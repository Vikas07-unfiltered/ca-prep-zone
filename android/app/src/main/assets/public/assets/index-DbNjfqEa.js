var QNe=Object.defineProperty;var c7=e=>{throw TypeError(e)};var ZNe=(e,t,n)=>t in e?QNe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var l7=(e,t,n)=>ZNe(e,typeof t!="symbol"?t+"":t,n),lk=(e,t,n)=>t.has(e)||c7("Cannot "+n);var Be=(e,t,n)=>(lk(e,t,"read from private field"),n?n.call(e):t.get(e)),Un=(e,t,n)=>t.has(e)?c7("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),tn=(e,t,n,i)=>(lk(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n),vo=(e,t,n)=>(lk(e,t,"access private method"),n);var ZT=(e,t,n,i)=>({set _(a){tn(e,t,a,n)},get _(){return Be(e,t,i)}});function e1e(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const a in i)if(a!=="default"&&!(a in e)){const l=Object.getOwnPropertyDescriptor(i,a);l&&Object.defineProperty(e,a,l.get?l:{enumerable:!0,get:()=>i[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var Ri=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t1e(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var a=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(n,i,a.get?a:{enumerable:!0,get:function(){return e[i]}})}),n}var dre={exports:{}},sO={},hre={exports:{}},bn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var SS=Symbol.for("react.element"),n1e=Symbol.for("react.portal"),r1e=Symbol.for("react.fragment"),i1e=Symbol.for("react.strict_mode"),o1e=Symbol.for("react.profiler"),s1e=Symbol.for("react.provider"),a1e=Symbol.for("react.context"),c1e=Symbol.for("react.forward_ref"),l1e=Symbol.for("react.suspense"),u1e=Symbol.for("react.memo"),d1e=Symbol.for("react.lazy"),u7=Symbol.iterator;function h1e(e){return e===null||typeof e!="object"?null:(e=u7&&e[u7]||e["@@iterator"],typeof e=="function"?e:null)}var fre={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pre=Object.assign,mre={};function Kv(e,t,n){this.props=e,this.context=t,this.refs=mre,this.updater=n||fre}Kv.prototype.isReactComponent={};Kv.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Kv.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function gre(){}gre.prototype=Kv.prototype;function yU(e,t,n){this.props=e,this.context=t,this.refs=mre,this.updater=n||fre}var _U=yU.prototype=new gre;_U.constructor=yU;pre(_U,Kv.prototype);_U.isPureReactComponent=!0;var d7=Array.isArray,vre=Object.prototype.hasOwnProperty,EU={current:null},yre={key:!0,ref:!0,__self:!0,__source:!0};function _re(e,t,n){var i,a={},l=null,d=null;if(t!=null)for(i in t.ref!==void 0&&(d=t.ref),t.key!==void 0&&(l=""+t.key),t)vre.call(t,i)&&!yre.hasOwnProperty(i)&&(a[i]=t[i]);var f=arguments.length-2;if(f===1)a.children=n;else if(1<f){for(var m=Array(f),v=0;v<f;v++)m[v]=arguments[v+2];a.children=m}if(e&&e.defaultProps)for(i in f=e.defaultProps,f)a[i]===void 0&&(a[i]=f[i]);return{$$typeof:SS,type:e,key:l,ref:d,props:a,_owner:EU.current}}function f1e(e,t){return{$$typeof:SS,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function bU(e){return typeof e=="object"&&e!==null&&e.$$typeof===SS}function p1e(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var h7=/\/+/g;function uk(e,t){return typeof e=="object"&&e!==null&&e.key!=null?p1e(""+e.key):t.toString(36)}function YC(e,t,n,i,a){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var d=!1;if(e===null)d=!0;else switch(l){case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case SS:case n1e:d=!0}}if(d)return d=e,a=a(d),e=i===""?"."+uk(d,0):i,d7(a)?(n="",e!=null&&(n=e.replace(h7,"$&/")+"/"),YC(a,t,n,"",function(v){return v})):a!=null&&(bU(a)&&(a=f1e(a,n+(!a.key||d&&d.key===a.key?"":(""+a.key).replace(h7,"$&/")+"/")+e)),t.push(a)),1;if(d=0,i=i===""?".":i+":",d7(e))for(var f=0;f<e.length;f++){l=e[f];var m=i+uk(l,f);d+=YC(l,t,n,m,a)}else if(m=h1e(e),typeof m=="function")for(e=m.call(e),f=0;!(l=e.next()).done;)l=l.value,m=i+uk(l,f++),d+=YC(l,t,n,m,a);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return d}function eC(e,t,n){if(e==null)return e;var i=[],a=0;return YC(e,i,"","",function(l){return t.call(n,l,a++)}),i}function m1e(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ho={current:null},qC={transition:null},g1e={ReactCurrentDispatcher:Ho,ReactCurrentBatchConfig:qC,ReactCurrentOwner:EU};function Ere(){throw Error("act(...) is not supported in production builds of React.")}bn.Children={map:eC,forEach:function(e,t,n){eC(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return eC(e,function(){t++}),t},toArray:function(e){return eC(e,function(t){return t})||[]},only:function(e){if(!bU(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};bn.Component=Kv;bn.Fragment=r1e;bn.Profiler=o1e;bn.PureComponent=yU;bn.StrictMode=i1e;bn.Suspense=l1e;bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=g1e;bn.act=Ere;bn.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=pre({},e.props),a=e.key,l=e.ref,d=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,d=EU.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var f=e.type.defaultProps;for(m in t)vre.call(t,m)&&!yre.hasOwnProperty(m)&&(i[m]=t[m]===void 0&&f!==void 0?f[m]:t[m])}var m=arguments.length-2;if(m===1)i.children=n;else if(1<m){f=Array(m);for(var v=0;v<m;v++)f[v]=arguments[v+2];i.children=f}return{$$typeof:SS,type:e.type,key:a,ref:l,props:i,_owner:d}};bn.createContext=function(e){return e={$$typeof:a1e,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:s1e,_context:e},e.Consumer=e};bn.createElement=_re;bn.createFactory=function(e){var t=_re.bind(null,e);return t.type=e,t};bn.createRef=function(){return{current:null}};bn.forwardRef=function(e){return{$$typeof:c1e,render:e}};bn.isValidElement=bU;bn.lazy=function(e){return{$$typeof:d1e,_payload:{_status:-1,_result:e},_init:m1e}};bn.memo=function(e,t){return{$$typeof:u1e,type:e,compare:t===void 0?null:t}};bn.startTransition=function(e){var t=qC.transition;qC.transition={};try{e()}finally{qC.transition=t}};bn.unstable_act=Ere;bn.useCallback=function(e,t){return Ho.current.useCallback(e,t)};bn.useContext=function(e){return Ho.current.useContext(e)};bn.useDebugValue=function(){};bn.useDeferredValue=function(e){return Ho.current.useDeferredValue(e)};bn.useEffect=function(e,t){return Ho.current.useEffect(e,t)};bn.useId=function(){return Ho.current.useId()};bn.useImperativeHandle=function(e,t,n){return Ho.current.useImperativeHandle(e,t,n)};bn.useInsertionEffect=function(e,t){return Ho.current.useInsertionEffect(e,t)};bn.useLayoutEffect=function(e,t){return Ho.current.useLayoutEffect(e,t)};bn.useMemo=function(e,t){return Ho.current.useMemo(e,t)};bn.useReducer=function(e,t,n){return Ho.current.useReducer(e,t,n)};bn.useRef=function(e){return Ho.current.useRef(e)};bn.useState=function(e){return Ho.current.useState(e)};bn.useSyncExternalStore=function(e,t,n){return Ho.current.useSyncExternalStore(e,t,n)};bn.useTransition=function(){return Ho.current.useTransition()};bn.version="18.3.1";hre.exports=bn;var N=hre.exports;const se=zn(N),SU=e1e({__proto__:null,default:se},[N]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v1e=N,y1e=Symbol.for("react.element"),_1e=Symbol.for("react.fragment"),E1e=Object.prototype.hasOwnProperty,b1e=v1e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,S1e={key:!0,ref:!0,__self:!0,__source:!0};function bre(e,t,n){var i,a={},l=null,d=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(d=t.ref);for(i in t)E1e.call(t,i)&&!S1e.hasOwnProperty(i)&&(a[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)a[i]===void 0&&(a[i]=t[i]);return{$$typeof:y1e,type:e,key:l,ref:d,props:a,_owner:b1e.current}}sO.Fragment=_1e;sO.jsx=bre;sO.jsxs=bre;dre.exports=sO;var _=dre.exports,Sre={exports:{}},Zs={},wre={exports:{}},Tre={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ne,ue){var _e=ne.length;ne.push(ue);e:for(;0<_e;){var Ce=_e-1>>>1,Ie=ne[Ce];if(0<a(Ie,ue))ne[Ce]=ue,ne[_e]=Ie,_e=Ce;else break e}}function n(ne){return ne.length===0?null:ne[0]}function i(ne){if(ne.length===0)return null;var ue=ne[0],_e=ne.pop();if(_e!==ue){ne[0]=_e;e:for(var Ce=0,Ie=ne.length,Ge=Ie>>>1;Ce<Ge;){var Ze=2*(Ce+1)-1,wt=ne[Ze],Ft=Ze+1,ze=ne[Ft];if(0>a(wt,_e))Ft<Ie&&0>a(ze,wt)?(ne[Ce]=ze,ne[Ft]=_e,Ce=Ft):(ne[Ce]=wt,ne[Ze]=_e,Ce=Ze);else if(Ft<Ie&&0>a(ze,_e))ne[Ce]=ze,ne[Ft]=_e,Ce=Ft;else break e}}return ue}function a(ne,ue){var _e=ne.sortIndex-ue.sortIndex;return _e!==0?_e:ne.id-ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var d=Date,f=d.now();e.unstable_now=function(){return d.now()-f}}var m=[],v=[],E=1,S=null,T=3,R=!1,I=!1,O=!1,P=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(ne){for(var ue=n(v);ue!==null;){if(ue.callback===null)i(v);else if(ue.startTime<=ne)i(v),ue.sortIndex=ue.expirationTime,t(m,ue);else break;ue=n(v)}}function $(ne){if(O=!1,M(ne),!I)if(n(m)!==null)I=!0,ye(V);else{var ue=n(v);ue!==null&&te($,ue.startTime-ne)}}function V(ne,ue){I=!1,O&&(O=!1,D(J),J=-1),R=!0;var _e=T;try{for(M(ue),S=n(m);S!==null&&(!(S.expirationTime>ue)||ne&&!he());){var Ce=S.callback;if(typeof Ce=="function"){S.callback=null,T=S.priorityLevel;var Ie=Ce(S.expirationTime<=ue);ue=e.unstable_now(),typeof Ie=="function"?S.callback=Ie:S===n(m)&&i(m),M(ue)}else i(m);S=n(m)}if(S!==null)var Ge=!0;else{var Ze=n(v);Ze!==null&&te($,Ze.startTime-ue),Ge=!1}return Ge}finally{S=null,T=_e,R=!1}}var W=!1,H=null,J=-1,ee=5,le=-1;function he(){return!(e.unstable_now()-le<ee)}function de(){if(H!==null){var ne=e.unstable_now();le=ne;var ue=!0;try{ue=H(!0,ne)}finally{ue?ae():(W=!1,H=null)}}else W=!1}var ae;if(typeof k=="function")ae=function(){k(de)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,ge=ce.port2;ce.port1.onmessage=de,ae=function(){ge.postMessage(null)}}else ae=function(){P(de,0)};function ye(ne){H=ne,W||(W=!0,ae())}function te(ne,ue){J=P(function(){ne(e.unstable_now())},ue)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ne){ne.callback=null},e.unstable_continueExecution=function(){I||R||(I=!0,ye(V))},e.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<ne?Math.floor(1e3/ne):5},e.unstable_getCurrentPriorityLevel=function(){return T},e.unstable_getFirstCallbackNode=function(){return n(m)},e.unstable_next=function(ne){switch(T){case 1:case 2:case 3:var ue=3;break;default:ue=T}var _e=T;T=ue;try{return ne()}finally{T=_e}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ne,ue){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var _e=T;T=ne;try{return ue()}finally{T=_e}},e.unstable_scheduleCallback=function(ne,ue,_e){var Ce=e.unstable_now();switch(typeof _e=="object"&&_e!==null?(_e=_e.delay,_e=typeof _e=="number"&&0<_e?Ce+_e:Ce):_e=Ce,ne){case 1:var Ie=-1;break;case 2:Ie=250;break;case 5:Ie=1073741823;break;case 4:Ie=1e4;break;default:Ie=5e3}return Ie=_e+Ie,ne={id:E++,callback:ue,priorityLevel:ne,startTime:_e,expirationTime:Ie,sortIndex:-1},_e>Ce?(ne.sortIndex=_e,t(v,ne),n(m)===null&&ne===n(v)&&(O?(D(J),J=-1):O=!0,te($,_e-Ce))):(ne.sortIndex=Ie,t(m,ne),I||R||(I=!0,ye(V))),ne},e.unstable_shouldYield=he,e.unstable_wrapCallback=function(ne){var ue=T;return function(){var _e=T;T=ue;try{return ne.apply(this,arguments)}finally{T=_e}}}})(Tre);wre.exports=Tre;var w1e=wre.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T1e=N,Xs=w1e;function qe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Cre=new Set,ob={};function Ap(e,t){ov(e,t),ov(e+"Capture",t)}function ov(e,t){for(ob[e]=t,e=0;e<t.length;e++)Cre.add(t[e])}var Du=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tM=Object.prototype.hasOwnProperty,C1e=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f7={},p7={};function R1e(e){return tM.call(p7,e)?!0:tM.call(f7,e)?!1:C1e.test(e)?p7[e]=!0:(f7[e]=!0,!1)}function A1e(e,t,n,i){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function O1e(e,t,n,i){if(t===null||typeof t>"u"||A1e(e,t,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ko(e,t,n,i,a,l,d){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=d}var co={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){co[e]=new Ko(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];co[t]=new Ko(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){co[e]=new Ko(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){co[e]=new Ko(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){co[e]=new Ko(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){co[e]=new Ko(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){co[e]=new Ko(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){co[e]=new Ko(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){co[e]=new Ko(e,5,!1,e.toLowerCase(),null,!1,!1)});var wU=/[\-:]([a-z])/g;function TU(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(wU,TU);co[t]=new Ko(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(wU,TU);co[t]=new Ko(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(wU,TU);co[t]=new Ko(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){co[e]=new Ko(e,1,!1,e.toLowerCase(),null,!1,!1)});co.xlinkHref=new Ko("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){co[e]=new Ko(e,1,!1,e.toLowerCase(),null,!0,!0)});function CU(e,t,n,i){var a=co.hasOwnProperty(t)?co[t]:null;(a!==null?a.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(O1e(t,n,a,i)&&(n=null),i||a===null?R1e(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,i=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}var Gu=T1e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,tC=Symbol.for("react.element"),mg=Symbol.for("react.portal"),gg=Symbol.for("react.fragment"),RU=Symbol.for("react.strict_mode"),nM=Symbol.for("react.profiler"),Rre=Symbol.for("react.provider"),Are=Symbol.for("react.context"),AU=Symbol.for("react.forward_ref"),rM=Symbol.for("react.suspense"),iM=Symbol.for("react.suspense_list"),OU=Symbol.for("react.memo"),Fd=Symbol.for("react.lazy"),Ore=Symbol.for("react.offscreen"),m7=Symbol.iterator;function J_(e){return e===null||typeof e!="object"?null:(e=m7&&e[m7]||e["@@iterator"],typeof e=="function"?e:null)}var ti=Object.assign,dk;function bE(e){if(dk===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);dk=t&&t[1]||""}return`
`+dk+e}var hk=!1;function fk(e,t){if(!e||hk)return"";hk=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(v){var i=v}Reflect.construct(e,[],t)}else{try{t.call()}catch(v){i=v}e.call(t.prototype)}else{try{throw Error()}catch(v){i=v}e()}}catch(v){if(v&&i&&typeof v.stack=="string"){for(var a=v.stack.split(`
`),l=i.stack.split(`
`),d=a.length-1,f=l.length-1;1<=d&&0<=f&&a[d]!==l[f];)f--;for(;1<=d&&0<=f;d--,f--)if(a[d]!==l[f]){if(d!==1||f!==1)do if(d--,f--,0>f||a[d]!==l[f]){var m=`
`+a[d].replace(" at new "," at ");return e.displayName&&m.includes("<anonymous>")&&(m=m.replace("<anonymous>",e.displayName)),m}while(1<=d&&0<=f);break}}}finally{hk=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?bE(e):""}function I1e(e){switch(e.tag){case 5:return bE(e.type);case 16:return bE("Lazy");case 13:return bE("Suspense");case 19:return bE("SuspenseList");case 0:case 2:case 15:return e=fk(e.type,!1),e;case 11:return e=fk(e.type.render,!1),e;case 1:return e=fk(e.type,!0),e;default:return""}}function oM(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case gg:return"Fragment";case mg:return"Portal";case nM:return"Profiler";case RU:return"StrictMode";case rM:return"Suspense";case iM:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Are:return(e.displayName||"Context")+".Consumer";case Rre:return(e._context.displayName||"Context")+".Provider";case AU:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case OU:return t=e.displayName||null,t!==null?t:oM(e.type)||"Memo";case Fd:t=e._payload,e=e._init;try{return oM(e(t))}catch{}}return null}function x1e(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return oM(t);case 8:return t===RU?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function yh(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ire(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function P1e(e){var t=Ire(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(d){i=""+d,l.call(this,d)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(d){i=""+d},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function nC(e){e._valueTracker||(e._valueTracker=P1e(e))}function xre(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=Ire(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function gR(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function sM(e,t){var n=t.checked;return ti({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function g7(e,t){var n=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;n=yh(t.value!=null?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Pre(e,t){t=t.checked,t!=null&&CU(e,"checked",t,!1)}function aM(e,t){Pre(e,t);var n=yh(t.value),i=t.type;if(n!=null)i==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?cM(e,t.type,n):t.hasOwnProperty("defaultValue")&&cM(e,t.type,yh(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function v7(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function cM(e,t,n){(t!=="number"||gR(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var SE=Array.isArray;function jg(e,t,n,i){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&i&&(e[n].defaultSelected=!0)}else{for(n=""+yh(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,i&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function lM(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(qe(91));return ti({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function y7(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(qe(92));if(SE(n)){if(1<n.length)throw Error(qe(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:yh(n)}}function Nre(e,t){var n=yh(t.value),i=yh(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),i!=null&&(e.defaultValue=""+i)}function _7(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Dre(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function uM(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Dre(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var rC,kre=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,i,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,i,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(rC=rC||document.createElement("div"),rC.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=rC.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function sb(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var DE={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},N1e=["Webkit","ms","Moz","O"];Object.keys(DE).forEach(function(e){N1e.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),DE[t]=DE[e]})});function Lre(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||DE.hasOwnProperty(e)&&DE[e]?(""+t).trim():t+"px"}function Mre(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var i=n.indexOf("--")===0,a=Lre(n,t[n],i);n==="float"&&(n="cssFloat"),i?e.setProperty(n,a):e[n]=a}}var D1e=ti({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function dM(e,t){if(t){if(D1e[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(qe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(qe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(qe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(qe(62))}}function hM(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fM=null;function IU(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var pM=null,Ug=null,Vg=null;function E7(e){if(e=CS(e)){if(typeof pM!="function")throw Error(qe(280));var t=e.stateNode;t&&(t=dO(t),pM(e.stateNode,e.type,t))}}function jre(e){Ug?Vg?Vg.push(e):Vg=[e]:Ug=e}function Ure(){if(Ug){var e=Ug,t=Vg;if(Vg=Ug=null,E7(e),t)for(e=0;e<t.length;e++)E7(t[e])}}function Vre(e,t){return e(t)}function Fre(){}var pk=!1;function Bre(e,t,n){if(pk)return e(t,n);pk=!0;try{return Vre(e,t,n)}finally{pk=!1,(Ug!==null||Vg!==null)&&(Fre(),Ure())}}function ab(e,t){var n=e.stateNode;if(n===null)return null;var i=dO(n);if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(qe(231,t,typeof n));return n}var mM=!1;if(Du)try{var Q_={};Object.defineProperty(Q_,"passive",{get:function(){mM=!0}}),window.addEventListener("test",Q_,Q_),window.removeEventListener("test",Q_,Q_)}catch{mM=!1}function k1e(e,t,n,i,a,l,d,f,m){var v=Array.prototype.slice.call(arguments,3);try{t.apply(n,v)}catch(E){this.onError(E)}}var kE=!1,vR=null,yR=!1,gM=null,L1e={onError:function(e){kE=!0,vR=e}};function M1e(e,t,n,i,a,l,d,f,m){kE=!1,vR=null,k1e.apply(L1e,arguments)}function j1e(e,t,n,i,a,l,d,f,m){if(M1e.apply(this,arguments),kE){if(kE){var v=vR;kE=!1,vR=null}else throw Error(qe(198));yR||(yR=!0,gM=v)}}function Op(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function $re(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function b7(e){if(Op(e)!==e)throw Error(qe(188))}function U1e(e){var t=e.alternate;if(!t){if(t=Op(e),t===null)throw Error(qe(188));return t!==e?null:e}for(var n=e,i=t;;){var a=n.return;if(a===null)break;var l=a.alternate;if(l===null){if(i=a.return,i!==null){n=i;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===n)return b7(a),e;if(l===i)return b7(a),t;l=l.sibling}throw Error(qe(188))}if(n.return!==i.return)n=a,i=l;else{for(var d=!1,f=a.child;f;){if(f===n){d=!0,n=a,i=l;break}if(f===i){d=!0,i=a,n=l;break}f=f.sibling}if(!d){for(f=l.child;f;){if(f===n){d=!0,n=l,i=a;break}if(f===i){d=!0,i=l,n=a;break}f=f.sibling}if(!d)throw Error(qe(189))}}if(n.alternate!==i)throw Error(qe(190))}if(n.tag!==3)throw Error(qe(188));return n.stateNode.current===n?e:t}function Wre(e){return e=U1e(e),e!==null?Gre(e):null}function Gre(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Gre(e);if(t!==null)return t;e=e.sibling}return null}var Hre=Xs.unstable_scheduleCallback,S7=Xs.unstable_cancelCallback,V1e=Xs.unstable_shouldYield,F1e=Xs.unstable_requestPaint,yi=Xs.unstable_now,B1e=Xs.unstable_getCurrentPriorityLevel,xU=Xs.unstable_ImmediatePriority,Kre=Xs.unstable_UserBlockingPriority,_R=Xs.unstable_NormalPriority,$1e=Xs.unstable_LowPriority,zre=Xs.unstable_IdlePriority,aO=null,Sl=null;function W1e(e){if(Sl&&typeof Sl.onCommitFiberRoot=="function")try{Sl.onCommitFiberRoot(aO,e,void 0,(e.current.flags&128)===128)}catch{}}var xc=Math.clz32?Math.clz32:K1e,G1e=Math.log,H1e=Math.LN2;function K1e(e){return e>>>=0,e===0?32:31-(G1e(e)/H1e|0)|0}var iC=64,oC=4194304;function wE(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ER(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,a=e.suspendedLanes,l=e.pingedLanes,d=n&268435455;if(d!==0){var f=d&~a;f!==0?i=wE(f):(l&=d,l!==0&&(i=wE(l)))}else d=n&~a,d!==0?i=wE(d):l!==0&&(i=wE(l));if(i===0)return 0;if(t!==0&&t!==i&&!(t&a)&&(a=i&-i,l=t&-t,a>=l||a===16&&(l&4194240)!==0))return t;if(i&4&&(i|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)n=31-xc(t),a=1<<n,i|=e[n],t&=~a;return i}function z1e(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Y1e(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,a=e.expirationTimes,l=e.pendingLanes;0<l;){var d=31-xc(l),f=1<<d,m=a[d];m===-1?(!(f&n)||f&i)&&(a[d]=z1e(f,t)):m<=t&&(e.expiredLanes|=f),l&=~f}}function vM(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Yre(){var e=iC;return iC<<=1,!(iC&4194240)&&(iC=64),e}function mk(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function wS(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-xc(t),e[t]=n}function q1e(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-xc(n),l=1<<a;t[a]=0,i[a]=-1,e[a]=-1,n&=~l}}function PU(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-xc(n),a=1<<i;a&t|e[i]&t&&(e[i]|=t),n&=~a}}var tr=0;function qre(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Xre,NU,Jre,Qre,Zre,yM=!1,sC=[],rh=null,ih=null,oh=null,cb=new Map,lb=new Map,Hd=[],X1e="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function w7(e,t){switch(e){case"focusin":case"focusout":rh=null;break;case"dragenter":case"dragleave":ih=null;break;case"mouseover":case"mouseout":oh=null;break;case"pointerover":case"pointerout":cb.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":lb.delete(t.pointerId)}}function Z_(e,t,n,i,a,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:l,targetContainers:[a]},t!==null&&(t=CS(t),t!==null&&NU(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function J1e(e,t,n,i,a){switch(t){case"focusin":return rh=Z_(rh,e,t,n,i,a),!0;case"dragenter":return ih=Z_(ih,e,t,n,i,a),!0;case"mouseover":return oh=Z_(oh,e,t,n,i,a),!0;case"pointerover":var l=a.pointerId;return cb.set(l,Z_(cb.get(l)||null,e,t,n,i,a)),!0;case"gotpointercapture":return l=a.pointerId,lb.set(l,Z_(lb.get(l)||null,e,t,n,i,a)),!0}return!1}function eie(e){var t=Kf(e.target);if(t!==null){var n=Op(t);if(n!==null){if(t=n.tag,t===13){if(t=$re(n),t!==null){e.blockedOn=t,Zre(e.priority,function(){Jre(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function XC(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=_M(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);fM=i,n.target.dispatchEvent(i),fM=null}else return t=CS(n),t!==null&&NU(t),e.blockedOn=n,!1;t.shift()}return!0}function T7(e,t,n){XC(e)&&n.delete(t)}function Q1e(){yM=!1,rh!==null&&XC(rh)&&(rh=null),ih!==null&&XC(ih)&&(ih=null),oh!==null&&XC(oh)&&(oh=null),cb.forEach(T7),lb.forEach(T7)}function eE(e,t){e.blockedOn===t&&(e.blockedOn=null,yM||(yM=!0,Xs.unstable_scheduleCallback(Xs.unstable_NormalPriority,Q1e)))}function ub(e){function t(a){return eE(a,e)}if(0<sC.length){eE(sC[0],e);for(var n=1;n<sC.length;n++){var i=sC[n];i.blockedOn===e&&(i.blockedOn=null)}}for(rh!==null&&eE(rh,e),ih!==null&&eE(ih,e),oh!==null&&eE(oh,e),cb.forEach(t),lb.forEach(t),n=0;n<Hd.length;n++)i=Hd[n],i.blockedOn===e&&(i.blockedOn=null);for(;0<Hd.length&&(n=Hd[0],n.blockedOn===null);)eie(n),n.blockedOn===null&&Hd.shift()}var Fg=Gu.ReactCurrentBatchConfig,bR=!0;function Z1e(e,t,n,i){var a=tr,l=Fg.transition;Fg.transition=null;try{tr=1,DU(e,t,n,i)}finally{tr=a,Fg.transition=l}}function eDe(e,t,n,i){var a=tr,l=Fg.transition;Fg.transition=null;try{tr=4,DU(e,t,n,i)}finally{tr=a,Fg.transition=l}}function DU(e,t,n,i){if(bR){var a=_M(e,t,n,i);if(a===null)Ck(e,t,i,SR,n),w7(e,i);else if(J1e(a,e,t,n,i))i.stopPropagation();else if(w7(e,i),t&4&&-1<X1e.indexOf(e)){for(;a!==null;){var l=CS(a);if(l!==null&&Xre(l),l=_M(e,t,n,i),l===null&&Ck(e,t,i,SR,n),l===a)break;a=l}a!==null&&i.stopPropagation()}else Ck(e,t,i,null,n)}}var SR=null;function _M(e,t,n,i){if(SR=null,e=IU(i),e=Kf(e),e!==null)if(t=Op(e),t===null)e=null;else if(n=t.tag,n===13){if(e=$re(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return SR=e,null}function tie(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(B1e()){case xU:return 1;case Kre:return 4;case _R:case $1e:return 16;case zre:return 536870912;default:return 16}default:return 16}}var Zd=null,kU=null,JC=null;function nie(){if(JC)return JC;var e,t=kU,n=t.length,i,a="value"in Zd?Zd.value:Zd.textContent,l=a.length;for(e=0;e<n&&t[e]===a[e];e++);var d=n-e;for(i=1;i<=d&&t[n-i]===a[l-i];i++);return JC=a.slice(e,1<i?1-i:void 0)}function QC(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function aC(){return!0}function C7(){return!1}function ea(e){function t(n,i,a,l,d){this._reactName=n,this._targetInst=a,this.type=i,this.nativeEvent=l,this.target=d,this.currentTarget=null;for(var f in e)e.hasOwnProperty(f)&&(n=e[f],this[f]=n?n(l):l[f]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?aC:C7,this.isPropagationStopped=C7,this}return ti(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=aC)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=aC)},persist:function(){},isPersistent:aC}),t}var zv={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},LU=ea(zv),TS=ti({},zv,{view:0,detail:0}),tDe=ea(TS),gk,vk,tE,cO=ti({},TS,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:MU,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==tE&&(tE&&e.type==="mousemove"?(gk=e.screenX-tE.screenX,vk=e.screenY-tE.screenY):vk=gk=0,tE=e),gk)},movementY:function(e){return"movementY"in e?e.movementY:vk}}),R7=ea(cO),nDe=ti({},cO,{dataTransfer:0}),rDe=ea(nDe),iDe=ti({},TS,{relatedTarget:0}),yk=ea(iDe),oDe=ti({},zv,{animationName:0,elapsedTime:0,pseudoElement:0}),sDe=ea(oDe),aDe=ti({},zv,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),cDe=ea(aDe),lDe=ti({},zv,{data:0}),A7=ea(lDe),uDe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dDe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hDe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fDe(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=hDe[e])?!!t[e]:!1}function MU(){return fDe}var pDe=ti({},TS,{key:function(e){if(e.key){var t=uDe[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=QC(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?dDe[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:MU,charCode:function(e){return e.type==="keypress"?QC(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?QC(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),mDe=ea(pDe),gDe=ti({},cO,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),O7=ea(gDe),vDe=ti({},TS,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:MU}),yDe=ea(vDe),_De=ti({},zv,{propertyName:0,elapsedTime:0,pseudoElement:0}),EDe=ea(_De),bDe=ti({},cO,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),SDe=ea(bDe),wDe=[9,13,27,32],jU=Du&&"CompositionEvent"in window,LE=null;Du&&"documentMode"in document&&(LE=document.documentMode);var TDe=Du&&"TextEvent"in window&&!LE,rie=Du&&(!jU||LE&&8<LE&&11>=LE),I7=" ",x7=!1;function iie(e,t){switch(e){case"keyup":return wDe.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function oie(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var vg=!1;function CDe(e,t){switch(e){case"compositionend":return oie(t);case"keypress":return t.which!==32?null:(x7=!0,I7);case"textInput":return e=t.data,e===I7&&x7?null:e;default:return null}}function RDe(e,t){if(vg)return e==="compositionend"||!jU&&iie(e,t)?(e=nie(),JC=kU=Zd=null,vg=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return rie&&t.locale!=="ko"?null:t.data;default:return null}}var ADe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function P7(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!ADe[e.type]:t==="textarea"}function sie(e,t,n,i){jre(i),t=wR(t,"onChange"),0<t.length&&(n=new LU("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var ME=null,db=null;function ODe(e){vie(e,0)}function lO(e){var t=Eg(e);if(xre(t))return e}function IDe(e,t){if(e==="change")return t}var aie=!1;if(Du){var _k;if(Du){var Ek="oninput"in document;if(!Ek){var N7=document.createElement("div");N7.setAttribute("oninput","return;"),Ek=typeof N7.oninput=="function"}_k=Ek}else _k=!1;aie=_k&&(!document.documentMode||9<document.documentMode)}function D7(){ME&&(ME.detachEvent("onpropertychange",cie),db=ME=null)}function cie(e){if(e.propertyName==="value"&&lO(db)){var t=[];sie(t,db,e,IU(e)),Bre(ODe,t)}}function xDe(e,t,n){e==="focusin"?(D7(),ME=t,db=n,ME.attachEvent("onpropertychange",cie)):e==="focusout"&&D7()}function PDe(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return lO(db)}function NDe(e,t){if(e==="click")return lO(t)}function DDe(e,t){if(e==="input"||e==="change")return lO(t)}function kDe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Nc=typeof Object.is=="function"?Object.is:kDe;function hb(e,t){if(Nc(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var a=n[i];if(!tM.call(t,a)||!Nc(e[a],t[a]))return!1}return!0}function k7(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function L7(e,t){var n=k7(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=k7(n)}}function lie(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?lie(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function uie(){for(var e=window,t=gR();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=gR(e.document)}return t}function UU(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function LDe(e){var t=uie(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&lie(n.ownerDocument.documentElement,n)){if(i!==null&&UU(n)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,l=Math.min(i.start,a);i=i.end===void 0?l:Math.min(i.end,a),!e.extend&&l>i&&(a=i,i=l,l=a),a=L7(n,l);var d=L7(n,i);a&&d&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==d.node||e.focusOffset!==d.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),l>i?(e.addRange(t),e.extend(d.node,d.offset)):(t.setEnd(d.node,d.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var MDe=Du&&"documentMode"in document&&11>=document.documentMode,yg=null,EM=null,jE=null,bM=!1;function M7(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;bM||yg==null||yg!==gR(i)||(i=yg,"selectionStart"in i&&UU(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),jE&&hb(jE,i)||(jE=i,i=wR(EM,"onSelect"),0<i.length&&(t=new LU("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=yg)))}function cC(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _g={animationend:cC("Animation","AnimationEnd"),animationiteration:cC("Animation","AnimationIteration"),animationstart:cC("Animation","AnimationStart"),transitionend:cC("Transition","TransitionEnd")},bk={},die={};Du&&(die=document.createElement("div").style,"AnimationEvent"in window||(delete _g.animationend.animation,delete _g.animationiteration.animation,delete _g.animationstart.animation),"TransitionEvent"in window||delete _g.transitionend.transition);function uO(e){if(bk[e])return bk[e];if(!_g[e])return e;var t=_g[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in die)return bk[e]=t[n];return e}var hie=uO("animationend"),fie=uO("animationiteration"),pie=uO("animationstart"),mie=uO("transitionend"),gie=new Map,j7="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ch(e,t){gie.set(e,t),Ap(t,[e])}for(var Sk=0;Sk<j7.length;Sk++){var wk=j7[Sk],jDe=wk.toLowerCase(),UDe=wk[0].toUpperCase()+wk.slice(1);Ch(jDe,"on"+UDe)}Ch(hie,"onAnimationEnd");Ch(fie,"onAnimationIteration");Ch(pie,"onAnimationStart");Ch("dblclick","onDoubleClick");Ch("focusin","onFocus");Ch("focusout","onBlur");Ch(mie,"onTransitionEnd");ov("onMouseEnter",["mouseout","mouseover"]);ov("onMouseLeave",["mouseout","mouseover"]);ov("onPointerEnter",["pointerout","pointerover"]);ov("onPointerLeave",["pointerout","pointerover"]);Ap("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ap("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ap("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ap("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ap("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ap("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var TE="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VDe=new Set("cancel close invalid load scroll toggle".split(" ").concat(TE));function U7(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,j1e(i,t,void 0,e),e.currentTarget=null}function vie(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],a=i.event;i=i.listeners;e:{var l=void 0;if(t)for(var d=i.length-1;0<=d;d--){var f=i[d],m=f.instance,v=f.currentTarget;if(f=f.listener,m!==l&&a.isPropagationStopped())break e;U7(a,f,v),l=m}else for(d=0;d<i.length;d++){if(f=i[d],m=f.instance,v=f.currentTarget,f=f.listener,m!==l&&a.isPropagationStopped())break e;U7(a,f,v),l=m}}}if(yR)throw e=gM,yR=!1,gM=null,e}function xr(e,t){var n=t[RM];n===void 0&&(n=t[RM]=new Set);var i=e+"__bubble";n.has(i)||(yie(t,e,2,!1),n.add(i))}function Tk(e,t,n){var i=0;t&&(i|=4),yie(n,e,i,t)}var lC="_reactListening"+Math.random().toString(36).slice(2);function fb(e){if(!e[lC]){e[lC]=!0,Cre.forEach(function(n){n!=="selectionchange"&&(VDe.has(n)||Tk(n,!1,e),Tk(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[lC]||(t[lC]=!0,Tk("selectionchange",!1,t))}}function yie(e,t,n,i){switch(tie(t)){case 1:var a=Z1e;break;case 4:a=eDe;break;default:a=DU}n=a.bind(null,t,n,e),a=void 0,!mM||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),i?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Ck(e,t,n,i,a){var l=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var d=i.tag;if(d===3||d===4){var f=i.stateNode.containerInfo;if(f===a||f.nodeType===8&&f.parentNode===a)break;if(d===4)for(d=i.return;d!==null;){var m=d.tag;if((m===3||m===4)&&(m=d.stateNode.containerInfo,m===a||m.nodeType===8&&m.parentNode===a))return;d=d.return}for(;f!==null;){if(d=Kf(f),d===null)return;if(m=d.tag,m===5||m===6){i=l=d;continue e}f=f.parentNode}}i=i.return}Bre(function(){var v=l,E=IU(n),S=[];e:{var T=gie.get(e);if(T!==void 0){var R=LU,I=e;switch(e){case"keypress":if(QC(n)===0)break e;case"keydown":case"keyup":R=mDe;break;case"focusin":I="focus",R=yk;break;case"focusout":I="blur",R=yk;break;case"beforeblur":case"afterblur":R=yk;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":R=R7;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":R=rDe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":R=yDe;break;case hie:case fie:case pie:R=sDe;break;case mie:R=EDe;break;case"scroll":R=tDe;break;case"wheel":R=SDe;break;case"copy":case"cut":case"paste":R=cDe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":R=O7}var O=(t&4)!==0,P=!O&&e==="scroll",D=O?T!==null?T+"Capture":null:T;O=[];for(var k=v,M;k!==null;){M=k;var $=M.stateNode;if(M.tag===5&&$!==null&&(M=$,D!==null&&($=ab(k,D),$!=null&&O.push(pb(k,$,M)))),P)break;k=k.return}0<O.length&&(T=new R(T,I,null,n,E),S.push({event:T,listeners:O}))}}if(!(t&7)){e:{if(T=e==="mouseover"||e==="pointerover",R=e==="mouseout"||e==="pointerout",T&&n!==fM&&(I=n.relatedTarget||n.fromElement)&&(Kf(I)||I[ku]))break e;if((R||T)&&(T=E.window===E?E:(T=E.ownerDocument)?T.defaultView||T.parentWindow:window,R?(I=n.relatedTarget||n.toElement,R=v,I=I?Kf(I):null,I!==null&&(P=Op(I),I!==P||I.tag!==5&&I.tag!==6)&&(I=null)):(R=null,I=v),R!==I)){if(O=R7,$="onMouseLeave",D="onMouseEnter",k="mouse",(e==="pointerout"||e==="pointerover")&&(O=O7,$="onPointerLeave",D="onPointerEnter",k="pointer"),P=R==null?T:Eg(R),M=I==null?T:Eg(I),T=new O($,k+"leave",R,n,E),T.target=P,T.relatedTarget=M,$=null,Kf(E)===v&&(O=new O(D,k+"enter",I,n,E),O.target=M,O.relatedTarget=P,$=O),P=$,R&&I)t:{for(O=R,D=I,k=0,M=O;M;M=eg(M))k++;for(M=0,$=D;$;$=eg($))M++;for(;0<k-M;)O=eg(O),k--;for(;0<M-k;)D=eg(D),M--;for(;k--;){if(O===D||D!==null&&O===D.alternate)break t;O=eg(O),D=eg(D)}O=null}else O=null;R!==null&&V7(S,T,R,O,!1),I!==null&&P!==null&&V7(S,P,I,O,!0)}}e:{if(T=v?Eg(v):window,R=T.nodeName&&T.nodeName.toLowerCase(),R==="select"||R==="input"&&T.type==="file")var V=IDe;else if(P7(T))if(aie)V=DDe;else{V=PDe;var W=xDe}else(R=T.nodeName)&&R.toLowerCase()==="input"&&(T.type==="checkbox"||T.type==="radio")&&(V=NDe);if(V&&(V=V(e,v))){sie(S,V,n,E);break e}W&&W(e,T,v),e==="focusout"&&(W=T._wrapperState)&&W.controlled&&T.type==="number"&&cM(T,"number",T.value)}switch(W=v?Eg(v):window,e){case"focusin":(P7(W)||W.contentEditable==="true")&&(yg=W,EM=v,jE=null);break;case"focusout":jE=EM=yg=null;break;case"mousedown":bM=!0;break;case"contextmenu":case"mouseup":case"dragend":bM=!1,M7(S,n,E);break;case"selectionchange":if(MDe)break;case"keydown":case"keyup":M7(S,n,E)}var H;if(jU)e:{switch(e){case"compositionstart":var J="onCompositionStart";break e;case"compositionend":J="onCompositionEnd";break e;case"compositionupdate":J="onCompositionUpdate";break e}J=void 0}else vg?iie(e,n)&&(J="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(J="onCompositionStart");J&&(rie&&n.locale!=="ko"&&(vg||J!=="onCompositionStart"?J==="onCompositionEnd"&&vg&&(H=nie()):(Zd=E,kU="value"in Zd?Zd.value:Zd.textContent,vg=!0)),W=wR(v,J),0<W.length&&(J=new A7(J,e,null,n,E),S.push({event:J,listeners:W}),H?J.data=H:(H=oie(n),H!==null&&(J.data=H)))),(H=TDe?CDe(e,n):RDe(e,n))&&(v=wR(v,"onBeforeInput"),0<v.length&&(E=new A7("onBeforeInput","beforeinput",null,n,E),S.push({event:E,listeners:v}),E.data=H))}vie(S,t)})}function pb(e,t,n){return{instance:e,listener:t,currentTarget:n}}function wR(e,t){for(var n=t+"Capture",i=[];e!==null;){var a=e,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=ab(e,n),l!=null&&i.unshift(pb(e,l,a)),l=ab(e,t),l!=null&&i.push(pb(e,l,a))),e=e.return}return i}function eg(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function V7(e,t,n,i,a){for(var l=t._reactName,d=[];n!==null&&n!==i;){var f=n,m=f.alternate,v=f.stateNode;if(m!==null&&m===i)break;f.tag===5&&v!==null&&(f=v,a?(m=ab(n,l),m!=null&&d.unshift(pb(n,m,f))):a||(m=ab(n,l),m!=null&&d.push(pb(n,m,f)))),n=n.return}d.length!==0&&e.push({event:t,listeners:d})}var FDe=/\r\n?/g,BDe=/\u0000|\uFFFD/g;function F7(e){return(typeof e=="string"?e:""+e).replace(FDe,`
`).replace(BDe,"")}function uC(e,t,n){if(t=F7(t),F7(e)!==t&&n)throw Error(qe(425))}function TR(){}var SM=null,wM=null;function TM(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var CM=typeof setTimeout=="function"?setTimeout:void 0,$De=typeof clearTimeout=="function"?clearTimeout:void 0,B7=typeof Promise=="function"?Promise:void 0,WDe=typeof queueMicrotask=="function"?queueMicrotask:typeof B7<"u"?function(e){return B7.resolve(null).then(e).catch(GDe)}:CM;function GDe(e){setTimeout(function(){throw e})}function Rk(e,t){var n=t,i=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(i===0){e.removeChild(a),ub(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=a}while(n);ub(t)}function sh(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function $7(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Yv=Math.random().toString(36).slice(2),gl="__reactFiber$"+Yv,mb="__reactProps$"+Yv,ku="__reactContainer$"+Yv,RM="__reactEvents$"+Yv,HDe="__reactListeners$"+Yv,KDe="__reactHandles$"+Yv;function Kf(e){var t=e[gl];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ku]||n[gl]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=$7(e);e!==null;){if(n=e[gl])return n;e=$7(e)}return t}e=n,n=e.parentNode}return null}function CS(e){return e=e[gl]||e[ku],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Eg(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(qe(33))}function dO(e){return e[mb]||null}var AM=[],bg=-1;function Rh(e){return{current:e}}function kr(e){0>bg||(e.current=AM[bg],AM[bg]=null,bg--)}function Sr(e,t){bg++,AM[bg]=e.current,e.current=t}var _h={},Ro=Rh(_h),_s=Rh(!1),dp=_h;function sv(e,t){var n=e.type.contextTypes;if(!n)return _h;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in n)a[l]=t[l];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Es(e){return e=e.childContextTypes,e!=null}function CR(){kr(_s),kr(Ro)}function W7(e,t,n){if(Ro.current!==_h)throw Error(qe(168));Sr(Ro,t),Sr(_s,n)}function _ie(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var a in i)if(!(a in t))throw Error(qe(108,x1e(e)||"Unknown",a));return ti({},n,i)}function RR(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_h,dp=Ro.current,Sr(Ro,e),Sr(_s,_s.current),!0}function G7(e,t,n){var i=e.stateNode;if(!i)throw Error(qe(169));n?(e=_ie(e,t,dp),i.__reactInternalMemoizedMergedChildContext=e,kr(_s),kr(Ro),Sr(Ro,e)):kr(_s),Sr(_s,n)}var hu=null,hO=!1,Ak=!1;function Eie(e){hu===null?hu=[e]:hu.push(e)}function zDe(e){hO=!0,Eie(e)}function Ah(){if(!Ak&&hu!==null){Ak=!0;var e=0,t=tr;try{var n=hu;for(tr=1;e<n.length;e++){var i=n[e];do i=i(!0);while(i!==null)}hu=null,hO=!1}catch(a){throw hu!==null&&(hu=hu.slice(e+1)),Hre(xU,Ah),a}finally{tr=t,Ak=!1}}return null}var Sg=[],wg=0,AR=null,OR=0,Da=[],ka=0,hp=null,pu=1,mu="";function kf(e,t){Sg[wg++]=OR,Sg[wg++]=AR,AR=e,OR=t}function bie(e,t,n){Da[ka++]=pu,Da[ka++]=mu,Da[ka++]=hp,hp=e;var i=pu;e=mu;var a=32-xc(i)-1;i&=~(1<<a),n+=1;var l=32-xc(t)+a;if(30<l){var d=a-a%5;l=(i&(1<<d)-1).toString(32),i>>=d,a-=d,pu=1<<32-xc(t)+a|n<<a|i,mu=l+e}else pu=1<<l|n<<a|i,mu=e}function VU(e){e.return!==null&&(kf(e,1),bie(e,1,0))}function FU(e){for(;e===AR;)AR=Sg[--wg],Sg[wg]=null,OR=Sg[--wg],Sg[wg]=null;for(;e===hp;)hp=Da[--ka],Da[ka]=null,mu=Da[--ka],Da[ka]=null,pu=Da[--ka],Da[ka]=null}var Ks=null,Hs=null,Br=!1,Rc=null;function Sie(e,t){var n=Ma(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function H7(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ks=e,Hs=sh(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ks=e,Hs=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=hp!==null?{id:pu,overflow:mu}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Ma(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Ks=e,Hs=null,!0):!1;default:return!1}}function OM(e){return(e.mode&1)!==0&&(e.flags&128)===0}function IM(e){if(Br){var t=Hs;if(t){var n=t;if(!H7(e,t)){if(OM(e))throw Error(qe(418));t=sh(n.nextSibling);var i=Ks;t&&H7(e,t)?Sie(i,n):(e.flags=e.flags&-4097|2,Br=!1,Ks=e)}}else{if(OM(e))throw Error(qe(418));e.flags=e.flags&-4097|2,Br=!1,Ks=e}}}function K7(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ks=e}function dC(e){if(e!==Ks)return!1;if(!Br)return K7(e),Br=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!TM(e.type,e.memoizedProps)),t&&(t=Hs)){if(OM(e))throw wie(),Error(qe(418));for(;t;)Sie(e,t),t=sh(t.nextSibling)}if(K7(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(qe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Hs=sh(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Hs=null}}else Hs=Ks?sh(e.stateNode.nextSibling):null;return!0}function wie(){for(var e=Hs;e;)e=sh(e.nextSibling)}function av(){Hs=Ks=null,Br=!1}function BU(e){Rc===null?Rc=[e]:Rc.push(e)}var YDe=Gu.ReactCurrentBatchConfig;function nE(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(qe(309));var i=n.stateNode}if(!i)throw Error(qe(147,e));var a=i,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(d){var f=a.refs;d===null?delete f[l]:f[l]=d},t._stringRef=l,t)}if(typeof e!="string")throw Error(qe(284));if(!n._owner)throw Error(qe(290,e))}return e}function hC(e,t){throw e=Object.prototype.toString.call(t),Error(qe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function z7(e){var t=e._init;return t(e._payload)}function Tie(e){function t(D,k){if(e){var M=D.deletions;M===null?(D.deletions=[k],D.flags|=16):M.push(k)}}function n(D,k){if(!e)return null;for(;k!==null;)t(D,k),k=k.sibling;return null}function i(D,k){for(D=new Map;k!==null;)k.key!==null?D.set(k.key,k):D.set(k.index,k),k=k.sibling;return D}function a(D,k){return D=uh(D,k),D.index=0,D.sibling=null,D}function l(D,k,M){return D.index=M,e?(M=D.alternate,M!==null?(M=M.index,M<k?(D.flags|=2,k):M):(D.flags|=2,k)):(D.flags|=1048576,k)}function d(D){return e&&D.alternate===null&&(D.flags|=2),D}function f(D,k,M,$){return k===null||k.tag!==6?(k=kk(M,D.mode,$),k.return=D,k):(k=a(k,M),k.return=D,k)}function m(D,k,M,$){var V=M.type;return V===gg?E(D,k,M.props.children,$,M.key):k!==null&&(k.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===Fd&&z7(V)===k.type)?($=a(k,M.props),$.ref=nE(D,k,M),$.return=D,$):($=oR(M.type,M.key,M.props,null,D.mode,$),$.ref=nE(D,k,M),$.return=D,$)}function v(D,k,M,$){return k===null||k.tag!==4||k.stateNode.containerInfo!==M.containerInfo||k.stateNode.implementation!==M.implementation?(k=Lk(M,D.mode,$),k.return=D,k):(k=a(k,M.children||[]),k.return=D,k)}function E(D,k,M,$,V){return k===null||k.tag!==7?(k=sp(M,D.mode,$,V),k.return=D,k):(k=a(k,M),k.return=D,k)}function S(D,k,M){if(typeof k=="string"&&k!==""||typeof k=="number")return k=kk(""+k,D.mode,M),k.return=D,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case tC:return M=oR(k.type,k.key,k.props,null,D.mode,M),M.ref=nE(D,null,k),M.return=D,M;case mg:return k=Lk(k,D.mode,M),k.return=D,k;case Fd:var $=k._init;return S(D,$(k._payload),M)}if(SE(k)||J_(k))return k=sp(k,D.mode,M,null),k.return=D,k;hC(D,k)}return null}function T(D,k,M,$){var V=k!==null?k.key:null;if(typeof M=="string"&&M!==""||typeof M=="number")return V!==null?null:f(D,k,""+M,$);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case tC:return M.key===V?m(D,k,M,$):null;case mg:return M.key===V?v(D,k,M,$):null;case Fd:return V=M._init,T(D,k,V(M._payload),$)}if(SE(M)||J_(M))return V!==null?null:E(D,k,M,$,null);hC(D,M)}return null}function R(D,k,M,$,V){if(typeof $=="string"&&$!==""||typeof $=="number")return D=D.get(M)||null,f(k,D,""+$,V);if(typeof $=="object"&&$!==null){switch($.$$typeof){case tC:return D=D.get($.key===null?M:$.key)||null,m(k,D,$,V);case mg:return D=D.get($.key===null?M:$.key)||null,v(k,D,$,V);case Fd:var W=$._init;return R(D,k,M,W($._payload),V)}if(SE($)||J_($))return D=D.get(M)||null,E(k,D,$,V,null);hC(k,$)}return null}function I(D,k,M,$){for(var V=null,W=null,H=k,J=k=0,ee=null;H!==null&&J<M.length;J++){H.index>J?(ee=H,H=null):ee=H.sibling;var le=T(D,H,M[J],$);if(le===null){H===null&&(H=ee);break}e&&H&&le.alternate===null&&t(D,H),k=l(le,k,J),W===null?V=le:W.sibling=le,W=le,H=ee}if(J===M.length)return n(D,H),Br&&kf(D,J),V;if(H===null){for(;J<M.length;J++)H=S(D,M[J],$),H!==null&&(k=l(H,k,J),W===null?V=H:W.sibling=H,W=H);return Br&&kf(D,J),V}for(H=i(D,H);J<M.length;J++)ee=R(H,D,J,M[J],$),ee!==null&&(e&&ee.alternate!==null&&H.delete(ee.key===null?J:ee.key),k=l(ee,k,J),W===null?V=ee:W.sibling=ee,W=ee);return e&&H.forEach(function(he){return t(D,he)}),Br&&kf(D,J),V}function O(D,k,M,$){var V=J_(M);if(typeof V!="function")throw Error(qe(150));if(M=V.call(M),M==null)throw Error(qe(151));for(var W=V=null,H=k,J=k=0,ee=null,le=M.next();H!==null&&!le.done;J++,le=M.next()){H.index>J?(ee=H,H=null):ee=H.sibling;var he=T(D,H,le.value,$);if(he===null){H===null&&(H=ee);break}e&&H&&he.alternate===null&&t(D,H),k=l(he,k,J),W===null?V=he:W.sibling=he,W=he,H=ee}if(le.done)return n(D,H),Br&&kf(D,J),V;if(H===null){for(;!le.done;J++,le=M.next())le=S(D,le.value,$),le!==null&&(k=l(le,k,J),W===null?V=le:W.sibling=le,W=le);return Br&&kf(D,J),V}for(H=i(D,H);!le.done;J++,le=M.next())le=R(H,D,J,le.value,$),le!==null&&(e&&le.alternate!==null&&H.delete(le.key===null?J:le.key),k=l(le,k,J),W===null?V=le:W.sibling=le,W=le);return e&&H.forEach(function(de){return t(D,de)}),Br&&kf(D,J),V}function P(D,k,M,$){if(typeof M=="object"&&M!==null&&M.type===gg&&M.key===null&&(M=M.props.children),typeof M=="object"&&M!==null){switch(M.$$typeof){case tC:e:{for(var V=M.key,W=k;W!==null;){if(W.key===V){if(V=M.type,V===gg){if(W.tag===7){n(D,W.sibling),k=a(W,M.props.children),k.return=D,D=k;break e}}else if(W.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===Fd&&z7(V)===W.type){n(D,W.sibling),k=a(W,M.props),k.ref=nE(D,W,M),k.return=D,D=k;break e}n(D,W);break}else t(D,W);W=W.sibling}M.type===gg?(k=sp(M.props.children,D.mode,$,M.key),k.return=D,D=k):($=oR(M.type,M.key,M.props,null,D.mode,$),$.ref=nE(D,k,M),$.return=D,D=$)}return d(D);case mg:e:{for(W=M.key;k!==null;){if(k.key===W)if(k.tag===4&&k.stateNode.containerInfo===M.containerInfo&&k.stateNode.implementation===M.implementation){n(D,k.sibling),k=a(k,M.children||[]),k.return=D,D=k;break e}else{n(D,k);break}else t(D,k);k=k.sibling}k=Lk(M,D.mode,$),k.return=D,D=k}return d(D);case Fd:return W=M._init,P(D,k,W(M._payload),$)}if(SE(M))return I(D,k,M,$);if(J_(M))return O(D,k,M,$);hC(D,M)}return typeof M=="string"&&M!==""||typeof M=="number"?(M=""+M,k!==null&&k.tag===6?(n(D,k.sibling),k=a(k,M),k.return=D,D=k):(n(D,k),k=kk(M,D.mode,$),k.return=D,D=k),d(D)):n(D,k)}return P}var cv=Tie(!0),Cie=Tie(!1),IR=Rh(null),xR=null,Tg=null,$U=null;function WU(){$U=Tg=xR=null}function GU(e){var t=IR.current;kr(IR),e._currentValue=t}function xM(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Bg(e,t){xR=e,$U=Tg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ps=!0),e.firstContext=null)}function $a(e){var t=e._currentValue;if($U!==e)if(e={context:e,memoizedValue:t,next:null},Tg===null){if(xR===null)throw Error(qe(308));Tg=e,xR.dependencies={lanes:0,firstContext:e}}else Tg=Tg.next=e;return t}var zf=null;function HU(e){zf===null?zf=[e]:zf.push(e)}function Rie(e,t,n,i){var a=t.interleaved;return a===null?(n.next=n,HU(t)):(n.next=a.next,a.next=n),t.interleaved=n,Lu(e,i)}function Lu(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Bd=!1;function KU(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Aie(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Eu(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ah(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,kn&2){var a=i.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),i.pending=t,Lu(e,n)}return a=i.interleaved,a===null?(t.next=t,HU(i)):(t.next=a.next,a.next=t),i.interleaved=t,Lu(e,n)}function ZC(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,PU(e,n)}}function Y7(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var a=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var d={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?a=l=d:l=l.next=d,n=n.next}while(n!==null);l===null?a=l=t:l=l.next=t}else a=l=t;n={baseState:i.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:i.shared,effects:i.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function PR(e,t,n,i){var a=e.updateQueue;Bd=!1;var l=a.firstBaseUpdate,d=a.lastBaseUpdate,f=a.shared.pending;if(f!==null){a.shared.pending=null;var m=f,v=m.next;m.next=null,d===null?l=v:d.next=v,d=m;var E=e.alternate;E!==null&&(E=E.updateQueue,f=E.lastBaseUpdate,f!==d&&(f===null?E.firstBaseUpdate=v:f.next=v,E.lastBaseUpdate=m))}if(l!==null){var S=a.baseState;d=0,E=v=m=null,f=l;do{var T=f.lane,R=f.eventTime;if((i&T)===T){E!==null&&(E=E.next={eventTime:R,lane:0,tag:f.tag,payload:f.payload,callback:f.callback,next:null});e:{var I=e,O=f;switch(T=t,R=n,O.tag){case 1:if(I=O.payload,typeof I=="function"){S=I.call(R,S,T);break e}S=I;break e;case 3:I.flags=I.flags&-65537|128;case 0:if(I=O.payload,T=typeof I=="function"?I.call(R,S,T):I,T==null)break e;S=ti({},S,T);break e;case 2:Bd=!0}}f.callback!==null&&f.lane!==0&&(e.flags|=64,T=a.effects,T===null?a.effects=[f]:T.push(f))}else R={eventTime:R,lane:T,tag:f.tag,payload:f.payload,callback:f.callback,next:null},E===null?(v=E=R,m=S):E=E.next=R,d|=T;if(f=f.next,f===null){if(f=a.shared.pending,f===null)break;T=f,f=T.next,T.next=null,a.lastBaseUpdate=T,a.shared.pending=null}}while(!0);if(E===null&&(m=S),a.baseState=m,a.firstBaseUpdate=v,a.lastBaseUpdate=E,t=a.shared.interleaved,t!==null){a=t;do d|=a.lane,a=a.next;while(a!==t)}else l===null&&(a.shared.lanes=0);pp|=d,e.lanes=d,e.memoizedState=S}}function q7(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],a=i.callback;if(a!==null){if(i.callback=null,i=n,typeof a!="function")throw Error(qe(191,a));a.call(i)}}}var RS={},wl=Rh(RS),gb=Rh(RS),vb=Rh(RS);function Yf(e){if(e===RS)throw Error(qe(174));return e}function zU(e,t){switch(Sr(vb,t),Sr(gb,e),Sr(wl,RS),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:uM(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=uM(t,e)}kr(wl),Sr(wl,t)}function lv(){kr(wl),kr(gb),kr(vb)}function Oie(e){Yf(vb.current);var t=Yf(wl.current),n=uM(t,e.type);t!==n&&(Sr(gb,e),Sr(wl,n))}function YU(e){gb.current===e&&(kr(wl),kr(gb))}var Jr=Rh(0);function NR(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ok=[];function qU(){for(var e=0;e<Ok.length;e++)Ok[e]._workInProgressVersionPrimary=null;Ok.length=0}var eR=Gu.ReactCurrentDispatcher,Ik=Gu.ReactCurrentBatchConfig,fp=0,ei=null,ki=null,zi=null,DR=!1,UE=!1,yb=0,qDe=0;function yo(){throw Error(qe(321))}function XU(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Nc(e[n],t[n]))return!1;return!0}function JU(e,t,n,i,a,l){if(fp=l,ei=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,eR.current=e===null||e.memoizedState===null?ZDe:eke,e=n(i,a),UE){l=0;do{if(UE=!1,yb=0,25<=l)throw Error(qe(301));l+=1,zi=ki=null,t.updateQueue=null,eR.current=tke,e=n(i,a)}while(UE)}if(eR.current=kR,t=ki!==null&&ki.next!==null,fp=0,zi=ki=ei=null,DR=!1,t)throw Error(qe(300));return e}function QU(){var e=yb!==0;return yb=0,e}function hl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zi===null?ei.memoizedState=zi=e:zi=zi.next=e,zi}function Wa(){if(ki===null){var e=ei.alternate;e=e!==null?e.memoizedState:null}else e=ki.next;var t=zi===null?ei.memoizedState:zi.next;if(t!==null)zi=t,ki=e;else{if(e===null)throw Error(qe(310));ki=e,e={memoizedState:ki.memoizedState,baseState:ki.baseState,baseQueue:ki.baseQueue,queue:ki.queue,next:null},zi===null?ei.memoizedState=zi=e:zi=zi.next=e}return zi}function _b(e,t){return typeof t=="function"?t(e):t}function xk(e){var t=Wa(),n=t.queue;if(n===null)throw Error(qe(311));n.lastRenderedReducer=e;var i=ki,a=i.baseQueue,l=n.pending;if(l!==null){if(a!==null){var d=a.next;a.next=l.next,l.next=d}i.baseQueue=a=l,n.pending=null}if(a!==null){l=a.next,i=i.baseState;var f=d=null,m=null,v=l;do{var E=v.lane;if((fp&E)===E)m!==null&&(m=m.next={lane:0,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null}),i=v.hasEagerState?v.eagerState:e(i,v.action);else{var S={lane:E,action:v.action,hasEagerState:v.hasEagerState,eagerState:v.eagerState,next:null};m===null?(f=m=S,d=i):m=m.next=S,ei.lanes|=E,pp|=E}v=v.next}while(v!==null&&v!==l);m===null?d=i:m.next=f,Nc(i,t.memoizedState)||(ps=!0),t.memoizedState=i,t.baseState=d,t.baseQueue=m,n.lastRenderedState=i}if(e=n.interleaved,e!==null){a=e;do l=a.lane,ei.lanes|=l,pp|=l,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Pk(e){var t=Wa(),n=t.queue;if(n===null)throw Error(qe(311));n.lastRenderedReducer=e;var i=n.dispatch,a=n.pending,l=t.memoizedState;if(a!==null){n.pending=null;var d=a=a.next;do l=e(l,d.action),d=d.next;while(d!==a);Nc(l,t.memoizedState)||(ps=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),n.lastRenderedState=l}return[l,i]}function Iie(){}function xie(e,t){var n=ei,i=Wa(),a=t(),l=!Nc(i.memoizedState,a);if(l&&(i.memoizedState=a,ps=!0),i=i.queue,ZU(Die.bind(null,n,i,e),[e]),i.getSnapshot!==t||l||zi!==null&&zi.memoizedState.tag&1){if(n.flags|=2048,Eb(9,Nie.bind(null,n,i,a,t),void 0,null),qi===null)throw Error(qe(349));fp&30||Pie(n,t,a)}return a}function Pie(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ei.updateQueue,t===null?(t={lastEffect:null,stores:null},ei.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Nie(e,t,n,i){t.value=n,t.getSnapshot=i,kie(t)&&Lie(e)}function Die(e,t,n){return n(function(){kie(t)&&Lie(e)})}function kie(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Nc(e,n)}catch{return!0}}function Lie(e){var t=Lu(e,1);t!==null&&Pc(t,e,1,-1)}function X7(e){var t=hl();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_b,lastRenderedState:e},t.queue=e,e=e.dispatch=QDe.bind(null,ei,e),[t.memoizedState,e]}function Eb(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},t=ei.updateQueue,t===null?(t={lastEffect:null,stores:null},ei.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e)),e}function Mie(){return Wa().memoizedState}function tR(e,t,n,i){var a=hl();ei.flags|=e,a.memoizedState=Eb(1|t,n,void 0,i===void 0?null:i)}function fO(e,t,n,i){var a=Wa();i=i===void 0?null:i;var l=void 0;if(ki!==null){var d=ki.memoizedState;if(l=d.destroy,i!==null&&XU(i,d.deps)){a.memoizedState=Eb(t,n,l,i);return}}ei.flags|=e,a.memoizedState=Eb(1|t,n,l,i)}function J7(e,t){return tR(8390656,8,e,t)}function ZU(e,t){return fO(2048,8,e,t)}function jie(e,t){return fO(4,2,e,t)}function Uie(e,t){return fO(4,4,e,t)}function Vie(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Fie(e,t,n){return n=n!=null?n.concat([e]):null,fO(4,4,Vie.bind(null,t,e),n)}function eV(){}function Bie(e,t){var n=Wa();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&XU(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function $ie(e,t){var n=Wa();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&XU(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function Wie(e,t,n){return fp&21?(Nc(n,t)||(n=Yre(),ei.lanes|=n,pp|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ps=!0),e.memoizedState=n)}function XDe(e,t){var n=tr;tr=n!==0&&4>n?n:4,e(!0);var i=Ik.transition;Ik.transition={};try{e(!1),t()}finally{tr=n,Ik.transition=i}}function Gie(){return Wa().memoizedState}function JDe(e,t,n){var i=lh(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},Hie(e))Kie(t,n);else if(n=Rie(e,t,n,i),n!==null){var a=Go();Pc(n,e,i,a),zie(n,t,i)}}function QDe(e,t,n){var i=lh(e),a={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(Hie(e))Kie(t,a);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var d=t.lastRenderedState,f=l(d,n);if(a.hasEagerState=!0,a.eagerState=f,Nc(f,d)){var m=t.interleaved;m===null?(a.next=a,HU(t)):(a.next=m.next,m.next=a),t.interleaved=a;return}}catch{}finally{}n=Rie(e,t,a,i),n!==null&&(a=Go(),Pc(n,e,i,a),zie(n,t,i))}}function Hie(e){var t=e.alternate;return e===ei||t!==null&&t===ei}function Kie(e,t){UE=DR=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function zie(e,t,n){if(n&4194240){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,PU(e,n)}}var kR={readContext:$a,useCallback:yo,useContext:yo,useEffect:yo,useImperativeHandle:yo,useInsertionEffect:yo,useLayoutEffect:yo,useMemo:yo,useReducer:yo,useRef:yo,useState:yo,useDebugValue:yo,useDeferredValue:yo,useTransition:yo,useMutableSource:yo,useSyncExternalStore:yo,useId:yo,unstable_isNewReconciler:!1},ZDe={readContext:$a,useCallback:function(e,t){return hl().memoizedState=[e,t===void 0?null:t],e},useContext:$a,useEffect:J7,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,tR(4194308,4,Vie.bind(null,t,e),n)},useLayoutEffect:function(e,t){return tR(4194308,4,e,t)},useInsertionEffect:function(e,t){return tR(4,2,e,t)},useMemo:function(e,t){var n=hl();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=hl();return t=n!==void 0?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=JDe.bind(null,ei,e),[i.memoizedState,e]},useRef:function(e){var t=hl();return e={current:e},t.memoizedState=e},useState:X7,useDebugValue:eV,useDeferredValue:function(e){return hl().memoizedState=e},useTransition:function(){var e=X7(!1),t=e[0];return e=XDe.bind(null,e[1]),hl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=ei,a=hl();if(Br){if(n===void 0)throw Error(qe(407));n=n()}else{if(n=t(),qi===null)throw Error(qe(349));fp&30||Pie(i,t,n)}a.memoizedState=n;var l={value:n,getSnapshot:t};return a.queue=l,J7(Die.bind(null,i,l,e),[e]),i.flags|=2048,Eb(9,Nie.bind(null,i,l,n,t),void 0,null),n},useId:function(){var e=hl(),t=qi.identifierPrefix;if(Br){var n=mu,i=pu;n=(i&~(1<<32-xc(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=yb++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=qDe++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},eke={readContext:$a,useCallback:Bie,useContext:$a,useEffect:ZU,useImperativeHandle:Fie,useInsertionEffect:jie,useLayoutEffect:Uie,useMemo:$ie,useReducer:xk,useRef:Mie,useState:function(){return xk(_b)},useDebugValue:eV,useDeferredValue:function(e){var t=Wa();return Wie(t,ki.memoizedState,e)},useTransition:function(){var e=xk(_b)[0],t=Wa().memoizedState;return[e,t]},useMutableSource:Iie,useSyncExternalStore:xie,useId:Gie,unstable_isNewReconciler:!1},tke={readContext:$a,useCallback:Bie,useContext:$a,useEffect:ZU,useImperativeHandle:Fie,useInsertionEffect:jie,useLayoutEffect:Uie,useMemo:$ie,useReducer:Pk,useRef:Mie,useState:function(){return Pk(_b)},useDebugValue:eV,useDeferredValue:function(e){var t=Wa();return ki===null?t.memoizedState=e:Wie(t,ki.memoizedState,e)},useTransition:function(){var e=Pk(_b)[0],t=Wa().memoizedState;return[e,t]},useMutableSource:Iie,useSyncExternalStore:xie,useId:Gie,unstable_isNewReconciler:!1};function _c(e,t){if(e&&e.defaultProps){t=ti({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function PM(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:ti({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var pO={isMounted:function(e){return(e=e._reactInternals)?Op(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Go(),a=lh(e),l=Eu(i,a);l.payload=t,n!=null&&(l.callback=n),t=ah(e,l,a),t!==null&&(Pc(t,e,a,i),ZC(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Go(),a=lh(e),l=Eu(i,a);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=ah(e,l,a),t!==null&&(Pc(t,e,a,i),ZC(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Go(),i=lh(e),a=Eu(n,i);a.tag=2,t!=null&&(a.callback=t),t=ah(e,a,i),t!==null&&(Pc(t,e,i,n),ZC(t,e,i))}};function Q7(e,t,n,i,a,l,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,l,d):t.prototype&&t.prototype.isPureReactComponent?!hb(n,i)||!hb(a,l):!0}function Yie(e,t,n){var i=!1,a=_h,l=t.contextType;return typeof l=="object"&&l!==null?l=$a(l):(a=Es(t)?dp:Ro.current,i=t.contextTypes,l=(i=i!=null)?sv(e,a):_h),t=new t(n,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=pO,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=l),t}function Z7(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&pO.enqueueReplaceState(t,t.state,null)}function NM(e,t,n,i){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},KU(e);var l=t.contextType;typeof l=="object"&&l!==null?a.context=$a(l):(l=Es(t)?dp:Ro.current,a.context=sv(e,l)),a.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(PM(e,t,l,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&pO.enqueueReplaceState(a,a.state,null),PR(e,n,a,i),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function uv(e,t){try{var n="",i=t;do n+=I1e(i),i=i.return;while(i);var a=n}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:a,digest:null}}function Nk(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function DM(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var nke=typeof WeakMap=="function"?WeakMap:Map;function qie(e,t,n){n=Eu(-1,n),n.tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){MR||(MR=!0,WM=i),DM(e,t)},n}function Xie(e,t,n){n=Eu(-1,n),n.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var a=t.value;n.payload=function(){return i(a)},n.callback=function(){DM(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){DM(e,t),typeof i!="function"&&(ch===null?ch=new Set([this]):ch.add(this));var d=t.stack;this.componentDidCatch(t.value,{componentStack:d!==null?d:""})}),n}function eX(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new nke;var a=new Set;i.set(t,a)}else a=i.get(t),a===void 0&&(a=new Set,i.set(t,a));a.has(n)||(a.add(n),e=gke.bind(null,e,t,n),t.then(e,e))}function tX(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function nX(e,t,n,i,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Eu(-1,1),t.tag=2,ah(n,t,1))),n.lanes|=1),e)}var rke=Gu.ReactCurrentOwner,ps=!1;function Uo(e,t,n,i){t.child=e===null?Cie(t,null,n,i):cv(t,e.child,n,i)}function rX(e,t,n,i,a){n=n.render;var l=t.ref;return Bg(t,a),i=JU(e,t,n,i,l,a),n=QU(),e!==null&&!ps?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Mu(e,t,a)):(Br&&n&&VU(t),t.flags|=1,Uo(e,t,i,a),t.child)}function iX(e,t,n,i,a){if(e===null){var l=n.type;return typeof l=="function"&&!cV(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=l,Jie(e,t,l,i,a)):(e=oR(n.type,null,i,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&a)){var d=l.memoizedProps;if(n=n.compare,n=n!==null?n:hb,n(d,i)&&e.ref===t.ref)return Mu(e,t,a)}return t.flags|=1,e=uh(l,i),e.ref=t.ref,e.return=t,t.child=e}function Jie(e,t,n,i,a){if(e!==null){var l=e.memoizedProps;if(hb(l,i)&&e.ref===t.ref)if(ps=!1,t.pendingProps=i=l,(e.lanes&a)!==0)e.flags&131072&&(ps=!0);else return t.lanes=e.lanes,Mu(e,t,a)}return kM(e,t,n,i,a)}function Qie(e,t,n){var i=t.pendingProps,a=i.children,l=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Sr(Rg,Bs),Bs|=n;else{if(!(n&1073741824))return e=l!==null?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Sr(Rg,Bs),Bs|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=l!==null?l.baseLanes:n,Sr(Rg,Bs),Bs|=i}else l!==null?(i=l.baseLanes|n,t.memoizedState=null):i=n,Sr(Rg,Bs),Bs|=i;return Uo(e,t,a,n),t.child}function Zie(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function kM(e,t,n,i,a){var l=Es(n)?dp:Ro.current;return l=sv(t,l),Bg(t,a),n=JU(e,t,n,i,l,a),i=QU(),e!==null&&!ps?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Mu(e,t,a)):(Br&&i&&VU(t),t.flags|=1,Uo(e,t,n,a),t.child)}function oX(e,t,n,i,a){if(Es(n)){var l=!0;RR(t)}else l=!1;if(Bg(t,a),t.stateNode===null)nR(e,t),Yie(t,n,i),NM(t,n,i,a),i=!0;else if(e===null){var d=t.stateNode,f=t.memoizedProps;d.props=f;var m=d.context,v=n.contextType;typeof v=="object"&&v!==null?v=$a(v):(v=Es(n)?dp:Ro.current,v=sv(t,v));var E=n.getDerivedStateFromProps,S=typeof E=="function"||typeof d.getSnapshotBeforeUpdate=="function";S||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(f!==i||m!==v)&&Z7(t,d,i,v),Bd=!1;var T=t.memoizedState;d.state=T,PR(t,i,d,a),m=t.memoizedState,f!==i||T!==m||_s.current||Bd?(typeof E=="function"&&(PM(t,n,E,i),m=t.memoizedState),(f=Bd||Q7(t,n,f,i,T,m,v))?(S||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(t.flags|=4194308)):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=m),d.props=i,d.state=m,d.context=v,i=f):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{d=t.stateNode,Aie(e,t),f=t.memoizedProps,v=t.type===t.elementType?f:_c(t.type,f),d.props=v,S=t.pendingProps,T=d.context,m=n.contextType,typeof m=="object"&&m!==null?m=$a(m):(m=Es(n)?dp:Ro.current,m=sv(t,m));var R=n.getDerivedStateFromProps;(E=typeof R=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(f!==S||T!==m)&&Z7(t,d,i,m),Bd=!1,T=t.memoizedState,d.state=T,PR(t,i,d,a);var I=t.memoizedState;f!==S||T!==I||_s.current||Bd?(typeof R=="function"&&(PM(t,n,R,i),I=t.memoizedState),(v=Bd||Q7(t,n,v,i,T,I,m)||!1)?(E||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(i,I,m),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(i,I,m)),typeof d.componentDidUpdate=="function"&&(t.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof d.componentDidUpdate!="function"||f===e.memoizedProps&&T===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||f===e.memoizedProps&&T===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=I),d.props=i,d.state=I,d.context=m,i=v):(typeof d.componentDidUpdate!="function"||f===e.memoizedProps&&T===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||f===e.memoizedProps&&T===e.memoizedState||(t.flags|=1024),i=!1)}return LM(e,t,n,i,l,a)}function LM(e,t,n,i,a,l){Zie(e,t);var d=(t.flags&128)!==0;if(!i&&!d)return a&&G7(t,n,!1),Mu(e,t,l);i=t.stateNode,rke.current=t;var f=d&&typeof n.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&d?(t.child=cv(t,e.child,null,l),t.child=cv(t,null,f,l)):Uo(e,t,f,l),t.memoizedState=i.state,a&&G7(t,n,!0),t.child}function eoe(e){var t=e.stateNode;t.pendingContext?W7(e,t.pendingContext,t.pendingContext!==t.context):t.context&&W7(e,t.context,!1),zU(e,t.containerInfo)}function sX(e,t,n,i,a){return av(),BU(a),t.flags|=256,Uo(e,t,n,i),t.child}var MM={dehydrated:null,treeContext:null,retryLane:0};function jM(e){return{baseLanes:e,cachePool:null,transitions:null}}function toe(e,t,n){var i=t.pendingProps,a=Jr.current,l=!1,d=(t.flags&128)!==0,f;if((f=d)||(f=e!==null&&e.memoizedState===null?!1:(a&2)!==0),f?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Sr(Jr,a&1),e===null)return IM(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(d=i.children,e=i.fallback,l?(i=t.mode,l=t.child,d={mode:"hidden",children:d},!(i&1)&&l!==null?(l.childLanes=0,l.pendingProps=d):l=vO(d,i,0,null),e=sp(e,i,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=jM(n),t.memoizedState=MM,e):tV(t,d));if(a=e.memoizedState,a!==null&&(f=a.dehydrated,f!==null))return ike(e,t,d,i,f,a,n);if(l){l=i.fallback,d=t.mode,a=e.child,f=a.sibling;var m={mode:"hidden",children:i.children};return!(d&1)&&t.child!==a?(i=t.child,i.childLanes=0,i.pendingProps=m,t.deletions=null):(i=uh(a,m),i.subtreeFlags=a.subtreeFlags&14680064),f!==null?l=uh(f,l):(l=sp(l,d,n,null),l.flags|=2),l.return=t,i.return=t,i.sibling=l,t.child=i,i=l,l=t.child,d=e.child.memoizedState,d=d===null?jM(n):{baseLanes:d.baseLanes|n,cachePool:null,transitions:d.transitions},l.memoizedState=d,l.childLanes=e.childLanes&~n,t.memoizedState=MM,i}return l=e.child,e=l.sibling,i=uh(l,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=n),i.return=t,i.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function tV(e,t){return t=vO({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function fC(e,t,n,i){return i!==null&&BU(i),cv(t,e.child,null,n),e=tV(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function ike(e,t,n,i,a,l,d){if(n)return t.flags&256?(t.flags&=-257,i=Nk(Error(qe(422))),fC(e,t,d,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=i.fallback,a=t.mode,i=vO({mode:"visible",children:i.children},a,0,null),l=sp(l,a,d,null),l.flags|=2,i.return=t,l.return=t,i.sibling=l,t.child=i,t.mode&1&&cv(t,e.child,null,d),t.child.memoizedState=jM(d),t.memoizedState=MM,l);if(!(t.mode&1))return fC(e,t,d,null);if(a.data==="$!"){if(i=a.nextSibling&&a.nextSibling.dataset,i)var f=i.dgst;return i=f,l=Error(qe(419)),i=Nk(l,i,void 0),fC(e,t,d,i)}if(f=(d&e.childLanes)!==0,ps||f){if(i=qi,i!==null){switch(d&-d){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(i.suspendedLanes|d)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,Lu(e,a),Pc(i,e,a,-1))}return aV(),i=Nk(Error(qe(421))),fC(e,t,d,i)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=vke.bind(null,e),a._reactRetry=t,null):(e=l.treeContext,Hs=sh(a.nextSibling),Ks=t,Br=!0,Rc=null,e!==null&&(Da[ka++]=pu,Da[ka++]=mu,Da[ka++]=hp,pu=e.id,mu=e.overflow,hp=t),t=tV(t,i.children),t.flags|=4096,t)}function aX(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),xM(e.return,t,n)}function Dk(e,t,n,i,a){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:a}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=i,l.tail=n,l.tailMode=a)}function noe(e,t,n){var i=t.pendingProps,a=i.revealOrder,l=i.tail;if(Uo(e,t,i.children,n),i=Jr.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&aX(e,n,t);else if(e.tag===19)aX(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Sr(Jr,i),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&NR(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Dk(t,!1,a,n,l);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&NR(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Dk(t,!0,n,null,l);break;case"together":Dk(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function nR(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Mu(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),pp|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(qe(153));if(t.child!==null){for(e=t.child,n=uh(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=uh(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function oke(e,t,n){switch(t.tag){case 3:eoe(t),av();break;case 5:Oie(t);break;case 1:Es(t.type)&&RR(t);break;case 4:zU(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,a=t.memoizedProps.value;Sr(IR,i._currentValue),i._currentValue=a;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(Sr(Jr,Jr.current&1),t.flags|=128,null):n&t.child.childLanes?toe(e,t,n):(Sr(Jr,Jr.current&1),e=Mu(e,t,n),e!==null?e.sibling:null);Sr(Jr,Jr.current&1);break;case 19:if(i=(n&t.childLanes)!==0,e.flags&128){if(i)return noe(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Sr(Jr,Jr.current),i)break;return null;case 22:case 23:return t.lanes=0,Qie(e,t,n)}return Mu(e,t,n)}var roe,UM,ioe,ooe;roe=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};UM=function(){};ioe=function(e,t,n,i){var a=e.memoizedProps;if(a!==i){e=t.stateNode,Yf(wl.current);var l=null;switch(n){case"input":a=sM(e,a),i=sM(e,i),l=[];break;case"select":a=ti({},a,{value:void 0}),i=ti({},i,{value:void 0}),l=[];break;case"textarea":a=lM(e,a),i=lM(e,i),l=[];break;default:typeof a.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=TR)}dM(n,i);var d;n=null;for(v in a)if(!i.hasOwnProperty(v)&&a.hasOwnProperty(v)&&a[v]!=null)if(v==="style"){var f=a[v];for(d in f)f.hasOwnProperty(d)&&(n||(n={}),n[d]="")}else v!=="dangerouslySetInnerHTML"&&v!=="children"&&v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(ob.hasOwnProperty(v)?l||(l=[]):(l=l||[]).push(v,null));for(v in i){var m=i[v];if(f=a!=null?a[v]:void 0,i.hasOwnProperty(v)&&m!==f&&(m!=null||f!=null))if(v==="style")if(f){for(d in f)!f.hasOwnProperty(d)||m&&m.hasOwnProperty(d)||(n||(n={}),n[d]="");for(d in m)m.hasOwnProperty(d)&&f[d]!==m[d]&&(n||(n={}),n[d]=m[d])}else n||(l||(l=[]),l.push(v,n)),n=m;else v==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,f=f?f.__html:void 0,m!=null&&f!==m&&(l=l||[]).push(v,m)):v==="children"?typeof m!="string"&&typeof m!="number"||(l=l||[]).push(v,""+m):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&(ob.hasOwnProperty(v)?(m!=null&&v==="onScroll"&&xr("scroll",e),l||f===m||(l=[])):(l=l||[]).push(v,m))}n&&(l=l||[]).push("style",n);var v=l;(t.updateQueue=v)&&(t.flags|=4)}};ooe=function(e,t,n,i){n!==i&&(t.flags|=4)};function rE(e,t){if(!Br)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function _o(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,i|=a.subtreeFlags&14680064,i|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,i|=a.subtreeFlags,i|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function ske(e,t,n){var i=t.pendingProps;switch(FU(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _o(t),null;case 1:return Es(t.type)&&CR(),_o(t),null;case 3:return i=t.stateNode,lv(),kr(_s),kr(Ro),qU(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(dC(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Rc!==null&&(KM(Rc),Rc=null))),UM(e,t),_o(t),null;case 5:YU(t);var a=Yf(vb.current);if(n=t.type,e!==null&&t.stateNode!=null)ioe(e,t,n,i,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(qe(166));return _o(t),null}if(e=Yf(wl.current),dC(t)){i=t.stateNode,n=t.type;var l=t.memoizedProps;switch(i[gl]=t,i[mb]=l,e=(t.mode&1)!==0,n){case"dialog":xr("cancel",i),xr("close",i);break;case"iframe":case"object":case"embed":xr("load",i);break;case"video":case"audio":for(a=0;a<TE.length;a++)xr(TE[a],i);break;case"source":xr("error",i);break;case"img":case"image":case"link":xr("error",i),xr("load",i);break;case"details":xr("toggle",i);break;case"input":g7(i,l),xr("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!l.multiple},xr("invalid",i);break;case"textarea":y7(i,l),xr("invalid",i)}dM(n,l),a=null;for(var d in l)if(l.hasOwnProperty(d)){var f=l[d];d==="children"?typeof f=="string"?i.textContent!==f&&(l.suppressHydrationWarning!==!0&&uC(i.textContent,f,e),a=["children",f]):typeof f=="number"&&i.textContent!==""+f&&(l.suppressHydrationWarning!==!0&&uC(i.textContent,f,e),a=["children",""+f]):ob.hasOwnProperty(d)&&f!=null&&d==="onScroll"&&xr("scroll",i)}switch(n){case"input":nC(i),v7(i,l,!0);break;case"textarea":nC(i),_7(i);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(i.onclick=TR)}i=a,t.updateQueue=i,i!==null&&(t.flags|=4)}else{d=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Dre(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=d.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=d.createElement(n,{is:i.is}):(e=d.createElement(n),n==="select"&&(d=e,i.multiple?d.multiple=!0:i.size&&(d.size=i.size))):e=d.createElementNS(e,n),e[gl]=t,e[mb]=i,roe(e,t,!1,!1),t.stateNode=e;e:{switch(d=hM(n,i),n){case"dialog":xr("cancel",e),xr("close",e),a=i;break;case"iframe":case"object":case"embed":xr("load",e),a=i;break;case"video":case"audio":for(a=0;a<TE.length;a++)xr(TE[a],e);a=i;break;case"source":xr("error",e),a=i;break;case"img":case"image":case"link":xr("error",e),xr("load",e),a=i;break;case"details":xr("toggle",e),a=i;break;case"input":g7(e,i),a=sM(e,i),xr("invalid",e);break;case"option":a=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},a=ti({},i,{value:void 0}),xr("invalid",e);break;case"textarea":y7(e,i),a=lM(e,i),xr("invalid",e);break;default:a=i}dM(n,a),f=a;for(l in f)if(f.hasOwnProperty(l)){var m=f[l];l==="style"?Mre(e,m):l==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,m!=null&&kre(e,m)):l==="children"?typeof m=="string"?(n!=="textarea"||m!=="")&&sb(e,m):typeof m=="number"&&sb(e,""+m):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(ob.hasOwnProperty(l)?m!=null&&l==="onScroll"&&xr("scroll",e):m!=null&&CU(e,l,m,d))}switch(n){case"input":nC(e),v7(e,i,!1);break;case"textarea":nC(e),_7(e);break;case"option":i.value!=null&&e.setAttribute("value",""+yh(i.value));break;case"select":e.multiple=!!i.multiple,l=i.value,l!=null?jg(e,!!i.multiple,l,!1):i.defaultValue!=null&&jg(e,!!i.multiple,i.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=TR)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return _o(t),null;case 6:if(e&&t.stateNode!=null)ooe(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(qe(166));if(n=Yf(vb.current),Yf(wl.current),dC(t)){if(i=t.stateNode,n=t.memoizedProps,i[gl]=t,(l=i.nodeValue!==n)&&(e=Ks,e!==null))switch(e.tag){case 3:uC(i.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&uC(i.nodeValue,n,(e.mode&1)!==0)}l&&(t.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[gl]=t,t.stateNode=i}return _o(t),null;case 13:if(kr(Jr),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Br&&Hs!==null&&t.mode&1&&!(t.flags&128))wie(),av(),t.flags|=98560,l=!1;else if(l=dC(t),i!==null&&i.dehydrated!==null){if(e===null){if(!l)throw Error(qe(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(qe(317));l[gl]=t}else av(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;_o(t),l=!1}else Rc!==null&&(KM(Rc),Rc=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||Jr.current&1?Li===0&&(Li=3):aV())),t.updateQueue!==null&&(t.flags|=4),_o(t),null);case 4:return lv(),UM(e,t),e===null&&fb(t.stateNode.containerInfo),_o(t),null;case 10:return GU(t.type._context),_o(t),null;case 17:return Es(t.type)&&CR(),_o(t),null;case 19:if(kr(Jr),l=t.memoizedState,l===null)return _o(t),null;if(i=(t.flags&128)!==0,d=l.rendering,d===null)if(i)rE(l,!1);else{if(Li!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(d=NR(e),d!==null){for(t.flags|=128,rE(l,!1),i=d.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;n!==null;)l=n,e=i,l.flags&=14680066,d=l.alternate,d===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=d.childLanes,l.lanes=d.lanes,l.child=d.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=d.memoizedProps,l.memoizedState=d.memoizedState,l.updateQueue=d.updateQueue,l.type=d.type,e=d.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Sr(Jr,Jr.current&1|2),t.child}e=e.sibling}l.tail!==null&&yi()>dv&&(t.flags|=128,i=!0,rE(l,!1),t.lanes=4194304)}else{if(!i)if(e=NR(d),e!==null){if(t.flags|=128,i=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),rE(l,!0),l.tail===null&&l.tailMode==="hidden"&&!d.alternate&&!Br)return _o(t),null}else 2*yi()-l.renderingStartTime>dv&&n!==1073741824&&(t.flags|=128,i=!0,rE(l,!1),t.lanes=4194304);l.isBackwards?(d.sibling=t.child,t.child=d):(n=l.last,n!==null?n.sibling=d:t.child=d,l.last=d)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=yi(),t.sibling=null,n=Jr.current,Sr(Jr,i?n&1|2:n&1),t):(_o(t),null);case 22:case 23:return sV(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?Bs&1073741824&&(_o(t),t.subtreeFlags&6&&(t.flags|=8192)):_o(t),null;case 24:return null;case 25:return null}throw Error(qe(156,t.tag))}function ake(e,t){switch(FU(t),t.tag){case 1:return Es(t.type)&&CR(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return lv(),kr(_s),kr(Ro),qU(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return YU(t),null;case 13:if(kr(Jr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(qe(340));av()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return kr(Jr),null;case 4:return lv(),null;case 10:return GU(t.type._context),null;case 22:case 23:return sV(),null;case 24:return null;default:return null}}var pC=!1,wo=!1,cke=typeof WeakSet=="function"?WeakSet:Set,ht=null;function Cg(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){ui(e,t,i)}else n.current=null}function VM(e,t,n){try{n()}catch(i){ui(e,t,i)}}var cX=!1;function lke(e,t){if(SM=bR,e=uie(),UU(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var a=i.anchorOffset,l=i.focusNode;i=i.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var d=0,f=-1,m=-1,v=0,E=0,S=e,T=null;t:for(;;){for(var R;S!==n||a!==0&&S.nodeType!==3||(f=d+a),S!==l||i!==0&&S.nodeType!==3||(m=d+i),S.nodeType===3&&(d+=S.nodeValue.length),(R=S.firstChild)!==null;)T=S,S=R;for(;;){if(S===e)break t;if(T===n&&++v===a&&(f=d),T===l&&++E===i&&(m=d),(R=S.nextSibling)!==null)break;S=T,T=S.parentNode}S=R}n=f===-1||m===-1?null:{start:f,end:m}}else n=null}n=n||{start:0,end:0}}else n=null;for(wM={focusedElem:e,selectionRange:n},bR=!1,ht=t;ht!==null;)if(t=ht,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ht=e;else for(;ht!==null;){t=ht;try{var I=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(I!==null){var O=I.memoizedProps,P=I.memoizedState,D=t.stateNode,k=D.getSnapshotBeforeUpdate(t.elementType===t.type?O:_c(t.type,O),P);D.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var M=t.stateNode.containerInfo;M.nodeType===1?M.textContent="":M.nodeType===9&&M.documentElement&&M.removeChild(M.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(qe(163))}}catch($){ui(t,t.return,$)}if(e=t.sibling,e!==null){e.return=t.return,ht=e;break}ht=t.return}return I=cX,cX=!1,I}function VE(e,t,n){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&e)===e){var l=a.destroy;a.destroy=void 0,l!==void 0&&VM(t,n,l)}a=a.next}while(a!==i)}}function mO(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function FM(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function soe(e){var t=e.alternate;t!==null&&(e.alternate=null,soe(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[gl],delete t[mb],delete t[RM],delete t[HDe],delete t[KDe])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function aoe(e){return e.tag===5||e.tag===3||e.tag===4}function lX(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||aoe(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function BM(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=TR));else if(i!==4&&(e=e.child,e!==null))for(BM(e,t,n),e=e.sibling;e!==null;)BM(e,t,n),e=e.sibling}function $M(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for($M(e,t,n),e=e.sibling;e!==null;)$M(e,t,n),e=e.sibling}var oo=null,wc=!1;function Id(e,t,n){for(n=n.child;n!==null;)coe(e,t,n),n=n.sibling}function coe(e,t,n){if(Sl&&typeof Sl.onCommitFiberUnmount=="function")try{Sl.onCommitFiberUnmount(aO,n)}catch{}switch(n.tag){case 5:wo||Cg(n,t);case 6:var i=oo,a=wc;oo=null,Id(e,t,n),oo=i,wc=a,oo!==null&&(wc?(e=oo,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):oo.removeChild(n.stateNode));break;case 18:oo!==null&&(wc?(e=oo,n=n.stateNode,e.nodeType===8?Rk(e.parentNode,n):e.nodeType===1&&Rk(e,n),ub(e)):Rk(oo,n.stateNode));break;case 4:i=oo,a=wc,oo=n.stateNode.containerInfo,wc=!0,Id(e,t,n),oo=i,wc=a;break;case 0:case 11:case 14:case 15:if(!wo&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){a=i=i.next;do{var l=a,d=l.destroy;l=l.tag,d!==void 0&&(l&2||l&4)&&VM(n,t,d),a=a.next}while(a!==i)}Id(e,t,n);break;case 1:if(!wo&&(Cg(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(f){ui(n,t,f)}Id(e,t,n);break;case 21:Id(e,t,n);break;case 22:n.mode&1?(wo=(i=wo)||n.memoizedState!==null,Id(e,t,n),wo=i):Id(e,t,n);break;default:Id(e,t,n)}}function uX(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new cke),t.forEach(function(i){var a=yke.bind(null,e,i);n.has(i)||(n.add(i),i.then(a,a))})}}function fc(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var a=n[i];try{var l=e,d=t,f=d;e:for(;f!==null;){switch(f.tag){case 5:oo=f.stateNode,wc=!1;break e;case 3:oo=f.stateNode.containerInfo,wc=!0;break e;case 4:oo=f.stateNode.containerInfo,wc=!0;break e}f=f.return}if(oo===null)throw Error(qe(160));coe(l,d,a),oo=null,wc=!1;var m=a.alternate;m!==null&&(m.return=null),a.return=null}catch(v){ui(a,t,v)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)loe(t,e),t=t.sibling}function loe(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(fc(t,e),ul(e),i&4){try{VE(3,e,e.return),mO(3,e)}catch(O){ui(e,e.return,O)}try{VE(5,e,e.return)}catch(O){ui(e,e.return,O)}}break;case 1:fc(t,e),ul(e),i&512&&n!==null&&Cg(n,n.return);break;case 5:if(fc(t,e),ul(e),i&512&&n!==null&&Cg(n,n.return),e.flags&32){var a=e.stateNode;try{sb(a,"")}catch(O){ui(e,e.return,O)}}if(i&4&&(a=e.stateNode,a!=null)){var l=e.memoizedProps,d=n!==null?n.memoizedProps:l,f=e.type,m=e.updateQueue;if(e.updateQueue=null,m!==null)try{f==="input"&&l.type==="radio"&&l.name!=null&&Pre(a,l),hM(f,d);var v=hM(f,l);for(d=0;d<m.length;d+=2){var E=m[d],S=m[d+1];E==="style"?Mre(a,S):E==="dangerouslySetInnerHTML"?kre(a,S):E==="children"?sb(a,S):CU(a,E,S,v)}switch(f){case"input":aM(a,l);break;case"textarea":Nre(a,l);break;case"select":var T=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var R=l.value;R!=null?jg(a,!!l.multiple,R,!1):T!==!!l.multiple&&(l.defaultValue!=null?jg(a,!!l.multiple,l.defaultValue,!0):jg(a,!!l.multiple,l.multiple?[]:"",!1))}a[mb]=l}catch(O){ui(e,e.return,O)}}break;case 6:if(fc(t,e),ul(e),i&4){if(e.stateNode===null)throw Error(qe(162));a=e.stateNode,l=e.memoizedProps;try{a.nodeValue=l}catch(O){ui(e,e.return,O)}}break;case 3:if(fc(t,e),ul(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{ub(t.containerInfo)}catch(O){ui(e,e.return,O)}break;case 4:fc(t,e),ul(e);break;case 13:fc(t,e),ul(e),a=e.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(iV=yi())),i&4&&uX(e);break;case 22:if(E=n!==null&&n.memoizedState!==null,e.mode&1?(wo=(v=wo)||E,fc(t,e),wo=v):fc(t,e),ul(e),i&8192){if(v=e.memoizedState!==null,(e.stateNode.isHidden=v)&&!E&&e.mode&1)for(ht=e,E=e.child;E!==null;){for(S=ht=E;ht!==null;){switch(T=ht,R=T.child,T.tag){case 0:case 11:case 14:case 15:VE(4,T,T.return);break;case 1:Cg(T,T.return);var I=T.stateNode;if(typeof I.componentWillUnmount=="function"){i=T,n=T.return;try{t=i,I.props=t.memoizedProps,I.state=t.memoizedState,I.componentWillUnmount()}catch(O){ui(i,n,O)}}break;case 5:Cg(T,T.return);break;case 22:if(T.memoizedState!==null){hX(S);continue}}R!==null?(R.return=T,ht=R):hX(S)}E=E.sibling}e:for(E=null,S=e;;){if(S.tag===5){if(E===null){E=S;try{a=S.stateNode,v?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(f=S.stateNode,m=S.memoizedProps.style,d=m!=null&&m.hasOwnProperty("display")?m.display:null,f.style.display=Lre("display",d))}catch(O){ui(e,e.return,O)}}}else if(S.tag===6){if(E===null)try{S.stateNode.nodeValue=v?"":S.memoizedProps}catch(O){ui(e,e.return,O)}}else if((S.tag!==22&&S.tag!==23||S.memoizedState===null||S===e)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===e)break e;for(;S.sibling===null;){if(S.return===null||S.return===e)break e;E===S&&(E=null),S=S.return}E===S&&(E=null),S.sibling.return=S.return,S=S.sibling}}break;case 19:fc(t,e),ul(e),i&4&&uX(e);break;case 21:break;default:fc(t,e),ul(e)}}function ul(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(aoe(n)){var i=n;break e}n=n.return}throw Error(qe(160))}switch(i.tag){case 5:var a=i.stateNode;i.flags&32&&(sb(a,""),i.flags&=-33);var l=lX(e);$M(e,l,a);break;case 3:case 4:var d=i.stateNode.containerInfo,f=lX(e);BM(e,f,d);break;default:throw Error(qe(161))}}catch(m){ui(e,e.return,m)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function uke(e,t,n){ht=e,uoe(e)}function uoe(e,t,n){for(var i=(e.mode&1)!==0;ht!==null;){var a=ht,l=a.child;if(a.tag===22&&i){var d=a.memoizedState!==null||pC;if(!d){var f=a.alternate,m=f!==null&&f.memoizedState!==null||wo;f=pC;var v=wo;if(pC=d,(wo=m)&&!v)for(ht=a;ht!==null;)d=ht,m=d.child,d.tag===22&&d.memoizedState!==null?fX(a):m!==null?(m.return=d,ht=m):fX(a);for(;l!==null;)ht=l,uoe(l),l=l.sibling;ht=a,pC=f,wo=v}dX(e)}else a.subtreeFlags&8772&&l!==null?(l.return=a,ht=l):dX(e)}}function dX(e){for(;ht!==null;){var t=ht;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:wo||mO(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!wo)if(n===null)i.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:_c(t.type,n.memoizedProps);i.componentDidUpdate(a,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&q7(t,l,i);break;case 3:var d=t.updateQueue;if(d!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}q7(t,d,n)}break;case 5:var f=t.stateNode;if(n===null&&t.flags&4){n=f;var m=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":m.autoFocus&&n.focus();break;case"img":m.src&&(n.src=m.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var v=t.alternate;if(v!==null){var E=v.memoizedState;if(E!==null){var S=E.dehydrated;S!==null&&ub(S)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(qe(163))}wo||t.flags&512&&FM(t)}catch(T){ui(t,t.return,T)}}if(t===e){ht=null;break}if(n=t.sibling,n!==null){n.return=t.return,ht=n;break}ht=t.return}}function hX(e){for(;ht!==null;){var t=ht;if(t===e){ht=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ht=n;break}ht=t.return}}function fX(e){for(;ht!==null;){var t=ht;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{mO(4,t)}catch(m){ui(t,n,m)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var a=t.return;try{i.componentDidMount()}catch(m){ui(t,a,m)}}var l=t.return;try{FM(t)}catch(m){ui(t,l,m)}break;case 5:var d=t.return;try{FM(t)}catch(m){ui(t,d,m)}}}catch(m){ui(t,t.return,m)}if(t===e){ht=null;break}var f=t.sibling;if(f!==null){f.return=t.return,ht=f;break}ht=t.return}}var dke=Math.ceil,LR=Gu.ReactCurrentDispatcher,nV=Gu.ReactCurrentOwner,Va=Gu.ReactCurrentBatchConfig,kn=0,qi=null,Ci=null,ao=0,Bs=0,Rg=Rh(0),Li=0,bb=null,pp=0,gO=0,rV=0,FE=null,hs=null,iV=0,dv=1/0,lu=null,MR=!1,WM=null,ch=null,mC=!1,eh=null,jR=0,BE=0,GM=null,rR=-1,iR=0;function Go(){return kn&6?yi():rR!==-1?rR:rR=yi()}function lh(e){return e.mode&1?kn&2&&ao!==0?ao&-ao:YDe.transition!==null?(iR===0&&(iR=Yre()),iR):(e=tr,e!==0||(e=window.event,e=e===void 0?16:tie(e.type)),e):1}function Pc(e,t,n,i){if(50<BE)throw BE=0,GM=null,Error(qe(185));wS(e,n,i),(!(kn&2)||e!==qi)&&(e===qi&&(!(kn&2)&&(gO|=n),Li===4&&Kd(e,ao)),bs(e,i),n===1&&kn===0&&!(t.mode&1)&&(dv=yi()+500,hO&&Ah()))}function bs(e,t){var n=e.callbackNode;Y1e(e,t);var i=ER(e,e===qi?ao:0);if(i===0)n!==null&&S7(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(n!=null&&S7(n),t===1)e.tag===0?zDe(pX.bind(null,e)):Eie(pX.bind(null,e)),WDe(function(){!(kn&6)&&Ah()}),n=null;else{switch(qre(i)){case 1:n=xU;break;case 4:n=Kre;break;case 16:n=_R;break;case 536870912:n=zre;break;default:n=_R}n=yoe(n,doe.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function doe(e,t){if(rR=-1,iR=0,kn&6)throw Error(qe(327));var n=e.callbackNode;if($g()&&e.callbackNode!==n)return null;var i=ER(e,e===qi?ao:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=UR(e,i);else{t=i;var a=kn;kn|=2;var l=foe();(qi!==e||ao!==t)&&(lu=null,dv=yi()+500,op(e,t));do try{pke();break}catch(f){hoe(e,f)}while(!0);WU(),LR.current=l,kn=a,Ci!==null?t=0:(qi=null,ao=0,t=Li)}if(t!==0){if(t===2&&(a=vM(e),a!==0&&(i=a,t=HM(e,a))),t===1)throw n=bb,op(e,0),Kd(e,i),bs(e,yi()),n;if(t===6)Kd(e,i);else{if(a=e.current.alternate,!(i&30)&&!hke(a)&&(t=UR(e,i),t===2&&(l=vM(e),l!==0&&(i=l,t=HM(e,l))),t===1))throw n=bb,op(e,0),Kd(e,i),bs(e,yi()),n;switch(e.finishedWork=a,e.finishedLanes=i,t){case 0:case 1:throw Error(qe(345));case 2:Lf(e,hs,lu);break;case 3:if(Kd(e,i),(i&130023424)===i&&(t=iV+500-yi(),10<t)){if(ER(e,0)!==0)break;if(a=e.suspendedLanes,(a&i)!==i){Go(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=CM(Lf.bind(null,e,hs,lu),t);break}Lf(e,hs,lu);break;case 4:if(Kd(e,i),(i&4194240)===i)break;for(t=e.eventTimes,a=-1;0<i;){var d=31-xc(i);l=1<<d,d=t[d],d>a&&(a=d),i&=~l}if(i=a,i=yi()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*dke(i/1960))-i,10<i){e.timeoutHandle=CM(Lf.bind(null,e,hs,lu),i);break}Lf(e,hs,lu);break;case 5:Lf(e,hs,lu);break;default:throw Error(qe(329))}}}return bs(e,yi()),e.callbackNode===n?doe.bind(null,e):null}function HM(e,t){var n=FE;return e.current.memoizedState.isDehydrated&&(op(e,t).flags|=256),e=UR(e,t),e!==2&&(t=hs,hs=n,t!==null&&KM(t)),e}function KM(e){hs===null?hs=e:hs.push.apply(hs,e)}function hke(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var a=n[i],l=a.getSnapshot;a=a.value;try{if(!Nc(l(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Kd(e,t){for(t&=~rV,t&=~gO,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-xc(t),i=1<<n;e[n]=-1,t&=~i}}function pX(e){if(kn&6)throw Error(qe(327));$g();var t=ER(e,0);if(!(t&1))return bs(e,yi()),null;var n=UR(e,t);if(e.tag!==0&&n===2){var i=vM(e);i!==0&&(t=i,n=HM(e,i))}if(n===1)throw n=bb,op(e,0),Kd(e,t),bs(e,yi()),n;if(n===6)throw Error(qe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Lf(e,hs,lu),bs(e,yi()),null}function oV(e,t){var n=kn;kn|=1;try{return e(t)}finally{kn=n,kn===0&&(dv=yi()+500,hO&&Ah())}}function mp(e){eh!==null&&eh.tag===0&&!(kn&6)&&$g();var t=kn;kn|=1;var n=Va.transition,i=tr;try{if(Va.transition=null,tr=1,e)return e()}finally{tr=i,Va.transition=n,kn=t,!(kn&6)&&Ah()}}function sV(){Bs=Rg.current,kr(Rg)}function op(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,$De(n)),Ci!==null)for(n=Ci.return;n!==null;){var i=n;switch(FU(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&CR();break;case 3:lv(),kr(_s),kr(Ro),qU();break;case 5:YU(i);break;case 4:lv();break;case 13:kr(Jr);break;case 19:kr(Jr);break;case 10:GU(i.type._context);break;case 22:case 23:sV()}n=n.return}if(qi=e,Ci=e=uh(e.current,null),ao=Bs=t,Li=0,bb=null,rV=gO=pp=0,hs=FE=null,zf!==null){for(t=0;t<zf.length;t++)if(n=zf[t],i=n.interleaved,i!==null){n.interleaved=null;var a=i.next,l=n.pending;if(l!==null){var d=l.next;l.next=a,i.next=d}n.pending=i}zf=null}return e}function hoe(e,t){do{var n=Ci;try{if(WU(),eR.current=kR,DR){for(var i=ei.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}DR=!1}if(fp=0,zi=ki=ei=null,UE=!1,yb=0,nV.current=null,n===null||n.return===null){Li=1,bb=t,Ci=null;break}e:{var l=e,d=n.return,f=n,m=t;if(t=ao,f.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){var v=m,E=f,S=E.tag;if(!(E.mode&1)&&(S===0||S===11||S===15)){var T=E.alternate;T?(E.updateQueue=T.updateQueue,E.memoizedState=T.memoizedState,E.lanes=T.lanes):(E.updateQueue=null,E.memoizedState=null)}var R=tX(d);if(R!==null){R.flags&=-257,nX(R,d,f,l,t),R.mode&1&&eX(l,v,t),t=R,m=v;var I=t.updateQueue;if(I===null){var O=new Set;O.add(m),t.updateQueue=O}else I.add(m);break e}else{if(!(t&1)){eX(l,v,t),aV();break e}m=Error(qe(426))}}else if(Br&&f.mode&1){var P=tX(d);if(P!==null){!(P.flags&65536)&&(P.flags|=256),nX(P,d,f,l,t),BU(uv(m,f));break e}}l=m=uv(m,f),Li!==4&&(Li=2),FE===null?FE=[l]:FE.push(l),l=d;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var D=qie(l,m,t);Y7(l,D);break e;case 1:f=m;var k=l.type,M=l.stateNode;if(!(l.flags&128)&&(typeof k.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(ch===null||!ch.has(M)))){l.flags|=65536,t&=-t,l.lanes|=t;var $=Xie(l,f,t);Y7(l,$);break e}}l=l.return}while(l!==null)}moe(n)}catch(V){t=V,Ci===n&&n!==null&&(Ci=n=n.return);continue}break}while(!0)}function foe(){var e=LR.current;return LR.current=kR,e===null?kR:e}function aV(){(Li===0||Li===3||Li===2)&&(Li=4),qi===null||!(pp&268435455)&&!(gO&268435455)||Kd(qi,ao)}function UR(e,t){var n=kn;kn|=2;var i=foe();(qi!==e||ao!==t)&&(lu=null,op(e,t));do try{fke();break}catch(a){hoe(e,a)}while(!0);if(WU(),kn=n,LR.current=i,Ci!==null)throw Error(qe(261));return qi=null,ao=0,Li}function fke(){for(;Ci!==null;)poe(Ci)}function pke(){for(;Ci!==null&&!V1e();)poe(Ci)}function poe(e){var t=voe(e.alternate,e,Bs);e.memoizedProps=e.pendingProps,t===null?moe(e):Ci=t,nV.current=null}function moe(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=ake(n,t),n!==null){n.flags&=32767,Ci=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Li=6,Ci=null;return}}else if(n=ske(n,t,Bs),n!==null){Ci=n;return}if(t=t.sibling,t!==null){Ci=t;return}Ci=t=e}while(t!==null);Li===0&&(Li=5)}function Lf(e,t,n){var i=tr,a=Va.transition;try{Va.transition=null,tr=1,mke(e,t,n,i)}finally{Va.transition=a,tr=i}return null}function mke(e,t,n,i){do $g();while(eh!==null);if(kn&6)throw Error(qe(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(qe(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(q1e(e,l),e===qi&&(Ci=qi=null,ao=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||mC||(mC=!0,yoe(_R,function(){return $g(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=Va.transition,Va.transition=null;var d=tr;tr=1;var f=kn;kn|=4,nV.current=null,lke(e,n),loe(n,e),LDe(wM),bR=!!SM,wM=SM=null,e.current=n,uke(n),F1e(),kn=f,tr=d,Va.transition=l}else e.current=n;if(mC&&(mC=!1,eh=e,jR=a),l=e.pendingLanes,l===0&&(ch=null),W1e(n.stateNode),bs(e,yi()),t!==null)for(i=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],i(a.value,{componentStack:a.stack,digest:a.digest});if(MR)throw MR=!1,e=WM,WM=null,e;return jR&1&&e.tag!==0&&$g(),l=e.pendingLanes,l&1?e===GM?BE++:(BE=0,GM=e):BE=0,Ah(),null}function $g(){if(eh!==null){var e=qre(jR),t=Va.transition,n=tr;try{if(Va.transition=null,tr=16>e?16:e,eh===null)var i=!1;else{if(e=eh,eh=null,jR=0,kn&6)throw Error(qe(331));var a=kn;for(kn|=4,ht=e.current;ht!==null;){var l=ht,d=l.child;if(ht.flags&16){var f=l.deletions;if(f!==null){for(var m=0;m<f.length;m++){var v=f[m];for(ht=v;ht!==null;){var E=ht;switch(E.tag){case 0:case 11:case 15:VE(8,E,l)}var S=E.child;if(S!==null)S.return=E,ht=S;else for(;ht!==null;){E=ht;var T=E.sibling,R=E.return;if(soe(E),E===v){ht=null;break}if(T!==null){T.return=R,ht=T;break}ht=R}}}var I=l.alternate;if(I!==null){var O=I.child;if(O!==null){I.child=null;do{var P=O.sibling;O.sibling=null,O=P}while(O!==null)}}ht=l}}if(l.subtreeFlags&2064&&d!==null)d.return=l,ht=d;else e:for(;ht!==null;){if(l=ht,l.flags&2048)switch(l.tag){case 0:case 11:case 15:VE(9,l,l.return)}var D=l.sibling;if(D!==null){D.return=l.return,ht=D;break e}ht=l.return}}var k=e.current;for(ht=k;ht!==null;){d=ht;var M=d.child;if(d.subtreeFlags&2064&&M!==null)M.return=d,ht=M;else e:for(d=k;ht!==null;){if(f=ht,f.flags&2048)try{switch(f.tag){case 0:case 11:case 15:mO(9,f)}}catch(V){ui(f,f.return,V)}if(f===d){ht=null;break e}var $=f.sibling;if($!==null){$.return=f.return,ht=$;break e}ht=f.return}}if(kn=a,Ah(),Sl&&typeof Sl.onPostCommitFiberRoot=="function")try{Sl.onPostCommitFiberRoot(aO,e)}catch{}i=!0}return i}finally{tr=n,Va.transition=t}}return!1}function mX(e,t,n){t=uv(n,t),t=qie(e,t,1),e=ah(e,t,1),t=Go(),e!==null&&(wS(e,1,t),bs(e,t))}function ui(e,t,n){if(e.tag===3)mX(e,e,n);else for(;t!==null;){if(t.tag===3){mX(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ch===null||!ch.has(i))){e=uv(n,e),e=Xie(t,e,1),t=ah(t,e,1),e=Go(),t!==null&&(wS(t,1,e),bs(t,e));break}}t=t.return}}function gke(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),t=Go(),e.pingedLanes|=e.suspendedLanes&n,qi===e&&(ao&n)===n&&(Li===4||Li===3&&(ao&130023424)===ao&&500>yi()-iV?op(e,0):rV|=n),bs(e,t)}function goe(e,t){t===0&&(e.mode&1?(t=oC,oC<<=1,!(oC&130023424)&&(oC=4194304)):t=1);var n=Go();e=Lu(e,t),e!==null&&(wS(e,t,n),bs(e,n))}function vke(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),goe(e,n)}function yke(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(qe(314))}i!==null&&i.delete(t),goe(e,n)}var voe;voe=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||_s.current)ps=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return ps=!1,oke(e,t,n);ps=!!(e.flags&131072)}else ps=!1,Br&&t.flags&1048576&&bie(t,OR,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;nR(e,t),e=t.pendingProps;var a=sv(t,Ro.current);Bg(t,n),a=JU(null,t,i,e,a,n);var l=QU();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Es(i)?(l=!0,RR(t)):l=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,KU(t),a.updater=pO,t.stateNode=a,a._reactInternals=t,NM(t,i,e,n),t=LM(null,t,i,!0,l,n)):(t.tag=0,Br&&l&&VU(t),Uo(null,t,a,n),t=t.child),t;case 16:i=t.elementType;e:{switch(nR(e,t),e=t.pendingProps,a=i._init,i=a(i._payload),t.type=i,a=t.tag=Eke(i),e=_c(i,e),a){case 0:t=kM(null,t,i,e,n);break e;case 1:t=oX(null,t,i,e,n);break e;case 11:t=rX(null,t,i,e,n);break e;case 14:t=iX(null,t,i,_c(i.type,e),n);break e}throw Error(qe(306,i,""))}return t;case 0:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:_c(i,a),kM(e,t,i,a,n);case 1:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:_c(i,a),oX(e,t,i,a,n);case 3:e:{if(eoe(t),e===null)throw Error(qe(387));i=t.pendingProps,l=t.memoizedState,a=l.element,Aie(e,t),PR(t,i,null,n);var d=t.memoizedState;if(i=d.element,l.isDehydrated)if(l={element:i,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){a=uv(Error(qe(423)),t),t=sX(e,t,i,n,a);break e}else if(i!==a){a=uv(Error(qe(424)),t),t=sX(e,t,i,n,a);break e}else for(Hs=sh(t.stateNode.containerInfo.firstChild),Ks=t,Br=!0,Rc=null,n=Cie(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(av(),i===a){t=Mu(e,t,n);break e}Uo(e,t,i,n)}t=t.child}return t;case 5:return Oie(t),e===null&&IM(t),i=t.type,a=t.pendingProps,l=e!==null?e.memoizedProps:null,d=a.children,TM(i,a)?d=null:l!==null&&TM(i,l)&&(t.flags|=32),Zie(e,t),Uo(e,t,d,n),t.child;case 6:return e===null&&IM(t),null;case 13:return toe(e,t,n);case 4:return zU(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=cv(t,null,i,n):Uo(e,t,i,n),t.child;case 11:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:_c(i,a),rX(e,t,i,a,n);case 7:return Uo(e,t,t.pendingProps,n),t.child;case 8:return Uo(e,t,t.pendingProps.children,n),t.child;case 12:return Uo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,a=t.pendingProps,l=t.memoizedProps,d=a.value,Sr(IR,i._currentValue),i._currentValue=d,l!==null)if(Nc(l.value,d)){if(l.children===a.children&&!_s.current){t=Mu(e,t,n);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var f=l.dependencies;if(f!==null){d=l.child;for(var m=f.firstContext;m!==null;){if(m.context===i){if(l.tag===1){m=Eu(-1,n&-n),m.tag=2;var v=l.updateQueue;if(v!==null){v=v.shared;var E=v.pending;E===null?m.next=m:(m.next=E.next,E.next=m),v.pending=m}}l.lanes|=n,m=l.alternate,m!==null&&(m.lanes|=n),xM(l.return,n,t),f.lanes|=n;break}m=m.next}}else if(l.tag===10)d=l.type===t.type?null:l.child;else if(l.tag===18){if(d=l.return,d===null)throw Error(qe(341));d.lanes|=n,f=d.alternate,f!==null&&(f.lanes|=n),xM(d,n,t),d=l.sibling}else d=l.child;if(d!==null)d.return=l;else for(d=l;d!==null;){if(d===t){d=null;break}if(l=d.sibling,l!==null){l.return=d.return,d=l;break}d=d.return}l=d}Uo(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,i=t.pendingProps.children,Bg(t,n),a=$a(a),i=i(a),t.flags|=1,Uo(e,t,i,n),t.child;case 14:return i=t.type,a=_c(i,t.pendingProps),a=_c(i.type,a),iX(e,t,i,a,n);case 15:return Jie(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:_c(i,a),nR(e,t),t.tag=1,Es(i)?(e=!0,RR(t)):e=!1,Bg(t,n),Yie(t,i,a),NM(t,i,a,n),LM(null,t,i,!0,e,n);case 19:return noe(e,t,n);case 22:return Qie(e,t,n)}throw Error(qe(156,t.tag))};function yoe(e,t){return Hre(e,t)}function _ke(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ma(e,t,n,i){return new _ke(e,t,n,i)}function cV(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Eke(e){if(typeof e=="function")return cV(e)?1:0;if(e!=null){if(e=e.$$typeof,e===AU)return 11;if(e===OU)return 14}return 2}function uh(e,t){var n=e.alternate;return n===null?(n=Ma(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function oR(e,t,n,i,a,l){var d=2;if(i=e,typeof e=="function")cV(e)&&(d=1);else if(typeof e=="string")d=5;else e:switch(e){case gg:return sp(n.children,a,l,t);case RU:d=8,a|=8;break;case nM:return e=Ma(12,n,t,a|2),e.elementType=nM,e.lanes=l,e;case rM:return e=Ma(13,n,t,a),e.elementType=rM,e.lanes=l,e;case iM:return e=Ma(19,n,t,a),e.elementType=iM,e.lanes=l,e;case Ore:return vO(n,a,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Rre:d=10;break e;case Are:d=9;break e;case AU:d=11;break e;case OU:d=14;break e;case Fd:d=16,i=null;break e}throw Error(qe(130,e==null?e:typeof e,""))}return t=Ma(d,n,t,a),t.elementType=e,t.type=i,t.lanes=l,t}function sp(e,t,n,i){return e=Ma(7,e,i,t),e.lanes=n,e}function vO(e,t,n,i){return e=Ma(22,e,i,t),e.elementType=Ore,e.lanes=n,e.stateNode={isHidden:!1},e}function kk(e,t,n){return e=Ma(6,e,null,t),e.lanes=n,e}function Lk(e,t,n){return t=Ma(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function bke(e,t,n,i,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mk(0),this.expirationTimes=mk(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mk(0),this.identifierPrefix=i,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function lV(e,t,n,i,a,l,d,f,m){return e=new bke(e,t,n,f,m),t===1?(t=1,l===!0&&(t|=8)):t=0,l=Ma(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},KU(l),e}function Ske(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mg,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}function _oe(e){if(!e)return _h;e=e._reactInternals;e:{if(Op(e)!==e||e.tag!==1)throw Error(qe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Es(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(qe(171))}if(e.tag===1){var n=e.type;if(Es(n))return _ie(e,n,t)}return t}function Eoe(e,t,n,i,a,l,d,f,m){return e=lV(n,i,!0,e,a,l,d,f,m),e.context=_oe(null),n=e.current,i=Go(),a=lh(n),l=Eu(i,a),l.callback=t??null,ah(n,l,a),e.current.lanes=a,wS(e,a,i),bs(e,i),e}function yO(e,t,n,i){var a=t.current,l=Go(),d=lh(a);return n=_oe(n),t.context===null?t.context=n:t.pendingContext=n,t=Eu(l,d),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=ah(a,t,d),e!==null&&(Pc(e,a,d,l),ZC(e,a,d)),d}function VR(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function gX(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function uV(e,t){gX(e,t),(e=e.alternate)&&gX(e,t)}function wke(){return null}var boe=typeof reportError=="function"?reportError:function(e){console.error(e)};function dV(e){this._internalRoot=e}_O.prototype.render=dV.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(qe(409));yO(e,t,null,null)};_O.prototype.unmount=dV.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;mp(function(){yO(null,e,null,null)}),t[ku]=null}};function _O(e){this._internalRoot=e}_O.prototype.unstable_scheduleHydration=function(e){if(e){var t=Qre();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Hd.length&&t!==0&&t<Hd[n].priority;n++);Hd.splice(n,0,e),n===0&&eie(e)}};function hV(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function EO(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function vX(){}function Tke(e,t,n,i,a){if(a){if(typeof i=="function"){var l=i;i=function(){var v=VR(d);l.call(v)}}var d=Eoe(t,i,e,0,null,!1,!1,"",vX);return e._reactRootContainer=d,e[ku]=d.current,fb(e.nodeType===8?e.parentNode:e),mp(),d}for(;a=e.lastChild;)e.removeChild(a);if(typeof i=="function"){var f=i;i=function(){var v=VR(m);f.call(v)}}var m=lV(e,0,!1,null,null,!1,!1,"",vX);return e._reactRootContainer=m,e[ku]=m.current,fb(e.nodeType===8?e.parentNode:e),mp(function(){yO(t,m,n,i)}),m}function bO(e,t,n,i,a){var l=n._reactRootContainer;if(l){var d=l;if(typeof a=="function"){var f=a;a=function(){var m=VR(d);f.call(m)}}yO(t,d,e,a)}else d=Tke(n,t,e,a,i);return VR(d)}Xre=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=wE(t.pendingLanes);n!==0&&(PU(t,n|1),bs(t,yi()),!(kn&6)&&(dv=yi()+500,Ah()))}break;case 13:mp(function(){var i=Lu(e,1);if(i!==null){var a=Go();Pc(i,e,1,a)}}),uV(e,1)}};NU=function(e){if(e.tag===13){var t=Lu(e,134217728);if(t!==null){var n=Go();Pc(t,e,134217728,n)}uV(e,134217728)}};Jre=function(e){if(e.tag===13){var t=lh(e),n=Lu(e,t);if(n!==null){var i=Go();Pc(n,e,t,i)}uV(e,t)}};Qre=function(){return tr};Zre=function(e,t){var n=tr;try{return tr=e,t()}finally{tr=n}};pM=function(e,t,n){switch(t){case"input":if(aM(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var a=dO(i);if(!a)throw Error(qe(90));xre(i),aM(i,a)}}}break;case"textarea":Nre(e,n);break;case"select":t=n.value,t!=null&&jg(e,!!n.multiple,t,!1)}};Vre=oV;Fre=mp;var Cke={usingClientEntryPoint:!1,Events:[CS,Eg,dO,jre,Ure,oV]},iE={findFiberByHostInstance:Kf,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Rke={bundleType:iE.bundleType,version:iE.version,rendererPackageName:iE.rendererPackageName,rendererConfig:iE.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gu.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Wre(e),e===null?null:e.stateNode},findFiberByHostInstance:iE.findFiberByHostInstance||wke,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gC.isDisabled&&gC.supportsFiber)try{aO=gC.inject(Rke),Sl=gC}catch{}}Zs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cke;Zs.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!hV(t))throw Error(qe(200));return Ske(e,t,null,n)};Zs.createRoot=function(e,t){if(!hV(e))throw Error(qe(299));var n=!1,i="",a=boe;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=lV(e,1,!1,null,null,n,!1,i,a),e[ku]=t.current,fb(e.nodeType===8?e.parentNode:e),new dV(t)};Zs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(qe(188)):(e=Object.keys(e).join(","),Error(qe(268,e)));return e=Wre(t),e=e===null?null:e.stateNode,e};Zs.flushSync=function(e){return mp(e)};Zs.hydrate=function(e,t,n){if(!EO(t))throw Error(qe(200));return bO(null,e,t,!0,n)};Zs.hydrateRoot=function(e,t,n){if(!hV(e))throw Error(qe(405));var i=n!=null&&n.hydratedSources||null,a=!1,l="",d=boe;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(d=n.onRecoverableError)),t=Eoe(t,null,e,1,n??null,a,!1,l,d),e[ku]=t.current,fb(e),i)for(e=0;e<i.length;e++)n=i[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new _O(t)};Zs.render=function(e,t,n){if(!EO(t))throw Error(qe(200));return bO(null,e,t,!1,n)};Zs.unmountComponentAtNode=function(e){if(!EO(e))throw Error(qe(40));return e._reactRootContainer?(mp(function(){bO(null,null,e,!1,function(){e._reactRootContainer=null,e[ku]=null})}),!0):!1};Zs.unstable_batchedUpdates=oV;Zs.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!EO(n))throw Error(qe(200));if(e==null||e._reactInternals===void 0)throw Error(qe(38));return bO(e,t,n,!1,i)};Zs.version="18.3.1-next-f1338f8080-20240426";function Soe(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Soe)}catch(e){console.error(e)}}Soe(),Sre.exports=Zs;var Ip=Sre.exports;const woe=zn(Ip);var Toe,yX=Ip;Toe=yX.createRoot,yX.hydrateRoot;const Ake=1,Oke=1e6;let Mk=0;function Ike(){return Mk=(Mk+1)%Number.MAX_SAFE_INTEGER,Mk.toString()}const jk=new Map,_X=e=>{if(jk.has(e))return;const t=setTimeout(()=>{jk.delete(e),$E({type:"REMOVE_TOAST",toastId:e})},Oke);jk.set(e,t)},xke=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,Ake)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(n=>n.id===t.toast.id?{...n,...t.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=t;return n?_X(n):e.toasts.forEach(i=>{_X(i.id)}),{...e,toasts:e.toasts.map(i=>i.id===n||n===void 0?{...i,open:!1}:i)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(n=>n.id!==t.toastId)}}},sR=[];let aR={toasts:[]};function $E(e){aR=xke(aR,e),sR.forEach(t=>{t(aR)})}function Pke({...e}){const t=Ike(),n=a=>$E({type:"UPDATE_TOAST",toast:{...a,id:t}}),i=()=>$E({type:"DISMISS_TOAST",toastId:t});return $E({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:a=>{a||i()}}}),{id:t,dismiss:i,update:n}}function Hu(){const[e,t]=N.useState(aR);return N.useEffect(()=>(sR.push(t),()=>{const n=sR.indexOf(t);n>-1&&sR.splice(n,1)}),[e]),{...e,toast:Pke,dismiss:n=>$E({type:"DISMISS_TOAST",toastId:n})}}function et(e,t,{checkForDefaultPrevented:n=!0}={}){return function(a){if(e==null||e(a),n===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function EX(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function SO(...e){return t=>{let n=!1;const i=e.map(a=>{const l=EX(a,t);return!n&&typeof l=="function"&&(n=!0),l});if(n)return()=>{for(let a=0;a<i.length;a++){const l=i[a];typeof l=="function"?l():EX(e[a],null)}}}}function fn(...e){return N.useCallback(SO(...e),e)}function Nke(e,t){const n=N.createContext(t),i=l=>{const{children:d,...f}=l,m=N.useMemo(()=>f,Object.values(f));return _.jsx(n.Provider,{value:m,children:d})};i.displayName=e+"Provider";function a(l){const d=N.useContext(n);if(d)return d;if(t!==void 0)return t;throw new Error(`\`${l}\` must be used within \`${e}\``)}return[i,a]}function ta(e,t=[]){let n=[];function i(l,d){const f=N.createContext(d),m=n.length;n=[...n,d];const v=S=>{var D;const{scope:T,children:R,...I}=S,O=((D=T==null?void 0:T[e])==null?void 0:D[m])||f,P=N.useMemo(()=>I,Object.values(I));return _.jsx(O.Provider,{value:P,children:R})};v.displayName=l+"Provider";function E(S,T){var O;const R=((O=T==null?void 0:T[e])==null?void 0:O[m])||f,I=N.useContext(R);if(I)return I;if(d!==void 0)return d;throw new Error(`\`${S}\` must be used within \`${l}\``)}return[v,E]}const a=()=>{const l=n.map(d=>N.createContext(d));return function(f){const m=(f==null?void 0:f[e])||l;return N.useMemo(()=>({[`__scope${e}`]:{...f,[e]:m}}),[f,m])}};return a.scopeName=e,[i,Dke(a,...t)]}function Dke(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const i=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(l){const d=i.reduce((f,{useScope:m,scopeName:v})=>{const S=m(l)[`__scope${v}`];return{...f,...S}},{});return N.useMemo(()=>({[`__scope${t.scopeName}`]:d}),[d])}};return n.scopeName=t.scopeName,n}function gp(e){const t=Lke(e),n=N.forwardRef((i,a)=>{const{children:l,...d}=i,f=N.Children.toArray(l),m=f.find(jke);if(m){const v=m.props.children,E=f.map(S=>S===m?N.Children.count(v)>1?N.Children.only(null):N.isValidElement(v)?v.props.children:null:S);return _.jsx(t,{...d,ref:a,children:N.isValidElement(v)?N.cloneElement(v,void 0,E):null})}return _.jsx(t,{...d,ref:a,children:l})});return n.displayName=`${e}.Slot`,n}var kke=gp("Slot");function Lke(e){const t=N.forwardRef((n,i)=>{const{children:a,...l}=n;if(N.isValidElement(a)){const d=Vke(a),f=Uke(l,a.props);return a.type!==N.Fragment&&(f.ref=i?SO(i,d):d),N.cloneElement(a,f)}return N.Children.count(a)>1?N.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Coe=Symbol("radix.slottable");function Mke(e){const t=({children:n})=>_.jsx(_.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=Coe,t}function jke(e){return N.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Coe}function Uke(e,t){const n={...t};for(const i in t){const a=e[i],l=t[i];/^on[A-Z]/.test(i)?a&&l?n[i]=(...f)=>{const m=l(...f);return a(...f),m}:a&&(n[i]=a):i==="style"?n[i]={...a,...l}:i==="className"&&(n[i]=[a,l].filter(Boolean).join(" "))}return{...e,...n}}function Vke(e){var i,a;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function wO(e){const t=e+"CollectionProvider",[n,i]=ta(t),[a,l]=n(t,{collectionRef:{current:null},itemMap:new Map}),d=O=>{const{scope:P,children:D}=O,k=se.useRef(null),M=se.useRef(new Map).current;return _.jsx(a,{scope:P,itemMap:M,collectionRef:k,children:D})};d.displayName=t;const f=e+"CollectionSlot",m=gp(f),v=se.forwardRef((O,P)=>{const{scope:D,children:k}=O,M=l(f,D),$=fn(P,M.collectionRef);return _.jsx(m,{ref:$,children:k})});v.displayName=f;const E=e+"CollectionItemSlot",S="data-radix-collection-item",T=gp(E),R=se.forwardRef((O,P)=>{const{scope:D,children:k,...M}=O,$=se.useRef(null),V=fn(P,$),W=l(E,D);return se.useEffect(()=>(W.itemMap.set($,{ref:$,...M}),()=>void W.itemMap.delete($))),_.jsx(T,{[S]:"",ref:V,children:k})});R.displayName=E;function I(O){const P=l(e+"CollectionConsumer",O);return se.useCallback(()=>{const k=P.collectionRef.current;if(!k)return[];const M=Array.from(k.querySelectorAll(`[${S}]`));return Array.from(P.itemMap.values()).sort((W,H)=>M.indexOf(W.ref.current)-M.indexOf(H.ref.current))},[P.collectionRef,P.itemMap])}return[{Provider:d,Slot:v,ItemSlot:R},I,i]}var Fke=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],yt=Fke.reduce((e,t)=>{const n=gp(`Primitive.${t}`),i=N.forwardRef((a,l)=>{const{asChild:d,...f}=a,m=d?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),_.jsx(m,{...f,ref:l})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{});function fV(e,t){e&&Ip.flushSync(()=>e.dispatchEvent(t))}function hi(e){const t=N.useRef(e);return N.useEffect(()=>{t.current=e}),N.useMemo(()=>(...n)=>{var i;return(i=t.current)==null?void 0:i.call(t,...n)},[])}function Bke(e,t=globalThis==null?void 0:globalThis.document){const n=hi(e);N.useEffect(()=>{const i=a=>{a.key==="Escape"&&n(a)};return t.addEventListener("keydown",i,{capture:!0}),()=>t.removeEventListener("keydown",i,{capture:!0})},[n,t])}var $ke="DismissableLayer",zM="dismissableLayer.update",Wke="dismissableLayer.pointerDownOutside",Gke="dismissableLayer.focusOutside",bX,Roe=N.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),qv=N.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:l,onInteractOutside:d,onDismiss:f,...m}=e,v=N.useContext(Roe),[E,S]=N.useState(null),T=(E==null?void 0:E.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,R]=N.useState({}),I=fn(t,H=>S(H)),O=Array.from(v.layers),[P]=[...v.layersWithOutsidePointerEventsDisabled].slice(-1),D=O.indexOf(P),k=E?O.indexOf(E):-1,M=v.layersWithOutsidePointerEventsDisabled.size>0,$=k>=D,V=Kke(H=>{const J=H.target,ee=[...v.branches].some(le=>le.contains(J));!$||ee||(a==null||a(H),d==null||d(H),H.defaultPrevented||f==null||f())},T),W=zke(H=>{const J=H.target;[...v.branches].some(le=>le.contains(J))||(l==null||l(H),d==null||d(H),H.defaultPrevented||f==null||f())},T);return Bke(H=>{k===v.layers.size-1&&(i==null||i(H),!H.defaultPrevented&&f&&(H.preventDefault(),f()))},T),N.useEffect(()=>{if(E)return n&&(v.layersWithOutsidePointerEventsDisabled.size===0&&(bX=T.body.style.pointerEvents,T.body.style.pointerEvents="none"),v.layersWithOutsidePointerEventsDisabled.add(E)),v.layers.add(E),SX(),()=>{n&&v.layersWithOutsidePointerEventsDisabled.size===1&&(T.body.style.pointerEvents=bX)}},[E,T,n,v]),N.useEffect(()=>()=>{E&&(v.layers.delete(E),v.layersWithOutsidePointerEventsDisabled.delete(E),SX())},[E,v]),N.useEffect(()=>{const H=()=>R({});return document.addEventListener(zM,H),()=>document.removeEventListener(zM,H)},[]),_.jsx(yt.div,{...m,ref:I,style:{pointerEvents:M?$?"auto":"none":void 0,...e.style},onFocusCapture:et(e.onFocusCapture,W.onFocusCapture),onBlurCapture:et(e.onBlurCapture,W.onBlurCapture),onPointerDownCapture:et(e.onPointerDownCapture,V.onPointerDownCapture)})});qv.displayName=$ke;var Hke="DismissableLayerBranch",Aoe=N.forwardRef((e,t)=>{const n=N.useContext(Roe),i=N.useRef(null),a=fn(t,i);return N.useEffect(()=>{const l=i.current;if(l)return n.branches.add(l),()=>{n.branches.delete(l)}},[n.branches]),_.jsx(yt.div,{...e,ref:a})});Aoe.displayName=Hke;function Kke(e,t=globalThis==null?void 0:globalThis.document){const n=hi(e),i=N.useRef(!1),a=N.useRef(()=>{});return N.useEffect(()=>{const l=f=>{if(f.target&&!i.current){let m=function(){Ooe(Wke,n,v,{discrete:!0})};const v={originalEvent:f};f.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=m,t.addEventListener("click",a.current,{once:!0})):m()}else t.removeEventListener("click",a.current);i.current=!1},d=window.setTimeout(()=>{t.addEventListener("pointerdown",l)},0);return()=>{window.clearTimeout(d),t.removeEventListener("pointerdown",l),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>i.current=!0}}function zke(e,t=globalThis==null?void 0:globalThis.document){const n=hi(e),i=N.useRef(!1);return N.useEffect(()=>{const a=l=>{l.target&&!i.current&&Ooe(Gke,n,{originalEvent:l},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>i.current=!0,onBlurCapture:()=>i.current=!1}}function SX(){const e=new CustomEvent(zM);document.dispatchEvent(e)}function Ooe(e,t,n,{discrete:i}){const a=n.originalEvent.target,l=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),i?fV(a,l):a.dispatchEvent(l)}var Yke=qv,qke=Aoe,Ei=globalThis!=null&&globalThis.document?N.useLayoutEffect:()=>{},Xke="Portal",AS=N.forwardRef((e,t)=>{var f;const{container:n,...i}=e,[a,l]=N.useState(!1);Ei(()=>l(!0),[]);const d=n||a&&((f=globalThis==null?void 0:globalThis.document)==null?void 0:f.body);return d?woe.createPortal(_.jsx(yt.div,{...i,ref:t}),d):null});AS.displayName=Xke;function Jke(e,t){return N.useReducer((n,i)=>t[n][i]??n,e)}var Ao=e=>{const{present:t,children:n}=e,i=Qke(t),a=typeof n=="function"?n({present:i.isPresent}):N.Children.only(n),l=fn(i.ref,Zke(a));return typeof n=="function"||i.isPresent?N.cloneElement(a,{ref:l}):null};Ao.displayName="Presence";function Qke(e){const[t,n]=N.useState(),i=N.useRef(null),a=N.useRef(e),l=N.useRef("none"),d=e?"mounted":"unmounted",[f,m]=Jke(d,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return N.useEffect(()=>{const v=vC(i.current);l.current=f==="mounted"?v:"none"},[f]),Ei(()=>{const v=i.current,E=a.current;if(E!==e){const T=l.current,R=vC(v);e?m("MOUNT"):R==="none"||(v==null?void 0:v.display)==="none"?m("UNMOUNT"):m(E&&T!==R?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,m]),Ei(()=>{if(t){let v;const E=t.ownerDocument.defaultView??window,S=R=>{const O=vC(i.current).includes(R.animationName);if(R.target===t&&O&&(m("ANIMATION_END"),!a.current)){const P=t.style.animationFillMode;t.style.animationFillMode="forwards",v=E.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=P)})}},T=R=>{R.target===t&&(l.current=vC(i.current))};return t.addEventListener("animationstart",T),t.addEventListener("animationcancel",S),t.addEventListener("animationend",S),()=>{E.clearTimeout(v),t.removeEventListener("animationstart",T),t.removeEventListener("animationcancel",S),t.removeEventListener("animationend",S)}}else m("ANIMATION_END")},[t,m]),{isPresent:["mounted","unmountSuspended"].includes(f),ref:N.useCallback(v=>{i.current=v?getComputedStyle(v):null,n(v)},[])}}function vC(e){return(e==null?void 0:e.animationName)||"none"}function Zke(e){var i,a;let t=(i=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var eLe=SU[" useInsertionEffect ".trim().toString()]||Ei;function Eh({prop:e,defaultProp:t,onChange:n=()=>{},caller:i}){const[a,l,d]=tLe({defaultProp:t,onChange:n}),f=e!==void 0,m=f?e:a;{const E=N.useRef(e!==void 0);N.useEffect(()=>{const S=E.current;S!==f&&console.warn(`${i} is changing from ${S?"controlled":"uncontrolled"} to ${f?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),E.current=f},[f,i])}const v=N.useCallback(E=>{var S;if(f){const T=nLe(E)?E(e):E;T!==e&&((S=d.current)==null||S.call(d,T))}else l(E)},[f,e,l,d]);return[m,v]}function tLe({defaultProp:e,onChange:t}){const[n,i]=N.useState(e),a=N.useRef(n),l=N.useRef(t);return eLe(()=>{l.current=t},[t]),N.useEffect(()=>{var d;a.current!==n&&((d=l.current)==null||d.call(l,n),a.current=n)},[n,a]),[n,i,l]}function nLe(e){return typeof e=="function"}var Ioe=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),rLe="VisuallyHidden",TO=N.forwardRef((e,t)=>_.jsx(yt.span,{...e,ref:t,style:{...Ioe,...e.style}}));TO.displayName=rLe;var iLe=TO,pV="ToastProvider",[mV,oLe,sLe]=wO("Toast"),[xoe,dEt]=ta("Toast",[sLe]),[aLe,CO]=xoe(pV),Poe=e=>{const{__scopeToast:t,label:n="Notification",duration:i=5e3,swipeDirection:a="right",swipeThreshold:l=50,children:d}=e,[f,m]=N.useState(null),[v,E]=N.useState(0),S=N.useRef(!1),T=N.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${pV}\`. Expected non-empty \`string\`.`),_.jsx(mV.Provider,{scope:t,children:_.jsx(aLe,{scope:t,label:n,duration:i,swipeDirection:a,swipeThreshold:l,toastCount:v,viewport:f,onViewportChange:m,onToastAdd:N.useCallback(()=>E(R=>R+1),[]),onToastRemove:N.useCallback(()=>E(R=>R-1),[]),isFocusedToastEscapeKeyDownRef:S,isClosePausedRef:T,children:d})})};Poe.displayName=pV;var Noe="ToastViewport",cLe=["F8"],YM="toast.viewportPause",qM="toast.viewportResume",Doe=N.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:i=cLe,label:a="Notifications ({hotkey})",...l}=e,d=CO(Noe,n),f=oLe(n),m=N.useRef(null),v=N.useRef(null),E=N.useRef(null),S=N.useRef(null),T=fn(t,S,d.onViewportChange),R=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),I=d.toastCount>0;N.useEffect(()=>{const P=D=>{var M;i.length!==0&&i.every($=>D[$]||D.code===$)&&((M=S.current)==null||M.focus())};return document.addEventListener("keydown",P),()=>document.removeEventListener("keydown",P)},[i]),N.useEffect(()=>{const P=m.current,D=S.current;if(I&&P&&D){const k=()=>{if(!d.isClosePausedRef.current){const W=new CustomEvent(YM);D.dispatchEvent(W),d.isClosePausedRef.current=!0}},M=()=>{if(d.isClosePausedRef.current){const W=new CustomEvent(qM);D.dispatchEvent(W),d.isClosePausedRef.current=!1}},$=W=>{!P.contains(W.relatedTarget)&&M()},V=()=>{P.contains(document.activeElement)||M()};return P.addEventListener("focusin",k),P.addEventListener("focusout",$),P.addEventListener("pointermove",k),P.addEventListener("pointerleave",V),window.addEventListener("blur",k),window.addEventListener("focus",M),()=>{P.removeEventListener("focusin",k),P.removeEventListener("focusout",$),P.removeEventListener("pointermove",k),P.removeEventListener("pointerleave",V),window.removeEventListener("blur",k),window.removeEventListener("focus",M)}}},[I,d.isClosePausedRef]);const O=N.useCallback(({tabbingDirection:P})=>{const k=f().map(M=>{const $=M.ref.current,V=[$,...bLe($)];return P==="forwards"?V:V.reverse()});return(P==="forwards"?k.reverse():k).flat()},[f]);return N.useEffect(()=>{const P=S.current;if(P){const D=k=>{var V,W,H;const M=k.altKey||k.ctrlKey||k.metaKey;if(k.key==="Tab"&&!M){const J=document.activeElement,ee=k.shiftKey;if(k.target===P&&ee){(V=v.current)==null||V.focus();return}const de=O({tabbingDirection:ee?"backwards":"forwards"}),ae=de.findIndex(ce=>ce===J);Uk(de.slice(ae+1))?k.preventDefault():ee?(W=v.current)==null||W.focus():(H=E.current)==null||H.focus()}};return P.addEventListener("keydown",D),()=>P.removeEventListener("keydown",D)}},[f,O]),_.jsxs(qke,{ref:m,role:"region","aria-label":a.replace("{hotkey}",R),tabIndex:-1,style:{pointerEvents:I?void 0:"none"},children:[I&&_.jsx(XM,{ref:v,onFocusFromOutsideViewport:()=>{const P=O({tabbingDirection:"forwards"});Uk(P)}}),_.jsx(mV.Slot,{scope:n,children:_.jsx(yt.ol,{tabIndex:-1,...l,ref:T})}),I&&_.jsx(XM,{ref:E,onFocusFromOutsideViewport:()=>{const P=O({tabbingDirection:"backwards"});Uk(P)}})]})});Doe.displayName=Noe;var koe="ToastFocusProxy",XM=N.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:i,...a}=e,l=CO(koe,n);return _.jsx(TO,{"aria-hidden":!0,tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:d=>{var v;const f=d.relatedTarget;!((v=l.viewport)!=null&&v.contains(f))&&i()}})});XM.displayName=koe;var OS="Toast",lLe="toast.swipeStart",uLe="toast.swipeMove",dLe="toast.swipeCancel",hLe="toast.swipeEnd",Loe=N.forwardRef((e,t)=>{const{forceMount:n,open:i,defaultOpen:a,onOpenChange:l,...d}=e,[f,m]=Eh({prop:i,defaultProp:a??!0,onChange:l,caller:OS});return _.jsx(Ao,{present:n||f,children:_.jsx(mLe,{open:f,...d,ref:t,onClose:()=>m(!1),onPause:hi(e.onPause),onResume:hi(e.onResume),onSwipeStart:et(e.onSwipeStart,v=>{v.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:et(e.onSwipeMove,v=>{const{x:E,y:S}=v.detail.delta;v.currentTarget.setAttribute("data-swipe","move"),v.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${E}px`),v.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${S}px`)}),onSwipeCancel:et(e.onSwipeCancel,v=>{v.currentTarget.setAttribute("data-swipe","cancel"),v.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),v.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),v.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),v.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:et(e.onSwipeEnd,v=>{const{x:E,y:S}=v.detail.delta;v.currentTarget.setAttribute("data-swipe","end"),v.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),v.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),v.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${E}px`),v.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${S}px`),m(!1)})})})});Loe.displayName=OS;var[fLe,pLe]=xoe(OS,{onClose(){}}),mLe=N.forwardRef((e,t)=>{const{__scopeToast:n,type:i="foreground",duration:a,open:l,onClose:d,onEscapeKeyDown:f,onPause:m,onResume:v,onSwipeStart:E,onSwipeMove:S,onSwipeCancel:T,onSwipeEnd:R,...I}=e,O=CO(OS,n),[P,D]=N.useState(null),k=fn(t,ce=>D(ce)),M=N.useRef(null),$=N.useRef(null),V=a||O.duration,W=N.useRef(0),H=N.useRef(V),J=N.useRef(0),{onToastAdd:ee,onToastRemove:le}=O,he=hi(()=>{var ge;(P==null?void 0:P.contains(document.activeElement))&&((ge=O.viewport)==null||ge.focus()),d()}),de=N.useCallback(ce=>{!ce||ce===1/0||(window.clearTimeout(J.current),W.current=new Date().getTime(),J.current=window.setTimeout(he,ce))},[he]);N.useEffect(()=>{const ce=O.viewport;if(ce){const ge=()=>{de(H.current),v==null||v()},ye=()=>{const te=new Date().getTime()-W.current;H.current=H.current-te,window.clearTimeout(J.current),m==null||m()};return ce.addEventListener(YM,ye),ce.addEventListener(qM,ge),()=>{ce.removeEventListener(YM,ye),ce.removeEventListener(qM,ge)}}},[O.viewport,V,m,v,de]),N.useEffect(()=>{l&&!O.isClosePausedRef.current&&de(V)},[l,V,O.isClosePausedRef,de]),N.useEffect(()=>(ee(),()=>le()),[ee,le]);const ae=N.useMemo(()=>P?$oe(P):null,[P]);return O.viewport?_.jsxs(_.Fragment,{children:[ae&&_.jsx(gLe,{__scopeToast:n,role:"status","aria-live":i==="foreground"?"assertive":"polite","aria-atomic":!0,children:ae}),_.jsx(fLe,{scope:n,onClose:he,children:Ip.createPortal(_.jsx(mV.ItemSlot,{scope:n,children:_.jsx(Yke,{asChild:!0,onEscapeKeyDown:et(f,()=>{O.isFocusedToastEscapeKeyDownRef.current||he(),O.isFocusedToastEscapeKeyDownRef.current=!1}),children:_.jsx(yt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":l?"open":"closed","data-swipe-direction":O.swipeDirection,...I,ref:k,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:et(e.onKeyDown,ce=>{ce.key==="Escape"&&(f==null||f(ce.nativeEvent),ce.nativeEvent.defaultPrevented||(O.isFocusedToastEscapeKeyDownRef.current=!0,he()))}),onPointerDown:et(e.onPointerDown,ce=>{ce.button===0&&(M.current={x:ce.clientX,y:ce.clientY})}),onPointerMove:et(e.onPointerMove,ce=>{if(!M.current)return;const ge=ce.clientX-M.current.x,ye=ce.clientY-M.current.y,te=!!$.current,ne=["left","right"].includes(O.swipeDirection),ue=["left","up"].includes(O.swipeDirection)?Math.min:Math.max,_e=ne?ue(0,ge):0,Ce=ne?0:ue(0,ye),Ie=ce.pointerType==="touch"?10:2,Ge={x:_e,y:Ce},Ze={originalEvent:ce,delta:Ge};te?($.current=Ge,yC(uLe,S,Ze,{discrete:!1})):wX(Ge,O.swipeDirection,Ie)?($.current=Ge,yC(lLe,E,Ze,{discrete:!1}),ce.target.setPointerCapture(ce.pointerId)):(Math.abs(ge)>Ie||Math.abs(ye)>Ie)&&(M.current=null)}),onPointerUp:et(e.onPointerUp,ce=>{const ge=$.current,ye=ce.target;if(ye.hasPointerCapture(ce.pointerId)&&ye.releasePointerCapture(ce.pointerId),$.current=null,M.current=null,ge){const te=ce.currentTarget,ne={originalEvent:ce,delta:ge};wX(ge,O.swipeDirection,O.swipeThreshold)?yC(hLe,R,ne,{discrete:!0}):yC(dLe,T,ne,{discrete:!0}),te.addEventListener("click",ue=>ue.preventDefault(),{once:!0})}})})})}),O.viewport)})]}):null}),gLe=e=>{const{__scopeToast:t,children:n,...i}=e,a=CO(OS,t),[l,d]=N.useState(!1),[f,m]=N.useState(!1);return _Le(()=>d(!0)),N.useEffect(()=>{const v=window.setTimeout(()=>m(!0),1e3);return()=>window.clearTimeout(v)},[]),f?null:_.jsx(AS,{asChild:!0,children:_.jsx(TO,{...i,children:l&&_.jsxs(_.Fragment,{children:[a.label," ",n]})})})},vLe="ToastTitle",Moe=N.forwardRef((e,t)=>{const{__scopeToast:n,...i}=e;return _.jsx(yt.div,{...i,ref:t})});Moe.displayName=vLe;var yLe="ToastDescription",joe=N.forwardRef((e,t)=>{const{__scopeToast:n,...i}=e;return _.jsx(yt.div,{...i,ref:t})});joe.displayName=yLe;var Uoe="ToastAction",Voe=N.forwardRef((e,t)=>{const{altText:n,...i}=e;return n.trim()?_.jsx(Boe,{altText:n,asChild:!0,children:_.jsx(gV,{...i,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${Uoe}\`. Expected non-empty \`string\`.`),null)});Voe.displayName=Uoe;var Foe="ToastClose",gV=N.forwardRef((e,t)=>{const{__scopeToast:n,...i}=e,a=pLe(Foe,n);return _.jsx(Boe,{asChild:!0,children:_.jsx(yt.button,{type:"button",...i,ref:t,onClick:et(e.onClick,a.onClose)})})});gV.displayName=Foe;var Boe=N.forwardRef((e,t)=>{const{__scopeToast:n,altText:i,...a}=e;return _.jsx(yt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":i||void 0,...a,ref:t})});function $oe(e){const t=[];return Array.from(e.childNodes).forEach(i=>{if(i.nodeType===i.TEXT_NODE&&i.textContent&&t.push(i.textContent),ELe(i)){const a=i.ariaHidden||i.hidden||i.style.display==="none",l=i.dataset.radixToastAnnounceExclude==="";if(!a)if(l){const d=i.dataset.radixToastAnnounceAlt;d&&t.push(d)}else t.push(...$oe(i))}}),t}function yC(e,t,n,{discrete:i}){const a=n.originalEvent.currentTarget,l=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),i?fV(a,l):a.dispatchEvent(l)}var wX=(e,t,n=0)=>{const i=Math.abs(e.x),a=Math.abs(e.y),l=i>a;return t==="left"||t==="right"?l&&i>n:!l&&a>n};function _Le(e=()=>{}){const t=hi(e);Ei(()=>{let n=0,i=0;return n=window.requestAnimationFrame(()=>i=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(i)}},[t])}function ELe(e){return e.nodeType===e.ELEMENT_NODE}function bLe(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const a=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||a?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Uk(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}var SLe=Poe,Woe=Doe,Goe=Loe,Hoe=Moe,Koe=joe,zoe=Voe,Yoe=gV;function qoe(e){var t,n,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=qoe(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function un(){for(var e,t,n=0,i="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=qoe(e))&&(i&&(i+=" "),i+=t);return i}const TX=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,CX=un,vV=(e,t)=>n=>{var i;if((t==null?void 0:t.variants)==null)return CX(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:a,defaultVariants:l}=t,d=Object.keys(a).map(v=>{const E=n==null?void 0:n[v],S=l==null?void 0:l[v];if(E===null)return null;const T=TX(E)||TX(S);return a[v][T]}),f=n&&Object.entries(n).reduce((v,E)=>{let[S,T]=E;return T===void 0||(v[S]=T),v},{}),m=t==null||(i=t.compoundVariants)===null||i===void 0?void 0:i.reduce((v,E)=>{let{class:S,className:T,...R}=E;return Object.entries(R).every(I=>{let[O,P]=I;return Array.isArray(P)?P.includes({...l,...f}[O]):{...l,...f}[O]===P})?[...v,S,T]:v},[]);return CX(e,d,m,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wLe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Xoe=(...e)=>e.filter((t,n,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var TLe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CLe=N.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:a="",children:l,iconNode:d,...f},m)=>N.createElement("svg",{ref:m,...TLe,width:t,height:t,stroke:e,strokeWidth:i?Number(n)*24/Number(t):n,className:Xoe("lucide",a),...f},[...d.map(([v,E])=>N.createElement(v,E)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=(e,t)=>{const n=N.forwardRef(({className:i,...a},l)=>N.createElement(CLe,{ref:l,iconNode:t,className:Xoe(`lucide-${wLe(e)}`,i),...a}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sb=Tr("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Joe=Tr("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RX=Tr("ChartNoAxesColumnIncreasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RO=Tr("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qoe=Tr("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RLe=Tr("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zoe=Tr("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ALe=Tr("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yV=Tr("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OLe=Tr("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ese=Tr("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AX=Tr("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ILe=Tr("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xLe=Tr("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vk=Tr("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PLe=Tr("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NLe=Tr("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DLe=Tr("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kLe=Tr("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LLe=Tr("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OX=Tr("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MLe=Tr("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WE=Tr("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tse=Tr("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AO=Tr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jLe=Tr("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),_V="-",ULe=e=>{const t=FLe(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:i}=e;return{getClassGroupId:d=>{const f=d.split(_V);return f[0]===""&&f.length!==1&&f.shift(),nse(f,t)||VLe(d)},getConflictingClassGroupIds:(d,f)=>{const m=n[d]||[];return f&&i[d]?[...m,...i[d]]:m}}},nse=(e,t)=>{var d;if(e.length===0)return t.classGroupId;const n=e[0],i=t.nextPart.get(n),a=i?nse(e.slice(1),i):void 0;if(a)return a;if(t.validators.length===0)return;const l=e.join(_V);return(d=t.validators.find(({validator:f})=>f(l)))==null?void 0:d.classGroupId},IX=/^\[(.+)\]$/,VLe=e=>{if(IX.test(e)){const t=IX.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},FLe=e=>{const{theme:t,prefix:n}=e,i={nextPart:new Map,validators:[]};return $Le(Object.entries(e.classGroups),n).forEach(([l,d])=>{JM(d,i,l,t)}),i},JM=(e,t,n,i)=>{e.forEach(a=>{if(typeof a=="string"){const l=a===""?t:xX(t,a);l.classGroupId=n;return}if(typeof a=="function"){if(BLe(a)){JM(a(i),t,n,i);return}t.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([l,d])=>{JM(d,xX(t,l),n,i)})})},xX=(e,t)=>{let n=e;return t.split(_V).forEach(i=>{n.nextPart.has(i)||n.nextPart.set(i,{nextPart:new Map,validators:[]}),n=n.nextPart.get(i)}),n},BLe=e=>e.isThemeGetter,$Le=(e,t)=>t?e.map(([n,i])=>{const a=i.map(l=>typeof l=="string"?t+l:typeof l=="object"?Object.fromEntries(Object.entries(l).map(([d,f])=>[t+d,f])):l);return[n,a]}):e,WLe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,i=new Map;const a=(l,d)=>{n.set(l,d),t++,t>e&&(t=0,i=n,n=new Map)};return{get(l){let d=n.get(l);if(d!==void 0)return d;if((d=i.get(l))!==void 0)return a(l,d),d},set(l,d){n.has(l)?n.set(l,d):a(l,d)}}},rse="!",GLe=e=>{const{separator:t,experimentalParseClassName:n}=e,i=t.length===1,a=t[0],l=t.length,d=f=>{const m=[];let v=0,E=0,S;for(let P=0;P<f.length;P++){let D=f[P];if(v===0){if(D===a&&(i||f.slice(P,P+l)===t)){m.push(f.slice(E,P)),E=P+l;continue}if(D==="/"){S=P;continue}}D==="["?v++:D==="]"&&v--}const T=m.length===0?f:f.substring(E),R=T.startsWith(rse),I=R?T.substring(1):T,O=S&&S>E?S-E:void 0;return{modifiers:m,hasImportantModifier:R,baseClassName:I,maybePostfixModifierPosition:O}};return n?f=>n({className:f,parseClassName:d}):d},HLe=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(i=>{i[0]==="["?(t.push(...n.sort(),i),n=[]):n.push(i)}),t.push(...n.sort()),t},KLe=e=>({cache:WLe(e.cacheSize),parseClassName:GLe(e),...ULe(e)}),zLe=/\s+/,YLe=(e,t)=>{const{parseClassName:n,getClassGroupId:i,getConflictingClassGroupIds:a}=t,l=[],d=e.trim().split(zLe);let f="";for(let m=d.length-1;m>=0;m-=1){const v=d[m],{modifiers:E,hasImportantModifier:S,baseClassName:T,maybePostfixModifierPosition:R}=n(v);let I=!!R,O=i(I?T.substring(0,R):T);if(!O){if(!I){f=v+(f.length>0?" "+f:f);continue}if(O=i(T),!O){f=v+(f.length>0?" "+f:f);continue}I=!1}const P=HLe(E).join(":"),D=S?P+rse:P,k=D+O;if(l.includes(k))continue;l.push(k);const M=a(O,I);for(let $=0;$<M.length;++$){const V=M[$];l.push(D+V)}f=v+(f.length>0?" "+f:f)}return f};function qLe(){let e=0,t,n,i="";for(;e<arguments.length;)(t=arguments[e++])&&(n=ise(t))&&(i&&(i+=" "),i+=n);return i}const ise=e=>{if(typeof e=="string")return e;let t,n="";for(let i=0;i<e.length;i++)e[i]&&(t=ise(e[i]))&&(n&&(n+=" "),n+=t);return n};function XLe(e,...t){let n,i,a,l=d;function d(m){const v=t.reduce((E,S)=>S(E),e());return n=KLe(v),i=n.cache.get,a=n.cache.set,l=f,f(m)}function f(m){const v=i(m);if(v)return v;const E=YLe(m,n);return a(m,E),E}return function(){return l(qLe.apply(null,arguments))}}const Ir=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},ose=/^\[(?:([a-z-]+):)?(.+)\]$/i,JLe=/^\d+\/\d+$/,QLe=new Set(["px","full","screen"]),ZLe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,eMe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,tMe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,nMe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,rMe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ru=e=>Wg(e)||QLe.has(e)||JLe.test(e),xd=e=>Xv(e,"length",dMe),Wg=e=>!!e&&!Number.isNaN(Number(e)),Fk=e=>Xv(e,"number",Wg),oE=e=>!!e&&Number.isInteger(Number(e)),iMe=e=>e.endsWith("%")&&Wg(e.slice(0,-1)),sn=e=>ose.test(e),Pd=e=>ZLe.test(e),oMe=new Set(["length","size","percentage"]),sMe=e=>Xv(e,oMe,sse),aMe=e=>Xv(e,"position",sse),cMe=new Set(["image","url"]),lMe=e=>Xv(e,cMe,fMe),uMe=e=>Xv(e,"",hMe),sE=()=>!0,Xv=(e,t,n)=>{const i=ose.exec(e);return i?i[1]?typeof t=="string"?i[1]===t:t.has(i[1]):n(i[2]):!1},dMe=e=>eMe.test(e)&&!tMe.test(e),sse=()=>!1,hMe=e=>nMe.test(e),fMe=e=>rMe.test(e),pMe=()=>{const e=Ir("colors"),t=Ir("spacing"),n=Ir("blur"),i=Ir("brightness"),a=Ir("borderColor"),l=Ir("borderRadius"),d=Ir("borderSpacing"),f=Ir("borderWidth"),m=Ir("contrast"),v=Ir("grayscale"),E=Ir("hueRotate"),S=Ir("invert"),T=Ir("gap"),R=Ir("gradientColorStops"),I=Ir("gradientColorStopPositions"),O=Ir("inset"),P=Ir("margin"),D=Ir("opacity"),k=Ir("padding"),M=Ir("saturate"),$=Ir("scale"),V=Ir("sepia"),W=Ir("skew"),H=Ir("space"),J=Ir("translate"),ee=()=>["auto","contain","none"],le=()=>["auto","hidden","clip","visible","scroll"],he=()=>["auto",sn,t],de=()=>[sn,t],ae=()=>["",ru,xd],ce=()=>["auto",Wg,sn],ge=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ye=()=>["solid","dashed","dotted","double","none"],te=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ne=()=>["start","end","center","between","around","evenly","stretch"],ue=()=>["","0",sn],_e=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Ce=()=>[Wg,sn];return{cacheSize:500,separator:":",theme:{colors:[sE],spacing:[ru,xd],blur:["none","",Pd,sn],brightness:Ce(),borderColor:[e],borderRadius:["none","","full",Pd,sn],borderSpacing:de(),borderWidth:ae(),contrast:Ce(),grayscale:ue(),hueRotate:Ce(),invert:ue(),gap:de(),gradientColorStops:[e],gradientColorStopPositions:[iMe,xd],inset:he(),margin:he(),opacity:Ce(),padding:de(),saturate:Ce(),scale:Ce(),sepia:ue(),skew:Ce(),space:de(),translate:de()},classGroups:{aspect:[{aspect:["auto","square","video",sn]}],container:["container"],columns:[{columns:[Pd]}],"break-after":[{"break-after":_e()}],"break-before":[{"break-before":_e()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ge(),sn]}],overflow:[{overflow:le()}],"overflow-x":[{"overflow-x":le()}],"overflow-y":[{"overflow-y":le()}],overscroll:[{overscroll:ee()}],"overscroll-x":[{"overscroll-x":ee()}],"overscroll-y":[{"overscroll-y":ee()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[O]}],"inset-x":[{"inset-x":[O]}],"inset-y":[{"inset-y":[O]}],start:[{start:[O]}],end:[{end:[O]}],top:[{top:[O]}],right:[{right:[O]}],bottom:[{bottom:[O]}],left:[{left:[O]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",oE,sn]}],basis:[{basis:he()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",sn]}],grow:[{grow:ue()}],shrink:[{shrink:ue()}],order:[{order:["first","last","none",oE,sn]}],"grid-cols":[{"grid-cols":[sE]}],"col-start-end":[{col:["auto",{span:["full",oE,sn]},sn]}],"col-start":[{"col-start":ce()}],"col-end":[{"col-end":ce()}],"grid-rows":[{"grid-rows":[sE]}],"row-start-end":[{row:["auto",{span:[oE,sn]},sn]}],"row-start":[{"row-start":ce()}],"row-end":[{"row-end":ce()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",sn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",sn]}],gap:[{gap:[T]}],"gap-x":[{"gap-x":[T]}],"gap-y":[{"gap-y":[T]}],"justify-content":[{justify:["normal",...ne()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...ne(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...ne(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[k]}],px:[{px:[k]}],py:[{py:[k]}],ps:[{ps:[k]}],pe:[{pe:[k]}],pt:[{pt:[k]}],pr:[{pr:[k]}],pb:[{pb:[k]}],pl:[{pl:[k]}],m:[{m:[P]}],mx:[{mx:[P]}],my:[{my:[P]}],ms:[{ms:[P]}],me:[{me:[P]}],mt:[{mt:[P]}],mr:[{mr:[P]}],mb:[{mb:[P]}],ml:[{ml:[P]}],"space-x":[{"space-x":[H]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[H]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",sn,t]}],"min-w":[{"min-w":[sn,t,"min","max","fit"]}],"max-w":[{"max-w":[sn,t,"none","full","min","max","fit","prose",{screen:[Pd]},Pd]}],h:[{h:[sn,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[sn,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[sn,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[sn,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Pd,xd]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Fk]}],"font-family":[{font:[sE]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",sn]}],"line-clamp":[{"line-clamp":["none",Wg,Fk]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ru,sn]}],"list-image":[{"list-image":["none",sn]}],"list-style-type":[{list:["none","disc","decimal",sn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[D]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[D]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ye(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ru,xd]}],"underline-offset":[{"underline-offset":["auto",ru,sn]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:de()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",sn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",sn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[D]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ge(),aMe]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",sMe]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},lMe]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[I]}],"gradient-via-pos":[{via:[I]}],"gradient-to-pos":[{to:[I]}],"gradient-from":[{from:[R]}],"gradient-via":[{via:[R]}],"gradient-to":[{to:[R]}],rounded:[{rounded:[l]}],"rounded-s":[{"rounded-s":[l]}],"rounded-e":[{"rounded-e":[l]}],"rounded-t":[{"rounded-t":[l]}],"rounded-r":[{"rounded-r":[l]}],"rounded-b":[{"rounded-b":[l]}],"rounded-l":[{"rounded-l":[l]}],"rounded-ss":[{"rounded-ss":[l]}],"rounded-se":[{"rounded-se":[l]}],"rounded-ee":[{"rounded-ee":[l]}],"rounded-es":[{"rounded-es":[l]}],"rounded-tl":[{"rounded-tl":[l]}],"rounded-tr":[{"rounded-tr":[l]}],"rounded-br":[{"rounded-br":[l]}],"rounded-bl":[{"rounded-bl":[l]}],"border-w":[{border:[f]}],"border-w-x":[{"border-x":[f]}],"border-w-y":[{"border-y":[f]}],"border-w-s":[{"border-s":[f]}],"border-w-e":[{"border-e":[f]}],"border-w-t":[{"border-t":[f]}],"border-w-r":[{"border-r":[f]}],"border-w-b":[{"border-b":[f]}],"border-w-l":[{"border-l":[f]}],"border-opacity":[{"border-opacity":[D]}],"border-style":[{border:[...ye(),"hidden"]}],"divide-x":[{"divide-x":[f]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[f]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[D]}],"divide-style":[{divide:ye()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...ye()]}],"outline-offset":[{"outline-offset":[ru,sn]}],"outline-w":[{outline:[ru,xd]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:ae()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[D]}],"ring-offset-w":[{"ring-offset":[ru,xd]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Pd,uMe]}],"shadow-color":[{shadow:[sE]}],opacity:[{opacity:[D]}],"mix-blend":[{"mix-blend":[...te(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":te()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[i]}],contrast:[{contrast:[m]}],"drop-shadow":[{"drop-shadow":["","none",Pd,sn]}],grayscale:[{grayscale:[v]}],"hue-rotate":[{"hue-rotate":[E]}],invert:[{invert:[S]}],saturate:[{saturate:[M]}],sepia:[{sepia:[V]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[i]}],"backdrop-contrast":[{"backdrop-contrast":[m]}],"backdrop-grayscale":[{"backdrop-grayscale":[v]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[E]}],"backdrop-invert":[{"backdrop-invert":[S]}],"backdrop-opacity":[{"backdrop-opacity":[D]}],"backdrop-saturate":[{"backdrop-saturate":[M]}],"backdrop-sepia":[{"backdrop-sepia":[V]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[d]}],"border-spacing-x":[{"border-spacing-x":[d]}],"border-spacing-y":[{"border-spacing-y":[d]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",sn]}],duration:[{duration:Ce()}],ease:[{ease:["linear","in","out","in-out",sn]}],delay:[{delay:Ce()}],animate:[{animate:["none","spin","ping","pulse","bounce",sn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[$]}],"scale-x":[{"scale-x":[$]}],"scale-y":[{"scale-y":[$]}],rotate:[{rotate:[oE,sn]}],"translate-x":[{"translate-x":[J]}],"translate-y":[{"translate-y":[J]}],"skew-x":[{"skew-x":[W]}],"skew-y":[{"skew-y":[W]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",sn]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",sn]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":de()}],"scroll-mx":[{"scroll-mx":de()}],"scroll-my":[{"scroll-my":de()}],"scroll-ms":[{"scroll-ms":de()}],"scroll-me":[{"scroll-me":de()}],"scroll-mt":[{"scroll-mt":de()}],"scroll-mr":[{"scroll-mr":de()}],"scroll-mb":[{"scroll-mb":de()}],"scroll-ml":[{"scroll-ml":de()}],"scroll-p":[{"scroll-p":de()}],"scroll-px":[{"scroll-px":de()}],"scroll-py":[{"scroll-py":de()}],"scroll-ps":[{"scroll-ps":de()}],"scroll-pe":[{"scroll-pe":de()}],"scroll-pt":[{"scroll-pt":de()}],"scroll-pr":[{"scroll-pr":de()}],"scroll-pb":[{"scroll-pb":de()}],"scroll-pl":[{"scroll-pl":de()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",sn]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[ru,xd,Fk]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},mMe=XLe(pMe);function gt(...e){return mMe(un(e))}const gMe=SLe,ase=N.forwardRef(({className:e,...t},n)=>_.jsx(Woe,{ref:n,className:gt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));ase.displayName=Woe.displayName;const vMe=vV("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),cse=N.forwardRef(({className:e,variant:t,...n},i)=>_.jsx(Goe,{ref:i,className:gt(vMe({variant:t}),e),...n}));cse.displayName=Goe.displayName;const yMe=N.forwardRef(({className:e,...t},n)=>_.jsx(zoe,{ref:n,className:gt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));yMe.displayName=zoe.displayName;const lse=N.forwardRef(({className:e,...t},n)=>_.jsx(Yoe,{ref:n,className:gt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:_.jsx(AO,{className:"h-4 w-4"})}));lse.displayName=Yoe.displayName;const use=N.forwardRef(({className:e,...t},n)=>_.jsx(Hoe,{ref:n,className:gt("text-sm font-semibold",e),...t}));use.displayName=Hoe.displayName;const dse=N.forwardRef(({className:e,...t},n)=>_.jsx(Koe,{ref:n,className:gt("text-sm opacity-90",e),...t}));dse.displayName=Koe.displayName;function _Me(){const{toasts:e}=Hu();return _.jsxs(gMe,{children:[e.map(function({id:t,title:n,description:i,action:a,...l}){return _.jsxs(cse,{...l,children:[_.jsxs("div",{className:"grid gap-1",children:[n&&_.jsx(use,{children:n}),i&&_.jsx(dse,{children:i})]}),a,_.jsx(lse,{})]},t)}),_.jsx(ase,{})]})}const EMe=N.createContext({theme:"system"}),bMe=()=>{const e=N.useContext(EMe);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e};var SMe=e=>{switch(e){case"success":return CMe;case"info":return AMe;case"warning":return RMe;case"error":return OMe;default:return null}},wMe=Array(12).fill(0),TMe=({visible:e,className:t})=>se.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},se.createElement("div",{className:"sonner-spinner"},wMe.map((n,i)=>se.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${i}`})))),CMe=se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},se.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),RMe=se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},se.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),AMe=se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},se.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),OMe=se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},se.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),IMe=se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},se.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),se.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),xMe=()=>{let[e,t]=se.useState(document.hidden);return se.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},QM=1,PMe=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:n,...i}=e,a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:QM++,l=this.toasts.find(f=>f.id===a),d=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),l?this.toasts=this.toasts.map(f=>f.id===a?(this.publish({...f,...e,id:a,title:n}),{...f,...e,id:a,dismissible:d,title:n}):f):this.addToast({title:n,...i,dismissible:d,id:a}),a},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let i=e instanceof Promise?e:e(),a=n!==void 0,l,d=i.then(async m=>{if(l=["resolve",m],se.isValidElement(m))a=!1,this.create({id:n,type:"default",message:m});else if(DMe(m)&&!m.ok){a=!1;let v=typeof t.error=="function"?await t.error(`HTTP error! status: ${m.status}`):t.error,E=typeof t.description=="function"?await t.description(`HTTP error! status: ${m.status}`):t.description;this.create({id:n,type:"error",message:v,description:E})}else if(t.success!==void 0){a=!1;let v=typeof t.success=="function"?await t.success(m):t.success,E=typeof t.description=="function"?await t.description(m):t.description;this.create({id:n,type:"success",message:v,description:E})}}).catch(async m=>{if(l=["reject",m],t.error!==void 0){a=!1;let v=typeof t.error=="function"?await t.error(m):t.error,E=typeof t.description=="function"?await t.description(m):t.description;this.create({id:n,type:"error",message:v,description:E})}}).finally(()=>{var m;a&&(this.dismiss(n),n=void 0),(m=t.finally)==null||m.call(t)}),f=()=>new Promise((m,v)=>d.then(()=>l[0]==="reject"?v(l[1]):m(l[1])).catch(v));return typeof n!="string"&&typeof n!="number"?{unwrap:f}:Object.assign(n,{unwrap:f})},this.custom=(e,t)=>{let n=(t==null?void 0:t.id)||QM++;return this.create({jsx:e(n),id:n,...t}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},ds=new PMe,NMe=(e,t)=>{let n=(t==null?void 0:t.id)||QM++;return ds.addToast({title:e,...t,id:n}),n},DMe=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",kMe=NMe,LMe=()=>ds.toasts,MMe=()=>ds.getActiveToasts();Object.assign(kMe,{success:ds.success,info:ds.info,warning:ds.warning,error:ds.error,custom:ds.custom,message:ds.message,promise:ds.promise,dismiss:ds.dismiss,loading:ds.loading},{getHistory:LMe,getToasts:MMe});function jMe(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",t==="top"&&n.firstChild?n.insertBefore(i,n.firstChild):n.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}jMe(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function _C(e){return e.label!==void 0}var UMe=3,VMe="32px",FMe="16px",PX=4e3,BMe=356,$Me=14,WMe=20,GMe=200;function pc(...e){return e.filter(Boolean).join(" ")}function HMe(e){let[t,n]=e.split("-"),i=[];return t&&i.push(t),n&&i.push(n),i}var KMe=e=>{var t,n,i,a,l,d,f,m,v,E,S;let{invert:T,toast:R,unstyled:I,interacting:O,setHeights:P,visibleToasts:D,heights:k,index:M,toasts:$,expanded:V,removeToast:W,defaultRichColors:H,closeButton:J,style:ee,cancelButtonStyle:le,actionButtonStyle:he,className:de="",descriptionClassName:ae="",duration:ce,position:ge,gap:ye,loadingIcon:te,expandByDefault:ne,classNames:ue,icons:_e,closeButtonAriaLabel:Ce="Close toast",pauseWhenPageIsHidden:Ie}=e,[Ge,Ze]=se.useState(null),[wt,Ft]=se.useState(null),[ze,Nt]=se.useState(!1),[we,He]=se.useState(!1),[Ke,Re]=se.useState(!1),[at,mt]=se.useState(!1),[At,nn]=se.useState(!1),[Mr,Mn]=se.useState(0),[ar,Ya]=se.useState(0),Ji=se.useRef(R.duration||ce||PX),na=se.useRef(null),Yo=se.useRef(null),ni=M===0,Fh=M+1<=D,Oo=R.type,lo=R.dismissible!==!1,t0=R.className||"",_y=R.descriptionClassName||"",Bh=se.useMemo(()=>k.findIndex(Gt=>Gt.toastId===R.id)||0,[k,R.id]),n0=se.useMemo(()=>{var Gt;return(Gt=R.closeButton)!=null?Gt:J},[R.closeButton,J]),Ey=se.useMemo(()=>R.duration||ce||PX,[R.duration,ce]),Up=se.useRef(0),qo=se.useRef(0),by=se.useRef(0),Ju=se.useRef(null),[lx,Qu]=ge.split("-"),Sy=se.useMemo(()=>k.reduce((Gt,wn,vr)=>vr>=Bh?Gt:Gt+wn.height,0),[k,Bh]),r0=xMe(),ux=R.invert||T,wy=Oo==="loading";qo.current=se.useMemo(()=>Bh*ye+Sy,[Bh,Sy]),se.useEffect(()=>{Ji.current=Ey},[Ey]),se.useEffect(()=>{Nt(!0)},[]),se.useEffect(()=>{let Gt=Yo.current;if(Gt){let wn=Gt.getBoundingClientRect().height;return Ya(wn),P(vr=>[{toastId:R.id,height:wn,position:R.position},...vr]),()=>P(vr=>vr.filter(Ts=>Ts.toastId!==R.id))}},[P,R.id]),se.useLayoutEffect(()=>{if(!ze)return;let Gt=Yo.current,wn=Gt.style.height;Gt.style.height="auto";let vr=Gt.getBoundingClientRect().height;Gt.style.height=wn,Ya(vr),P(Ts=>Ts.find(Cs=>Cs.toastId===R.id)?Ts.map(Cs=>Cs.toastId===R.id?{...Cs,height:vr}:Cs):[{toastId:R.id,height:vr,position:R.position},...Ts])},[ze,R.title,R.description,P,R.id]);let Fc=se.useCallback(()=>{He(!0),Mn(qo.current),P(Gt=>Gt.filter(wn=>wn.toastId!==R.id)),setTimeout(()=>{W(R)},GMe)},[R,W,P,qo]);se.useEffect(()=>{if(R.promise&&Oo==="loading"||R.duration===1/0||R.type==="loading")return;let Gt;return V||O||Ie&&r0?(()=>{if(by.current<Up.current){let wn=new Date().getTime()-Up.current;Ji.current=Ji.current-wn}by.current=new Date().getTime()})():Ji.current!==1/0&&(Up.current=new Date().getTime(),Gt=setTimeout(()=>{var wn;(wn=R.onAutoClose)==null||wn.call(R,R),Fc()},Ji.current)),()=>clearTimeout(Gt)},[V,O,R,Oo,Ie,r0,Fc]),se.useEffect(()=>{R.delete&&Fc()},[Fc,R.delete]);function $h(){var Gt,wn,vr;return _e!=null&&_e.loading?se.createElement("div",{className:pc(ue==null?void 0:ue.loader,(Gt=R==null?void 0:R.classNames)==null?void 0:Gt.loader,"sonner-loader"),"data-visible":Oo==="loading"},_e.loading):te?se.createElement("div",{className:pc(ue==null?void 0:ue.loader,(wn=R==null?void 0:R.classNames)==null?void 0:wn.loader,"sonner-loader"),"data-visible":Oo==="loading"},te):se.createElement(TMe,{className:pc(ue==null?void 0:ue.loader,(vr=R==null?void 0:R.classNames)==null?void 0:vr.loader),visible:Oo==="loading"})}return se.createElement("li",{tabIndex:0,ref:Yo,className:pc(de,t0,ue==null?void 0:ue.toast,(t=R==null?void 0:R.classNames)==null?void 0:t.toast,ue==null?void 0:ue.default,ue==null?void 0:ue[Oo],(n=R==null?void 0:R.classNames)==null?void 0:n[Oo]),"data-sonner-toast":"","data-rich-colors":(i=R.richColors)!=null?i:H,"data-styled":!(R.jsx||R.unstyled||I),"data-mounted":ze,"data-promise":!!R.promise,"data-swiped":At,"data-removed":we,"data-visible":Fh,"data-y-position":lx,"data-x-position":Qu,"data-index":M,"data-front":ni,"data-swiping":Ke,"data-dismissible":lo,"data-type":Oo,"data-invert":ux,"data-swipe-out":at,"data-swipe-direction":wt,"data-expanded":!!(V||ne&&ze),style:{"--index":M,"--toasts-before":M,"--z-index":$.length-M,"--offset":`${we?Mr:qo.current}px`,"--initial-height":ne?"auto":`${ar}px`,...ee,...R.style},onDragEnd:()=>{Re(!1),Ze(null),Ju.current=null},onPointerDown:Gt=>{wy||!lo||(na.current=new Date,Mn(qo.current),Gt.target.setPointerCapture(Gt.pointerId),Gt.target.tagName!=="BUTTON"&&(Re(!0),Ju.current={x:Gt.clientX,y:Gt.clientY}))},onPointerUp:()=>{var Gt,wn,vr,Ts;if(at||!lo)return;Ju.current=null;let Cs=Number(((Gt=Yo.current)==null?void 0:Gt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Wr=Number(((wn=Yo.current)==null?void 0:wn.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),jl=new Date().getTime()-((vr=na.current)==null?void 0:vr.getTime()),Rs=Ge==="x"?Cs:Wr,As=Math.abs(Rs)/jl;if(Math.abs(Rs)>=WMe||As>.11){Mn(qo.current),(Ts=R.onDismiss)==null||Ts.call(R,R),Ft(Ge==="x"?Cs>0?"right":"left":Wr>0?"down":"up"),Fc(),mt(!0),nn(!1);return}Re(!1),Ze(null)},onPointerMove:Gt=>{var wn,vr,Ts,Cs;if(!Ju.current||!lo||((wn=window.getSelection())==null?void 0:wn.toString().length)>0)return;let Wr=Gt.clientY-Ju.current.y,jl=Gt.clientX-Ju.current.x,Rs=(vr=e.swipeDirections)!=null?vr:HMe(ge);!Ge&&(Math.abs(jl)>1||Math.abs(Wr)>1)&&Ze(Math.abs(jl)>Math.abs(Wr)?"x":"y");let As={x:0,y:0};Ge==="y"?(Rs.includes("top")||Rs.includes("bottom"))&&(Rs.includes("top")&&Wr<0||Rs.includes("bottom")&&Wr>0)&&(As.y=Wr):Ge==="x"&&(Rs.includes("left")||Rs.includes("right"))&&(Rs.includes("left")&&jl<0||Rs.includes("right")&&jl>0)&&(As.x=jl),(Math.abs(As.x)>0||Math.abs(As.y)>0)&&nn(!0),(Ts=Yo.current)==null||Ts.style.setProperty("--swipe-amount-x",`${As.x}px`),(Cs=Yo.current)==null||Cs.style.setProperty("--swipe-amount-y",`${As.y}px`)}},n0&&!R.jsx?se.createElement("button",{"aria-label":Ce,"data-disabled":wy,"data-close-button":!0,onClick:wy||!lo?()=>{}:()=>{var Gt;Fc(),(Gt=R.onDismiss)==null||Gt.call(R,R)},className:pc(ue==null?void 0:ue.closeButton,(a=R==null?void 0:R.classNames)==null?void 0:a.closeButton)},(l=_e==null?void 0:_e.close)!=null?l:IMe):null,R.jsx||N.isValidElement(R.title)?R.jsx?R.jsx:typeof R.title=="function"?R.title():R.title:se.createElement(se.Fragment,null,Oo||R.icon||R.promise?se.createElement("div",{"data-icon":"",className:pc(ue==null?void 0:ue.icon,(d=R==null?void 0:R.classNames)==null?void 0:d.icon)},R.promise||R.type==="loading"&&!R.icon?R.icon||$h():null,R.type!=="loading"?R.icon||(_e==null?void 0:_e[Oo])||SMe(Oo):null):null,se.createElement("div",{"data-content":"",className:pc(ue==null?void 0:ue.content,(f=R==null?void 0:R.classNames)==null?void 0:f.content)},se.createElement("div",{"data-title":"",className:pc(ue==null?void 0:ue.title,(m=R==null?void 0:R.classNames)==null?void 0:m.title)},typeof R.title=="function"?R.title():R.title),R.description?se.createElement("div",{"data-description":"",className:pc(ae,_y,ue==null?void 0:ue.description,(v=R==null?void 0:R.classNames)==null?void 0:v.description)},typeof R.description=="function"?R.description():R.description):null),N.isValidElement(R.cancel)?R.cancel:R.cancel&&_C(R.cancel)?se.createElement("button",{"data-button":!0,"data-cancel":!0,style:R.cancelButtonStyle||le,onClick:Gt=>{var wn,vr;_C(R.cancel)&&lo&&((vr=(wn=R.cancel).onClick)==null||vr.call(wn,Gt),Fc())},className:pc(ue==null?void 0:ue.cancelButton,(E=R==null?void 0:R.classNames)==null?void 0:E.cancelButton)},R.cancel.label):null,N.isValidElement(R.action)?R.action:R.action&&_C(R.action)?se.createElement("button",{"data-button":!0,"data-action":!0,style:R.actionButtonStyle||he,onClick:Gt=>{var wn,vr;_C(R.action)&&((vr=(wn=R.action).onClick)==null||vr.call(wn,Gt),!Gt.defaultPrevented&&Fc())},className:pc(ue==null?void 0:ue.actionButton,(S=R==null?void 0:R.classNames)==null?void 0:S.actionButton)},R.action.label):null))};function NX(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function zMe(e,t){let n={};return[e,t].forEach((i,a)=>{let l=a===1,d=l?"--mobile-offset":"--offset",f=l?FMe:VMe;function m(v){["top","right","bottom","left"].forEach(E=>{n[`${d}-${E}`]=typeof v=="number"?`${v}px`:v})}typeof i=="number"||typeof i=="string"?m(i):typeof i=="object"?["top","right","bottom","left"].forEach(v=>{i[v]===void 0?n[`${d}-${v}`]=f:n[`${d}-${v}`]=typeof i[v]=="number"?`${i[v]}px`:i[v]}):m(f)}),n}var YMe=N.forwardRef(function(e,t){let{invert:n,position:i="bottom-right",hotkey:a=["altKey","KeyT"],expand:l,closeButton:d,className:f,offset:m,mobileOffset:v,theme:E="light",richColors:S,duration:T,style:R,visibleToasts:I=UMe,toastOptions:O,dir:P=NX(),gap:D=$Me,loadingIcon:k,icons:M,containerAriaLabel:$="Notifications",pauseWhenPageIsHidden:V}=e,[W,H]=se.useState([]),J=se.useMemo(()=>Array.from(new Set([i].concat(W.filter(Ie=>Ie.position).map(Ie=>Ie.position)))),[W,i]),[ee,le]=se.useState([]),[he,de]=se.useState(!1),[ae,ce]=se.useState(!1),[ge,ye]=se.useState(E!=="system"?E:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),te=se.useRef(null),ne=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),ue=se.useRef(null),_e=se.useRef(!1),Ce=se.useCallback(Ie=>{H(Ge=>{var Ze;return(Ze=Ge.find(wt=>wt.id===Ie.id))!=null&&Ze.delete||ds.dismiss(Ie.id),Ge.filter(({id:wt})=>wt!==Ie.id)})},[]);return se.useEffect(()=>ds.subscribe(Ie=>{if(Ie.dismiss){H(Ge=>Ge.map(Ze=>Ze.id===Ie.id?{...Ze,delete:!0}:Ze));return}setTimeout(()=>{woe.flushSync(()=>{H(Ge=>{let Ze=Ge.findIndex(wt=>wt.id===Ie.id);return Ze!==-1?[...Ge.slice(0,Ze),{...Ge[Ze],...Ie},...Ge.slice(Ze+1)]:[Ie,...Ge]})})})}),[]),se.useEffect(()=>{if(E!=="system"){ye(E);return}if(E==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ye("dark"):ye("light")),typeof window>"u")return;let Ie=window.matchMedia("(prefers-color-scheme: dark)");try{Ie.addEventListener("change",({matches:Ge})=>{ye(Ge?"dark":"light")})}catch{Ie.addListener(({matches:Ze})=>{try{ye(Ze?"dark":"light")}catch(wt){console.error(wt)}})}},[E]),se.useEffect(()=>{W.length<=1&&de(!1)},[W]),se.useEffect(()=>{let Ie=Ge=>{var Ze,wt;a.every(Ft=>Ge[Ft]||Ge.code===Ft)&&(de(!0),(Ze=te.current)==null||Ze.focus()),Ge.code==="Escape"&&(document.activeElement===te.current||(wt=te.current)!=null&&wt.contains(document.activeElement))&&de(!1)};return document.addEventListener("keydown",Ie),()=>document.removeEventListener("keydown",Ie)},[a]),se.useEffect(()=>{if(te.current)return()=>{ue.current&&(ue.current.focus({preventScroll:!0}),ue.current=null,_e.current=!1)}},[te.current]),se.createElement("section",{ref:t,"aria-label":`${$} ${ne}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},J.map((Ie,Ge)=>{var Ze;let[wt,Ft]=Ie.split("-");return W.length?se.createElement("ol",{key:Ie,dir:P==="auto"?NX():P,tabIndex:-1,ref:te,className:f,"data-sonner-toaster":!0,"data-theme":ge,"data-y-position":wt,"data-lifted":he&&W.length>1&&!l,"data-x-position":Ft,style:{"--front-toast-height":`${((Ze=ee[0])==null?void 0:Ze.height)||0}px`,"--width":`${BMe}px`,"--gap":`${D}px`,...R,...zMe(m,v)},onBlur:ze=>{_e.current&&!ze.currentTarget.contains(ze.relatedTarget)&&(_e.current=!1,ue.current&&(ue.current.focus({preventScroll:!0}),ue.current=null))},onFocus:ze=>{ze.target instanceof HTMLElement&&ze.target.dataset.dismissible==="false"||_e.current||(_e.current=!0,ue.current=ze.relatedTarget)},onMouseEnter:()=>de(!0),onMouseMove:()=>de(!0),onMouseLeave:()=>{ae||de(!1)},onDragEnd:()=>de(!1),onPointerDown:ze=>{ze.target instanceof HTMLElement&&ze.target.dataset.dismissible==="false"||ce(!0)},onPointerUp:()=>ce(!1)},W.filter(ze=>!ze.position&&Ge===0||ze.position===Ie).map((ze,Nt)=>{var we,He;return se.createElement(KMe,{key:ze.id,icons:M,index:Nt,toast:ze,defaultRichColors:S,duration:(we=O==null?void 0:O.duration)!=null?we:T,className:O==null?void 0:O.className,descriptionClassName:O==null?void 0:O.descriptionClassName,invert:n,visibleToasts:I,closeButton:(He=O==null?void 0:O.closeButton)!=null?He:d,interacting:ae,position:Ie,style:O==null?void 0:O.style,unstyled:O==null?void 0:O.unstyled,classNames:O==null?void 0:O.classNames,cancelButtonStyle:O==null?void 0:O.cancelButtonStyle,actionButtonStyle:O==null?void 0:O.actionButtonStyle,removeToast:Ce,toasts:W.filter(Ke=>Ke.position==ze.position),heights:ee.filter(Ke=>Ke.position==ze.position),setHeights:le,expandByDefault:l,gap:D,loadingIcon:k,expanded:he,pauseWhenPageIsHidden:V,swipeDirections:e.swipeDirections})})):null}))});const qMe=({...e})=>{const{theme:t}=bMe(),n=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",i=t==="system"?n:t;return _.jsx(YMe,{theme:i,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var XMe=SU[" useId ".trim().toString()]||(()=>{}),JMe=0;function Tl(e){const[t,n]=N.useState(XMe());return Ei(()=>{n(i=>i??String(JMe++))},[e]),t?`radix-${t}`:""}const QMe=["top","right","bottom","left"],bh=Math.min,Ws=Math.max,FR=Math.round,EC=Math.floor,Cl=e=>({x:e,y:e}),ZMe={left:"right",right:"left",bottom:"top",top:"bottom"},e2e={start:"end",end:"start"};function ZM(e,t,n){return Ws(e,bh(t,n))}function ju(e,t){return typeof e=="function"?e(t):e}function Uu(e){return e.split("-")[0]}function Jv(e){return e.split("-")[1]}function EV(e){return e==="x"?"y":"x"}function bV(e){return e==="y"?"height":"width"}function bu(e){return["top","bottom"].includes(Uu(e))?"y":"x"}function SV(e){return EV(bu(e))}function t2e(e,t,n){n===void 0&&(n=!1);const i=Jv(e),a=SV(e),l=bV(a);let d=a==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return t.reference[l]>t.floating[l]&&(d=BR(d)),[d,BR(d)]}function n2e(e){const t=BR(e);return[e2(e),t,e2(t)]}function e2(e){return e.replace(/start|end/g,t=>e2e[t])}function r2e(e,t,n){const i=["left","right"],a=["right","left"],l=["top","bottom"],d=["bottom","top"];switch(e){case"top":case"bottom":return n?t?a:i:t?i:a;case"left":case"right":return t?l:d;default:return[]}}function i2e(e,t,n,i){const a=Jv(e);let l=r2e(Uu(e),n==="start",i);return a&&(l=l.map(d=>d+"-"+a),t&&(l=l.concat(l.map(e2)))),l}function BR(e){return e.replace(/left|right|bottom|top/g,t=>ZMe[t])}function o2e(e){return{top:0,right:0,bottom:0,left:0,...e}}function hse(e){return typeof e!="number"?o2e(e):{top:e,right:e,bottom:e,left:e}}function $R(e){const{x:t,y:n,width:i,height:a}=e;return{width:i,height:a,top:n,left:t,right:t+i,bottom:n+a,x:t,y:n}}function DX(e,t,n){let{reference:i,floating:a}=e;const l=bu(t),d=SV(t),f=bV(d),m=Uu(t),v=l==="y",E=i.x+i.width/2-a.width/2,S=i.y+i.height/2-a.height/2,T=i[f]/2-a[f]/2;let R;switch(m){case"top":R={x:E,y:i.y-a.height};break;case"bottom":R={x:E,y:i.y+i.height};break;case"right":R={x:i.x+i.width,y:S};break;case"left":R={x:i.x-a.width,y:S};break;default:R={x:i.x,y:i.y}}switch(Jv(t)){case"start":R[d]-=T*(n&&v?-1:1);break;case"end":R[d]+=T*(n&&v?-1:1);break}return R}const s2e=async(e,t,n)=>{const{placement:i="bottom",strategy:a="absolute",middleware:l=[],platform:d}=n,f=l.filter(Boolean),m=await(d.isRTL==null?void 0:d.isRTL(t));let v=await d.getElementRects({reference:e,floating:t,strategy:a}),{x:E,y:S}=DX(v,i,m),T=i,R={},I=0;for(let O=0;O<f.length;O++){const{name:P,fn:D}=f[O],{x:k,y:M,data:$,reset:V}=await D({x:E,y:S,initialPlacement:i,placement:T,strategy:a,middlewareData:R,rects:v,platform:d,elements:{reference:e,floating:t}});E=k??E,S=M??S,R={...R,[P]:{...R[P],...$}},V&&I<=50&&(I++,typeof V=="object"&&(V.placement&&(T=V.placement),V.rects&&(v=V.rects===!0?await d.getElementRects({reference:e,floating:t,strategy:a}):V.rects),{x:E,y:S}=DX(v,T,m)),O=-1)}return{x:E,y:S,placement:T,strategy:a,middlewareData:R}};async function wb(e,t){var n;t===void 0&&(t={});const{x:i,y:a,platform:l,rects:d,elements:f,strategy:m}=e,{boundary:v="clippingAncestors",rootBoundary:E="viewport",elementContext:S="floating",altBoundary:T=!1,padding:R=0}=ju(t,e),I=hse(R),P=f[T?S==="floating"?"reference":"floating":S],D=$R(await l.getClippingRect({element:(n=await(l.isElement==null?void 0:l.isElement(P)))==null||n?P:P.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(f.floating)),boundary:v,rootBoundary:E,strategy:m})),k=S==="floating"?{x:i,y:a,width:d.floating.width,height:d.floating.height}:d.reference,M=await(l.getOffsetParent==null?void 0:l.getOffsetParent(f.floating)),$=await(l.isElement==null?void 0:l.isElement(M))?await(l.getScale==null?void 0:l.getScale(M))||{x:1,y:1}:{x:1,y:1},V=$R(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:f,rect:k,offsetParent:M,strategy:m}):k);return{top:(D.top-V.top+I.top)/$.y,bottom:(V.bottom-D.bottom+I.bottom)/$.y,left:(D.left-V.left+I.left)/$.x,right:(V.right-D.right+I.right)/$.x}}const a2e=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:i,placement:a,rects:l,platform:d,elements:f,middlewareData:m}=t,{element:v,padding:E=0}=ju(e,t)||{};if(v==null)return{};const S=hse(E),T={x:n,y:i},R=SV(a),I=bV(R),O=await d.getDimensions(v),P=R==="y",D=P?"top":"left",k=P?"bottom":"right",M=P?"clientHeight":"clientWidth",$=l.reference[I]+l.reference[R]-T[R]-l.floating[I],V=T[R]-l.reference[R],W=await(d.getOffsetParent==null?void 0:d.getOffsetParent(v));let H=W?W[M]:0;(!H||!await(d.isElement==null?void 0:d.isElement(W)))&&(H=f.floating[M]||l.floating[I]);const J=$/2-V/2,ee=H/2-O[I]/2-1,le=bh(S[D],ee),he=bh(S[k],ee),de=le,ae=H-O[I]-he,ce=H/2-O[I]/2+J,ge=ZM(de,ce,ae),ye=!m.arrow&&Jv(a)!=null&&ce!==ge&&l.reference[I]/2-(ce<de?le:he)-O[I]/2<0,te=ye?ce<de?ce-de:ce-ae:0;return{[R]:T[R]+te,data:{[R]:ge,centerOffset:ce-ge-te,...ye&&{alignmentOffset:te}},reset:ye}}}),c2e=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,i;const{placement:a,middlewareData:l,rects:d,initialPlacement:f,platform:m,elements:v}=t,{mainAxis:E=!0,crossAxis:S=!0,fallbackPlacements:T,fallbackStrategy:R="bestFit",fallbackAxisSideDirection:I="none",flipAlignment:O=!0,...P}=ju(e,t);if((n=l.arrow)!=null&&n.alignmentOffset)return{};const D=Uu(a),k=bu(f),M=Uu(f)===f,$=await(m.isRTL==null?void 0:m.isRTL(v.floating)),V=T||(M||!O?[BR(f)]:n2e(f)),W=I!=="none";!T&&W&&V.push(...i2e(f,O,I,$));const H=[f,...V],J=await wb(t,P),ee=[];let le=((i=l.flip)==null?void 0:i.overflows)||[];if(E&&ee.push(J[D]),S){const ge=t2e(a,d,$);ee.push(J[ge[0]],J[ge[1]])}if(le=[...le,{placement:a,overflows:ee}],!ee.every(ge=>ge<=0)){var he,de;const ge=(((he=l.flip)==null?void 0:he.index)||0)+1,ye=H[ge];if(ye){var ae;const ne=S==="alignment"?k!==bu(ye):!1,ue=((ae=le[0])==null?void 0:ae.overflows[0])>0;if(!ne||ue)return{data:{index:ge,overflows:le},reset:{placement:ye}}}let te=(de=le.filter(ne=>ne.overflows[0]<=0).sort((ne,ue)=>ne.overflows[1]-ue.overflows[1])[0])==null?void 0:de.placement;if(!te)switch(R){case"bestFit":{var ce;const ne=(ce=le.filter(ue=>{if(W){const _e=bu(ue.placement);return _e===k||_e==="y"}return!0}).map(ue=>[ue.placement,ue.overflows.filter(_e=>_e>0).reduce((_e,Ce)=>_e+Ce,0)]).sort((ue,_e)=>ue[1]-_e[1])[0])==null?void 0:ce[0];ne&&(te=ne);break}case"initialPlacement":te=f;break}if(a!==te)return{reset:{placement:te}}}return{}}}};function kX(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function LX(e){return QMe.some(t=>e[t]>=0)}const l2e=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:i="referenceHidden",...a}=ju(e,t);switch(i){case"referenceHidden":{const l=await wb(t,{...a,elementContext:"reference"}),d=kX(l,n.reference);return{data:{referenceHiddenOffsets:d,referenceHidden:LX(d)}}}case"escaped":{const l=await wb(t,{...a,altBoundary:!0}),d=kX(l,n.floating);return{data:{escapedOffsets:d,escaped:LX(d)}}}default:return{}}}}};async function u2e(e,t){const{placement:n,platform:i,elements:a}=e,l=await(i.isRTL==null?void 0:i.isRTL(a.floating)),d=Uu(n),f=Jv(n),m=bu(n)==="y",v=["left","top"].includes(d)?-1:1,E=l&&m?-1:1,S=ju(t,e);let{mainAxis:T,crossAxis:R,alignmentAxis:I}=typeof S=="number"?{mainAxis:S,crossAxis:0,alignmentAxis:null}:{mainAxis:S.mainAxis||0,crossAxis:S.crossAxis||0,alignmentAxis:S.alignmentAxis};return f&&typeof I=="number"&&(R=f==="end"?I*-1:I),m?{x:R*E,y:T*v}:{x:T*v,y:R*E}}const d2e=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,i;const{x:a,y:l,placement:d,middlewareData:f}=t,m=await u2e(t,e);return d===((n=f.offset)==null?void 0:n.placement)&&(i=f.arrow)!=null&&i.alignmentOffset?{}:{x:a+m.x,y:l+m.y,data:{...m,placement:d}}}}},h2e=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:i,placement:a}=t,{mainAxis:l=!0,crossAxis:d=!1,limiter:f={fn:P=>{let{x:D,y:k}=P;return{x:D,y:k}}},...m}=ju(e,t),v={x:n,y:i},E=await wb(t,m),S=bu(Uu(a)),T=EV(S);let R=v[T],I=v[S];if(l){const P=T==="y"?"top":"left",D=T==="y"?"bottom":"right",k=R+E[P],M=R-E[D];R=ZM(k,R,M)}if(d){const P=S==="y"?"top":"left",D=S==="y"?"bottom":"right",k=I+E[P],M=I-E[D];I=ZM(k,I,M)}const O=f.fn({...t,[T]:R,[S]:I});return{...O,data:{x:O.x-n,y:O.y-i,enabled:{[T]:l,[S]:d}}}}}},f2e=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:i,placement:a,rects:l,middlewareData:d}=t,{offset:f=0,mainAxis:m=!0,crossAxis:v=!0}=ju(e,t),E={x:n,y:i},S=bu(a),T=EV(S);let R=E[T],I=E[S];const O=ju(f,t),P=typeof O=="number"?{mainAxis:O,crossAxis:0}:{mainAxis:0,crossAxis:0,...O};if(m){const M=T==="y"?"height":"width",$=l.reference[T]-l.floating[M]+P.mainAxis,V=l.reference[T]+l.reference[M]-P.mainAxis;R<$?R=$:R>V&&(R=V)}if(v){var D,k;const M=T==="y"?"width":"height",$=["top","left"].includes(Uu(a)),V=l.reference[S]-l.floating[M]+($&&((D=d.offset)==null?void 0:D[S])||0)+($?0:P.crossAxis),W=l.reference[S]+l.reference[M]+($?0:((k=d.offset)==null?void 0:k[S])||0)-($?P.crossAxis:0);I<V?I=V:I>W&&(I=W)}return{[T]:R,[S]:I}}}},p2e=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,i;const{placement:a,rects:l,platform:d,elements:f}=t,{apply:m=()=>{},...v}=ju(e,t),E=await wb(t,v),S=Uu(a),T=Jv(a),R=bu(a)==="y",{width:I,height:O}=l.floating;let P,D;S==="top"||S==="bottom"?(P=S,D=T===(await(d.isRTL==null?void 0:d.isRTL(f.floating))?"start":"end")?"left":"right"):(D=S,P=T==="end"?"top":"bottom");const k=O-E.top-E.bottom,M=I-E.left-E.right,$=bh(O-E[P],k),V=bh(I-E[D],M),W=!t.middlewareData.shift;let H=$,J=V;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(J=M),(i=t.middlewareData.shift)!=null&&i.enabled.y&&(H=k),W&&!T){const le=Ws(E.left,0),he=Ws(E.right,0),de=Ws(E.top,0),ae=Ws(E.bottom,0);R?J=I-2*(le!==0||he!==0?le+he:Ws(E.left,E.right)):H=O-2*(de!==0||ae!==0?de+ae:Ws(E.top,E.bottom))}await m({...t,availableWidth:J,availableHeight:H});const ee=await d.getDimensions(f.floating);return I!==ee.width||O!==ee.height?{reset:{rects:!0}}:{}}}};function OO(){return typeof window<"u"}function Qv(e){return fse(e)?(e.nodeName||"").toLowerCase():"#document"}function zs(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Dl(e){var t;return(t=(fse(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function fse(e){return OO()?e instanceof Node||e instanceof zs(e).Node:!1}function Dc(e){return OO()?e instanceof Element||e instanceof zs(e).Element:!1}function xl(e){return OO()?e instanceof HTMLElement||e instanceof zs(e).HTMLElement:!1}function MX(e){return!OO()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof zs(e).ShadowRoot}function IS(e){const{overflow:t,overflowX:n,overflowY:i,display:a}=kc(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!["inline","contents"].includes(a)}function m2e(e){return["table","td","th"].includes(Qv(e))}function IO(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function wV(e){const t=TV(),n=Dc(e)?kc(e):e;return["transform","translate","scale","rotate","perspective"].some(i=>n[i]?n[i]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(i=>(n.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(n.contain||"").includes(i))}function g2e(e){let t=Sh(e);for(;xl(t)&&!hv(t);){if(wV(t))return t;if(IO(t))return null;t=Sh(t)}return null}function TV(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function hv(e){return["html","body","#document"].includes(Qv(e))}function kc(e){return zs(e).getComputedStyle(e)}function xO(e){return Dc(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Sh(e){if(Qv(e)==="html")return e;const t=e.assignedSlot||e.parentNode||MX(e)&&e.host||Dl(e);return MX(t)?t.host:t}function pse(e){const t=Sh(e);return hv(t)?e.ownerDocument?e.ownerDocument.body:e.body:xl(t)&&IS(t)?t:pse(t)}function Tb(e,t,n){var i;t===void 0&&(t=[]),n===void 0&&(n=!0);const a=pse(e),l=a===((i=e.ownerDocument)==null?void 0:i.body),d=zs(a);if(l){const f=t2(d);return t.concat(d,d.visualViewport||[],IS(a)?a:[],f&&n?Tb(f):[])}return t.concat(a,Tb(a,[],n))}function t2(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function mse(e){const t=kc(e);let n=parseFloat(t.width)||0,i=parseFloat(t.height)||0;const a=xl(e),l=a?e.offsetWidth:n,d=a?e.offsetHeight:i,f=FR(n)!==l||FR(i)!==d;return f&&(n=l,i=d),{width:n,height:i,$:f}}function CV(e){return Dc(e)?e:e.contextElement}function Gg(e){const t=CV(e);if(!xl(t))return Cl(1);const n=t.getBoundingClientRect(),{width:i,height:a,$:l}=mse(t);let d=(l?FR(n.width):n.width)/i,f=(l?FR(n.height):n.height)/a;return(!d||!Number.isFinite(d))&&(d=1),(!f||!Number.isFinite(f))&&(f=1),{x:d,y:f}}const v2e=Cl(0);function gse(e){const t=zs(e);return!TV()||!t.visualViewport?v2e:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function y2e(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==zs(e)?!1:t}function vp(e,t,n,i){t===void 0&&(t=!1),n===void 0&&(n=!1);const a=e.getBoundingClientRect(),l=CV(e);let d=Cl(1);t&&(i?Dc(i)&&(d=Gg(i)):d=Gg(e));const f=y2e(l,n,i)?gse(l):Cl(0);let m=(a.left+f.x)/d.x,v=(a.top+f.y)/d.y,E=a.width/d.x,S=a.height/d.y;if(l){const T=zs(l),R=i&&Dc(i)?zs(i):i;let I=T,O=t2(I);for(;O&&i&&R!==I;){const P=Gg(O),D=O.getBoundingClientRect(),k=kc(O),M=D.left+(O.clientLeft+parseFloat(k.paddingLeft))*P.x,$=D.top+(O.clientTop+parseFloat(k.paddingTop))*P.y;m*=P.x,v*=P.y,E*=P.x,S*=P.y,m+=M,v+=$,I=zs(O),O=t2(I)}}return $R({width:E,height:S,x:m,y:v})}function RV(e,t){const n=xO(e).scrollLeft;return t?t.left+n:vp(Dl(e)).left+n}function vse(e,t,n){n===void 0&&(n=!1);const i=e.getBoundingClientRect(),a=i.left+t.scrollLeft-(n?0:RV(e,i)),l=i.top+t.scrollTop;return{x:a,y:l}}function _2e(e){let{elements:t,rect:n,offsetParent:i,strategy:a}=e;const l=a==="fixed",d=Dl(i),f=t?IO(t.floating):!1;if(i===d||f&&l)return n;let m={scrollLeft:0,scrollTop:0},v=Cl(1);const E=Cl(0),S=xl(i);if((S||!S&&!l)&&((Qv(i)!=="body"||IS(d))&&(m=xO(i)),xl(i))){const R=vp(i);v=Gg(i),E.x=R.x+i.clientLeft,E.y=R.y+i.clientTop}const T=d&&!S&&!l?vse(d,m,!0):Cl(0);return{width:n.width*v.x,height:n.height*v.y,x:n.x*v.x-m.scrollLeft*v.x+E.x+T.x,y:n.y*v.y-m.scrollTop*v.y+E.y+T.y}}function E2e(e){return Array.from(e.getClientRects())}function b2e(e){const t=Dl(e),n=xO(e),i=e.ownerDocument.body,a=Ws(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),l=Ws(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight);let d=-n.scrollLeft+RV(e);const f=-n.scrollTop;return kc(i).direction==="rtl"&&(d+=Ws(t.clientWidth,i.clientWidth)-a),{width:a,height:l,x:d,y:f}}function S2e(e,t){const n=zs(e),i=Dl(e),a=n.visualViewport;let l=i.clientWidth,d=i.clientHeight,f=0,m=0;if(a){l=a.width,d=a.height;const v=TV();(!v||v&&t==="fixed")&&(f=a.offsetLeft,m=a.offsetTop)}return{width:l,height:d,x:f,y:m}}function w2e(e,t){const n=vp(e,!0,t==="fixed"),i=n.top+e.clientTop,a=n.left+e.clientLeft,l=xl(e)?Gg(e):Cl(1),d=e.clientWidth*l.x,f=e.clientHeight*l.y,m=a*l.x,v=i*l.y;return{width:d,height:f,x:m,y:v}}function jX(e,t,n){let i;if(t==="viewport")i=S2e(e,n);else if(t==="document")i=b2e(Dl(e));else if(Dc(t))i=w2e(t,n);else{const a=gse(e);i={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return $R(i)}function yse(e,t){const n=Sh(e);return n===t||!Dc(n)||hv(n)?!1:kc(n).position==="fixed"||yse(n,t)}function T2e(e,t){const n=t.get(e);if(n)return n;let i=Tb(e,[],!1).filter(f=>Dc(f)&&Qv(f)!=="body"),a=null;const l=kc(e).position==="fixed";let d=l?Sh(e):e;for(;Dc(d)&&!hv(d);){const f=kc(d),m=wV(d);!m&&f.position==="fixed"&&(a=null),(l?!m&&!a:!m&&f.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||IS(d)&&!m&&yse(e,d))?i=i.filter(E=>E!==d):a=f,d=Sh(d)}return t.set(e,i),i}function C2e(e){let{element:t,boundary:n,rootBoundary:i,strategy:a}=e;const d=[...n==="clippingAncestors"?IO(t)?[]:T2e(t,this._c):[].concat(n),i],f=d[0],m=d.reduce((v,E)=>{const S=jX(t,E,a);return v.top=Ws(S.top,v.top),v.right=bh(S.right,v.right),v.bottom=bh(S.bottom,v.bottom),v.left=Ws(S.left,v.left),v},jX(t,f,a));return{width:m.right-m.left,height:m.bottom-m.top,x:m.left,y:m.top}}function R2e(e){const{width:t,height:n}=mse(e);return{width:t,height:n}}function A2e(e,t,n){const i=xl(t),a=Dl(t),l=n==="fixed",d=vp(e,!0,l,t);let f={scrollLeft:0,scrollTop:0};const m=Cl(0);function v(){m.x=RV(a)}if(i||!i&&!l)if((Qv(t)!=="body"||IS(a))&&(f=xO(t)),i){const R=vp(t,!0,l,t);m.x=R.x+t.clientLeft,m.y=R.y+t.clientTop}else a&&v();l&&!i&&a&&v();const E=a&&!i&&!l?vse(a,f):Cl(0),S=d.left+f.scrollLeft-m.x-E.x,T=d.top+f.scrollTop-m.y-E.y;return{x:S,y:T,width:d.width,height:d.height}}function Bk(e){return kc(e).position==="static"}function UX(e,t){if(!xl(e)||kc(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Dl(e)===n&&(n=n.ownerDocument.body),n}function _se(e,t){const n=zs(e);if(IO(e))return n;if(!xl(e)){let a=Sh(e);for(;a&&!hv(a);){if(Dc(a)&&!Bk(a))return a;a=Sh(a)}return n}let i=UX(e,t);for(;i&&m2e(i)&&Bk(i);)i=UX(i,t);return i&&hv(i)&&Bk(i)&&!wV(i)?n:i||g2e(e)||n}const O2e=async function(e){const t=this.getOffsetParent||_se,n=this.getDimensions,i=await n(e.floating);return{reference:A2e(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}};function I2e(e){return kc(e).direction==="rtl"}const x2e={convertOffsetParentRelativeRectToViewportRelativeRect:_2e,getDocumentElement:Dl,getClippingRect:C2e,getOffsetParent:_se,getElementRects:O2e,getClientRects:E2e,getDimensions:R2e,getScale:Gg,isElement:Dc,isRTL:I2e};function Ese(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function P2e(e,t){let n=null,i;const a=Dl(e);function l(){var f;clearTimeout(i),(f=n)==null||f.disconnect(),n=null}function d(f,m){f===void 0&&(f=!1),m===void 0&&(m=1),l();const v=e.getBoundingClientRect(),{left:E,top:S,width:T,height:R}=v;if(f||t(),!T||!R)return;const I=EC(S),O=EC(a.clientWidth-(E+T)),P=EC(a.clientHeight-(S+R)),D=EC(E),M={rootMargin:-I+"px "+-O+"px "+-P+"px "+-D+"px",threshold:Ws(0,bh(1,m))||1};let $=!0;function V(W){const H=W[0].intersectionRatio;if(H!==m){if(!$)return d();H?d(!1,H):i=setTimeout(()=>{d(!1,1e-7)},1e3)}H===1&&!Ese(v,e.getBoundingClientRect())&&d(),$=!1}try{n=new IntersectionObserver(V,{...M,root:a.ownerDocument})}catch{n=new IntersectionObserver(V,M)}n.observe(e)}return d(!0),l}function N2e(e,t,n,i){i===void 0&&(i={});const{ancestorScroll:a=!0,ancestorResize:l=!0,elementResize:d=typeof ResizeObserver=="function",layoutShift:f=typeof IntersectionObserver=="function",animationFrame:m=!1}=i,v=CV(e),E=a||l?[...v?Tb(v):[],...Tb(t)]:[];E.forEach(D=>{a&&D.addEventListener("scroll",n,{passive:!0}),l&&D.addEventListener("resize",n)});const S=v&&f?P2e(v,n):null;let T=-1,R=null;d&&(R=new ResizeObserver(D=>{let[k]=D;k&&k.target===v&&R&&(R.unobserve(t),cancelAnimationFrame(T),T=requestAnimationFrame(()=>{var M;(M=R)==null||M.observe(t)})),n()}),v&&!m&&R.observe(v),R.observe(t));let I,O=m?vp(e):null;m&&P();function P(){const D=vp(e);O&&!Ese(O,D)&&n(),O=D,I=requestAnimationFrame(P)}return n(),()=>{var D;E.forEach(k=>{a&&k.removeEventListener("scroll",n),l&&k.removeEventListener("resize",n)}),S==null||S(),(D=R)==null||D.disconnect(),R=null,m&&cancelAnimationFrame(I)}}const D2e=d2e,k2e=h2e,L2e=c2e,M2e=p2e,j2e=l2e,VX=a2e,U2e=f2e,V2e=(e,t,n)=>{const i=new Map,a={platform:x2e,...n},l={...a.platform,_c:i};return s2e(e,t,{...a,platform:l})};var cR=typeof document<"u"?N.useLayoutEffect:N.useEffect;function WR(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,i,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(i=n;i--!==0;)if(!WR(e[i],t[i]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!{}.hasOwnProperty.call(t,a[i]))return!1;for(i=n;i--!==0;){const l=a[i];if(!(l==="_owner"&&e.$$typeof)&&!WR(e[l],t[l]))return!1}return!0}return e!==e&&t!==t}function bse(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function FX(e,t){const n=bse(e);return Math.round(t*n)/n}function $k(e){const t=N.useRef(e);return cR(()=>{t.current=e}),t}function F2e(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:i=[],platform:a,elements:{reference:l,floating:d}={},transform:f=!0,whileElementsMounted:m,open:v}=e,[E,S]=N.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[T,R]=N.useState(i);WR(T,i)||R(i);const[I,O]=N.useState(null),[P,D]=N.useState(null),k=N.useCallback(ne=>{ne!==W.current&&(W.current=ne,O(ne))},[]),M=N.useCallback(ne=>{ne!==H.current&&(H.current=ne,D(ne))},[]),$=l||I,V=d||P,W=N.useRef(null),H=N.useRef(null),J=N.useRef(E),ee=m!=null,le=$k(m),he=$k(a),de=$k(v),ae=N.useCallback(()=>{if(!W.current||!H.current)return;const ne={placement:t,strategy:n,middleware:T};he.current&&(ne.platform=he.current),V2e(W.current,H.current,ne).then(ue=>{const _e={...ue,isPositioned:de.current!==!1};ce.current&&!WR(J.current,_e)&&(J.current=_e,Ip.flushSync(()=>{S(_e)}))})},[T,t,n,he,de]);cR(()=>{v===!1&&J.current.isPositioned&&(J.current.isPositioned=!1,S(ne=>({...ne,isPositioned:!1})))},[v]);const ce=N.useRef(!1);cR(()=>(ce.current=!0,()=>{ce.current=!1}),[]),cR(()=>{if($&&(W.current=$),V&&(H.current=V),$&&V){if(le.current)return le.current($,V,ae);ae()}},[$,V,ae,le,ee]);const ge=N.useMemo(()=>({reference:W,floating:H,setReference:k,setFloating:M}),[k,M]),ye=N.useMemo(()=>({reference:$,floating:V}),[$,V]),te=N.useMemo(()=>{const ne={position:n,left:0,top:0};if(!ye.floating)return ne;const ue=FX(ye.floating,E.x),_e=FX(ye.floating,E.y);return f?{...ne,transform:"translate("+ue+"px, "+_e+"px)",...bse(ye.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:ue,top:_e}},[n,f,ye.floating,E.x,E.y]);return N.useMemo(()=>({...E,update:ae,refs:ge,elements:ye,floatingStyles:te}),[E,ae,ge,ye,te])}const B2e=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:i,padding:a}=typeof e=="function"?e(n):e;return i&&t(i)?i.current!=null?VX({element:i.current,padding:a}).fn(n):{}:i?VX({element:i,padding:a}).fn(n):{}}}},$2e=(e,t)=>({...D2e(e),options:[e,t]}),W2e=(e,t)=>({...k2e(e),options:[e,t]}),G2e=(e,t)=>({...U2e(e),options:[e,t]}),H2e=(e,t)=>({...L2e(e),options:[e,t]}),K2e=(e,t)=>({...M2e(e),options:[e,t]}),z2e=(e,t)=>({...j2e(e),options:[e,t]}),Y2e=(e,t)=>({...B2e(e),options:[e,t]});var q2e="Arrow",Sse=N.forwardRef((e,t)=>{const{children:n,width:i=10,height:a=5,...l}=e;return _.jsx(yt.svg,{...l,ref:t,width:i,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:_.jsx("polygon",{points:"0,0 30,0 15,10"})})});Sse.displayName=q2e;var X2e=Sse;function wse(e){const[t,n]=N.useState(void 0);return Ei(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const i=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const l=a[0];let d,f;if("borderBoxSize"in l){const m=l.borderBoxSize,v=Array.isArray(m)?m[0]:m;d=v.inlineSize,f=v.blockSize}else d=e.offsetWidth,f=e.offsetHeight;n({width:d,height:f})});return i.observe(e,{box:"border-box"}),()=>i.unobserve(e)}else n(void 0)},[e]),t}var AV="Popper",[Tse,Zv]=ta(AV),[J2e,Cse]=Tse(AV),Rse=e=>{const{__scopePopper:t,children:n}=e,[i,a]=N.useState(null);return _.jsx(J2e,{scope:t,anchor:i,onAnchorChange:a,children:n})};Rse.displayName=AV;var Ase="PopperAnchor",Ose=N.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:i,...a}=e,l=Cse(Ase,n),d=N.useRef(null),f=fn(t,d);return N.useEffect(()=>{l.onAnchorChange((i==null?void 0:i.current)||d.current)}),i?null:_.jsx(yt.div,{...a,ref:f})});Ose.displayName=Ase;var OV="PopperContent",[Q2e,Z2e]=Tse(OV),Ise=N.forwardRef((e,t)=>{var ze,Nt,we,He,Ke,Re;const{__scopePopper:n,side:i="bottom",sideOffset:a=0,align:l="center",alignOffset:d=0,arrowPadding:f=0,avoidCollisions:m=!0,collisionBoundary:v=[],collisionPadding:E=0,sticky:S="partial",hideWhenDetached:T=!1,updatePositionStrategy:R="optimized",onPlaced:I,...O}=e,P=Cse(OV,n),[D,k]=N.useState(null),M=fn(t,at=>k(at)),[$,V]=N.useState(null),W=wse($),H=(W==null?void 0:W.width)??0,J=(W==null?void 0:W.height)??0,ee=i+(l!=="center"?"-"+l:""),le=typeof E=="number"?E:{top:0,right:0,bottom:0,left:0,...E},he=Array.isArray(v)?v:[v],de=he.length>0,ae={padding:le,boundary:he.filter(tje),altBoundary:de},{refs:ce,floatingStyles:ge,placement:ye,isPositioned:te,middlewareData:ne}=F2e({strategy:"fixed",placement:ee,whileElementsMounted:(...at)=>N2e(...at,{animationFrame:R==="always"}),elements:{reference:P.anchor},middleware:[$2e({mainAxis:a+J,alignmentAxis:d}),m&&W2e({mainAxis:!0,crossAxis:!1,limiter:S==="partial"?G2e():void 0,...ae}),m&&H2e({...ae}),K2e({...ae,apply:({elements:at,rects:mt,availableWidth:At,availableHeight:nn})=>{const{width:Mr,height:Mn}=mt.reference,ar=at.floating.style;ar.setProperty("--radix-popper-available-width",`${At}px`),ar.setProperty("--radix-popper-available-height",`${nn}px`),ar.setProperty("--radix-popper-anchor-width",`${Mr}px`),ar.setProperty("--radix-popper-anchor-height",`${Mn}px`)}}),$&&Y2e({element:$,padding:f}),nje({arrowWidth:H,arrowHeight:J}),T&&z2e({strategy:"referenceHidden",...ae})]}),[ue,_e]=Nse(ye),Ce=hi(I);Ei(()=>{te&&(Ce==null||Ce())},[te,Ce]);const Ie=(ze=ne.arrow)==null?void 0:ze.x,Ge=(Nt=ne.arrow)==null?void 0:Nt.y,Ze=((we=ne.arrow)==null?void 0:we.centerOffset)!==0,[wt,Ft]=N.useState();return Ei(()=>{D&&Ft(window.getComputedStyle(D).zIndex)},[D]),_.jsx("div",{ref:ce.setFloating,"data-radix-popper-content-wrapper":"",style:{...ge,transform:te?ge.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:wt,"--radix-popper-transform-origin":[(He=ne.transformOrigin)==null?void 0:He.x,(Ke=ne.transformOrigin)==null?void 0:Ke.y].join(" "),...((Re=ne.hide)==null?void 0:Re.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:_.jsx(Q2e,{scope:n,placedSide:ue,onArrowChange:V,arrowX:Ie,arrowY:Ge,shouldHideArrow:Ze,children:_.jsx(yt.div,{"data-side":ue,"data-align":_e,...O,ref:M,style:{...O.style,animation:te?void 0:"none"}})})})});Ise.displayName=OV;var xse="PopperArrow",eje={top:"bottom",right:"left",bottom:"top",left:"right"},Pse=N.forwardRef(function(t,n){const{__scopePopper:i,...a}=t,l=Z2e(xse,i),d=eje[l.placedSide];return _.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[d]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:_.jsx(X2e,{...a,ref:n,style:{...a.style,display:"block"}})})});Pse.displayName=xse;function tje(e){return e!==null}var nje=e=>({name:"transformOrigin",options:e,fn(t){var P,D,k;const{placement:n,rects:i,middlewareData:a}=t,d=((P=a.arrow)==null?void 0:P.centerOffset)!==0,f=d?0:e.arrowWidth,m=d?0:e.arrowHeight,[v,E]=Nse(n),S={start:"0%",center:"50%",end:"100%"}[E],T=(((D=a.arrow)==null?void 0:D.x)??0)+f/2,R=(((k=a.arrow)==null?void 0:k.y)??0)+m/2;let I="",O="";return v==="bottom"?(I=d?S:`${T}px`,O=`${-m}px`):v==="top"?(I=d?S:`${T}px`,O=`${i.floating.height+m}px`):v==="right"?(I=`${-m}px`,O=d?S:`${R}px`):v==="left"&&(I=`${i.floating.width+m}px`,O=d?S:`${R}px`),{data:{x:I,y:O}}}});function Nse(e){const[t,n="center"]=e.split("-");return[t,n]}var Dse=Rse,IV=Ose,xV=Ise,PV=Pse,[PO,hEt]=ta("Tooltip",[Zv]),NV=Zv(),kse="TooltipProvider",rje=700,BX="tooltip.open",[ije,Lse]=PO(kse),Mse=e=>{const{__scopeTooltip:t,delayDuration:n=rje,skipDelayDuration:i=300,disableHoverableContent:a=!1,children:l}=e,d=N.useRef(!0),f=N.useRef(!1),m=N.useRef(0);return N.useEffect(()=>{const v=m.current;return()=>window.clearTimeout(v)},[]),_.jsx(ije,{scope:t,isOpenDelayedRef:d,delayDuration:n,onOpen:N.useCallback(()=>{window.clearTimeout(m.current),d.current=!1},[]),onClose:N.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>d.current=!0,i)},[i]),isPointerInTransitRef:f,onPointerInTransitChange:N.useCallback(v=>{f.current=v},[]),disableHoverableContent:a,children:l})};Mse.displayName=kse;var jse="Tooltip",[fEt,NO]=PO(jse),n2="TooltipTrigger",oje=N.forwardRef((e,t)=>{const{__scopeTooltip:n,...i}=e,a=NO(n2,n),l=Lse(n2,n),d=NV(n),f=N.useRef(null),m=fn(t,f,a.onTriggerChange),v=N.useRef(!1),E=N.useRef(!1),S=N.useCallback(()=>v.current=!1,[]);return N.useEffect(()=>()=>document.removeEventListener("pointerup",S),[S]),_.jsx(IV,{asChild:!0,...d,children:_.jsx(yt.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...i,ref:m,onPointerMove:et(e.onPointerMove,T=>{T.pointerType!=="touch"&&!E.current&&!l.isPointerInTransitRef.current&&(a.onTriggerEnter(),E.current=!0)}),onPointerLeave:et(e.onPointerLeave,()=>{a.onTriggerLeave(),E.current=!1}),onPointerDown:et(e.onPointerDown,()=>{a.open&&a.onClose(),v.current=!0,document.addEventListener("pointerup",S,{once:!0})}),onFocus:et(e.onFocus,()=>{v.current||a.onOpen()}),onBlur:et(e.onBlur,a.onClose),onClick:et(e.onClick,a.onClose)})})});oje.displayName=n2;var sje="TooltipPortal",[pEt,aje]=PO(sje,{forceMount:void 0}),fv="TooltipContent",Use=N.forwardRef((e,t)=>{const n=aje(fv,e.__scopeTooltip),{forceMount:i=n.forceMount,side:a="top",...l}=e,d=NO(fv,e.__scopeTooltip);return _.jsx(Ao,{present:i||d.open,children:d.disableHoverableContent?_.jsx(Vse,{side:a,...l,ref:t}):_.jsx(cje,{side:a,...l,ref:t})})}),cje=N.forwardRef((e,t)=>{const n=NO(fv,e.__scopeTooltip),i=Lse(fv,e.__scopeTooltip),a=N.useRef(null),l=fn(t,a),[d,f]=N.useState(null),{trigger:m,onClose:v}=n,E=a.current,{onPointerInTransitChange:S}=i,T=N.useCallback(()=>{f(null),S(!1)},[S]),R=N.useCallback((I,O)=>{const P=I.currentTarget,D={x:I.clientX,y:I.clientY},k=fje(D,P.getBoundingClientRect()),M=pje(D,k),$=mje(O.getBoundingClientRect()),V=vje([...M,...$]);f(V),S(!0)},[S]);return N.useEffect(()=>()=>T(),[T]),N.useEffect(()=>{if(m&&E){const I=P=>R(P,E),O=P=>R(P,m);return m.addEventListener("pointerleave",I),E.addEventListener("pointerleave",O),()=>{m.removeEventListener("pointerleave",I),E.removeEventListener("pointerleave",O)}}},[m,E,R,T]),N.useEffect(()=>{if(d){const I=O=>{const P=O.target,D={x:O.clientX,y:O.clientY},k=(m==null?void 0:m.contains(P))||(E==null?void 0:E.contains(P)),M=!gje(D,d);k?T():M&&(T(),v())};return document.addEventListener("pointermove",I),()=>document.removeEventListener("pointermove",I)}},[m,E,d,v,T]),_.jsx(Vse,{...e,ref:l})}),[lje,uje]=PO(jse,{isInside:!1}),dje=Mke("TooltipContent"),Vse=N.forwardRef((e,t)=>{const{__scopeTooltip:n,children:i,"aria-label":a,onEscapeKeyDown:l,onPointerDownOutside:d,...f}=e,m=NO(fv,n),v=NV(n),{onClose:E}=m;return N.useEffect(()=>(document.addEventListener(BX,E),()=>document.removeEventListener(BX,E)),[E]),N.useEffect(()=>{if(m.trigger){const S=T=>{const R=T.target;R!=null&&R.contains(m.trigger)&&E()};return window.addEventListener("scroll",S,{capture:!0}),()=>window.removeEventListener("scroll",S,{capture:!0})}},[m.trigger,E]),_.jsx(qv,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:l,onPointerDownOutside:d,onFocusOutside:S=>S.preventDefault(),onDismiss:E,children:_.jsxs(xV,{"data-state":m.stateAttribute,...v,...f,ref:t,style:{...f.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[_.jsx(dje,{children:i}),_.jsx(lje,{scope:n,isInside:!0,children:_.jsx(iLe,{id:m.contentId,role:"tooltip",children:a||i})})]})})});Use.displayName=fv;var Fse="TooltipArrow",hje=N.forwardRef((e,t)=>{const{__scopeTooltip:n,...i}=e,a=NV(n);return uje(Fse,n).isInside?null:_.jsx(PV,{...a,...i,ref:t})});hje.displayName=Fse;function fje(e,t){const n=Math.abs(t.top-e.y),i=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),l=Math.abs(t.left-e.x);switch(Math.min(n,i,a,l)){case l:return"left";case a:return"right";case n:return"top";case i:return"bottom";default:throw new Error("unreachable")}}function pje(e,t,n=5){const i=[];switch(t){case"top":i.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":i.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":i.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":i.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return i}function mje(e){const{top:t,right:n,bottom:i,left:a}=e;return[{x:a,y:t},{x:n,y:t},{x:n,y:i},{x:a,y:i}]}function gje(e,t){const{x:n,y:i}=e;let a=!1;for(let l=0,d=t.length-1;l<t.length;d=l++){const f=t[l],m=t[d],v=f.x,E=f.y,S=m.x,T=m.y;E>i!=T>i&&n<(S-v)*(i-E)/(T-E)+v&&(a=!a)}return a}function vje(e){const t=e.slice();return t.sort((n,i)=>n.x<i.x?-1:n.x>i.x?1:n.y<i.y?-1:n.y>i.y?1:0),yje(t)}function yje(e){if(e.length<=1)return e.slice();const t=[];for(let i=0;i<e.length;i++){const a=e[i];for(;t.length>=2;){const l=t[t.length-1],d=t[t.length-2];if((l.x-d.x)*(a.y-d.y)>=(l.y-d.y)*(a.x-d.x))t.pop();else break}t.push(a)}t.pop();const n=[];for(let i=e.length-1;i>=0;i--){const a=e[i];for(;n.length>=2;){const l=n[n.length-1],d=n[n.length-2];if((l.x-d.x)*(a.y-d.y)>=(l.y-d.y)*(a.x-d.x))n.pop();else break}n.push(a)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var _je=Mse,Bse=Use;const Eje=_je,bje=N.forwardRef(({className:e,sideOffset:t=4,...n},i)=>_.jsx(Bse,{ref:i,sideOffset:t,className:gt("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));bje.displayName=Bse.displayName;var DO=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},kO=typeof window>"u"||"Deno"in globalThis;function Ec(){}function Sje(e,t){return typeof e=="function"?e(t):e}function wje(e){return typeof e=="number"&&e>=0&&e!==1/0}function Tje(e,t){return Math.max(e+(t||0)-Date.now(),0)}function $X(e,t){return typeof e=="function"?e(t):e}function Cje(e,t){return typeof e=="function"?e(t):e}function WX(e,t){const{type:n="all",exact:i,fetchStatus:a,predicate:l,queryKey:d,stale:f}=e;if(d){if(i){if(t.queryHash!==DV(d,t.options))return!1}else if(!Rb(t.queryKey,d))return!1}if(n!=="all"){const m=t.isActive();if(n==="active"&&!m||n==="inactive"&&m)return!1}return!(typeof f=="boolean"&&t.isStale()!==f||a&&a!==t.state.fetchStatus||l&&!l(t))}function GX(e,t){const{exact:n,status:i,predicate:a,mutationKey:l}=e;if(l){if(!t.options.mutationKey)return!1;if(n){if(Cb(t.options.mutationKey)!==Cb(l))return!1}else if(!Rb(t.options.mutationKey,l))return!1}return!(i&&t.state.status!==i||a&&!a(t))}function DV(e,t){return((t==null?void 0:t.queryKeyHashFn)||Cb)(e)}function Cb(e){return JSON.stringify(e,(t,n)=>r2(n)?Object.keys(n).sort().reduce((i,a)=>(i[a]=n[a],i),{}):n)}function Rb(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>Rb(e[n],t[n])):!1}function $se(e,t){if(e===t)return e;const n=HX(e)&&HX(t);if(n||r2(e)&&r2(t)){const i=n?e:Object.keys(e),a=i.length,l=n?t:Object.keys(t),d=l.length,f=n?[]:{};let m=0;for(let v=0;v<d;v++){const E=n?v:l[v];(!n&&i.includes(E)||n)&&e[E]===void 0&&t[E]===void 0?(f[E]=void 0,m++):(f[E]=$se(e[E],t[E]),f[E]===e[E]&&e[E]!==void 0&&m++)}return a===d&&m===a?e:f}return t}function HX(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function r2(e){if(!KX(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!KX(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function KX(e){return Object.prototype.toString.call(e)==="[object Object]"}function Rje(e){return new Promise(t=>{setTimeout(t,e)})}function Aje(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?$se(e,t):t}function Oje(e,t,n=0){const i=[...e,t];return n&&i.length>n?i.slice(1):i}function Ije(e,t,n=0){const i=[t,...e];return n&&i.length>n?i.slice(0,-1):i}var kV=Symbol();function Wse(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===kV?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var ep,Yd,Xg,rre,xje=(rre=class extends DO{constructor(){super();Un(this,ep);Un(this,Yd);Un(this,Xg);tn(this,Xg,t=>{if(!kO&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){Be(this,Yd)||this.setEventListener(Be(this,Xg))}onUnsubscribe(){var t;this.hasListeners()||((t=Be(this,Yd))==null||t.call(this),tn(this,Yd,void 0))}setEventListener(t){var n;tn(this,Xg,t),(n=Be(this,Yd))==null||n.call(this),tn(this,Yd,t(i=>{typeof i=="boolean"?this.setFocused(i):this.onFocus()}))}setFocused(t){Be(this,ep)!==t&&(tn(this,ep,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof Be(this,ep)=="boolean"?Be(this,ep):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},ep=new WeakMap,Yd=new WeakMap,Xg=new WeakMap,rre),Gse=new xje,Jg,qd,Qg,ire,Pje=(ire=class extends DO{constructor(){super();Un(this,Jg,!0);Un(this,qd);Un(this,Qg);tn(this,Qg,t=>{if(!kO&&window.addEventListener){const n=()=>t(!0),i=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",i,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",i)}}})}onSubscribe(){Be(this,qd)||this.setEventListener(Be(this,Qg))}onUnsubscribe(){var t;this.hasListeners()||((t=Be(this,qd))==null||t.call(this),tn(this,qd,void 0))}setEventListener(t){var n;tn(this,Qg,t),(n=Be(this,qd))==null||n.call(this),tn(this,qd,t(this.setOnline.bind(this)))}setOnline(t){Be(this,Jg)!==t&&(tn(this,Jg,t),this.listeners.forEach(i=>{i(t)}))}isOnline(){return Be(this,Jg)}},Jg=new WeakMap,qd=new WeakMap,Qg=new WeakMap,ire),GR=new Pje;function Nje(){let e,t;const n=new Promise((a,l)=>{e=a,t=l});n.status="pending",n.catch(()=>{});function i(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{i({status:"fulfilled",value:a}),e(a)},n.reject=a=>{i({status:"rejected",reason:a}),t(a)},n}function Dje(e){return Math.min(1e3*2**e,3e4)}function Hse(e){return(e??"online")==="online"?GR.isOnline():!0}var Kse=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Wk(e){return e instanceof Kse}function zse(e){let t=!1,n=0,i=!1,a;const l=Nje(),d=O=>{var P;i||(T(new Kse(O)),(P=e.abort)==null||P.call(e))},f=()=>{t=!0},m=()=>{t=!1},v=()=>Gse.isFocused()&&(e.networkMode==="always"||GR.isOnline())&&e.canRun(),E=()=>Hse(e.networkMode)&&e.canRun(),S=O=>{var P;i||(i=!0,(P=e.onSuccess)==null||P.call(e,O),a==null||a(),l.resolve(O))},T=O=>{var P;i||(i=!0,(P=e.onError)==null||P.call(e,O),a==null||a(),l.reject(O))},R=()=>new Promise(O=>{var P;a=D=>{(i||v())&&O(D)},(P=e.onPause)==null||P.call(e)}).then(()=>{var O;a=void 0,i||(O=e.onContinue)==null||O.call(e)}),I=()=>{if(i)return;let O;const P=n===0?e.initialPromise:void 0;try{O=P??e.fn()}catch(D){O=Promise.reject(D)}Promise.resolve(O).then(S).catch(D=>{var W;if(i)return;const k=e.retry??(kO?0:3),M=e.retryDelay??Dje,$=typeof M=="function"?M(n,D):M,V=k===!0||typeof k=="number"&&n<k||typeof k=="function"&&k(n,D);if(t||!V){T(D);return}n++,(W=e.onFail)==null||W.call(e,n,D),Rje($).then(()=>v()?void 0:R()).then(()=>{t?T(D):I()})})};return{promise:l,cancel:d,continue:()=>(a==null||a(),l),cancelRetry:f,continueRetry:m,canStart:E,start:()=>(E()?I():R().then(I),l)}}var kje=e=>setTimeout(e,0);function Lje(){let e=[],t=0,n=f=>{f()},i=f=>{f()},a=kje;const l=f=>{t?e.push(f):a(()=>{n(f)})},d=()=>{const f=e;e=[],f.length&&a(()=>{i(()=>{f.forEach(m=>{n(m)})})})};return{batch:f=>{let m;t++;try{m=f()}finally{t--,t||d()}return m},batchCalls:f=>(...m)=>{l(()=>{f(...m)})},schedule:l,setNotifyFunction:f=>{n=f},setBatchNotifyFunction:f=>{i=f},setScheduler:f=>{a=f}}}var Fo=Lje(),tp,ore,Yse=(ore=class{constructor(){Un(this,tp)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),wje(this.gcTime)&&tn(this,tp,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(kO?1/0:5*60*1e3))}clearGcTimeout(){Be(this,tp)&&(clearTimeout(Be(this,tp)),tn(this,tp,void 0))}},tp=new WeakMap,ore),Zg,ev,Pa,np,Eo,ES,rp,bc,cu,sre,Mje=(sre=class extends Yse{constructor(t){super();Un(this,bc);Un(this,Zg);Un(this,ev);Un(this,Pa);Un(this,np);Un(this,Eo);Un(this,ES);Un(this,rp);tn(this,rp,!1),tn(this,ES,t.defaultOptions),this.setOptions(t.options),this.observers=[],tn(this,np,t.client),tn(this,Pa,Be(this,np).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,tn(this,Zg,Uje(this.options)),this.state=t.state??Be(this,Zg),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Be(this,Eo))==null?void 0:t.promise}setOptions(t){this.options={...Be(this,ES),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Be(this,Pa).remove(this)}setData(t,n){const i=Aje(this.state.data,t,this.options);return vo(this,bc,cu).call(this,{data:i,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),i}setState(t,n){vo(this,bc,cu).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var i,a;const n=(i=Be(this,Eo))==null?void 0:i.promise;return(a=Be(this,Eo))==null||a.cancel(t),n?n.then(Ec).catch(Ec):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Be(this,Zg))}isActive(){return this.observers.some(t=>Cje(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===kV||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(t=0){return this.state.isInvalidated||this.state.data===void 0||!Tje(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(i=>i.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=Be(this,Eo))==null||n.continue()}onOnline(){var n;const t=this.observers.find(i=>i.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=Be(this,Eo))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Be(this,Pa).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(Be(this,Eo)&&(Be(this,rp)?Be(this,Eo).cancel({revert:!0}):Be(this,Eo).cancelRetry()),this.scheduleGc()),Be(this,Pa).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||vo(this,bc,cu).call(this,{type:"invalidate"})}fetch(t,n){var m,v,E;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(Be(this,Eo))return Be(this,Eo).continueRetry(),Be(this,Eo).promise}if(t&&this.setOptions(t),!this.options.queryFn){const S=this.observers.find(T=>T.options.queryFn);S&&this.setOptions(S.options)}const i=new AbortController,a=S=>{Object.defineProperty(S,"signal",{enumerable:!0,get:()=>(tn(this,rp,!0),i.signal)})},l=()=>{const S=Wse(this.options,n),T={client:Be(this,np),queryKey:this.queryKey,meta:this.meta};return a(T),tn(this,rp,!1),this.options.persister?this.options.persister(S,T,this):S(T)},d={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:Be(this,np),state:this.state,fetchFn:l};a(d),(m=this.options.behavior)==null||m.onFetch(d,this),tn(this,ev,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((v=d.fetchOptions)==null?void 0:v.meta))&&vo(this,bc,cu).call(this,{type:"fetch",meta:(E=d.fetchOptions)==null?void 0:E.meta});const f=S=>{var T,R,I,O;Wk(S)&&S.silent||vo(this,bc,cu).call(this,{type:"error",error:S}),Wk(S)||((R=(T=Be(this,Pa).config).onError)==null||R.call(T,S,this),(O=(I=Be(this,Pa).config).onSettled)==null||O.call(I,this.state.data,S,this)),this.scheduleGc()};return tn(this,Eo,zse({initialPromise:n==null?void 0:n.initialPromise,fn:d.fetchFn,abort:i.abort.bind(i),onSuccess:S=>{var T,R,I,O;if(S===void 0){f(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(S)}catch(P){f(P);return}(R=(T=Be(this,Pa).config).onSuccess)==null||R.call(T,S,this),(O=(I=Be(this,Pa).config).onSettled)==null||O.call(I,S,this.state.error,this),this.scheduleGc()},onError:f,onFail:(S,T)=>{vo(this,bc,cu).call(this,{type:"failed",failureCount:S,error:T})},onPause:()=>{vo(this,bc,cu).call(this,{type:"pause"})},onContinue:()=>{vo(this,bc,cu).call(this,{type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0})),Be(this,Eo).start()}},Zg=new WeakMap,ev=new WeakMap,Pa=new WeakMap,np=new WeakMap,Eo=new WeakMap,ES=new WeakMap,rp=new WeakMap,bc=new WeakSet,cu=function(t){const n=i=>{switch(t.type){case"failed":return{...i,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...jje(i.data,this.options),fetchMeta:t.meta??null};case"success":return{...i,data:t.data,dataUpdateCount:i.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return Wk(a)&&a.revert&&Be(this,ev)?{...Be(this,ev),fetchStatus:"idle"}:{...i,error:a,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...t.state}}};this.state=n(this.state),Fo.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),Be(this,Pa).notify({query:this,type:"updated",action:t})})},sre);function jje(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Hse(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Uje(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,i=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var fl,are,Vje=(are=class extends DO{constructor(t={}){super();Un(this,fl);this.config=t,tn(this,fl,new Map)}build(t,n,i){const a=n.queryKey,l=n.queryHash??DV(a,n);let d=this.get(l);return d||(d=new Mje({client:t,queryKey:a,queryHash:l,options:t.defaultQueryOptions(n),state:i,defaultOptions:t.getQueryDefaults(a)}),this.add(d)),d}add(t){Be(this,fl).has(t.queryHash)||(Be(this,fl).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=Be(this,fl).get(t.queryHash);n&&(t.destroy(),n===t&&Be(this,fl).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Fo.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Be(this,fl).get(t)}getAll(){return[...Be(this,fl).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(i=>WX(n,i))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(i=>WX(t,i)):n}notify(t){Fo.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Fo.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Fo.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},fl=new WeakMap,are),pl,jo,ip,ml,Ld,cre,Fje=(cre=class extends Yse{constructor(t){super();Un(this,ml);Un(this,pl);Un(this,jo);Un(this,ip);this.mutationId=t.mutationId,tn(this,jo,t.mutationCache),tn(this,pl,[]),this.state=t.state||Bje(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Be(this,pl).includes(t)||(Be(this,pl).push(t),this.clearGcTimeout(),Be(this,jo).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){tn(this,pl,Be(this,pl).filter(n=>n!==t)),this.scheduleGc(),Be(this,jo).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Be(this,pl).length||(this.state.status==="pending"?this.scheduleGc():Be(this,jo).remove(this))}continue(){var t;return((t=Be(this,ip))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var l,d,f,m,v,E,S,T,R,I,O,P,D,k,M,$,V,W,H,J;const n=()=>{vo(this,ml,Ld).call(this,{type:"continue"})};tn(this,ip,zse({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(ee,le)=>{vo(this,ml,Ld).call(this,{type:"failed",failureCount:ee,error:le})},onPause:()=>{vo(this,ml,Ld).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Be(this,jo).canRun(this)}));const i=this.state.status==="pending",a=!Be(this,ip).canStart();try{if(i)n();else{vo(this,ml,Ld).call(this,{type:"pending",variables:t,isPaused:a}),await((d=(l=Be(this,jo).config).onMutate)==null?void 0:d.call(l,t,this));const le=await((m=(f=this.options).onMutate)==null?void 0:m.call(f,t));le!==this.state.context&&vo(this,ml,Ld).call(this,{type:"pending",context:le,variables:t,isPaused:a})}const ee=await Be(this,ip).start();return await((E=(v=Be(this,jo).config).onSuccess)==null?void 0:E.call(v,ee,t,this.state.context,this)),await((T=(S=this.options).onSuccess)==null?void 0:T.call(S,ee,t,this.state.context)),await((I=(R=Be(this,jo).config).onSettled)==null?void 0:I.call(R,ee,null,this.state.variables,this.state.context,this)),await((P=(O=this.options).onSettled)==null?void 0:P.call(O,ee,null,t,this.state.context)),vo(this,ml,Ld).call(this,{type:"success",data:ee}),ee}catch(ee){try{throw await((k=(D=Be(this,jo).config).onError)==null?void 0:k.call(D,ee,t,this.state.context,this)),await(($=(M=this.options).onError)==null?void 0:$.call(M,ee,t,this.state.context)),await((W=(V=Be(this,jo).config).onSettled)==null?void 0:W.call(V,void 0,ee,this.state.variables,this.state.context,this)),await((J=(H=this.options).onSettled)==null?void 0:J.call(H,void 0,ee,t,this.state.context)),ee}finally{vo(this,ml,Ld).call(this,{type:"error",error:ee})}}finally{Be(this,jo).runNext(this)}}},pl=new WeakMap,jo=new WeakMap,ip=new WeakMap,ml=new WeakSet,Ld=function(t){const n=i=>{switch(t.type){case"failed":return{...i,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...i,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:t.error,failureCount:i.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Fo.batch(()=>{Be(this,pl).forEach(i=>{i.onMutationUpdate(t)}),Be(this,jo).notify({mutation:this,type:"updated",action:t})})},cre);function Bje(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var fu,Sc,bS,lre,$je=(lre=class extends DO{constructor(t={}){super();Un(this,fu);Un(this,Sc);Un(this,bS);this.config=t,tn(this,fu,new Set),tn(this,Sc,new Map),tn(this,bS,0)}build(t,n,i){const a=new Fje({mutationCache:this,mutationId:++ZT(this,bS)._,options:t.defaultMutationOptions(n),state:i});return this.add(a),a}add(t){Be(this,fu).add(t);const n=bC(t);if(typeof n=="string"){const i=Be(this,Sc).get(n);i?i.push(t):Be(this,Sc).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(Be(this,fu).delete(t)){const n=bC(t);if(typeof n=="string"){const i=Be(this,Sc).get(n);if(i)if(i.length>1){const a=i.indexOf(t);a!==-1&&i.splice(a,1)}else i[0]===t&&Be(this,Sc).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=bC(t);if(typeof n=="string"){const i=Be(this,Sc).get(n),a=i==null?void 0:i.find(l=>l.state.status==="pending");return!a||a===t}else return!0}runNext(t){var i;const n=bC(t);if(typeof n=="string"){const a=(i=Be(this,Sc).get(n))==null?void 0:i.find(l=>l!==t&&l.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Fo.batch(()=>{Be(this,fu).forEach(t=>{this.notify({type:"removed",mutation:t})}),Be(this,fu).clear(),Be(this,Sc).clear()})}getAll(){return Array.from(Be(this,fu))}find(t){const n={exact:!0,...t};return this.getAll().find(i=>GX(n,i))}findAll(t={}){return this.getAll().filter(n=>GX(t,n))}notify(t){Fo.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Fo.batch(()=>Promise.all(t.map(n=>n.continue().catch(Ec))))}},fu=new WeakMap,Sc=new WeakMap,bS=new WeakMap,lre);function bC(e){var t;return(t=e.options.scope)==null?void 0:t.id}function zX(e){return{onFetch:(t,n)=>{var E,S,T,R,I;const i=t.options,a=(T=(S=(E=t.fetchOptions)==null?void 0:E.meta)==null?void 0:S.fetchMore)==null?void 0:T.direction,l=((R=t.state.data)==null?void 0:R.pages)||[],d=((I=t.state.data)==null?void 0:I.pageParams)||[];let f={pages:[],pageParams:[]},m=0;const v=async()=>{let O=!1;const P=M=>{Object.defineProperty(M,"signal",{enumerable:!0,get:()=>(t.signal.aborted?O=!0:t.signal.addEventListener("abort",()=>{O=!0}),t.signal)})},D=Wse(t.options,t.fetchOptions),k=async(M,$,V)=>{if(O)return Promise.reject();if($==null&&M.pages.length)return Promise.resolve(M);const W={client:t.client,queryKey:t.queryKey,pageParam:$,direction:V?"backward":"forward",meta:t.options.meta};P(W);const H=await D(W),{maxPages:J}=t.options,ee=V?Ije:Oje;return{pages:ee(M.pages,H,J),pageParams:ee(M.pageParams,$,J)}};if(a&&l.length){const M=a==="backward",$=M?Wje:YX,V={pages:l,pageParams:d},W=$(i,V);f=await k(V,W,M)}else{const M=e??l.length;do{const $=m===0?d[0]??i.initialPageParam:YX(i,f);if(m>0&&$==null)break;f=await k(f,$),m++}while(m<M)}return f};t.options.persister?t.fetchFn=()=>{var O,P;return(P=(O=t.options).persister)==null?void 0:P.call(O,v,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=v}}}function YX(e,{pages:t,pageParams:n}){const i=t.length-1;return t.length>0?e.getNextPageParam(t[i],t,n[i],n):void 0}function Wje(e,{pages:t,pageParams:n}){var i;return t.length>0?(i=e.getPreviousPageParam)==null?void 0:i.call(e,t[0],t,n[0],n):void 0}var ci,Xd,Jd,tv,nv,Qd,rv,iv,ure,Gje=(ure=class{constructor(e={}){Un(this,ci);Un(this,Xd);Un(this,Jd);Un(this,tv);Un(this,nv);Un(this,Qd);Un(this,rv);Un(this,iv);tn(this,ci,e.queryCache||new Vje),tn(this,Xd,e.mutationCache||new $je),tn(this,Jd,e.defaultOptions||{}),tn(this,tv,new Map),tn(this,nv,new Map),tn(this,Qd,0)}mount(){ZT(this,Qd)._++,Be(this,Qd)===1&&(tn(this,rv,Gse.subscribe(async e=>{e&&(await this.resumePausedMutations(),Be(this,ci).onFocus())})),tn(this,iv,GR.subscribe(async e=>{e&&(await this.resumePausedMutations(),Be(this,ci).onOnline())})))}unmount(){var e,t;ZT(this,Qd)._--,Be(this,Qd)===0&&((e=Be(this,rv))==null||e.call(this),tn(this,rv,void 0),(t=Be(this,iv))==null||t.call(this),tn(this,iv,void 0))}isFetching(e){return Be(this,ci).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Be(this,Xd).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Be(this,ci).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=Be(this,ci).build(this,t),i=n.state.data;return i===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime($X(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(i))}getQueriesData(e){return Be(this,ci).findAll(e).map(({queryKey:t,state:n})=>{const i=n.data;return[t,i]})}setQueryData(e,t,n){const i=this.defaultQueryOptions({queryKey:e}),a=Be(this,ci).get(i.queryHash),l=a==null?void 0:a.state.data,d=Sje(t,l);if(d!==void 0)return Be(this,ci).build(this,i).setData(d,{...n,manual:!0})}setQueriesData(e,t,n){return Fo.batch(()=>Be(this,ci).findAll(e).map(({queryKey:i})=>[i,this.setQueryData(i,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Be(this,ci).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=Be(this,ci);Fo.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=Be(this,ci);return Fo.batch(()=>(n.findAll(e).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},i=Fo.batch(()=>Be(this,ci).findAll(e).map(a=>a.cancel(n)));return Promise.all(i).then(Ec).catch(Ec)}invalidateQueries(e,t={}){return Fo.batch(()=>(Be(this,ci).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},i=Fo.batch(()=>Be(this,ci).findAll(e).filter(a=>!a.isDisabled()).map(a=>{let l=a.fetch(void 0,n);return n.throwOnError||(l=l.catch(Ec)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then(Ec)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=Be(this,ci).build(this,t);return n.isStaleByTime($X(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Ec).catch(Ec)}fetchInfiniteQuery(e){return e.behavior=zX(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Ec).catch(Ec)}ensureInfiniteQueryData(e){return e.behavior=zX(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return GR.isOnline()?Be(this,Xd).resumePausedMutations():Promise.resolve()}getQueryCache(){return Be(this,ci)}getMutationCache(){return Be(this,Xd)}getDefaultOptions(){return Be(this,Jd)}setDefaultOptions(e){tn(this,Jd,e)}setQueryDefaults(e,t){Be(this,tv).set(Cb(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Be(this,tv).values()],n={};return t.forEach(i=>{Rb(e,i.queryKey)&&Object.assign(n,i.defaultOptions)}),n}setMutationDefaults(e,t){Be(this,nv).set(Cb(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Be(this,nv).values()],n={};return t.forEach(i=>{Rb(e,i.mutationKey)&&Object.assign(n,i.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Be(this,Jd).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=DV(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===kV&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Be(this,Jd).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Be(this,ci).clear(),Be(this,Xd).clear()}},ci=new WeakMap,Xd=new WeakMap,Jd=new WeakMap,tv=new WeakMap,nv=new WeakMap,Qd=new WeakMap,rv=new WeakMap,iv=new WeakMap,ure),Hje=N.createContext(void 0),Kje=({client:e,children:t})=>(N.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),_.jsx(Hje.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ab(){return Ab=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ab.apply(this,arguments)}var th;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(th||(th={}));const qX="popstate";function zje(e){e===void 0&&(e={});function t(i,a){let{pathname:l,search:d,hash:f}=i.location;return i2("",{pathname:l,search:d,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){return typeof a=="string"?a:HR(a)}return qje(t,n,null,e)}function _i(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function qse(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Yje(){return Math.random().toString(36).substr(2,8)}function XX(e,t){return{usr:e.state,key:e.key,idx:t}}function i2(e,t,n,i){return n===void 0&&(n=null),Ab({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?ey(t):t,{state:n,key:t&&t.key||i||Yje()})}function HR(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function ey(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substr(i),e=e.substr(0,i)),e&&(t.pathname=e)}return t}function qje(e,t,n,i){i===void 0&&(i={});let{window:a=document.defaultView,v5Compat:l=!1}=i,d=a.history,f=th.Pop,m=null,v=E();v==null&&(v=0,d.replaceState(Ab({},d.state,{idx:v}),""));function E(){return(d.state||{idx:null}).idx}function S(){f=th.Pop;let P=E(),D=P==null?null:P-v;v=P,m&&m({action:f,location:O.location,delta:D})}function T(P,D){f=th.Push;let k=i2(O.location,P,D);v=E()+1;let M=XX(k,v),$=O.createHref(k);try{d.pushState(M,"",$)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;a.location.assign($)}l&&m&&m({action:f,location:O.location,delta:1})}function R(P,D){f=th.Replace;let k=i2(O.location,P,D);v=E();let M=XX(k,v),$=O.createHref(k);d.replaceState(M,"",$),l&&m&&m({action:f,location:O.location,delta:0})}function I(P){let D=a.location.origin!=="null"?a.location.origin:a.location.href,k=typeof P=="string"?P:HR(P);return k=k.replace(/ $/,"%20"),_i(D,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,D)}let O={get action(){return f},get location(){return e(a,d)},listen(P){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(qX,S),m=P,()=>{a.removeEventListener(qX,S),m=null}},createHref(P){return t(a,P)},createURL:I,encodeLocation(P){let D=I(P);return{pathname:D.pathname,search:D.search,hash:D.hash}},push:T,replace:R,go(P){return d.go(P)}};return O}var JX;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(JX||(JX={}));function Xje(e,t,n){return n===void 0&&(n="/"),Jje(e,t,n)}function Jje(e,t,n,i){let a=typeof t=="string"?ey(t):t,l=LV(a.pathname||"/",n);if(l==null)return null;let d=Xse(e);Qje(d);let f=null;for(let m=0;f==null&&m<d.length;++m){let v=uUe(l);f=aUe(d[m],v)}return f}function Xse(e,t,n,i){t===void 0&&(t=[]),n===void 0&&(n=[]),i===void 0&&(i="");let a=(l,d,f)=>{let m={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};m.relativePath.startsWith("/")&&(_i(m.relativePath.startsWith(i),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(i.length));let v=dh([i,m.relativePath]),E=n.concat(m);l.children&&l.children.length>0&&(_i(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),Xse(l.children,t,E,v)),!(l.path==null&&!l.index)&&t.push({path:v,score:oUe(v,l.index),routesMeta:E})};return e.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,d);else for(let m of Jse(l.path))a(l,d,m)}),t}function Jse(e){let t=e.split("/");if(t.length===0)return[];let[n,...i]=t,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let d=Jse(i.join("/")),f=[];return f.push(...d.map(m=>m===""?l:[l,m].join("/"))),a&&f.push(...d),f.map(m=>e.startsWith("/")&&m===""?"/":m)}function Qje(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:sUe(t.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const Zje=/^:[\w-]+$/,eUe=3,tUe=2,nUe=1,rUe=10,iUe=-2,QX=e=>e==="*";function oUe(e,t){let n=e.split("/"),i=n.length;return n.some(QX)&&(i+=iUe),t&&(i+=tUe),n.filter(a=>!QX(a)).reduce((a,l)=>a+(Zje.test(l)?eUe:l===""?nUe:rUe),i)}function sUe(e,t){return e.length===t.length&&e.slice(0,-1).every((i,a)=>i===t[a])?e[e.length-1]-t[t.length-1]:0}function aUe(e,t,n){let{routesMeta:i}=e,a={},l="/",d=[];for(let f=0;f<i.length;++f){let m=i[f],v=f===i.length-1,E=l==="/"?t:t.slice(l.length)||"/",S=cUe({path:m.relativePath,caseSensitive:m.caseSensitive,end:v},E),T=m.route;if(!S)return null;Object.assign(a,S.params),d.push({params:a,pathname:dh([l,S.pathname]),pathnameBase:pUe(dh([l,S.pathnameBase])),route:T}),S.pathnameBase!=="/"&&(l=dh([l,S.pathnameBase]))}return d}function cUe(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=lUe(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let l=a[0],d=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:i.reduce((v,E,S)=>{let{paramName:T,isOptional:R}=E;if(T==="*"){let O=f[S]||"";d=l.slice(0,l.length-O.length).replace(/(.)\/+$/,"$1")}const I=f[S];return R&&!I?v[T]=void 0:v[T]=(I||"").replace(/%2F/g,"/"),v},{}),pathname:l,pathnameBase:d,pattern:e}}function lUe(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),qse(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let i=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,m)=>(i.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(i.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),i]}function uUe(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return qse(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function LV(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&i!=="/"?null:e.slice(n)||"/"}function dUe(e,t){t===void 0&&(t="/");let{pathname:n,search:i="",hash:a=""}=typeof e=="string"?ey(e):e;return{pathname:n?n.startsWith("/")?n:hUe(n,t):t,search:mUe(i),hash:gUe(a)}}function hUe(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Gk(e,t,n,i){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function fUe(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function MV(e,t){let n=fUe(e);return t?n.map((i,a)=>a===n.length-1?i.pathname:i.pathnameBase):n.map(i=>i.pathnameBase)}function jV(e,t,n,i){i===void 0&&(i=!1);let a;typeof e=="string"?a=ey(e):(a=Ab({},e),_i(!a.pathname||!a.pathname.includes("?"),Gk("?","pathname","search",a)),_i(!a.pathname||!a.pathname.includes("#"),Gk("#","pathname","hash",a)),_i(!a.search||!a.search.includes("#"),Gk("#","search","hash",a)));let l=e===""||a.pathname==="",d=l?"/":a.pathname,f;if(d==null)f=n;else{let S=t.length-1;if(!i&&d.startsWith("..")){let T=d.split("/");for(;T[0]==="..";)T.shift(),S-=1;a.pathname=T.join("/")}f=S>=0?t[S]:"/"}let m=dUe(a,f),v=d&&d!=="/"&&d.endsWith("/"),E=(l||d===".")&&n.endsWith("/");return!m.pathname.endsWith("/")&&(v||E)&&(m.pathname+="/"),m}const dh=e=>e.join("/").replace(/\/\/+/g,"/"),pUe=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),mUe=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,gUe=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function vUe(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Qse=["post","put","patch","delete"];new Set(Qse);const yUe=["get",...Qse];new Set(yUe);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ob(){return Ob=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ob.apply(this,arguments)}const UV=N.createContext(null),_Ue=N.createContext(null),Oh=N.createContext(null),LO=N.createContext(null),Ku=N.createContext({outlet:null,matches:[],isDataRoute:!1}),Zse=N.createContext(null);function EUe(e,t){let{relative:n}=t===void 0?{}:t;ty()||_i(!1);let{basename:i,navigator:a}=N.useContext(Oh),{hash:l,pathname:d,search:f}=tae(e,{relative:n}),m=d;return i!=="/"&&(m=d==="/"?i:dh([i,d])),a.createHref({pathname:m,search:f,hash:l})}function ty(){return N.useContext(LO)!=null}function kl(){return ty()||_i(!1),N.useContext(LO).location}function eae(e){N.useContext(Oh).static||N.useLayoutEffect(e)}function xS(){let{isDataRoute:e}=N.useContext(Ku);return e?kUe():bUe()}function bUe(){ty()||_i(!1);let e=N.useContext(UV),{basename:t,future:n,navigator:i}=N.useContext(Oh),{matches:a}=N.useContext(Ku),{pathname:l}=kl(),d=JSON.stringify(MV(a,n.v7_relativeSplatPath)),f=N.useRef(!1);return eae(()=>{f.current=!0}),N.useCallback(function(v,E){if(E===void 0&&(E={}),!f.current)return;if(typeof v=="number"){i.go(v);return}let S=jV(v,JSON.parse(d),l,E.relative==="path");e==null&&t!=="/"&&(S.pathname=S.pathname==="/"?t:dh([t,S.pathname])),(E.replace?i.replace:i.push)(S,E.state,E)},[t,i,d,l,e])}function SUe(){let{matches:e}=N.useContext(Ku),t=e[e.length-1];return t?t.params:{}}function tae(e,t){let{relative:n}=t===void 0?{}:t,{future:i}=N.useContext(Oh),{matches:a}=N.useContext(Ku),{pathname:l}=kl(),d=JSON.stringify(MV(a,i.v7_relativeSplatPath));return N.useMemo(()=>jV(e,JSON.parse(d),l,n==="path"),[e,d,l,n])}function wUe(e,t){return TUe(e,t)}function TUe(e,t,n,i){ty()||_i(!1);let{navigator:a}=N.useContext(Oh),{matches:l}=N.useContext(Ku),d=l[l.length-1],f=d?d.params:{};d&&d.pathname;let m=d?d.pathnameBase:"/";d&&d.route;let v=kl(),E;if(t){var S;let P=typeof t=="string"?ey(t):t;m==="/"||(S=P.pathname)!=null&&S.startsWith(m)||_i(!1),E=P}else E=v;let T=E.pathname||"/",R=T;if(m!=="/"){let P=m.replace(/^\//,"").split("/");R="/"+T.replace(/^\//,"").split("/").slice(P.length).join("/")}let I=Xje(e,{pathname:R}),O=IUe(I&&I.map(P=>Object.assign({},P,{params:Object.assign({},f,P.params),pathname:dh([m,a.encodeLocation?a.encodeLocation(P.pathname).pathname:P.pathname]),pathnameBase:P.pathnameBase==="/"?m:dh([m,a.encodeLocation?a.encodeLocation(P.pathnameBase).pathname:P.pathnameBase])})),l,n,i);return t&&O?N.createElement(LO.Provider,{value:{location:Ob({pathname:"/",search:"",hash:"",state:null,key:"default"},E),navigationType:th.Pop}},O):O}function CUe(){let e=DUe(),t=vUe(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},t),n?N.createElement("pre",{style:a},n):null,null)}const RUe=N.createElement(CUe,null);class AUe extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?N.createElement(Ku.Provider,{value:this.props.routeContext},N.createElement(Zse.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function OUe(e){let{routeContext:t,match:n,children:i}=e,a=N.useContext(UV);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),N.createElement(Ku.Provider,{value:t},i)}function IUe(e,t,n,i){var a;if(t===void 0&&(t=[]),n===void 0&&(n=null),i===void 0&&(i=null),e==null){var l;if(!n)return null;if(n.errors)e=n.matches;else if((l=i)!=null&&l.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let d=e,f=(a=n)==null?void 0:a.errors;if(f!=null){let E=d.findIndex(S=>S.route.id&&(f==null?void 0:f[S.route.id])!==void 0);E>=0||_i(!1),d=d.slice(0,Math.min(d.length,E+1))}let m=!1,v=-1;if(n&&i&&i.v7_partialHydration)for(let E=0;E<d.length;E++){let S=d[E];if((S.route.HydrateFallback||S.route.hydrateFallbackElement)&&(v=E),S.route.id){let{loaderData:T,errors:R}=n,I=S.route.loader&&T[S.route.id]===void 0&&(!R||R[S.route.id]===void 0);if(S.route.lazy||I){m=!0,v>=0?d=d.slice(0,v+1):d=[d[0]];break}}}return d.reduceRight((E,S,T)=>{let R,I=!1,O=null,P=null;n&&(R=f&&S.route.id?f[S.route.id]:void 0,O=S.route.errorElement||RUe,m&&(v<0&&T===0?(LUe("route-fallback"),I=!0,P=null):v===T&&(I=!0,P=S.route.hydrateFallbackElement||null)));let D=t.concat(d.slice(0,T+1)),k=()=>{let M;return R?M=O:I?M=P:S.route.Component?M=N.createElement(S.route.Component,null):S.route.element?M=S.route.element:M=E,N.createElement(OUe,{match:S,routeContext:{outlet:E,matches:D,isDataRoute:n!=null},children:M})};return n&&(S.route.ErrorBoundary||S.route.errorElement||T===0)?N.createElement(AUe,{location:n.location,revalidation:n.revalidation,component:O,error:R,children:k(),routeContext:{outlet:null,matches:D,isDataRoute:!0}}):k()},null)}var nae=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(nae||{}),rae=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(rae||{});function xUe(e){let t=N.useContext(UV);return t||_i(!1),t}function PUe(e){let t=N.useContext(_Ue);return t||_i(!1),t}function NUe(e){let t=N.useContext(Ku);return t||_i(!1),t}function iae(e){let t=NUe(),n=t.matches[t.matches.length-1];return n.route.id||_i(!1),n.route.id}function DUe(){var e;let t=N.useContext(Zse),n=PUe(),i=iae();return t!==void 0?t:(e=n.errors)==null?void 0:e[i]}function kUe(){let{router:e}=xUe(nae.UseNavigateStable),t=iae(rae.UseNavigateStable),n=N.useRef(!1);return eae(()=>{n.current=!0}),N.useCallback(function(a,l){l===void 0&&(l={}),n.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Ob({fromRouteId:t},l)))},[e,t])}const ZX={};function LUe(e,t,n){ZX[e]||(ZX[e]=!0)}function MUe(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function jUe(e){let{to:t,replace:n,state:i,relative:a}=e;ty()||_i(!1);let{future:l,static:d}=N.useContext(Oh),{matches:f}=N.useContext(Ku),{pathname:m}=kl(),v=xS(),E=jV(t,MV(f,l.v7_relativeSplatPath),m,a==="path"),S=JSON.stringify(E);return N.useEffect(()=>v(JSON.parse(S),{replace:n,state:i,relative:a}),[v,S,a,n,i]),null}function Xr(e){_i(!1)}function UUe(e){let{basename:t="/",children:n=null,location:i,navigationType:a=th.Pop,navigator:l,static:d=!1,future:f}=e;ty()&&_i(!1);let m=t.replace(/^\/*/,"/"),v=N.useMemo(()=>({basename:m,navigator:l,static:d,future:Ob({v7_relativeSplatPath:!1},f)}),[m,f,l,d]);typeof i=="string"&&(i=ey(i));let{pathname:E="/",search:S="",hash:T="",state:R=null,key:I="default"}=i,O=N.useMemo(()=>{let P=LV(E,m);return P==null?null:{location:{pathname:P,search:S,hash:T,state:R,key:I},navigationType:a}},[m,E,S,T,R,I,a]);return O==null?null:N.createElement(Oh.Provider,{value:v},N.createElement(LO.Provider,{children:n,value:O}))}function oae(e){let{children:t,location:n}=e;return wUe(o2(t),n)}new Promise(()=>{});function o2(e,t){t===void 0&&(t=[]);let n=[];return N.Children.forEach(e,(i,a)=>{if(!N.isValidElement(i))return;let l=[...t,a];if(i.type===N.Fragment){n.push.apply(n,o2(i.props.children,l));return}i.type!==Xr&&_i(!1),!i.props.index||!i.props.children||_i(!1);let d={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(d.children=o2(i.props.children,l)),n.push(d)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function s2(){return s2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},s2.apply(this,arguments)}function VUe(e,t){if(e==null)return{};var n={},i=Object.keys(e),a,l;for(l=0;l<i.length;l++)a=i[l],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function FUe(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function BUe(e,t){return e.button===0&&(!t||t==="_self")&&!FUe(e)}const $Ue=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],WUe="6";try{window.__reactRouterVersion=WUe}catch{}const GUe="startTransition",eJ=SU[GUe];function HUe(e){let{basename:t,children:n,future:i,window:a}=e,l=N.useRef();l.current==null&&(l.current=zje({window:a,v5Compat:!0}));let d=l.current,[f,m]=N.useState({action:d.action,location:d.location}),{v7_startTransition:v}=i||{},E=N.useCallback(S=>{v&&eJ?eJ(()=>m(S)):m(S)},[m,v]);return N.useLayoutEffect(()=>d.listen(E),[d,E]),N.useEffect(()=>MUe(i),[i]),N.createElement(UUe,{basename:t,children:n,location:f.location,navigationType:f.action,navigator:d,future:i})}const KUe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",zUe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Dt=N.forwardRef(function(t,n){let{onClick:i,relative:a,reloadDocument:l,replace:d,state:f,target:m,to:v,preventScrollReset:E,viewTransition:S}=t,T=VUe(t,$Ue),{basename:R}=N.useContext(Oh),I,O=!1;if(typeof v=="string"&&zUe.test(v)&&(I=v,KUe))try{let M=new URL(window.location.href),$=v.startsWith("//")?new URL(M.protocol+v):new URL(v),V=LV($.pathname,R);$.origin===M.origin&&V!=null?v=V+$.search+$.hash:O=!0}catch{}let P=EUe(v,{relative:a}),D=YUe(v,{replace:d,state:f,target:m,preventScrollReset:E,relative:a,viewTransition:S});function k(M){i&&i(M),M.defaultPrevented||D(M)}return N.createElement("a",s2({},T,{href:I||P,onClick:O||l?i:k,ref:n,target:m}))});var tJ;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(tJ||(tJ={}));var nJ;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(nJ||(nJ={}));function YUe(e,t){let{target:n,replace:i,state:a,preventScrollReset:l,relative:d,viewTransition:f}=t===void 0?{}:t,m=xS(),v=kl(),E=tae(e,{relative:d});return N.useCallback(S=>{if(BUe(S,n)){S.preventDefault();let T=i!==void 0?i:HR(v)===HR(E);m(e,{replace:T,state:a,preventScrollReset:l,relative:d,viewTransition:f})}},[v,m,E,i,a,n,e,l,d,f])}const qUe="modulepreload",XUe=function(e){return"/"+e},rJ={},pv=function(t,n,i){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),f=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));a=Promise.allSettled(n.map(m=>{if(m=XUe(m),m in rJ)return;rJ[m]=!0;const v=m.endsWith(".css"),E=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${E}`))return;const S=document.createElement("link");if(S.rel=v?"stylesheet":qUe,v||(S.as="script"),S.crossOrigin="",S.href=m,f&&S.setAttribute("nonce",f),document.head.appendChild(S),v)return new Promise((T,R)=>{S.addEventListener("load",T),S.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${m}`)))})}))}function l(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return a.then(d=>{for(const f of d||[])f.status==="rejected"&&l(f.reason);return t().catch(l)})},JUe=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>pv(async()=>{const{default:i}=await Promise.resolve().then(()=>ny);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)};class VV extends Error{constructor(t,n="FunctionsError",i){super(t),this.name=n,this.context=i}}class QUe extends VV{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class ZUe extends VV{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class eVe extends VV{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var a2;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(a2||(a2={}));var tVe=function(e,t,n,i){function a(l){return l instanceof n?l:new n(function(d){d(l)})}return new(n||(n=Promise))(function(l,d){function f(E){try{v(i.next(E))}catch(S){d(S)}}function m(E){try{v(i.throw(E))}catch(S){d(S)}}function v(E){E.done?l(E.value):a(E.value).then(f,m)}v((i=i.apply(e,t||[])).next())})};class nVe{constructor(t,{headers:n={},customFetch:i,region:a=a2.Any}={}){this.url=t,this.headers=n,this.region=a,this.fetch=JUe(i)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,n={}){var i;return tVe(this,void 0,void 0,function*(){try{const{headers:a,method:l,body:d}=n;let f={},{region:m}=n;m||(m=this.region),m&&m!=="any"&&(f["x-region"]=m);let v;d&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",v=d):typeof d=="string"?(f["Content-Type"]="text/plain",v=d):typeof FormData<"u"&&d instanceof FormData?v=d:(f["Content-Type"]="application/json",v=JSON.stringify(d)));const E=yield this.fetch(`${this.url}/${t}`,{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),a),body:v}).catch(I=>{throw new QUe(I)}),S=E.headers.get("x-relay-error");if(S&&S==="true")throw new ZUe(E);if(!E.ok)throw new eVe(E);let T=((i=E.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),R;return T==="application/json"?R=yield E.json():T==="application/octet-stream"?R=yield E.blob():T==="text/event-stream"?R=E:T==="multipart/form-data"?R=yield E.formData():R=yield E.text(),{data:R,error:null}}catch(a){return{data:null,error:a}}})}}var fs={},FV={},MO={},PS={},jO={},UO={},rVe=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},mv=rVe();const iVe=mv.fetch,sae=mv.fetch.bind(mv),aae=mv.Headers,oVe=mv.Request,sVe=mv.Response,ny=Object.freeze(Object.defineProperty({__proto__:null,Headers:aae,Request:oVe,Response:sVe,default:sae,fetch:iVe},Symbol.toStringTag,{value:"Module"})),aVe=t1e(ny);var VO={};Object.defineProperty(VO,"__esModule",{value:!0});let cVe=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};VO.default=cVe;var cae=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(UO,"__esModule",{value:!0});const lVe=cae(aVe),uVe=cae(VO);let dVe=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=lVe.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,n){return this.headers=Object.assign({},this.headers),this.headers[t]=n,this}then(t,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const i=this.fetch;let a=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{var d,f,m;let v=null,E=null,S=null,T=l.status,R=l.statusText;if(l.ok){if(this.method!=="HEAD"){const D=await l.text();D===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?E=D:E=JSON.parse(D))}const O=(d=this.headers.Prefer)===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),P=(f=l.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");O&&P&&P.length>1&&(S=parseInt(P[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(E)&&(E.length>1?(v={code:"PGRST116",details:`Results contain ${E.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},E=null,S=null,T=406,R="Not Acceptable"):E.length===1?E=E[0]:E=null)}else{const O=await l.text();try{v=JSON.parse(O),Array.isArray(v)&&l.status===404&&(E=[],v=null,T=200,R="OK")}catch{l.status===404&&O===""?(T=204,R="No Content"):v={message:O}}if(v&&this.isMaybeSingle&&(!((m=v==null?void 0:v.details)===null||m===void 0)&&m.includes("0 rows"))&&(v=null,T=200,R="OK"),v&&this.shouldThrowOnError)throw new uVe.default(v)}return{error:v,data:E,count:S,status:T,statusText:R}});return this.shouldThrowOnError||(a=a.catch(l=>{var d,f,m;return{error:{message:`${(d=l==null?void 0:l.name)!==null&&d!==void 0?d:"FetchError"}: ${l==null?void 0:l.message}`,details:`${(f=l==null?void 0:l.stack)!==null&&f!==void 0?f:""}`,hint:"",code:`${(m=l==null?void 0:l.code)!==null&&m!==void 0?m:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,n)}returns(){return this}overrideTypes(){return this}};UO.default=dVe;var hVe=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jO,"__esModule",{value:!0});const fVe=hVe(UO);let pVe=class extends fVe.default{select(t){let n=!1;const i=(t??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:n=!0,nullsFirst:i,foreignTable:a,referencedTable:l=a}={}){const d=l?`${l}.order`:"order",f=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${f?`${f},`:""}${t}.${n?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:n,referencedTable:i=n}={}){const a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,n,{foreignTable:i,referencedTable:a=i}={}){const l=typeof a>"u"?"offset":`${a}.offset`,d=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${t}`),this.url.searchParams.set(d,`${n-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:n=!1,settings:i=!1,buffers:a=!1,wal:l=!1,format:d="text"}={}){var f;const m=[t?"analyze":null,n?"verbose":null,i?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),v=(f=this.headers.Accept)!==null&&f!==void 0?f:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${d}; for="${v}"; options=${m};`,d==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};jO.default=pVe;var mVe=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(PS,"__esModule",{value:!0});const gVe=mVe(jO);let vVe=class extends gVe.default{eq(t,n){return this.url.searchParams.append(t,`eq.${n}`),this}neq(t,n){return this.url.searchParams.append(t,`neq.${n}`),this}gt(t,n){return this.url.searchParams.append(t,`gt.${n}`),this}gte(t,n){return this.url.searchParams.append(t,`gte.${n}`),this}lt(t,n){return this.url.searchParams.append(t,`lt.${n}`),this}lte(t,n){return this.url.searchParams.append(t,`lte.${n}`),this}like(t,n){return this.url.searchParams.append(t,`like.${n}`),this}likeAllOf(t,n){return this.url.searchParams.append(t,`like(all).{${n.join(",")}}`),this}likeAnyOf(t,n){return this.url.searchParams.append(t,`like(any).{${n.join(",")}}`),this}ilike(t,n){return this.url.searchParams.append(t,`ilike.${n}`),this}ilikeAllOf(t,n){return this.url.searchParams.append(t,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(t,n){return this.url.searchParams.append(t,`ilike(any).{${n.join(",")}}`),this}is(t,n){return this.url.searchParams.append(t,`is.${n}`),this}in(t,n){const i=Array.from(new Set(n)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${i})`),this}contains(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cs.{${n.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(n)}`),this}containedBy(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cd.{${n.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(n)}`),this}rangeGt(t,n){return this.url.searchParams.append(t,`sr.${n}`),this}rangeGte(t,n){return this.url.searchParams.append(t,`nxl.${n}`),this}rangeLt(t,n){return this.url.searchParams.append(t,`sl.${n}`),this}rangeLte(t,n){return this.url.searchParams.append(t,`nxr.${n}`),this}rangeAdjacent(t,n){return this.url.searchParams.append(t,`adj.${n}`),this}overlaps(t,n){return typeof n=="string"?this.url.searchParams.append(t,`ov.${n}`):this.url.searchParams.append(t,`ov.{${n.join(",")}}`),this}textSearch(t,n,{config:i,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const d=i===void 0?"":`(${i})`;return this.url.searchParams.append(t,`${l}fts${d}.${n}`),this}match(t){return Object.entries(t).forEach(([n,i])=>{this.url.searchParams.append(n,`eq.${i}`)}),this}not(t,n,i){return this.url.searchParams.append(t,`not.${n}.${i}`),this}or(t,{foreignTable:n,referencedTable:i=n}={}){const a=i?`${i}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,n,i){return this.url.searchParams.append(t,`${n}.${i}`),this}};PS.default=vVe;var yVe=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(MO,"__esModule",{value:!0});const aE=yVe(PS);let _Ve=class{constructor(t,{headers:n={},schema:i,fetch:a}){this.url=t,this.headers=n,this.schema=i,this.fetch=a}select(t,{head:n=!1,count:i}={}){const a=n?"HEAD":"GET";let l=!1;const d=(t??"*").split("").map(f=>/\s/.test(f)&&!l?"":(f==='"'&&(l=!l),f)).join("");return this.url.searchParams.set("select",d),i&&(this.headers.Prefer=`count=${i}`),new aE.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:n,defaultToNull:i=!0}={}){const a="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),n&&l.push(`count=${n}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const d=t.reduce((f,m)=>f.concat(Object.keys(m)),[]);if(d.length>0){const f=[...new Set(d)].map(m=>`"${m}"`);this.url.searchParams.set("columns",f.join(","))}}return new aE.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:n,ignoreDuplicates:i=!1,count:a,defaultToNull:l=!0}={}){const d="POST",f=[`resolution=${i?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&f.push(this.headers.Prefer),a&&f.push(`count=${a}`),l||f.push("missing=default"),this.headers.Prefer=f.join(","),Array.isArray(t)){const m=t.reduce((v,E)=>v.concat(Object.keys(E)),[]);if(m.length>0){const v=[...new Set(m)].map(E=>`"${E}"`);this.url.searchParams.set("columns",v.join(","))}}return new aE.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:n}={}){const i="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),this.headers.Prefer=a.join(","),new aE.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const n="DELETE",i=[];return t&&i.push(`count=${t}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new aE.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};MO.default=_Ve;var FO={},BO={};Object.defineProperty(BO,"__esModule",{value:!0});BO.version=void 0;BO.version="0.0.0-automated";Object.defineProperty(FO,"__esModule",{value:!0});FO.DEFAULT_HEADERS=void 0;const EVe=BO;FO.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${EVe.version}`};var lae=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(FV,"__esModule",{value:!0});const bVe=lae(MO),SVe=lae(PS),wVe=FO;let TVe=class uae{constructor(t,{headers:n={},schema:i,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},wVe.DEFAULT_HEADERS),n),this.schemaName=i,this.fetch=a}from(t){const n=new URL(`${this.url}/${t}`);return new bVe.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new uae(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,n={},{head:i=!1,get:a=!1,count:l}={}){let d;const f=new URL(`${this.url}/rpc/${t}`);let m;i||a?(d=i?"HEAD":"GET",Object.entries(n).filter(([E,S])=>S!==void 0).map(([E,S])=>[E,Array.isArray(S)?`{${S.join(",")}}`:`${S}`]).forEach(([E,S])=>{f.searchParams.append(E,S)})):(d="POST",m=n);const v=Object.assign({},this.headers);return l&&(v.Prefer=`count=${l}`),new SVe.default({method:d,url:f,headers:v,schema:this.schemaName,body:m,fetch:this.fetch,allowEmpty:!1})}};FV.default=TVe;var ry=Ri&&Ri.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(fs,"__esModule",{value:!0});fs.PostgrestError=fs.PostgrestBuilder=fs.PostgrestTransformBuilder=fs.PostgrestFilterBuilder=fs.PostgrestQueryBuilder=fs.PostgrestClient=void 0;const dae=ry(FV);fs.PostgrestClient=dae.default;const hae=ry(MO);fs.PostgrestQueryBuilder=hae.default;const fae=ry(PS);fs.PostgrestFilterBuilder=fae.default;const pae=ry(jO);fs.PostgrestTransformBuilder=pae.default;const mae=ry(UO);fs.PostgrestBuilder=mae.default;const gae=ry(VO);fs.PostgrestError=gae.default;var CVe=fs.default={PostgrestClient:dae.default,PostgrestQueryBuilder:hae.default,PostgrestFilterBuilder:fae.default,PostgrestTransformBuilder:pae.default,PostgrestBuilder:mae.default,PostgrestError:gae.default};const{PostgrestClient:RVe,PostgrestQueryBuilder:EEt,PostgrestFilterBuilder:bEt,PostgrestTransformBuilder:SEt,PostgrestBuilder:wEt,PostgrestError:TEt}=CVe,AVe="2.11.2",OVe={"X-Client-Info":`realtime-js/${AVe}`},IVe="1.0.0",vae=1e4,xVe=1e3;var Hg;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Hg||(Hg={}));var Vs;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Vs||(Vs={}));var Tc;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Tc||(Tc={}));var c2;(function(e){e.websocket="websocket"})(c2||(c2={}));var Gf;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Gf||(Gf={}));class PVe{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),i=new TextDecoder;return this._decodeBroadcast(t,n,i)}_decodeBroadcast(t,n,i){const a=n.getUint8(1),l=n.getUint8(2);let d=this.HEADER_LENGTH+2;const f=i.decode(t.slice(d,d+a));d=d+a;const m=i.decode(t.slice(d,d+l));d=d+l;const v=JSON.parse(i.decode(t.slice(d,t.byteLength)));return{ref:null,topic:f,event:m,payload:v}}}let yae=class{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var _r;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(_r||(_r={}));const iJ=(e,t,n={})=>{var i;const a=(i=n.skipTypes)!==null&&i!==void 0?i:[];return Object.keys(t).reduce((l,d)=>(l[d]=NVe(d,e,t,a),l),{})},NVe=(e,t,n,i)=>{const a=t.find(f=>f.name===e),l=a==null?void 0:a.type,d=n[e];return l&&!i.includes(l)?_ae(l,d):l2(d)},_ae=(e,t)=>{if(e.charAt(0)==="_"){const n=e.slice(1,e.length);return MVe(t,n)}switch(e){case _r.bool:return DVe(t);case _r.float4:case _r.float8:case _r.int2:case _r.int4:case _r.int8:case _r.numeric:case _r.oid:return kVe(t);case _r.json:case _r.jsonb:return LVe(t);case _r.timestamp:return jVe(t);case _r.abstime:case _r.date:case _r.daterange:case _r.int4range:case _r.int8range:case _r.money:case _r.reltime:case _r.text:case _r.time:case _r.timestamptz:case _r.timetz:case _r.tsrange:case _r.tstzrange:return l2(t);default:return l2(t)}},l2=e=>e,DVe=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},kVe=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},LVe=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},MVe=(e,t)=>{if(typeof e!="string")return e;const n=e.length-1,i=e[n];if(e[0]==="{"&&i==="}"){let l;const d=e.slice(1,n);try{l=JSON.parse("["+d+"]")}catch{l=d?d.split(","):[]}return l.map(f=>_ae(t,f))}return e},jVe=e=>typeof e=="string"?e.replace(" ","T"):e,Eae=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Hk{constructor(t,n,i={},a=vae){this.channel=t,this.event=n,this.payload=i,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var i;return this._hasReceived(t)&&n((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(i=>i.status===t).forEach(i=>i.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var oJ;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(oJ||(oJ={}));class GE{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},a=>{const{onJoin:l,onLeave:d,onSync:f}=this.caller;this.joinRef=this.channel._joinRef(),this.state=GE.syncState(this.state,a,l,d),this.pendingDiffs.forEach(m=>{this.state=GE.syncDiff(this.state,m,l,d)}),this.pendingDiffs=[],f()}),this.channel._on(i.diff,{},a=>{const{onJoin:l,onLeave:d,onSync:f}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=GE.syncDiff(this.state,a,l,d),f())}),this.onJoin((a,l,d)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:d})}),this.onLeave((a,l,d)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:d})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,i,a){const l=this.cloneDeep(t),d=this.transformState(n),f={},m={};return this.map(l,(v,E)=>{d[v]||(m[v]=E)}),this.map(d,(v,E)=>{const S=l[v];if(S){const T=E.map(P=>P.presence_ref),R=S.map(P=>P.presence_ref),I=E.filter(P=>R.indexOf(P.presence_ref)<0),O=S.filter(P=>T.indexOf(P.presence_ref)<0);I.length>0&&(f[v]=I),O.length>0&&(m[v]=O)}else f[v]=E}),this.syncDiff(l,{joins:f,leaves:m},i,a)}static syncDiff(t,n,i,a){const{joins:l,leaves:d}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return i||(i=()=>{}),a||(a=()=>{}),this.map(l,(f,m)=>{var v;const E=(v=t[f])!==null&&v!==void 0?v:[];if(t[f]=this.cloneDeep(m),E.length>0){const S=t[f].map(R=>R.presence_ref),T=E.filter(R=>S.indexOf(R.presence_ref)<0);t[f].unshift(...T)}i(f,E,m)}),this.map(d,(f,m)=>{let v=t[f];if(!v)return;const E=m.map(S=>S.presence_ref);v=v.filter(S=>E.indexOf(S.presence_ref)<0),t[f]=v,a(f,v,m),v.length===0&&delete t[f]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(i=>n(i,t[i]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,i)=>{const a=t[i];return"metas"in a?n[i]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):n[i]=a,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var sJ;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(sJ||(sJ={}));var aJ;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(aJ||(aJ={}));var uu;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(uu||(uu={}));class BV{constructor(t,n={config:{}},i){this.topic=t,this.params=n,this.socket=i,this.bindings={},this.state=Vs.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Hk(this,Tc.join,this.params,this.timeout),this.rejoinTimer=new yae(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Vs.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Vs.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Vs.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Vs.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Tc.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new GE(this),this.broadcastEndpointURL=Eae(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,n=this.timeout){var i,a;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:l,presence:d,private:f}}=this.params;this._onError(E=>t==null?void 0:t(uu.CHANNEL_ERROR,E)),this._onClose(()=>t==null?void 0:t(uu.CLOSED));const m={},v={broadcast:l,presence:d,postgres_changes:(a=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(E=>E.filter))!==null&&a!==void 0?a:[],private:f};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:v},m)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:E})=>{var S;if(this.socket.setAuth(),E===void 0){t==null||t(uu.SUBSCRIBED);return}else{const T=this.bindings.postgres_changes,R=(S=T==null?void 0:T.length)!==null&&S!==void 0?S:0,I=[];for(let O=0;O<R;O++){const P=T[O],{filter:{event:D,schema:k,table:M,filter:$}}=P,V=E&&E[O];if(V&&V.event===D&&V.schema===k&&V.table===M&&V.filter===$)I.push(Object.assign(Object.assign({},P),{id:V.id}));else{this.unsubscribe(),t==null||t(uu.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=I,t&&t(uu.SUBSCRIBED);return}}).receive("error",E=>{t==null||t(uu.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(E).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(uu.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,i){return this._on(t,n,i)}async send(t,n={}){var i,a;if(!this._canPush()&&t.type==="broadcast"){const{event:l,payload:d}=t,m={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:d,private:this.private}]})};try{const v=await this._fetchWithTimeout(this.broadcastEndpointURL,m,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);return await((a=v.body)===null||a===void 0?void 0:a.cancel()),v.ok?"ok":"error"}catch(v){return v.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var d,f,m;const v=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((m=(f=(d=this.params)===null||d===void 0?void 0:d.config)===null||f===void 0?void 0:f.broadcast)===null||m===void 0)&&m.ack)&&l("ok"),v.receive("ok",()=>l("ok")),v.receive("error",()=>l("error")),v.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Vs.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Tc.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(i=>{const a=new Hk(this,Tc.leave,{},t);a.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),a.send(),this._canPush()||a.trigger("ok",{})})}async _fetchWithTimeout(t,n,i){const a=new AbortController,l=setTimeout(()=>a.abort(),i),d=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(l),d}_push(t,n,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Hk(this,t,n,i);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,n,i){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,i){var a,l;const d=t.toLocaleLowerCase(),{close:f,error:m,leave:v,join:E}=Tc;if(i&&[f,m,v,E].indexOf(d)>=0&&i!==this._joinRef())return;let T=this._onMessage(d,n,i);if(n&&!T)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(d)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(R=>{var I,O,P;return((I=R.filter)===null||I===void 0?void 0:I.event)==="*"||((P=(O=R.filter)===null||O===void 0?void 0:O.event)===null||P===void 0?void 0:P.toLocaleLowerCase())===d}).map(R=>R.callback(T,i)):(l=this.bindings[d])===null||l===void 0||l.filter(R=>{var I,O,P,D,k,M;if(["broadcast","presence","postgres_changes"].includes(d))if("id"in R){const $=R.id,V=(I=R.filter)===null||I===void 0?void 0:I.event;return $&&((O=n.ids)===null||O===void 0?void 0:O.includes($))&&(V==="*"||(V==null?void 0:V.toLocaleLowerCase())===((P=n.data)===null||P===void 0?void 0:P.type.toLocaleLowerCase()))}else{const $=(k=(D=R==null?void 0:R.filter)===null||D===void 0?void 0:D.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return $==="*"||$===((M=n==null?void 0:n.event)===null||M===void 0?void 0:M.toLocaleLowerCase())}else return R.type.toLocaleLowerCase()===d}).map(R=>{if(typeof T=="object"&&"ids"in T){const I=T.data,{schema:O,table:P,commit_timestamp:D,type:k,errors:M}=I;T=Object.assign(Object.assign({},{schema:O,table:P,commit_timestamp:D,eventType:k,new:{},old:{},errors:M}),this._getPayloadRecords(I))}R.callback(T,i)})}_isClosed(){return this.state===Vs.closed}_isJoined(){return this.state===Vs.joined}_isJoining(){return this.state===Vs.joining}_isLeaving(){return this.state===Vs.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,i){const a=t.toLocaleLowerCase(),l={type:a,filter:n,callback:i};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(t,n){const i=t.toLocaleLowerCase();return this.bindings[i]=this.bindings[i].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===i&&BV.isEqual(a.filter,n))}),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const i in t)if(t[i]!==n[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Tc.close,{},t)}_onError(t){this._on(Tc.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Vs.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=iJ(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=iJ(t.columns,t.old_record)),n}}const UVe=()=>{},VVe=typeof WebSocket<"u",FVe=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class BVe{constructor(t,n){var i;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=OVe,this.params={},this.timeout=vae,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=UVe,this.conn=null,this.sendBuffer=[],this.serializer=new PVe,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=l=>{let d;return l?d=l:typeof fetch>"u"?d=(...f)=>pv(async()=>{const{default:m}=await Promise.resolve().then(()=>ny);return{default:m}},void 0).then(({default:m})=>m(...f)):d=fetch,(...f)=>d(...f)},this.endPoint=`${t}/${c2.websocket}`,this.httpEndpoint=Eae(t),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const a=(i=n==null?void 0:n.params)===null||i===void 0?void 0:i.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:l=>[1e3,2e3,5e3,1e4][l-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(l,d)=>d(JSON.stringify(l)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new yae(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(VVe){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new $Ve(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),pv(async()=>{const{default:t}=await import("./browser-BxkeEY3x.js").then(n=>n.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:IVe}))}disconnect(t,n){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),t}log(t,n,i){this.logger(t,n,i)}connectionState(){switch(this.conn&&this.conn.readyState){case Hg.connecting:return Gf.Connecting;case Hg.open:return Gf.Open;case Hg.closing:return Gf.Closing;default:return Gf.Closed}}isConnected(){return this.connectionState()===Gf.Open}channel(t,n={config:{}}){const i=new BV(`realtime:${t}`,n,this);return this.channels.push(i),i}push(t){const{topic:n,event:i,payload:a,ref:l}=t,d=()=>{this.encode(t,f=>{var m;(m=this.conn)===null||m===void 0||m.send(f)})};this.log("push",`${n} ${i} (${l})`,a),this.isConnected()?d():this.sendBuffer.push(d)}async setAuth(t=null){let n=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(n){let i=null;try{i=JSON.parse(atob(n.split(".")[1]))}catch{}if(i&&i.exp&&!(Math.floor(Date.now()/1e3)-i.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${i.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${i.exp}`);this.accessTokenValue=n,this.channels.forEach(a=>{n&&a.updateJoinPayload({access_token:n}),a.joinedOnce&&a._isJoined()&&a._push(Tc.access_token,{access_token:n})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(xVe,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(i=>i.topic===t&&(i._isJoined()||i._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,n=>{let{topic:i,event:a,payload:l,ref:d}=n;d&&d===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${l.status||""} ${i} ${a} ${d&&"("+d+")"||""}`,l),this.channels.filter(f=>f._isMember(i)).forEach(f=>f._trigger(a,l,d)),this.stateChangeCallbacks.message.forEach(f=>f(n))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Tc.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const i=t.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${t}${i}${a}`}_workerObjectUrl(t){let n;if(t)n=t;else{const i=new Blob([FVe],{type:"application/javascript"});n=URL.createObjectURL(i)}return n}}class $Ve{constructor(t,n,i){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Hg.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=i.close}}class $V extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Hi(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class WVe extends $V{constructor(t,n){super(t),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class u2 extends $V{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}var GVe=function(e,t,n,i){function a(l){return l instanceof n?l:new n(function(d){d(l)})}return new(n||(n=Promise))(function(l,d){function f(E){try{v(i.next(E))}catch(S){d(S)}}function m(E){try{v(i.throw(E))}catch(S){d(S)}}function v(E){E.done?l(E.value):a(E.value).then(f,m)}v((i=i.apply(e,t||[])).next())})};const bae=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>pv(async()=>{const{default:i}=await Promise.resolve().then(()=>ny);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},HVe=()=>GVe(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield pv(()=>Promise.resolve().then(()=>ny),void 0)).Response:Response}),d2=e=>{if(Array.isArray(e))return e.map(n=>d2(n));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([n,i])=>{const a=n.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[a]=d2(i)}),t};var xp=function(e,t,n,i){function a(l){return l instanceof n?l:new n(function(d){d(l)})}return new(n||(n=Promise))(function(l,d){function f(E){try{v(i.next(E))}catch(S){d(S)}}function m(E){try{v(i.throw(E))}catch(S){d(S)}}function v(E){E.done?l(E.value):a(E.value).then(f,m)}v((i=i.apply(e,t||[])).next())})};const Kk=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),KVe=(e,t,n)=>xp(void 0,void 0,void 0,function*(){const i=yield HVe();e instanceof i&&!(n!=null&&n.noResolveJson)?e.json().then(a=>{t(new WVe(Kk(a),e.status||500))}).catch(a=>{t(new u2(Kk(a),a))}):t(new u2(Kk(e),e))}),zVe=(e,t,n,i)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i&&(a.body=JSON.stringify(i)),Object.assign(Object.assign({},a),n))};function NS(e,t,n,i,a,l){return xp(this,void 0,void 0,function*(){return new Promise((d,f)=>{e(n,zVe(t,i,a,l)).then(m=>{if(!m.ok)throw m;return i!=null&&i.noResolveJson?m:m.json()}).then(m=>d(m)).catch(m=>KVe(m,f,i))})})}function KR(e,t,n,i){return xp(this,void 0,void 0,function*(){return NS(e,"GET",t,n,i)})}function $d(e,t,n,i,a){return xp(this,void 0,void 0,function*(){return NS(e,"POST",t,i,a,n)})}function YVe(e,t,n,i,a){return xp(this,void 0,void 0,function*(){return NS(e,"PUT",t,i,a,n)})}function qVe(e,t,n,i){return xp(this,void 0,void 0,function*(){return NS(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),i)})}function Sae(e,t,n,i,a){return xp(this,void 0,void 0,function*(){return NS(e,"DELETE",t,i,a,n)})}var us=function(e,t,n,i){function a(l){return l instanceof n?l:new n(function(d){d(l)})}return new(n||(n=Promise))(function(l,d){function f(E){try{v(i.next(E))}catch(S){d(S)}}function m(E){try{v(i.throw(E))}catch(S){d(S)}}function v(E){E.done?l(E.value):a(E.value).then(f,m)}v((i=i.apply(e,t||[])).next())})};const XVe={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},cJ={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class JVe{constructor(t,n={},i,a){this.url=t,this.headers=n,this.bucketId=i,this.fetch=bae(a)}uploadOrUpdate(t,n,i,a){return us(this,void 0,void 0,function*(){try{let l;const d=Object.assign(Object.assign({},cJ),a);let f=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(d.upsert)});const m=d.metadata;typeof Blob<"u"&&i instanceof Blob?(l=new FormData,l.append("cacheControl",d.cacheControl),m&&l.append("metadata",this.encodeMetadata(m)),l.append("",i)):typeof FormData<"u"&&i instanceof FormData?(l=i,l.append("cacheControl",d.cacheControl),m&&l.append("metadata",this.encodeMetadata(m))):(l=i,f["cache-control"]=`max-age=${d.cacheControl}`,f["content-type"]=d.contentType,m&&(f["x-metadata"]=this.toBase64(this.encodeMetadata(m)))),a!=null&&a.headers&&(f=Object.assign(Object.assign({},f),a.headers));const v=this._removeEmptyFolders(n),E=this._getFinalPath(v),S=yield this.fetch(`${this.url}/object/${E}`,Object.assign({method:t,body:l,headers:f},d!=null&&d.duplex?{duplex:d.duplex}:{})),T=yield S.json();return S.ok?{data:{path:v,id:T.Id,fullPath:T.Key},error:null}:{data:null,error:T}}catch(l){if(Hi(l))return{data:null,error:l};throw l}})}upload(t,n,i){return us(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,i)})}uploadToSignedUrl(t,n,i,a){return us(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(t),d=this._getFinalPath(l),f=new URL(this.url+`/object/upload/sign/${d}`);f.searchParams.set("token",n);try{let m;const v=Object.assign({upsert:cJ.upsert},a),E=Object.assign(Object.assign({},this.headers),{"x-upsert":String(v.upsert)});typeof Blob<"u"&&i instanceof Blob?(m=new FormData,m.append("cacheControl",v.cacheControl),m.append("",i)):typeof FormData<"u"&&i instanceof FormData?(m=i,m.append("cacheControl",v.cacheControl)):(m=i,E["cache-control"]=`max-age=${v.cacheControl}`,E["content-type"]=v.contentType);const S=yield this.fetch(f.toString(),{method:"PUT",body:m,headers:E}),T=yield S.json();return S.ok?{data:{path:l,fullPath:T.Key},error:null}:{data:null,error:T}}catch(m){if(Hi(m))return{data:null,error:m};throw m}})}createSignedUploadUrl(t,n){return us(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const l=yield $d(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:a}),d=new URL(this.url+l.url),f=d.searchParams.get("token");if(!f)throw new $V("No token returned by API");return{data:{signedUrl:d.toString(),path:t,token:f},error:null}}catch(i){if(Hi(i))return{data:null,error:i};throw i}})}update(t,n,i){return us(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,i)})}move(t,n,i){return us(this,void 0,void 0,function*(){try{return{data:yield $d(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Hi(a))return{data:null,error:a};throw a}})}copy(t,n,i){return us(this,void 0,void 0,function*(){try{return{data:{path:(yield $d(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:i==null?void 0:i.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Hi(a))return{data:null,error:a};throw a}})}createSignedUrl(t,n,i){return us(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),l=yield $d(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},i!=null&&i.transform?{transform:i.transform}:{}),{headers:this.headers});const d=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${d}`)},{data:l,error:null}}catch(a){if(Hi(a))return{data:null,error:a};throw a}})}createSignedUrls(t,n,i){return us(this,void 0,void 0,function*(){try{const a=yield $d(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),l=i!=null&&i.download?`&download=${i.download===!0?"":i.download}`:"";return{data:a.map(d=>Object.assign(Object.assign({},d),{signedUrl:d.signedURL?encodeURI(`${this.url}${d.signedURL}${l}`):null})),error:null}}catch(a){if(Hi(a))return{data:null,error:a};throw a}})}download(t,n){return us(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),d=l?`?${l}`:"";try{const f=this._getFinalPath(t);return{data:yield(yield KR(this.fetch,`${this.url}/${a}/${f}${d}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(f){if(Hi(f))return{data:null,error:f};throw f}})}info(t){return us(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const i=yield KR(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:d2(i),error:null}}catch(i){if(Hi(i))return{data:null,error:i};throw i}})}exists(t){return us(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield qVe(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(Hi(i)&&i instanceof u2){const a=i.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:i}}throw i}})}getPublicUrl(t,n){const i=this._getFinalPath(t),a=[],l=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";l!==""&&a.push(l);const f=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",m=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});m!==""&&a.push(m);let v=a.join("&");return v!==""&&(v=`?${v}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${i}${v}`)}}}remove(t){return us(this,void 0,void 0,function*(){try{return{data:yield Sae(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(Hi(n))return{data:null,error:n};throw n}})}list(t,n,i){return us(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},XVe),n),{prefix:t||""});return{data:yield $d(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},i),error:null}}catch(a){if(Hi(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const QVe="2.7.1",ZVe={"X-Client-Info":`storage-js/${QVe}`};var tg=function(e,t,n,i){function a(l){return l instanceof n?l:new n(function(d){d(l)})}return new(n||(n=Promise))(function(l,d){function f(E){try{v(i.next(E))}catch(S){d(S)}}function m(E){try{v(i.throw(E))}catch(S){d(S)}}function v(E){E.done?l(E.value):a(E.value).then(f,m)}v((i=i.apply(e,t||[])).next())})};class eFe{constructor(t,n={},i){this.url=t,this.headers=Object.assign(Object.assign({},ZVe),n),this.fetch=bae(i)}listBuckets(){return tg(this,void 0,void 0,function*(){try{return{data:yield KR(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Hi(t))return{data:null,error:t};throw t}})}getBucket(t){return tg(this,void 0,void 0,function*(){try{return{data:yield KR(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(Hi(n))return{data:null,error:n};throw n}})}createBucket(t,n={public:!1}){return tg(this,void 0,void 0,function*(){try{return{data:yield $d(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(Hi(i))return{data:null,error:i};throw i}})}updateBucket(t,n){return tg(this,void 0,void 0,function*(){try{return{data:yield YVe(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(Hi(i))return{data:null,error:i};throw i}})}emptyBucket(t){return tg(this,void 0,void 0,function*(){try{return{data:yield $d(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(Hi(n))return{data:null,error:n};throw n}})}deleteBucket(t){return tg(this,void 0,void 0,function*(){try{return{data:yield Sae(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(Hi(n))return{data:null,error:n};throw n}})}}class tFe extends eFe{constructor(t,n={},i){super(t,n,i)}from(t){return new JVe(this.url,this.headers,t,this.fetch)}}const nFe="2.49.8";let CE="";typeof Deno<"u"?CE="deno":typeof document<"u"?CE="web":typeof navigator<"u"&&navigator.product==="ReactNative"?CE="react-native":CE="node";const rFe={"X-Client-Info":`supabase-js-${CE}/${nFe}`},iFe={headers:rFe},oFe={schema:"public"},sFe={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},aFe={};var cFe=function(e,t,n,i){function a(l){return l instanceof n?l:new n(function(d){d(l)})}return new(n||(n=Promise))(function(l,d){function f(E){try{v(i.next(E))}catch(S){d(S)}}function m(E){try{v(i.throw(E))}catch(S){d(S)}}function v(E){E.done?l(E.value):a(E.value).then(f,m)}v((i=i.apply(e,t||[])).next())})};const lFe=e=>{let t;return e?t=e:typeof fetch>"u"?t=sae:t=fetch,(...n)=>t(...n)},uFe=()=>typeof Headers>"u"?aae:Headers,dFe=(e,t,n)=>{const i=lFe(n),a=uFe();return(l,d)=>cFe(void 0,void 0,void 0,function*(){var f;const m=(f=yield t())!==null&&f!==void 0?f:e;let v=new a(d==null?void 0:d.headers);return v.has("apikey")||v.set("apikey",e),v.has("Authorization")||v.set("Authorization",`Bearer ${m}`),i(l,Object.assign(Object.assign({},d),{headers:v}))})};var hFe=function(e,t,n,i){function a(l){return l instanceof n?l:new n(function(d){d(l)})}return new(n||(n=Promise))(function(l,d){function f(E){try{v(i.next(E))}catch(S){d(S)}}function m(E){try{v(i.throw(E))}catch(S){d(S)}}function v(E){E.done?l(E.value):a(E.value).then(f,m)}v((i=i.apply(e,t||[])).next())})};function fFe(e){return e.endsWith("/")?e:e+"/"}function pFe(e,t){var n,i;const{db:a,auth:l,realtime:d,global:f}=e,{db:m,auth:v,realtime:E,global:S}=t,T={db:Object.assign(Object.assign({},m),a),auth:Object.assign(Object.assign({},v),l),realtime:Object.assign(Object.assign({},E),d),global:Object.assign(Object.assign(Object.assign({},S),f),{headers:Object.assign(Object.assign({},(n=S==null?void 0:S.headers)!==null&&n!==void 0?n:{}),(i=f==null?void 0:f.headers)!==null&&i!==void 0?i:{})}),accessToken:()=>hFe(this,void 0,void 0,function*(){return""})};return e.accessToken?T.accessToken=e.accessToken:delete T.accessToken,T}const wae="2.69.1",hg=30*1e3,h2=3,zk=h2*hg,mFe="http://localhost:9999",gFe="supabase.auth.token",vFe={"X-Client-Info":`gotrue-js/${wae}`},f2="X-Supabase-Api-Version",Tae={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},yFe=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,_Fe=6e5;class WV extends Error{constructor(t,n,i){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=i}}function an(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class EFe extends WV{constructor(t,n,i){super(t,n,i),this.name="AuthApiError",this.status=n,this.code=i}}function bFe(e){return an(e)&&e.name==="AuthApiError"}class Cae extends WV{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class Ih extends WV{constructor(t,n,i,a){super(t,i,a),this.name=n,this.status=i}}class Md extends Ih{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function SFe(e){return an(e)&&e.name==="AuthSessionMissingError"}class Yk extends Ih{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class SC extends Ih{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class wC extends Ih{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function wFe(e){return an(e)&&e.name==="AuthImplicitGrantRedirectError"}class lJ extends Ih{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class p2 extends Ih{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function qk(e){return an(e)&&e.name==="AuthRetryableFetchError"}class uJ extends Ih{constructor(t,n,i){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=i}}class HE extends Ih{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const dJ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),hJ=` 	
\r=`.split(""),TFe=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<hJ.length;t+=1)e[hJ[t].charCodeAt(0)]=-2;for(let t=0;t<dJ.length;t+=1)e[dJ[t].charCodeAt(0)]=t;return e})();function Rae(e,t,n){const i=TFe[e];if(i>-1)for(t.queue=t.queue<<6|i,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function fJ(e){const t=[],n=d=>{t.push(String.fromCodePoint(d))},i={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=d=>{AFe(d,i,n)};for(let d=0;d<e.length;d+=1)Rae(e.charCodeAt(d),a,l);return t.join("")}function CFe(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function RFe(e,t){for(let n=0;n<e.length;n+=1){let i=e.charCodeAt(n);if(i>55295&&i<=56319){const a=(i-55296)*1024&65535;i=(e.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}CFe(i,t)}}function AFe(e,t,n){if(t.utf8seq===0){if(e<=127){n(e);return}for(let i=1;i<6;i+=1)if(!(e>>7-i&1)){t.utf8seq=i;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function OFe(e){const t=[],n={queue:0,queuedBits:0},i=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)Rae(e.charCodeAt(a),n,i);return new Uint8Array(t)}function IFe(e){const t=[];return RFe(e,n=>t.push(n)),new Uint8Array(t)}function xFe(e){return Math.round(Date.now()/1e3)+e}function PFe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const dl=()=>typeof window<"u"&&typeof document<"u",If={tested:!1,writable:!1},KE=()=>{if(!dl())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(If.tested)return If.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),If.tested=!0,If.writable=!0}catch{If.tested=!0,If.writable=!1}return If.writable};function NFe(e){const t={},n=new URL(e);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,l)=>{t[l]=a})}catch{}return n.searchParams.forEach((i,a)=>{t[a]=i}),t}const Aae=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>pv(async()=>{const{default:i}=await Promise.resolve().then(()=>ny);return{default:i}},void 0).then(({default:i})=>i(...n)):t=fetch,(...n)=>t(...n)},DFe=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Oae=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},TC=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},CC=async(e,t)=>{await e.removeItem(t)};class $O{constructor(){this.promise=new $O.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}$O.promiseConstructor=Promise;function Xk(e){const t=e.split(".");if(t.length!==3)throw new HE("Invalid JWT structure");for(let i=0;i<t.length;i++)if(!yFe.test(t[i]))throw new HE("JWT not in base64url format");return{header:JSON.parse(fJ(t[0])),payload:JSON.parse(fJ(t[1])),signature:OFe(t[2]),raw:{header:t[0],payload:t[1]}}}async function kFe(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function LFe(e,t){return new Promise((i,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const d=await e(l);if(!t(l,null,d)){i(d);return}}catch(d){if(!t(l,d)){a(d);return}}})()})}function MFe(e){return("0"+e.toString(16)).substr(-2)}function jFe(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=n.length;let a="";for(let l=0;l<56;l++)a+=n.charAt(Math.floor(Math.random()*i));return a}return crypto.getRandomValues(t),Array.from(t,MFe).join("")}async function UFe(e){const n=new TextEncoder().encode(e),i=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(i);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function VFe(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const n=await UFe(e);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ng(e,t,n=!1){const i=jFe();let a=i;n&&(a+="/PASSWORD_RECOVERY"),await Oae(e,`${t}-code-verifier`,a);const l=await VFe(i);return[l,i===l?"plain":"s256"]}const FFe=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function BFe(e){const t=e.headers.get(f2);if(!t||!t.match(FFe))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function $Fe(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function WFe(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var GFe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]]);return n};const Mf=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),HFe=[502,503,504];async function pJ(e){var t;if(!DFe(e))throw new p2(Mf(e),0);if(HFe.includes(e.status))throw new p2(Mf(e),e.status);let n;try{n=await e.json()}catch(l){throw new Cae(Mf(l),l)}let i;const a=BFe(e);if(a&&a.getTime()>=Tae["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?i=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(i=n.error_code),i){if(i==="weak_password")throw new uJ(Mf(n),e.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(i==="session_not_found")throw new Md}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((l,d)=>l&&typeof d=="string",!0))throw new uJ(Mf(n),e.status,n.weak_password.reasons);throw new EFe(Mf(n),e.status||500,i)}const KFe=(e,t,n,i)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(i),Object.assign(Object.assign({},a),n))};async function Sn(e,t,n,i){var a;const l=Object.assign({},i==null?void 0:i.headers);l[f2]||(l[f2]=Tae["2024-01-01"].name),i!=null&&i.jwt&&(l.Authorization=`Bearer ${i.jwt}`);const d=(a=i==null?void 0:i.query)!==null&&a!==void 0?a:{};i!=null&&i.redirectTo&&(d.redirect_to=i.redirectTo);const f=Object.keys(d).length?"?"+new URLSearchParams(d).toString():"",m=await zFe(e,t,n+f,{headers:l,noResolveJson:i==null?void 0:i.noResolveJson},{},i==null?void 0:i.body);return i!=null&&i.xform?i==null?void 0:i.xform(m):{data:Object.assign({},m),error:null}}async function zFe(e,t,n,i,a,l){const d=KFe(t,i,a,l);let f;try{f=await e(n,Object.assign({},d))}catch(m){throw console.error(m),new p2(Mf(m),0)}if(f.ok||await pJ(f),i!=null&&i.noResolveJson)return f;try{return await f.json()}catch(m){await pJ(m)}}function jd(e){var t;let n=null;JFe(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=xFe(e.expires_in)));const i=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:n,user:i},error:null}}function mJ(e){const t=jd(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((n,i)=>n&&typeof i=="string",!0)&&(t.data.weak_password=e.weak_password),t}function zd(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function YFe(e){return{data:e,error:null}}function qFe(e){const{action_link:t,email_otp:n,hashed_token:i,redirect_to:a,verification_type:l}=e,d=GFe(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),f={action_link:t,email_otp:n,hashed_token:i,redirect_to:a,verification_type:l},m=Object.assign({},d);return{data:{properties:f,user:m},error:null}}function XFe(e){return e}function JFe(e){return e.access_token&&e.refresh_token&&e.expires_in}var QFe=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]]);return n};class ZFe{constructor({url:t="",headers:n={},fetch:i}){this.url=t,this.headers=n,this.fetch=Aae(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,n="global"){try{return await Sn(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(i){if(an(i))return{data:null,error:i};throw i}}async inviteUserByEmail(t,n={}){try{return await Sn(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:zd})}catch(i){if(an(i))return{data:{user:null},error:i};throw i}}async generateLink(t){try{const{options:n}=t,i=QFe(t,["options"]),a=Object.assign(Object.assign({},i),n);return"newEmail"in i&&(a.new_email=i==null?void 0:i.newEmail,delete a.newEmail),await Sn(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:qFe,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(an(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await Sn(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:zd})}catch(n){if(an(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,i,a,l,d,f,m;try{const v={nextPage:null,lastPage:0,total:0},E=await Sn(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:"",per_page:(l=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:XFe});if(E.error)throw E.error;const S=await E.json(),T=(d=E.headers.get("x-total-count"))!==null&&d!==void 0?d:0,R=(m=(f=E.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&m!==void 0?m:[];return R.length>0&&(R.forEach(I=>{const O=parseInt(I.split(";")[0].split("=")[1].substring(0,1)),P=JSON.parse(I.split(";")[1].split("=")[1]);v[`${P}Page`]=O}),v.total=parseInt(T)),{data:Object.assign(Object.assign({},S),v),error:null}}catch(v){if(an(v))return{data:{users:[]},error:v};throw v}}async getUserById(t){try{return await Sn(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:zd})}catch(n){if(an(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){try{return await Sn(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:zd})}catch(i){if(an(i))return{data:{user:null},error:i};throw i}}async deleteUser(t,n=!1){try{return await Sn(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:zd})}catch(i){if(an(i))return{data:{user:null},error:i};throw i}}async _listFactors(t){try{const{data:n,error:i}=await Sn(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:i}}catch(n){if(an(n))return{data:null,error:n};throw n}}async _deleteFactor(t){try{return{data:await Sn(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(an(n))return{data:null,error:n};throw n}}}const eBe={getItem:e=>KE()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{KE()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{KE()&&globalThis.localStorage.removeItem(e)}};function gJ(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}function tBe(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const rg={debug:!!(globalThis&&KE()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Iae extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class nBe extends Iae{}async function rBe(e,t,n){rg.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),rg.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async a=>{if(a){rg.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await n()}finally{rg.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw rg.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new nBe(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(rg.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}tBe();const iBe={url:mFe,storageKey:gFe,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:vFe,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function vJ(e,t,n){return await n()}class Ib{constructor(t){var n,i;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ib.nextInstanceID,Ib.nextInstanceID+=1,this.instanceID>0&&dl()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},iBe),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new ZFe({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Aae(a.fetch),this.lock=a.lock||vJ,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:dl()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=rBe:this.lock=vJ,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:KE()?this.storage=eBe:(this.memoryStorage={},this.storage=gJ(this.memoryStorage)):(this.memoryStorage={},this.storage=gJ(this.memoryStorage)),dl()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${wae}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=NFe(window.location.href);let i="none";if(this._isImplicitGrantCallback(n)?i="implicit":await this._isPKCECallback(n)&&(i="pkce"),dl()&&this.detectSessionInUrl&&i!=="none"){const{data:a,error:l}=await this._getSessionFromURL(n,i);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),wFe(l)){const m=(t=l.details)===null||t===void 0?void 0:t.code;if(m==="identity_already_exists"||m==="identity_not_found"||m==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:d,redirectType:f}=a;return this._debug("#_initialize()","detected session in URL",d,"redirect type",f),await this._saveSession(d),setTimeout(async()=>{f==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",d):await this._notifyAllSubscribers("SIGNED_IN",d)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return an(n)?{error:n}:{error:new Cae("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,i,a;try{const l=await Sn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:jd}),{data:d,error:f}=l;if(f||!d)return{data:{user:null,session:null},error:f};const m=d.session,v=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:v,session:m},error:null}}catch(l){if(an(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(t){var n,i,a;try{let l;if("email"in t){const{email:E,password:S,options:T}=t;let R=null,I=null;this.flowType==="pkce"&&([R,I]=await ng(this.storage,this.storageKey)),l=await Sn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:T==null?void 0:T.emailRedirectTo,body:{email:E,password:S,data:(n=T==null?void 0:T.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:T==null?void 0:T.captchaToken},code_challenge:R,code_challenge_method:I},xform:jd})}else if("phone"in t){const{phone:E,password:S,options:T}=t;l=await Sn(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:E,password:S,data:(i=T==null?void 0:T.data)!==null&&i!==void 0?i:{},channel:(a=T==null?void 0:T.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:T==null?void 0:T.captchaToken}},xform:jd})}else throw new SC("You must provide either an email or phone number and a password");const{data:d,error:f}=l;if(f||!d)return{data:{user:null,session:null},error:f};const m=d.session,v=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:v,session:m},error:null}}catch(l){if(an(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(t){try{let n;if("email"in t){const{email:l,password:d,options:f}=t;n=await Sn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:d,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:mJ})}else if("phone"in t){const{phone:l,password:d,options:f}=t;n=await Sn(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:d,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:mJ})}else throw new SC("You must provide either an email or phone number and a password");const{data:i,error:a}=n;return a?{data:{user:null,session:null},error:a}:!i||!i.session||!i.user?{data:{user:null,session:null},error:new Yk}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:a})}catch(n){if(an(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,i,a,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(i=t.options)===null||i===void 0?void 0:i.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const n=await TC(this.storage,`${this.storageKey}-code-verifier`),[i,a]=(n??"").split("/");try{const{data:l,error:d}=await Sn(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:i},xform:jd});if(await CC(this.storage,`${this.storageKey}-code-verifier`),d)throw d;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new Yk}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:d})}catch(l){if(an(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(t){try{const{options:n,provider:i,token:a,access_token:l,nonce:d}=t,f=await Sn(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:a,access_token:l,nonce:d,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:jd}),{data:m,error:v}=f;return v?{data:{user:null,session:null},error:v}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new Yk}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:m,error:v})}catch(n){if(an(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,i,a,l,d;try{if("email"in t){const{email:f,options:m}=t;let v=null,E=null;this.flowType==="pkce"&&([v,E]=await ng(this.storage,this.storageKey));const{error:S}=await Sn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:f,data:(n=m==null?void 0:m.data)!==null&&n!==void 0?n:{},create_user:(i=m==null?void 0:m.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:v,code_challenge_method:E},redirectTo:m==null?void 0:m.emailRedirectTo});return{data:{user:null,session:null},error:S}}if("phone"in t){const{phone:f,options:m}=t,{data:v,error:E}=await Sn(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:f,data:(a=m==null?void 0:m.data)!==null&&a!==void 0?a:{},create_user:(l=m==null?void 0:m.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},channel:(d=m==null?void 0:m.channel)!==null&&d!==void 0?d:"sms"}});return{data:{user:null,session:null,messageId:v==null?void 0:v.message_id},error:E}}throw new SC("You must provide either an email or phone number.")}catch(f){if(an(f))return{data:{user:null,session:null},error:f};throw f}}async verifyOtp(t){var n,i;try{let a,l;"options"in t&&(a=(n=t.options)===null||n===void 0?void 0:n.redirectTo,l=(i=t.options)===null||i===void 0?void 0:i.captchaToken);const{data:d,error:f}=await Sn(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:jd});if(f)throw f;if(!d)throw new Error("An error occurred on token verification.");const m=d.session,v=d.user;return m!=null&&m.access_token&&(await this._saveSession(m),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",m)),{data:{user:v,session:m},error:null}}catch(a){if(an(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var n,i,a;try{let l=null,d=null;return this.flowType==="pkce"&&([l,d]=await ng(this.storage,this.storageKey)),await Sn(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(i=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&i!==void 0?i:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:d}),headers:this.headers,xform:YFe})}catch(l){if(an(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:i}=t;if(i)throw i;if(!n)throw new Md;const{error:a}=await Sn(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(an(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:i,type:a,options:l}=t,{error:d}=await Sn(this.fetch,"POST",n,{headers:this.headers,body:{email:i,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}else if("phone"in t){const{phone:i,type:a,options:l}=t,{data:d,error:f}=await Sn(this.fetch,"POST",n,{headers:this.headers,body:{phone:i,type:a,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:f}}throw new SC("You must provide either an email or phone number and a type")}catch(n){if(an(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await i,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=n();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await TC(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const i=t.expires_at?t.expires_at*1e3-Date.now()<zk:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",t.expires_at),!i){if(this.storage.isServer){let d=this.suppressGetSessionWarning;t=new Proxy(t,{get:(m,v,E)=>(!d&&v==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),d=!0,this.suppressGetSessionWarning=!0),Reflect.get(m,v,E))})}return{data:{session:t},error:null}}const{session:a,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{session:null},error:l}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Sn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:zd}):await this._useSession(async n=>{var i,a,l;const{data:d,error:f}=n;if(f)throw f;return!(!((i=d.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Md}:await Sn(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=d.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:zd})})}catch(n){if(an(n))return SFe(n)&&(await this._removeSession(),await CC(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async i=>{const{data:a,error:l}=i;if(l)throw l;if(!a.session)throw new Md;const d=a.session;let f=null,m=null;this.flowType==="pkce"&&t.email!=null&&([f,m]=await ng(this.storage,this.storageKey));const{data:v,error:E}=await Sn(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:f,code_challenge_method:m}),jwt:d.access_token,xform:zd});if(E)throw E;return d.user=v.user,await this._saveSession(d),await this._notifyAllSubscribers("USER_UPDATED",d),{data:{user:d.user},error:null}})}catch(i){if(an(i))return{data:{user:null},error:i};throw i}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Md;const n=Date.now()/1e3;let i=n,a=!0,l=null;const{payload:d}=Xk(t.access_token);if(d.exp&&(i=d.exp,a=i<=n),a){const{session:f,error:m}=await this._callRefreshToken(t.refresh_token);if(m)return{data:{user:null,session:null},error:m};if(!f)return{data:{user:null,session:null},error:null};l=f}else{const{data:f,error:m}=await this._getUser(t.access_token);if(m)throw m;l={access_token:t.access_token,refresh_token:t.refresh_token,user:f.user,token_type:"bearer",expires_in:i-n,expires_at:i},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(n){if(an(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var i;if(!t){const{data:d,error:f}=n;if(f)throw f;t=(i=d.session)!==null&&i!==void 0?i:void 0}if(!(t!=null&&t.refresh_token))throw new Md;const{session:a,error:l}=await this._callRefreshToken(t.refresh_token);return l?{data:{user:null,session:null},error:l}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(an(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!dl())throw new wC("No browser detected.");if(t.error||t.error_description||t.error_code)throw new wC(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new lJ("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new wC("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new lJ("No code detected.");const{data:k,error:M}=await this._exchangeCodeForSession(t.code);if(M)throw M;const $=new URL(window.location.href);return $.searchParams.delete("code"),window.history.replaceState(window.history.state,"",$.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:a,access_token:l,refresh_token:d,expires_in:f,expires_at:m,token_type:v}=t;if(!l||!f||!d||!v)throw new wC("No session defined in URL");const E=Math.round(Date.now()/1e3),S=parseInt(f);let T=E+S;m&&(T=parseInt(m));const R=T-E;R*1e3<=hg&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${R}s, should have been closer to ${S}s`);const I=T-S;E-I>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",I,T,E):E-I<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",I,T,E);const{data:O,error:P}=await this._getUser(l);if(P)throw P;const D={provider_token:i,provider_refresh_token:a,access_token:l,expires_in:S,expires_at:T,refresh_token:d,token_type:v,user:O.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:D,redirectType:t.type},error:null}}catch(i){if(an(i))return{data:{session:null,redirectType:null},error:i};throw i}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await TC(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var i;const{data:a,error:l}=n;if(l)return{error:l};const d=(i=a.session)===null||i===void 0?void 0:i.access_token;if(d){const{error:f}=await this.admin.signOut(d,t);if(f&&!(bFe(f)&&(f.status===404||f.status===401||f.status===403)))return{error:f}}return t!=="others"&&(await this._removeSession(),await CC(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=PFe(),i={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,i),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:i}}}async _emitInitialSession(t){return await this._useSession(async n=>{var i,a;try{const{data:{session:l},error:d}=n;if(d)throw d;await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,n={}){let i=null,a=null;this.flowType==="pkce"&&([i,a]=await ng(this.storage,this.storageKey,!0));try{return await Sn(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:i,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(l){if(an(l))return{data:null,error:l};throw l}}async getUserIdentities(){var t;try{const{data:n,error:i}=await this.getUser();if(i)throw i;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(an(n))return{data:null,error:n};throw n}}async linkIdentity(t){var n;try{const{data:i,error:a}=await this._useSession(async l=>{var d,f,m,v,E;const{data:S,error:T}=l;if(T)throw T;const R=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(d=t.options)===null||d===void 0?void 0:d.redirectTo,scopes:(f=t.options)===null||f===void 0?void 0:f.scopes,queryParams:(m=t.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:!0});return await Sn(this.fetch,"GET",R,{headers:this.headers,jwt:(E=(v=S.session)===null||v===void 0?void 0:v.access_token)!==null&&E!==void 0?E:void 0})});if(a)throw a;return dl()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(i==null?void 0:i.url),{data:{provider:t.provider,url:i==null?void 0:i.url},error:null}}catch(i){if(an(i))return{data:{provider:t.provider,url:null},error:i};throw i}}async unlinkIdentity(t){try{return await this._useSession(async n=>{var i,a;const{data:l,error:d}=n;if(d)throw d;return await Sn(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(i=l.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(an(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const i=Date.now();return await LFe(async a=>(a>0&&await kFe(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await Sn(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:jd})),(a,l)=>{const d=200*Math.pow(2,a);return l&&qk(l)&&Date.now()+d-i<hg})}catch(i){if(this._debug(n,"error",i),an(i))return{data:{session:null,user:null},error:i};throw i}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const i=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",i),dl()&&!n.skipBrowserRedirect&&window.location.assign(i),{data:{provider:t,url:i},error:null}}async _recoverAndRefresh(){var t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await TC(this.storage,this.storageKey);if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const a=((t=i.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<zk;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${zk}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:l}=await this._callRefreshToken(i.refresh_token);l&&(console.error(l),qk(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var n,i;if(!t)throw new Md;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new $O;const{data:l,error:d}=await this._refreshAccessToken(t);if(d)throw d;if(!l.session)throw new Md;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const f={session:l.session,error:null};return this.refreshingDeferred.resolve(f),f}catch(l){if(this._debug(a,"error",l),an(l)){const d={session:null,error:l};return qk(l)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(d),d}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,n,i=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",n,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:t,session:n});const l=[],d=Array.from(this.stateChangeEmitters.values()).map(async f=>{try{await f.callback(t,n)}catch(m){l.push(m)}});if(await Promise.all(d),l.length>0){for(let f=0;f<l.length;f+=1)console.error(l[f]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Oae(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await CC(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&dl()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),hg);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:i}}=n;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((i.expires_at*1e3-t)/hg);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${hg}ms, refresh threshold is ${h2} ticks`),a<=h2&&await this._callRefreshToken(i.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Iae)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!dl()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,i){const a=[`provider=${encodeURIComponent(n)}`];if(i!=null&&i.redirectTo&&a.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i!=null&&i.scopes&&a.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[l,d]=await ng(this.storage,this.storageKey),f=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(d)}`});a.push(f.toString())}if(i!=null&&i.queryParams){const l=new URLSearchParams(i.queryParams);a.push(l.toString())}return i!=null&&i.skipBrowserRedirect&&a.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var i;const{data:a,error:l}=n;return l?{data:null,error:l}:await Sn(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(an(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var i,a;const{data:l,error:d}=n;if(d)return{data:null,error:d};const f=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:m,error:v}=await Sn(this.fetch,"POST",`${this.url}/factors`,{body:f,headers:this.headers,jwt:(i=l==null?void 0:l.session)===null||i===void 0?void 0:i.access_token});return v?{data:null,error:v}:(t.factorType==="totp"&&(!((a=m==null?void 0:m.totp)===null||a===void 0)&&a.qr_code)&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),{data:m,error:null})})}catch(n){if(an(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:a,error:l}=n;if(l)return{data:null,error:l};const{data:d,error:f}=await Sn(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token});return f?{data:null,error:f}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:f})})}catch(n){if(an(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var i;const{data:a,error:l}=n;return l?{data:null,error:l}:await Sn(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(i=a==null?void 0:a.session)===null||i===void 0?void 0:i.access_token})})}catch(n){if(an(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:i}=await this._challenge({factorId:t.factorId});return i?{data:null,error:i}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const i=(t==null?void 0:t.factors)||[],a=i.filter(d=>d.factor_type==="totp"&&d.status==="verified"),l=i.filter(d=>d.factor_type==="phone"&&d.status==="verified");return{data:{all:i,totp:a,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,i;const{data:{session:a},error:l}=t;if(l)return{data:null,error:l};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=Xk(a.access_token);let f=null;d.aal&&(f=d.aal);let m=f;((i=(n=a.user.factors)===null||n===void 0?void 0:n.filter(S=>S.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(m="aal2");const E=d.amr||[];return{data:{currentLevel:f,nextLevel:m,currentAuthenticationMethods:E},error:null}}))}async fetchJwk(t,n={keys:[]}){let i=n.keys.find(d=>d.kid===t);if(i||(i=this.jwks.keys.find(d=>d.kid===t),i&&this.jwks_cached_at+_Fe>Date.now()))return i;const{data:a,error:l}=await Sn(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;if(!a.keys||a.keys.length===0)throw new HE("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),i=a.keys.find(d=>d.kid===t),!i)throw new HE("No matching signing key found in JWKS");return i}async getClaims(t,n={keys:[]}){try{let i=t;if(!i){const{data:R,error:I}=await this.getSession();if(I||!R.session)return{data:null,error:I};i=R.session.access_token}const{header:a,payload:l,signature:d,raw:{header:f,payload:m}}=Xk(i);if($Fe(l.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:R}=await this.getUser(i);if(R)throw R;return{data:{claims:l,header:a,signature:d},error:null}}const v=WFe(a.alg),E=await this.fetchJwk(a.kid,n),S=await crypto.subtle.importKey("jwk",E,v,!0,["verify"]);if(!await crypto.subtle.verify(v,S,d,IFe(`${f}.${m}`)))throw new HE("Invalid JWT signature");return{data:{claims:l,header:a,signature:d},error:null}}catch(i){if(an(i))return{data:null,error:i};throw i}}}Ib.nextInstanceID=0;const oBe=Ib;class sBe extends oBe{constructor(t){super(t)}}var aBe=function(e,t,n,i){function a(l){return l instanceof n?l:new n(function(d){d(l)})}return new(n||(n=Promise))(function(l,d){function f(E){try{v(i.next(E))}catch(S){d(S)}}function m(E){try{v(i.throw(E))}catch(S){d(S)}}function v(E){E.done?l(E.value):a(E.value).then(f,m)}v((i=i.apply(e,t||[])).next())})};class cBe{constructor(t,n,i){var a,l,d;if(this.supabaseUrl=t,this.supabaseKey=n,!t)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const f=fFe(t),m=new URL(f);this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const v=`sb-${m.hostname.split(".")[0]}-auth-token`,E={db:oFe,realtime:aFe,auth:Object.assign(Object.assign({},sFe),{storageKey:v}),global:iFe},S=pFe(i??{},E);this.storageKey=(a=S.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=S.global.headers)!==null&&l!==void 0?l:{},S.accessToken?(this.accessToken=S.accessToken,this.auth=new Proxy({},{get:(T,R)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(R)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((d=S.auth)!==null&&d!==void 0?d:{},this.headers,S.global.fetch),this.fetch=dFe(n,this._getAccessToken.bind(this),S.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},S.realtime)),this.rest=new RVe(new URL("rest/v1",m).href,{headers:this.headers,schema:S.db.schema,fetch:this.fetch}),S.accessToken||this._listenForAuthEvents()}get functions(){return new nVe(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new tFe(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},i={}){return this.rest.rpc(t,n,i)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,n;return aBe(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:i}=yield this.auth.getSession();return(n=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:i,storage:a,storageKey:l,flowType:d,lock:f,debug:m},v,E){const S={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new sBe({url:this.authUrl.href,headers:Object.assign(Object.assign({},S),v),storageKey:l,autoRefreshToken:t,persistSession:n,detectSessionInUrl:i,storage:a,flowType:d,lock:f,debug:m,fetch:E,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new BVe(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,i)=>{this._handleTokenChanged(n,"CLIENT",i==null?void 0:i.access_token)})}_handleTokenChanged(t,n,i){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==i?this.changedAccessToken=i:t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const lBe=(e,t,n)=>new cBe(e,t,n),uBe="https://iylyzckrakrpoddamwml.supabase.co",dBe="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml5bHl6Y2tyYWtycG9kZGFtd21sIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc1MTcxNjgsImV4cCI6MjA2MzA5MzE2OH0.jy8IwzHGQ8HpRNrIyAbBPH6oi8oyGcvY43ig0G016Nk",Wt=lBe(uBe,dBe),xae=N.createContext(void 0),hBe=({children:e})=>{const[t,n]=N.useState(null),[i,a]=N.useState(null),[l,d]=N.useState(!0),f=xS(),m=kl();N.useEffect(()=>{Wt.auth.getSession().then(({data:{session:R}})=>{a(R),n((R==null?void 0:R.user)??null),d(!1)});const{data:{subscription:T}}=Wt.auth.onAuthStateChange((R,I)=>{a(I),n((I==null?void 0:I.user)??null),R==="SIGNED_OUT"?f("/login"):R==="SIGNED_IN"&&(m.pathname==="/login"||m.pathname==="/register")&&f("/")});return()=>T.unsubscribe()},[f,m.pathname]);const v=async(T,R)=>{const{error:I}=await Wt.auth.signInWithPassword({email:T,password:R});return{error:I}},E=async(T,R,I)=>{const{error:O}=await Wt.auth.signUp({email:T,password:R,options:{data:{full_name:I}}});return O||f("/login"),{error:O}},S=async()=>{await Wt.auth.signOut()};return _.jsx(xae.Provider,{value:{user:t,session:i,loading:l,signIn:v,signUp:E,signOut:S},children:e})},jc=()=>{const e=N.useContext(xae);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},iu=({children:e})=>{const{user:t,loading:n}=jc();return n?_.jsx("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."}):t?_.jsx(_.Fragment,{children:e}):_.jsx(jUe,{to:"/login",replace:!0})},GV=N.createContext({});function WO(e){const t=N.useRef(null);return t.current===null&&(t.current=e()),t.current}const GO=N.createContext(null),HV=N.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class fBe extends N.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function pBe({children:e,isPresent:t}){const n=N.useId(),i=N.useRef(null),a=N.useRef({width:0,height:0,top:0,left:0}),{nonce:l}=N.useContext(HV);return N.useInsertionEffect(()=>{const{width:d,height:f,top:m,left:v}=a.current;if(t||!i.current||!d||!f)return;i.current.dataset.motionPopId=n;const E=document.createElement("style");return l&&(E.nonce=l),document.head.appendChild(E),E.sheet&&E.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${f}px !important;
            top: ${m}px !important;
            left: ${v}px !important;
          }
        `),()=>{document.head.removeChild(E)}},[t]),_.jsx(fBe,{isPresent:t,childRef:i,sizeRef:a,children:N.cloneElement(e,{ref:i})})}const mBe=({children:e,initial:t,isPresent:n,onExitComplete:i,custom:a,presenceAffectsLayout:l,mode:d})=>{const f=WO(gBe),m=N.useId(),v=N.useCallback(S=>{f.set(S,!0);for(const T of f.values())if(!T)return;i&&i()},[f,i]),E=N.useMemo(()=>({id:m,initial:t,isPresent:n,custom:a,onExitComplete:v,register:S=>(f.set(S,!1),()=>f.delete(S))}),l?[Math.random(),v]:[n,v]);return N.useMemo(()=>{f.forEach((S,T)=>f.set(T,!1))},[n]),N.useEffect(()=>{!n&&!f.size&&i&&i()},[n]),d==="popLayout"&&(e=_.jsx(pBe,{isPresent:n,children:e})),_.jsx(GO.Provider,{value:E,children:e})};function gBe(){return new Map}function Pae(e=!0){const t=N.useContext(GO);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:i,register:a}=t,l=N.useId();N.useEffect(()=>{e&&a(l)},[e]);const d=N.useCallback(()=>e&&i&&i(l),[l,i,e]);return!n&&i?[!1,d]:[!0]}const RC=e=>e.key||"";function yJ(e){const t=[];return N.Children.forEach(e,n=>{N.isValidElement(n)&&t.push(n)}),t}const KV=typeof window<"u",zV=KV?N.useLayoutEffect:N.useEffect,Nae=({children:e,custom:t,initial:n=!0,onExitComplete:i,presenceAffectsLayout:a=!0,mode:l="sync",propagate:d=!1})=>{const[f,m]=Pae(d),v=N.useMemo(()=>yJ(e),[e]),E=d&&!f?[]:v.map(RC),S=N.useRef(!0),T=N.useRef(v),R=WO(()=>new Map),[I,O]=N.useState(v),[P,D]=N.useState(v);zV(()=>{S.current=!1,T.current=v;for(let $=0;$<P.length;$++){const V=RC(P[$]);E.includes(V)?R.delete(V):R.get(V)!==!0&&R.set(V,!1)}},[P,E.length,E.join("-")]);const k=[];if(v!==I){let $=[...v];for(let V=0;V<P.length;V++){const W=P[V],H=RC(W);E.includes(H)||($.splice(V,0,W),k.push(W))}l==="wait"&&k.length&&($=k),D(yJ($)),O(v);return}const{forceRender:M}=N.useContext(GV);return _.jsx(_.Fragment,{children:P.map($=>{const V=RC($),W=d&&!f?!1:v===P||E.includes(V),H=()=>{if(R.has(V))R.set(V,!0);else return;let J=!0;R.forEach(ee=>{ee||(J=!1)}),J&&(M==null||M(),D(T.current),d&&(m==null||m()),i&&i())};return _.jsx(mBe,{isPresent:W,initial:!S.current||n?void 0:!1,custom:W?void 0:t,presenceAffectsLayout:a,mode:l,onExitComplete:W?void 0:H,children:$},V)})})},Ys=e=>e;let Dae=Ys;function YV(e){let t;return()=>(t===void 0&&(t=e()),t)}const gv=(e,t,n)=>{const i=t-e;return i===0?1:(n-e)/i},Su=e=>e*1e3,wu=e=>e/1e3,vBe={useManualTiming:!1};function yBe(e){let t=new Set,n=new Set,i=!1,a=!1;const l=new WeakSet;let d={delta:0,timestamp:0,isProcessing:!1};function f(v){l.has(v)&&(m.schedule(v),e()),v(d)}const m={schedule:(v,E=!1,S=!1)=>{const R=S&&i?t:n;return E&&l.add(v),R.has(v)||R.add(v),v},cancel:v=>{n.delete(v),l.delete(v)},process:v=>{if(d=v,i){a=!0;return}i=!0,[t,n]=[n,t],t.forEach(f),t.clear(),i=!1,a&&(a=!1,m.process(v))}};return m}const AC=["read","resolveKeyframes","update","preRender","render","postRender"],_Be=40;function kae(e,t){let n=!1,i=!0;const a={delta:0,timestamp:0,isProcessing:!1},l=()=>n=!0,d=AC.reduce((D,k)=>(D[k]=yBe(l),D),{}),{read:f,resolveKeyframes:m,update:v,preRender:E,render:S,postRender:T}=d,R=()=>{const D=performance.now();n=!1,a.delta=i?1e3/60:Math.max(Math.min(D-a.timestamp,_Be),1),a.timestamp=D,a.isProcessing=!0,f.process(a),m.process(a),v.process(a),E.process(a),S.process(a),T.process(a),a.isProcessing=!1,n&&t&&(i=!1,e(R))},I=()=>{n=!0,i=!0,a.isProcessing||e(R)};return{schedule:AC.reduce((D,k)=>{const M=d[k];return D[k]=($,V=!1,W=!1)=>(n||I(),M.schedule($,V,W)),D},{}),cancel:D=>{for(let k=0;k<AC.length;k++)d[AC[k]].cancel(D)},state:a,steps:d}}const{schedule:Lr,cancel:wh,state:so,steps:Jk}=kae(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ys,!0),Lae=N.createContext({strict:!1}),_J={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},vv={};for(const e in _J)vv[e]={isEnabled:t=>_J[e].some(n=>!!t[n])};function EBe(e){for(const t in e)vv[t]={...vv[t],...e[t]}}const bBe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function zR(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||bBe.has(e)}let Mae=e=>!zR(e);function SBe(e){e&&(Mae=t=>t.startsWith("on")?!zR(t):e(t))}try{SBe(require("@emotion/is-prop-valid").default)}catch{}function wBe(e,t,n){const i={};for(const a in e)a==="values"&&typeof e.values=="object"||(Mae(a)||n===!0&&zR(a)||!t&&!zR(a)||e.draggable&&a.startsWith("onDrag"))&&(i[a]=e[a]);return i}function TBe(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...i)=>e(...i);return new Proxy(n,{get:(i,a)=>a==="create"?e:(t.has(a)||t.set(a,e(a)),t.get(a))})}const HO=N.createContext({});function xb(e){return typeof e=="string"||Array.isArray(e)}function KO(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const qV=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],XV=["initial",...qV];function zO(e){return KO(e.animate)||XV.some(t=>xb(e[t]))}function jae(e){return!!(zO(e)||e.variants)}function CBe(e,t){if(zO(e)){const{initial:n,animate:i}=e;return{initial:n===!1||xb(n)?n:void 0,animate:xb(i)?i:void 0}}return e.inherit!==!1?t:{}}function RBe(e){const{initial:t,animate:n}=CBe(e,N.useContext(HO));return N.useMemo(()=>({initial:t,animate:n}),[EJ(t),EJ(n)])}function EJ(e){return Array.isArray(e)?e.join(" "):e}const ABe=Symbol.for("motionComponentSymbol");function Ag(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function OBe(e,t,n){return N.useCallback(i=>{i&&e.onMount&&e.onMount(i),t&&(i?t.mount(i):t.unmount()),n&&(typeof n=="function"?n(i):Ag(n)&&(n.current=i))},[t])}const JV=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),IBe="framerAppearId",Uae="data-"+JV(IBe),{schedule:QV}=kae(queueMicrotask,!1),Vae=N.createContext({});function xBe(e,t,n,i,a){var l,d;const{visualElement:f}=N.useContext(HO),m=N.useContext(Lae),v=N.useContext(GO),E=N.useContext(HV).reducedMotion,S=N.useRef(null);i=i||m.renderer,!S.current&&i&&(S.current=i(e,{visualState:t,parent:f,props:n,presenceContext:v,blockInitialAnimation:v?v.initial===!1:!1,reducedMotionConfig:E}));const T=S.current,R=N.useContext(Vae);T&&!T.projection&&a&&(T.type==="html"||T.type==="svg")&&PBe(S.current,n,a,R);const I=N.useRef(!1);N.useInsertionEffect(()=>{T&&I.current&&T.update(n,v)});const O=n[Uae],P=N.useRef(!!O&&!(!((l=window.MotionHandoffIsComplete)===null||l===void 0)&&l.call(window,O))&&((d=window.MotionHasOptimisedAnimation)===null||d===void 0?void 0:d.call(window,O)));return zV(()=>{T&&(I.current=!0,window.MotionIsMounted=!0,T.updateFeatures(),QV.render(T.render),P.current&&T.animationState&&T.animationState.animateChanges())}),N.useEffect(()=>{T&&(!P.current&&T.animationState&&T.animationState.animateChanges(),P.current&&(queueMicrotask(()=>{var D;(D=window.MotionHandoffMarkAsComplete)===null||D===void 0||D.call(window,O)}),P.current=!1))}),T}function PBe(e,t,n,i){const{layoutId:a,layout:l,drag:d,dragConstraints:f,layoutScroll:m,layoutRoot:v}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:Fae(e.parent)),e.projection.setOptions({layoutId:a,layout:l,alwaysMeasureLayout:!!d||f&&Ag(f),visualElement:e,animationType:typeof l=="string"?l:"both",initialPromotionConfig:i,layoutScroll:m,layoutRoot:v})}function Fae(e){if(e)return e.options.allowProjection!==!1?e.projection:Fae(e.parent)}function NBe({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:i,Component:a}){var l,d;e&&EBe(e);function f(v,E){let S;const T={...N.useContext(HV),...v,layoutId:DBe(v)},{isStatic:R}=T,I=RBe(v),O=i(v,R);if(!R&&KV){kBe();const P=LBe(T);S=P.MeasureLayout,I.visualElement=xBe(a,O,T,t,P.ProjectionNode)}return _.jsxs(HO.Provider,{value:I,children:[S&&I.visualElement?_.jsx(S,{visualElement:I.visualElement,...T}):null,n(a,v,OBe(O,I.visualElement,E),O,R,I.visualElement)]})}f.displayName=`motion.${typeof a=="string"?a:`create(${(d=(l=a.displayName)!==null&&l!==void 0?l:a.name)!==null&&d!==void 0?d:""})`}`;const m=N.forwardRef(f);return m[ABe]=a,m}function DBe({layoutId:e}){const t=N.useContext(GV).id;return t&&e!==void 0?t+"-"+e:e}function kBe(e,t){N.useContext(Lae).strict}function LBe(e){const{drag:t,layout:n}=vv;if(!t&&!n)return{};const i={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const MBe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ZV(e){return typeof e!="string"||e.includes("-")?!1:!!(MBe.indexOf(e)>-1||/[A-Z]/u.test(e))}function bJ(e){const t=[{},{}];return e==null||e.values.forEach((n,i)=>{t[0][i]=n.get(),t[1][i]=n.getVelocity()}),t}function eF(e,t,n,i){if(typeof t=="function"){const[a,l]=bJ(i);t=t(n!==void 0?n:e.custom,a,l)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[a,l]=bJ(i);t=t(n!==void 0?n:e.custom,a,l)}return t}const m2=e=>Array.isArray(e),jBe=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),UBe=e=>m2(e)?e[e.length-1]||0:e,Co=e=>!!(e&&e.getVelocity);function lR(e){const t=Co(e)?e.get():e;return jBe(t)?t.toValue():t}function VBe({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:n},i,a,l){const d={latestValues:FBe(i,a,l,e),renderState:t()};return n&&(d.onMount=f=>n({props:i,current:f,...d}),d.onUpdate=f=>n(f)),d}const Bae=e=>(t,n)=>{const i=N.useContext(HO),a=N.useContext(GO),l=()=>VBe(e,t,i,a);return n?l():WO(l)};function FBe(e,t,n,i){const a={},l=i(e,{});for(const T in l)a[T]=lR(l[T]);let{initial:d,animate:f}=e;const m=zO(e),v=jae(e);t&&v&&!m&&e.inherit!==!1&&(d===void 0&&(d=t.initial),f===void 0&&(f=t.animate));let E=n?n.initial===!1:!1;E=E||d===!1;const S=E?f:d;if(S&&typeof S!="boolean"&&!KO(S)){const T=Array.isArray(S)?S:[S];for(let R=0;R<T.length;R++){const I=eF(e,T[R]);if(I){const{transitionEnd:O,transition:P,...D}=I;for(const k in D){let M=D[k];if(Array.isArray(M)){const $=E?M.length-1:0;M=M[$]}M!==null&&(a[k]=M)}for(const k in O)a[k]=O[k]}}}return a}const iy=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Pp=new Set(iy),$ae=e=>t=>typeof t=="string"&&t.startsWith(e),Wae=$ae("--"),BBe=$ae("var(--"),tF=e=>BBe(e)?$Be.test(e.split("/*")[0].trim()):!1,$Be=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Gae=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Vu=(e,t,n)=>n>t?t:n<e?e:n,oy={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Pb={...oy,transform:e=>Vu(0,1,e)},OC={...oy,default:1},DS=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Ud=DS("deg"),Rl=DS("%"),Lt=DS("px"),WBe=DS("vh"),GBe=DS("vw"),SJ={...Rl,parse:e=>Rl.parse(e)/100,transform:e=>Rl.transform(e*100)},HBe={borderWidth:Lt,borderTopWidth:Lt,borderRightWidth:Lt,borderBottomWidth:Lt,borderLeftWidth:Lt,borderRadius:Lt,radius:Lt,borderTopLeftRadius:Lt,borderTopRightRadius:Lt,borderBottomRightRadius:Lt,borderBottomLeftRadius:Lt,width:Lt,maxWidth:Lt,height:Lt,maxHeight:Lt,top:Lt,right:Lt,bottom:Lt,left:Lt,padding:Lt,paddingTop:Lt,paddingRight:Lt,paddingBottom:Lt,paddingLeft:Lt,margin:Lt,marginTop:Lt,marginRight:Lt,marginBottom:Lt,marginLeft:Lt,backgroundPositionX:Lt,backgroundPositionY:Lt},KBe={rotate:Ud,rotateX:Ud,rotateY:Ud,rotateZ:Ud,scale:OC,scaleX:OC,scaleY:OC,scaleZ:OC,skew:Ud,skewX:Ud,skewY:Ud,distance:Lt,translateX:Lt,translateY:Lt,translateZ:Lt,x:Lt,y:Lt,z:Lt,perspective:Lt,transformPerspective:Lt,opacity:Pb,originX:SJ,originY:SJ,originZ:Lt},wJ={...oy,transform:Math.round},nF={...HBe,...KBe,zIndex:wJ,size:Lt,fillOpacity:Pb,strokeOpacity:Pb,numOctaves:wJ},zBe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},YBe=iy.length;function qBe(e,t,n){let i="",a=!0;for(let l=0;l<YBe;l++){const d=iy[l],f=e[d];if(f===void 0)continue;let m=!0;if(typeof f=="number"?m=f===(d.startsWith("scale")?1:0):m=parseFloat(f)===0,!m||n){const v=Gae(f,nF[d]);if(!m){a=!1;const E=zBe[d]||d;i+=`${E}(${v}) `}n&&(t[d]=v)}}return i=i.trim(),n?i=n(t,a?"":i):a&&(i="none"),i}function rF(e,t,n){const{style:i,vars:a,transformOrigin:l}=e;let d=!1,f=!1;for(const m in t){const v=t[m];if(Pp.has(m)){d=!0;continue}else if(Wae(m)){a[m]=v;continue}else{const E=Gae(v,nF[m]);m.startsWith("origin")?(f=!0,l[m]=E):i[m]=E}}if(t.transform||(d||n?i.transform=qBe(t,e.transform,n):i.transform&&(i.transform="none")),f){const{originX:m="50%",originY:v="50%",originZ:E=0}=l;i.transformOrigin=`${m} ${v} ${E}`}}const XBe={offset:"stroke-dashoffset",array:"stroke-dasharray"},JBe={offset:"strokeDashoffset",array:"strokeDasharray"};function QBe(e,t,n=1,i=0,a=!0){e.pathLength=1;const l=a?XBe:JBe;e[l.offset]=Lt.transform(-i);const d=Lt.transform(t),f=Lt.transform(n);e[l.array]=`${d} ${f}`}function TJ(e,t,n){return typeof e=="string"?e:Lt.transform(t+n*e)}function ZBe(e,t,n){const i=TJ(t,e.x,e.width),a=TJ(n,e.y,e.height);return`${i} ${a}`}function iF(e,{attrX:t,attrY:n,attrScale:i,originX:a,originY:l,pathLength:d,pathSpacing:f=1,pathOffset:m=0,...v},E,S){if(rF(e,v,S),E){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:T,style:R,dimensions:I}=e;T.transform&&(I&&(R.transform=T.transform),delete T.transform),I&&(a!==void 0||l!==void 0||R.transform)&&(R.transformOrigin=ZBe(I,a!==void 0?a:.5,l!==void 0?l:.5)),t!==void 0&&(T.x=t),n!==void 0&&(T.y=n),i!==void 0&&(T.scale=i),d!==void 0&&QBe(T,d,f,m,!1)}const oF=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Hae=()=>({...oF(),attrs:{}}),sF=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Kae(e,{style:t,vars:n},i,a){Object.assign(e.style,t,a&&a.getProjectionStyles(i));for(const l in n)e.style.setProperty(l,n[l])}const zae=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Yae(e,t,n,i){Kae(e,t,void 0,i);for(const a in t.attrs)e.setAttribute(zae.has(a)?a:JV(a),t.attrs[a])}const YR={};function e3e(e){Object.assign(YR,e)}function qae(e,{layout:t,layoutId:n}){return Pp.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!YR[e]||e==="opacity")}function aF(e,t,n){var i;const{style:a}=e,l={};for(const d in a)(Co(a[d])||t.style&&Co(t.style[d])||qae(d,e)||((i=n==null?void 0:n.getValue(d))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(l[d]=a[d]);return l}function Xae(e,t,n){const i=aF(e,t,n);for(const a in e)if(Co(e[a])||Co(t[a])){const l=iy.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;i[l]=e[a]}return i}function t3e(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}const CJ=["x","y","width","height","cx","cy","r"],n3e={useVisualState:Bae({scrapeMotionValuesFromProps:Xae,createRenderState:Hae,onUpdate:({props:e,prevProps:t,current:n,renderState:i,latestValues:a})=>{if(!n)return;let l=!!e.drag;if(!l){for(const f in a)if(Pp.has(f)){l=!0;break}}if(!l)return;let d=!t;if(t)for(let f=0;f<CJ.length;f++){const m=CJ[f];e[m]!==t[m]&&(d=!0)}d&&Lr.read(()=>{t3e(n,i),Lr.render(()=>{iF(i,a,sF(n.tagName),e.transformTemplate),Yae(n,i)})})}})},r3e={useVisualState:Bae({scrapeMotionValuesFromProps:aF,createRenderState:oF})};function Jae(e,t,n){for(const i in t)!Co(t[i])&&!qae(i,n)&&(e[i]=t[i])}function i3e({transformTemplate:e},t){return N.useMemo(()=>{const n=oF();return rF(n,t,e),Object.assign({},n.vars,n.style)},[t])}function o3e(e,t){const n=e.style||{},i={};return Jae(i,n,e),Object.assign(i,i3e(e,t)),i}function s3e(e,t){const n={},i=o3e(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=i,n}function a3e(e,t,n,i){const a=N.useMemo(()=>{const l=Hae();return iF(l,t,sF(i),e.transformTemplate),{...l.attrs,style:{...l.style}}},[t]);if(e.style){const l={};Jae(l,e.style,e),a.style={...l,...a.style}}return a}function c3e(e=!1){return(n,i,a,{latestValues:l},d)=>{const m=(ZV(n)?a3e:s3e)(i,l,d,n),v=wBe(i,typeof n=="string",e),E=n!==N.Fragment?{...v,...m,ref:a}:{},{children:S}=i,T=N.useMemo(()=>Co(S)?S.get():S,[S]);return N.createElement(n,{...E,children:T})}}function l3e(e,t){return function(i,{forwardMotionProps:a}={forwardMotionProps:!1}){const d={...ZV(i)?n3e:r3e,preloadedFeatures:e,useRender:c3e(a),createVisualElement:t,Component:i};return NBe(d)}}function Qae(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function YO(e,t,n){const i=e.getProps();return eF(i,t,n!==void 0?n:i.custom,e)}const u3e=YV(()=>window.ScrollTimeline!==void 0);class d3e{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>"finished"in t?t.finished:t))}getAll(t){return this.animations[0][t]}setAll(t,n){for(let i=0;i<this.animations.length;i++)this.animations[i][t]=n}attachTimeline(t,n){const i=this.animations.map(a=>{if(u3e()&&a.attachTimeline)return a.attachTimeline(t);if(typeof n=="function")return n(a)});return()=>{i.forEach((a,l)=>{a&&a(),this.animations[l].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let n=0;n<this.animations.length;n++)t=Math.max(t,this.animations[n].duration);return t}runAll(t){this.animations.forEach(n=>n[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class h3e extends d3e{then(t,n){return Promise.all(this.animations).then(t).catch(n)}}function cF(e,t){return e?e[t]||e.default||e:void 0}const g2=2e4;function Zae(e){let t=0;const n=50;let i=e.next(t);for(;!i.done&&t<g2;)t+=n,i=e.next(t);return t>=g2?1/0:t}function lF(e){return typeof e=="function"}function RJ(e,t){e.timeline=t,e.onfinish=null}const uF=e=>Array.isArray(e)&&typeof e[0]=="number",f3e={linearEasing:void 0};function p3e(e,t){const n=YV(e);return()=>{var i;return(i=f3e[t])!==null&&i!==void 0?i:n()}}const qR=p3e(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ece=(e,t,n=10)=>{let i="";const a=Math.max(Math.round(t/n),2);for(let l=0;l<a;l++)i+=e(gv(0,a-1,l))+", ";return`linear(${i.substring(0,i.length-2)})`};function tce(e){return!!(typeof e=="function"&&qR()||!e||typeof e=="string"&&(e in v2||qR())||uF(e)||Array.isArray(e)&&e.every(tce))}const RE=([e,t,n,i])=>`cubic-bezier(${e}, ${t}, ${n}, ${i})`,v2={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:RE([0,.65,.55,1]),circOut:RE([.55,0,1,.45]),backIn:RE([.31,.01,.66,-.59]),backOut:RE([.33,1.53,.69,.99])};function nce(e,t){if(e)return typeof e=="function"&&qR()?ece(e,t):uF(e)?RE(e):Array.isArray(e)?e.map(n=>nce(n,t)||v2.easeOut):v2[e]}const vc={x:!1,y:!1};function rce(){return vc.x||vc.y}function ice(e,t,n){var i;if(e instanceof Element)return[e];if(typeof e=="string"){let a=document;const l=(i=void 0)!==null&&i!==void 0?i:a.querySelectorAll(e);return l?Array.from(l):[]}return Array.from(e)}function oce(e,t){const n=ice(e),i=new AbortController,a={passive:!0,...t,signal:i.signal};return[n,a,()=>i.abort()]}function AJ(e){return t=>{t.pointerType==="touch"||rce()||e(t)}}function m3e(e,t,n={}){const[i,a,l]=oce(e,n),d=AJ(f=>{const{target:m}=f,v=t(f);if(typeof v!="function"||!m)return;const E=AJ(S=>{v(S),m.removeEventListener("pointerleave",E)});m.addEventListener("pointerleave",E,a)});return i.forEach(f=>{f.addEventListener("pointerenter",d,a)}),l}const sce=(e,t)=>t?e===t?!0:sce(e,t.parentElement):!1,dF=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,g3e=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function v3e(e){return g3e.has(e.tagName)||e.tabIndex!==-1}const AE=new WeakSet;function OJ(e){return t=>{t.key==="Enter"&&e(t)}}function Qk(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const y3e=(e,t)=>{const n=e.currentTarget;if(!n)return;const i=OJ(()=>{if(AE.has(n))return;Qk(n,"down");const a=OJ(()=>{Qk(n,"up")}),l=()=>Qk(n,"cancel");n.addEventListener("keyup",a,t),n.addEventListener("blur",l,t)});n.addEventListener("keydown",i,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",i),t)};function IJ(e){return dF(e)&&!rce()}function _3e(e,t,n={}){const[i,a,l]=oce(e,n),d=f=>{const m=f.currentTarget;if(!IJ(f)||AE.has(m))return;AE.add(m);const v=t(f),E=(R,I)=>{window.removeEventListener("pointerup",S),window.removeEventListener("pointercancel",T),!(!IJ(R)||!AE.has(m))&&(AE.delete(m),typeof v=="function"&&v(R,{success:I}))},S=R=>{E(R,n.useGlobalTarget||sce(m,R.target))},T=R=>{E(R,!1)};window.addEventListener("pointerup",S,a),window.addEventListener("pointercancel",T,a)};return i.forEach(f=>{!v3e(f)&&f.getAttribute("tabindex")===null&&(f.tabIndex=0),(n.useGlobalTarget?window:f).addEventListener("pointerdown",d,a),f.addEventListener("focus",v=>y3e(v,a),a)}),l}function E3e(e){return e==="x"||e==="y"?vc[e]?null:(vc[e]=!0,()=>{vc[e]=!1}):vc.x||vc.y?null:(vc.x=vc.y=!0,()=>{vc.x=vc.y=!1})}const ace=new Set(["width","height","top","left","right","bottom",...iy]);let uR;function b3e(){uR=void 0}const Al={now:()=>(uR===void 0&&Al.set(so.isProcessing||vBe.useManualTiming?so.timestamp:performance.now()),uR),set:e=>{uR=e,queueMicrotask(b3e)}};function hF(e,t){e.indexOf(t)===-1&&e.push(t)}function fF(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class pF{constructor(){this.subscriptions=[]}add(t){return hF(this.subscriptions,t),()=>fF(this.subscriptions,t)}notify(t,n,i){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,n,i);else for(let l=0;l<a;l++){const d=this.subscriptions[l];d&&d(t,n,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function cce(e,t){return t?e*(1e3/t):0}const xJ=30,S3e=e=>!isNaN(parseFloat(e));class w3e{constructor(t,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,a=!0)=>{const l=Al.now();this.updatedAt!==l&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),a&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=Al.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=S3e(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new pF);const i=this.events[t].add(n);return t==="change"?()=>{i(),Lr.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,i){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-i}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Al.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>xJ)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,xJ);return cce(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Nb(e,t){return new w3e(e,t)}function T3e(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Nb(n))}function mF(e,t){const n=YO(e,t);let{transitionEnd:i={},transition:a={},...l}=n||{};l={...l,...i};for(const d in l){const f=UBe(l[d]);T3e(e,d,f)}}function C3e(e){return!!(Co(e)&&e.add)}function y2(e,t){const n=e.getValue("willChange");if(C3e(n))return n.add(t)}function lce(e){return e.props[Uae]}const uce=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,R3e=1e-7,A3e=12;function O3e(e,t,n,i,a){let l,d,f=0;do d=t+(n-t)/2,l=uce(d,i,a)-e,l>0?n=d:t=d;while(Math.abs(l)>R3e&&++f<A3e);return d}function kS(e,t,n,i){if(e===t&&n===i)return Ys;const a=l=>O3e(l,0,1,e,n);return l=>l===0||l===1?l:uce(a(l),t,i)}const dce=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,hce=e=>t=>1-e(1-t),fce=kS(.33,1.53,.69,.99),gF=hce(fce),pce=dce(gF),mce=e=>(e*=2)<1?.5*gF(e):.5*(2-Math.pow(2,-10*(e-1))),vF=e=>1-Math.sin(Math.acos(e)),gce=hce(vF),vce=dce(vF),yce=e=>/^0[^.\s]+$/u.test(e);function I3e(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||yce(e):!0}const zE=e=>Math.round(e*1e5)/1e5,yF=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function x3e(e){return e==null}const P3e=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,_F=(e,t)=>n=>!!(typeof n=="string"&&P3e.test(n)&&n.startsWith(e)||t&&!x3e(n)&&Object.prototype.hasOwnProperty.call(n,t)),_ce=(e,t,n)=>i=>{if(typeof i!="string")return i;const[a,l,d,f]=i.match(yF);return{[e]:parseFloat(a),[t]:parseFloat(l),[n]:parseFloat(d),alpha:f!==void 0?parseFloat(f):1}},N3e=e=>Vu(0,255,e),Zk={...oy,transform:e=>Math.round(N3e(e))},qf={test:_F("rgb","red"),parse:_ce("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:i=1})=>"rgba("+Zk.transform(e)+", "+Zk.transform(t)+", "+Zk.transform(n)+", "+zE(Pb.transform(i))+")"};function D3e(e){let t="",n="",i="",a="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),i=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),i=e.substring(3,4),a=e.substring(4,5),t+=t,n+=n,i+=i,a+=a),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:a?parseInt(a,16)/255:1}}const _2={test:_F("#"),parse:D3e,transform:qf.transform},Og={test:_F("hsl","hue"),parse:_ce("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:i=1})=>"hsla("+Math.round(e)+", "+Rl.transform(zE(t))+", "+Rl.transform(zE(n))+", "+zE(Pb.transform(i))+")"},bo={test:e=>qf.test(e)||_2.test(e)||Og.test(e),parse:e=>qf.test(e)?qf.parse(e):Og.test(e)?Og.parse(e):_2.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?qf.transform(e):Og.transform(e)},k3e=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function L3e(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(yF))===null||t===void 0?void 0:t.length)||0)+(((n=e.match(k3e))===null||n===void 0?void 0:n.length)||0)>0}const Ece="number",bce="color",M3e="var",j3e="var(",PJ="${}",U3e=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Db(e){const t=e.toString(),n=[],i={color:[],number:[],var:[]},a=[];let l=0;const f=t.replace(U3e,m=>(bo.test(m)?(i.color.push(l),a.push(bce),n.push(bo.parse(m))):m.startsWith(j3e)?(i.var.push(l),a.push(M3e),n.push(m)):(i.number.push(l),a.push(Ece),n.push(parseFloat(m))),++l,PJ)).split(PJ);return{values:n,split:f,indexes:i,types:a}}function Sce(e){return Db(e).values}function wce(e){const{split:t,types:n}=Db(e),i=t.length;return a=>{let l="";for(let d=0;d<i;d++)if(l+=t[d],a[d]!==void 0){const f=n[d];f===Ece?l+=zE(a[d]):f===bce?l+=bo.transform(a[d]):l+=a[d]}return l}}const V3e=e=>typeof e=="number"?0:e;function F3e(e){const t=Sce(e);return wce(e)(t.map(V3e))}const Th={test:L3e,parse:Sce,createTransformer:wce,getAnimatableNone:F3e},B3e=new Set(["brightness","contrast","saturate","opacity"]);function $3e(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[i]=n.match(yF)||[];if(!i)return e;const a=n.replace(i,"");let l=B3e.has(t)?1:0;return i!==n&&(l*=100),t+"("+l+a+")"}const W3e=/\b([a-z-]*)\(.*?\)/gu,E2={...Th,getAnimatableNone:e=>{const t=e.match(W3e);return t?t.map($3e).join(" "):e}},G3e={...nF,color:bo,backgroundColor:bo,outlineColor:bo,fill:bo,stroke:bo,borderColor:bo,borderTopColor:bo,borderRightColor:bo,borderBottomColor:bo,borderLeftColor:bo,filter:E2,WebkitFilter:E2},EF=e=>G3e[e];function Tce(e,t){let n=EF(e);return n!==E2&&(n=Th),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const H3e=new Set(["auto","none","0"]);function K3e(e,t,n){let i=0,a;for(;i<e.length&&!a;){const l=e[i];typeof l=="string"&&!H3e.has(l)&&Db(l).values.length&&(a=e[i]),i++}if(a&&n)for(const l of t)e[l]=Tce(n,a)}const NJ=e=>e===oy||e===Lt,DJ=(e,t)=>parseFloat(e.split(", ")[t]),kJ=(e,t)=>(n,{transform:i})=>{if(i==="none"||!i)return 0;const a=i.match(/^matrix3d\((.+)\)$/u);if(a)return DJ(a[1],t);{const l=i.match(/^matrix\((.+)\)$/u);return l?DJ(l[1],e):0}},z3e=new Set(["x","y","z"]),Y3e=iy.filter(e=>!z3e.has(e));function q3e(e){const t=[];return Y3e.forEach(n=>{const i=e.getValue(n);i!==void 0&&(t.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),t}const yv={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:kJ(4,13),y:kJ(5,14)};yv.translateX=yv.x;yv.translateY=yv.y;const ap=new Set;let b2=!1,S2=!1;function Cce(){if(S2){const e=Array.from(ap).filter(i=>i.needsMeasurement),t=new Set(e.map(i=>i.element)),n=new Map;t.forEach(i=>{const a=q3e(i);a.length&&(n.set(i,a),i.render())}),e.forEach(i=>i.measureInitialState()),t.forEach(i=>{i.render();const a=n.get(i);a&&a.forEach(([l,d])=>{var f;(f=i.getValue(l))===null||f===void 0||f.set(d)})}),e.forEach(i=>i.measureEndState()),e.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}S2=!1,b2=!1,ap.forEach(e=>e.complete()),ap.clear()}function Rce(){ap.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(S2=!0)})}function X3e(){Rce(),Cce()}class bF{constructor(t,n,i,a,l,d=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=i,this.motionValue=a,this.element=l,this.isAsync=d}scheduleResolve(){this.isScheduled=!0,this.isAsync?(ap.add(this),b2||(b2=!0,Lr.read(Rce),Lr.resolveKeyframes(Cce))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:i,motionValue:a}=this;for(let l=0;l<t.length;l++)if(t[l]===null)if(l===0){const d=a==null?void 0:a.get(),f=t[t.length-1];if(d!==void 0)t[0]=d;else if(i&&n){const m=i.readValue(n,f);m!=null&&(t[0]=m)}t[0]===void 0&&(t[0]=f),a&&d===void 0&&a.set(t[0])}else t[l]=t[l-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),ap.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,ap.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Ace=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),J3e=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Q3e(e){const t=J3e.exec(e);if(!t)return[,];const[,n,i,a]=t;return[`--${n??i}`,a]}function Oce(e,t,n=1){const[i,a]=Q3e(e);if(!i)return;const l=window.getComputedStyle(t).getPropertyValue(i);if(l){const d=l.trim();return Ace(d)?parseFloat(d):d}return tF(a)?Oce(a,t,n+1):a}const Ice=e=>t=>t.test(e),Z3e={test:e=>e==="auto",parse:e=>e},xce=[oy,Lt,Rl,Ud,GBe,WBe,Z3e],LJ=e=>xce.find(Ice(e));class Pce extends bF{constructor(t,n,i,a,l){super(t,n,i,a,l,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:i}=this;if(!n||!n.current)return;super.readKeyframes();for(let m=0;m<t.length;m++){let v=t[m];if(typeof v=="string"&&(v=v.trim(),tF(v))){const E=Oce(v,n.current);E!==void 0&&(t[m]=E),m===t.length-1&&(this.finalKeyframe=v)}}if(this.resolveNoneKeyframes(),!ace.has(i)||t.length!==2)return;const[a,l]=t,d=LJ(a),f=LJ(l);if(d!==f)if(NJ(d)&&NJ(f))for(let m=0;m<t.length;m++){const v=t[m];typeof v=="string"&&(t[m]=parseFloat(v))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,i=[];for(let a=0;a<t.length;a++)I3e(t[a])&&i.push(a);i.length&&K3e(t,i,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:i}=this;if(!t||!t.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=yv[i](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const a=n[n.length-1];a!==void 0&&t.getValue(i,a).jump(a,!1)}measureEndState(){var t;const{element:n,name:i,unresolvedKeyframes:a}=this;if(!n||!n.current)return;const l=n.getValue(i);l&&l.jump(this.measuredOrigin,!1);const d=a.length-1,f=a[d];a[d]=yv[i](n.measureViewportBox(),window.getComputedStyle(n.current)),f!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=f),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([m,v])=>{n.getValue(m).set(v)}),this.resolveNoneKeyframes()}}const MJ=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Th.test(e)||e==="0")&&!e.startsWith("url("));function e4e(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function t4e(e,t,n,i){const a=e[0];if(a===null)return!1;if(t==="display"||t==="visibility")return!0;const l=e[e.length-1],d=MJ(a,t),f=MJ(l,t);return!d||!f?!1:e4e(e)||(n==="spring"||lF(n))&&i}const n4e=e=>e!==null;function qO(e,{repeat:t,repeatType:n="loop"},i){const a=e.filter(n4e),l=t&&n!=="loop"&&t%2===1?0:a.length-1;return!l||i===void 0?a[l]:i}const r4e=40;class Nce{constructor({autoplay:t=!0,delay:n=0,type:i="keyframes",repeat:a=0,repeatDelay:l=0,repeatType:d="loop",...f}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Al.now(),this.options={autoplay:t,delay:n,type:i,repeat:a,repeatDelay:l,repeatType:d,...f},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>r4e?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&X3e(),this._resolved}onKeyframesResolved(t,n){this.resolvedAt=Al.now(),this.hasAttemptedResolve=!0;const{name:i,type:a,velocity:l,delay:d,onComplete:f,onUpdate:m,isGenerator:v}=this.options;if(!v&&!t4e(t,i,a,l))if(d)this.options.duration=0;else{m&&m(qO(t,this.options,n)),f&&f(),this.resolveFinishedPromise();return}const E=this.initPlayback(t,n);E!==!1&&(this._resolved={keyframes:t,finalKeyframe:n,...E},this.onPostResolved())}onPostResolved(){}then(t,n){return this.currentFinishedPromise.then(t,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const Qr=(e,t,n)=>e+(t-e)*n;function eL(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function i4e({hue:e,saturation:t,lightness:n,alpha:i}){e/=360,t/=100,n/=100;let a=0,l=0,d=0;if(!t)a=l=d=n;else{const f=n<.5?n*(1+t):n+t-n*t,m=2*n-f;a=eL(m,f,e+1/3),l=eL(m,f,e),d=eL(m,f,e-1/3)}return{red:Math.round(a*255),green:Math.round(l*255),blue:Math.round(d*255),alpha:i}}function XR(e,t){return n=>n>0?t:e}const tL=(e,t,n)=>{const i=e*e,a=n*(t*t-i)+i;return a<0?0:Math.sqrt(a)},o4e=[_2,qf,Og],s4e=e=>o4e.find(t=>t.test(e));function jJ(e){const t=s4e(e);if(!t)return!1;let n=t.parse(e);return t===Og&&(n=i4e(n)),n}const UJ=(e,t)=>{const n=jJ(e),i=jJ(t);if(!n||!i)return XR(e,t);const a={...n};return l=>(a.red=tL(n.red,i.red,l),a.green=tL(n.green,i.green,l),a.blue=tL(n.blue,i.blue,l),a.alpha=Qr(n.alpha,i.alpha,l),qf.transform(a))},a4e=(e,t)=>n=>t(e(n)),LS=(...e)=>e.reduce(a4e),w2=new Set(["none","hidden"]);function c4e(e,t){return w2.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function l4e(e,t){return n=>Qr(e,t,n)}function SF(e){return typeof e=="number"?l4e:typeof e=="string"?tF(e)?XR:bo.test(e)?UJ:h4e:Array.isArray(e)?Dce:typeof e=="object"?bo.test(e)?UJ:u4e:XR}function Dce(e,t){const n=[...e],i=n.length,a=e.map((l,d)=>SF(l)(l,t[d]));return l=>{for(let d=0;d<i;d++)n[d]=a[d](l);return n}}function u4e(e,t){const n={...e,...t},i={};for(const a in n)e[a]!==void 0&&t[a]!==void 0&&(i[a]=SF(e[a])(e[a],t[a]));return a=>{for(const l in i)n[l]=i[l](a);return n}}function d4e(e,t){var n;const i=[],a={color:0,var:0,number:0};for(let l=0;l<t.values.length;l++){const d=t.types[l],f=e.indexes[d][a[d]],m=(n=e.values[f])!==null&&n!==void 0?n:0;i[l]=m,a[d]++}return i}const h4e=(e,t)=>{const n=Th.createTransformer(t),i=Db(e),a=Db(t);return i.indexes.var.length===a.indexes.var.length&&i.indexes.color.length===a.indexes.color.length&&i.indexes.number.length>=a.indexes.number.length?w2.has(e)&&!a.values.length||w2.has(t)&&!i.values.length?c4e(e,t):LS(Dce(d4e(i,a),a.values),n):XR(e,t)};function kce(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?Qr(e,t,n):SF(e)(e,t)}const f4e=5;function Lce(e,t,n){const i=Math.max(t-f4e,0);return cce(n-e(i),t-i)}const li={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},VJ=.001;function p4e({duration:e=li.duration,bounce:t=li.bounce,velocity:n=li.velocity,mass:i=li.mass}){let a,l,d=1-t;d=Vu(li.minDamping,li.maxDamping,d),e=Vu(li.minDuration,li.maxDuration,wu(e)),d<1?(a=v=>{const E=v*d,S=E*e,T=E-n,R=T2(v,d),I=Math.exp(-S);return VJ-T/R*I},l=v=>{const S=v*d*e,T=S*n+n,R=Math.pow(d,2)*Math.pow(v,2)*e,I=Math.exp(-S),O=T2(Math.pow(v,2),d);return(-a(v)+VJ>0?-1:1)*((T-R)*I)/O}):(a=v=>{const E=Math.exp(-v*e),S=(v-n)*e+1;return-.001+E*S},l=v=>{const E=Math.exp(-v*e),S=(n-v)*(e*e);return E*S});const f=5/e,m=g4e(a,l,f);if(e=Su(e),isNaN(m))return{stiffness:li.stiffness,damping:li.damping,duration:e};{const v=Math.pow(m,2)*i;return{stiffness:v,damping:d*2*Math.sqrt(i*v),duration:e}}}const m4e=12;function g4e(e,t,n){let i=n;for(let a=1;a<m4e;a++)i=i-e(i)/t(i);return i}function T2(e,t){return e*Math.sqrt(1-t*t)}const v4e=["duration","bounce"],y4e=["stiffness","damping","mass"];function FJ(e,t){return t.some(n=>e[n]!==void 0)}function _4e(e){let t={velocity:li.velocity,stiffness:li.stiffness,damping:li.damping,mass:li.mass,isResolvedFromDuration:!1,...e};if(!FJ(e,y4e)&&FJ(e,v4e))if(e.visualDuration){const n=e.visualDuration,i=2*Math.PI/(n*1.2),a=i*i,l=2*Vu(.05,1,1-(e.bounce||0))*Math.sqrt(a);t={...t,mass:li.mass,stiffness:a,damping:l}}else{const n=p4e(e);t={...t,...n,mass:li.mass},t.isResolvedFromDuration=!0}return t}function Mce(e=li.visualDuration,t=li.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:i,restDelta:a}=n;const l=n.keyframes[0],d=n.keyframes[n.keyframes.length-1],f={done:!1,value:l},{stiffness:m,damping:v,mass:E,duration:S,velocity:T,isResolvedFromDuration:R}=_4e({...n,velocity:-wu(n.velocity||0)}),I=T||0,O=v/(2*Math.sqrt(m*E)),P=d-l,D=wu(Math.sqrt(m/E)),k=Math.abs(P)<5;i||(i=k?li.restSpeed.granular:li.restSpeed.default),a||(a=k?li.restDelta.granular:li.restDelta.default);let M;if(O<1){const V=T2(D,O);M=W=>{const H=Math.exp(-O*D*W);return d-H*((I+O*D*P)/V*Math.sin(V*W)+P*Math.cos(V*W))}}else if(O===1)M=V=>d-Math.exp(-D*V)*(P+(I+D*P)*V);else{const V=D*Math.sqrt(O*O-1);M=W=>{const H=Math.exp(-O*D*W),J=Math.min(V*W,300);return d-H*((I+O*D*P)*Math.sinh(J)+V*P*Math.cosh(J))/V}}const $={calculatedDuration:R&&S||null,next:V=>{const W=M(V);if(R)f.done=V>=S;else{let H=0;O<1&&(H=V===0?Su(I):Lce(M,V,W));const J=Math.abs(H)<=i,ee=Math.abs(d-W)<=a;f.done=J&&ee}return f.value=f.done?d:W,f},toString:()=>{const V=Math.min(Zae($),g2),W=ece(H=>$.next(V*H).value,V,30);return V+"ms "+W}};return $}function BJ({keyframes:e,velocity:t=0,power:n=.8,timeConstant:i=325,bounceDamping:a=10,bounceStiffness:l=500,modifyTarget:d,min:f,max:m,restDelta:v=.5,restSpeed:E}){const S=e[0],T={done:!1,value:S},R=J=>f!==void 0&&J<f||m!==void 0&&J>m,I=J=>f===void 0?m:m===void 0||Math.abs(f-J)<Math.abs(m-J)?f:m;let O=n*t;const P=S+O,D=d===void 0?P:d(P);D!==P&&(O=D-S);const k=J=>-O*Math.exp(-J/i),M=J=>D+k(J),$=J=>{const ee=k(J),le=M(J);T.done=Math.abs(ee)<=v,T.value=T.done?D:le};let V,W;const H=J=>{R(T.value)&&(V=J,W=Mce({keyframes:[T.value,I(T.value)],velocity:Lce(M,J,T.value),damping:a,stiffness:l,restDelta:v,restSpeed:E}))};return H(0),{calculatedDuration:null,next:J=>{let ee=!1;return!W&&V===void 0&&(ee=!0,$(J),H(J)),V!==void 0&&J>=V?W.next(J-V):(!ee&&$(J),T)}}}const E4e=kS(.42,0,1,1),b4e=kS(0,0,.58,1),jce=kS(.42,0,.58,1),S4e=e=>Array.isArray(e)&&typeof e[0]!="number",w4e={linear:Ys,easeIn:E4e,easeInOut:jce,easeOut:b4e,circIn:vF,circInOut:vce,circOut:gce,backIn:gF,backInOut:pce,backOut:fce,anticipate:mce},$J=e=>{if(uF(e)){Dae(e.length===4);const[t,n,i,a]=e;return kS(t,n,i,a)}else if(typeof e=="string")return w4e[e];return e};function T4e(e,t,n){const i=[],a=n||kce,l=e.length-1;for(let d=0;d<l;d++){let f=a(e[d],e[d+1]);if(t){const m=Array.isArray(t)?t[d]||Ys:t;f=LS(m,f)}i.push(f)}return i}function C4e(e,t,{clamp:n=!0,ease:i,mixer:a}={}){const l=e.length;if(Dae(l===t.length),l===1)return()=>t[0];if(l===2&&t[0]===t[1])return()=>t[1];const d=e[0]===e[1];e[0]>e[l-1]&&(e=[...e].reverse(),t=[...t].reverse());const f=T4e(t,i,a),m=f.length,v=E=>{if(d&&E<e[0])return t[0];let S=0;if(m>1)for(;S<e.length-2&&!(E<e[S+1]);S++);const T=gv(e[S],e[S+1],E);return f[S](T)};return n?E=>v(Vu(e[0],e[l-1],E)):v}function R4e(e,t){const n=e[e.length-1];for(let i=1;i<=t;i++){const a=gv(0,t,i);e.push(Qr(n,1,a))}}function A4e(e){const t=[0];return R4e(t,e.length-1),t}function O4e(e,t){return e.map(n=>n*t)}function I4e(e,t){return e.map(()=>t||jce).splice(0,e.length-1)}function JR({duration:e=300,keyframes:t,times:n,ease:i="easeInOut"}){const a=S4e(i)?i.map($J):$J(i),l={done:!1,value:t[0]},d=O4e(n&&n.length===t.length?n:A4e(t),e),f=C4e(d,t,{ease:Array.isArray(a)?a:I4e(t,a)});return{calculatedDuration:e,next:m=>(l.value=f(m),l.done=m>=e,l)}}const x4e=e=>{const t=({timestamp:n})=>e(n);return{start:()=>Lr.update(t,!0),stop:()=>wh(t),now:()=>so.isProcessing?so.timestamp:Al.now()}},P4e={decay:BJ,inertia:BJ,tween:JR,keyframes:JR,spring:Mce},N4e=e=>e/100;class wF extends Nce{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:m}=this.options;m&&m()};const{name:n,motionValue:i,element:a,keyframes:l}=this.options,d=(a==null?void 0:a.KeyframeResolver)||bF,f=(m,v)=>this.onKeyframesResolved(m,v);this.resolver=new d(l,f,n,i,a),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:n="keyframes",repeat:i=0,repeatDelay:a=0,repeatType:l,velocity:d=0}=this.options,f=lF(n)?n:P4e[n]||JR;let m,v;f!==JR&&typeof t[0]!="number"&&(m=LS(N4e,kce(t[0],t[1])),t=[0,100]);const E=f({...this.options,keyframes:t});l==="mirror"&&(v=f({...this.options,keyframes:[...t].reverse(),velocity:-d})),E.calculatedDuration===null&&(E.calculatedDuration=Zae(E));const{calculatedDuration:S}=E,T=S+a,R=T*(i+1)-a;return{generator:E,mirroredGenerator:v,mapPercentToKeyframes:m,calculatedDuration:S,resolvedDuration:T,totalDuration:R}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,n=!1){const{resolved:i}=this;if(!i){const{keyframes:J}=this.options;return{done:!0,value:J[J.length-1]}}const{finalKeyframe:a,generator:l,mirroredGenerator:d,mapPercentToKeyframes:f,keyframes:m,calculatedDuration:v,totalDuration:E,resolvedDuration:S}=i;if(this.startTime===null)return l.next(0);const{delay:T,repeat:R,repeatType:I,repeatDelay:O,onUpdate:P}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-E/this.speed,this.startTime)),n?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const D=this.currentTime-T*(this.speed>=0?1:-1),k=this.speed>=0?D<0:D>E;this.currentTime=Math.max(D,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=E);let M=this.currentTime,$=l;if(R){const J=Math.min(this.currentTime,E)/S;let ee=Math.floor(J),le=J%1;!le&&J>=1&&(le=1),le===1&&ee--,ee=Math.min(ee,R+1),!!(ee%2)&&(I==="reverse"?(le=1-le,O&&(le-=O/S)):I==="mirror"&&($=d)),M=Vu(0,1,le)*S}const V=k?{done:!1,value:m[0]}:$.next(M);f&&(V.value=f(V.value));let{done:W}=V;!k&&v!==null&&(W=this.speed>=0?this.currentTime>=E:this.currentTime<=0);const H=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&W);return H&&a!==void 0&&(V.value=qO(m,this.options,a)),P&&P(V.value),H&&this.finish(),V}get duration(){const{resolved:t}=this;return t?wu(t.calculatedDuration):0}get time(){return wu(this.currentTime)}set time(t){t=Su(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=wu(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=x4e,onPlay:n,startTime:i}=this.options;this.driver||(this.driver=t(l=>this.tick(l))),n&&n();const a=this.driver.now();this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=a):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const D4e=new Set(["opacity","clipPath","filter","transform"]);function k4e(e,t,n,{delay:i=0,duration:a=300,repeat:l=0,repeatType:d="loop",ease:f="easeInOut",times:m}={}){const v={[t]:n};m&&(v.offset=m);const E=nce(f,a);return Array.isArray(E)&&(v.easing=E),e.animate(v,{delay:i,duration:a,easing:Array.isArray(E)?"linear":E,fill:"both",iterations:l+1,direction:d==="reverse"?"alternate":"normal"})}const L4e=YV(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),QR=10,M4e=2e4;function j4e(e){return lF(e.type)||e.type==="spring"||!tce(e.ease)}function U4e(e,t){const n=new wF({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:e[0]};const a=[];let l=0;for(;!i.done&&l<M4e;)i=n.sample(l),a.push(i.value),l+=QR;return{times:void 0,keyframes:a,duration:l-QR,ease:"linear"}}const Uce={anticipate:mce,backInOut:pce,circInOut:vce};function V4e(e){return e in Uce}class WJ extends Nce{constructor(t){super(t);const{name:n,motionValue:i,element:a,keyframes:l}=this.options;this.resolver=new Pce(l,(d,f)=>this.onKeyframesResolved(d,f),n,i,a),this.resolver.scheduleResolve()}initPlayback(t,n){let{duration:i=300,times:a,ease:l,type:d,motionValue:f,name:m,startTime:v}=this.options;if(!f.owner||!f.owner.current)return!1;if(typeof l=="string"&&qR()&&V4e(l)&&(l=Uce[l]),j4e(this.options)){const{onComplete:S,onUpdate:T,motionValue:R,element:I,...O}=this.options,P=U4e(t,O);t=P.keyframes,t.length===1&&(t[1]=t[0]),i=P.duration,a=P.times,l=P.ease,d="keyframes"}const E=k4e(f.owner.current,m,t,{...this.options,duration:i,times:a,ease:l});return E.startTime=v??this.calcStartTime(),this.pendingTimeline?(RJ(E,this.pendingTimeline),this.pendingTimeline=void 0):E.onfinish=()=>{const{onComplete:S}=this.options;f.set(qO(t,this.options,n)),S&&S(),this.cancel(),this.resolveFinishedPromise()},{animation:E,duration:i,times:a,type:d,ease:l,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:n}=t;return wu(n)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:n}=t;return wu(n.currentTime||0)}set time(t){const{resolved:n}=this;if(!n)return;const{animation:i}=n;i.currentTime=Su(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:n}=t;return n.playbackRate}set speed(t){const{resolved:n}=this;if(!n)return;const{animation:i}=n;i.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:n}=t;return n.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:n}=t;return n.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:n}=this;if(!n)return Ys;const{animation:i}=n;RJ(i,t)}return Ys}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:n,keyframes:i,duration:a,type:l,ease:d,times:f}=t;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:v,onUpdate:E,onComplete:S,element:T,...R}=this.options,I=new wF({...R,keyframes:i,duration:a,type:l,ease:d,times:f,isGenerator:!0}),O=Su(this.time);v.setWithVelocity(I.sample(O-QR).value,I.sample(O).value,QR)}const{onStop:m}=this.options;m&&m(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:n,name:i,repeatDelay:a,repeatType:l,damping:d,type:f}=t;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:m,transformTemplate:v}=n.owner.getProps();return L4e()&&i&&D4e.has(i)&&!m&&!v&&!a&&l!=="mirror"&&d!==0&&f!=="inertia"}}const F4e={type:"spring",stiffness:500,damping:25,restSpeed:10},B4e=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),$4e={type:"keyframes",duration:.8},W4e={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},G4e=(e,{keyframes:t})=>t.length>2?$4e:Pp.has(e)?e.startsWith("scale")?B4e(t[1]):F4e:W4e;function H4e({when:e,delay:t,delayChildren:n,staggerChildren:i,staggerDirection:a,repeat:l,repeatType:d,repeatDelay:f,from:m,elapsed:v,...E}){return!!Object.keys(E).length}const TF=(e,t,n,i={},a,l)=>d=>{const f=cF(i,e)||{},m=f.delay||i.delay||0;let{elapsed:v=0}=i;v=v-Su(m);let E={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...f,delay:-v,onUpdate:T=>{t.set(T),f.onUpdate&&f.onUpdate(T)},onComplete:()=>{d(),f.onComplete&&f.onComplete()},name:e,motionValue:t,element:l?void 0:a};H4e(f)||(E={...E,...G4e(e,E)}),E.duration&&(E.duration=Su(E.duration)),E.repeatDelay&&(E.repeatDelay=Su(E.repeatDelay)),E.from!==void 0&&(E.keyframes[0]=E.from);let S=!1;if((E.type===!1||E.duration===0&&!E.repeatDelay)&&(E.duration=0,E.delay===0&&(S=!0)),S&&!l&&t.get()!==void 0){const T=qO(E.keyframes,f);if(T!==void 0)return Lr.update(()=>{E.onUpdate(T),E.onComplete()}),new h3e([])}return!l&&WJ.supports(E)?new WJ(E):new wF(E)};function K4e({protectedKeys:e,needsAnimating:t},n){const i=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,i}function Vce(e,t,{delay:n=0,transitionOverride:i,type:a}={}){var l;let{transition:d=e.getDefaultTransition(),transitionEnd:f,...m}=t;i&&(d=i);const v=[],E=a&&e.animationState&&e.animationState.getState()[a];for(const S in m){const T=e.getValue(S,(l=e.latestValues[S])!==null&&l!==void 0?l:null),R=m[S];if(R===void 0||E&&K4e(E,S))continue;const I={delay:n,...cF(d||{},S)};let O=!1;if(window.MotionHandoffAnimation){const D=lce(e);if(D){const k=window.MotionHandoffAnimation(D,S,Lr);k!==null&&(I.startTime=k,O=!0)}}y2(e,S),T.start(TF(S,T,R,e.shouldReduceMotion&&ace.has(S)?{type:!1}:I,e,O));const P=T.animation;P&&v.push(P)}return f&&Promise.all(v).then(()=>{Lr.update(()=>{f&&mF(e,f)})}),v}function C2(e,t,n={}){var i;const a=YO(e,t,n.type==="exit"?(i=e.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:l=e.getDefaultTransition()||{}}=a||{};n.transitionOverride&&(l=n.transitionOverride);const d=a?()=>Promise.all(Vce(e,a,n)):()=>Promise.resolve(),f=e.variantChildren&&e.variantChildren.size?(v=0)=>{const{delayChildren:E=0,staggerChildren:S,staggerDirection:T}=l;return z4e(e,t,E+v,S,T,n)}:()=>Promise.resolve(),{when:m}=l;if(m){const[v,E]=m==="beforeChildren"?[d,f]:[f,d];return v().then(()=>E())}else return Promise.all([d(),f(n.delay)])}function z4e(e,t,n=0,i=0,a=1,l){const d=[],f=(e.variantChildren.size-1)*i,m=a===1?(v=0)=>v*i:(v=0)=>f-v*i;return Array.from(e.variantChildren).sort(Y4e).forEach((v,E)=>{v.notify("AnimationStart",t),d.push(C2(v,t,{...l,delay:n+m(E)}).then(()=>v.notify("AnimationComplete",t)))}),Promise.all(d)}function Y4e(e,t){return e.sortNodePosition(t)}function Fce(e,t,n={}){e.notify("AnimationStart",t);let i;if(Array.isArray(t)){const a=t.map(l=>C2(e,l,n));i=Promise.all(a)}else if(typeof t=="string")i=C2(e,t,n);else{const a=typeof t=="function"?YO(e,t,n.custom):t;i=Promise.all(Vce(e,a,n))}return i.then(()=>{e.notify("AnimationComplete",t)})}const q4e=XV.length;function Bce(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?Bce(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<q4e;n++){const i=XV[n],a=e.props[i];(xb(a)||a===!1)&&(t[i]=a)}return t}const X4e=[...qV].reverse(),J4e=qV.length;function Q4e(e){return t=>Promise.all(t.map(({animation:n,options:i})=>Fce(e,n,i)))}function Z4e(e){let t=Q4e(e),n=GJ(),i=!0;const a=m=>(v,E)=>{var S;const T=YO(e,E,m==="exit"?(S=e.presenceContext)===null||S===void 0?void 0:S.custom:void 0);if(T){const{transition:R,transitionEnd:I,...O}=T;v={...v,...O,...I}}return v};function l(m){t=m(e)}function d(m){const{props:v}=e,E=Bce(e.parent)||{},S=[],T=new Set;let R={},I=1/0;for(let P=0;P<J4e;P++){const D=X4e[P],k=n[D],M=v[D]!==void 0?v[D]:E[D],$=xb(M),V=D===m?k.isActive:null;V===!1&&(I=P);let W=M===E[D]&&M!==v[D]&&$;if(W&&i&&e.manuallyAnimateOnMount&&(W=!1),k.protectedKeys={...R},!k.isActive&&V===null||!M&&!k.prevProp||KO(M)||typeof M=="boolean")continue;const H=e5e(k.prevProp,M);let J=H||D===m&&k.isActive&&!W&&$||P>I&&$,ee=!1;const le=Array.isArray(M)?M:[M];let he=le.reduce(a(D),{});V===!1&&(he={});const{prevResolvedValues:de={}}=k,ae={...de,...he},ce=te=>{J=!0,T.has(te)&&(ee=!0,T.delete(te)),k.needsAnimating[te]=!0;const ne=e.getValue(te);ne&&(ne.liveStyle=!1)};for(const te in ae){const ne=he[te],ue=de[te];if(R.hasOwnProperty(te))continue;let _e=!1;m2(ne)&&m2(ue)?_e=!Qae(ne,ue):_e=ne!==ue,_e?ne!=null?ce(te):T.add(te):ne!==void 0&&T.has(te)?ce(te):k.protectedKeys[te]=!0}k.prevProp=M,k.prevResolvedValues=he,k.isActive&&(R={...R,...he}),i&&e.blockInitialAnimation&&(J=!1),J&&(!(W&&H)||ee)&&S.push(...le.map(te=>({animation:te,options:{type:D}})))}if(T.size){const P={};T.forEach(D=>{const k=e.getBaseTarget(D),M=e.getValue(D);M&&(M.liveStyle=!0),P[D]=k??null}),S.push({animation:P})}let O=!!S.length;return i&&(v.initial===!1||v.initial===v.animate)&&!e.manuallyAnimateOnMount&&(O=!1),i=!1,O?t(S):Promise.resolve()}function f(m,v){var E;if(n[m].isActive===v)return Promise.resolve();(E=e.variantChildren)===null||E===void 0||E.forEach(T=>{var R;return(R=T.animationState)===null||R===void 0?void 0:R.setActive(m,v)}),n[m].isActive=v;const S=d(m);for(const T in n)n[T].protectedKeys={};return S}return{animateChanges:d,setActive:f,setAnimateFunction:l,getState:()=>n,reset:()=>{n=GJ(),i=!0}}}function e5e(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!Qae(t,e):!1}function xf(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function GJ(){return{animate:xf(!0),whileInView:xf(),whileHover:xf(),whileTap:xf(),whileDrag:xf(),whileFocus:xf(),exit:xf()}}class xh{constructor(t){this.isMounted=!1,this.node=t}update(){}}class t5e extends xh{constructor(t){super(t),t.animationState||(t.animationState=Z4e(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();KO(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let n5e=0;class r5e extends xh{constructor(){super(...arguments),this.id=n5e++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===i)return;const a=this.node.animationState.setActive("exit",!t);n&&!t&&a.then(()=>n(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const i5e={animation:{Feature:t5e},exit:{Feature:r5e}};function kb(e,t,n,i={passive:!0}){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n)}function MS(e){return{point:{x:e.pageX,y:e.pageY}}}const o5e=e=>t=>dF(t)&&e(t,MS(t));function YE(e,t,n,i){return kb(e,t,o5e(n),i)}const HJ=(e,t)=>Math.abs(e-t);function s5e(e,t){const n=HJ(e.x,t.x),i=HJ(e.y,t.y);return Math.sqrt(n**2+i**2)}class $ce{constructor(t,n,{transformPagePoint:i,contextWindow:a,dragSnapToOrigin:l=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const S=rL(this.lastMoveEventInfo,this.history),T=this.startEvent!==null,R=s5e(S.offset,{x:0,y:0})>=3;if(!T&&!R)return;const{point:I}=S,{timestamp:O}=so;this.history.push({...I,timestamp:O});const{onStart:P,onMove:D}=this.handlers;T||(P&&P(this.lastMoveEvent,S),this.startEvent=this.lastMoveEvent),D&&D(this.lastMoveEvent,S)},this.handlePointerMove=(S,T)=>{this.lastMoveEvent=S,this.lastMoveEventInfo=nL(T,this.transformPagePoint),Lr.update(this.updatePoint,!0)},this.handlePointerUp=(S,T)=>{this.end();const{onEnd:R,onSessionEnd:I,resumeAnimation:O}=this.handlers;if(this.dragSnapToOrigin&&O&&O(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const P=rL(S.type==="pointercancel"?this.lastMoveEventInfo:nL(T,this.transformPagePoint),this.history);this.startEvent&&R&&R(S,P),I&&I(S,P)},!dF(t))return;this.dragSnapToOrigin=l,this.handlers=n,this.transformPagePoint=i,this.contextWindow=a||window;const d=MS(t),f=nL(d,this.transformPagePoint),{point:m}=f,{timestamp:v}=so;this.history=[{...m,timestamp:v}];const{onSessionStart:E}=n;E&&E(t,rL(f,this.history)),this.removeListeners=LS(YE(this.contextWindow,"pointermove",this.handlePointerMove),YE(this.contextWindow,"pointerup",this.handlePointerUp),YE(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),wh(this.updatePoint)}}function nL(e,t){return t?{point:t(e.point)}:e}function KJ(e,t){return{x:e.x-t.x,y:e.y-t.y}}function rL({point:e},t){return{point:e,delta:KJ(e,Wce(t)),offset:KJ(e,a5e(t)),velocity:c5e(t,.1)}}function a5e(e){return e[0]}function Wce(e){return e[e.length-1]}function c5e(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,i=null;const a=Wce(e);for(;n>=0&&(i=e[n],!(a.timestamp-i.timestamp>Su(t)));)n--;if(!i)return{x:0,y:0};const l=wu(a.timestamp-i.timestamp);if(l===0)return{x:0,y:0};const d={x:(a.x-i.x)/l,y:(a.y-i.y)/l};return d.x===1/0&&(d.x=0),d.y===1/0&&(d.y=0),d}const Gce=1e-4,l5e=1-Gce,u5e=1+Gce,Hce=.01,d5e=0-Hce,h5e=0+Hce;function Js(e){return e.max-e.min}function f5e(e,t,n){return Math.abs(e-t)<=n}function zJ(e,t,n,i=.5){e.origin=i,e.originPoint=Qr(t.min,t.max,e.origin),e.scale=Js(n)/Js(t),e.translate=Qr(n.min,n.max,e.origin)-e.originPoint,(e.scale>=l5e&&e.scale<=u5e||isNaN(e.scale))&&(e.scale=1),(e.translate>=d5e&&e.translate<=h5e||isNaN(e.translate))&&(e.translate=0)}function qE(e,t,n,i){zJ(e.x,t.x,n.x,i?i.originX:void 0),zJ(e.y,t.y,n.y,i?i.originY:void 0)}function YJ(e,t,n){e.min=n.min+t.min,e.max=e.min+Js(t)}function p5e(e,t,n){YJ(e.x,t.x,n.x),YJ(e.y,t.y,n.y)}function qJ(e,t,n){e.min=t.min-n.min,e.max=e.min+Js(t)}function XE(e,t,n){qJ(e.x,t.x,n.x),qJ(e.y,t.y,n.y)}function m5e(e,{min:t,max:n},i){return t!==void 0&&e<t?e=i?Qr(t,e,i.min):Math.max(e,t):n!==void 0&&e>n&&(e=i?Qr(n,e,i.max):Math.min(e,n)),e}function XJ(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function g5e(e,{top:t,left:n,bottom:i,right:a}){return{x:XJ(e.x,n,a),y:XJ(e.y,t,i)}}function JJ(e,t){let n=t.min-e.min,i=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,i]=[i,n]),{min:n,max:i}}function v5e(e,t){return{x:JJ(e.x,t.x),y:JJ(e.y,t.y)}}function y5e(e,t){let n=.5;const i=Js(e),a=Js(t);return a>i?n=gv(t.min,t.max-i,e.min):i>a&&(n=gv(e.min,e.max-a,t.min)),Vu(0,1,n)}function _5e(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const R2=.35;function E5e(e=R2){return e===!1?e=0:e===!0&&(e=R2),{x:QJ(e,"left","right"),y:QJ(e,"top","bottom")}}function QJ(e,t,n){return{min:ZJ(e,t),max:ZJ(e,n)}}function ZJ(e,t){return typeof e=="number"?e:e[t]||0}const eQ=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ig=()=>({x:eQ(),y:eQ()}),tQ=()=>({min:0,max:0}),vi=()=>({x:tQ(),y:tQ()});function xa(e){return[e("x"),e("y")]}function Kce({top:e,left:t,right:n,bottom:i}){return{x:{min:t,max:n},y:{min:e,max:i}}}function b5e({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function S5e(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),i=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}function iL(e){return e===void 0||e===1}function A2({scale:e,scaleX:t,scaleY:n}){return!iL(e)||!iL(t)||!iL(n)}function jf(e){return A2(e)||zce(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function zce(e){return nQ(e.x)||nQ(e.y)}function nQ(e){return e&&e!=="0%"}function ZR(e,t,n){const i=e-n,a=t*i;return n+a}function rQ(e,t,n,i,a){return a!==void 0&&(e=ZR(e,a,i)),ZR(e,n,i)+t}function O2(e,t=0,n=1,i,a){e.min=rQ(e.min,t,n,i,a),e.max=rQ(e.max,t,n,i,a)}function Yce(e,{x:t,y:n}){O2(e.x,t.translate,t.scale,t.originPoint),O2(e.y,n.translate,n.scale,n.originPoint)}const iQ=.999999999999,oQ=1.0000000000001;function w5e(e,t,n,i=!1){const a=n.length;if(!a)return;t.x=t.y=1;let l,d;for(let f=0;f<a;f++){l=n[f],d=l.projectionDelta;const{visualElement:m}=l.options;m&&m.props.style&&m.props.style.display==="contents"||(i&&l.options.layoutScroll&&l.scroll&&l!==l.root&&Pg(e,{x:-l.scroll.offset.x,y:-l.scroll.offset.y}),d&&(t.x*=d.x.scale,t.y*=d.y.scale,Yce(e,d)),i&&jf(l.latestValues)&&Pg(e,l.latestValues))}t.x<oQ&&t.x>iQ&&(t.x=1),t.y<oQ&&t.y>iQ&&(t.y=1)}function xg(e,t){e.min=e.min+t,e.max=e.max+t}function sQ(e,t,n,i,a=.5){const l=Qr(e.min,e.max,a);O2(e,t,n,l,i)}function Pg(e,t){sQ(e.x,t.x,t.scaleX,t.scale,t.originX),sQ(e.y,t.y,t.scaleY,t.scale,t.originY)}function qce(e,t){return Kce(S5e(e.getBoundingClientRect(),t))}function T5e(e,t,n){const i=qce(e,n),{scroll:a}=t;return a&&(xg(i.x,a.offset.x),xg(i.y,a.offset.y)),i}const Xce=({current:e})=>e?e.ownerDocument.defaultView:null,C5e=new WeakMap;class R5e{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=vi(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const a=E=>{const{dragSnapToOrigin:S}=this.getProps();S?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(MS(E).point)},l=(E,S)=>{const{drag:T,dragPropagation:R,onDragStart:I}=this.getProps();if(T&&!R&&(this.openDragLock&&this.openDragLock(),this.openDragLock=E3e(T),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),xa(P=>{let D=this.getAxisMotionValue(P).get()||0;if(Rl.test(D)){const{projection:k}=this.visualElement;if(k&&k.layout){const M=k.layout.layoutBox[P];M&&(D=Js(M)*(parseFloat(D)/100))}}this.originPoint[P]=D}),I&&Lr.postRender(()=>I(E,S)),y2(this.visualElement,"transform");const{animationState:O}=this.visualElement;O&&O.setActive("whileDrag",!0)},d=(E,S)=>{const{dragPropagation:T,dragDirectionLock:R,onDirectionLock:I,onDrag:O}=this.getProps();if(!T&&!this.openDragLock)return;const{offset:P}=S;if(R&&this.currentDirection===null){this.currentDirection=A5e(P),this.currentDirection!==null&&I&&I(this.currentDirection);return}this.updateAxis("x",S.point,P),this.updateAxis("y",S.point,P),this.visualElement.render(),O&&O(E,S)},f=(E,S)=>this.stop(E,S),m=()=>xa(E=>{var S;return this.getAnimationState(E)==="paused"&&((S=this.getAxisMotionValue(E).animation)===null||S===void 0?void 0:S.play())}),{dragSnapToOrigin:v}=this.getProps();this.panSession=new $ce(t,{onSessionStart:a,onStart:l,onMove:d,onSessionEnd:f,resumeAnimation:m},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:v,contextWindow:Xce(this.visualElement)})}stop(t,n){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:a}=n;this.startAnimation(a);const{onDragEnd:l}=this.getProps();l&&Lr.postRender(()=>l(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,i){const{drag:a}=this.getProps();if(!i||!IC(t,a,this.currentDirection))return;const l=this.getAxisMotionValue(t);let d=this.originPoint[t]+i[t];this.constraints&&this.constraints[t]&&(d=m5e(d,this.constraints[t],this.elastic[t])),l.set(d)}resolveConstraints(){var t;const{dragConstraints:n,dragElastic:i}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,l=this.constraints;n&&Ag(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&a?this.constraints=g5e(a.layoutBox,n):this.constraints=!1,this.elastic=E5e(i),l!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&xa(d=>{this.constraints!==!1&&this.getAxisMotionValue(d)&&(this.constraints[d]=_5e(a.layoutBox[d],this.constraints[d]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!Ag(t))return!1;const i=t.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const l=T5e(i,a.root,this.visualElement.getTransformPagePoint());let d=v5e(a.layout.layoutBox,l);if(n){const f=n(b5e(d));this.hasMutatedConstraints=!!f,f&&(d=Kce(f))}return d}startAnimation(t){const{drag:n,dragMomentum:i,dragElastic:a,dragTransition:l,dragSnapToOrigin:d,onDragTransitionEnd:f}=this.getProps(),m=this.constraints||{},v=xa(E=>{if(!IC(E,n,this.currentDirection))return;let S=m&&m[E]||{};d&&(S={min:0,max:0});const T=a?200:1e6,R=a?40:1e7,I={type:"inertia",velocity:i?t[E]:0,bounceStiffness:T,bounceDamping:R,timeConstant:750,restDelta:1,restSpeed:10,...l,...S};return this.startAxisValueAnimation(E,I)});return Promise.all(v).then(f)}startAxisValueAnimation(t,n){const i=this.getAxisMotionValue(t);return y2(this.visualElement,t),i.start(TF(t,i,0,n,this.visualElement,!1))}stopAnimation(){xa(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){xa(t=>{var n;return(n=this.getAxisMotionValue(t).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,i=this.visualElement.getProps(),a=i[n];return a||this.visualElement.getValue(t,(i.initial?i.initial[t]:void 0)||0)}snapToCursor(t){xa(n=>{const{drag:i}=this.getProps();if(!IC(n,i,this.currentDirection))return;const{projection:a}=this.visualElement,l=this.getAxisMotionValue(n);if(a&&a.layout){const{min:d,max:f}=a.layout.layoutBox[n];l.set(t[n]-Qr(d,f,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:i}=this.visualElement;if(!Ag(n)||!i||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};xa(d=>{const f=this.getAxisMotionValue(d);if(f&&this.constraints!==!1){const m=f.get();a[d]=y5e({min:m,max:m},this.constraints[d])}});const{transformTemplate:l}=this.visualElement.getProps();this.visualElement.current.style.transform=l?l({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),xa(d=>{if(!IC(d,t,null))return;const f=this.getAxisMotionValue(d),{min:m,max:v}=this.constraints[d];f.set(Qr(m,v,a[d]))})}addListeners(){if(!this.visualElement.current)return;C5e.set(this.visualElement,this);const t=this.visualElement.current,n=YE(t,"pointerdown",m=>{const{drag:v,dragListener:E=!0}=this.getProps();v&&E&&this.start(m)}),i=()=>{const{dragConstraints:m}=this.getProps();Ag(m)&&m.current&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,l=a.addEventListener("measure",i);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),Lr.read(i);const d=kb(window,"resize",()=>this.scalePositionWithinConstraints()),f=a.addEventListener("didUpdate",({delta:m,hasLayoutChanged:v})=>{this.isDragging&&v&&(xa(E=>{const S=this.getAxisMotionValue(E);S&&(this.originPoint[E]+=m[E].translate,S.set(S.get()+m[E].translate))}),this.visualElement.render())});return()=>{d(),n(),l(),f&&f()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:i=!1,dragPropagation:a=!1,dragConstraints:l=!1,dragElastic:d=R2,dragMomentum:f=!0}=t;return{...t,drag:n,dragDirectionLock:i,dragPropagation:a,dragConstraints:l,dragElastic:d,dragMomentum:f}}}function IC(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function A5e(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class O5e extends xh{constructor(t){super(t),this.removeGroupControls=Ys,this.removeListeners=Ys,this.controls=new R5e(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ys}unmount(){this.removeGroupControls(),this.removeListeners()}}const aQ=e=>(t,n)=>{e&&Lr.postRender(()=>e(t,n))};class I5e extends xh{constructor(){super(...arguments),this.removePointerDownListener=Ys}onPointerDown(t){this.session=new $ce(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Xce(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:i,onPanEnd:a}=this.node.getProps();return{onSessionStart:aQ(t),onStart:aQ(n),onMove:i,onEnd:(l,d)=>{delete this.session,a&&Lr.postRender(()=>a(l,d))}}}mount(){this.removePointerDownListener=YE(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const dR={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function cQ(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const cE={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Lt.test(e))e=parseFloat(e);else return e;const n=cQ(e,t.target.x),i=cQ(e,t.target.y);return`${n}% ${i}%`}},x5e={correct:(e,{treeScale:t,projectionDelta:n})=>{const i=e,a=Th.parse(e);if(a.length>5)return i;const l=Th.createTransformer(e),d=typeof a[0]!="number"?1:0,f=n.x.scale*t.x,m=n.y.scale*t.y;a[0+d]/=f,a[1+d]/=m;const v=Qr(f,m,.5);return typeof a[2+d]=="number"&&(a[2+d]/=v),typeof a[3+d]=="number"&&(a[3+d]/=v),l(a)}};class P5e extends N.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:i,layoutId:a}=this.props,{projection:l}=t;e3e(N5e),l&&(n.group&&n.group.add(l),i&&i.register&&a&&i.register(l),l.root.didUpdate(),l.addEventListener("animationComplete",()=>{this.safeToRemove()}),l.setOptions({...l.options,onExitComplete:()=>this.safeToRemove()})),dR.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:i,drag:a,isPresent:l}=this.props,d=i.projection;return d&&(d.isPresent=l,a||t.layoutDependency!==n||n===void 0?d.willUpdate():this.safeToRemove(),t.isPresent!==l&&(l?d.promote():d.relegate()||Lr.postRender(()=>{const f=d.getStack();(!f||!f.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),QV.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:i}=this.props,{projection:a}=t;a&&(a.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(a),i&&i.deregister&&i.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Jce(e){const[t,n]=Pae(),i=N.useContext(GV);return _.jsx(P5e,{...e,layoutGroup:i,switchLayoutGroup:N.useContext(Vae),isPresent:t,safeToRemove:n})}const N5e={borderRadius:{...cE,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:cE,borderTopRightRadius:cE,borderBottomLeftRadius:cE,borderBottomRightRadius:cE,boxShadow:x5e};function D5e(e,t,n){const i=Co(e)?e:Nb(e);return i.start(TF("",i,t,n)),i.animation}function k5e(e){return e instanceof SVGElement&&e.tagName!=="svg"}const L5e=(e,t)=>e.depth-t.depth;class M5e{constructor(){this.children=[],this.isDirty=!1}add(t){hF(this.children,t),this.isDirty=!0}remove(t){fF(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(L5e),this.isDirty=!1,this.children.forEach(t)}}function j5e(e,t){const n=Al.now(),i=({timestamp:a})=>{const l=a-n;l>=t&&(wh(i),e(l-t))};return Lr.read(i,!0),()=>wh(i)}const Qce=["TopLeft","TopRight","BottomLeft","BottomRight"],U5e=Qce.length,lQ=e=>typeof e=="string"?parseFloat(e):e,uQ=e=>typeof e=="number"||Lt.test(e);function V5e(e,t,n,i,a,l){a?(e.opacity=Qr(0,n.opacity!==void 0?n.opacity:1,F5e(i)),e.opacityExit=Qr(t.opacity!==void 0?t.opacity:1,0,B5e(i))):l&&(e.opacity=Qr(t.opacity!==void 0?t.opacity:1,n.opacity!==void 0?n.opacity:1,i));for(let d=0;d<U5e;d++){const f=`border${Qce[d]}Radius`;let m=dQ(t,f),v=dQ(n,f);if(m===void 0&&v===void 0)continue;m||(m=0),v||(v=0),m===0||v===0||uQ(m)===uQ(v)?(e[f]=Math.max(Qr(lQ(m),lQ(v),i),0),(Rl.test(v)||Rl.test(m))&&(e[f]+="%")):e[f]=v}(t.rotate||n.rotate)&&(e.rotate=Qr(t.rotate||0,n.rotate||0,i))}function dQ(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const F5e=Zce(0,.5,gce),B5e=Zce(.5,.95,Ys);function Zce(e,t,n){return i=>i<e?0:i>t?1:n(gv(e,t,i))}function hQ(e,t){e.min=t.min,e.max=t.max}function Aa(e,t){hQ(e.x,t.x),hQ(e.y,t.y)}function fQ(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function pQ(e,t,n,i,a){return e-=t,e=ZR(e,1/n,i),a!==void 0&&(e=ZR(e,1/a,i)),e}function $5e(e,t=0,n=1,i=.5,a,l=e,d=e){if(Rl.test(t)&&(t=parseFloat(t),t=Qr(d.min,d.max,t/100)-d.min),typeof t!="number")return;let f=Qr(l.min,l.max,i);e===l&&(f-=t),e.min=pQ(e.min,t,n,f,a),e.max=pQ(e.max,t,n,f,a)}function mQ(e,t,[n,i,a],l,d){$5e(e,t[n],t[i],t[a],t.scale,l,d)}const W5e=["x","scaleX","originX"],G5e=["y","scaleY","originY"];function gQ(e,t,n,i){mQ(e.x,t,W5e,n?n.x:void 0,i?i.x:void 0),mQ(e.y,t,G5e,n?n.y:void 0,i?i.y:void 0)}function vQ(e){return e.translate===0&&e.scale===1}function ele(e){return vQ(e.x)&&vQ(e.y)}function yQ(e,t){return e.min===t.min&&e.max===t.max}function H5e(e,t){return yQ(e.x,t.x)&&yQ(e.y,t.y)}function _Q(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function tle(e,t){return _Q(e.x,t.x)&&_Q(e.y,t.y)}function EQ(e){return Js(e.x)/Js(e.y)}function bQ(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class K5e{constructor(){this.members=[]}add(t){hF(this.members,t),t.scheduleRender()}remove(t){if(fF(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(a=>t===a);if(n===0)return!1;let i;for(let a=n;a>=0;a--){const l=this.members[a];if(l.isPresent!==!1){i=l;break}}return i?(this.promote(i),!0):!1}promote(t,n){const i=this.lead;if(t!==i&&(this.prevLead=i,this.lead=t,t.show(),i)){i.instance&&i.scheduleRender(),t.scheduleRender(),t.resumeFrom=i,n&&(t.resumeFrom.preserveOpacity=!0),i.snapshot&&(t.snapshot=i.snapshot,t.snapshot.latestValues=i.animationValues||i.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:a}=t.options;a===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:i}=t;n.onExitComplete&&n.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function z5e(e,t,n){let i="";const a=e.x.translate/t.x,l=e.y.translate/t.y,d=(n==null?void 0:n.z)||0;if((a||l||d)&&(i=`translate3d(${a}px, ${l}px, ${d}px) `),(t.x!==1||t.y!==1)&&(i+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:v,rotate:E,rotateX:S,rotateY:T,skewX:R,skewY:I}=n;v&&(i=`perspective(${v}px) ${i}`),E&&(i+=`rotate(${E}deg) `),S&&(i+=`rotateX(${S}deg) `),T&&(i+=`rotateY(${T}deg) `),R&&(i+=`skewX(${R}deg) `),I&&(i+=`skewY(${I}deg) `)}const f=e.x.scale*t.x,m=e.y.scale*t.y;return(f!==1||m!==1)&&(i+=`scale(${f}, ${m})`),i||"none"}const Uf={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},OE=typeof window<"u"&&window.MotionDebug!==void 0,oL=["","X","Y","Z"],Y5e={visibility:"hidden"},SQ=1e3;let q5e=0;function sL(e,t,n,i){const{latestValues:a}=t;a[e]&&(n[e]=a[e],t.setStaticValue(e,0),i&&(i[e]=0))}function nle(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=lce(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:a,layoutId:l}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",Lr,!(a||l))}const{parent:i}=e;i&&!i.hasCheckedOptimisedAppear&&nle(i)}function rle({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:i,resetTransform:a}){return class{constructor(d={},f=t==null?void 0:t()){this.id=q5e++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,OE&&(Uf.totalNodes=Uf.resolvedTargetDeltas=Uf.recalculatedProjection=0),this.nodes.forEach(Q5e),this.nodes.forEach(r$e),this.nodes.forEach(i$e),this.nodes.forEach(Z5e),OE&&window.MotionDebug.record(Uf)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=d,this.root=f?f.root||f:this,this.path=f?[...f.path,f]:[],this.parent=f,this.depth=f?f.depth+1:0;for(let m=0;m<this.path.length;m++)this.path[m].shouldResetTransform=!0;this.root===this&&(this.nodes=new M5e)}addEventListener(d,f){return this.eventHandlers.has(d)||this.eventHandlers.set(d,new pF),this.eventHandlers.get(d).add(f)}notifyListeners(d,...f){const m=this.eventHandlers.get(d);m&&m.notify(...f)}hasListeners(d){return this.eventHandlers.has(d)}mount(d,f=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=k5e(d),this.instance=d;const{layoutId:m,layout:v,visualElement:E}=this.options;if(E&&!E.current&&E.mount(d),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),f&&(v||m)&&(this.isLayoutDirty=!0),e){let S;const T=()=>this.root.updateBlockedByResize=!1;e(d,()=>{this.root.updateBlockedByResize=!0,S&&S(),S=j5e(T,250),dR.hasAnimatedSinceResize&&(dR.hasAnimatedSinceResize=!1,this.nodes.forEach(TQ))})}m&&this.root.registerSharedNode(m,this),this.options.animate!==!1&&E&&(m||v)&&this.addEventListener("didUpdate",({delta:S,hasLayoutChanged:T,hasRelativeTargetChanged:R,layout:I})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const O=this.options.transition||E.getDefaultTransition()||l$e,{onLayoutAnimationStart:P,onLayoutAnimationComplete:D}=E.getProps(),k=!this.targetLayout||!tle(this.targetLayout,I)||R,M=!T&&R;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||M||T&&(k||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(S,M);const $={...cF(O,"layout"),onPlay:P,onComplete:D};(E.shouldReduceMotion||this.options.layoutRoot)&&($.delay=0,$.type=!1),this.startAnimation($)}else T||TQ(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=I})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const d=this.getStack();d&&d.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,wh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(o$e),this.animationId++)}getTransformTemplate(){const{visualElement:d}=this.options;return d&&d.getProps().transformTemplate}willUpdate(d=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&nle(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let E=0;E<this.path.length;E++){const S=this.path[E];S.shouldResetTransform=!0,S.updateScroll("snapshot"),S.options.layoutRoot&&S.willUpdate(!1)}const{layoutId:f,layout:m}=this.options;if(f===void 0&&!m)return;const v=this.getTransformTemplate();this.prevTransformTemplateValue=v?v(this.latestValues,""):void 0,this.updateSnapshot(),d&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(wQ);return}this.isUpdating||this.nodes.forEach(t$e),this.isUpdating=!1,this.nodes.forEach(n$e),this.nodes.forEach(X5e),this.nodes.forEach(J5e),this.clearAllSnapshots();const f=Al.now();so.delta=Vu(0,1e3/60,f-so.timestamp),so.timestamp=f,so.isProcessing=!0,Jk.update.process(so),Jk.preRender.process(so),Jk.render.process(so),so.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,QV.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(e$e),this.sharedNodes.forEach(s$e)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Lr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Lr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let m=0;m<this.path.length;m++)this.path[m].updateScroll();const d=this.layout;this.layout=this.measure(!1),this.layoutCorrected=vi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:f}=this.options;f&&f.notify("LayoutMeasure",this.layout.layoutBox,d?d.layoutBox:void 0)}updateScroll(d="measure"){let f=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===d&&(f=!1),f){const m=i(this.instance);this.scroll={animationId:this.root.animationId,phase:d,isRoot:m,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:m}}}resetTransform(){if(!a)return;const d=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,f=this.projectionDelta&&!ele(this.projectionDelta),m=this.getTransformTemplate(),v=m?m(this.latestValues,""):void 0,E=v!==this.prevTransformTemplateValue;d&&(f||jf(this.latestValues)||E)&&(a(this.instance,v),this.shouldResetTransform=!1,this.scheduleRender())}measure(d=!0){const f=this.measurePageBox();let m=this.removeElementScroll(f);return d&&(m=this.removeTransform(m)),u$e(m),{animationId:this.root.animationId,measuredBox:f,layoutBox:m,latestValues:{},source:this.id}}measurePageBox(){var d;const{visualElement:f}=this.options;if(!f)return vi();const m=f.measureViewportBox();if(!(((d=this.scroll)===null||d===void 0?void 0:d.wasRoot)||this.path.some(d$e))){const{scroll:E}=this.root;E&&(xg(m.x,E.offset.x),xg(m.y,E.offset.y))}return m}removeElementScroll(d){var f;const m=vi();if(Aa(m,d),!((f=this.scroll)===null||f===void 0)&&f.wasRoot)return m;for(let v=0;v<this.path.length;v++){const E=this.path[v],{scroll:S,options:T}=E;E!==this.root&&S&&T.layoutScroll&&(S.wasRoot&&Aa(m,d),xg(m.x,S.offset.x),xg(m.y,S.offset.y))}return m}applyTransform(d,f=!1){const m=vi();Aa(m,d);for(let v=0;v<this.path.length;v++){const E=this.path[v];!f&&E.options.layoutScroll&&E.scroll&&E!==E.root&&Pg(m,{x:-E.scroll.offset.x,y:-E.scroll.offset.y}),jf(E.latestValues)&&Pg(m,E.latestValues)}return jf(this.latestValues)&&Pg(m,this.latestValues),m}removeTransform(d){const f=vi();Aa(f,d);for(let m=0;m<this.path.length;m++){const v=this.path[m];if(!v.instance||!jf(v.latestValues))continue;A2(v.latestValues)&&v.updateSnapshot();const E=vi(),S=v.measurePageBox();Aa(E,S),gQ(f,v.latestValues,v.snapshot?v.snapshot.layoutBox:void 0,E)}return jf(this.latestValues)&&gQ(f,this.latestValues),f}setTargetDelta(d){this.targetDelta=d,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(d){this.options={...this.options,...d,crossfade:d.crossfade!==void 0?d.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==so.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(d=!1){var f;const m=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=m.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=m.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=m.isSharedProjectionDirty);const v=!!this.resumingFrom||this!==m;if(!(d||v&&this.isSharedProjectionDirty||this.isProjectionDirty||!((f=this.parent)===null||f===void 0)&&f.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:S,layoutId:T}=this.options;if(!(!this.layout||!(S||T))){if(this.resolvedRelativeTargetAt=so.timestamp,!this.targetDelta&&!this.relativeTarget){const R=this.getClosestProjectingParent();R&&R.layout&&this.animationProgress!==1?(this.relativeParent=R,this.forceRelativeParentToResolveTarget(),this.relativeTarget=vi(),this.relativeTargetOrigin=vi(),XE(this.relativeTargetOrigin,this.layout.layoutBox,R.layout.layoutBox),Aa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=vi(),this.targetWithTransforms=vi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),p5e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Aa(this.target,this.layout.layoutBox),Yce(this.target,this.targetDelta)):Aa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const R=this.getClosestProjectingParent();R&&!!R.resumingFrom==!!this.resumingFrom&&!R.options.layoutScroll&&R.target&&this.animationProgress!==1?(this.relativeParent=R,this.forceRelativeParentToResolveTarget(),this.relativeTarget=vi(),this.relativeTargetOrigin=vi(),XE(this.relativeTargetOrigin,this.target,R.target),Aa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}OE&&Uf.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||A2(this.parent.latestValues)||zce(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var d;const f=this.getLead(),m=!!this.resumingFrom||this!==f;let v=!0;if((this.isProjectionDirty||!((d=this.parent)===null||d===void 0)&&d.isProjectionDirty)&&(v=!1),m&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(v=!1),this.resolvedRelativeTargetAt===so.timestamp&&(v=!1),v)return;const{layout:E,layoutId:S}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(E||S))return;Aa(this.layoutCorrected,this.layout.layoutBox);const T=this.treeScale.x,R=this.treeScale.y;w5e(this.layoutCorrected,this.treeScale,this.path,m),f.layout&&!f.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(f.target=f.layout.layoutBox,f.targetWithTransforms=vi());const{target:I}=f;if(!I){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(fQ(this.prevProjectionDelta.x,this.projectionDelta.x),fQ(this.prevProjectionDelta.y,this.projectionDelta.y)),qE(this.projectionDelta,this.layoutCorrected,I,this.latestValues),(this.treeScale.x!==T||this.treeScale.y!==R||!bQ(this.projectionDelta.x,this.prevProjectionDelta.x)||!bQ(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",I)),OE&&Uf.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(d=!0){var f;if((f=this.options.visualElement)===null||f===void 0||f.scheduleRender(),d){const m=this.getStack();m&&m.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Ig(),this.projectionDelta=Ig(),this.projectionDeltaWithTransform=Ig()}setAnimationOrigin(d,f=!1){const m=this.snapshot,v=m?m.latestValues:{},E={...this.latestValues},S=Ig();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!f;const T=vi(),R=m?m.source:void 0,I=this.layout?this.layout.source:void 0,O=R!==I,P=this.getStack(),D=!P||P.members.length<=1,k=!!(O&&!D&&this.options.crossfade===!0&&!this.path.some(c$e));this.animationProgress=0;let M;this.mixTargetDelta=$=>{const V=$/1e3;CQ(S.x,d.x,V),CQ(S.y,d.y,V),this.setTargetDelta(S),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(XE(T,this.layout.layoutBox,this.relativeParent.layout.layoutBox),a$e(this.relativeTarget,this.relativeTargetOrigin,T,V),M&&H5e(this.relativeTarget,M)&&(this.isProjectionDirty=!1),M||(M=vi()),Aa(M,this.relativeTarget)),O&&(this.animationValues=E,V5e(E,v,this.latestValues,V,k,D)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=V},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(d){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(wh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Lr.update(()=>{dR.hasAnimatedSinceResize=!0,this.currentAnimation=D5e(0,SQ,{...d,onUpdate:f=>{this.mixTargetDelta(f),d.onUpdate&&d.onUpdate(f)},onComplete:()=>{d.onComplete&&d.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const d=this.getStack();d&&d.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(SQ),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const d=this.getLead();let{targetWithTransforms:f,target:m,layout:v,latestValues:E}=d;if(!(!f||!m||!v)){if(this!==d&&this.layout&&v&&ile(this.options.animationType,this.layout.layoutBox,v.layoutBox)){m=this.target||vi();const S=Js(this.layout.layoutBox.x);m.x.min=d.target.x.min,m.x.max=m.x.min+S;const T=Js(this.layout.layoutBox.y);m.y.min=d.target.y.min,m.y.max=m.y.min+T}Aa(f,m),Pg(f,E),qE(this.projectionDeltaWithTransform,this.layoutCorrected,f,E)}}registerSharedNode(d,f){this.sharedNodes.has(d)||this.sharedNodes.set(d,new K5e),this.sharedNodes.get(d).add(f);const v=f.options.initialPromotionConfig;f.promote({transition:v?v.transition:void 0,preserveFollowOpacity:v&&v.shouldPreserveFollowOpacity?v.shouldPreserveFollowOpacity(f):void 0})}isLead(){const d=this.getStack();return d?d.lead===this:!0}getLead(){var d;const{layoutId:f}=this.options;return f?((d=this.getStack())===null||d===void 0?void 0:d.lead)||this:this}getPrevLead(){var d;const{layoutId:f}=this.options;return f?(d=this.getStack())===null||d===void 0?void 0:d.prevLead:void 0}getStack(){const{layoutId:d}=this.options;if(d)return this.root.sharedNodes.get(d)}promote({needsReset:d,transition:f,preserveFollowOpacity:m}={}){const v=this.getStack();v&&v.promote(this,m),d&&(this.projectionDelta=void 0,this.needsReset=!0),f&&this.setOptions({transition:f})}relegate(){const d=this.getStack();return d?d.relegate(this):!1}resetSkewAndRotation(){const{visualElement:d}=this.options;if(!d)return;let f=!1;const{latestValues:m}=d;if((m.z||m.rotate||m.rotateX||m.rotateY||m.rotateZ||m.skewX||m.skewY)&&(f=!0),!f)return;const v={};m.z&&sL("z",d,v,this.animationValues);for(let E=0;E<oL.length;E++)sL(`rotate${oL[E]}`,d,v,this.animationValues),sL(`skew${oL[E]}`,d,v,this.animationValues);d.render();for(const E in v)d.setStaticValue(E,v[E]),this.animationValues&&(this.animationValues[E]=v[E]);d.scheduleRender()}getProjectionStyles(d){var f,m;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Y5e;const v={visibility:""},E=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,v.opacity="",v.pointerEvents=lR(d==null?void 0:d.pointerEvents)||"",v.transform=E?E(this.latestValues,""):"none",v;const S=this.getLead();if(!this.projectionDelta||!this.layout||!S.target){const O={};return this.options.layoutId&&(O.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,O.pointerEvents=lR(d==null?void 0:d.pointerEvents)||""),this.hasProjected&&!jf(this.latestValues)&&(O.transform=E?E({},""):"none",this.hasProjected=!1),O}const T=S.animationValues||S.latestValues;this.applyTransformsToTarget(),v.transform=z5e(this.projectionDeltaWithTransform,this.treeScale,T),E&&(v.transform=E(T,v.transform));const{x:R,y:I}=this.projectionDelta;v.transformOrigin=`${R.origin*100}% ${I.origin*100}% 0`,S.animationValues?v.opacity=S===this?(m=(f=T.opacity)!==null&&f!==void 0?f:this.latestValues.opacity)!==null&&m!==void 0?m:1:this.preserveOpacity?this.latestValues.opacity:T.opacityExit:v.opacity=S===this?T.opacity!==void 0?T.opacity:"":T.opacityExit!==void 0?T.opacityExit:0;for(const O in YR){if(T[O]===void 0)continue;const{correct:P,applyTo:D}=YR[O],k=v.transform==="none"?T[O]:P(T[O],S);if(D){const M=D.length;for(let $=0;$<M;$++)v[D[$]]=k}else v[O]=k}return this.options.layoutId&&(v.pointerEvents=S===this?lR(d==null?void 0:d.pointerEvents)||"":"none"),v}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(d=>{var f;return(f=d.currentAnimation)===null||f===void 0?void 0:f.stop()}),this.root.nodes.forEach(wQ),this.root.sharedNodes.clear()}}}function X5e(e){e.updateLayout()}function J5e(e){var t;const n=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:a}=e.layout,{animationType:l}=e.options,d=n.source!==e.layout.source;l==="size"?xa(S=>{const T=d?n.measuredBox[S]:n.layoutBox[S],R=Js(T);T.min=i[S].min,T.max=T.min+R}):ile(l,n.layoutBox,i)&&xa(S=>{const T=d?n.measuredBox[S]:n.layoutBox[S],R=Js(i[S]);T.max=T.min+R,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[S].max=e.relativeTarget[S].min+R)});const f=Ig();qE(f,i,n.layoutBox);const m=Ig();d?qE(m,e.applyTransform(a,!0),n.measuredBox):qE(m,i,n.layoutBox);const v=!ele(f);let E=!1;if(!e.resumeFrom){const S=e.getClosestProjectingParent();if(S&&!S.resumeFrom){const{snapshot:T,layout:R}=S;if(T&&R){const I=vi();XE(I,n.layoutBox,T.layoutBox);const O=vi();XE(O,i,R.layoutBox),tle(I,O)||(E=!0),S.options.layoutRoot&&(e.relativeTarget=O,e.relativeTargetOrigin=I,e.relativeParent=S)}}}e.notifyListeners("didUpdate",{layout:i,snapshot:n,delta:m,layoutDelta:f,hasLayoutChanged:v,hasRelativeTargetChanged:E})}else if(e.isLead()){const{onExitComplete:i}=e.options;i&&i()}e.options.transition=void 0}function Q5e(e){OE&&Uf.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Z5e(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function e$e(e){e.clearSnapshot()}function wQ(e){e.clearMeasurements()}function t$e(e){e.isLayoutDirty=!1}function n$e(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function TQ(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function r$e(e){e.resolveTargetDelta()}function i$e(e){e.calcProjection()}function o$e(e){e.resetSkewAndRotation()}function s$e(e){e.removeLeadSnapshot()}function CQ(e,t,n){e.translate=Qr(t.translate,0,n),e.scale=Qr(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function RQ(e,t,n,i){e.min=Qr(t.min,n.min,i),e.max=Qr(t.max,n.max,i)}function a$e(e,t,n,i){RQ(e.x,t.x,n.x,i),RQ(e.y,t.y,n.y,i)}function c$e(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const l$e={duration:.45,ease:[.4,0,.1,1]},AQ=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),OQ=AQ("applewebkit/")&&!AQ("chrome/")?Math.round:Ys;function IQ(e){e.min=OQ(e.min),e.max=OQ(e.max)}function u$e(e){IQ(e.x),IQ(e.y)}function ile(e,t,n){return e==="position"||e==="preserve-aspect"&&!f5e(EQ(t),EQ(n),.2)}function d$e(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const h$e=rle({attachResizeListener:(e,t)=>kb(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),aL={current:void 0},ole=rle({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!aL.current){const e=new h$e({});e.mount(window),e.setOptions({layoutScroll:!0}),aL.current=e}return aL.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),f$e={pan:{Feature:I5e},drag:{Feature:O5e,ProjectionNode:ole,MeasureLayout:Jce}};function xQ(e,t,n){const{props:i}=e;e.animationState&&i.whileHover&&e.animationState.setActive("whileHover",n==="Start");const a="onHover"+n,l=i[a];l&&Lr.postRender(()=>l(t,MS(t)))}class p$e extends xh{mount(){const{current:t}=this.node;t&&(this.unmount=m3e(t,n=>(xQ(this.node,n,"Start"),i=>xQ(this.node,i,"End"))))}unmount(){}}class m$e extends xh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=LS(kb(this.node.current,"focus",()=>this.onFocus()),kb(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function PQ(e,t,n){const{props:i}=e;e.animationState&&i.whileTap&&e.animationState.setActive("whileTap",n==="Start");const a="onTap"+(n==="End"?"":n),l=i[a];l&&Lr.postRender(()=>l(t,MS(t)))}class g$e extends xh{mount(){const{current:t}=this.node;t&&(this.unmount=_3e(t,n=>(PQ(this.node,n,"Start"),(i,{success:a})=>PQ(this.node,i,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const I2=new WeakMap,cL=new WeakMap,v$e=e=>{const t=I2.get(e.target);t&&t(e)},y$e=e=>{e.forEach(v$e)};function _$e({root:e,...t}){const n=e||document;cL.has(n)||cL.set(n,{});const i=cL.get(n),a=JSON.stringify(t);return i[a]||(i[a]=new IntersectionObserver(y$e,{root:e,...t})),i[a]}function E$e(e,t,n){const i=_$e(t);return I2.set(e,n),i.observe(e),()=>{I2.delete(e),i.unobserve(e)}}const b$e={some:0,all:1};class S$e extends xh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:i,amount:a="some",once:l}=t,d={root:n?n.current:void 0,rootMargin:i,threshold:typeof a=="number"?a:b$e[a]},f=m=>{const{isIntersecting:v}=m;if(this.isInView===v||(this.isInView=v,l&&!v&&this.hasEnteredView))return;v&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",v);const{onViewportEnter:E,onViewportLeave:S}=this.node.getProps(),T=v?E:S;T&&T(m)};return E$e(this.node.current,d,f)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(w$e(t,n))&&this.startObserver()}unmount(){}}function w$e({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const T$e={inView:{Feature:S$e},tap:{Feature:g$e},focus:{Feature:m$e},hover:{Feature:p$e}},C$e={layout:{ProjectionNode:ole,MeasureLayout:Jce}},x2={current:null},sle={current:!1};function R$e(){if(sle.current=!0,!!KV)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>x2.current=e.matches;e.addListener(t),t()}else x2.current=!1}const A$e=[...xce,bo,Th],O$e=e=>A$e.find(Ice(e)),NQ=new WeakMap;function I$e(e,t,n){for(const i in t){const a=t[i],l=n[i];if(Co(a))e.addValue(i,a);else if(Co(l))e.addValue(i,Nb(a,{owner:e}));else if(l!==a)if(e.hasValue(i)){const d=e.getValue(i);d.liveStyle===!0?d.jump(a):d.hasAnimated||d.set(a)}else{const d=e.getStaticValue(i);e.addValue(i,Nb(d!==void 0?d:a,{owner:e}))}}for(const i in n)t[i]===void 0&&e.removeValue(i);return t}const DQ=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class x$e{scrapeMotionValuesFromProps(t,n,i){return{}}constructor({parent:t,props:n,presenceContext:i,reducedMotionConfig:a,blockInitialAnimation:l,visualState:d},f={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=bF,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const R=Al.now();this.renderScheduledAt<R&&(this.renderScheduledAt=R,Lr.render(this.render,!1,!0))};const{latestValues:m,renderState:v,onUpdate:E}=d;this.onUpdate=E,this.latestValues=m,this.baseTarget={...m},this.initialValues=n.initial?{...m}:{},this.renderState=v,this.parent=t,this.props=n,this.presenceContext=i,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=f,this.blockInitialAnimation=!!l,this.isControllingVariants=zO(n),this.isVariantNode=jae(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:S,...T}=this.scrapeMotionValuesFromProps(n,{},this);for(const R in T){const I=T[R];m[R]!==void 0&&Co(I)&&I.set(m[R],!1)}}mount(t){this.current=t,NQ.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,i)=>this.bindToMotionValue(i,n)),sle.current||R$e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:x2.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){NQ.delete(this.current),this.projection&&this.projection.unmount(),wh(this.notifyUpdate),wh(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const i=Pp.has(t),a=n.on("change",f=>{this.latestValues[t]=f,this.props.onUpdate&&Lr.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),l=n.on("renderRequest",this.scheduleRender);let d;window.MotionCheckAppearSync&&(d=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{a(),l(),d&&d(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in vv){const n=vv[t];if(!n)continue;const{isEnabled:i,Feature:a}=n;if(!this.features[t]&&a&&i(this.props)&&(this.features[t]=new a(this)),this.features[t]){const l=this.features[t];l.isMounted?l.update():(l.mount(),l.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):vi()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let i=0;i<DQ.length;i++){const a=DQ[i];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const l="on"+a,d=t[l];d&&(this.propEventSubscriptions[a]=this.on(a,d))}this.prevMotionValues=I$e(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const i=this.values.get(t);n!==i&&(i&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let i=this.values.get(t);return i===void 0&&n!==void 0&&(i=Nb(n===null?void 0:n,{owner:this}),this.addValue(t,i)),i}readValue(t,n){var i;let a=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(i=this.getBaseTargetFromProps(this.props,t))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,t,this.options);return a!=null&&(typeof a=="string"&&(Ace(a)||yce(a))?a=parseFloat(a):!O$e(a)&&Th.test(n)&&(a=Tce(t,n)),this.setBaseTarget(t,Co(a)?a.get():a)),Co(a)?a.get():a}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var n;const{initial:i}=this.props;let a;if(typeof i=="string"||typeof i=="object"){const d=eF(this.props,i,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);d&&(a=d[t])}if(i&&a!==void 0)return a;const l=this.getBaseTargetFromProps(this.props,t);return l!==void 0&&!Co(l)?l:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new pF),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}class ale extends x$e{constructor(){super(...arguments),this.KeyframeResolver=Pce}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:i}){delete n[t],delete i[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Co(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function P$e(e){return window.getComputedStyle(e)}class N$e extends ale{constructor(){super(...arguments),this.type="html",this.renderInstance=Kae}readValueFromInstance(t,n){if(Pp.has(n)){const i=EF(n);return i&&i.default||0}else{const i=P$e(t),a=(Wae(n)?i.getPropertyValue(n):i[n])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:n}){return qce(t,n)}build(t,n,i){rF(t,n,i.transformTemplate)}scrapeMotionValuesFromProps(t,n,i){return aF(t,n,i)}}class D$e extends ale{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=vi}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(Pp.has(n)){const i=EF(n);return i&&i.default||0}return n=zae.has(n)?n:JV(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,i){return Xae(t,n,i)}build(t,n,i){iF(t,n,this.isSVGTag,i.transformTemplate)}renderInstance(t,n,i,a){Yae(t,n,i,a)}mount(t){this.isSVGTag=sF(t.tagName),super.mount(t)}}const k$e=(e,t)=>ZV(e)?new D$e(t):new N$e(t,{allowProjection:e!==N.Fragment}),L$e=l3e({...i5e,...T$e,...f$e,...C$e},k$e),Vn=TBe(L$e);function M$e(e){e.values.forEach(t=>t.stop())}function P2(e,t){[...t].reverse().forEach(i=>{const a=e.getVariant(i);a&&mF(e,a),e.variantChildren&&e.variantChildren.forEach(l=>{P2(l,t)})})}function j$e(e,t){if(Array.isArray(t))return P2(e,t);if(typeof t=="string")return P2(e,[t]);mF(e,t)}function U$e(){const e=new Set,t={subscribe(n){return e.add(n),()=>void e.delete(n)},start(n,i){const a=[];return e.forEach(l=>{a.push(Fce(l,n,{transitionOverride:i}))}),Promise.all(a)},set(n){return e.forEach(i=>{j$e(i,n)})},stop(){e.forEach(n=>{M$e(n)})},mount(){return()=>{t.stop()}}};return t}function V$e(){const e=WO(U$e);return zV(e.mount,[]),e}const F$e=V$e,B$e={some:0,all:1};function $$e(e,t,{root:n,margin:i,amount:a="some"}={}){const l=ice(e),d=new WeakMap,f=v=>{v.forEach(E=>{const S=d.get(E.target);if(E.isIntersecting!==!!S)if(E.isIntersecting){const T=t(E);typeof T=="function"?d.set(E.target,T):m.unobserve(E.target)}else typeof S=="function"&&(S(E),d.delete(E.target))})},m=new IntersectionObserver(f,{root:n,rootMargin:i,threshold:typeof a=="number"?a:B$e[a]});return l.forEach(v=>m.observe(v)),()=>m.disconnect()}function W$e(e,{root:t,margin:n,amount:i,once:a=!1}={}){const[l,d]=N.useState(!1);return N.useEffect(()=>{if(!e.current||a&&l)return;const f=()=>(d(!0),a?void 0:()=>d(!1)),m={root:t&&t.current||void 0,margin:n,amount:i};return $$e(e.current,f,m)},[t,e,n,a,i]),l}const N2=vV("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),vn=N.forwardRef(({className:e,variant:t,size:n,asChild:i=!1,...a},l)=>{const d=i?kke:"button";return _.jsx(d,{className:gt(N2({variant:t,size:n,className:e})),ref:l,...a})});vn.displayName="Button";const Fr=N.forwardRef(({children:e,scale:t=1.05,tapScale:n=.95,hoverScale:i=1.05,transitionDuration:a=.2,className:l="",...d},f)=>_.jsx(Vn.div,{whileHover:{scale:i},whileTap:{scale:n},transition:{type:"spring",stiffness:400,damping:17,duration:a},className:"inline-block",children:_.jsx(vn,{ref:f,className:l,...d,children:e})}));Fr.displayName="AnimatedButton";const G$e=e=>N.createElement("svg",{width:48,height:48,viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},N.createElement("circle",{cx:24,cy:24,r:22,stroke:"#6366F1",strokeWidth:4,fill:"#EEF2FF"}),N.createElement("text",{x:"50%",y:"54%",textAnchor:"middle",fill:"#6366F1",fontSize:16,fontFamily:"Arial, Helvetica, sans-serif",dy:".3em"},"CA"));var H$e=N.createContext(void 0);function jS(e){const t=N.useContext(H$e);return e||t||"ltr"}var lL=0;function CF(){N.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??kQ()),document.body.insertAdjacentElement("beforeend",e[1]??kQ()),lL++,()=>{lL===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),lL--}},[])}function kQ(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var uL="focusScope.autoFocusOnMount",dL="focusScope.autoFocusOnUnmount",LQ={bubbles:!1,cancelable:!0},K$e="FocusScope",XO=N.forwardRef((e,t)=>{const{loop:n=!1,trapped:i=!1,onMountAutoFocus:a,onUnmountAutoFocus:l,...d}=e,[f,m]=N.useState(null),v=hi(a),E=hi(l),S=N.useRef(null),T=fn(t,O=>m(O)),R=N.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;N.useEffect(()=>{if(i){let O=function(M){if(R.paused||!f)return;const $=M.target;f.contains($)?S.current=$:Vd(S.current,{select:!0})},P=function(M){if(R.paused||!f)return;const $=M.relatedTarget;$!==null&&(f.contains($)||Vd(S.current,{select:!0}))},D=function(M){if(document.activeElement===document.body)for(const V of M)V.removedNodes.length>0&&Vd(f)};document.addEventListener("focusin",O),document.addEventListener("focusout",P);const k=new MutationObserver(D);return f&&k.observe(f,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",O),document.removeEventListener("focusout",P),k.disconnect()}}},[i,f,R.paused]),N.useEffect(()=>{if(f){jQ.add(R);const O=document.activeElement;if(!f.contains(O)){const D=new CustomEvent(uL,LQ);f.addEventListener(uL,v),f.dispatchEvent(D),D.defaultPrevented||(z$e(Q$e(cle(f)),{select:!0}),document.activeElement===O&&Vd(f))}return()=>{f.removeEventListener(uL,v),setTimeout(()=>{const D=new CustomEvent(dL,LQ);f.addEventListener(dL,E),f.dispatchEvent(D),D.defaultPrevented||Vd(O??document.body,{select:!0}),f.removeEventListener(dL,E),jQ.remove(R)},0)}}},[f,v,E,R]);const I=N.useCallback(O=>{if(!n&&!i||R.paused)return;const P=O.key==="Tab"&&!O.altKey&&!O.ctrlKey&&!O.metaKey,D=document.activeElement;if(P&&D){const k=O.currentTarget,[M,$]=Y$e(k);M&&$?!O.shiftKey&&D===$?(O.preventDefault(),n&&Vd(M,{select:!0})):O.shiftKey&&D===M&&(O.preventDefault(),n&&Vd($,{select:!0})):D===k&&O.preventDefault()}},[n,i,R.paused]);return _.jsx(yt.div,{tabIndex:-1,...d,ref:T,onKeyDown:I})});XO.displayName=K$e;function z$e(e,{select:t=!1}={}){const n=document.activeElement;for(const i of e)if(Vd(i,{select:t}),document.activeElement!==n)return}function Y$e(e){const t=cle(e),n=MQ(t,e),i=MQ(t.reverse(),e);return[n,i]}function cle(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:i=>{const a=i.tagName==="INPUT"&&i.type==="hidden";return i.disabled||i.hidden||a?NodeFilter.FILTER_SKIP:i.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function MQ(e,t){for(const n of e)if(!q$e(n,{upTo:t}))return n}function q$e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function X$e(e){return e instanceof HTMLInputElement&&"select"in e}function Vd(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&X$e(e)&&t&&e.select()}}var jQ=J$e();function J$e(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=UQ(e,t),e.unshift(t)},remove(t){var n;e=UQ(e,t),(n=e[0])==null||n.resume()}}}function UQ(e,t){const n=[...e],i=n.indexOf(t);return i!==-1&&n.splice(i,1),n}function Q$e(e){return e.filter(t=>t.tagName!=="A")}var hL="rovingFocusGroup.onEntryFocus",Z$e={bubbles:!1,cancelable:!0},US="RovingFocusGroup",[D2,lle,eWe]=wO(US),[tWe,JO]=ta(US,[eWe]),[nWe,rWe]=tWe(US),ule=N.forwardRef((e,t)=>_.jsx(D2.Provider,{scope:e.__scopeRovingFocusGroup,children:_.jsx(D2.Slot,{scope:e.__scopeRovingFocusGroup,children:_.jsx(iWe,{...e,ref:t})})}));ule.displayName=US;var iWe=N.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:i,loop:a=!1,dir:l,currentTabStopId:d,defaultCurrentTabStopId:f,onCurrentTabStopIdChange:m,onEntryFocus:v,preventScrollOnEntryFocus:E=!1,...S}=e,T=N.useRef(null),R=fn(t,T),I=jS(l),[O,P]=Eh({prop:d,defaultProp:f??null,onChange:m,caller:US}),[D,k]=N.useState(!1),M=hi(v),$=lle(n),V=N.useRef(!1),[W,H]=N.useState(0);return N.useEffect(()=>{const J=T.current;if(J)return J.addEventListener(hL,M),()=>J.removeEventListener(hL,M)},[M]),_.jsx(nWe,{scope:n,orientation:i,dir:I,loop:a,currentTabStopId:O,onItemFocus:N.useCallback(J=>P(J),[P]),onItemShiftTab:N.useCallback(()=>k(!0),[]),onFocusableItemAdd:N.useCallback(()=>H(J=>J+1),[]),onFocusableItemRemove:N.useCallback(()=>H(J=>J-1),[]),children:_.jsx(yt.div,{tabIndex:D||W===0?-1:0,"data-orientation":i,...S,ref:R,style:{outline:"none",...e.style},onMouseDown:et(e.onMouseDown,()=>{V.current=!0}),onFocus:et(e.onFocus,J=>{const ee=!V.current;if(J.target===J.currentTarget&&ee&&!D){const le=new CustomEvent(hL,Z$e);if(J.currentTarget.dispatchEvent(le),!le.defaultPrevented){const he=$().filter(ye=>ye.focusable),de=he.find(ye=>ye.active),ae=he.find(ye=>ye.id===O),ge=[de,ae,...he].filter(Boolean).map(ye=>ye.ref.current);fle(ge,E)}}V.current=!1}),onBlur:et(e.onBlur,()=>k(!1))})})}),dle="RovingFocusGroupItem",hle=N.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:i=!0,active:a=!1,tabStopId:l,children:d,...f}=e,m=Tl(),v=l||m,E=rWe(dle,n),S=E.currentTabStopId===v,T=lle(n),{onFocusableItemAdd:R,onFocusableItemRemove:I,currentTabStopId:O}=E;return N.useEffect(()=>{if(i)return R(),()=>I()},[i,R,I]),_.jsx(D2.ItemSlot,{scope:n,id:v,focusable:i,active:a,children:_.jsx(yt.span,{tabIndex:S?0:-1,"data-orientation":E.orientation,...f,ref:t,onMouseDown:et(e.onMouseDown,P=>{i?E.onItemFocus(v):P.preventDefault()}),onFocus:et(e.onFocus,()=>E.onItemFocus(v)),onKeyDown:et(e.onKeyDown,P=>{if(P.key==="Tab"&&P.shiftKey){E.onItemShiftTab();return}if(P.target!==P.currentTarget)return;const D=aWe(P,E.orientation,E.dir);if(D!==void 0){if(P.metaKey||P.ctrlKey||P.altKey||P.shiftKey)return;P.preventDefault();let M=T().filter($=>$.focusable).map($=>$.ref.current);if(D==="last")M.reverse();else if(D==="prev"||D==="next"){D==="prev"&&M.reverse();const $=M.indexOf(P.currentTarget);M=E.loop?cWe(M,$+1):M.slice($+1)}setTimeout(()=>fle(M))}}),children:typeof d=="function"?d({isCurrentTabStop:S,hasTabStop:O!=null}):d})})});hle.displayName=dle;var oWe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function sWe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function aWe(e,t,n){const i=sWe(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(i))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(i)))return oWe[i]}function fle(e,t=!1){const n=document.activeElement;for(const i of e)if(i===n||(i.focus({preventScroll:t}),document.activeElement!==n))return}function cWe(e,t){return e.map((n,i)=>e[(t+i)%e.length])}var ple=ule,mle=hle,lWe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},ig=new WeakMap,xC=new WeakMap,PC={},fL=0,gle=function(e){return e&&(e.host||gle(e.parentNode))},uWe=function(e,t){return t.map(function(n){if(e.contains(n))return n;var i=gle(n);return i&&e.contains(i)?i:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},dWe=function(e,t,n,i){var a=uWe(t,Array.isArray(e)?e:[e]);PC[n]||(PC[n]=new WeakMap);var l=PC[n],d=[],f=new Set,m=new Set(a),v=function(S){!S||f.has(S)||(f.add(S),v(S.parentNode))};a.forEach(v);var E=function(S){!S||m.has(S)||Array.prototype.forEach.call(S.children,function(T){if(f.has(T))E(T);else try{var R=T.getAttribute(i),I=R!==null&&R!=="false",O=(ig.get(T)||0)+1,P=(l.get(T)||0)+1;ig.set(T,O),l.set(T,P),d.push(T),O===1&&I&&xC.set(T,!0),P===1&&T.setAttribute(n,"true"),I||T.setAttribute(i,"true")}catch(D){console.error("aria-hidden: cannot operate on ",T,D)}})};return E(t),f.clear(),fL++,function(){d.forEach(function(S){var T=ig.get(S)-1,R=l.get(S)-1;ig.set(S,T),l.set(S,R),T||(xC.has(S)||S.removeAttribute(i),xC.delete(S)),R||S.removeAttribute(n)}),fL--,fL||(ig=new WeakMap,ig=new WeakMap,xC=new WeakMap,PC={})}},RF=function(e,t,n){n===void 0&&(n="data-aria-hidden");var i=Array.from(Array.isArray(e)?e:[e]),a=lWe(e);return a?(i.push.apply(i,Array.from(a.querySelectorAll("[aria-live], script"))),dWe(i,a,n,"aria-hidden")):function(){return null}},vl=function(){return vl=Object.assign||function(t){for(var n,i=1,a=arguments.length;i<a;i++){n=arguments[i];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},vl.apply(this,arguments)};function vle(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]]);return n}function hWe(e,t,n){if(n||arguments.length===2)for(var i=0,a=t.length,l;i<a;i++)(l||!(i in t))&&(l||(l=Array.prototype.slice.call(t,0,i)),l[i]=t[i]);return e.concat(l||Array.prototype.slice.call(t))}var hR="right-scroll-bar-position",fR="width-before-scroll-bar",fWe="with-scroll-bars-hidden",pWe="--removed-body-scroll-bar-size";function pL(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function mWe(e,t){var n=N.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(i){var a=n.value;a!==i&&(n.value=i,n.callback(i,a))}}}})[0];return n.callback=t,n.facade}var gWe=typeof window<"u"?N.useLayoutEffect:N.useEffect,VQ=new WeakMap;function vWe(e,t){var n=mWe(null,function(i){return e.forEach(function(a){return pL(a,i)})});return gWe(function(){var i=VQ.get(n);if(i){var a=new Set(i),l=new Set(e),d=n.current;a.forEach(function(f){l.has(f)||pL(f,null)}),l.forEach(function(f){a.has(f)||pL(f,d)})}VQ.set(n,e)},[e]),n}function yWe(e){return e}function _We(e,t){t===void 0&&(t=yWe);var n=[],i=!1,a={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(l){var d=t(l,i);return n.push(d),function(){n=n.filter(function(f){return f!==d})}},assignSyncMedium:function(l){for(i=!0;n.length;){var d=n;n=[],d.forEach(l)}n={push:function(f){return l(f)},filter:function(){return n}}},assignMedium:function(l){i=!0;var d=[];if(n.length){var f=n;n=[],f.forEach(l),d=n}var m=function(){var E=d;d=[],E.forEach(l)},v=function(){return Promise.resolve().then(m)};v(),n={push:function(E){d.push(E),v()},filter:function(E){return d=d.filter(E),n}}}};return a}function EWe(e){e===void 0&&(e={});var t=_We(null);return t.options=vl({async:!0,ssr:!1},e),t}var yle=function(e){var t=e.sideCar,n=vle(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var i=t.read();if(!i)throw new Error("Sidecar medium not found");return N.createElement(i,vl({},n))};yle.isSideCarExport=!0;function bWe(e,t){return e.useMedium(t),yle}var _le=EWe(),mL=function(){},QO=N.forwardRef(function(e,t){var n=N.useRef(null),i=N.useState({onScrollCapture:mL,onWheelCapture:mL,onTouchMoveCapture:mL}),a=i[0],l=i[1],d=e.forwardProps,f=e.children,m=e.className,v=e.removeScrollBar,E=e.enabled,S=e.shards,T=e.sideCar,R=e.noRelative,I=e.noIsolation,O=e.inert,P=e.allowPinchZoom,D=e.as,k=D===void 0?"div":D,M=e.gapMode,$=vle(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),V=T,W=vWe([n,t]),H=vl(vl({},$),a);return N.createElement(N.Fragment,null,E&&N.createElement(V,{sideCar:_le,removeScrollBar:v,shards:S,noRelative:R,noIsolation:I,inert:O,setCallbacks:l,allowPinchZoom:!!P,lockRef:n,gapMode:M}),d?N.cloneElement(N.Children.only(f),vl(vl({},H),{ref:W})):N.createElement(k,vl({},H,{className:m,ref:W}),f))});QO.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};QO.classNames={fullWidth:fR,zeroRight:hR};var SWe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function wWe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=SWe();return t&&e.setAttribute("nonce",t),e}function TWe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function CWe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var RWe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=wWe())&&(TWe(t,n),CWe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},AWe=function(){var e=RWe();return function(t,n){N.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Ele=function(){var e=AWe(),t=function(n){var i=n.styles,a=n.dynamic;return e(i,a),null};return t},OWe={left:0,top:0,right:0,gap:0},gL=function(e){return parseInt(e||"",10)||0},IWe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],i=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[gL(n),gL(i),gL(a)]},xWe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return OWe;var t=IWe(e),n=document.documentElement.clientWidth,i=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,i-n+t[2]-t[0])}},PWe=Ele(),Kg="data-scroll-locked",NWe=function(e,t,n,i){var a=e.left,l=e.top,d=e.right,f=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(fWe,` {
   overflow: hidden `).concat(i,`;
   padding-right: `).concat(f,"px ").concat(i,`;
  }
  body[`).concat(Kg,`] {
    overflow: hidden `).concat(i,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(i,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(l,`px;
    padding-right: `).concat(d,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(f,"px ").concat(i,`;
    `),n==="padding"&&"padding-right: ".concat(f,"px ").concat(i,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(hR,` {
    right: `).concat(f,"px ").concat(i,`;
  }
  
  .`).concat(fR,` {
    margin-right: `).concat(f,"px ").concat(i,`;
  }
  
  .`).concat(hR," .").concat(hR,` {
    right: 0 `).concat(i,`;
  }
  
  .`).concat(fR," .").concat(fR,` {
    margin-right: 0 `).concat(i,`;
  }
  
  body[`).concat(Kg,`] {
    `).concat(pWe,": ").concat(f,`px;
  }
`)},FQ=function(){var e=parseInt(document.body.getAttribute(Kg)||"0",10);return isFinite(e)?e:0},DWe=function(){N.useEffect(function(){return document.body.setAttribute(Kg,(FQ()+1).toString()),function(){var e=FQ()-1;e<=0?document.body.removeAttribute(Kg):document.body.setAttribute(Kg,e.toString())}},[])},kWe=function(e){var t=e.noRelative,n=e.noImportant,i=e.gapMode,a=i===void 0?"margin":i;DWe();var l=N.useMemo(function(){return xWe(a)},[a]);return N.createElement(PWe,{styles:NWe(l,!t,a,n?"":"!important")})},k2=!1;if(typeof window<"u")try{var NC=Object.defineProperty({},"passive",{get:function(){return k2=!0,!0}});window.addEventListener("test",NC,NC),window.removeEventListener("test",NC,NC)}catch{k2=!1}var og=k2?{passive:!1}:!1,LWe=function(e){return e.tagName==="TEXTAREA"},ble=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!LWe(e)&&n[t]==="visible")},MWe=function(e){return ble(e,"overflowY")},jWe=function(e){return ble(e,"overflowX")},BQ=function(e,t){var n=t.ownerDocument,i=t;do{typeof ShadowRoot<"u"&&i instanceof ShadowRoot&&(i=i.host);var a=Sle(e,i);if(a){var l=wle(e,i),d=l[1],f=l[2];if(d>f)return!0}i=i.parentNode}while(i&&i!==n.body);return!1},UWe=function(e){var t=e.scrollTop,n=e.scrollHeight,i=e.clientHeight;return[t,n,i]},VWe=function(e){var t=e.scrollLeft,n=e.scrollWidth,i=e.clientWidth;return[t,n,i]},Sle=function(e,t){return e==="v"?MWe(t):jWe(t)},wle=function(e,t){return e==="v"?UWe(t):VWe(t)},FWe=function(e,t){return e==="h"&&t==="rtl"?-1:1},BWe=function(e,t,n,i,a){var l=FWe(e,window.getComputedStyle(t).direction),d=l*i,f=n.target,m=t.contains(f),v=!1,E=d>0,S=0,T=0;do{var R=wle(e,f),I=R[0],O=R[1],P=R[2],D=O-P-l*I;(I||D)&&Sle(e,f)&&(S+=D,T+=I),f=f.parentNode.host||f.parentNode}while(!m&&f!==document.body||m&&(t.contains(f)||t===f));return(E&&Math.abs(S)<1||!E&&Math.abs(T)<1)&&(v=!0),v},DC=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},$Q=function(e){return[e.deltaX,e.deltaY]},WQ=function(e){return e&&"current"in e?e.current:e},$We=function(e,t){return e[0]===t[0]&&e[1]===t[1]},WWe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},GWe=0,sg=[];function HWe(e){var t=N.useRef([]),n=N.useRef([0,0]),i=N.useRef(),a=N.useState(GWe++)[0],l=N.useState(Ele)[0],d=N.useRef(e);N.useEffect(function(){d.current=e},[e]),N.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var O=hWe([e.lockRef.current],(e.shards||[]).map(WQ),!0).filter(Boolean);return O.forEach(function(P){return P.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),O.forEach(function(P){return P.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var f=N.useCallback(function(O,P){if("touches"in O&&O.touches.length===2||O.type==="wheel"&&O.ctrlKey)return!d.current.allowPinchZoom;var D=DC(O),k=n.current,M="deltaX"in O?O.deltaX:k[0]-D[0],$="deltaY"in O?O.deltaY:k[1]-D[1],V,W=O.target,H=Math.abs(M)>Math.abs($)?"h":"v";if("touches"in O&&H==="h"&&W.type==="range")return!1;var J=BQ(H,W);if(!J)return!0;if(J?V=H:(V=H==="v"?"h":"v",J=BQ(H,W)),!J)return!1;if(!i.current&&"changedTouches"in O&&(M||$)&&(i.current=V),!V)return!0;var ee=i.current||V;return BWe(ee,P,O,ee==="h"?M:$)},[]),m=N.useCallback(function(O){var P=O;if(!(!sg.length||sg[sg.length-1]!==l)){var D="deltaY"in P?$Q(P):DC(P),k=t.current.filter(function(V){return V.name===P.type&&(V.target===P.target||P.target===V.shadowParent)&&$We(V.delta,D)})[0];if(k&&k.should){P.cancelable&&P.preventDefault();return}if(!k){var M=(d.current.shards||[]).map(WQ).filter(Boolean).filter(function(V){return V.contains(P.target)}),$=M.length>0?f(P,M[0]):!d.current.noIsolation;$&&P.cancelable&&P.preventDefault()}}},[]),v=N.useCallback(function(O,P,D,k){var M={name:O,delta:P,target:D,should:k,shadowParent:KWe(D)};t.current.push(M),setTimeout(function(){t.current=t.current.filter(function($){return $!==M})},1)},[]),E=N.useCallback(function(O){n.current=DC(O),i.current=void 0},[]),S=N.useCallback(function(O){v(O.type,$Q(O),O.target,f(O,e.lockRef.current))},[]),T=N.useCallback(function(O){v(O.type,DC(O),O.target,f(O,e.lockRef.current))},[]);N.useEffect(function(){return sg.push(l),e.setCallbacks({onScrollCapture:S,onWheelCapture:S,onTouchMoveCapture:T}),document.addEventListener("wheel",m,og),document.addEventListener("touchmove",m,og),document.addEventListener("touchstart",E,og),function(){sg=sg.filter(function(O){return O!==l}),document.removeEventListener("wheel",m,og),document.removeEventListener("touchmove",m,og),document.removeEventListener("touchstart",E,og)}},[]);var R=e.removeScrollBar,I=e.inert;return N.createElement(N.Fragment,null,I?N.createElement(l,{styles:WWe(a)}):null,R?N.createElement(kWe,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function KWe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const zWe=bWe(_le,HWe);var ZO=N.forwardRef(function(e,t){return N.createElement(QO,vl({},e,{ref:t,sideCar:zWe}))});ZO.classNames=QO.classNames;var L2=["Enter"," "],YWe=["ArrowDown","PageUp","Home"],Tle=["ArrowUp","PageDown","End"],qWe=[...YWe,...Tle],XWe={ltr:[...L2,"ArrowRight"],rtl:[...L2,"ArrowLeft"]},JWe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},VS="Menu",[Lb,QWe,ZWe]=wO(VS),[Np,Cle]=ta(VS,[ZWe,Zv,JO]),eI=Zv(),Rle=JO(),[e6e,Dp]=Np(VS),[t6e,FS]=Np(VS),Ale=e=>{const{__scopeMenu:t,open:n=!1,children:i,dir:a,onOpenChange:l,modal:d=!0}=e,f=eI(t),[m,v]=N.useState(null),E=N.useRef(!1),S=hi(l),T=jS(a);return N.useEffect(()=>{const R=()=>{E.current=!0,document.addEventListener("pointerdown",I,{capture:!0,once:!0}),document.addEventListener("pointermove",I,{capture:!0,once:!0})},I=()=>E.current=!1;return document.addEventListener("keydown",R,{capture:!0}),()=>{document.removeEventListener("keydown",R,{capture:!0}),document.removeEventListener("pointerdown",I,{capture:!0}),document.removeEventListener("pointermove",I,{capture:!0})}},[]),_.jsx(Dse,{...f,children:_.jsx(e6e,{scope:t,open:n,onOpenChange:S,content:m,onContentChange:v,children:_.jsx(t6e,{scope:t,onClose:N.useCallback(()=>S(!1),[S]),isUsingKeyboardRef:E,dir:T,modal:d,children:i})})})};Ale.displayName=VS;var n6e="MenuAnchor",AF=N.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e,a=eI(n);return _.jsx(IV,{...a,...i,ref:t})});AF.displayName=n6e;var OF="MenuPortal",[r6e,Ole]=Np(OF,{forceMount:void 0}),Ile=e=>{const{__scopeMenu:t,forceMount:n,children:i,container:a}=e,l=Dp(OF,t);return _.jsx(r6e,{scope:t,forceMount:n,children:_.jsx(Ao,{present:n||l.open,children:_.jsx(AS,{asChild:!0,container:a,children:i})})})};Ile.displayName=OF;var Fa="MenuContent",[i6e,IF]=Np(Fa),xle=N.forwardRef((e,t)=>{const n=Ole(Fa,e.__scopeMenu),{forceMount:i=n.forceMount,...a}=e,l=Dp(Fa,e.__scopeMenu),d=FS(Fa,e.__scopeMenu);return _.jsx(Lb.Provider,{scope:e.__scopeMenu,children:_.jsx(Ao,{present:i||l.open,children:_.jsx(Lb.Slot,{scope:e.__scopeMenu,children:d.modal?_.jsx(o6e,{...a,ref:t}):_.jsx(s6e,{...a,ref:t})})})})}),o6e=N.forwardRef((e,t)=>{const n=Dp(Fa,e.__scopeMenu),i=N.useRef(null),a=fn(t,i);return N.useEffect(()=>{const l=i.current;if(l)return RF(l)},[]),_.jsx(xF,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:et(e.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),s6e=N.forwardRef((e,t)=>{const n=Dp(Fa,e.__scopeMenu);return _.jsx(xF,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),a6e=gp("MenuContent.ScrollLock"),xF=N.forwardRef((e,t)=>{const{__scopeMenu:n,loop:i=!1,trapFocus:a,onOpenAutoFocus:l,onCloseAutoFocus:d,disableOutsidePointerEvents:f,onEntryFocus:m,onEscapeKeyDown:v,onPointerDownOutside:E,onFocusOutside:S,onInteractOutside:T,onDismiss:R,disableOutsideScroll:I,...O}=e,P=Dp(Fa,n),D=FS(Fa,n),k=eI(n),M=Rle(n),$=QWe(n),[V,W]=N.useState(null),H=N.useRef(null),J=fn(t,H,P.onContentChange),ee=N.useRef(0),le=N.useRef(""),he=N.useRef(0),de=N.useRef(null),ae=N.useRef("right"),ce=N.useRef(0),ge=I?ZO:N.Fragment,ye=I?{as:a6e,allowPinchZoom:!0}:void 0,te=ue=>{var ze,Nt;const _e=le.current+ue,Ce=$().filter(we=>!we.disabled),Ie=document.activeElement,Ge=(ze=Ce.find(we=>we.ref.current===Ie))==null?void 0:ze.textValue,Ze=Ce.map(we=>we.textValue),wt=_6e(Ze,_e,Ge),Ft=(Nt=Ce.find(we=>we.textValue===wt))==null?void 0:Nt.ref.current;(function we(He){le.current=He,window.clearTimeout(ee.current),He!==""&&(ee.current=window.setTimeout(()=>we(""),1e3))})(_e),Ft&&setTimeout(()=>Ft.focus())};N.useEffect(()=>()=>window.clearTimeout(ee.current),[]),CF();const ne=N.useCallback(ue=>{var Ce,Ie;return ae.current===((Ce=de.current)==null?void 0:Ce.side)&&b6e(ue,(Ie=de.current)==null?void 0:Ie.area)},[]);return _.jsx(i6e,{scope:n,searchRef:le,onItemEnter:N.useCallback(ue=>{ne(ue)&&ue.preventDefault()},[ne]),onItemLeave:N.useCallback(ue=>{var _e;ne(ue)||((_e=H.current)==null||_e.focus(),W(null))},[ne]),onTriggerLeave:N.useCallback(ue=>{ne(ue)&&ue.preventDefault()},[ne]),pointerGraceTimerRef:he,onPointerGraceIntentChange:N.useCallback(ue=>{de.current=ue},[]),children:_.jsx(ge,{...ye,children:_.jsx(XO,{asChild:!0,trapped:a,onMountAutoFocus:et(l,ue=>{var _e;ue.preventDefault(),(_e=H.current)==null||_e.focus({preventScroll:!0})}),onUnmountAutoFocus:d,children:_.jsx(qv,{asChild:!0,disableOutsidePointerEvents:f,onEscapeKeyDown:v,onPointerDownOutside:E,onFocusOutside:S,onInteractOutside:T,onDismiss:R,children:_.jsx(ple,{asChild:!0,...M,dir:D.dir,orientation:"vertical",loop:i,currentTabStopId:V,onCurrentTabStopIdChange:W,onEntryFocus:et(m,ue=>{D.isUsingKeyboardRef.current||ue.preventDefault()}),preventScrollOnEntryFocus:!0,children:_.jsx(xV,{role:"menu","aria-orientation":"vertical","data-state":Kle(P.open),"data-radix-menu-content":"",dir:D.dir,...k,...O,ref:J,style:{outline:"none",...O.style},onKeyDown:et(O.onKeyDown,ue=>{const Ce=ue.target.closest("[data-radix-menu-content]")===ue.currentTarget,Ie=ue.ctrlKey||ue.altKey||ue.metaKey,Ge=ue.key.length===1;Ce&&(ue.key==="Tab"&&ue.preventDefault(),!Ie&&Ge&&te(ue.key));const Ze=H.current;if(ue.target!==Ze||!qWe.includes(ue.key))return;ue.preventDefault();const Ft=$().filter(ze=>!ze.disabled).map(ze=>ze.ref.current);Tle.includes(ue.key)&&Ft.reverse(),v6e(Ft)}),onBlur:et(e.onBlur,ue=>{ue.currentTarget.contains(ue.target)||(window.clearTimeout(ee.current),le.current="")}),onPointerMove:et(e.onPointerMove,Mb(ue=>{const _e=ue.target,Ce=ce.current!==ue.clientX;if(ue.currentTarget.contains(_e)&&Ce){const Ie=ue.clientX>ce.current?"right":"left";ae.current=Ie,ce.current=ue.clientX}}))})})})})})})});xle.displayName=Fa;var c6e="MenuGroup",PF=N.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e;return _.jsx(yt.div,{role:"group",...i,ref:t})});PF.displayName=c6e;var l6e="MenuLabel",Ple=N.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e;return _.jsx(yt.div,{...i,ref:t})});Ple.displayName=l6e;var eA="MenuItem",GQ="menu.itemSelect",tI=N.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:i,...a}=e,l=N.useRef(null),d=FS(eA,e.__scopeMenu),f=IF(eA,e.__scopeMenu),m=fn(t,l),v=N.useRef(!1),E=()=>{const S=l.current;if(!n&&S){const T=new CustomEvent(GQ,{bubbles:!0,cancelable:!0});S.addEventListener(GQ,R=>i==null?void 0:i(R),{once:!0}),fV(S,T),T.defaultPrevented?v.current=!1:d.onClose()}};return _.jsx(Nle,{...a,ref:m,disabled:n,onClick:et(e.onClick,E),onPointerDown:S=>{var T;(T=e.onPointerDown)==null||T.call(e,S),v.current=!0},onPointerUp:et(e.onPointerUp,S=>{var T;v.current||(T=S.currentTarget)==null||T.click()}),onKeyDown:et(e.onKeyDown,S=>{const T=f.searchRef.current!=="";n||T&&S.key===" "||L2.includes(S.key)&&(S.currentTarget.click(),S.preventDefault())})})});tI.displayName=eA;var Nle=N.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:i=!1,textValue:a,...l}=e,d=IF(eA,n),f=Rle(n),m=N.useRef(null),v=fn(t,m),[E,S]=N.useState(!1),[T,R]=N.useState("");return N.useEffect(()=>{const I=m.current;I&&R((I.textContent??"").trim())},[l.children]),_.jsx(Lb.ItemSlot,{scope:n,disabled:i,textValue:a??T,children:_.jsx(mle,{asChild:!0,...f,focusable:!i,children:_.jsx(yt.div,{role:"menuitem","data-highlighted":E?"":void 0,"aria-disabled":i||void 0,"data-disabled":i?"":void 0,...l,ref:v,onPointerMove:et(e.onPointerMove,Mb(I=>{i?d.onItemLeave(I):(d.onItemEnter(I),I.defaultPrevented||I.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:et(e.onPointerLeave,Mb(I=>d.onItemLeave(I))),onFocus:et(e.onFocus,()=>S(!0)),onBlur:et(e.onBlur,()=>S(!1))})})})}),u6e="MenuCheckboxItem",Dle=N.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:i,...a}=e;return _.jsx(Ule,{scope:e.__scopeMenu,checked:n,children:_.jsx(tI,{role:"menuitemcheckbox","aria-checked":tA(n)?"mixed":n,...a,ref:t,"data-state":DF(n),onSelect:et(a.onSelect,()=>i==null?void 0:i(tA(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Dle.displayName=u6e;var kle="MenuRadioGroup",[d6e,h6e]=Np(kle,{value:void 0,onValueChange:()=>{}}),Lle=N.forwardRef((e,t)=>{const{value:n,onValueChange:i,...a}=e,l=hi(i);return _.jsx(d6e,{scope:e.__scopeMenu,value:n,onValueChange:l,children:_.jsx(PF,{...a,ref:t})})});Lle.displayName=kle;var Mle="MenuRadioItem",jle=N.forwardRef((e,t)=>{const{value:n,...i}=e,a=h6e(Mle,e.__scopeMenu),l=n===a.value;return _.jsx(Ule,{scope:e.__scopeMenu,checked:l,children:_.jsx(tI,{role:"menuitemradio","aria-checked":l,...i,ref:t,"data-state":DF(l),onSelect:et(i.onSelect,()=>{var d;return(d=a.onValueChange)==null?void 0:d.call(a,n)},{checkForDefaultPrevented:!1})})})});jle.displayName=Mle;var NF="MenuItemIndicator",[Ule,f6e]=Np(NF,{checked:!1}),Vle=N.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:i,...a}=e,l=f6e(NF,n);return _.jsx(Ao,{present:i||tA(l.checked)||l.checked===!0,children:_.jsx(yt.span,{...a,ref:t,"data-state":DF(l.checked)})})});Vle.displayName=NF;var p6e="MenuSeparator",Fle=N.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e;return _.jsx(yt.div,{role:"separator","aria-orientation":"horizontal",...i,ref:t})});Fle.displayName=p6e;var m6e="MenuArrow",Ble=N.forwardRef((e,t)=>{const{__scopeMenu:n,...i}=e,a=eI(n);return _.jsx(PV,{...a,...i,ref:t})});Ble.displayName=m6e;var g6e="MenuSub",[AEt,$le]=Np(g6e),IE="MenuSubTrigger",Wle=N.forwardRef((e,t)=>{const n=Dp(IE,e.__scopeMenu),i=FS(IE,e.__scopeMenu),a=$le(IE,e.__scopeMenu),l=IF(IE,e.__scopeMenu),d=N.useRef(null),{pointerGraceTimerRef:f,onPointerGraceIntentChange:m}=l,v={__scopeMenu:e.__scopeMenu},E=N.useCallback(()=>{d.current&&window.clearTimeout(d.current),d.current=null},[]);return N.useEffect(()=>E,[E]),N.useEffect(()=>{const S=f.current;return()=>{window.clearTimeout(S),m(null)}},[f,m]),_.jsx(AF,{asChild:!0,...v,children:_.jsx(Nle,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":Kle(n.open),...e,ref:SO(t,a.onTriggerChange),onClick:S=>{var T;(T=e.onClick)==null||T.call(e,S),!(e.disabled||S.defaultPrevented)&&(S.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:et(e.onPointerMove,Mb(S=>{l.onItemEnter(S),!S.defaultPrevented&&!e.disabled&&!n.open&&!d.current&&(l.onPointerGraceIntentChange(null),d.current=window.setTimeout(()=>{n.onOpenChange(!0),E()},100))})),onPointerLeave:et(e.onPointerLeave,Mb(S=>{var R,I;E();const T=(R=n.content)==null?void 0:R.getBoundingClientRect();if(T){const O=(I=n.content)==null?void 0:I.dataset.side,P=O==="right",D=P?-5:5,k=T[P?"left":"right"],M=T[P?"right":"left"];l.onPointerGraceIntentChange({area:[{x:S.clientX+D,y:S.clientY},{x:k,y:T.top},{x:M,y:T.top},{x:M,y:T.bottom},{x:k,y:T.bottom}],side:O}),window.clearTimeout(f.current),f.current=window.setTimeout(()=>l.onPointerGraceIntentChange(null),300)}else{if(l.onTriggerLeave(S),S.defaultPrevented)return;l.onPointerGraceIntentChange(null)}})),onKeyDown:et(e.onKeyDown,S=>{var R;const T=l.searchRef.current!=="";e.disabled||T&&S.key===" "||XWe[i.dir].includes(S.key)&&(n.onOpenChange(!0),(R=n.content)==null||R.focus(),S.preventDefault())})})})});Wle.displayName=IE;var Gle="MenuSubContent",Hle=N.forwardRef((e,t)=>{const n=Ole(Fa,e.__scopeMenu),{forceMount:i=n.forceMount,...a}=e,l=Dp(Fa,e.__scopeMenu),d=FS(Fa,e.__scopeMenu),f=$le(Gle,e.__scopeMenu),m=N.useRef(null),v=fn(t,m);return _.jsx(Lb.Provider,{scope:e.__scopeMenu,children:_.jsx(Ao,{present:i||l.open,children:_.jsx(Lb.Slot,{scope:e.__scopeMenu,children:_.jsx(xF,{id:f.contentId,"aria-labelledby":f.triggerId,...a,ref:v,align:"start",side:d.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:E=>{var S;d.isUsingKeyboardRef.current&&((S=m.current)==null||S.focus()),E.preventDefault()},onCloseAutoFocus:E=>E.preventDefault(),onFocusOutside:et(e.onFocusOutside,E=>{E.target!==f.trigger&&l.onOpenChange(!1)}),onEscapeKeyDown:et(e.onEscapeKeyDown,E=>{d.onClose(),E.preventDefault()}),onKeyDown:et(e.onKeyDown,E=>{var R;const S=E.currentTarget.contains(E.target),T=JWe[d.dir].includes(E.key);S&&T&&(l.onOpenChange(!1),(R=f.trigger)==null||R.focus(),E.preventDefault())})})})})})});Hle.displayName=Gle;function Kle(e){return e?"open":"closed"}function tA(e){return e==="indeterminate"}function DF(e){return tA(e)?"indeterminate":e?"checked":"unchecked"}function v6e(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function y6e(e,t){return e.map((n,i)=>e[(t+i)%e.length])}function _6e(e,t,n){const a=t.length>1&&Array.from(t).every(v=>v===t[0])?t[0]:t,l=n?e.indexOf(n):-1;let d=y6e(e,Math.max(l,0));a.length===1&&(d=d.filter(v=>v!==n));const m=d.find(v=>v.toLowerCase().startsWith(a.toLowerCase()));return m!==n?m:void 0}function E6e(e,t){const{x:n,y:i}=e;let a=!1;for(let l=0,d=t.length-1;l<t.length;d=l++){const f=t[l],m=t[d],v=f.x,E=f.y,S=m.x,T=m.y;E>i!=T>i&&n<(S-v)*(i-E)/(T-E)+v&&(a=!a)}return a}function b6e(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return E6e(n,t)}function Mb(e){return t=>t.pointerType==="mouse"?e(t):void 0}var S6e=Ale,w6e=AF,T6e=Ile,C6e=xle,R6e=PF,A6e=Ple,O6e=tI,I6e=Dle,x6e=Lle,P6e=jle,N6e=Vle,D6e=Fle,k6e=Ble,L6e=Wle,M6e=Hle,nI="DropdownMenu",[j6e,OEt]=ta(nI,[Cle]),zo=Cle(),[U6e,zle]=j6e(nI),Yle=e=>{const{__scopeDropdownMenu:t,children:n,dir:i,open:a,defaultOpen:l,onOpenChange:d,modal:f=!0}=e,m=zo(t),v=N.useRef(null),[E,S]=Eh({prop:a,defaultProp:l??!1,onChange:d,caller:nI});return _.jsx(U6e,{scope:t,triggerId:Tl(),triggerRef:v,contentId:Tl(),open:E,onOpenChange:S,onOpenToggle:N.useCallback(()=>S(T=>!T),[S]),modal:f,children:_.jsx(S6e,{...m,open:E,onOpenChange:S,dir:i,modal:f,children:n})})};Yle.displayName=nI;var qle="DropdownMenuTrigger",Xle=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:i=!1,...a}=e,l=zle(qle,n),d=zo(n);return _.jsx(w6e,{asChild:!0,...d,children:_.jsx(yt.button,{type:"button",id:l.triggerId,"aria-haspopup":"menu","aria-expanded":l.open,"aria-controls":l.open?l.contentId:void 0,"data-state":l.open?"open":"closed","data-disabled":i?"":void 0,disabled:i,...a,ref:SO(t,l.triggerRef),onPointerDown:et(e.onPointerDown,f=>{!i&&f.button===0&&f.ctrlKey===!1&&(l.onOpenToggle(),l.open||f.preventDefault())}),onKeyDown:et(e.onKeyDown,f=>{i||(["Enter"," "].includes(f.key)&&l.onOpenToggle(),f.key==="ArrowDown"&&l.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(f.key)&&f.preventDefault())})})})});Xle.displayName=qle;var V6e="DropdownMenuPortal",Jle=e=>{const{__scopeDropdownMenu:t,...n}=e,i=zo(t);return _.jsx(T6e,{...i,...n})};Jle.displayName=V6e;var Qle="DropdownMenuContent",Zle=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,a=zle(Qle,n),l=zo(n),d=N.useRef(!1);return _.jsx(C6e,{id:a.contentId,"aria-labelledby":a.triggerId,...l,...i,ref:t,onCloseAutoFocus:et(e.onCloseAutoFocus,f=>{var m;d.current||(m=a.triggerRef.current)==null||m.focus(),d.current=!1,f.preventDefault()}),onInteractOutside:et(e.onInteractOutside,f=>{const m=f.detail.originalEvent,v=m.button===0&&m.ctrlKey===!0,E=m.button===2||v;(!a.modal||E)&&(d.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Zle.displayName=Qle;var F6e="DropdownMenuGroup",B6e=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,a=zo(n);return _.jsx(R6e,{...a,...i,ref:t})});B6e.displayName=F6e;var $6e="DropdownMenuLabel",eue=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,a=zo(n);return _.jsx(A6e,{...a,...i,ref:t})});eue.displayName=$6e;var W6e="DropdownMenuItem",tue=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,a=zo(n);return _.jsx(O6e,{...a,...i,ref:t})});tue.displayName=W6e;var G6e="DropdownMenuCheckboxItem",nue=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,a=zo(n);return _.jsx(I6e,{...a,...i,ref:t})});nue.displayName=G6e;var H6e="DropdownMenuRadioGroup",K6e=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,a=zo(n);return _.jsx(x6e,{...a,...i,ref:t})});K6e.displayName=H6e;var z6e="DropdownMenuRadioItem",rue=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,a=zo(n);return _.jsx(P6e,{...a,...i,ref:t})});rue.displayName=z6e;var Y6e="DropdownMenuItemIndicator",iue=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,a=zo(n);return _.jsx(N6e,{...a,...i,ref:t})});iue.displayName=Y6e;var q6e="DropdownMenuSeparator",oue=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,a=zo(n);return _.jsx(D6e,{...a,...i,ref:t})});oue.displayName=q6e;var X6e="DropdownMenuArrow",J6e=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,a=zo(n);return _.jsx(k6e,{...a,...i,ref:t})});J6e.displayName=X6e;var Q6e="DropdownMenuSubTrigger",sue=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,a=zo(n);return _.jsx(L6e,{...a,...i,ref:t})});sue.displayName=Q6e;var Z6e="DropdownMenuSubContent",aue=N.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...i}=e,a=zo(n);return _.jsx(M6e,{...a,...i,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});aue.displayName=Z6e;var eGe=Yle,tGe=Xle,nGe=Jle,cue=Zle,lue=eue,uue=tue,due=nue,hue=rue,fue=iue,pue=oue,mue=sue,gue=aue;const rGe=eGe,iGe=tGe,oGe=N.forwardRef(({className:e,inset:t,children:n,...i},a)=>_.jsxs(mue,{ref:a,className:gt("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...i,children:[n,_.jsx(Zoe,{className:"ml-auto h-4 w-4"})]}));oGe.displayName=mue.displayName;const sGe=N.forwardRef(({className:e,...t},n)=>_.jsx(gue,{ref:n,className:gt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));sGe.displayName=gue.displayName;const vue=N.forwardRef(({className:e,sideOffset:t=4,...n},i)=>_.jsx(nGe,{children:_.jsx(cue,{ref:i,sideOffset:t,className:gt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));vue.displayName=cue.displayName;const M2=N.forwardRef(({className:e,inset:t,...n},i)=>_.jsx(uue,{ref:i,className:gt("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));M2.displayName=uue.displayName;const aGe=N.forwardRef(({className:e,children:t,checked:n,...i},a)=>_.jsxs(due,{ref:a,className:gt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...i,children:[_.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:_.jsx(fue,{children:_.jsx(RO,{className:"h-4 w-4"})})}),t]}));aGe.displayName=due.displayName;const cGe=N.forwardRef(({className:e,children:t,...n},i)=>_.jsxs(hue,{ref:i,className:gt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[_.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:_.jsx(fue,{children:_.jsx(OLe,{className:"h-2 w-2 fill-current"})})}),t]}));cGe.displayName=hue.displayName;const lGe=N.forwardRef(({className:e,inset:t,...n},i)=>_.jsx(lue,{ref:i,className:gt("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));lGe.displayName=lue.displayName;const yue=N.forwardRef(({className:e,...t},n)=>_.jsx(pue,{ref:n,className:gt("-mx-1 my-1 h-px bg-muted",e),...t}));yue.displayName=pue.displayName;const uGe=()=>{const[e,t]=N.useState(!1),{user:n,signOut:i}=jc(),a=kl();return N.useEffect(()=>{t(!1)},[a.pathname]),_.jsxs(Vn.header,{initial:{y:-100},animate:{y:0},transition:{duration:.5,ease:[.21,.47,.32,.98]},className:"sticky top-0 z-50 w-full border-b border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:[_.jsxs("div",{className:"container flex h-16 items-center justify-between px-4 md:px-6",children:[_.jsx(Vn.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:_.jsxs(Dt,{to:"/",className:"flex items-center gap-2 text-xl font-bold text-primary",children:[_.jsx(Vn.div,{whileHover:{rotate:5},className:"w-10 h-10 flex items-center justify-center",children:_.jsx(G$e,{className:"w-full h-full"})}),_.jsx("span",{children:"Unfiltered CA"})]})}),_.jsxs("nav",{className:"hidden md:flex items-center gap-6",children:[_.jsx(Vn.div,{whileHover:{y:-2},children:_.jsx(Dt,{to:"/",className:"text-muted-foreground hover:text-foreground",children:"Home"})}),n&&_.jsxs(_.Fragment,{children:[_.jsx(Vn.div,{whileHover:{y:-2},children:_.jsxs(Dt,{to:"/tools",className:"text-muted-foreground hover:text-foreground flex items-center gap-1",children:[_.jsx(AX,{className:"h-4 w-4"}),_.jsx("span",{children:"Tools"})]})}),_.jsx(Vn.div,{whileHover:{y:-2},children:_.jsxs(Dt,{to:"/preparation",className:"text-muted-foreground hover:text-foreground flex items-center gap-1",children:[_.jsx(Sb,{className:"h-4 w-4"}),_.jsx("span",{children:"Preparation"})]})}),_.jsx(Vn.div,{whileHover:{y:-2},children:_.jsx(Dt,{to:"/forum",className:"text-muted-foreground hover:text-foreground flex items-center gap-1",children:_.jsx("span",{children:"Discussion Forum"})})}),_.jsx(Vn.div,{whileHover:{y:-2},children:_.jsxs(Dt,{to:"/study-analysis",className:"text-muted-foreground hover:text-foreground flex items-center gap-1",children:[_.jsx(RX,{className:"h-4 w-4"}),_.jsx("span",{children:"Study Analysis"})]})}),_.jsx(Vn.div,{whileHover:{y:-2},children:_.jsxs(Dt,{to:"/achievements",className:"text-muted-foreground hover:text-foreground flex items-center gap-1",children:[_.jsx(OX,{className:"h-4 w-4"}),_.jsx("span",{children:"Achievements"})]})})]})]}),_.jsxs("div",{className:"flex items-center gap-4",children:[n?_.jsxs(rGe,{children:[_.jsx(iGe,{asChild:!0,children:_.jsx(Vn.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"flex items-center gap-2 rounded-full border p-2 hover:bg-accent",children:_.jsx(MLe,{className:"h-5 w-5"})})}),_.jsxs(vue,{align:"end",className:"w-56",children:[_.jsx(M2,{asChild:!0,children:_.jsx(Dt,{to:"/profile",className:"cursor-pointer",children:"Profile"})}),_.jsx(yue,{}),_.jsxs(M2,{className:"cursor-pointer text-destructive focus:text-destructive",onClick:i,children:[_.jsx(ILe,{className:"mr-2 h-4 w-4"}),"Sign Out"]})]})]}):_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Dt,{to:"/login",children:_.jsx(Fr,{variant:"ghost",hoverScale:1.05,children:"Sign In"})}),_.jsx(Dt,{to:"/register",children:_.jsx(Fr,{hoverScale:1.08,children:"Get Started"})})]}),_.jsx(Vn.button,{whileHover:{scale:1.1},whileTap:{scale:.9},className:"md:hidden",onClick:()=>t(!e),children:e?_.jsx(AO,{className:"h-6 w-6"}):_.jsx(xLe,{className:"h-6 w-6"})})]})]}),_.jsx(Nae,{children:e&&_.jsx(Vn.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"container md:hidden pb-4",children:_.jsxs(Vn.nav,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.2,delay:.1},className:"flex flex-col gap-4",children:[_.jsx(Vn.div,{whileHover:{x:5},children:_.jsx(Dt,{to:"/",className:"flex items-center gap-2 p-2 rounded-md hover:bg-accent",onClick:()=>t(!1),children:"Home"})}),n&&_.jsxs(_.Fragment,{children:[_.jsx(Vn.div,{whileHover:{x:5},children:_.jsxs(Dt,{to:"/tools",className:"flex items-center gap-2 p-2 rounded-md hover:bg-accent",onClick:()=>t(!1),children:[_.jsx(AX,{className:"h-5 w-5 text-primary"}),_.jsx("span",{children:"Tools"})]})}),_.jsx(Vn.div,{whileHover:{x:5},children:_.jsxs(Dt,{to:"/preparation",className:"flex items-center gap-2 p-2 rounded-md hover:bg-accent",onClick:()=>t(!1),children:[_.jsx(Sb,{className:"h-5 w-5 text-primary"}),_.jsx("span",{children:"Preparation"})]})}),_.jsx(Vn.div,{whileHover:{x:5},children:_.jsx(Dt,{to:"/forum",className:"flex items-center gap-2 p-2 rounded-md hover:bg-accent",onClick:()=>t(!1),children:_.jsx("span",{children:"Discussion Forum"})})}),_.jsx(Vn.div,{whileHover:{x:5},children:_.jsxs(Dt,{to:"/study-analysis",className:"flex items-center gap-2 p-2 rounded-md hover:bg-accent",onClick:()=>t(!1),children:[_.jsx(RX,{className:"h-5 w-5 text-primary"}),_.jsx("span",{children:"Study Analysis"})]})}),_.jsx(Vn.div,{whileHover:{x:5},children:_.jsxs(Dt,{to:"/achievements",className:"flex items-center gap-2 p-2 rounded-md hover:bg-accent",onClick:()=>t(!1),children:[_.jsx(OX,{className:"h-5 w-5 text-primary"}),_.jsx("span",{children:"Achievements"})]})})]})]})})})]})};var rI="Dialog",[_ue,IEt]=ta(rI),[dGe,Uc]=_ue(rI),Eue=e=>{const{__scopeDialog:t,children:n,open:i,defaultOpen:a,onOpenChange:l,modal:d=!0}=e,f=N.useRef(null),m=N.useRef(null),[v,E]=Eh({prop:i,defaultProp:a??!1,onChange:l,caller:rI});return _.jsx(dGe,{scope:t,triggerRef:f,contentRef:m,contentId:Tl(),titleId:Tl(),descriptionId:Tl(),open:v,onOpenChange:E,onOpenToggle:N.useCallback(()=>E(S=>!S),[E]),modal:d,children:n})};Eue.displayName=rI;var bue="DialogTrigger",Sue=N.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,a=Uc(bue,n),l=fn(t,a.triggerRef);return _.jsx(yt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":MF(a.open),...i,ref:l,onClick:et(e.onClick,a.onOpenToggle)})});Sue.displayName=bue;var kF="DialogPortal",[hGe,wue]=_ue(kF,{forceMount:void 0}),Tue=e=>{const{__scopeDialog:t,forceMount:n,children:i,container:a}=e,l=Uc(kF,t);return _.jsx(hGe,{scope:t,forceMount:n,children:N.Children.map(i,d=>_.jsx(Ao,{present:n||l.open,children:_.jsx(AS,{asChild:!0,container:a,children:d})}))})};Tue.displayName=kF;var nA="DialogOverlay",Cue=N.forwardRef((e,t)=>{const n=wue(nA,e.__scopeDialog),{forceMount:i=n.forceMount,...a}=e,l=Uc(nA,e.__scopeDialog);return l.modal?_.jsx(Ao,{present:i||l.open,children:_.jsx(pGe,{...a,ref:t})}):null});Cue.displayName=nA;var fGe=gp("DialogOverlay.RemoveScroll"),pGe=N.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,a=Uc(nA,n);return _.jsx(ZO,{as:fGe,allowPinchZoom:!0,shards:[a.contentRef],children:_.jsx(yt.div,{"data-state":MF(a.open),...i,ref:t,style:{pointerEvents:"auto",...i.style}})})}),yp="DialogContent",Rue=N.forwardRef((e,t)=>{const n=wue(yp,e.__scopeDialog),{forceMount:i=n.forceMount,...a}=e,l=Uc(yp,e.__scopeDialog);return _.jsx(Ao,{present:i||l.open,children:l.modal?_.jsx(mGe,{...a,ref:t}):_.jsx(gGe,{...a,ref:t})})});Rue.displayName=yp;var mGe=N.forwardRef((e,t)=>{const n=Uc(yp,e.__scopeDialog),i=N.useRef(null),a=fn(t,n.contentRef,i);return N.useEffect(()=>{const l=i.current;if(l)return RF(l)},[]),_.jsx(Aue,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:et(e.onCloseAutoFocus,l=>{var d;l.preventDefault(),(d=n.triggerRef.current)==null||d.focus()}),onPointerDownOutside:et(e.onPointerDownOutside,l=>{const d=l.detail.originalEvent,f=d.button===0&&d.ctrlKey===!0;(d.button===2||f)&&l.preventDefault()}),onFocusOutside:et(e.onFocusOutside,l=>l.preventDefault())})}),gGe=N.forwardRef((e,t)=>{const n=Uc(yp,e.__scopeDialog),i=N.useRef(!1),a=N.useRef(!1);return _.jsx(Aue,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var d,f;(d=e.onCloseAutoFocus)==null||d.call(e,l),l.defaultPrevented||(i.current||(f=n.triggerRef.current)==null||f.focus(),l.preventDefault()),i.current=!1,a.current=!1},onInteractOutside:l=>{var m,v;(m=e.onInteractOutside)==null||m.call(e,l),l.defaultPrevented||(i.current=!0,l.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const d=l.target;((v=n.triggerRef.current)==null?void 0:v.contains(d))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&a.current&&l.preventDefault()}})}),Aue=N.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:i,onOpenAutoFocus:a,onCloseAutoFocus:l,...d}=e,f=Uc(yp,n),m=N.useRef(null),v=fn(t,m);return CF(),_.jsxs(_.Fragment,{children:[_.jsx(XO,{asChild:!0,loop:!0,trapped:i,onMountAutoFocus:a,onUnmountAutoFocus:l,children:_.jsx(qv,{role:"dialog",id:f.contentId,"aria-describedby":f.descriptionId,"aria-labelledby":f.titleId,"data-state":MF(f.open),...d,ref:v,onDismiss:()=>f.onOpenChange(!1)})}),_.jsxs(_.Fragment,{children:[_.jsx(vGe,{titleId:f.titleId}),_.jsx(_Ge,{contentRef:m,descriptionId:f.descriptionId})]})]})}),LF="DialogTitle",Oue=N.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,a=Uc(LF,n);return _.jsx(yt.h2,{id:a.titleId,...i,ref:t})});Oue.displayName=LF;var Iue="DialogDescription",xue=N.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,a=Uc(Iue,n);return _.jsx(yt.p,{id:a.descriptionId,...i,ref:t})});xue.displayName=Iue;var Pue="DialogClose",Nue=N.forwardRef((e,t)=>{const{__scopeDialog:n,...i}=e,a=Uc(Pue,n);return _.jsx(yt.button,{type:"button",...i,ref:t,onClick:et(e.onClick,()=>a.onOpenChange(!1))})});Nue.displayName=Pue;function MF(e){return e?"open":"closed"}var Due="DialogTitleWarning",[xEt,kue]=Nke(Due,{contentName:yp,titleName:LF,docsSlug:"dialog"}),vGe=({titleId:e})=>{const t=kue(Due),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return N.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},yGe="DialogDescriptionWarning",_Ge=({contentRef:e,descriptionId:t})=>{const i=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${kue(yGe).contentName}}.`;return N.useEffect(()=>{var l;const a=(l=e.current)==null?void 0:l.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(i))},[i,e,t]),null},EGe=Eue,bGe=Sue,SGe=Tue,Lue=Cue,Mue=Rue,jue=Oue,Uue=xue,wGe=Nue;const hh=EGe,fh=bGe,TGe=SGe,Vue=N.forwardRef(({className:e,...t},n)=>_.jsx(Lue,{ref:n,className:gt("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));Vue.displayName=Lue.displayName;const Tu=N.forwardRef(({className:e,children:t,...n},i)=>_.jsxs(TGe,{children:[_.jsx(Vue,{}),_.jsxs(Mue,{ref:i,className:gt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,_.jsxs(wGe,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[_.jsx(AO,{className:"h-4 w-4"}),_.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Tu.displayName=Mue.displayName;const Cu=({className:e,...t})=>_.jsx("div",{className:gt("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Cu.displayName="DialogHeader";const Ru=({className:e,...t})=>_.jsx("div",{className:gt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Ru.displayName="DialogFooter";const Au=N.forwardRef(({className:e,...t},n)=>_.jsx(jue,{ref:n,className:gt("text-lg font-semibold leading-none tracking-tight",e),...t}));Au.displayName=jue.displayName;const Ou=N.forwardRef(({className:e,...t},n)=>_.jsx(Uue,{ref:n,className:gt("text-sm text-muted-foreground",e),...t}));Ou.displayName=Uue.displayName;const _n=N.forwardRef(({className:e,type:t,...n},i)=>_.jsx("input",{type:t,className:gt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:i,...n}));_n.displayName="Input";const iI=N.forwardRef(({className:e,...t},n)=>_.jsx("textarea",{className:gt("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));iI.displayName="Textarea";const CGe=()=>{const{user:e}=jc(),t=xS(),[n,i]=N.useState(!1),[a,l]=N.useState(!1),d=f=>m=>{e||(m.preventDefault(),t("/login"))};return _.jsx("footer",{className:"border-t border-border/40 bg-background",children:_.jsxs("div",{className:"container py-8 md:py-12",children:[_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[_.jsxs("div",{children:[_.jsxs(Dt,{to:"/",className:"flex items-center gap-2 text-xl font-bold text-primary mb-4",children:[_.jsx("div",{className:"w-8 h-8 rounded-md bg-primary flex items-center justify-center",children:_.jsx("span",{className:"text-white text-sm font-bold",children:"CA"})}),_.jsx("span",{children:"Unfiltered CA"})]}),_.jsx("p",{className:"text-muted-foreground text-sm",children:"A comprehensive study platform for CA students."})]}),_.jsxs("div",{children:[_.jsx("h3",{className:"font-medium text-sm mb-3",children:"Features"}),_.jsxs("ul",{className:"space-y-2 text-sm",children:[_.jsx("li",{children:_.jsx(Dt,{to:"/tools/timer",className:"text-muted-foreground hover:text-foreground",onClick:d(),children:"Pomodoro Timer"})}),_.jsx("li",{children:_.jsx(Dt,{to:"/tools/planner",className:"text-muted-foreground hover:text-foreground",onClick:d(),children:"Study Planner"})}),_.jsx("li",{children:_.jsx(Dt,{to:"/tools/rooms",className:"text-muted-foreground hover:text-foreground",onClick:d(),children:"Study Rooms"})}),_.jsx("li",{children:_.jsx(Dt,{to:"/resources",className:"text-muted-foreground hover:text-foreground",onClick:d(),children:"Resources"})}),_.jsx("li",{children:_.jsx(Dt,{to:"/forum",className:"text-muted-foreground hover:text-foreground",children:"Discussion Forum"})})]})]}),_.jsxs("div",{children:[_.jsx("h3",{className:"font-medium text-sm mb-3",children:"Account"}),_.jsxs("ul",{className:"space-y-2 text-sm",children:[_.jsx("li",{children:_.jsx(Dt,{to:"/login",className:"text-muted-foreground hover:text-foreground",children:"Sign In"})}),_.jsx("li",{children:_.jsx(Dt,{to:"/register",className:"text-muted-foreground hover:text-foreground",children:"Sign Up"})}),_.jsx("li",{children:_.jsx(Dt,{to:"/profile",className:"text-muted-foreground hover:text-foreground",children:"Profile"})})]})]}),_.jsxs("div",{children:[_.jsx("h3",{className:"font-medium text-sm mb-3",children:"Support"}),_.jsxs("ul",{className:"space-y-2 text-sm",children:[_.jsxs("li",{children:[_.jsxs("button",{type:"button",className:"text-muted-foreground hover:text-foreground w-full text-left flex items-center justify-between",onClick:()=>i(f=>!f),"aria-expanded":n,children:["Help Center",_.jsx("span",{className:`ml-2 transition-transform ${n?"rotate-90":""}`,children:"▶"})]}),n&&_.jsx("ul",{className:"ml-4 mt-2 space-y-1 text-xs text-muted-foreground",children:_.jsx("li",{children:"• Email: unfilteredca07@gmail.com"})})]}),_.jsxs("li",{children:[_.jsxs("button",{type:"button",className:"text-muted-foreground hover:text-foreground w-full text-left flex items-center justify-between",onClick:()=>l(f=>!f),"aria-expanded":a,children:["Contact Us",_.jsx("span",{className:`ml-2 transition-transform ${a?"rotate-90":""}`,children:"▶"})]}),a&&_.jsx("ul",{className:"ml-4 mt-2 space-y-1 text-xs text-muted-foreground",children:_.jsx("li",{children:"• Email: unfilteredca07@gmail.com"})})]}),_.jsx("li",{children:_.jsx(Dt,{to:"/privacy-policy",className:"text-muted-foreground hover:text-foreground",children:"Privacy Policy"})}),_.jsx("li",{children:_.jsx(Dt,{to:"/terms-of-service",className:"text-muted-foreground hover:text-foreground",children:"Terms of Service"})})]})]})]}),_.jsxs("div",{className:"flex justify-center gap-6 mt-8 mb-2",children:[_.jsx("a",{href:"https://www.instagram.com/unfiltered_ca/",target:"_blank",rel:"noopener noreferrer","aria-label":"Instagram",children:_.jsxs("svg",{width:"28",height:"28",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",className:"text-muted-foreground hover:text-foreground transition-colors",children:[_.jsx("rect",{width:"18",height:"18",x:"3",y:"3",rx:"5"}),_.jsx("circle",{cx:"12",cy:"12",r:"4"}),_.jsx("circle",{cx:"17.5",cy:"6.5",r:"1"})]})}),_.jsx("a",{href:"https://t.me/+pUMu05Vk-EEwZDFl",target:"_blank",rel:"noopener noreferrer","aria-label":"Telegram",children:_.jsxs("svg",{width:"28",height:"28",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",className:"text-muted-foreground hover:text-foreground transition-colors",children:[_.jsx("path",{d:"M21 3L3.5 10.5c-.7.3-.7 1.3 0 1.6l4.3 1.4 1.4 4.3c.3.7 1.3.7 1.6 0L21 3z"}),_.jsx("path",{d:"M8.5 15.5l2.5 2.5c.4.4 1.1.2 1.2-.4l.7-3.2"})]})}),_.jsx("a",{href:"https://linkedin.com/company/unfiltered-ca",target:"_blank",rel:"noopener noreferrer","aria-label":"LinkedIn",children:_.jsxs("svg",{width:"28",height:"28",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",className:"text-muted-foreground hover:text-foreground transition-colors",children:[_.jsx("rect",{x:"2",y:"2",width:"20",height:"20",rx:"5"}),_.jsx("path",{d:"M7 10v7"}),_.jsx("circle",{cx:"7",cy:"7",r:"1.1"}),_.jsx("path",{d:"M10 17v-4a2 2 0 0 1 4 0v4"}),_.jsx("path",{d:"M14 13v4"})]})}),_.jsx("a",{href:"https://youtube.com/@unfiltered-ca07?si=X8Od_FglcVQ4BdVx",target:"_blank",rel:"noopener noreferrer","aria-label":"YouTube",children:_.jsxs("svg",{width:"28",height:"28",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",className:"text-muted-foreground hover:text-foreground transition-colors",children:[_.jsx("rect",{x:"3",y:"6",width:"18",height:"12",rx:"4"}),_.jsx("path",{d:"M10 9.5v5l5-2.5-5-2.5z"})]})})]}),_.jsx("div",{className:"flex justify-center mt-8 mb-4",children:_.jsx(RGe,{})}),_.jsx("div",{className:"border-t border-border/40 pt-6 text-sm text-muted-foreground",children:_.jsxs("p",{children:["© ",new Date().getFullYear()," CA Unfiltered CA. All rights reserved."]})})]})})};function RGe(){const[e,t]=N.useState(!1),[n,i]=N.useState(""),[a,l]=N.useState(""),[d,f]=N.useState(""),[m,v]=N.useState(!1),[E,S]=N.useState(""),[T,R]=N.useState(!1),[I,O]=N.useState(null),P=async D=>{if(D.preventDefault(),!E.trim()){O("Phone number is required.");return}R(!0),O(null);try{const{error:k}=await Wt.from("feedback").insert([{name:n,email:a,phone:E,message:d}]);if(k){O("Failed to submit feedback. Please try again."),R(!1);return}v(!0),R(!1),setTimeout(()=>{t(!1),v(!1),i(""),l(""),S(""),f("")},2e3)}catch{O("An unexpected error occurred."),R(!1)}};return _.jsxs(hh,{open:e,onOpenChange:t,children:[_.jsx(fh,{asChild:!0,children:_.jsx("button",{className:"px-4 py-2 rounded bg-primary text-white hover:bg-primary/90 transition-colors text-sm font-medium",children:"Feedback & Suggestions"})}),_.jsxs(Tu,{children:[_.jsxs(Cu,{children:[_.jsx(Au,{children:"Feedback & Suggestions"}),_.jsx(Ou,{children:"We value your input! Please share your feedback or suggest new features/resources."})]}),m?_.jsx("div",{className:"py-8 text-center text-green-600 font-medium",children:"Thank you for your feedback!"}):_.jsxs("form",{onSubmit:P,className:"space-y-4",children:[_.jsx(_n,{placeholder:"Your Name (optional)",value:n,onChange:D=>i(D.target.value)}),_.jsx(_n,{type:"email",placeholder:"Your Email (optional)",value:a,onChange:D=>l(D.target.value)}),_.jsx(_n,{type:"tel",placeholder:"Your Phone Number (required)",value:E,onChange:D=>S(D.target.value),required:!0}),_.jsx(iI,{placeholder:"Your feedback or suggestion...",required:!0,value:d,onChange:D=>f(D.target.value),className:"min-h-[100px]"}),I&&_.jsx("div",{className:"text-red-500 text-sm pb-2",children:I}),_.jsx(Ru,{children:_.jsx("button",{type:"submit",className:"px-4 py-2 rounded bg-primary text-white hover:bg-primary/90 transition-colors text-sm font-medium",disabled:T,children:T?"Submitting...":"Submit"})})]})]})]})}const AGe=({children:e})=>(N.useEffect(()=>{window.scrollTo(0,0)},[]),_.jsx(Vn.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e})),Ni=({children:e})=>_.jsxs("div",{className:"flex flex-col min-h-screen bg-white dark:bg-gray-950",children:[_.jsx(uGe,{}),_.jsx("main",{className:"flex-1 w-full max-w-7xl mx-auto px-4 sm:px-6 md:px-8",children:_.jsx(Nae,{mode:"wait",children:_.jsx(AGe,{children:e})})}),_.jsx(CGe,{})]}),Fue={up:{initial:{y:20,opacity:0},animate:{y:0,opacity:1}},down:{initial:{y:-20,opacity:0},animate:{y:0,opacity:1}},left:{initial:{x:20,opacity:0},animate:{x:0,opacity:1}},right:{initial:{x:-20,opacity:0},animate:{x:0,opacity:1}}};function ag({children:e,className:t="",delay:n=0,direction:i="up",duration:a=.5}){const l=Fue[i];return _.jsx(Vn.div,{initial:l.initial,animate:l.animate,transition:{duration:a,delay:n,ease:[.21,.47,.32,.98]},className:t,children:e})}function HQ({children:e,className:t="",delay:n=0,staggerDelay:i=.1,direction:a="up",duration:l=.5}){const d={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:i,delayChildren:n}}},f=Fue[a];return _.jsx(Vn.div,{variants:d,initial:"hidden",animate:"show",className:t,children:Array.isArray(e)?e.map((m,v)=>_.jsx(Vn.div,{variants:f,transition:{duration:l,ease:[.21,.47,.32,.98]},children:m},v)):_.jsx(Vn.div,{variants:f,transition:{duration:l,ease:[.21,.47,.32,.98]},children:e})})}const cp=({name:e,className:t="",on:n,state:i})=>{if(e==="finance")return _.jsxs("svg",{viewBox:"0 0 64 64",fill:"none",className:t,"aria-label":"Finance Doodle",children:[_.jsx("ellipse",{cx:"32",cy:"40",rx:"24",ry:"16",stroke:"#222",strokeWidth:"2.5",fill:"#fffbe7"}),_.jsx("ellipse",{cx:"32",cy:"40",rx:"20",ry:"12",stroke:"#222",strokeWidth:"2",fill:"none"}),_.jsx("ellipse",{cx:"32",cy:"36",rx:"4",ry:"2",stroke:"#222",strokeWidth:"1.5",fill:"#fff"}),_.jsx("circle",{cx:"48",cy:"36",r:"2.5",fill:"#222"}),_.jsx("rect",{x:"28",y:"24",width:"8",height:"6",rx:"2",stroke:"#222",strokeWidth:"2",fill:"#ffe066"}),_.jsx("path",{d:"M16 48 Q12 56 20 56",stroke:"#222",strokeWidth:"2",fill:"none"}),_.jsx("path",{d:"M48 48 Q52 56 44 56",stroke:"#222",strokeWidth:"2",fill:"none"})]});if(e==="accounting")return _.jsxs("svg",{viewBox:"0 0 64 64",fill:"none",className:t,"aria-label":"Accounting Doodle",children:[_.jsx("rect",{x:"12",y:"8",width:"40",height:"48",rx:"6",stroke:"#222",strokeWidth:"2.5",fill:"#e3f6fd"}),_.jsx("rect",{x:"20",y:"16",width:"24",height:"8",rx:"2",stroke:"#222",strokeWidth:"1.5",fill:"#fff"}),_.jsx("rect",{x:"20",y:"28",width:"8",height:"8",rx:"2",stroke:"#222",strokeWidth:"1.5",fill:"#fff"}),_.jsx("rect",{x:"28",y:"28",width:"8",height:"8",rx:"2",stroke:"#222",strokeWidth:"1.5",fill:"#fff"}),_.jsx("rect",{x:"36",y:"28",width:"8",height:"8",rx:"2",stroke:"#222",strokeWidth:"1.5",fill:"#fff"}),_.jsx("rect",{x:"20",y:"36",width:"8",height:"8",rx:"2",stroke:"#222",strokeWidth:"1.5",fill:"#fff"}),_.jsx("rect",{x:"28",y:"36",width:"8",height:"8",rx:"2",stroke:"#222",strokeWidth:"1.5",fill:"#fff"}),_.jsx("rect",{x:"36",y:"36",width:"8",height:"8",rx:"2",stroke:"#222",strokeWidth:"1.5",fill:"#fff"})]});if(e==="law")return _.jsxs("svg",{viewBox:"0 0 64 64",fill:"none",className:t,"aria-label":"Law Doodle",children:[_.jsx("rect",{x:"30",y:"12",width:"4",height:"32",rx:"2",fill:"#fff",stroke:"#222",strokeWidth:"2"}),_.jsx("circle",{cx:"32",cy:"12",r:"3",fill:"#fff",stroke:"#222",strokeWidth:"2"}),_.jsx("path",{d:"M32 16 L20 40 M32 16 L44 40",stroke:"#222",strokeWidth:"2"}),_.jsx("ellipse",{cx:"20",cy:"44",rx:"6",ry:"2.5",fill:"#fff",stroke:"#222",strokeWidth:"2"}),_.jsx("ellipse",{cx:"44",cy:"44",rx:"6",ry:"2.5",fill:"#fff",stroke:"#222",strokeWidth:"2"}),_.jsx("path",{d:"M32 44 V56",stroke:"#222",strokeWidth:"2"}),_.jsx("ellipse",{cx:"32",cy:"58",rx:"8",ry:"2",fill:"#fff",stroke:"#222",strokeWidth:"2"})]});if(e==="book-light")return _.jsxs("svg",{viewBox:"0 0 120 120",fill:"none",className:t,"aria-label":"Book with Lightbulb",children:[_.jsx("path",{d:"M20 95 Q35 80 60 90 Q85 80 100 95",stroke:"#222",strokeWidth:"2.5",fill:"#fff"}),_.jsx("path",{d:"M20 95 Q60 110 100 95",stroke:"#222",strokeWidth:"2.5",fill:"#fff"}),_.jsx("path",{d:"M35 85 Q60 100 85 85",stroke:"#222",strokeWidth:"2",fill:"none"}),_.jsx("path",{d:"M60 90 Q60 105 60 110",stroke:"#aaa",strokeWidth:"1.5"}),_.jsx("path",{d:"M35 85 Q45 80 60 85 Q75 80 85 85",stroke:"#222",strokeWidth:"1.5",fill:"#fff"}),_.jsx("path",{d:"M35 85 Q40 75 60 80 Q80 75 85 85",stroke:"#222",strokeWidth:"1.2",fill:"#fff"}),_.jsxs("g",{children:[_.jsx("ellipse",{cx:"60",cy:"52",rx:"14",ry:"14",fill:n?"#ffe066":"#eee",stroke:n?"#ffd700":"#aaa",strokeWidth:"2.5"}),_.jsx("path",{d:"M54 66 Q60 72 66 66",stroke:"#aaa",strokeWidth:"2",fill:"none"}),_.jsx("rect",{x:"56",y:"66",width:"8",height:"8",rx:"2",fill:"#fff",stroke:"#aaa",strokeWidth:"1.2"}),_.jsx("path",{d:"M60 60 Q62 58 60 56 Q58 58 60 60",stroke:n?"#ffd700":"#aaa",strokeWidth:"1.8",fill:"none"}),_.jsxs("g",{children:[_.jsx("line",{x1:"60",y1:"36",x2:"60",y2:"22",stroke:n?"#ffd700":"#ccc",strokeWidth:n?3:1.5,opacity:n?1:.4,children:n&&_.jsx("animate",{attributeName:"opacity",values:"1;0.5;1",dur:"0.7s",repeatCount:"indefinite"})}),_.jsx("line",{x1:"60",y1:"36",x2:"70",y2:"25",stroke:n?"#ffd700":"#ccc",strokeWidth:n?2.5:1.2,opacity:n?1:.4,children:n&&_.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"0.7s",repeatCount:"indefinite"})}),_.jsx("line",{x1:"60",y1:"36",x2:"50",y2:"25",stroke:n?"#ffd700":"#ccc",strokeWidth:n?2.5:1.2,opacity:n?1:.4,children:n&&_.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"0.7s",repeatCount:"indefinite"})}),_.jsx("line",{x1:"60",y1:"36",x2:"75",y2:"32",stroke:n?"#ffd700":"#ccc",strokeWidth:n?2:1,opacity:n?1:.4,children:n&&_.jsx("animate",{attributeName:"opacity",values:"1;0.2;1",dur:"0.7s",repeatCount:"indefinite"})}),_.jsx("line",{x1:"60",y1:"36",x2:"45",y2:"32",stroke:n?"#ffd700":"#ccc",strokeWidth:n?2:1,opacity:n?1:.4,children:n&&_.jsx("animate",{attributeName:"opacity",values:"1;0.2;1",dur:"0.7s",repeatCount:"indefinite"})})]})]})]});if(e==="books"){if(!n&&(!i||i==="closed"))return _.jsxs("svg",{viewBox:"0 0 64 64",fill:"none",className:t,"aria-label":"Book Closed",children:[_.jsx("path",{d:"M12 52 Q12 20 32 20 Q52 20 52 52",fill:"#fff",stroke:"#222",strokeWidth:"2.5"}),_.jsx("path",{d:"M12 52 Q32 44 52 52",fill:"#fff",stroke:"#222",strokeWidth:"2.5"}),_.jsx("path",{d:"M32 20 V44",stroke:"#222",strokeWidth:"2"}),_.jsx("path",{d:"M32 44 Q32 48 28 50",stroke:"#222",strokeWidth:"2"}),_.jsx("path",{d:"M32 44 Q32 48 36 50",stroke:"#222",strokeWidth:"2"})]});if(i==="open")return _.jsxs("svg",{viewBox:"0 0 64 64",fill:"none",className:t,"aria-label":"Book Open",children:[_.jsx("path",{d:"M12 52 Q12 32 32 32 Q52 32 52 52",fill:"#fff",stroke:"#222",strokeWidth:"2.5"}),_.jsx("path",{d:"M12 52 Q32 44 52 52",fill:"#fff",stroke:"#222",strokeWidth:"2.5"}),_.jsx("path",{d:"M32 32 V52",stroke:"#222",strokeWidth:"2"}),_.jsx("path",{d:"M22 44 Q32 38 42 44",stroke:"#222",strokeWidth:"1.5"})]});if(i==="page")return _.jsxs("svg",{viewBox:"0 0 64 64",fill:"none",className:t,"aria-label":"Book Page Turn",children:[_.jsx("path",{d:"M13 53 Q13 34 32 33 Q51 32 51 53",fill:"#fff",stroke:"#222",strokeWidth:"2.7",strokeLinecap:"round",strokeLinejoin:"round"}),_.jsx("path",{d:"M13 53 Q32 47 51 53",fill:"#fff",stroke:"#222",strokeWidth:"2.7",strokeLinecap:"round",strokeLinejoin:"round"}),_.jsx("path",{d:"M32 33 V53",stroke:"#222",strokeWidth:"2",strokeDasharray:"3 2"}),_.jsx("path",{d:"M22 46 Q32 39 42 46",stroke:"#222",strokeWidth:"1.7"}),_.jsxs("g",{children:[_.jsx("path",{d:"M32 33 Q55 35 55 53 Q54 54 32 53",fill:"#fff",stroke:"#0af",strokeWidth:"3",strokeDasharray:"6 3",filter:"url(#shadow)"}),_.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 32 53",to:"-120 32 53",dur:"1s",repeatCount:"indefinite"}),_.jsx("animateTransform",{attributeName:"transform",type:"skewY",from:"0",to:"-18",begin:"0s",dur:"1s",repeatCount:"indefinite"}),_.jsx("animateTransform",{attributeName:"transform",type:"scale",from:"1 1",to:"1.15 1.05",begin:"0s",dur:"1s",repeatCount:"indefinite"})]}),_.jsx("defs",{children:_.jsx("filter",{id:"shadow",x:"0",y:"0",width:"200%",height:"200%",children:_.jsx("feDropShadow",{dx:"-3",dy:"3",stdDeviation:"2","flood-color":"#333"})})})]})}return e==="certificate"?_.jsxs("svg",{viewBox:"0 0 64 64",fill:"none",className:t,"aria-label":"Certificate Doodle",children:[_.jsx("rect",{x:"12",y:"16",width:"40",height:"32",rx:"4",fill:"#fffbe7",stroke:"#222",strokeWidth:"2"}),_.jsx("circle",{cx:"32",cy:"32",r:"8",fill:"#e3f6fd",stroke:"#222",strokeWidth:"2"}),_.jsx("path",{d:"M32 40 L32 56",stroke:"#222",strokeWidth:"2"}),_.jsx("circle",{cx:"32",cy:"56",r:"3",fill:"#ffe066",stroke:"#222",strokeWidth:"1.5"})]}):e==="briefcase"?_.jsxs("svg",{viewBox:"0 0 64 64",fill:"none",className:t,"aria-label":"Briefcase Doodle",children:[_.jsx("rect",{x:"12",y:"24",width:"40",height:"24",rx:"4",fill:"#e3f6fd",stroke:"#222",strokeWidth:"2"}),_.jsx("rect",{x:"24",y:"16",width:"16",height:"8",rx:"2",fill:"#fffbe7",stroke:"#222",strokeWidth:"2"}),_.jsx("rect",{x:"28",y:"36",width:"8",height:"8",rx:"2",fill:"#fff",stroke:"#222",strokeWidth:"1.5"}),_.jsx("path",{d:"M12 36 H52",stroke:"#222",strokeWidth:"1.5"})]}):e==="balance-sheet"?_.jsxs("svg",{viewBox:"0 0 64 64",fill:"none",className:t,"aria-label":"Balance Sheet Doodle",children:[_.jsx("rect",{x:"12",y:"12",width:"40",height:"40",rx:"2",fill:"#fff",stroke:"#222",strokeWidth:"2"}),_.jsx("rect",{x:"16",y:"16",width:"32",height:"8",rx:"1",fill:"#e3f6fd",stroke:"#222",strokeWidth:"1.5"}),_.jsx("rect",{x:"16",y:"28",width:"32",height:"4",rx:"1",fill:"#f0f9ff",stroke:"#222",strokeWidth:"1.2"}),_.jsx("rect",{x:"16",y:"36",width:"24",height:"4",rx:"1",fill:"#f0f9ff",stroke:"#222",strokeWidth:"1.2"}),_.jsx("rect",{x:"16",y:"44",width:"28",height:"4",rx:"1",fill:"#f0f9ff",stroke:"#222",strokeWidth:"1.2"}),_.jsx("path",{d:"M24 20 L40 20",stroke:"#222",strokeWidth:"1.5",strokeLinecap:"round"}),_.jsx("path",{d:"M24 32 L48 32",stroke:"#222",strokeWidth:"1.2",strokeDasharray:"2 2"}),_.jsx("path",{d:"M24 40 L40 40",stroke:"#222",strokeWidth:"1.2",strokeDasharray:"2 2"}),_.jsx("path",{d:"M24 48 L44 48",stroke:"#222",strokeWidth:"1.2",strokeDasharray:"2 2"}),_.jsx("path",{d:"M16 24 H48",stroke:"#222",strokeWidth:"1.2"})]}):e==="idea"?_.jsxs("svg",{viewBox:"0 0 64 64",fill:"none",className:t,"aria-label":"Idea Doodle",children:[_.jsx("ellipse",{cx:"32",cy:"32",rx:"16",ry:"20",fill:n?"#fffbe7":"#fff",stroke:"#222",strokeWidth:"2"}),_.jsx("rect",{x:"28",y:"48",width:"8",height:"8",rx:"2",fill:n?"#ffe066":"#eee",stroke:"#222",strokeWidth:"2"}),_.jsx("path",{d:"M32 56 V60",stroke:"#222",strokeWidth:"2"}),_.jsx("path",{d:"M24 60 H40",stroke:"#222",strokeWidth:"2"}),_.jsx("path",{d:"M20 20 Q32 8 44 20",stroke:"#222",strokeWidth:"1.5",fill:"none"}),n&&_.jsxs("g",{children:[_.jsx("ellipse",{cx:"32",cy:"32",rx:"18",ry:"22",fill:"#ffe066",fillOpacity:"0.18"}),_.jsx("ellipse",{cx:"32",cy:"32",rx:"22",ry:"26",fill:"#ffe066",fillOpacity:"0.08"})]})]}):null};function Nr({children:e,delay:t=0}){const n=N.useRef(null),i=W$e(n,{once:!0,margin:"-100px"}),a=F$e();return N.useEffect(()=>{i&&a.start("visible")},[i,a]),_.jsx(Vn.div,{ref:n,initial:"hidden",animate:a,variants:{hidden:{opacity:0,y:60,scale:.98,filter:"blur(6px)"},visible:{opacity:1,y:0,scale:1,filter:"blur(0px)",transition:{type:"spring",stiffness:60,damping:16,duration:.7,delay:t}}},style:{willChange:"opacity, transform, filter"},children:e})}const OGe=()=>{const{user:e}=jc();return _.jsxs("div",{className:"relative",children:[_.jsx(Nr,{children:_.jsx("section",{className:"py-20 md:py-24 bg-gradient-to-b from-blue-50 to-white dark:from-gray-900 dark:to-background",children:_.jsxs("div",{className:"container px-4 md:px-6 relative",children:[_.jsx(cp,{name:"balance-sheet",className:gt("absolute -left-4 top-1/4 w-24 h-24 text-blue-200 -rotate-12","hidden md:block")}),_.jsx(cp,{name:"finance",className:gt("absolute -right-4 top-1/3 w-20 h-20 text-blue-100 rotate-12","hidden md:block")}),_.jsxs(ag,{className:"flex flex-col items-center space-y-4 text-center relative z-10",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsx("h1",{className:"text-3xl font-bold tracking-tighter sm:text-4xl md:text-5xl lg:text-6xl/none",children:"Master Your CA Studies with Unfiltered CA"}),_.jsx("p",{className:"mx-auto max-w-[700px] text-muted-foreground md:text-xl",children:"Your comprehensive platform for CA exam preparation"})]}),_.jsx(ag,{delay:.2,className:"flex flex-col gap-2 min-[400px]:flex-row",children:e?_.jsx(Dt,{to:"/tools",children:_.jsx(Fr,{size:"lg",hoverScale:1.08,children:"Access Study Tools"})}):_.jsxs(_.Fragment,{children:[_.jsx(Dt,{to:"/register",children:_.jsx(Fr,{size:"lg",hoverScale:1.08,children:"Get Started"})}),_.jsx(Dt,{to:"/login",children:_.jsx(Fr,{variant:"outline",size:"lg",hoverScale:1.05,children:"Sign In"})})]})})]})]})})}),_.jsx(Nr,{delay:.1,children:_.jsx("section",{className:"py-16 md:py-20",children:_.jsxs("div",{className:"container px-4 md:px-6",children:[_.jsx(Nr,{children:_.jsx(ag,{className:"flex flex-col items-center justify-center space-y-4 text-center",children:_.jsxs("div",{className:"space-y-2",children:[_.jsx("h2",{className:"text-3xl font-bold tracking-tighter md:text-4xl",children:"Study Tools Designed for CA Students"}),_.jsx("p",{className:"mx-auto max-w-[700px] text-muted-foreground",children:"Everything you need to excel in your chartered accountancy studies, all in one place."})]})})}),_.jsxs(HQ,{className:"mx-auto grid max-w-5xl grid-cols-1 gap-6 py-12 md:grid-cols-2 lg:gap-12",delay:.2,staggerDelay:.1,children:[_.jsx(Nr,{delay:.2,children:_.jsxs("div",{className:"flex flex-col items-start space-y-4 rounded-lg border bg-background p-6",children:[_.jsx("div",{className:"rounded-full bg-primary/10 p-3",children:_.jsx(ese,{className:"h-6 w-6 text-primary"})}),_.jsx("h3",{className:"text-xl font-bold",children:"Pomodoro Timer"}),_.jsx("p",{className:"text-muted-foreground",children:"Stay focused with customizable study intervals. Track subjects and analyze your study patterns."}),e?_.jsx(Dt,{to:"/tools/timer",children:_.jsx(Fr,{variant:"outline",hoverScale:1.05,children:"Try Timer"})}):_.jsx(Dt,{to:"/login",children:_.jsx(Fr,{variant:"outline",hoverScale:1.05,children:"Sign In to Access"})})]})}),_.jsx(Nr,{delay:.3,children:_.jsxs("div",{className:"flex flex-col items-start space-y-4 rounded-lg border bg-background p-6",children:[_.jsx("div",{className:"rounded-full bg-primary/10 p-3",children:_.jsx(Joe,{className:"h-6 w-6 text-primary"})}),_.jsx("h3",{className:"text-xl font-bold",children:"Study Planner"}),_.jsx("p",{className:"text-muted-foreground",children:"Plan your study schedule, set goals, and track your progress across all subjects."}),e?_.jsx(Dt,{to:"/tools/planner",children:_.jsx(Fr,{variant:"outline",hoverScale:1.05,children:"Open Planner"})}):_.jsx(Dt,{to:"/login",children:_.jsx(Fr,{variant:"outline",hoverScale:1.05,children:"Sign In to Access"})})]})}),_.jsx(Nr,{delay:.4,children:_.jsxs("div",{className:"flex flex-col items-start space-y-4 rounded-lg border bg-background p-6",children:[_.jsx("div",{className:"rounded-full bg-primary/10 p-3",children:_.jsx(WE,{className:"h-6 w-6 text-primary"})}),_.jsx("h3",{className:"text-xl font-bold",children:"Study Groups"}),_.jsx("p",{className:"text-muted-foreground",children:"Connect with fellow CA students, share resources, and study together."}),e?_.jsx(Dt,{to:"/tools/rooms",children:_.jsx(Fr,{variant:"outline",hoverScale:1.05,children:"Join Groups"})}):_.jsx(Dt,{to:"/login",children:_.jsx(Fr,{variant:"outline",hoverScale:1.05,children:"Sign In to Access"})})]})}),_.jsx(Nr,{delay:.5,children:_.jsxs("div",{className:"flex flex-col items-start space-y-4 rounded-lg border bg-background p-6",children:[_.jsx("div",{className:"rounded-full bg-primary/10 p-3",children:_.jsx(Sb,{className:"h-6 w-6 text-primary"})}),_.jsx("h3",{className:"text-xl font-bold",children:"Study Resources"}),_.jsx("p",{className:"text-muted-foreground",children:"Access curated study materials, PDFs, and video tutorials to help you prepare for exams."}),e?_.jsx(Dt,{to:"/resources",children:_.jsx(Fr,{variant:"outline",hoverScale:1.05,children:"View Resources"})}):_.jsx(Dt,{to:"/login",children:_.jsx(Fr,{variant:"outline",hoverScale:1.05,children:"Sign In to Access"})})]})})]})]})})}),_.jsx(Nr,{delay:.2,children:_.jsx("section",{className:"py-16 md:py-20 bg-muted/50",children:_.jsxs("div",{className:"container px-4 md:px-6",children:[_.jsx(Nr,{children:_.jsx(ag,{className:"flex flex-col items-center justify-center space-y-4 text-center",children:_.jsxs("div",{className:"space-y-2",children:[_.jsx("h2",{className:"text-3xl font-bold tracking-tighter md:text-4xl",children:"What Our Students Say"}),_.jsx("p",{className:"mx-auto max-w-[700px] text-muted-foreground",children:"Join thousands of successful CA students who have transformed their study experience."})]})})}),_.jsxs(HQ,{className:"mx-auto grid max-w-5xl grid-cols-1 gap-6 py-12 md:grid-cols-3",delay:.2,staggerDelay:.1,children:[_.jsx(Nr,{delay:.2,children:_.jsxs("div",{className:"flex flex-col justify-between space-y-4 rounded-lg border bg-background p-6",children:[_.jsx("div",{className:"space-y-2",children:_.jsx("p",{className:"text-muted-foreground",children:`"The Pomodoro timer has completely changed how I study. I'm more focused and productive than ever."`})}),_.jsxs("div",{children:[_.jsx("p",{className:"font-medium",children:"Priya S."}),_.jsx("p",{className:"text-sm text-muted-foreground",children:"CA Intermediate"})]})]})}),_.jsx(Nr,{delay:.3,children:_.jsxs("div",{className:"flex flex-col justify-between space-y-4 rounded-lg border bg-background p-6",children:[_.jsx("div",{className:"space-y-2",children:_.jsx("p",{className:"text-muted-foreground",children:'"The study planner helps me stay organized and ensures I cover all subjects effectively."'})}),_.jsxs("div",{children:[_.jsx("p",{className:"font-medium",children:"Rahul M."}),_.jsx("p",{className:"text-sm text-muted-foreground",children:"CA Foundation"})]})]})}),_.jsx(Nr,{delay:.4,children:_.jsxs("div",{className:"flex flex-col justify-between space-y-4 rounded-lg border bg-background p-6",children:[_.jsx("div",{className:"space-y-2",children:_.jsx("p",{className:"text-muted-foreground",children:'"The study groups feature helped me connect with other students and share valuable resources."'})}),_.jsxs("div",{children:[_.jsx("p",{className:"font-medium",children:"Ananya K."}),_.jsx("p",{className:"text-sm text-muted-foreground",children:"CA Final"})]})]})})]})]})})}),_.jsx("section",{className:"py-16 md:py-20",children:_.jsx("div",{className:"container px-4 md:px-6",children:_.jsxs(ag,{className:"flex flex-col items-center justify-center space-y-4 text-center",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsx("h2",{className:"text-3xl font-bold tracking-tighter md:text-4xl",children:"Ready to Elevate Your CA Studies?"}),_.jsx("p",{className:"mx-auto max-w-[600px] text-muted-foreground md:text-xl",children:"Join thousands of CA students who are studying smarter, not harder."})]}),_.jsx(ag,{delay:.2,className:"flex flex-col gap-2 min-[400px]:flex-row",children:e?_.jsx(Dt,{to:"/tools",children:_.jsx(Fr,{size:"lg",hoverScale:1.08,children:"Access All Tools"})}):_.jsxs(_.Fragment,{children:[_.jsx(Dt,{to:"/register",children:_.jsx(Fr,{size:"lg",hoverScale:1.08,children:"Create Free Account"})}),_.jsx(Dt,{to:"/login",children:_.jsx(Fr,{variant:"outline",size:"lg",hoverScale:1.05,children:"Sign In"})})]})})]})})}),_.jsx("div",{className:"fixed bottom-4 right-4 z-0 opacity-60 pointer-events-none select-none",children:_.jsx(cp,{name:"finance",className:"w-40 h-40"})})]})},Zn=N.forwardRef(({className:e,...t},n)=>_.jsx("div",{ref:n,className:gt("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Zn.displayName="Card";const Zr=N.forwardRef(({className:e,...t},n)=>_.jsx("div",{ref:n,className:gt("flex flex-col space-y-1.5 p-6",e),...t}));Zr.displayName="CardHeader";const pr=N.forwardRef(({className:e,...t},n)=>_.jsx("h3",{ref:n,className:gt("text-2xl font-semibold leading-none tracking-tight",e),...t}));pr.displayName="CardTitle";const ms=N.forwardRef(({className:e,...t},n)=>_.jsx("p",{ref:n,className:gt("text-sm text-muted-foreground",e),...t}));ms.displayName="CardDescription";const mr=N.forwardRef(({className:e,...t},n)=>_.jsx("div",{ref:n,className:gt("p-6 pt-0",e),...t}));mr.displayName="CardContent";const Iu=N.forwardRef(({className:e,...t},n)=>_.jsx("div",{ref:n,className:gt("flex items-center p-6 pt-0",e),...t}));Iu.displayName="CardFooter";var IGe="Label",Bue=N.forwardRef((e,t)=>_.jsx(yt.label,{...e,ref:t,onMouseDown:n=>{var a;n.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));Bue.displayName=IGe;var $ue=Bue;const xGe=vV("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),fr=N.forwardRef(({className:e,...t},n)=>_.jsx($ue,{ref:n,className:gt(xGe(),e),...t}));fr.displayName=$ue.displayName;function j2(e,[t,n]){return Math.min(n,Math.max(t,e))}function Wue(e){const t=N.useRef({value:e,previous:e});return N.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var PGe=[" ","Enter","ArrowUp","ArrowDown"],NGe=[" ","Enter"],_p="Select",[oI,sI,DGe]=wO(_p),[sy,PEt]=ta(_p,[DGe,Zv]),aI=Zv(),[kGe,Ph]=sy(_p),[LGe,MGe]=sy(_p),Gue=e=>{const{__scopeSelect:t,children:n,open:i,defaultOpen:a,onOpenChange:l,value:d,defaultValue:f,onValueChange:m,dir:v,name:E,autoComplete:S,disabled:T,required:R,form:I}=e,O=aI(t),[P,D]=N.useState(null),[k,M]=N.useState(null),[$,V]=N.useState(!1),W=jS(v),[H,J]=Eh({prop:i,defaultProp:a??!1,onChange:l,caller:_p}),[ee,le]=Eh({prop:d,defaultProp:f,onChange:m,caller:_p}),he=N.useRef(null),de=P?I||!!P.closest("form"):!0,[ae,ce]=N.useState(new Set),ge=Array.from(ae).map(ye=>ye.props.value).join(";");return _.jsx(Dse,{...O,children:_.jsxs(kGe,{required:R,scope:t,trigger:P,onTriggerChange:D,valueNode:k,onValueNodeChange:M,valueNodeHasChildren:$,onValueNodeHasChildrenChange:V,contentId:Tl(),value:ee,onValueChange:le,open:H,onOpenChange:J,dir:W,triggerPointerDownPosRef:he,disabled:T,children:[_.jsx(oI.Provider,{scope:t,children:_.jsx(LGe,{scope:e.__scopeSelect,onNativeOptionAdd:N.useCallback(ye=>{ce(te=>new Set(te).add(ye))},[]),onNativeOptionRemove:N.useCallback(ye=>{ce(te=>{const ne=new Set(te);return ne.delete(ye),ne})},[]),children:n})}),de?_.jsxs(pde,{"aria-hidden":!0,required:R,tabIndex:-1,name:E,autoComplete:S,value:ee,onChange:ye=>le(ye.target.value),disabled:T,form:I,children:[ee===void 0?_.jsx("option",{value:""}):null,Array.from(ae)]},ge):null]})})};Gue.displayName=_p;var Hue="SelectTrigger",Kue=N.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:i=!1,...a}=e,l=aI(n),d=Ph(Hue,n),f=d.disabled||i,m=fn(t,d.onTriggerChange),v=sI(n),E=N.useRef("touch"),[S,T,R]=gde(O=>{const P=v().filter(M=>!M.disabled),D=P.find(M=>M.value===d.value),k=vde(P,O,D);k!==void 0&&d.onValueChange(k.value)}),I=O=>{f||(d.onOpenChange(!0),R()),O&&(d.triggerPointerDownPosRef.current={x:Math.round(O.pageX),y:Math.round(O.pageY)})};return _.jsx(IV,{asChild:!0,...l,children:_.jsx(yt.button,{type:"button",role:"combobox","aria-controls":d.contentId,"aria-expanded":d.open,"aria-required":d.required,"aria-autocomplete":"none",dir:d.dir,"data-state":d.open?"open":"closed",disabled:f,"data-disabled":f?"":void 0,"data-placeholder":mde(d.value)?"":void 0,...a,ref:m,onClick:et(a.onClick,O=>{O.currentTarget.focus(),E.current!=="mouse"&&I(O)}),onPointerDown:et(a.onPointerDown,O=>{E.current=O.pointerType;const P=O.target;P.hasPointerCapture(O.pointerId)&&P.releasePointerCapture(O.pointerId),O.button===0&&O.ctrlKey===!1&&O.pointerType==="mouse"&&(I(O),O.preventDefault())}),onKeyDown:et(a.onKeyDown,O=>{const P=S.current!=="";!(O.ctrlKey||O.altKey||O.metaKey)&&O.key.length===1&&T(O.key),!(P&&O.key===" ")&&PGe.includes(O.key)&&(I(),O.preventDefault())})})})});Kue.displayName=Hue;var zue="SelectValue",Yue=N.forwardRef((e,t)=>{const{__scopeSelect:n,className:i,style:a,children:l,placeholder:d="",...f}=e,m=Ph(zue,n),{onValueNodeHasChildrenChange:v}=m,E=l!==void 0,S=fn(t,m.onValueNodeChange);return Ei(()=>{v(E)},[v,E]),_.jsx(yt.span,{...f,ref:S,style:{pointerEvents:"none"},children:mde(m.value)?_.jsx(_.Fragment,{children:d}):l})});Yue.displayName=zue;var jGe="SelectIcon",que=N.forwardRef((e,t)=>{const{__scopeSelect:n,children:i,...a}=e;return _.jsx(yt.span,{"aria-hidden":!0,...a,ref:t,children:i||"▼"})});que.displayName=jGe;var UGe="SelectPortal",Xue=e=>_.jsx(AS,{asChild:!0,...e});Xue.displayName=UGe;var Ep="SelectContent",Jue=N.forwardRef((e,t)=>{const n=Ph(Ep,e.__scopeSelect),[i,a]=N.useState();if(Ei(()=>{a(new DocumentFragment)},[]),!n.open){const l=i;return l?Ip.createPortal(_.jsx(Que,{scope:e.__scopeSelect,children:_.jsx(oI.Slot,{scope:e.__scopeSelect,children:_.jsx("div",{children:e.children})})}),l):null}return _.jsx(Zue,{...e,ref:t})});Jue.displayName=Ep;var yc=10,[Que,Nh]=sy(Ep),VGe="SelectContentImpl",FGe=gp("SelectContent.RemoveScroll"),Zue=N.forwardRef((e,t)=>{const{__scopeSelect:n,position:i="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:l,onPointerDownOutside:d,side:f,sideOffset:m,align:v,alignOffset:E,arrowPadding:S,collisionBoundary:T,collisionPadding:R,sticky:I,hideWhenDetached:O,avoidCollisions:P,...D}=e,k=Ph(Ep,n),[M,$]=N.useState(null),[V,W]=N.useState(null),H=fn(t,ze=>$(ze)),[J,ee]=N.useState(null),[le,he]=N.useState(null),de=sI(n),[ae,ce]=N.useState(!1),ge=N.useRef(!1);N.useEffect(()=>{if(M)return RF(M)},[M]),CF();const ye=N.useCallback(ze=>{const[Nt,...we]=de().map(Re=>Re.ref.current),[He]=we.slice(-1),Ke=document.activeElement;for(const Re of ze)if(Re===Ke||(Re==null||Re.scrollIntoView({block:"nearest"}),Re===Nt&&V&&(V.scrollTop=0),Re===He&&V&&(V.scrollTop=V.scrollHeight),Re==null||Re.focus(),document.activeElement!==Ke))return},[de,V]),te=N.useCallback(()=>ye([J,M]),[ye,J,M]);N.useEffect(()=>{ae&&te()},[ae,te]);const{onOpenChange:ne,triggerPointerDownPosRef:ue}=k;N.useEffect(()=>{if(M){let ze={x:0,y:0};const Nt=He=>{var Ke,Re;ze={x:Math.abs(Math.round(He.pageX)-(((Ke=ue.current)==null?void 0:Ke.x)??0)),y:Math.abs(Math.round(He.pageY)-(((Re=ue.current)==null?void 0:Re.y)??0))}},we=He=>{ze.x<=10&&ze.y<=10?He.preventDefault():M.contains(He.target)||ne(!1),document.removeEventListener("pointermove",Nt),ue.current=null};return ue.current!==null&&(document.addEventListener("pointermove",Nt),document.addEventListener("pointerup",we,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Nt),document.removeEventListener("pointerup",we,{capture:!0})}}},[M,ne,ue]),N.useEffect(()=>{const ze=()=>ne(!1);return window.addEventListener("blur",ze),window.addEventListener("resize",ze),()=>{window.removeEventListener("blur",ze),window.removeEventListener("resize",ze)}},[ne]);const[_e,Ce]=gde(ze=>{const Nt=de().filter(Ke=>!Ke.disabled),we=Nt.find(Ke=>Ke.ref.current===document.activeElement),He=vde(Nt,ze,we);He&&setTimeout(()=>He.ref.current.focus())}),Ie=N.useCallback((ze,Nt,we)=>{const He=!ge.current&&!we;(k.value!==void 0&&k.value===Nt||He)&&(ee(ze),He&&(ge.current=!0))},[k.value]),Ge=N.useCallback(()=>M==null?void 0:M.focus(),[M]),Ze=N.useCallback((ze,Nt,we)=>{const He=!ge.current&&!we;(k.value!==void 0&&k.value===Nt||He)&&he(ze)},[k.value]),wt=i==="popper"?U2:ede,Ft=wt===U2?{side:f,sideOffset:m,align:v,alignOffset:E,arrowPadding:S,collisionBoundary:T,collisionPadding:R,sticky:I,hideWhenDetached:O,avoidCollisions:P}:{};return _.jsx(Que,{scope:n,content:M,viewport:V,onViewportChange:W,itemRefCallback:Ie,selectedItem:J,onItemLeave:Ge,itemTextRefCallback:Ze,focusSelectedItem:te,selectedItemText:le,position:i,isPositioned:ae,searchRef:_e,children:_.jsx(ZO,{as:FGe,allowPinchZoom:!0,children:_.jsx(XO,{asChild:!0,trapped:k.open,onMountAutoFocus:ze=>{ze.preventDefault()},onUnmountAutoFocus:et(a,ze=>{var Nt;(Nt=k.trigger)==null||Nt.focus({preventScroll:!0}),ze.preventDefault()}),children:_.jsx(qv,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:l,onPointerDownOutside:d,onFocusOutside:ze=>ze.preventDefault(),onDismiss:()=>k.onOpenChange(!1),children:_.jsx(wt,{role:"listbox",id:k.contentId,"data-state":k.open?"open":"closed",dir:k.dir,onContextMenu:ze=>ze.preventDefault(),...D,...Ft,onPlaced:()=>ce(!0),ref:H,style:{display:"flex",flexDirection:"column",outline:"none",...D.style},onKeyDown:et(D.onKeyDown,ze=>{const Nt=ze.ctrlKey||ze.altKey||ze.metaKey;if(ze.key==="Tab"&&ze.preventDefault(),!Nt&&ze.key.length===1&&Ce(ze.key),["ArrowUp","ArrowDown","Home","End"].includes(ze.key)){let He=de().filter(Ke=>!Ke.disabled).map(Ke=>Ke.ref.current);if(["ArrowUp","End"].includes(ze.key)&&(He=He.slice().reverse()),["ArrowUp","ArrowDown"].includes(ze.key)){const Ke=ze.target,Re=He.indexOf(Ke);He=He.slice(Re+1)}setTimeout(()=>ye(He)),ze.preventDefault()}})})})})})})});Zue.displayName=VGe;var BGe="SelectItemAlignedPosition",ede=N.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:i,...a}=e,l=Ph(Ep,n),d=Nh(Ep,n),[f,m]=N.useState(null),[v,E]=N.useState(null),S=fn(t,H=>E(H)),T=sI(n),R=N.useRef(!1),I=N.useRef(!0),{viewport:O,selectedItem:P,selectedItemText:D,focusSelectedItem:k}=d,M=N.useCallback(()=>{if(l.trigger&&l.valueNode&&f&&v&&O&&P&&D){const H=l.trigger.getBoundingClientRect(),J=v.getBoundingClientRect(),ee=l.valueNode.getBoundingClientRect(),le=D.getBoundingClientRect();if(l.dir!=="rtl"){const Ke=le.left-J.left,Re=ee.left-Ke,at=H.left-Re,mt=H.width+at,At=Math.max(mt,J.width),nn=window.innerWidth-yc,Mr=j2(Re,[yc,Math.max(yc,nn-At)]);f.style.minWidth=mt+"px",f.style.left=Mr+"px"}else{const Ke=J.right-le.right,Re=window.innerWidth-ee.right-Ke,at=window.innerWidth-H.right-Re,mt=H.width+at,At=Math.max(mt,J.width),nn=window.innerWidth-yc,Mr=j2(Re,[yc,Math.max(yc,nn-At)]);f.style.minWidth=mt+"px",f.style.right=Mr+"px"}const he=T(),de=window.innerHeight-yc*2,ae=O.scrollHeight,ce=window.getComputedStyle(v),ge=parseInt(ce.borderTopWidth,10),ye=parseInt(ce.paddingTop,10),te=parseInt(ce.borderBottomWidth,10),ne=parseInt(ce.paddingBottom,10),ue=ge+ye+ae+ne+te,_e=Math.min(P.offsetHeight*5,ue),Ce=window.getComputedStyle(O),Ie=parseInt(Ce.paddingTop,10),Ge=parseInt(Ce.paddingBottom,10),Ze=H.top+H.height/2-yc,wt=de-Ze,Ft=P.offsetHeight/2,ze=P.offsetTop+Ft,Nt=ge+ye+ze,we=ue-Nt;if(Nt<=Ze){const Ke=he.length>0&&P===he[he.length-1].ref.current;f.style.bottom="0px";const Re=v.clientHeight-O.offsetTop-O.offsetHeight,at=Math.max(wt,Ft+(Ke?Ge:0)+Re+te),mt=Nt+at;f.style.height=mt+"px"}else{const Ke=he.length>0&&P===he[0].ref.current;f.style.top="0px";const at=Math.max(Ze,ge+O.offsetTop+(Ke?Ie:0)+Ft)+we;f.style.height=at+"px",O.scrollTop=Nt-Ze+O.offsetTop}f.style.margin=`${yc}px 0`,f.style.minHeight=_e+"px",f.style.maxHeight=de+"px",i==null||i(),requestAnimationFrame(()=>R.current=!0)}},[T,l.trigger,l.valueNode,f,v,O,P,D,l.dir,i]);Ei(()=>M(),[M]);const[$,V]=N.useState();Ei(()=>{v&&V(window.getComputedStyle(v).zIndex)},[v]);const W=N.useCallback(H=>{H&&I.current===!0&&(M(),k==null||k(),I.current=!1)},[M,k]);return _.jsx(WGe,{scope:n,contentWrapper:f,shouldExpandOnScrollRef:R,onScrollButtonChange:W,children:_.jsx("div",{ref:m,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:$},children:_.jsx(yt.div,{...a,ref:S,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});ede.displayName=BGe;var $Ge="SelectPopperPosition",U2=N.forwardRef((e,t)=>{const{__scopeSelect:n,align:i="start",collisionPadding:a=yc,...l}=e,d=aI(n);return _.jsx(xV,{...d,...l,ref:t,align:i,collisionPadding:a,style:{boxSizing:"border-box",...l.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});U2.displayName=$Ge;var[WGe,jF]=sy(Ep,{}),V2="SelectViewport",tde=N.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:i,...a}=e,l=Nh(V2,n),d=jF(V2,n),f=fn(t,l.onViewportChange),m=N.useRef(0);return _.jsxs(_.Fragment,{children:[_.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),_.jsx(oI.Slot,{scope:n,children:_.jsx(yt.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:f,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:et(a.onScroll,v=>{const E=v.currentTarget,{contentWrapper:S,shouldExpandOnScrollRef:T}=d;if(T!=null&&T.current&&S){const R=Math.abs(m.current-E.scrollTop);if(R>0){const I=window.innerHeight-yc*2,O=parseFloat(S.style.minHeight),P=parseFloat(S.style.height),D=Math.max(O,P);if(D<I){const k=D+R,M=Math.min(I,k),$=k-M;S.style.height=M+"px",S.style.bottom==="0px"&&(E.scrollTop=$>0?$:0,S.style.justifyContent="flex-end")}}}m.current=E.scrollTop})})})]})});tde.displayName=V2;var nde="SelectGroup",[GGe,HGe]=sy(nde),KGe=N.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e,a=Tl();return _.jsx(GGe,{scope:n,id:a,children:_.jsx(yt.div,{role:"group","aria-labelledby":a,...i,ref:t})})});KGe.displayName=nde;var rde="SelectLabel",ide=N.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e,a=HGe(rde,n);return _.jsx(yt.div,{id:a.id,...i,ref:t})});ide.displayName=rde;var rA="SelectItem",[zGe,ode]=sy(rA),sde=N.forwardRef((e,t)=>{const{__scopeSelect:n,value:i,disabled:a=!1,textValue:l,...d}=e,f=Ph(rA,n),m=Nh(rA,n),v=f.value===i,[E,S]=N.useState(l??""),[T,R]=N.useState(!1),I=fn(t,k=>{var M;return(M=m.itemRefCallback)==null?void 0:M.call(m,k,i,a)}),O=Tl(),P=N.useRef("touch"),D=()=>{a||(f.onValueChange(i),f.onOpenChange(!1))};if(i==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return _.jsx(zGe,{scope:n,value:i,disabled:a,textId:O,isSelected:v,onItemTextChange:N.useCallback(k=>{S(M=>M||((k==null?void 0:k.textContent)??"").trim())},[]),children:_.jsx(oI.ItemSlot,{scope:n,value:i,disabled:a,textValue:E,children:_.jsx(yt.div,{role:"option","aria-labelledby":O,"data-highlighted":T?"":void 0,"aria-selected":v&&T,"data-state":v?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...d,ref:I,onFocus:et(d.onFocus,()=>R(!0)),onBlur:et(d.onBlur,()=>R(!1)),onClick:et(d.onClick,()=>{P.current!=="mouse"&&D()}),onPointerUp:et(d.onPointerUp,()=>{P.current==="mouse"&&D()}),onPointerDown:et(d.onPointerDown,k=>{P.current=k.pointerType}),onPointerMove:et(d.onPointerMove,k=>{var M;P.current=k.pointerType,a?(M=m.onItemLeave)==null||M.call(m):P.current==="mouse"&&k.currentTarget.focus({preventScroll:!0})}),onPointerLeave:et(d.onPointerLeave,k=>{var M;k.currentTarget===document.activeElement&&((M=m.onItemLeave)==null||M.call(m))}),onKeyDown:et(d.onKeyDown,k=>{var $;(($=m.searchRef)==null?void 0:$.current)!==""&&k.key===" "||(NGe.includes(k.key)&&D(),k.key===" "&&k.preventDefault())})})})})});sde.displayName=rA;var xE="SelectItemText",ade=N.forwardRef((e,t)=>{const{__scopeSelect:n,className:i,style:a,...l}=e,d=Ph(xE,n),f=Nh(xE,n),m=ode(xE,n),v=MGe(xE,n),[E,S]=N.useState(null),T=fn(t,D=>S(D),m.onItemTextChange,D=>{var k;return(k=f.itemTextRefCallback)==null?void 0:k.call(f,D,m.value,m.disabled)}),R=E==null?void 0:E.textContent,I=N.useMemo(()=>_.jsx("option",{value:m.value,disabled:m.disabled,children:R},m.value),[m.disabled,m.value,R]),{onNativeOptionAdd:O,onNativeOptionRemove:P}=v;return Ei(()=>(O(I),()=>P(I)),[O,P,I]),_.jsxs(_.Fragment,{children:[_.jsx(yt.span,{id:m.textId,...l,ref:T}),m.isSelected&&d.valueNode&&!d.valueNodeHasChildren?Ip.createPortal(l.children,d.valueNode):null]})});ade.displayName=xE;var cde="SelectItemIndicator",lde=N.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e;return ode(cde,n).isSelected?_.jsx(yt.span,{"aria-hidden":!0,...i,ref:t}):null});lde.displayName=cde;var F2="SelectScrollUpButton",ude=N.forwardRef((e,t)=>{const n=Nh(F2,e.__scopeSelect),i=jF(F2,e.__scopeSelect),[a,l]=N.useState(!1),d=fn(t,i.onScrollButtonChange);return Ei(()=>{if(n.viewport&&n.isPositioned){let f=function(){const v=m.scrollTop>0;l(v)};const m=n.viewport;return f(),m.addEventListener("scroll",f),()=>m.removeEventListener("scroll",f)}},[n.viewport,n.isPositioned]),a?_.jsx(hde,{...e,ref:d,onAutoScroll:()=>{const{viewport:f,selectedItem:m}=n;f&&m&&(f.scrollTop=f.scrollTop-m.offsetHeight)}}):null});ude.displayName=F2;var B2="SelectScrollDownButton",dde=N.forwardRef((e,t)=>{const n=Nh(B2,e.__scopeSelect),i=jF(B2,e.__scopeSelect),[a,l]=N.useState(!1),d=fn(t,i.onScrollButtonChange);return Ei(()=>{if(n.viewport&&n.isPositioned){let f=function(){const v=m.scrollHeight-m.clientHeight,E=Math.ceil(m.scrollTop)<v;l(E)};const m=n.viewport;return f(),m.addEventListener("scroll",f),()=>m.removeEventListener("scroll",f)}},[n.viewport,n.isPositioned]),a?_.jsx(hde,{...e,ref:d,onAutoScroll:()=>{const{viewport:f,selectedItem:m}=n;f&&m&&(f.scrollTop=f.scrollTop+m.offsetHeight)}}):null});dde.displayName=B2;var hde=N.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:i,...a}=e,l=Nh("SelectScrollButton",n),d=N.useRef(null),f=sI(n),m=N.useCallback(()=>{d.current!==null&&(window.clearInterval(d.current),d.current=null)},[]);return N.useEffect(()=>()=>m(),[m]),Ei(()=>{var E;const v=f().find(S=>S.ref.current===document.activeElement);(E=v==null?void 0:v.ref.current)==null||E.scrollIntoView({block:"nearest"})},[f]),_.jsx(yt.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:et(a.onPointerDown,()=>{d.current===null&&(d.current=window.setInterval(i,50))}),onPointerMove:et(a.onPointerMove,()=>{var v;(v=l.onItemLeave)==null||v.call(l),d.current===null&&(d.current=window.setInterval(i,50))}),onPointerLeave:et(a.onPointerLeave,()=>{m()})})}),YGe="SelectSeparator",fde=N.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e;return _.jsx(yt.div,{"aria-hidden":!0,...i,ref:t})});fde.displayName=YGe;var $2="SelectArrow",qGe=N.forwardRef((e,t)=>{const{__scopeSelect:n,...i}=e,a=aI(n),l=Ph($2,n),d=Nh($2,n);return l.open&&d.position==="popper"?_.jsx(PV,{...a,...i,ref:t}):null});qGe.displayName=$2;var XGe="SelectBubbleInput",pde=N.forwardRef(({__scopeSelect:e,value:t,...n},i)=>{const a=N.useRef(null),l=fn(i,a),d=Wue(t);return N.useEffect(()=>{const f=a.current;if(!f)return;const m=window.HTMLSelectElement.prototype,E=Object.getOwnPropertyDescriptor(m,"value").set;if(d!==t&&E){const S=new Event("change",{bubbles:!0});E.call(f,t),f.dispatchEvent(S)}},[d,t]),_.jsx(yt.select,{...n,style:{...Ioe,...n.style},ref:l,defaultValue:t})});pde.displayName=XGe;function mde(e){return e===""||e===void 0}function gde(e){const t=hi(e),n=N.useRef(""),i=N.useRef(0),a=N.useCallback(d=>{const f=n.current+d;t(f),function m(v){n.current=v,window.clearTimeout(i.current),v!==""&&(i.current=window.setTimeout(()=>m(""),1e3))}(f)},[t]),l=N.useCallback(()=>{n.current="",window.clearTimeout(i.current)},[]);return N.useEffect(()=>()=>window.clearTimeout(i.current),[]),[n,a,l]}function vde(e,t,n){const a=t.length>1&&Array.from(t).every(v=>v===t[0])?t[0]:t,l=n?e.indexOf(n):-1;let d=JGe(e,Math.max(l,0));a.length===1&&(d=d.filter(v=>v!==n));const m=d.find(v=>v.textValue.toLowerCase().startsWith(a.toLowerCase()));return m!==n?m:void 0}function JGe(e,t){return e.map((n,i)=>e[(t+i)%e.length])}var QGe=Gue,yde=Kue,ZGe=Yue,e8e=que,t8e=Xue,_de=Jue,n8e=tde,Ede=ide,bde=sde,r8e=ade,i8e=lde,Sde=ude,wde=dde,Tde=fde;const yl=QGe,_l=ZGe,Oc=N.forwardRef(({className:e,children:t,...n},i)=>_.jsxs(yde,{ref:i,className:gt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,_.jsx(e8e,{asChild:!0,children:_.jsx(Qoe,{className:"h-4 w-4 opacity-50"})})]}));Oc.displayName=yde.displayName;const Cde=N.forwardRef(({className:e,...t},n)=>_.jsx(Sde,{ref:n,className:gt("flex cursor-default items-center justify-center py-1",e),...t,children:_.jsx(ALe,{className:"h-4 w-4"})}));Cde.displayName=Sde.displayName;const Rde=N.forwardRef(({className:e,...t},n)=>_.jsx(wde,{ref:n,className:gt("flex cursor-default items-center justify-center py-1",e),...t,children:_.jsx(Qoe,{className:"h-4 w-4"})}));Rde.displayName=wde.displayName;const Ic=N.forwardRef(({className:e,children:t,position:n="popper",...i},a)=>_.jsx(t8e,{children:_.jsxs(_de,{ref:a,className:gt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...i,children:[_.jsx(Cde,{}),_.jsx(n8e,{className:gt("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),_.jsx(Rde,{})]})}));Ic.displayName=_de.displayName;const o8e=N.forwardRef(({className:e,...t},n)=>_.jsx(Ede,{ref:n,className:gt("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));o8e.displayName=Ede.displayName;const Kn=N.forwardRef(({className:e,children:t,...n},i)=>_.jsxs(bde,{ref:i,className:gt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[_.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:_.jsx(i8e,{children:_.jsx(RO,{className:"h-4 w-4"})})}),_.jsx(r8e,{children:t})]}));Kn.displayName=bde.displayName;const s8e=N.forwardRef(({className:e,...t},n)=>_.jsx(Tde,{ref:n,className:gt("-mx-1 my-1 h-px bg-muted",e),...t}));s8e.displayName=Tde.displayName;var cI="Tabs",[a8e,NEt]=ta(cI,[JO]),Ade=JO(),[c8e,UF]=a8e(cI),Ode=N.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,onValueChange:a,defaultValue:l,orientation:d="horizontal",dir:f,activationMode:m="automatic",...v}=e,E=jS(f),[S,T]=Eh({prop:i,onChange:a,defaultProp:l??"",caller:cI});return _.jsx(c8e,{scope:n,baseId:Tl(),value:S,onValueChange:T,orientation:d,dir:E,activationMode:m,children:_.jsx(yt.div,{dir:E,"data-orientation":d,...v,ref:t})})});Ode.displayName=cI;var Ide="TabsList",xde=N.forwardRef((e,t)=>{const{__scopeTabs:n,loop:i=!0,...a}=e,l=UF(Ide,n),d=Ade(n);return _.jsx(ple,{asChild:!0,...d,orientation:l.orientation,dir:l.dir,loop:i,children:_.jsx(yt.div,{role:"tablist","aria-orientation":l.orientation,...a,ref:t})})});xde.displayName=Ide;var Pde="TabsTrigger",Nde=N.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,disabled:a=!1,...l}=e,d=UF(Pde,n),f=Ade(n),m=Lde(d.baseId,i),v=Mde(d.baseId,i),E=i===d.value;return _.jsx(mle,{asChild:!0,...f,focusable:!a,active:E,children:_.jsx(yt.button,{type:"button",role:"tab","aria-selected":E,"aria-controls":v,"data-state":E?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:m,...l,ref:t,onMouseDown:et(e.onMouseDown,S=>{!a&&S.button===0&&S.ctrlKey===!1?d.onValueChange(i):S.preventDefault()}),onKeyDown:et(e.onKeyDown,S=>{[" ","Enter"].includes(S.key)&&d.onValueChange(i)}),onFocus:et(e.onFocus,()=>{const S=d.activationMode!=="manual";!E&&!a&&S&&d.onValueChange(i)})})})});Nde.displayName=Pde;var Dde="TabsContent",kde=N.forwardRef((e,t)=>{const{__scopeTabs:n,value:i,forceMount:a,children:l,...d}=e,f=UF(Dde,n),m=Lde(f.baseId,i),v=Mde(f.baseId,i),E=i===f.value,S=N.useRef(E);return N.useEffect(()=>{const T=requestAnimationFrame(()=>S.current=!1);return()=>cancelAnimationFrame(T)},[]),_.jsx(Ao,{present:a||E,children:({present:T})=>_.jsx(yt.div,{"data-state":E?"active":"inactive","data-orientation":f.orientation,role:"tabpanel","aria-labelledby":m,hidden:!T,id:v,tabIndex:0,...d,ref:t,style:{...e.style,animationDuration:S.current?"0s":void 0},children:T&&l})})});kde.displayName=Dde;function Lde(e,t){return`${e}-trigger-${t}`}function Mde(e,t){return`${e}-content-${t}`}var l8e=Ode,jde=xde,Ude=Nde,Vde=kde;const lI=l8e,BS=N.forwardRef(({className:e,...t},n)=>_.jsx(jde,{ref:n,className:gt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));BS.displayName=jde.displayName;const gs=N.forwardRef(({className:e,...t},n)=>_.jsx(Ude,{ref:n,className:gt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));gs.displayName=Ude.displayName;const ja=N.forwardRef(({className:e,...t},n)=>_.jsx(Vde,{ref:n,className:gt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));ja.displayName=Vde.displayName;const u8e=({onPomodoroComplete:e})=>{const{toast:t}=Hu(),[n,i]=N.useState(25*60),[a,l]=N.useState(!1),[d,f]=N.useState("focus"),[m,v]=N.useState(25),[E,S]=N.useState(5),[T,R]=N.useState(15),[I,O]=N.useState(""),[P,D]=N.useState([]),[k,M]=N.useState(!1),[$,V]=N.useState("0"),[W,H]=N.useState(""),[J,ee]=N.useState(""),le=N.useRef(null),[he,de]=N.useState("All");N.useEffect(()=>(a?le.current=setInterval(()=>{i(_e=>_e<=1?(clearInterval(le.current),l(!1),t({title:"Timer Completed",description:`Your ${d} session is complete!`}),d==="focus"&&typeof e=="function"&&e(),0):_e-1)},1e3):clearInterval(le.current),()=>clearInterval(le.current)),[a,d,t]);const ae=_e=>{const Ce=Math.floor(_e/60),Ie=_e%60;return`${Ce.toString().padStart(2,"0")}:${Ie.toString().padStart(2,"0")}`},ce=_e=>{f(_e);let Ce;switch(_e){case"focus":Ce=m;break;case"shortBreak":Ce=E;break;case"longBreak":Ce=T;break;default:Ce=m}i(Ce*60),l(!1)},ge=()=>{if(!a&&n===0){let _e;switch(d){case"focus":_e=m;break;case"shortBreak":_e=E;break;case"longBreak":_e=T;break;default:_e=m}i(_e*60)}l(!a),!a&&d==="focus"&&console.log(`Started focus session on: ${I||"Unnamed subject"}`)},ye=()=>{l(!1);let _e;switch(d){case"focus":_e=m;break;case"shortBreak":_e=E;break;case"longBreak":_e=T;break;default:_e=m}i(_e*60)},te=()=>{a&&(l(!1),clearInterval(le.current)),M(!0),V(Math.floor(n/3600).toString()),H(Math.floor(n%3600/60).toString()),ee((n%60).toString().padStart(2,"0"))},ne=()=>{const _e=parseInt($)||0,Ce=parseInt(W)||0,Ie=parseInt(J)||0,Ge=_e*3600+Ce*60+Ie;if(Ge<=0){t({title:"Invalid Time",description:"Please enter a valid time greater than 0",variant:"destructive"});return}i(Ge),M(!1)},ue=()=>{M(!1)};return P.filter(_e=>he==="All"||_e.ca_level===he),_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"container py-8 md:py-12",children:_.jsxs("div",{className:"mx-auto max-w-2xl",children:[_.jsx(Nr,{children:_.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Pomodoro Timer"})}),_.jsx(Nr,{delay:.1,children:_.jsxs(Zn,{className:"mb-8",children:[_.jsx(Zr,{children:_.jsx(pr,{className:"text-center text-2xl",children:d==="focus"?"Focus Time":d==="shortBreak"?"Short Break":"Long Break"})}),_.jsxs(mr,{className:"space-y-6",children:[_.jsxs("div",{className:"mb-4 flex gap-4 items-center",children:[_.jsx("label",{className:"font-medium",children:"CA Level:"}),_.jsxs(yl,{value:he,onValueChange:de,children:[_.jsx(Oc,{className:"w-40",children:_.jsx(_l,{placeholder:"Select CA Level"})}),_.jsxs(Ic,{children:[_.jsx(Kn,{value:"All",children:"All"}),_.jsx(Kn,{value:"Foundation",children:"Foundation"}),_.jsx(Kn,{value:"Inter",children:"Inter"}),_.jsx(Kn,{value:"Final",children:"Final"})]})]})]}),_.jsxs(lI,{defaultValue:"focus",onValueChange:ce,className:"w-full",children:[_.jsxs(BS,{className:"grid grid-cols-3",children:[_.jsx(gs,{value:"focus",children:"Focus"}),_.jsx(gs,{value:"shortBreak",children:"Short Break"}),_.jsx(gs,{value:"longBreak",children:"Long Break"})]}),_.jsx(ja,{value:"focus",className:"space-y-4 mt-4",children:_.jsxs("div",{className:"space-y-2",children:[_.jsx(fr,{htmlFor:"subject",children:"Study Subject"}),_.jsx(_n,{id:"subject",placeholder:"What are you studying?",value:I,onChange:_e=>O(_e.target.value)})]})})]}),_.jsxs("div",{className:"flex flex-col items-center gap-4",children:[_.jsx("div",{className:"relative w-full max-w-[400px]",children:k?_.jsxs("div",{className:"flex items-center justify-center gap-2",children:[_.jsx(_n,{type:"number",min:"0",value:$,onChange:_e=>V(_e.target.value),className:"w-20 text-center text-5xl font-mono h-20",placeholder:"00"}),_.jsx("span",{className:"text-5xl font-mono",children:":"}),_.jsx(_n,{type:"number",min:"0",max:"59",value:W,onChange:_e=>H(_e.target.value),className:"w-20 text-center text-5xl font-mono h-20",placeholder:"00"}),_.jsx("span",{className:"text-5xl font-mono",children:":"}),_.jsx(_n,{type:"number",min:"0",max:"59",value:J,onChange:_e=>ee(_e.target.value.padStart(2,"0")),className:"w-20 text-center text-5xl font-mono h-20",placeholder:"00"})]}):_.jsxs("div",{className:"flex items-center justify-center gap-4",children:[_.jsx("h2",{className:"text-7xl font-mono font-bold",children:ae(n)}),_.jsxs(Fr,{variant:"outline",size:"icon",className:"h-10 w-10 hover:bg-accent",onClick:te,hoverScale:1.1,children:[_.jsx(DLe,{className:"h-5 w-5"}),_.jsx("span",{className:"sr-only",children:"Edit timer"})]})]})}),_.jsx("div",{className:"flex justify-center gap-4 mt-2",children:k?_.jsxs(_.Fragment,{children:[_.jsxs(Fr,{onClick:ne,variant:"default",size:"lg",hoverScale:1.05,className:"min-w-[120px]",children:[_.jsx(RO,{className:"h-5 w-5 mr-2"}),"Save"]}),_.jsxs(Fr,{onClick:ue,variant:"outline",size:"lg",hoverScale:1.05,className:"min-w-[120px]",children:[_.jsx(AO,{className:"h-5 w-5 mr-2"}),"Cancel"]})]}):_.jsxs(_.Fragment,{children:[_.jsx(Fr,{onClick:ge,variant:a?"destructive":"default",size:"lg",hoverScale:1.05,className:"min-w-[120px]",children:a?"Pause":n===0?"Restart":"Start"}),_.jsx(Fr,{onClick:ye,variant:"outline",size:"lg",hoverScale:1.05,className:"min-w-[120px]",children:"Reset"})]})})]})]})]})})]})}),_.jsx("div",{className:"fixed bottom-4 right-4 z-0 opacity-80 pointer-events-none select-none",children:_.jsx(cp,{name:"idea",className:"w-40 h-40",on:a})})]})};var d8e=Array.isArray,ws=d8e,h8e=typeof Ri=="object"&&Ri&&Ri.Object===Object&&Ri,Fde=h8e,f8e=Fde,p8e=typeof self=="object"&&self&&self.Object===Object&&self,m8e=f8e||p8e||Function("return this")(),Ll=m8e,g8e=Ll,v8e=g8e.Symbol,$S=v8e,KQ=$S,Bde=Object.prototype,y8e=Bde.hasOwnProperty,_8e=Bde.toString,lE=KQ?KQ.toStringTag:void 0;function E8e(e){var t=y8e.call(e,lE),n=e[lE];try{e[lE]=void 0;var i=!0}catch{}var a=_8e.call(e);return i&&(t?e[lE]=n:delete e[lE]),a}var b8e=E8e,S8e=Object.prototype,w8e=S8e.toString;function T8e(e){return w8e.call(e)}var C8e=T8e,zQ=$S,R8e=b8e,A8e=C8e,O8e="[object Null]",I8e="[object Undefined]",YQ=zQ?zQ.toStringTag:void 0;function x8e(e){return e==null?e===void 0?I8e:O8e:YQ&&YQ in Object(e)?R8e(e):A8e(e)}var zu=x8e;function P8e(e){return e!=null&&typeof e=="object"}var Yu=P8e,N8e=zu,D8e=Yu,k8e="[object Symbol]";function L8e(e){return typeof e=="symbol"||D8e(e)&&N8e(e)==k8e}var ay=L8e,M8e=ws,j8e=ay,U8e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,V8e=/^\w*$/;function F8e(e,t){if(M8e(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||j8e(e)?!0:V8e.test(e)||!U8e.test(e)||t!=null&&e in Object(t)}var VF=F8e;function B8e(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Dh=B8e;const cy=zn(Dh);var $8e=zu,W8e=Dh,G8e="[object AsyncFunction]",H8e="[object Function]",K8e="[object GeneratorFunction]",z8e="[object Proxy]";function Y8e(e){if(!W8e(e))return!1;var t=$8e(e);return t==H8e||t==K8e||t==G8e||t==z8e}var FF=Y8e;const Xt=zn(FF);var q8e=Ll,X8e=q8e["__core-js_shared__"],J8e=X8e,vL=J8e,qQ=function(){var e=/[^.]+$/.exec(vL&&vL.keys&&vL.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Q8e(e){return!!qQ&&qQ in e}var Z8e=Q8e,eHe=Function.prototype,tHe=eHe.toString;function nHe(e){if(e!=null){try{return tHe.call(e)}catch{}try{return e+""}catch{}}return""}var $de=nHe,rHe=FF,iHe=Z8e,oHe=Dh,sHe=$de,aHe=/[\\^$.*+?()[\]{}|]/g,cHe=/^\[object .+?Constructor\]$/,lHe=Function.prototype,uHe=Object.prototype,dHe=lHe.toString,hHe=uHe.hasOwnProperty,fHe=RegExp("^"+dHe.call(hHe).replace(aHe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function pHe(e){if(!oHe(e)||iHe(e))return!1;var t=rHe(e)?fHe:cHe;return t.test(sHe(e))}var mHe=pHe;function gHe(e,t){return e==null?void 0:e[t]}var vHe=gHe,yHe=mHe,_He=vHe;function EHe(e,t){var n=_He(e,t);return yHe(n)?n:void 0}var kp=EHe,bHe=kp,SHe=bHe(Object,"create"),uI=SHe,XQ=uI;function wHe(){this.__data__=XQ?XQ(null):{},this.size=0}var THe=wHe;function CHe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var RHe=CHe,AHe=uI,OHe="__lodash_hash_undefined__",IHe=Object.prototype,xHe=IHe.hasOwnProperty;function PHe(e){var t=this.__data__;if(AHe){var n=t[e];return n===OHe?void 0:n}return xHe.call(t,e)?t[e]:void 0}var NHe=PHe,DHe=uI,kHe=Object.prototype,LHe=kHe.hasOwnProperty;function MHe(e){var t=this.__data__;return DHe?t[e]!==void 0:LHe.call(t,e)}var jHe=MHe,UHe=uI,VHe="__lodash_hash_undefined__";function FHe(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=UHe&&t===void 0?VHe:t,this}var BHe=FHe,$He=THe,WHe=RHe,GHe=NHe,HHe=jHe,KHe=BHe;function ly(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}ly.prototype.clear=$He;ly.prototype.delete=WHe;ly.prototype.get=GHe;ly.prototype.has=HHe;ly.prototype.set=KHe;var zHe=ly;function YHe(){this.__data__=[],this.size=0}var qHe=YHe;function XHe(e,t){return e===t||e!==e&&t!==t}var BF=XHe,JHe=BF;function QHe(e,t){for(var n=e.length;n--;)if(JHe(e[n][0],t))return n;return-1}var dI=QHe,ZHe=dI,eKe=Array.prototype,tKe=eKe.splice;function nKe(e){var t=this.__data__,n=ZHe(t,e);if(n<0)return!1;var i=t.length-1;return n==i?t.pop():tKe.call(t,n,1),--this.size,!0}var rKe=nKe,iKe=dI;function oKe(e){var t=this.__data__,n=iKe(t,e);return n<0?void 0:t[n][1]}var sKe=oKe,aKe=dI;function cKe(e){return aKe(this.__data__,e)>-1}var lKe=cKe,uKe=dI;function dKe(e,t){var n=this.__data__,i=uKe(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}var hKe=dKe,fKe=qHe,pKe=rKe,mKe=sKe,gKe=lKe,vKe=hKe;function uy(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}uy.prototype.clear=fKe;uy.prototype.delete=pKe;uy.prototype.get=mKe;uy.prototype.has=gKe;uy.prototype.set=vKe;var hI=uy,yKe=kp,_Ke=Ll,EKe=yKe(_Ke,"Map"),$F=EKe,JQ=zHe,bKe=hI,SKe=$F;function wKe(){this.size=0,this.__data__={hash:new JQ,map:new(SKe||bKe),string:new JQ}}var TKe=wKe;function CKe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var RKe=CKe,AKe=RKe;function OKe(e,t){var n=e.__data__;return AKe(t)?n[typeof t=="string"?"string":"hash"]:n.map}var fI=OKe,IKe=fI;function xKe(e){var t=IKe(this,e).delete(e);return this.size-=t?1:0,t}var PKe=xKe,NKe=fI;function DKe(e){return NKe(this,e).get(e)}var kKe=DKe,LKe=fI;function MKe(e){return LKe(this,e).has(e)}var jKe=MKe,UKe=fI;function VKe(e,t){var n=UKe(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}var FKe=VKe,BKe=TKe,$Ke=PKe,WKe=kKe,GKe=jKe,HKe=FKe;function dy(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}dy.prototype.clear=BKe;dy.prototype.delete=$Ke;dy.prototype.get=WKe;dy.prototype.has=GKe;dy.prototype.set=HKe;var WF=dy,Wde=WF,KKe="Expected a function";function GF(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(KKe);var n=function(){var i=arguments,a=t?t.apply(this,i):i[0],l=n.cache;if(l.has(a))return l.get(a);var d=e.apply(this,i);return n.cache=l.set(a,d)||l,d};return n.cache=new(GF.Cache||Wde),n}GF.Cache=Wde;var Gde=GF;const zKe=zn(Gde);var YKe=Gde,qKe=500;function XKe(e){var t=YKe(e,function(i){return n.size===qKe&&n.clear(),i}),n=t.cache;return t}var JKe=XKe,QKe=JKe,ZKe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,eze=/\\(\\)?/g,tze=QKe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(ZKe,function(n,i,a,l){t.push(a?l.replace(eze,"$1"):i||n)}),t}),nze=tze;function rze(e,t){for(var n=-1,i=e==null?0:e.length,a=Array(i);++n<i;)a[n]=t(e[n],n,e);return a}var HF=rze,QQ=$S,ize=HF,oze=ws,sze=ay,ZQ=QQ?QQ.prototype:void 0,eZ=ZQ?ZQ.toString:void 0;function Hde(e){if(typeof e=="string")return e;if(oze(e))return ize(e,Hde)+"";if(sze(e))return eZ?eZ.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var aze=Hde,cze=aze;function lze(e){return e==null?"":cze(e)}var Kde=lze,uze=ws,dze=VF,hze=nze,fze=Kde;function pze(e,t){return uze(e)?e:dze(e,t)?[e]:hze(fze(e))}var zde=pze,mze=ay;function gze(e){if(typeof e=="string"||mze(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var pI=gze,vze=zde,yze=pI;function _ze(e,t){t=vze(t,e);for(var n=0,i=t.length;e!=null&&n<i;)e=e[yze(t[n++])];return n&&n==i?e:void 0}var KF=_ze,Eze=KF;function bze(e,t,n){var i=e==null?void 0:Eze(e,t);return i===void 0?n:i}var Yde=bze;const qs=zn(Yde);function Sze(e){return e==null}var wze=Sze;const En=zn(wze);var Tze=zu,Cze=ws,Rze=Yu,Aze="[object String]";function Oze(e){return typeof e=="string"||!Cze(e)&&Rze(e)&&Tze(e)==Aze}var Ize=Oze;const bp=zn(Ize);var qde={exports:{}},nr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zF=Symbol.for("react.element"),YF=Symbol.for("react.portal"),mI=Symbol.for("react.fragment"),gI=Symbol.for("react.strict_mode"),vI=Symbol.for("react.profiler"),yI=Symbol.for("react.provider"),_I=Symbol.for("react.context"),xze=Symbol.for("react.server_context"),EI=Symbol.for("react.forward_ref"),bI=Symbol.for("react.suspense"),SI=Symbol.for("react.suspense_list"),wI=Symbol.for("react.memo"),TI=Symbol.for("react.lazy"),Pze=Symbol.for("react.offscreen"),Xde;Xde=Symbol.for("react.module.reference");function Ha(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case zF:switch(e=e.type,e){case mI:case vI:case gI:case bI:case SI:return e;default:switch(e=e&&e.$$typeof,e){case xze:case _I:case EI:case TI:case wI:case yI:return e;default:return t}}case YF:return t}}}nr.ContextConsumer=_I;nr.ContextProvider=yI;nr.Element=zF;nr.ForwardRef=EI;nr.Fragment=mI;nr.Lazy=TI;nr.Memo=wI;nr.Portal=YF;nr.Profiler=vI;nr.StrictMode=gI;nr.Suspense=bI;nr.SuspenseList=SI;nr.isAsyncMode=function(){return!1};nr.isConcurrentMode=function(){return!1};nr.isContextConsumer=function(e){return Ha(e)===_I};nr.isContextProvider=function(e){return Ha(e)===yI};nr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===zF};nr.isForwardRef=function(e){return Ha(e)===EI};nr.isFragment=function(e){return Ha(e)===mI};nr.isLazy=function(e){return Ha(e)===TI};nr.isMemo=function(e){return Ha(e)===wI};nr.isPortal=function(e){return Ha(e)===YF};nr.isProfiler=function(e){return Ha(e)===vI};nr.isStrictMode=function(e){return Ha(e)===gI};nr.isSuspense=function(e){return Ha(e)===bI};nr.isSuspenseList=function(e){return Ha(e)===SI};nr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===mI||e===vI||e===gI||e===bI||e===SI||e===Pze||typeof e=="object"&&e!==null&&(e.$$typeof===TI||e.$$typeof===wI||e.$$typeof===yI||e.$$typeof===_I||e.$$typeof===EI||e.$$typeof===Xde||e.getModuleId!==void 0)};nr.typeOf=Ha;qde.exports=nr;var Nze=qde.exports,Dze=zu,kze=Yu,Lze="[object Number]";function Mze(e){return typeof e=="number"||kze(e)&&Dze(e)==Lze}var Jde=Mze;const jze=zn(Jde);var Uze=Jde;function Vze(e){return Uze(e)&&e!=+e}var Fze=Vze;const WS=zn(Fze);var Bo=function(t){return t===0?0:t>0?1:-1},Xf=function(t){return bp(t)&&t.indexOf("%")===t.length-1},rt=function(t){return jze(t)&&!WS(t)},Mi=function(t){return rt(t)||bp(t)},Bze=0,GS=function(t){var n=++Bze;return"".concat(t||"").concat(n)},$o=function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!rt(t)&&!bp(t))return i;var l;if(Xf(t)){var d=t.indexOf("%");l=n*parseFloat(t.slice(0,d))/100}else l=+t;return WS(l)&&(l=i),a&&l>n&&(l=n),l},fg=function(t){if(!t)return null;var n=Object.keys(t);return n&&n.length?t[n[0]]:null},$ze=function(t){if(!Array.isArray(t))return!1;for(var n=t.length,i={},a=0;a<n;a++)if(!i[t[a]])i[t[a]]=!0;else return!0;return!1},Wd=function(t,n){return rt(t)&&rt(n)?function(i){return t+i*(n-t)}:function(){return n}};function W2(e,t,n){return!e||!e.length?null:e.find(function(i){return i&&(typeof t=="function"?t(i):qs(i,t))===n})}var Wze=function(t,n){return rt(t)&&rt(n)?t-n:bp(t)&&bp(n)?t.localeCompare(n):t instanceof Date&&n instanceof Date?t.getTime()-n.getTime():String(t).localeCompare(String(n))};function zg(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var i in t)if({}.hasOwnProperty.call(t,i)&&!{}.hasOwnProperty.call(e,i))return!1;return!0}function G2(e){"@babel/helpers - typeof";return G2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G2(e)}var Gze=["viewBox","children"],Hze=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],tZ=["points","pathLength"],yL={svg:Gze,polygon:tZ,polyline:tZ},qF=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],iA=function(t,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var i=t;if(N.isValidElement(t)&&(i=t.props),!cy(i))return null;var a={};return Object.keys(i).forEach(function(l){qF.includes(l)&&(a[l]=n||function(d){return i[l](i,d)})}),a},Kze=function(t,n,i){return function(a){return t(n,i,a),null}},Sp=function(t,n,i){if(!cy(t)||G2(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(l){var d=t[l];qF.includes(l)&&typeof d=="function"&&(a||(a={}),a[l]=Kze(d,n,i))}),a},zze=["children"],Yze=["children"];function nZ(e,t){if(e==null)return{};var n=qze(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function qze(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var rZ={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},xu=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},iZ=null,_L=null,XF=function e(t){if(t===iZ&&Array.isArray(_L))return _L;var n=[];return N.Children.forEach(t,function(i){En(i)||(Nze.isFragment(i)?n=n.concat(e(i.props.children)):n.push(i))}),_L=n,iZ=t,n};function Ba(e,t){var n=[],i=[];return Array.isArray(t)?i=t.map(function(a){return xu(a)}):i=[xu(t)],XF(e).forEach(function(a){var l=qs(a,"type.displayName")||qs(a,"type.name");i.indexOf(l)!==-1&&n.push(a)}),n}function $s(e,t){var n=Ba(e,t);return n&&n[0]}var oZ=function(t){if(!t||!t.props)return!1;var n=t.props,i=n.width,a=n.height;return!(!rt(i)||i<=0||!rt(a)||a<=0)},Xze=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Jze=function(t){return t&&t.type&&bp(t.type)&&Xze.indexOf(t.type)>=0},Qze=function(t,n,i,a){var l,d=(l=yL==null?void 0:yL[a])!==null&&l!==void 0?l:[];return n.startsWith("data-")||!Xt(t)&&(a&&d.includes(n)||Hze.includes(n))||i&&qF.includes(n)},Vt=function(t,n,i){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(N.isValidElement(t)&&(a=t.props),!cy(a))return null;var l={};return Object.keys(a).forEach(function(d){var f;Qze((f=a)===null||f===void 0?void 0:f[d],d,n,i)&&(l[d]=a[d])}),l},H2=function e(t,n){if(t===n)return!0;var i=N.Children.count(t);if(i!==N.Children.count(n))return!1;if(i===0)return!0;if(i===1)return sZ(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var a=0;a<i;a++){var l=t[a],d=n[a];if(Array.isArray(l)||Array.isArray(d)){if(!e(l,d))return!1}else if(!sZ(l,d))return!1}return!0},sZ=function(t,n){if(En(t)&&En(n))return!0;if(!En(t)&&!En(n)){var i=t.props||{},a=i.children,l=nZ(i,zze),d=n.props||{},f=d.children,m=nZ(d,Yze);return a&&f?zg(l,m)&&H2(a,f):!a&&!f?zg(l,m):!1}return!1},aZ=function(t,n){var i=[],a={};return XF(t).forEach(function(l,d){if(Jze(l))i.push(l);else if(l){var f=xu(l.type),m=n[f]||{},v=m.handler,E=m.once;if(v&&(!E||!a[f])){var S=v(l,f,d);i.push(S),a[f]=!0}}}),i},Zze=function(t){var n=t&&t.type;return n&&rZ[n]?rZ[n]:null},eYe=function(t,n){return XF(n).indexOf(t)},tYe=["children","width","height","viewBox","className","style","title","desc"];function K2(){return K2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},K2.apply(this,arguments)}function nYe(e,t){if(e==null)return{};var n=rYe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function rYe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function z2(e){var t=e.children,n=e.width,i=e.height,a=e.viewBox,l=e.className,d=e.style,f=e.title,m=e.desc,v=nYe(e,tYe),E=a||{width:n,height:i,x:0,y:0},S=un("recharts-surface",l);return se.createElement("svg",K2({},Vt(v,!0,"svg"),{className:S,width:n,height:i,style:d,viewBox:"".concat(E.x," ").concat(E.y," ").concat(E.width," ").concat(E.height)}),se.createElement("title",null,f),se.createElement("desc",null,m),t)}var iYe=["children","className"];function Y2(){return Y2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Y2.apply(this,arguments)}function oYe(e,t){if(e==null)return{};var n=sYe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function sYe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var er=se.forwardRef(function(e,t){var n=e.children,i=e.className,a=oYe(e,iYe),l=un("recharts-layer",i);return se.createElement("g",Y2({className:l},Vt(a,!0),{ref:t}),n)}),Pu=function(t,n){for(var i=arguments.length,a=new Array(i>2?i-2:0),l=2;l<i;l++)a[l-2]=arguments[l]};function aYe(e,t,n){var i=-1,a=e.length;t<0&&(t=-t>a?0:a+t),n=n>a?a:n,n<0&&(n+=a),a=t>n?0:n-t>>>0,t>>>=0;for(var l=Array(a);++i<a;)l[i]=e[i+t];return l}var cYe=aYe,lYe=cYe;function uYe(e,t,n){var i=e.length;return n=n===void 0?i:n,!t&&n>=i?e:lYe(e,t,n)}var dYe=uYe,hYe="\\ud800-\\udfff",fYe="\\u0300-\\u036f",pYe="\\ufe20-\\ufe2f",mYe="\\u20d0-\\u20ff",gYe=fYe+pYe+mYe,vYe="\\ufe0e\\ufe0f",yYe="\\u200d",_Ye=RegExp("["+yYe+hYe+gYe+vYe+"]");function EYe(e){return _Ye.test(e)}var Qde=EYe;function bYe(e){return e.split("")}var SYe=bYe,Zde="\\ud800-\\udfff",wYe="\\u0300-\\u036f",TYe="\\ufe20-\\ufe2f",CYe="\\u20d0-\\u20ff",RYe=wYe+TYe+CYe,AYe="\\ufe0e\\ufe0f",OYe="["+Zde+"]",q2="["+RYe+"]",X2="\\ud83c[\\udffb-\\udfff]",IYe="(?:"+q2+"|"+X2+")",ehe="[^"+Zde+"]",the="(?:\\ud83c[\\udde6-\\uddff]){2}",nhe="[\\ud800-\\udbff][\\udc00-\\udfff]",xYe="\\u200d",rhe=IYe+"?",ihe="["+AYe+"]?",PYe="(?:"+xYe+"(?:"+[ehe,the,nhe].join("|")+")"+ihe+rhe+")*",NYe=ihe+rhe+PYe,DYe="(?:"+[ehe+q2+"?",q2,the,nhe,OYe].join("|")+")",kYe=RegExp(X2+"(?="+X2+")|"+DYe+NYe,"g");function LYe(e){return e.match(kYe)||[]}var MYe=LYe,jYe=SYe,UYe=Qde,VYe=MYe;function FYe(e){return UYe(e)?VYe(e):jYe(e)}var BYe=FYe,$Ye=dYe,WYe=Qde,GYe=BYe,HYe=Kde;function KYe(e){return function(t){t=HYe(t);var n=WYe(t)?GYe(t):void 0,i=n?n[0]:t.charAt(0),a=n?$Ye(n,1).join(""):t.slice(1);return i[e]()+a}}var zYe=KYe,YYe=zYe,qYe=YYe("toUpperCase"),XYe=qYe;const CI=zn(XYe);function br(e){return function(){return e}}const ohe=Math.cos,oA=Math.sin,Vc=Math.sqrt,sA=Math.PI,RI=2*sA,J2=Math.PI,Q2=2*J2,Vf=1e-6,JYe=Q2-Vf;function she(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function QYe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return she;const n=10**t;return function(i){this._+=i[0];for(let a=1,l=i.length;a<l;++a)this._+=Math.round(arguments[a]*n)/n+i[a]}}class ZYe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?she:QYe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,i,a){this._append`Q${+t},${+n},${this._x1=+i},${this._y1=+a}`}bezierCurveTo(t,n,i,a,l,d){this._append`C${+t},${+n},${+i},${+a},${this._x1=+l},${this._y1=+d}`}arcTo(t,n,i,a,l){if(t=+t,n=+n,i=+i,a=+a,l=+l,l<0)throw new Error(`negative radius: ${l}`);let d=this._x1,f=this._y1,m=i-t,v=a-n,E=d-t,S=f-n,T=E*E+S*S;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(T>Vf)if(!(Math.abs(S*m-v*E)>Vf)||!l)this._append`L${this._x1=t},${this._y1=n}`;else{let R=i-d,I=a-f,O=m*m+v*v,P=R*R+I*I,D=Math.sqrt(O),k=Math.sqrt(T),M=l*Math.tan((J2-Math.acos((O+T-P)/(2*D*k)))/2),$=M/k,V=M/D;Math.abs($-1)>Vf&&this._append`L${t+$*E},${n+$*S}`,this._append`A${l},${l},0,0,${+(S*R>E*I)},${this._x1=t+V*m},${this._y1=n+V*v}`}}arc(t,n,i,a,l,d){if(t=+t,n=+n,i=+i,d=!!d,i<0)throw new Error(`negative radius: ${i}`);let f=i*Math.cos(a),m=i*Math.sin(a),v=t+f,E=n+m,S=1^d,T=d?a-l:l-a;this._x1===null?this._append`M${v},${E}`:(Math.abs(this._x1-v)>Vf||Math.abs(this._y1-E)>Vf)&&this._append`L${v},${E}`,i&&(T<0&&(T=T%Q2+Q2),T>JYe?this._append`A${i},${i},0,1,${S},${t-f},${n-m}A${i},${i},0,1,${S},${this._x1=v},${this._y1=E}`:T>Vf&&this._append`A${i},${i},0,${+(T>=J2)},${S},${this._x1=t+i*Math.cos(l)},${this._y1=n+i*Math.sin(l)}`)}rect(t,n,i,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${i=+i}v${+a}h${-i}Z`}toString(){return this._}}function JF(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);t=i}return e},()=>new ZYe(t)}function QF(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ahe(e){this._context=e}ahe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function AI(e){return new ahe(e)}function che(e){return e[0]}function lhe(e){return e[1]}function uhe(e,t){var n=br(!0),i=null,a=AI,l=null,d=JF(f);e=typeof e=="function"?e:e===void 0?che:br(e),t=typeof t=="function"?t:t===void 0?lhe:br(t);function f(m){var v,E=(m=QF(m)).length,S,T=!1,R;for(i==null&&(l=a(R=d())),v=0;v<=E;++v)!(v<E&&n(S=m[v],v,m))===T&&((T=!T)?l.lineStart():l.lineEnd()),T&&l.point(+e(S,v,m),+t(S,v,m));if(R)return l=null,R+""||null}return f.x=function(m){return arguments.length?(e=typeof m=="function"?m:br(+m),f):e},f.y=function(m){return arguments.length?(t=typeof m=="function"?m:br(+m),f):t},f.defined=function(m){return arguments.length?(n=typeof m=="function"?m:br(!!m),f):n},f.curve=function(m){return arguments.length?(a=m,i!=null&&(l=a(i)),f):a},f.context=function(m){return arguments.length?(m==null?i=l=null:l=a(i=m),f):i},f}function kC(e,t,n){var i=null,a=br(!0),l=null,d=AI,f=null,m=JF(v);e=typeof e=="function"?e:e===void 0?che:br(+e),t=typeof t=="function"?t:br(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?lhe:br(+n);function v(S){var T,R,I,O=(S=QF(S)).length,P,D=!1,k,M=new Array(O),$=new Array(O);for(l==null&&(f=d(k=m())),T=0;T<=O;++T){if(!(T<O&&a(P=S[T],T,S))===D)if(D=!D)R=T,f.areaStart(),f.lineStart();else{for(f.lineEnd(),f.lineStart(),I=T-1;I>=R;--I)f.point(M[I],$[I]);f.lineEnd(),f.areaEnd()}D&&(M[T]=+e(P,T,S),$[T]=+t(P,T,S),f.point(i?+i(P,T,S):M[T],n?+n(P,T,S):$[T]))}if(k)return f=null,k+""||null}function E(){return uhe().defined(a).curve(d).context(l)}return v.x=function(S){return arguments.length?(e=typeof S=="function"?S:br(+S),i=null,v):e},v.x0=function(S){return arguments.length?(e=typeof S=="function"?S:br(+S),v):e},v.x1=function(S){return arguments.length?(i=S==null?null:typeof S=="function"?S:br(+S),v):i},v.y=function(S){return arguments.length?(t=typeof S=="function"?S:br(+S),n=null,v):t},v.y0=function(S){return arguments.length?(t=typeof S=="function"?S:br(+S),v):t},v.y1=function(S){return arguments.length?(n=S==null?null:typeof S=="function"?S:br(+S),v):n},v.lineX0=v.lineY0=function(){return E().x(e).y(t)},v.lineY1=function(){return E().x(e).y(n)},v.lineX1=function(){return E().x(i).y(t)},v.defined=function(S){return arguments.length?(a=typeof S=="function"?S:br(!!S),v):a},v.curve=function(S){return arguments.length?(d=S,l!=null&&(f=d(l)),v):d},v.context=function(S){return arguments.length?(S==null?l=f=null:f=d(l=S),v):l},v}class dhe{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function eqe(e){return new dhe(e,!0)}function tqe(e){return new dhe(e,!1)}const ZF={draw(e,t){const n=Vc(t/sA);e.moveTo(n,0),e.arc(0,0,n,0,RI)}},nqe={draw(e,t){const n=Vc(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},hhe=Vc(1/3),rqe=hhe*2,iqe={draw(e,t){const n=Vc(t/rqe),i=n*hhe;e.moveTo(0,-n),e.lineTo(i,0),e.lineTo(0,n),e.lineTo(-i,0),e.closePath()}},oqe={draw(e,t){const n=Vc(t),i=-n/2;e.rect(i,i,n,n)}},sqe=.8908130915292852,fhe=oA(sA/10)/oA(7*sA/10),aqe=oA(RI/10)*fhe,cqe=-ohe(RI/10)*fhe,lqe={draw(e,t){const n=Vc(t*sqe),i=aqe*n,a=cqe*n;e.moveTo(0,-n),e.lineTo(i,a);for(let l=1;l<5;++l){const d=RI*l/5,f=ohe(d),m=oA(d);e.lineTo(m*n,-f*n),e.lineTo(f*i-m*a,m*i+f*a)}e.closePath()}},EL=Vc(3),uqe={draw(e,t){const n=-Vc(t/(EL*3));e.moveTo(0,n*2),e.lineTo(-EL*n,-n),e.lineTo(EL*n,-n),e.closePath()}},Oa=-.5,Ia=Vc(3)/2,Z2=1/Vc(12),dqe=(Z2/2+1)*3,hqe={draw(e,t){const n=Vc(t/dqe),i=n/2,a=n*Z2,l=i,d=n*Z2+n,f=-l,m=d;e.moveTo(i,a),e.lineTo(l,d),e.lineTo(f,m),e.lineTo(Oa*i-Ia*a,Ia*i+Oa*a),e.lineTo(Oa*l-Ia*d,Ia*l+Oa*d),e.lineTo(Oa*f-Ia*m,Ia*f+Oa*m),e.lineTo(Oa*i+Ia*a,Oa*a-Ia*i),e.lineTo(Oa*l+Ia*d,Oa*d-Ia*l),e.lineTo(Oa*f+Ia*m,Oa*m-Ia*f),e.closePath()}};function fqe(e,t){let n=null,i=JF(a);e=typeof e=="function"?e:br(e||ZF),t=typeof t=="function"?t:br(t===void 0?64:+t);function a(){let l;if(n||(n=l=i()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),l)return n=null,l+""||null}return a.type=function(l){return arguments.length?(e=typeof l=="function"?l:br(l),a):e},a.size=function(l){return arguments.length?(t=typeof l=="function"?l:br(+l),a):t},a.context=function(l){return arguments.length?(n=l??null,a):n},a}function aA(){}function cA(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function phe(e){this._context=e}phe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:cA(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:cA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function pqe(e){return new phe(e)}function mhe(e){this._context=e}mhe.prototype={areaStart:aA,areaEnd:aA,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:cA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function mqe(e){return new mhe(e)}function ghe(e){this._context=e}ghe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:cA(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function gqe(e){return new ghe(e)}function vhe(e){this._context=e}vhe.prototype={areaStart:aA,areaEnd:aA,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function vqe(e){return new vhe(e)}function cZ(e){return e<0?-1:1}function lZ(e,t,n){var i=e._x1-e._x0,a=t-e._x1,l=(e._y1-e._y0)/(i||a<0&&-0),d=(n-e._y1)/(a||i<0&&-0),f=(l*a+d*i)/(i+a);return(cZ(l)+cZ(d))*Math.min(Math.abs(l),Math.abs(d),.5*Math.abs(f))||0}function uZ(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function bL(e,t,n){var i=e._x0,a=e._y0,l=e._x1,d=e._y1,f=(l-i)/3;e._context.bezierCurveTo(i+f,a+f*t,l-f,d-f*n,l,d)}function lA(e){this._context=e}lA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:bL(this,this._t0,uZ(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,bL(this,uZ(this,n=lZ(this,e,t)),n);break;default:bL(this,this._t0,n=lZ(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function yhe(e){this._context=new _he(e)}(yhe.prototype=Object.create(lA.prototype)).point=function(e,t){lA.prototype.point.call(this,t,e)};function _he(e){this._context=e}_he.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,a,l){this._context.bezierCurveTo(t,e,i,n,l,a)}};function yqe(e){return new lA(e)}function _qe(e){return new yhe(e)}function Ehe(e){this._context=e}Ehe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=dZ(e),a=dZ(t),l=0,d=1;d<n;++l,++d)this._context.bezierCurveTo(i[0][l],a[0][l],i[1][l],a[1][l],e[d],t[d]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function dZ(e){var t,n=e.length-1,i,a=new Array(n),l=new Array(n),d=new Array(n);for(a[0]=0,l[0]=2,d[0]=e[0]+2*e[1],t=1;t<n-1;++t)a[t]=1,l[t]=4,d[t]=4*e[t]+2*e[t+1];for(a[n-1]=2,l[n-1]=7,d[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=a[t]/l[t-1],l[t]-=i,d[t]-=i*d[t-1];for(a[n-1]=d[n-1]/l[n-1],t=n-2;t>=0;--t)a[t]=(d[t]-a[t+1])/l[t];for(l[n-1]=(e[n]+a[n-1])/2,t=0;t<n-1;++t)l[t]=2*e[t+1]-a[t+1];return[a,l]}function Eqe(e){return new Ehe(e)}function OI(e,t){this._context=e,this._t=t}OI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function bqe(e){return new OI(e,.5)}function Sqe(e){return new OI(e,0)}function wqe(e){return new OI(e,1)}function _v(e,t){if((d=e.length)>1)for(var n=1,i,a,l=e[t[0]],d,f=l.length;n<d;++n)for(a=l,l=e[t[n]],i=0;i<f;++i)l[i][1]+=l[i][0]=isNaN(a[i][1])?a[i][0]:a[i][1]}function ej(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function Tqe(e,t){return e[t]}function Cqe(e){const t=[];return t.key=e,t}function Rqe(){var e=br([]),t=ej,n=_v,i=Tqe;function a(l){var d=Array.from(e.apply(this,arguments),Cqe),f,m=d.length,v=-1,E;for(const S of l)for(f=0,++v;f<m;++f)(d[f][v]=[0,+i(S,d[f].key,v,l)]).data=S;for(f=0,E=QF(t(d));f<m;++f)d[E[f]].index=f;return n(d,E),d}return a.keys=function(l){return arguments.length?(e=typeof l=="function"?l:br(Array.from(l)),a):e},a.value=function(l){return arguments.length?(i=typeof l=="function"?l:br(+l),a):i},a.order=function(l){return arguments.length?(t=l==null?ej:typeof l=="function"?l:br(Array.from(l)),a):t},a.offset=function(l){return arguments.length?(n=l??_v,a):n},a}function Aqe(e,t){if((i=e.length)>0){for(var n,i,a=0,l=e[0].length,d;a<l;++a){for(d=n=0;n<i;++n)d+=e[n][a][1]||0;if(d)for(n=0;n<i;++n)e[n][a][1]/=d}_v(e,t)}}function Oqe(e,t){if((a=e.length)>0){for(var n=0,i=e[t[0]],a,l=i.length;n<l;++n){for(var d=0,f=0;d<a;++d)f+=e[d][n][1]||0;i[n][1]+=i[n][0]=-f/2}_v(e,t)}}function Iqe(e,t){if(!(!((d=e.length)>0)||!((l=(a=e[t[0]]).length)>0))){for(var n=0,i=1,a,l,d;i<l;++i){for(var f=0,m=0,v=0;f<d;++f){for(var E=e[t[f]],S=E[i][1]||0,T=E[i-1][1]||0,R=(S-T)/2,I=0;I<f;++I){var O=e[t[I]],P=O[i][1]||0,D=O[i-1][1]||0;R+=P-D}m+=S,v+=R*S}a[i-1][1]+=a[i-1][0]=n,m&&(n-=v/m)}a[i-1][1]+=a[i-1][0]=n,_v(e,t)}}function jb(e){"@babel/helpers - typeof";return jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jb(e)}var xqe=["type","size","sizeType"];function tj(){return tj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},tj.apply(this,arguments)}function hZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function fZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hZ(Object(n),!0).forEach(function(i){Pqe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hZ(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Pqe(e,t,n){return t=Nqe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nqe(e){var t=Dqe(e,"string");return jb(t)=="symbol"?t:t+""}function Dqe(e,t){if(jb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(jb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kqe(e,t){if(e==null)return{};var n=Lqe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Lqe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var bhe={symbolCircle:ZF,symbolCross:nqe,symbolDiamond:iqe,symbolSquare:oqe,symbolStar:lqe,symbolTriangle:uqe,symbolWye:hqe},Mqe=Math.PI/180,jqe=function(t){var n="symbol".concat(CI(t));return bhe[n]||ZF},Uqe=function(t,n,i){if(n==="area")return t;switch(i){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*Mqe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},Vqe=function(t,n){bhe["symbol".concat(CI(t))]=n},eB=function(t){var n=t.type,i=n===void 0?"circle":n,a=t.size,l=a===void 0?64:a,d=t.sizeType,f=d===void 0?"area":d,m=kqe(t,xqe),v=fZ(fZ({},m),{},{type:i,size:l,sizeType:f}),E=function(){var P=jqe(i),D=fqe().type(P).size(Uqe(l,f,i));return D()},S=v.className,T=v.cx,R=v.cy,I=Vt(v,!0);return T===+T&&R===+R&&l===+l?se.createElement("path",tj({},I,{className:un("recharts-symbols",S),transform:"translate(".concat(T,", ").concat(R,")"),d:E()})):null};eB.registerSymbol=Vqe;function Ev(e){"@babel/helpers - typeof";return Ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ev(e)}function nj(){return nj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},nj.apply(this,arguments)}function pZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Fqe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pZ(Object(n),!0).forEach(function(i){Ub(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pZ(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Bqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $qe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,whe(i.key),i)}}function Wqe(e,t,n){return t&&$qe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gqe(e,t,n){return t=uA(t),Hqe(e,She()?Reflect.construct(t,n||[],uA(e).constructor):t.apply(e,n))}function Hqe(e,t){if(t&&(Ev(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Kqe(e)}function Kqe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function She(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(She=function(){return!!e})()}function uA(e){return uA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},uA(e)}function zqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rj(e,t)}function rj(e,t){return rj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},rj(e,t)}function Ub(e,t,n){return t=whe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function whe(e){var t=Yqe(e,"string");return Ev(t)=="symbol"?t:t+""}function Yqe(e,t){if(Ev(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Ev(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var mc=32,tB=function(e){function t(){return Bqe(this,t),Gqe(this,t,arguments)}return zqe(t,e),Wqe(t,[{key:"renderIcon",value:function(i){var a=this.props.inactiveColor,l=mc/2,d=mc/6,f=mc/3,m=i.inactive?a:i.color;if(i.type==="plainline")return se.createElement("line",{strokeWidth:4,fill:"none",stroke:m,strokeDasharray:i.payload.strokeDasharray,x1:0,y1:l,x2:mc,y2:l,className:"recharts-legend-icon"});if(i.type==="line")return se.createElement("path",{strokeWidth:4,fill:"none",stroke:m,d:"M0,".concat(l,"h").concat(f,`
            A`).concat(d,",").concat(d,",0,1,1,").concat(2*f,",").concat(l,`
            H`).concat(mc,"M").concat(2*f,",").concat(l,`
            A`).concat(d,",").concat(d,",0,1,1,").concat(f,",").concat(l),className:"recharts-legend-icon"});if(i.type==="rect")return se.createElement("path",{stroke:"none",fill:m,d:"M0,".concat(mc/8,"h").concat(mc,"v").concat(mc*3/4,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(se.isValidElement(i.legendIcon)){var v=Fqe({},i);return delete v.legendIcon,se.cloneElement(i.legendIcon,v)}return se.createElement(eB,{fill:m,cx:l,cy:l,size:mc,sizeType:"diameter",type:i.type})}},{key:"renderItems",value:function(){var i=this,a=this.props,l=a.payload,d=a.iconSize,f=a.layout,m=a.formatter,v=a.inactiveColor,E={x:0,y:0,width:mc,height:mc},S={display:f==="horizontal"?"inline-block":"block",marginRight:10},T={display:"inline-block",verticalAlign:"middle",marginRight:4};return l.map(function(R,I){var O=R.formatter||m,P=un(Ub(Ub({"recharts-legend-item":!0},"legend-item-".concat(I),!0),"inactive",R.inactive));if(R.type==="none")return null;var D=Xt(R.value)?null:R.value;Pu(!Xt(R.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var k=R.inactive?v:R.color;return se.createElement("li",nj({className:P,style:S,key:"legend-item-".concat(I)},Sp(i.props,R,I)),se.createElement(z2,{width:d,height:d,viewBox:E,style:T},i.renderIcon(R)),se.createElement("span",{className:"recharts-legend-item-text",style:{color:k}},O?O(D,R,I):D))})}},{key:"render",value:function(){var i=this.props,a=i.payload,l=i.layout,d=i.align;if(!a||!a.length)return null;var f={padding:0,margin:0,textAlign:l==="horizontal"?d:"left"};return se.createElement("ul",{className:"recharts-default-legend",style:f},this.renderItems())}}])}(N.PureComponent);Ub(tB,"displayName","Legend");Ub(tB,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var qqe=hI;function Xqe(){this.__data__=new qqe,this.size=0}var Jqe=Xqe;function Qqe(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var Zqe=Qqe;function e9e(e){return this.__data__.get(e)}var t9e=e9e;function n9e(e){return this.__data__.has(e)}var r9e=n9e,i9e=hI,o9e=$F,s9e=WF,a9e=200;function c9e(e,t){var n=this.__data__;if(n instanceof i9e){var i=n.__data__;if(!o9e||i.length<a9e-1)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new s9e(i)}return n.set(e,t),this.size=n.size,this}var l9e=c9e,u9e=hI,d9e=Jqe,h9e=Zqe,f9e=t9e,p9e=r9e,m9e=l9e;function hy(e){var t=this.__data__=new u9e(e);this.size=t.size}hy.prototype.clear=d9e;hy.prototype.delete=h9e;hy.prototype.get=f9e;hy.prototype.has=p9e;hy.prototype.set=m9e;var The=hy,g9e="__lodash_hash_undefined__";function v9e(e){return this.__data__.set(e,g9e),this}var y9e=v9e;function _9e(e){return this.__data__.has(e)}var E9e=_9e,b9e=WF,S9e=y9e,w9e=E9e;function dA(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new b9e;++t<n;)this.add(e[t])}dA.prototype.add=dA.prototype.push=S9e;dA.prototype.has=w9e;var Che=dA;function T9e(e,t){for(var n=-1,i=e==null?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}var Rhe=T9e;function C9e(e,t){return e.has(t)}var Ahe=C9e,R9e=Che,A9e=Rhe,O9e=Ahe,I9e=1,x9e=2;function P9e(e,t,n,i,a,l){var d=n&I9e,f=e.length,m=t.length;if(f!=m&&!(d&&m>f))return!1;var v=l.get(e),E=l.get(t);if(v&&E)return v==t&&E==e;var S=-1,T=!0,R=n&x9e?new R9e:void 0;for(l.set(e,t),l.set(t,e);++S<f;){var I=e[S],O=t[S];if(i)var P=d?i(O,I,S,t,e,l):i(I,O,S,e,t,l);if(P!==void 0){if(P)continue;T=!1;break}if(R){if(!A9e(t,function(D,k){if(!O9e(R,k)&&(I===D||a(I,D,n,i,l)))return R.push(k)})){T=!1;break}}else if(!(I===O||a(I,O,n,i,l))){T=!1;break}}return l.delete(e),l.delete(t),T}var Ohe=P9e,N9e=Ll,D9e=N9e.Uint8Array,k9e=D9e;function L9e(e){var t=-1,n=Array(e.size);return e.forEach(function(i,a){n[++t]=[a,i]}),n}var M9e=L9e;function j9e(e){var t=-1,n=Array(e.size);return e.forEach(function(i){n[++t]=i}),n}var nB=j9e,mZ=$S,gZ=k9e,U9e=BF,V9e=Ohe,F9e=M9e,B9e=nB,$9e=1,W9e=2,G9e="[object Boolean]",H9e="[object Date]",K9e="[object Error]",z9e="[object Map]",Y9e="[object Number]",q9e="[object RegExp]",X9e="[object Set]",J9e="[object String]",Q9e="[object Symbol]",Z9e="[object ArrayBuffer]",e7e="[object DataView]",vZ=mZ?mZ.prototype:void 0,SL=vZ?vZ.valueOf:void 0;function t7e(e,t,n,i,a,l,d){switch(n){case e7e:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Z9e:return!(e.byteLength!=t.byteLength||!l(new gZ(e),new gZ(t)));case G9e:case H9e:case Y9e:return U9e(+e,+t);case K9e:return e.name==t.name&&e.message==t.message;case q9e:case J9e:return e==t+"";case z9e:var f=F9e;case X9e:var m=i&$9e;if(f||(f=B9e),e.size!=t.size&&!m)return!1;var v=d.get(e);if(v)return v==t;i|=W9e,d.set(e,t);var E=V9e(f(e),f(t),i,a,l,d);return d.delete(e),E;case Q9e:if(SL)return SL.call(e)==SL.call(t)}return!1}var n7e=t7e;function r7e(e,t){for(var n=-1,i=t.length,a=e.length;++n<i;)e[a+n]=t[n];return e}var Ihe=r7e,i7e=Ihe,o7e=ws;function s7e(e,t,n){var i=t(e);return o7e(e)?i:i7e(i,n(e))}var a7e=s7e;function c7e(e,t){for(var n=-1,i=e==null?0:e.length,a=0,l=[];++n<i;){var d=e[n];t(d,n,e)&&(l[a++]=d)}return l}var l7e=c7e;function u7e(){return[]}var d7e=u7e,h7e=l7e,f7e=d7e,p7e=Object.prototype,m7e=p7e.propertyIsEnumerable,yZ=Object.getOwnPropertySymbols,g7e=yZ?function(e){return e==null?[]:(e=Object(e),h7e(yZ(e),function(t){return m7e.call(e,t)}))}:f7e,v7e=g7e;function y7e(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}var _7e=y7e,E7e=zu,b7e=Yu,S7e="[object Arguments]";function w7e(e){return b7e(e)&&E7e(e)==S7e}var T7e=w7e,_Z=T7e,C7e=Yu,xhe=Object.prototype,R7e=xhe.hasOwnProperty,A7e=xhe.propertyIsEnumerable,O7e=_Z(function(){return arguments}())?_Z:function(e){return C7e(e)&&R7e.call(e,"callee")&&!A7e.call(e,"callee")},rB=O7e,hA={exports:{}};function I7e(){return!1}var x7e=I7e;hA.exports;(function(e,t){var n=Ll,i=x7e,a=t&&!t.nodeType&&t,l=a&&!0&&e&&!e.nodeType&&e,d=l&&l.exports===a,f=d?n.Buffer:void 0,m=f?f.isBuffer:void 0,v=m||i;e.exports=v})(hA,hA.exports);var Phe=hA.exports,P7e=9007199254740991,N7e=/^(?:0|[1-9]\d*)$/;function D7e(e,t){var n=typeof e;return t=t??P7e,!!t&&(n=="number"||n!="symbol"&&N7e.test(e))&&e>-1&&e%1==0&&e<t}var iB=D7e,k7e=9007199254740991;function L7e(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=k7e}var oB=L7e,M7e=zu,j7e=oB,U7e=Yu,V7e="[object Arguments]",F7e="[object Array]",B7e="[object Boolean]",$7e="[object Date]",W7e="[object Error]",G7e="[object Function]",H7e="[object Map]",K7e="[object Number]",z7e="[object Object]",Y7e="[object RegExp]",q7e="[object Set]",X7e="[object String]",J7e="[object WeakMap]",Q7e="[object ArrayBuffer]",Z7e="[object DataView]",eXe="[object Float32Array]",tXe="[object Float64Array]",nXe="[object Int8Array]",rXe="[object Int16Array]",iXe="[object Int32Array]",oXe="[object Uint8Array]",sXe="[object Uint8ClampedArray]",aXe="[object Uint16Array]",cXe="[object Uint32Array]",Pr={};Pr[eXe]=Pr[tXe]=Pr[nXe]=Pr[rXe]=Pr[iXe]=Pr[oXe]=Pr[sXe]=Pr[aXe]=Pr[cXe]=!0;Pr[V7e]=Pr[F7e]=Pr[Q7e]=Pr[B7e]=Pr[Z7e]=Pr[$7e]=Pr[W7e]=Pr[G7e]=Pr[H7e]=Pr[K7e]=Pr[z7e]=Pr[Y7e]=Pr[q7e]=Pr[X7e]=Pr[J7e]=!1;function lXe(e){return U7e(e)&&j7e(e.length)&&!!Pr[M7e(e)]}var uXe=lXe;function dXe(e){return function(t){return e(t)}}var Nhe=dXe,fA={exports:{}};fA.exports;(function(e,t){var n=Fde,i=t&&!t.nodeType&&t,a=i&&!0&&e&&!e.nodeType&&e,l=a&&a.exports===i,d=l&&n.process,f=function(){try{var m=a&&a.require&&a.require("util").types;return m||d&&d.binding&&d.binding("util")}catch{}}();e.exports=f})(fA,fA.exports);var hXe=fA.exports,fXe=uXe,pXe=Nhe,EZ=hXe,bZ=EZ&&EZ.isTypedArray,mXe=bZ?pXe(bZ):fXe,Dhe=mXe,gXe=_7e,vXe=rB,yXe=ws,_Xe=Phe,EXe=iB,bXe=Dhe,SXe=Object.prototype,wXe=SXe.hasOwnProperty;function TXe(e,t){var n=yXe(e),i=!n&&vXe(e),a=!n&&!i&&_Xe(e),l=!n&&!i&&!a&&bXe(e),d=n||i||a||l,f=d?gXe(e.length,String):[],m=f.length;for(var v in e)(t||wXe.call(e,v))&&!(d&&(v=="length"||a&&(v=="offset"||v=="parent")||l&&(v=="buffer"||v=="byteLength"||v=="byteOffset")||EXe(v,m)))&&f.push(v);return f}var CXe=TXe,RXe=Object.prototype;function AXe(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||RXe;return e===n}var OXe=AXe;function IXe(e,t){return function(n){return e(t(n))}}var khe=IXe,xXe=khe,PXe=xXe(Object.keys,Object),NXe=PXe,DXe=OXe,kXe=NXe,LXe=Object.prototype,MXe=LXe.hasOwnProperty;function jXe(e){if(!DXe(e))return kXe(e);var t=[];for(var n in Object(e))MXe.call(e,n)&&n!="constructor"&&t.push(n);return t}var UXe=jXe,VXe=FF,FXe=oB;function BXe(e){return e!=null&&FXe(e.length)&&!VXe(e)}var II=BXe,$Xe=CXe,WXe=UXe,GXe=II;function HXe(e){return GXe(e)?$Xe(e):WXe(e)}var sB=HXe,KXe=a7e,zXe=v7e,YXe=sB;function qXe(e){return KXe(e,YXe,zXe)}var XXe=qXe,SZ=XXe,JXe=1,QXe=Object.prototype,ZXe=QXe.hasOwnProperty;function eJe(e,t,n,i,a,l){var d=n&JXe,f=SZ(e),m=f.length,v=SZ(t),E=v.length;if(m!=E&&!d)return!1;for(var S=m;S--;){var T=f[S];if(!(d?T in t:ZXe.call(t,T)))return!1}var R=l.get(e),I=l.get(t);if(R&&I)return R==t&&I==e;var O=!0;l.set(e,t),l.set(t,e);for(var P=d;++S<m;){T=f[S];var D=e[T],k=t[T];if(i)var M=d?i(k,D,T,t,e,l):i(D,k,T,e,t,l);if(!(M===void 0?D===k||a(D,k,n,i,l):M)){O=!1;break}P||(P=T=="constructor")}if(O&&!P){var $=e.constructor,V=t.constructor;$!=V&&"constructor"in e&&"constructor"in t&&!(typeof $=="function"&&$ instanceof $&&typeof V=="function"&&V instanceof V)&&(O=!1)}return l.delete(e),l.delete(t),O}var tJe=eJe,nJe=kp,rJe=Ll,iJe=nJe(rJe,"DataView"),oJe=iJe,sJe=kp,aJe=Ll,cJe=sJe(aJe,"Promise"),lJe=cJe,uJe=kp,dJe=Ll,hJe=uJe(dJe,"Set"),Lhe=hJe,fJe=kp,pJe=Ll,mJe=fJe(pJe,"WeakMap"),gJe=mJe,ij=oJe,oj=$F,sj=lJe,aj=Lhe,cj=gJe,Mhe=zu,fy=$de,wZ="[object Map]",vJe="[object Object]",TZ="[object Promise]",CZ="[object Set]",RZ="[object WeakMap]",AZ="[object DataView]",yJe=fy(ij),_Je=fy(oj),EJe=fy(sj),bJe=fy(aj),SJe=fy(cj),Ff=Mhe;(ij&&Ff(new ij(new ArrayBuffer(1)))!=AZ||oj&&Ff(new oj)!=wZ||sj&&Ff(sj.resolve())!=TZ||aj&&Ff(new aj)!=CZ||cj&&Ff(new cj)!=RZ)&&(Ff=function(e){var t=Mhe(e),n=t==vJe?e.constructor:void 0,i=n?fy(n):"";if(i)switch(i){case yJe:return AZ;case _Je:return wZ;case EJe:return TZ;case bJe:return CZ;case SJe:return RZ}return t});var wJe=Ff,wL=The,TJe=Ohe,CJe=n7e,RJe=tJe,OZ=wJe,IZ=ws,xZ=Phe,AJe=Dhe,OJe=1,PZ="[object Arguments]",NZ="[object Array]",LC="[object Object]",IJe=Object.prototype,DZ=IJe.hasOwnProperty;function xJe(e,t,n,i,a,l){var d=IZ(e),f=IZ(t),m=d?NZ:OZ(e),v=f?NZ:OZ(t);m=m==PZ?LC:m,v=v==PZ?LC:v;var E=m==LC,S=v==LC,T=m==v;if(T&&xZ(e)){if(!xZ(t))return!1;d=!0,E=!1}if(T&&!E)return l||(l=new wL),d||AJe(e)?TJe(e,t,n,i,a,l):CJe(e,t,m,n,i,a,l);if(!(n&OJe)){var R=E&&DZ.call(e,"__wrapped__"),I=S&&DZ.call(t,"__wrapped__");if(R||I){var O=R?e.value():e,P=I?t.value():t;return l||(l=new wL),a(O,P,n,i,l)}}return T?(l||(l=new wL),RJe(e,t,n,i,a,l)):!1}var PJe=xJe,NJe=PJe,kZ=Yu;function jhe(e,t,n,i,a){return e===t?!0:e==null||t==null||!kZ(e)&&!kZ(t)?e!==e&&t!==t:NJe(e,t,n,i,jhe,a)}var aB=jhe,DJe=The,kJe=aB,LJe=1,MJe=2;function jJe(e,t,n,i){var a=n.length,l=a,d=!i;if(e==null)return!l;for(e=Object(e);a--;){var f=n[a];if(d&&f[2]?f[1]!==e[f[0]]:!(f[0]in e))return!1}for(;++a<l;){f=n[a];var m=f[0],v=e[m],E=f[1];if(d&&f[2]){if(v===void 0&&!(m in e))return!1}else{var S=new DJe;if(i)var T=i(v,E,m,e,t,S);if(!(T===void 0?kJe(E,v,LJe|MJe,i,S):T))return!1}}return!0}var UJe=jJe,VJe=Dh;function FJe(e){return e===e&&!VJe(e)}var Uhe=FJe,BJe=Uhe,$Je=sB;function WJe(e){for(var t=$Je(e),n=t.length;n--;){var i=t[n],a=e[i];t[n]=[i,a,BJe(a)]}return t}var GJe=WJe;function HJe(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}var Vhe=HJe,KJe=UJe,zJe=GJe,YJe=Vhe;function qJe(e){var t=zJe(e);return t.length==1&&t[0][2]?YJe(t[0][0],t[0][1]):function(n){return n===e||KJe(n,e,t)}}var XJe=qJe;function JJe(e,t){return e!=null&&t in Object(e)}var QJe=JJe,ZJe=zde,eQe=rB,tQe=ws,nQe=iB,rQe=oB,iQe=pI;function oQe(e,t,n){t=ZJe(t,e);for(var i=-1,a=t.length,l=!1;++i<a;){var d=iQe(t[i]);if(!(l=e!=null&&n(e,d)))break;e=e[d]}return l||++i!=a?l:(a=e==null?0:e.length,!!a&&rQe(a)&&nQe(d,a)&&(tQe(e)||eQe(e)))}var sQe=oQe,aQe=QJe,cQe=sQe;function lQe(e,t){return e!=null&&cQe(e,t,aQe)}var uQe=lQe,dQe=aB,hQe=Yde,fQe=uQe,pQe=VF,mQe=Uhe,gQe=Vhe,vQe=pI,yQe=1,_Qe=2;function EQe(e,t){return pQe(e)&&mQe(t)?gQe(vQe(e),t):function(n){var i=hQe(n,e);return i===void 0&&i===t?fQe(n,e):dQe(t,i,yQe|_Qe)}}var bQe=EQe;function SQe(e){return e}var py=SQe;function wQe(e){return function(t){return t==null?void 0:t[e]}}var TQe=wQe,CQe=KF;function RQe(e){return function(t){return CQe(t,e)}}var AQe=RQe,OQe=TQe,IQe=AQe,xQe=VF,PQe=pI;function NQe(e){return xQe(e)?OQe(PQe(e)):IQe(e)}var DQe=NQe,kQe=XJe,LQe=bQe,MQe=py,jQe=ws,UQe=DQe;function VQe(e){return typeof e=="function"?e:e==null?MQe:typeof e=="object"?jQe(e)?LQe(e[0],e[1]):kQe(e):UQe(e)}var kh=VQe;function FQe(e,t,n,i){for(var a=e.length,l=n+(i?1:-1);i?l--:++l<a;)if(t(e[l],l,e))return l;return-1}var BQe=FQe;function $Qe(e){return e!==e}var WQe=$Qe;function GQe(e,t,n){for(var i=n-1,a=e.length;++i<a;)if(e[i]===t)return i;return-1}var HQe=GQe,KQe=BQe,zQe=WQe,YQe=HQe;function qQe(e,t,n){return t===t?YQe(e,t,n):KQe(e,zQe,n)}var XQe=qQe,JQe=XQe;function QQe(e,t){var n=e==null?0:e.length;return!!n&&JQe(e,t,0)>-1}var ZQe=QQe;function eZe(e,t,n){for(var i=-1,a=e==null?0:e.length;++i<a;)if(n(t,e[i]))return!0;return!1}var tZe=eZe;function nZe(){}var rZe=nZe,TL=Lhe,iZe=rZe,oZe=nB,sZe=1/0,aZe=TL&&1/oZe(new TL([,-0]))[1]==sZe?function(e){return new TL(e)}:iZe,cZe=aZe,lZe=Che,uZe=ZQe,dZe=tZe,hZe=Ahe,fZe=cZe,pZe=nB,mZe=200;function gZe(e,t,n){var i=-1,a=uZe,l=e.length,d=!0,f=[],m=f;if(n)d=!1,a=dZe;else if(l>=mZe){var v=t?null:fZe(e);if(v)return pZe(v);d=!1,a=hZe,m=new lZe}else m=t?[]:f;e:for(;++i<l;){var E=e[i],S=t?t(E):E;if(E=n||E!==0?E:0,d&&S===S){for(var T=m.length;T--;)if(m[T]===S)continue e;t&&m.push(S),f.push(E)}else a(m,S,n)||(m!==f&&m.push(S),f.push(E))}return f}var vZe=gZe,yZe=kh,_Ze=vZe;function EZe(e,t){return e&&e.length?_Ze(e,yZe(t)):[]}var bZe=EZe;const LZ=zn(bZe);function Fhe(e,t,n){return t===!0?LZ(e,n):Xt(t)?LZ(e,t):e}function bv(e){"@babel/helpers - typeof";return bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bv(e)}var SZe=["ref"];function MZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function ou(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?MZ(Object(n),!0).forEach(function(i){xI(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):MZ(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function wZe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,$he(i.key),i)}}function TZe(e,t,n){return t&&jZ(e.prototype,t),n&&jZ(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function CZe(e,t,n){return t=pA(t),RZe(e,Bhe()?Reflect.construct(t,n||[],pA(e).constructor):t.apply(e,n))}function RZe(e,t){if(t&&(bv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AZe(e)}function AZe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bhe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Bhe=function(){return!!e})()}function pA(e){return pA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},pA(e)}function OZe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lj(e,t)}function lj(e,t){return lj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},lj(e,t)}function xI(e,t,n){return t=$he(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $he(e){var t=IZe(e,"string");return bv(t)=="symbol"?t:t+""}function IZe(e,t){if(bv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(bv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function xZe(e,t){if(e==null)return{};var n=PZe(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function PZe(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function NZe(e){return e.value}function DZe(e,t){if(se.isValidElement(e))return se.cloneElement(e,t);if(typeof e=="function")return se.createElement(e,t);t.ref;var n=xZe(t,SZe);return se.createElement(tB,n)}var UZ=1,ph=function(e){function t(){var n;wZe(this,t);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return n=CZe(this,t,[].concat(a)),xI(n,"lastBoundingBox",{width:-1,height:-1}),n}return OZe(t,e),TZe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();return i.height=this.wrapperNode.offsetHeight,i.width=this.wrapperNode.offsetWidth,i}return null}},{key:"updateBBox",value:function(){var i=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>UZ||Math.abs(a.height-this.lastBoundingBox.height)>UZ)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,i&&i(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,i&&i(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?ou({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(i){var a=this.props,l=a.layout,d=a.align,f=a.verticalAlign,m=a.margin,v=a.chartWidth,E=a.chartHeight,S,T;if(!i||(i.left===void 0||i.left===null)&&(i.right===void 0||i.right===null))if(d==="center"&&l==="vertical"){var R=this.getBBoxSnapshot();S={left:((v||0)-R.width)/2}}else S=d==="right"?{right:m&&m.right||0}:{left:m&&m.left||0};if(!i||(i.top===void 0||i.top===null)&&(i.bottom===void 0||i.bottom===null))if(f==="middle"){var I=this.getBBoxSnapshot();T={top:((E||0)-I.height)/2}}else T=f==="bottom"?{bottom:m&&m.bottom||0}:{top:m&&m.top||0};return ou(ou({},S),T)}},{key:"render",value:function(){var i=this,a=this.props,l=a.content,d=a.width,f=a.height,m=a.wrapperStyle,v=a.payloadUniqBy,E=a.payload,S=ou(ou({position:"absolute",width:d||"auto",height:f||"auto"},this.getDefaultPosition(m)),m);return se.createElement("div",{className:"recharts-legend-wrapper",style:S,ref:function(R){i.wrapperNode=R}},DZe(l,ou(ou({},this.props),{},{payload:Fhe(E,v,NZe)})))}}],[{key:"getWithHeight",value:function(i,a){var l=ou(ou({},this.defaultProps),i.props),d=l.layout;return d==="vertical"&&rt(i.props.height)?{height:i.props.height}:d==="horizontal"?{width:i.props.width||a}:null}}])}(N.PureComponent);xI(ph,"displayName","Legend");xI(ph,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var VZ=$S,kZe=rB,LZe=ws,FZ=VZ?VZ.isConcatSpreadable:void 0;function MZe(e){return LZe(e)||kZe(e)||!!(FZ&&e&&e[FZ])}var jZe=MZe,UZe=Ihe,VZe=jZe;function Whe(e,t,n,i,a){var l=-1,d=e.length;for(n||(n=VZe),a||(a=[]);++l<d;){var f=e[l];t>0&&n(f)?t>1?Whe(f,t-1,n,i,a):UZe(a,f):i||(a[a.length]=f)}return a}var Ghe=Whe;function FZe(e){return function(t,n,i){for(var a=-1,l=Object(t),d=i(t),f=d.length;f--;){var m=d[e?f:++a];if(n(l[m],m,l)===!1)break}return t}}var BZe=FZe,$Ze=BZe,WZe=$Ze(),GZe=WZe,HZe=GZe,KZe=sB;function zZe(e,t){return e&&HZe(e,t,KZe)}var Hhe=zZe,YZe=II;function qZe(e,t){return function(n,i){if(n==null)return n;if(!YZe(n))return e(n,i);for(var a=n.length,l=t?a:-1,d=Object(n);(t?l--:++l<a)&&i(d[l],l,d)!==!1;);return n}}var XZe=qZe,JZe=Hhe,QZe=XZe,ZZe=QZe(JZe),cB=ZZe,eet=cB,tet=II;function net(e,t){var n=-1,i=tet(e)?Array(e.length):[];return eet(e,function(a,l,d){i[++n]=t(a,l,d)}),i}var Khe=net;function ret(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var iet=ret,BZ=ay;function oet(e,t){if(e!==t){var n=e!==void 0,i=e===null,a=e===e,l=BZ(e),d=t!==void 0,f=t===null,m=t===t,v=BZ(t);if(!f&&!v&&!l&&e>t||l&&d&&m&&!f&&!v||i&&d&&m||!n&&m||!a)return 1;if(!i&&!l&&!v&&e<t||v&&n&&a&&!i&&!l||f&&n&&a||!d&&a||!m)return-1}return 0}var set=oet,aet=set;function cet(e,t,n){for(var i=-1,a=e.criteria,l=t.criteria,d=a.length,f=n.length;++i<d;){var m=aet(a[i],l[i]);if(m){if(i>=f)return m;var v=n[i];return m*(v=="desc"?-1:1)}}return e.index-t.index}var uet=cet,CL=HF,det=KF,het=kh,fet=Khe,pet=iet,met=Nhe,get=uet,vet=py,yet=ws;function _et(e,t,n){t.length?t=CL(t,function(l){return yet(l)?function(d){return det(d,l.length===1?l[0]:l)}:l}):t=[vet];var i=-1;t=CL(t,met(het));var a=fet(e,function(l,d,f){var m=CL(t,function(v){return v(l)});return{criteria:m,index:++i,value:l}});return pet(a,function(l,d){return get(l,d,n)})}var Eet=_et;function bet(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var wet=bet,Tet=wet,$Z=Math.max;function Cet(e,t,n){return t=$Z(t===void 0?e.length-1:t,0),function(){for(var i=arguments,a=-1,l=$Z(i.length-t,0),d=Array(l);++a<l;)d[a]=i[t+a];a=-1;for(var f=Array(t+1);++a<t;)f[a]=i[a];return f[t]=n(d),Tet(e,this,f)}}var Ret=Cet;function Aet(e){return function(){return e}}var Oet=Aet,Iet=kp,xet=function(){try{var e=Iet(Object,"defineProperty");return e({},"",{}),e}catch{}}(),zhe=xet,Pet=Oet,WZ=zhe,Net=py,Det=WZ?function(e,t){return WZ(e,"toString",{configurable:!0,enumerable:!1,value:Pet(t),writable:!0})}:Net,ket=Det,Let=800,Met=16,jet=Date.now;function Uet(e){var t=0,n=0;return function(){var i=jet(),a=Met-(i-n);if(n=i,a>0){if(++t>=Let)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Vet=Uet,Fet=ket,Bet=Vet,$et=Bet(Fet),Wet=$et,Get=py,Het=Ret,Ket=Wet;function zet(e,t){return Ket(Het(e,t,Get),e+"")}var Yet=zet,qet=BF,Xet=II,Jet=iB,Qet=Dh;function Zet(e,t,n){if(!Qet(n))return!1;var i=typeof t;return(i=="number"?Xet(n)&&Jet(t,n.length):i=="string"&&t in n)?qet(n[t],e):!1}var PI=Zet,ett=Ghe,ttt=Eet,ntt=Yet,GZ=PI,rtt=ntt(function(e,t){if(e==null)return[];var n=t.length;return n>1&&GZ(e,t[0],t[1])?t=[]:n>2&&GZ(t[0],t[1],t[2])&&(t=[t[0]]),ttt(e,ett(t,1),[])}),itt=rtt;const lB=zn(itt);function Vb(e){"@babel/helpers - typeof";return Vb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vb(e)}function uj(){return uj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},uj.apply(this,arguments)}function ott(e,t){return ltt(e)||ctt(e,t)||att(e,t)||stt()}function stt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function att(e,t){if(e){if(typeof e=="string")return HZ(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return HZ(e,t)}}function HZ(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ctt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,a,l,d,f=[],m=!0,v=!1;try{if(l=(n=n.call(e)).next,t!==0)for(;!(m=(i=l.call(n)).done)&&(f.push(i.value),f.length!==t);m=!0);}catch(E){v=!0,a=E}finally{try{if(!m&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(v)throw a}}return f}}function ltt(e){if(Array.isArray(e))return e}function KZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function RL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?KZ(Object(n),!0).forEach(function(i){utt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):KZ(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function utt(e,t,n){return t=dtt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dtt(e){var t=htt(e,"string");return Vb(t)=="symbol"?t:t+""}function htt(e,t){if(Vb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Vb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ftt(e){return Array.isArray(e)&&Mi(e[0])&&Mi(e[1])?e.join(" ~ "):e}var ptt=function(t){var n=t.separator,i=n===void 0?" : ":n,a=t.contentStyle,l=a===void 0?{}:a,d=t.itemStyle,f=d===void 0?{}:d,m=t.labelStyle,v=m===void 0?{}:m,E=t.payload,S=t.formatter,T=t.itemSorter,R=t.wrapperClassName,I=t.labelClassName,O=t.label,P=t.labelFormatter,D=t.accessibilityLayer,k=D===void 0?!1:D,M=function(){if(E&&E.length){var de={padding:0,margin:0},ae=(T?lB(E,T):E).map(function(ce,ge){if(ce.type==="none")return null;var ye=RL({display:"block",paddingTop:4,paddingBottom:4,color:ce.color||"#000"},f),te=ce.formatter||S||ftt,ne=ce.value,ue=ce.name,_e=ne,Ce=ue;if(te&&_e!=null&&Ce!=null){var Ie=te(ne,ue,ce,ge,E);if(Array.isArray(Ie)){var Ge=ott(Ie,2);_e=Ge[0],Ce=Ge[1]}else _e=Ie}return se.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(ge),style:ye},Mi(Ce)?se.createElement("span",{className:"recharts-tooltip-item-name"},Ce):null,Mi(Ce)?se.createElement("span",{className:"recharts-tooltip-item-separator"},i):null,se.createElement("span",{className:"recharts-tooltip-item-value"},_e),se.createElement("span",{className:"recharts-tooltip-item-unit"},ce.unit||""))});return se.createElement("ul",{className:"recharts-tooltip-item-list",style:de},ae)}return null},$=RL({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},l),V=RL({margin:0},v),W=!En(O),H=W?O:"",J=un("recharts-default-tooltip",R),ee=un("recharts-tooltip-label",I);W&&P&&E!==void 0&&E!==null&&(H=P(O,E));var le=k?{role:"status","aria-live":"assertive"}:{};return se.createElement("div",uj({className:J,style:$},le),se.createElement("p",{className:ee,style:V},se.isValidElement(H)?H:"".concat(H)),M())};function Fb(e){"@babel/helpers - typeof";return Fb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fb(e)}function MC(e,t,n){return t=mtt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mtt(e){var t=gtt(e,"string");return Fb(t)=="symbol"?t:t+""}function gtt(e,t){if(Fb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Fb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uE="recharts-tooltip-wrapper",vtt={visibility:"hidden"};function ytt(e){var t=e.coordinate,n=e.translateX,i=e.translateY;return un(uE,MC(MC(MC(MC({},"".concat(uE,"-right"),rt(n)&&t&&rt(t.x)&&n>=t.x),"".concat(uE,"-left"),rt(n)&&t&&rt(t.x)&&n<t.x),"".concat(uE,"-bottom"),rt(i)&&t&&rt(t.y)&&i>=t.y),"".concat(uE,"-top"),rt(i)&&t&&rt(t.y)&&i<t.y))}function zZ(e){var t=e.allowEscapeViewBox,n=e.coordinate,i=e.key,a=e.offsetTopLeft,l=e.position,d=e.reverseDirection,f=e.tooltipDimension,m=e.viewBox,v=e.viewBoxDimension;if(l&&rt(l[i]))return l[i];var E=n[i]-f-a,S=n[i]+a;if(t[i])return d[i]?E:S;if(d[i]){var T=E,R=m[i];return T<R?Math.max(S,m[i]):Math.max(E,m[i])}var I=S+f,O=m[i]+v;return I>O?Math.max(E,m[i]):Math.max(S,m[i])}function _tt(e){var t=e.translateX,n=e.translateY,i=e.useTranslate3d;return{transform:i?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function Ett(e){var t=e.allowEscapeViewBox,n=e.coordinate,i=e.offsetTopLeft,a=e.position,l=e.reverseDirection,d=e.tooltipBox,f=e.useTranslate3d,m=e.viewBox,v,E,S;return d.height>0&&d.width>0&&n?(E=zZ({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:i,position:a,reverseDirection:l,tooltipDimension:d.width,viewBox:m,viewBoxDimension:m.width}),S=zZ({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:i,position:a,reverseDirection:l,tooltipDimension:d.height,viewBox:m,viewBoxDimension:m.height}),v=_tt({translateX:E,translateY:S,useTranslate3d:f})):v=vtt,{cssProperties:v,cssClasses:ytt({translateX:E,translateY:S,coordinate:n})}}function Sv(e){"@babel/helpers - typeof";return Sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sv(e)}function YZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function qZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?YZ(Object(n),!0).forEach(function(i){hj(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YZ(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function btt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Stt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,qhe(i.key),i)}}function wtt(e,t,n){return t&&Stt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ttt(e,t,n){return t=mA(t),Ctt(e,Yhe()?Reflect.construct(t,n||[],mA(e).constructor):t.apply(e,n))}function Ctt(e,t){if(t&&(Sv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rtt(e)}function Rtt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yhe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Yhe=function(){return!!e})()}function mA(e){return mA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},mA(e)}function Att(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dj(e,t)}function dj(e,t){return dj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},dj(e,t)}function hj(e,t,n){return t=qhe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qhe(e){var t=Ott(e,"string");return Sv(t)=="symbol"?t:t+""}function Ott(e,t){if(Sv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Sv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var XZ=1,Itt=function(e){function t(){var n;btt(this,t);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return n=Ttt(this,t,[].concat(a)),hj(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),hj(n,"handleKeyDown",function(d){if(d.key==="Escape"){var f,m,v,E;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(f=(m=n.props.coordinate)===null||m===void 0?void 0:m.x)!==null&&f!==void 0?f:0,y:(v=(E=n.props.coordinate)===null||E===void 0?void 0:E.y)!==null&&v!==void 0?v:0}})}}),n}return Att(t,e),wtt(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var i=this.wrapperNode.getBoundingClientRect();(Math.abs(i.width-this.state.lastBoundingBox.width)>XZ||Math.abs(i.height-this.state.lastBoundingBox.height)>XZ)&&this.setState({lastBoundingBox:{width:i.width,height:i.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var i,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((i=this.props.coordinate)===null||i===void 0?void 0:i.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var i=this,a=this.props,l=a.active,d=a.allowEscapeViewBox,f=a.animationDuration,m=a.animationEasing,v=a.children,E=a.coordinate,S=a.hasPayload,T=a.isAnimationActive,R=a.offset,I=a.position,O=a.reverseDirection,P=a.useTranslate3d,D=a.viewBox,k=a.wrapperStyle,M=Ett({allowEscapeViewBox:d,coordinate:E,offsetTopLeft:R,position:I,reverseDirection:O,tooltipBox:this.state.lastBoundingBox,useTranslate3d:P,viewBox:D}),$=M.cssClasses,V=M.cssProperties,W=qZ(qZ({transition:T&&l?"transform ".concat(f,"ms ").concat(m):void 0},V),{},{pointerEvents:"none",visibility:!this.state.dismissed&&l&&S?"visible":"hidden",position:"absolute",top:0,left:0},k);return se.createElement("div",{tabIndex:-1,className:$,style:W,ref:function(J){i.wrapperNode=J}},v)}}])}(N.PureComponent),xtt=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},my={isSsr:xtt()};function wv(e){"@babel/helpers - typeof";return wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wv(e)}function JZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function QZ(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?JZ(Object(n),!0).forEach(function(i){uB(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JZ(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Ptt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ntt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Jhe(i.key),i)}}function Dtt(e,t,n){return t&&Ntt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ktt(e,t,n){return t=gA(t),Ltt(e,Xhe()?Reflect.construct(t,n||[],gA(e).constructor):t.apply(e,n))}function Ltt(e,t){if(t&&(wv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mtt(e)}function Mtt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xhe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xhe=function(){return!!e})()}function gA(e){return gA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},gA(e)}function jtt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fj(e,t)}function fj(e,t){return fj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},fj(e,t)}function uB(e,t,n){return t=Jhe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jhe(e){var t=Utt(e,"string");return wv(t)=="symbol"?t:t+""}function Utt(e,t){if(wv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(wv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Vtt(e){return e.dataKey}function Ftt(e,t){return se.isValidElement(e)?se.cloneElement(e,t):typeof e=="function"?se.createElement(e,t):se.createElement(ptt,t)}var Na=function(e){function t(){return Ptt(this,t),ktt(this,t,arguments)}return jtt(t,e),Dtt(t,[{key:"render",value:function(){var i=this,a=this.props,l=a.active,d=a.allowEscapeViewBox,f=a.animationDuration,m=a.animationEasing,v=a.content,E=a.coordinate,S=a.filterNull,T=a.isAnimationActive,R=a.offset,I=a.payload,O=a.payloadUniqBy,P=a.position,D=a.reverseDirection,k=a.useTranslate3d,M=a.viewBox,$=a.wrapperStyle,V=I??[];S&&V.length&&(V=Fhe(I.filter(function(H){return H.value!=null&&(H.hide!==!0||i.props.includeHidden)}),O,Vtt));var W=V.length>0;return se.createElement(Itt,{allowEscapeViewBox:d,animationDuration:f,animationEasing:m,isAnimationActive:T,active:l,coordinate:E,hasPayload:W,offset:R,position:P,reverseDirection:D,useTranslate3d:k,viewBox:M,wrapperStyle:$},Ftt(v,QZ(QZ({},this.props),{},{payload:V})))}}])}(N.PureComponent);uB(Na,"displayName","Tooltip");uB(Na,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!my.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var Btt=Ll,$tt=function(){return Btt.Date.now()},Wtt=$tt,Gtt=/\s/;function Htt(e){for(var t=e.length;t--&&Gtt.test(e.charAt(t)););return t}var Ktt=Htt,ztt=Ktt,Ytt=/^\s+/;function qtt(e){return e&&e.slice(0,ztt(e)+1).replace(Ytt,"")}var Xtt=qtt,Jtt=Xtt,ZZ=Dh,Qtt=ay,eee=NaN,Ztt=/^[-+]0x[0-9a-f]+$/i,ent=/^0b[01]+$/i,tnt=/^0o[0-7]+$/i,nnt=parseInt;function rnt(e){if(typeof e=="number")return e;if(Qtt(e))return eee;if(ZZ(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ZZ(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Jtt(e);var n=ent.test(e);return n||tnt.test(e)?nnt(e.slice(2),n?2:8):Ztt.test(e)?eee:+e}var Qhe=rnt,int=Dh,AL=Wtt,tee=Qhe,ont="Expected a function",snt=Math.max,ant=Math.min;function cnt(e,t,n){var i,a,l,d,f,m,v=0,E=!1,S=!1,T=!0;if(typeof e!="function")throw new TypeError(ont);t=tee(t)||0,int(n)&&(E=!!n.leading,S="maxWait"in n,l=S?snt(tee(n.maxWait)||0,t):l,T="trailing"in n?!!n.trailing:T);function R(W){var H=i,J=a;return i=a=void 0,v=W,d=e.apply(J,H),d}function I(W){return v=W,f=setTimeout(D,t),E?R(W):d}function O(W){var H=W-m,J=W-v,ee=t-H;return S?ant(ee,l-J):ee}function P(W){var H=W-m,J=W-v;return m===void 0||H>=t||H<0||S&&J>=l}function D(){var W=AL();if(P(W))return k(W);f=setTimeout(D,O(W))}function k(W){return f=void 0,T&&i?R(W):(i=a=void 0,d)}function M(){f!==void 0&&clearTimeout(f),v=0,i=m=a=f=void 0}function $(){return f===void 0?d:k(AL())}function V(){var W=AL(),H=P(W);if(i=arguments,a=this,m=W,H){if(f===void 0)return I(m);if(S)return clearTimeout(f),f=setTimeout(D,t),R(m)}return f===void 0&&(f=setTimeout(D,t)),d}return V.cancel=M,V.flush=$,V}var lnt=cnt,unt=lnt,dnt=Dh,hnt="Expected a function";function fnt(e,t,n){var i=!0,a=!0;if(typeof e!="function")throw new TypeError(hnt);return dnt(n)&&(i="leading"in n?!!n.leading:i,a="trailing"in n?!!n.trailing:a),unt(e,t,{leading:i,maxWait:t,trailing:a})}var pnt=fnt;const Zhe=zn(pnt);function Bb(e){"@babel/helpers - typeof";return Bb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bb(e)}function nee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function jC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nee(Object(n),!0).forEach(function(i){mnt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nee(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function mnt(e,t,n){return t=gnt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gnt(e){var t=vnt(e,"string");return Bb(t)=="symbol"?t:t+""}function vnt(e,t){if(Bb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Bb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ynt(e,t){return Snt(e)||bnt(e,t)||Ent(e,t)||_nt()}function _nt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ent(e,t){if(e){if(typeof e=="string")return ree(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ree(e,t)}}function ree(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function bnt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,a,l,d,f=[],m=!0,v=!1;try{if(l=(n=n.call(e)).next,t!==0)for(;!(m=(i=l.call(n)).done)&&(f.push(i.value),f.length!==t);m=!0);}catch(E){v=!0,a=E}finally{try{if(!m&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(v)throw a}}return f}}function Snt(e){if(Array.isArray(e))return e}var dB=N.forwardRef(function(e,t){var n=e.aspect,i=e.initialDimension,a=i===void 0?{width:-1,height:-1}:i,l=e.width,d=l===void 0?"100%":l,f=e.height,m=f===void 0?"100%":f,v=e.minWidth,E=v===void 0?0:v,S=e.minHeight,T=e.maxHeight,R=e.children,I=e.debounce,O=I===void 0?0:I,P=e.id,D=e.className,k=e.onResize,M=e.style,$=M===void 0?{}:M,V=N.useRef(null),W=N.useRef();W.current=k,N.useImperativeHandle(t,function(){return Object.defineProperty(V.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),V.current},configurable:!0})});var H=N.useState({containerWidth:a.width,containerHeight:a.height}),J=ynt(H,2),ee=J[0],le=J[1],he=N.useCallback(function(ae,ce){le(function(ge){var ye=Math.round(ae),te=Math.round(ce);return ge.containerWidth===ye&&ge.containerHeight===te?ge:{containerWidth:ye,containerHeight:te}})},[]);N.useEffect(function(){var ae=function(ue){var _e,Ce=ue[0].contentRect,Ie=Ce.width,Ge=Ce.height;he(Ie,Ge),(_e=W.current)===null||_e===void 0||_e.call(W,Ie,Ge)};O>0&&(ae=Zhe(ae,O,{trailing:!0,leading:!1}));var ce=new ResizeObserver(ae),ge=V.current.getBoundingClientRect(),ye=ge.width,te=ge.height;return he(ye,te),ce.observe(V.current),function(){ce.disconnect()}},[he,O]);var de=N.useMemo(function(){var ae=ee.containerWidth,ce=ee.containerHeight;if(ae<0||ce<0)return null;Pu(Xf(d)||Xf(m),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,d,m),Pu(!n||n>0,"The aspect(%s) must be greater than zero.",n);var ge=Xf(d)?ae:d,ye=Xf(m)?ce:m;n&&n>0&&(ge?ye=ge/n:ye&&(ge=ye*n),T&&ye>T&&(ye=T)),Pu(ge>0||ye>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,ge,ye,d,m,E,S,n);var te=!Array.isArray(R)&&xu(R.type).endsWith("Chart");return se.Children.map(R,function(ne){return se.isValidElement(ne)?N.cloneElement(ne,jC({width:ge,height:ye},te?{style:jC({height:"100%",width:"100%",maxHeight:ye,maxWidth:ge},ne.props.style)}:{})):ne})},[n,R,m,T,S,E,ee,d]);return se.createElement("div",{id:P?"".concat(P):void 0,className:un("recharts-responsive-container",D),style:jC(jC({},$),{},{width:d,height:m,minWidth:E,minHeight:S,maxHeight:T}),ref:V},de)}),NI=function(t){return null};NI.displayName="Cell";function $b(e){"@babel/helpers - typeof";return $b=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$b(e)}function iee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function pj(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?iee(Object(n),!0).forEach(function(i){wnt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iee(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function wnt(e,t,n){return t=Tnt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tnt(e){var t=Cnt(e,"string");return $b(t)=="symbol"?t:t+""}function Cnt(e,t){if($b(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if($b(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cg={widthCache:{},cacheCount:0},Rnt=2e3,Ant={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},oee="recharts_measurement_span";function Ont(e){var t=pj({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var JE=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||my.isSsr)return{width:0,height:0};var i=Ont(n),a=JSON.stringify({text:t,copyStyle:i});if(cg.widthCache[a])return cg.widthCache[a];try{var l=document.getElementById(oee);l||(l=document.createElement("span"),l.setAttribute("id",oee),l.setAttribute("aria-hidden","true"),document.body.appendChild(l));var d=pj(pj({},Ant),i);Object.assign(l.style,d),l.textContent="".concat(t);var f=l.getBoundingClientRect(),m={width:f.width,height:f.height};return cg.widthCache[a]=m,++cg.cacheCount>Rnt&&(cg.cacheCount=0,cg.widthCache={}),m}catch{return{width:0,height:0}}},Int=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Wb(e){"@babel/helpers - typeof";return Wb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wb(e)}function vA(e,t){return Dnt(e)||Nnt(e,t)||Pnt(e,t)||xnt()}function xnt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pnt(e,t){if(e){if(typeof e=="string")return see(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return see(e,t)}}function see(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Nnt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,a,l,d,f=[],m=!0,v=!1;try{if(l=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;m=!1}else for(;!(m=(i=l.call(n)).done)&&(f.push(i.value),f.length!==t);m=!0);}catch(E){v=!0,a=E}finally{try{if(!m&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(v)throw a}}return f}}function Dnt(e){if(Array.isArray(e))return e}function knt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Mnt(i.key),i)}}function Lnt(e,t,n){return t&&aee(e.prototype,t),n&&aee(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Mnt(e){var t=jnt(e,"string");return Wb(t)=="symbol"?t:t+""}function jnt(e,t){if(Wb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Wb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var cee=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,lee=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Unt=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Vnt=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,efe={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Fnt=Object.keys(efe),Ng="NaN";function Bnt(e,t){return e*efe[t]}var UC=function(){function e(t,n){knt(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!Unt.test(n)&&(this.num=NaN,this.unit=""),Fnt.includes(n)&&(this.num=Bnt(t,n),this.unit="px")}return Lnt(e,[{key:"add",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var i,a=(i=Vnt.exec(n))!==null&&i!==void 0?i:[],l=vA(a,3),d=l[1],f=l[2];return new e(parseFloat(d),f??"")}}])}();function tfe(e){if(e.includes(Ng))return Ng;for(var t=e;t.includes("*")||t.includes("/");){var n,i=(n=cee.exec(t))!==null&&n!==void 0?n:[],a=vA(i,4),l=a[1],d=a[2],f=a[3],m=UC.parse(l??""),v=UC.parse(f??""),E=d==="*"?m.multiply(v):m.divide(v);if(E.isNaN())return Ng;t=t.replace(cee,E.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var S,T=(S=lee.exec(t))!==null&&S!==void 0?S:[],R=vA(T,4),I=R[1],O=R[2],P=R[3],D=UC.parse(I??""),k=UC.parse(P??""),M=O==="+"?D.add(k):D.subtract(k);if(M.isNaN())return Ng;t=t.replace(lee,M.toString())}return t}var uee=/\(([^()]*)\)/;function $nt(e){for(var t=e;t.includes("(");){var n=uee.exec(t),i=vA(n,2),a=i[1];t=t.replace(uee,tfe(a))}return t}function Wnt(e){var t=e.replace(/\s+/g,"");return t=$nt(t),t=tfe(t),t}function Gnt(e){try{return Wnt(e)}catch{return Ng}}function OL(e){var t=Gnt(e.slice(5,-1));return t===Ng?"":t}var Hnt=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Knt=["dx","dy","angle","className","breakAll"];function mj(){return mj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},mj.apply(this,arguments)}function dee(e,t){if(e==null)return{};var n=znt(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function znt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function hee(e,t){return Jnt(e)||Xnt(e,t)||qnt(e,t)||Ynt()}function Ynt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qnt(e,t){if(e){if(typeof e=="string")return fee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fee(e,t)}}function fee(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Xnt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,a,l,d,f=[],m=!0,v=!1;try{if(l=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;m=!1}else for(;!(m=(i=l.call(n)).done)&&(f.push(i.value),f.length!==t);m=!0);}catch(E){v=!0,a=E}finally{try{if(!m&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(v)throw a}}return f}}function Jnt(e){if(Array.isArray(e))return e}var nfe=/[ \f\n\r\t\v\u2028\u2029]+/,rfe=function(t){var n=t.children,i=t.breakAll,a=t.style;try{var l=[];En(n)||(i?l=n.toString().split(""):l=n.toString().split(nfe));var d=l.map(function(m){return{word:m,width:JE(m,a).width}}),f=i?0:JE(" ",a).width;return{wordsWithComputedWidth:d,spaceWidth:f}}catch{return null}},Qnt=function(t,n,i,a,l){var d=t.maxLines,f=t.children,m=t.style,v=t.breakAll,E=rt(d),S=f,T=function(){var ge=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return ge.reduce(function(ye,te){var ne=te.word,ue=te.width,_e=ye[ye.length-1];if(_e&&(a==null||l||_e.width+ue+i<Number(a)))_e.words.push(ne),_e.width+=ue+i;else{var Ce={words:[ne],width:ue};ye.push(Ce)}return ye},[])},R=T(n),I=function(ge){return ge.reduce(function(ye,te){return ye.width>te.width?ye:te})};if(!E)return R;for(var O="…",P=function(ge){var ye=S.slice(0,ge),te=rfe({breakAll:v,style:m,children:ye+O}).wordsWithComputedWidth,ne=T(te),ue=ne.length>d||I(ne).width>Number(a);return[ue,ne]},D=0,k=S.length-1,M=0,$;D<=k&&M<=S.length-1;){var V=Math.floor((D+k)/2),W=V-1,H=P(W),J=hee(H,2),ee=J[0],le=J[1],he=P(V),de=hee(he,1),ae=de[0];if(!ee&&!ae&&(D=V+1),ee&&ae&&(k=V-1),!ee&&ae){$=le;break}M++}return $||R},pee=function(t){var n=En(t)?[]:t.toString().split(nfe);return[{words:n}]},Znt=function(t){var n=t.width,i=t.scaleToFit,a=t.children,l=t.style,d=t.breakAll,f=t.maxLines;if((n||i)&&!my.isSsr){var m,v,E=rfe({breakAll:d,children:a,style:l});if(E){var S=E.wordsWithComputedWidth,T=E.spaceWidth;m=S,v=T}else return pee(a);return Qnt({breakAll:d,children:a,maxLines:f,style:l},m,v,n,i)}return pee(a)},mee="#808080",wp=function(t){var n=t.x,i=n===void 0?0:n,a=t.y,l=a===void 0?0:a,d=t.lineHeight,f=d===void 0?"1em":d,m=t.capHeight,v=m===void 0?"0.71em":m,E=t.scaleToFit,S=E===void 0?!1:E,T=t.textAnchor,R=T===void 0?"start":T,I=t.verticalAnchor,O=I===void 0?"end":I,P=t.fill,D=P===void 0?mee:P,k=dee(t,Hnt),M=N.useMemo(function(){return Znt({breakAll:k.breakAll,children:k.children,maxLines:k.maxLines,scaleToFit:S,style:k.style,width:k.width})},[k.breakAll,k.children,k.maxLines,S,k.style,k.width]),$=k.dx,V=k.dy,W=k.angle,H=k.className,J=k.breakAll,ee=dee(k,Knt);if(!Mi(i)||!Mi(l))return null;var le=i+(rt($)?$:0),he=l+(rt(V)?V:0),de;switch(O){case"start":de=OL("calc(".concat(v,")"));break;case"middle":de=OL("calc(".concat((M.length-1)/2," * -").concat(f," + (").concat(v," / 2))"));break;default:de=OL("calc(".concat(M.length-1," * -").concat(f,")"));break}var ae=[];if(S){var ce=M[0].width,ge=k.width;ae.push("scale(".concat((rt(ge)?ge/ce:1)/ce,")"))}return W&&ae.push("rotate(".concat(W,", ").concat(le,", ").concat(he,")")),ae.length&&(ee.transform=ae.join(" ")),se.createElement("text",mj({},Vt(ee,!0),{x:le,y:he,className:un("recharts-text",H),textAnchor:R,fill:D.includes("url")?mee:D}),M.map(function(ye,te){var ne=ye.words.join(J?"":" ");return se.createElement("tspan",{x:le,dy:te===0?de:f,key:"".concat(ne,"-").concat(te)},ne)}))};function mh(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ert(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function hB(e){let t,n,i;e.length!==2?(t=mh,n=(f,m)=>mh(e(f),m),i=(f,m)=>e(f)-m):(t=e===mh||e===ert?e:trt,n=e,i=e);function a(f,m,v=0,E=f.length){if(v<E){if(t(m,m)!==0)return E;do{const S=v+E>>>1;n(f[S],m)<0?v=S+1:E=S}while(v<E)}return v}function l(f,m,v=0,E=f.length){if(v<E){if(t(m,m)!==0)return E;do{const S=v+E>>>1;n(f[S],m)<=0?v=S+1:E=S}while(v<E)}return v}function d(f,m,v=0,E=f.length){const S=a(f,m,v,E-1);return S>v&&i(f[S-1],m)>-i(f[S],m)?S-1:S}return{left:a,center:d,right:l}}function trt(){return 0}function ife(e){return e===null?NaN:+e}function*nrt(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const rrt=hB(mh),HS=rrt.right;hB(ife).center;class gee extends Map{constructor(t,n=srt){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[i,a]of t)this.set(i,a)}get(t){return super.get(vee(this,t))}has(t){return super.has(vee(this,t))}set(t,n){return super.set(irt(this,t),n)}delete(t){return super.delete(ort(this,t))}}function vee({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function irt({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function ort({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function srt(e){return e!==null&&typeof e=="object"?e.valueOf():e}function art(e=mh){if(e===mh)return ofe;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||i===0?i:(e(n,n)===0)-(e(t,t)===0)}}function ofe(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const crt=Math.sqrt(50),lrt=Math.sqrt(10),urt=Math.sqrt(2);function yA(e,t,n){const i=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(i)),l=i/Math.pow(10,a),d=l>=crt?10:l>=lrt?5:l>=urt?2:1;let f,m,v;return a<0?(v=Math.pow(10,-a)/d,f=Math.round(e*v),m=Math.round(t*v),f/v<e&&++f,m/v>t&&--m,v=-v):(v=Math.pow(10,a)*d,f=Math.round(e/v),m=Math.round(t/v),f*v<e&&++f,m*v>t&&--m),m<f&&.5<=n&&n<2?yA(e,t,n*2):[f,m,v]}function gj(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const i=t<e,[a,l,d]=i?yA(t,e,n):yA(e,t,n);if(!(l>=a))return[];const f=l-a+1,m=new Array(f);if(i)if(d<0)for(let v=0;v<f;++v)m[v]=(l-v)/-d;else for(let v=0;v<f;++v)m[v]=(l-v)*d;else if(d<0)for(let v=0;v<f;++v)m[v]=(a+v)/-d;else for(let v=0;v<f;++v)m[v]=(a+v)*d;return m}function vj(e,t,n){return t=+t,e=+e,n=+n,yA(e,t,n)[2]}function yj(e,t,n){t=+t,e=+e,n=+n;const i=t<e,a=i?vj(t,e,n):vj(e,t,n);return(i?-1:1)*(a<0?1/-a:a)}function yee(e,t){let n;for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);return n}function _ee(e,t){let n;for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);return n}function sfe(e,t,n=0,i=1/0,a){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(e.length-1,i)),!(n<=t&&t<=i))return e;for(a=a===void 0?ofe:art(a);i>n;){if(i-n>600){const m=i-n+1,v=t-n+1,E=Math.log(m),S=.5*Math.exp(2*E/3),T=.5*Math.sqrt(E*S*(m-S)/m)*(v-m/2<0?-1:1),R=Math.max(n,Math.floor(t-v*S/m+T)),I=Math.min(i,Math.floor(t+(m-v)*S/m+T));sfe(e,t,R,I,a)}const l=e[t];let d=n,f=i;for(dE(e,n,t),a(e[i],l)>0&&dE(e,n,i);d<f;){for(dE(e,d,f),++d,--f;a(e[d],l)<0;)++d;for(;a(e[f],l)>0;)--f}a(e[n],l)===0?dE(e,n,f):(++f,dE(e,f,i)),f<=t&&(n=f+1),t<=f&&(i=f-1)}return e}function dE(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function drt(e,t,n){if(e=Float64Array.from(nrt(e)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return _ee(e);if(t>=1)return yee(e);var i,a=(i-1)*t,l=Math.floor(a),d=yee(sfe(e,l).subarray(0,l+1)),f=_ee(e.subarray(l+1));return d+(f-d)*(a-l)}}function hrt(e,t,n=ife){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,a=(i-1)*t,l=Math.floor(a),d=+n(e[l],l,e),f=+n(e[l+1],l+1,e);return d+(f-d)*(a-l)}}function frt(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var i=-1,a=Math.max(0,Math.ceil((t-e)/n))|0,l=new Array(a);++i<a;)l[i]=e+i*n;return l}function Ka(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function qu(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const _j=Symbol("implicit");function fB(){var e=new gee,t=[],n=[],i=_j;function a(l){let d=e.get(l);if(d===void 0){if(i!==_j)return i;e.set(l,d=t.push(l)-1)}return n[d%n.length]}return a.domain=function(l){if(!arguments.length)return t.slice();t=[],e=new gee;for(const d of l)e.has(d)||e.set(d,t.push(d)-1);return a},a.range=function(l){return arguments.length?(n=Array.from(l),a):n.slice()},a.unknown=function(l){return arguments.length?(i=l,a):i},a.copy=function(){return fB(t,n).unknown(i)},Ka.apply(a,arguments),a}function Gb(){var e=fB().unknown(void 0),t=e.domain,n=e.range,i=0,a=1,l,d,f=!1,m=0,v=0,E=.5;delete e.unknown;function S(){var T=t().length,R=a<i,I=R?a:i,O=R?i:a;l=(O-I)/Math.max(1,T-m+v*2),f&&(l=Math.floor(l)),I+=(O-I-l*(T-m))*E,d=l*(1-m),f&&(I=Math.round(I),d=Math.round(d));var P=frt(T).map(function(D){return I+l*D});return n(R?P.reverse():P)}return e.domain=function(T){return arguments.length?(t(T),S()):t()},e.range=function(T){return arguments.length?([i,a]=T,i=+i,a=+a,S()):[i,a]},e.rangeRound=function(T){return[i,a]=T,i=+i,a=+a,f=!0,S()},e.bandwidth=function(){return d},e.step=function(){return l},e.round=function(T){return arguments.length?(f=!!T,S()):f},e.padding=function(T){return arguments.length?(m=Math.min(1,v=+T),S()):m},e.paddingInner=function(T){return arguments.length?(m=Math.min(1,T),S()):m},e.paddingOuter=function(T){return arguments.length?(v=+T,S()):v},e.align=function(T){return arguments.length?(E=Math.max(0,Math.min(1,T)),S()):E},e.copy=function(){return Gb(t(),[i,a]).round(f).paddingInner(m).paddingOuter(v).align(E)},Ka.apply(S(),arguments)}function afe(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return afe(t())},e}function QE(){return afe(Gb.apply(null,arguments).paddingInner(1))}function pB(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function cfe(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function KS(){}var Hb=.7,_A=1/Hb,Yg="\\s*([+-]?\\d+)\\s*",Kb="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ol="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",prt=/^#([0-9a-f]{3,8})$/,mrt=new RegExp(`^rgb\\(${Yg},${Yg},${Yg}\\)$`),grt=new RegExp(`^rgb\\(${Ol},${Ol},${Ol}\\)$`),vrt=new RegExp(`^rgba\\(${Yg},${Yg},${Yg},${Kb}\\)$`),yrt=new RegExp(`^rgba\\(${Ol},${Ol},${Ol},${Kb}\\)$`),_rt=new RegExp(`^hsl\\(${Kb},${Ol},${Ol}\\)$`),Ert=new RegExp(`^hsla\\(${Kb},${Ol},${Ol},${Kb}\\)$`),Eee={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};pB(KS,zb,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:bee,formatHex:bee,formatHex8:brt,formatHsl:Srt,formatRgb:See,toString:See});function bee(){return this.rgb().formatHex()}function brt(){return this.rgb().formatHex8()}function Srt(){return lfe(this).formatHsl()}function See(){return this.rgb().formatRgb()}function zb(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=prt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?wee(t):n===3?new vs(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?VC(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?VC(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=mrt.exec(e))?new vs(t[1],t[2],t[3],1):(t=grt.exec(e))?new vs(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=vrt.exec(e))?VC(t[1],t[2],t[3],t[4]):(t=yrt.exec(e))?VC(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=_rt.exec(e))?Ree(t[1],t[2]/100,t[3]/100,1):(t=Ert.exec(e))?Ree(t[1],t[2]/100,t[3]/100,t[4]):Eee.hasOwnProperty(e)?wee(Eee[e]):e==="transparent"?new vs(NaN,NaN,NaN,0):null}function wee(e){return new vs(e>>16&255,e>>8&255,e&255,1)}function VC(e,t,n,i){return i<=0&&(e=t=n=NaN),new vs(e,t,n,i)}function wrt(e){return e instanceof KS||(e=zb(e)),e?(e=e.rgb(),new vs(e.r,e.g,e.b,e.opacity)):new vs}function Ej(e,t,n,i){return arguments.length===1?wrt(e):new vs(e,t,n,i??1)}function vs(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}pB(vs,Ej,cfe(KS,{brighter(e){return e=e==null?_A:Math.pow(_A,e),new vs(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Hb:Math.pow(Hb,e),new vs(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new vs(lp(this.r),lp(this.g),lp(this.b),EA(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Tee,formatHex:Tee,formatHex8:Trt,formatRgb:Cee,toString:Cee}));function Tee(){return`#${Jf(this.r)}${Jf(this.g)}${Jf(this.b)}`}function Trt(){return`#${Jf(this.r)}${Jf(this.g)}${Jf(this.b)}${Jf((isNaN(this.opacity)?1:this.opacity)*255)}`}function Cee(){const e=EA(this.opacity);return`${e===1?"rgb(":"rgba("}${lp(this.r)}, ${lp(this.g)}, ${lp(this.b)}${e===1?")":`, ${e})`}`}function EA(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function lp(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Jf(e){return e=lp(e),(e<16?"0":"")+e.toString(16)}function Ree(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Ac(e,t,n,i)}function lfe(e){if(e instanceof Ac)return new Ac(e.h,e.s,e.l,e.opacity);if(e instanceof KS||(e=zb(e)),!e)return new Ac;if(e instanceof Ac)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,a=Math.min(t,n,i),l=Math.max(t,n,i),d=NaN,f=l-a,m=(l+a)/2;return f?(t===l?d=(n-i)/f+(n<i)*6:n===l?d=(i-t)/f+2:d=(t-n)/f+4,f/=m<.5?l+a:2-l-a,d*=60):f=m>0&&m<1?0:d,new Ac(d,f,m,e.opacity)}function Crt(e,t,n,i){return arguments.length===1?lfe(e):new Ac(e,t,n,i??1)}function Ac(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}pB(Ac,Crt,cfe(KS,{brighter(e){return e=e==null?_A:Math.pow(_A,e),new Ac(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Hb:Math.pow(Hb,e),new Ac(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,a=2*n-i;return new vs(IL(e>=240?e-240:e+120,a,i),IL(e,a,i),IL(e<120?e+240:e-120,a,i),this.opacity)},clamp(){return new Ac(Aee(this.h),FC(this.s),FC(this.l),EA(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=EA(this.opacity);return`${e===1?"hsl(":"hsla("}${Aee(this.h)}, ${FC(this.s)*100}%, ${FC(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Aee(e){return e=(e||0)%360,e<0?e+360:e}function FC(e){return Math.max(0,Math.min(1,e||0))}function IL(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const mB=e=>()=>e;function Rrt(e,t){return function(n){return e+n*t}}function Art(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function Ort(e){return(e=+e)==1?ufe:function(t,n){return n-t?Art(t,n,e):mB(isNaN(t)?n:t)}}function ufe(e,t){var n=t-e;return n?Rrt(e,n):mB(isNaN(e)?t:e)}const Oee=function e(t){var n=Ort(t);function i(a,l){var d=n((a=Ej(a)).r,(l=Ej(l)).r),f=n(a.g,l.g),m=n(a.b,l.b),v=ufe(a.opacity,l.opacity);return function(E){return a.r=d(E),a.g=f(E),a.b=m(E),a.opacity=v(E),a+""}}return i.gamma=e,i}(1);function Irt(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),a;return function(l){for(a=0;a<n;++a)i[a]=e[a]*(1-l)+t[a]*l;return i}}function xrt(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Prt(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,a=new Array(i),l=new Array(n),d;for(d=0;d<i;++d)a[d]=gy(e[d],t[d]);for(;d<n;++d)l[d]=t[d];return function(f){for(d=0;d<i;++d)l[d]=a[d](f);return l}}function Nrt(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function bA(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Drt(e,t){var n={},i={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?n[a]=gy(e[a],t[a]):i[a]=t[a];return function(l){for(a in n)i[a]=n[a](l);return i}}var bj=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xL=new RegExp(bj.source,"g");function krt(e){return function(){return e}}function Lrt(e){return function(t){return e(t)+""}}function Mrt(e,t){var n=bj.lastIndex=xL.lastIndex=0,i,a,l,d=-1,f=[],m=[];for(e=e+"",t=t+"";(i=bj.exec(e))&&(a=xL.exec(t));)(l=a.index)>n&&(l=t.slice(n,l),f[d]?f[d]+=l:f[++d]=l),(i=i[0])===(a=a[0])?f[d]?f[d]+=a:f[++d]=a:(f[++d]=null,m.push({i:d,x:bA(i,a)})),n=xL.lastIndex;return n<t.length&&(l=t.slice(n),f[d]?f[d]+=l:f[++d]=l),f.length<2?m[0]?Lrt(m[0].x):krt(t):(t=m.length,function(v){for(var E=0,S;E<t;++E)f[(S=m[E]).i]=S.x(v);return f.join("")})}function gy(e,t){var n=typeof t,i;return t==null||n==="boolean"?mB(t):(n==="number"?bA:n==="string"?(i=zb(t))?(t=i,Oee):Mrt:t instanceof zb?Oee:t instanceof Date?Nrt:xrt(t)?Irt:Array.isArray(t)?Prt:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Drt:bA)(e,t)}function gB(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function jrt(e,t){t===void 0&&(t=e,e=gy);for(var n=0,i=t.length-1,a=t[0],l=new Array(i<0?0:i);n<i;)l[n]=e(a,a=t[++n]);return function(d){var f=Math.max(0,Math.min(i-1,Math.floor(d*=i)));return l[f](d-f)}}function Urt(e){return function(){return e}}function SA(e){return+e}var Iee=[0,1];function Wo(e){return e}function Sj(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Urt(isNaN(t)?NaN:.5)}function Vrt(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function Frt(e,t,n){var i=e[0],a=e[1],l=t[0],d=t[1];return a<i?(i=Sj(a,i),l=n(d,l)):(i=Sj(i,a),l=n(l,d)),function(f){return l(i(f))}}function Brt(e,t,n){var i=Math.min(e.length,t.length)-1,a=new Array(i),l=new Array(i),d=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++d<i;)a[d]=Sj(e[d],e[d+1]),l[d]=n(t[d],t[d+1]);return function(f){var m=HS(e,f,1,i)-1;return l[m](a[m](f))}}function zS(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function DI(){var e=Iee,t=Iee,n=gy,i,a,l,d=Wo,f,m,v;function E(){var T=Math.min(e.length,t.length);return d!==Wo&&(d=Vrt(e[0],e[T-1])),f=T>2?Brt:Frt,m=v=null,S}function S(T){return T==null||isNaN(T=+T)?l:(m||(m=f(e.map(i),t,n)))(i(d(T)))}return S.invert=function(T){return d(a((v||(v=f(t,e.map(i),bA)))(T)))},S.domain=function(T){return arguments.length?(e=Array.from(T,SA),E()):e.slice()},S.range=function(T){return arguments.length?(t=Array.from(T),E()):t.slice()},S.rangeRound=function(T){return t=Array.from(T),n=gB,E()},S.clamp=function(T){return arguments.length?(d=T?!0:Wo,E()):d!==Wo},S.interpolate=function(T){return arguments.length?(n=T,E()):n},S.unknown=function(T){return arguments.length?(l=T,S):l},function(T,R){return i=T,a=R,E()}}function vB(){return DI()(Wo,Wo)}function $rt(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function wA(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function Tv(e){return e=wA(Math.abs(e)),e?e[1]:NaN}function Wrt(e,t){return function(n,i){for(var a=n.length,l=[],d=0,f=e[0],m=0;a>0&&f>0&&(m+f+1>i&&(f=Math.max(1,i-m)),l.push(n.substring(a-=f,a+f)),!((m+=f+1)>i));)f=e[d=(d+1)%e.length];return l.reverse().join(t)}}function Grt(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var Hrt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Yb(e){if(!(t=Hrt.exec(e)))throw new Error("invalid format: "+e);var t;return new yB({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Yb.prototype=yB.prototype;function yB(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}yB.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Krt(e){e:for(var t=e.length,n=1,i=-1,a;n<t;++n)switch(e[n]){case".":i=a=n;break;case"0":i===0&&(i=n),a=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(a+1):e}var dfe;function zrt(e,t){var n=wA(e,t);if(!n)return e+"";var i=n[0],a=n[1],l=a-(dfe=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,d=i.length;return l===d?i:l>d?i+new Array(l-d+1).join("0"):l>0?i.slice(0,l)+"."+i.slice(l):"0."+new Array(1-l).join("0")+wA(e,Math.max(0,t+l-1))[0]}function xee(e,t){var n=wA(e,t);if(!n)return e+"";var i=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+i:i.length>a+1?i.slice(0,a+1)+"."+i.slice(a+1):i+new Array(a-i.length+2).join("0")}const Pee={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:$rt,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>xee(e*100,t),r:xee,s:zrt,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Nee(e){return e}var Dee=Array.prototype.map,kee=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Yrt(e){var t=e.grouping===void 0||e.thousands===void 0?Nee:Wrt(Dee.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",l=e.numerals===void 0?Nee:Grt(Dee.call(e.numerals,String)),d=e.percent===void 0?"%":e.percent+"",f=e.minus===void 0?"−":e.minus+"",m=e.nan===void 0?"NaN":e.nan+"";function v(S){S=Yb(S);var T=S.fill,R=S.align,I=S.sign,O=S.symbol,P=S.zero,D=S.width,k=S.comma,M=S.precision,$=S.trim,V=S.type;V==="n"?(k=!0,V="g"):Pee[V]||(M===void 0&&(M=12),$=!0,V="g"),(P||T==="0"&&R==="=")&&(P=!0,T="0",R="=");var W=O==="$"?n:O==="#"&&/[boxX]/.test(V)?"0"+V.toLowerCase():"",H=O==="$"?i:/[%p]/.test(V)?d:"",J=Pee[V],ee=/[defgprs%]/.test(V);M=M===void 0?6:/[gprs]/.test(V)?Math.max(1,Math.min(21,M)):Math.max(0,Math.min(20,M));function le(he){var de=W,ae=H,ce,ge,ye;if(V==="c")ae=J(he)+ae,he="";else{he=+he;var te=he<0||1/he<0;if(he=isNaN(he)?m:J(Math.abs(he),M),$&&(he=Krt(he)),te&&+he==0&&I!=="+"&&(te=!1),de=(te?I==="("?I:f:I==="-"||I==="("?"":I)+de,ae=(V==="s"?kee[8+dfe/3]:"")+ae+(te&&I==="("?")":""),ee){for(ce=-1,ge=he.length;++ce<ge;)if(ye=he.charCodeAt(ce),48>ye||ye>57){ae=(ye===46?a+he.slice(ce+1):he.slice(ce))+ae,he=he.slice(0,ce);break}}}k&&!P&&(he=t(he,1/0));var ne=de.length+he.length+ae.length,ue=ne<D?new Array(D-ne+1).join(T):"";switch(k&&P&&(he=t(ue+he,ue.length?D-ae.length:1/0),ue=""),R){case"<":he=de+he+ae+ue;break;case"=":he=de+ue+he+ae;break;case"^":he=ue.slice(0,ne=ue.length>>1)+de+he+ae+ue.slice(ne);break;default:he=ue+de+he+ae;break}return l(he)}return le.toString=function(){return S+""},le}function E(S,T){var R=v((S=Yb(S),S.type="f",S)),I=Math.max(-8,Math.min(8,Math.floor(Tv(T)/3)))*3,O=Math.pow(10,-I),P=kee[8+I/3];return function(D){return R(O*D)+P}}return{format:v,formatPrefix:E}}var BC,_B,hfe;qrt({thousands:",",grouping:[3],currency:["$",""]});function qrt(e){return BC=Yrt(e),_B=BC.format,hfe=BC.formatPrefix,BC}function Xrt(e){return Math.max(0,-Tv(Math.abs(e)))}function Jrt(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Tv(t)/3)))*3-Tv(Math.abs(e)))}function Qrt(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Tv(t)-Tv(e))+1}function ffe(e,t,n,i){var a=yj(e,t,n),l;switch(i=Yb(i??",f"),i.type){case"s":{var d=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(l=Jrt(a,d))&&(i.precision=l),hfe(i,d)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(l=Qrt(a,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=l-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(l=Xrt(a))&&(i.precision=l-(i.type==="%")*2);break}}return _B(i)}function Lh(e){var t=e.domain;return e.ticks=function(n){var i=t();return gj(i[0],i[i.length-1],n??10)},e.tickFormat=function(n,i){var a=t();return ffe(a[0],a[a.length-1],n??10,i)},e.nice=function(n){n==null&&(n=10);var i=t(),a=0,l=i.length-1,d=i[a],f=i[l],m,v,E=10;for(f<d&&(v=d,d=f,f=v,v=a,a=l,l=v);E-- >0;){if(v=vj(d,f,n),v===m)return i[a]=d,i[l]=f,t(i);if(v>0)d=Math.floor(d/v)*v,f=Math.ceil(f/v)*v;else if(v<0)d=Math.ceil(d*v)/v,f=Math.floor(f*v)/v;else break;m=v}return e},e}function TA(){var e=vB();return e.copy=function(){return zS(e,TA())},Ka.apply(e,arguments),Lh(e)}function pfe(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,SA),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return pfe(e).unknown(t)},e=arguments.length?Array.from(e,SA):[0,1],Lh(n)}function mfe(e,t){e=e.slice();var n=0,i=e.length-1,a=e[n],l=e[i],d;return l<a&&(d=n,n=i,i=d,d=a,a=l,l=d),e[n]=t.floor(a),e[i]=t.ceil(l),e}function Lee(e){return Math.log(e)}function Mee(e){return Math.exp(e)}function Zrt(e){return-Math.log(-e)}function eit(e){return-Math.exp(-e)}function tit(e){return isFinite(e)?+("1e"+e):e<0?0:e}function nit(e){return e===10?tit:e===Math.E?Math.exp:t=>Math.pow(e,t)}function rit(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function jee(e){return(t,n)=>-e(-t,n)}function EB(e){const t=e(Lee,Mee),n=t.domain;let i=10,a,l;function d(){return a=rit(i),l=nit(i),n()[0]<0?(a=jee(a),l=jee(l),e(Zrt,eit)):e(Lee,Mee),t}return t.base=function(f){return arguments.length?(i=+f,d()):i},t.domain=function(f){return arguments.length?(n(f),d()):n()},t.ticks=f=>{const m=n();let v=m[0],E=m[m.length-1];const S=E<v;S&&([v,E]=[E,v]);let T=a(v),R=a(E),I,O;const P=f==null?10:+f;let D=[];if(!(i%1)&&R-T<P){if(T=Math.floor(T),R=Math.ceil(R),v>0){for(;T<=R;++T)for(I=1;I<i;++I)if(O=T<0?I/l(-T):I*l(T),!(O<v)){if(O>E)break;D.push(O)}}else for(;T<=R;++T)for(I=i-1;I>=1;--I)if(O=T>0?I/l(-T):I*l(T),!(O<v)){if(O>E)break;D.push(O)}D.length*2<P&&(D=gj(v,E,P))}else D=gj(T,R,Math.min(R-T,P)).map(l);return S?D.reverse():D},t.tickFormat=(f,m)=>{if(f==null&&(f=10),m==null&&(m=i===10?"s":","),typeof m!="function"&&(!(i%1)&&(m=Yb(m)).precision==null&&(m.trim=!0),m=_B(m)),f===1/0)return m;const v=Math.max(1,i*f/t.ticks().length);return E=>{let S=E/l(Math.round(a(E)));return S*i<i-.5&&(S*=i),S<=v?m(E):""}},t.nice=()=>n(mfe(n(),{floor:f=>l(Math.floor(a(f))),ceil:f=>l(Math.ceil(a(f)))})),t}function gfe(){const e=EB(DI()).domain([1,10]);return e.copy=()=>zS(e,gfe()).base(e.base()),Ka.apply(e,arguments),e}function Uee(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Vee(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function bB(e){var t=1,n=e(Uee(t),Vee(t));return n.constant=function(i){return arguments.length?e(Uee(t=+i),Vee(t)):t},Lh(n)}function vfe(){var e=bB(DI());return e.copy=function(){return zS(e,vfe()).constant(e.constant())},Ka.apply(e,arguments)}function Fee(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function iit(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function oit(e){return e<0?-e*e:e*e}function SB(e){var t=e(Wo,Wo),n=1;function i(){return n===1?e(Wo,Wo):n===.5?e(iit,oit):e(Fee(n),Fee(1/n))}return t.exponent=function(a){return arguments.length?(n=+a,i()):n},Lh(t)}function wB(){var e=SB(DI());return e.copy=function(){return zS(e,wB()).exponent(e.exponent())},Ka.apply(e,arguments),e}function sit(){return wB.apply(null,arguments).exponent(.5)}function Bee(e){return Math.sign(e)*e*e}function ait(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function yfe(){var e=vB(),t=[0,1],n=!1,i;function a(l){var d=ait(e(l));return isNaN(d)?i:n?Math.round(d):d}return a.invert=function(l){return e.invert(Bee(l))},a.domain=function(l){return arguments.length?(e.domain(l),a):e.domain()},a.range=function(l){return arguments.length?(e.range((t=Array.from(l,SA)).map(Bee)),a):t.slice()},a.rangeRound=function(l){return a.range(l).round(!0)},a.round=function(l){return arguments.length?(n=!!l,a):n},a.clamp=function(l){return arguments.length?(e.clamp(l),a):e.clamp()},a.unknown=function(l){return arguments.length?(i=l,a):i},a.copy=function(){return yfe(e.domain(),t).round(n).clamp(e.clamp()).unknown(i)},Ka.apply(a,arguments),Lh(a)}function _fe(){var e=[],t=[],n=[],i;function a(){var d=0,f=Math.max(1,t.length);for(n=new Array(f-1);++d<f;)n[d-1]=hrt(e,d/f);return l}function l(d){return d==null||isNaN(d=+d)?i:t[HS(n,d)]}return l.invertExtent=function(d){var f=t.indexOf(d);return f<0?[NaN,NaN]:[f>0?n[f-1]:e[0],f<n.length?n[f]:e[e.length-1]]},l.domain=function(d){if(!arguments.length)return e.slice();e=[];for(let f of d)f!=null&&!isNaN(f=+f)&&e.push(f);return e.sort(mh),a()},l.range=function(d){return arguments.length?(t=Array.from(d),a()):t.slice()},l.unknown=function(d){return arguments.length?(i=d,l):i},l.quantiles=function(){return n.slice()},l.copy=function(){return _fe().domain(e).range(t).unknown(i)},Ka.apply(l,arguments)}function Efe(){var e=0,t=1,n=1,i=[.5],a=[0,1],l;function d(m){return m!=null&&m<=m?a[HS(i,m,0,n)]:l}function f(){var m=-1;for(i=new Array(n);++m<n;)i[m]=((m+1)*t-(m-n)*e)/(n+1);return d}return d.domain=function(m){return arguments.length?([e,t]=m,e=+e,t=+t,f()):[e,t]},d.range=function(m){return arguments.length?(n=(a=Array.from(m)).length-1,f()):a.slice()},d.invertExtent=function(m){var v=a.indexOf(m);return v<0?[NaN,NaN]:v<1?[e,i[0]]:v>=n?[i[n-1],t]:[i[v-1],i[v]]},d.unknown=function(m){return arguments.length&&(l=m),d},d.thresholds=function(){return i.slice()},d.copy=function(){return Efe().domain([e,t]).range(a).unknown(l)},Ka.apply(Lh(d),arguments)}function bfe(){var e=[.5],t=[0,1],n,i=1;function a(l){return l!=null&&l<=l?t[HS(e,l,0,i)]:n}return a.domain=function(l){return arguments.length?(e=Array.from(l),i=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(l){return arguments.length?(t=Array.from(l),i=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(l){var d=t.indexOf(l);return[e[d-1],e[d]]},a.unknown=function(l){return arguments.length?(n=l,a):n},a.copy=function(){return bfe().domain(e).range(t).unknown(n)},Ka.apply(a,arguments)}const PL=new Date,NL=new Date;function ji(e,t,n,i){function a(l){return e(l=arguments.length===0?new Date:new Date(+l)),l}return a.floor=l=>(e(l=new Date(+l)),l),a.ceil=l=>(e(l=new Date(l-1)),t(l,1),e(l),l),a.round=l=>{const d=a(l),f=a.ceil(l);return l-d<f-l?d:f},a.offset=(l,d)=>(t(l=new Date(+l),d==null?1:Math.floor(d)),l),a.range=(l,d,f)=>{const m=[];if(l=a.ceil(l),f=f==null?1:Math.floor(f),!(l<d)||!(f>0))return m;let v;do m.push(v=new Date(+l)),t(l,f),e(l);while(v<l&&l<d);return m},a.filter=l=>ji(d=>{if(d>=d)for(;e(d),!l(d);)d.setTime(d-1)},(d,f)=>{if(d>=d)if(f<0)for(;++f<=0;)for(;t(d,-1),!l(d););else for(;--f>=0;)for(;t(d,1),!l(d););}),n&&(a.count=(l,d)=>(PL.setTime(+l),NL.setTime(+d),e(PL),e(NL),Math.floor(n(PL,NL))),a.every=l=>(l=Math.floor(l),!isFinite(l)||!(l>0)?null:l>1?a.filter(i?d=>i(d)%l===0:d=>a.count(0,d)%l===0):a)),a}const CA=ji(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);CA.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ji(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):CA);CA.range;const gu=1e3,Ua=gu*60,vu=Ua*60,Fu=vu*24,TB=Fu*7,$ee=Fu*30,DL=Fu*365,Qf=ji(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*gu)},(e,t)=>(t-e)/gu,e=>e.getUTCSeconds());Qf.range;const CB=ji(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*gu)},(e,t)=>{e.setTime(+e+t*Ua)},(e,t)=>(t-e)/Ua,e=>e.getMinutes());CB.range;const RB=ji(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ua)},(e,t)=>(t-e)/Ua,e=>e.getUTCMinutes());RB.range;const AB=ji(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*gu-e.getMinutes()*Ua)},(e,t)=>{e.setTime(+e+t*vu)},(e,t)=>(t-e)/vu,e=>e.getHours());AB.range;const OB=ji(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*vu)},(e,t)=>(t-e)/vu,e=>e.getUTCHours());OB.range;const YS=ji(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ua)/Fu,e=>e.getDate()-1);YS.range;const kI=ji(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Fu,e=>e.getUTCDate()-1);kI.range;const Sfe=ji(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Fu,e=>Math.floor(e/Fu));Sfe.range;function Lp(e){return ji(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ua)/TB)}const LI=Lp(0),RA=Lp(1),cit=Lp(2),lit=Lp(3),Cv=Lp(4),uit=Lp(5),dit=Lp(6);LI.range;RA.range;cit.range;lit.range;Cv.range;uit.range;dit.range;function Mp(e){return ji(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/TB)}const MI=Mp(0),AA=Mp(1),hit=Mp(2),fit=Mp(3),Rv=Mp(4),pit=Mp(5),mit=Mp(6);MI.range;AA.range;hit.range;fit.range;Rv.range;pit.range;mit.range;const IB=ji(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());IB.range;const xB=ji(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());xB.range;const Bu=ji(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Bu.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ji(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Bu.range;const $u=ji(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());$u.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ji(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});$u.range;function wfe(e,t,n,i,a,l){const d=[[Qf,1,gu],[Qf,5,5*gu],[Qf,15,15*gu],[Qf,30,30*gu],[l,1,Ua],[l,5,5*Ua],[l,15,15*Ua],[l,30,30*Ua],[a,1,vu],[a,3,3*vu],[a,6,6*vu],[a,12,12*vu],[i,1,Fu],[i,2,2*Fu],[n,1,TB],[t,1,$ee],[t,3,3*$ee],[e,1,DL]];function f(v,E,S){const T=E<v;T&&([v,E]=[E,v]);const R=S&&typeof S.range=="function"?S:m(v,E,S),I=R?R.range(v,+E+1):[];return T?I.reverse():I}function m(v,E,S){const T=Math.abs(E-v)/S,R=hB(([,,P])=>P).right(d,T);if(R===d.length)return e.every(yj(v/DL,E/DL,S));if(R===0)return CA.every(Math.max(yj(v,E,S),1));const[I,O]=d[T/d[R-1][2]<d[R][2]/T?R-1:R];return I.every(O)}return[f,m]}const[git,vit]=wfe($u,xB,MI,Sfe,OB,RB),[yit,_it]=wfe(Bu,IB,LI,YS,AB,CB);function kL(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function LL(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function hE(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Eit(e){var t=e.dateTime,n=e.date,i=e.time,a=e.periods,l=e.days,d=e.shortDays,f=e.months,m=e.shortMonths,v=fE(a),E=pE(a),S=fE(l),T=pE(l),R=fE(d),I=pE(d),O=fE(f),P=pE(f),D=fE(m),k=pE(m),M={a:te,A:ne,b:ue,B:_e,c:null,d:Yee,e:Yee,f:Wit,g:Zit,G:tot,H:Fit,I:Bit,j:$it,L:Tfe,m:Git,M:Hit,p:Ce,q:Ie,Q:Jee,s:Qee,S:Kit,u:zit,U:Yit,V:qit,w:Xit,W:Jit,x:null,X:null,y:Qit,Y:eot,Z:not,"%":Xee},$={a:Ge,A:Ze,b:wt,B:Ft,c:null,d:qee,e:qee,f:sot,g:got,G:yot,H:rot,I:iot,j:oot,L:Rfe,m:aot,M:cot,p:ze,q:Nt,Q:Jee,s:Qee,S:lot,u:uot,U:dot,V:hot,w:fot,W:pot,x:null,X:null,y:mot,Y:vot,Z:_ot,"%":Xee},V={a:le,A:he,b:de,B:ae,c:ce,d:Kee,e:Kee,f:Mit,g:Hee,G:Gee,H:zee,I:zee,j:Nit,L:Lit,m:Pit,M:Dit,p:ee,q:xit,Q:Uit,s:Vit,S:kit,u:Cit,U:Rit,V:Ait,w:Tit,W:Oit,x:ge,X:ye,y:Hee,Y:Gee,Z:Iit,"%":jit};M.x=W(n,M),M.X=W(i,M),M.c=W(t,M),$.x=W(n,$),$.X=W(i,$),$.c=W(t,$);function W(we,He){return function(Ke){var Re=[],at=-1,mt=0,At=we.length,nn,Mr,Mn;for(Ke instanceof Date||(Ke=new Date(+Ke));++at<At;)we.charCodeAt(at)===37&&(Re.push(we.slice(mt,at)),(Mr=Wee[nn=we.charAt(++at)])!=null?nn=we.charAt(++at):Mr=nn==="e"?" ":"0",(Mn=He[nn])&&(nn=Mn(Ke,Mr)),Re.push(nn),mt=at+1);return Re.push(we.slice(mt,at)),Re.join("")}}function H(we,He){return function(Ke){var Re=hE(1900,void 0,1),at=J(Re,we,Ke+="",0),mt,At;if(at!=Ke.length)return null;if("Q"in Re)return new Date(Re.Q);if("s"in Re)return new Date(Re.s*1e3+("L"in Re?Re.L:0));if(He&&!("Z"in Re)&&(Re.Z=0),"p"in Re&&(Re.H=Re.H%12+Re.p*12),Re.m===void 0&&(Re.m="q"in Re?Re.q:0),"V"in Re){if(Re.V<1||Re.V>53)return null;"w"in Re||(Re.w=1),"Z"in Re?(mt=LL(hE(Re.y,0,1)),At=mt.getUTCDay(),mt=At>4||At===0?AA.ceil(mt):AA(mt),mt=kI.offset(mt,(Re.V-1)*7),Re.y=mt.getUTCFullYear(),Re.m=mt.getUTCMonth(),Re.d=mt.getUTCDate()+(Re.w+6)%7):(mt=kL(hE(Re.y,0,1)),At=mt.getDay(),mt=At>4||At===0?RA.ceil(mt):RA(mt),mt=YS.offset(mt,(Re.V-1)*7),Re.y=mt.getFullYear(),Re.m=mt.getMonth(),Re.d=mt.getDate()+(Re.w+6)%7)}else("W"in Re||"U"in Re)&&("w"in Re||(Re.w="u"in Re?Re.u%7:"W"in Re?1:0),At="Z"in Re?LL(hE(Re.y,0,1)).getUTCDay():kL(hE(Re.y,0,1)).getDay(),Re.m=0,Re.d="W"in Re?(Re.w+6)%7+Re.W*7-(At+5)%7:Re.w+Re.U*7-(At+6)%7);return"Z"in Re?(Re.H+=Re.Z/100|0,Re.M+=Re.Z%100,LL(Re)):kL(Re)}}function J(we,He,Ke,Re){for(var at=0,mt=He.length,At=Ke.length,nn,Mr;at<mt;){if(Re>=At)return-1;if(nn=He.charCodeAt(at++),nn===37){if(nn=He.charAt(at++),Mr=V[nn in Wee?He.charAt(at++):nn],!Mr||(Re=Mr(we,Ke,Re))<0)return-1}else if(nn!=Ke.charCodeAt(Re++))return-1}return Re}function ee(we,He,Ke){var Re=v.exec(He.slice(Ke));return Re?(we.p=E.get(Re[0].toLowerCase()),Ke+Re[0].length):-1}function le(we,He,Ke){var Re=R.exec(He.slice(Ke));return Re?(we.w=I.get(Re[0].toLowerCase()),Ke+Re[0].length):-1}function he(we,He,Ke){var Re=S.exec(He.slice(Ke));return Re?(we.w=T.get(Re[0].toLowerCase()),Ke+Re[0].length):-1}function de(we,He,Ke){var Re=D.exec(He.slice(Ke));return Re?(we.m=k.get(Re[0].toLowerCase()),Ke+Re[0].length):-1}function ae(we,He,Ke){var Re=O.exec(He.slice(Ke));return Re?(we.m=P.get(Re[0].toLowerCase()),Ke+Re[0].length):-1}function ce(we,He,Ke){return J(we,t,He,Ke)}function ge(we,He,Ke){return J(we,n,He,Ke)}function ye(we,He,Ke){return J(we,i,He,Ke)}function te(we){return d[we.getDay()]}function ne(we){return l[we.getDay()]}function ue(we){return m[we.getMonth()]}function _e(we){return f[we.getMonth()]}function Ce(we){return a[+(we.getHours()>=12)]}function Ie(we){return 1+~~(we.getMonth()/3)}function Ge(we){return d[we.getUTCDay()]}function Ze(we){return l[we.getUTCDay()]}function wt(we){return m[we.getUTCMonth()]}function Ft(we){return f[we.getUTCMonth()]}function ze(we){return a[+(we.getUTCHours()>=12)]}function Nt(we){return 1+~~(we.getUTCMonth()/3)}return{format:function(we){var He=W(we+="",M);return He.toString=function(){return we},He},parse:function(we){var He=H(we+="",!1);return He.toString=function(){return we},He},utcFormat:function(we){var He=W(we+="",$);return He.toString=function(){return we},He},utcParse:function(we){var He=H(we+="",!0);return He.toString=function(){return we},He}}}var Wee={"-":"",_:" ",0:"0"},Xi=/^\s*\d+/,bit=/^%/,Sit=/[\\^$*+?|[\]().{}]/g;function Fn(e,t,n){var i=e<0?"-":"",a=(i?-e:e)+"",l=a.length;return i+(l<n?new Array(n-l+1).join(t)+a:a)}function wit(e){return e.replace(Sit,"\\$&")}function fE(e){return new RegExp("^(?:"+e.map(wit).join("|")+")","i")}function pE(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Tit(e,t,n){var i=Xi.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function Cit(e,t,n){var i=Xi.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function Rit(e,t,n){var i=Xi.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function Ait(e,t,n){var i=Xi.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function Oit(e,t,n){var i=Xi.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function Gee(e,t,n){var i=Xi.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function Hee(e,t,n){var i=Xi.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function Iit(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function xit(e,t,n){var i=Xi.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function Pit(e,t,n){var i=Xi.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function Kee(e,t,n){var i=Xi.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function Nit(e,t,n){var i=Xi.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function zee(e,t,n){var i=Xi.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function Dit(e,t,n){var i=Xi.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function kit(e,t,n){var i=Xi.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function Lit(e,t,n){var i=Xi.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function Mit(e,t,n){var i=Xi.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function jit(e,t,n){var i=bit.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function Uit(e,t,n){var i=Xi.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function Vit(e,t,n){var i=Xi.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function Yee(e,t){return Fn(e.getDate(),t,2)}function Fit(e,t){return Fn(e.getHours(),t,2)}function Bit(e,t){return Fn(e.getHours()%12||12,t,2)}function $it(e,t){return Fn(1+YS.count(Bu(e),e),t,3)}function Tfe(e,t){return Fn(e.getMilliseconds(),t,3)}function Wit(e,t){return Tfe(e,t)+"000"}function Git(e,t){return Fn(e.getMonth()+1,t,2)}function Hit(e,t){return Fn(e.getMinutes(),t,2)}function Kit(e,t){return Fn(e.getSeconds(),t,2)}function zit(e){var t=e.getDay();return t===0?7:t}function Yit(e,t){return Fn(LI.count(Bu(e)-1,e),t,2)}function Cfe(e){var t=e.getDay();return t>=4||t===0?Cv(e):Cv.ceil(e)}function qit(e,t){return e=Cfe(e),Fn(Cv.count(Bu(e),e)+(Bu(e).getDay()===4),t,2)}function Xit(e){return e.getDay()}function Jit(e,t){return Fn(RA.count(Bu(e)-1,e),t,2)}function Qit(e,t){return Fn(e.getFullYear()%100,t,2)}function Zit(e,t){return e=Cfe(e),Fn(e.getFullYear()%100,t,2)}function eot(e,t){return Fn(e.getFullYear()%1e4,t,4)}function tot(e,t){var n=e.getDay();return e=n>=4||n===0?Cv(e):Cv.ceil(e),Fn(e.getFullYear()%1e4,t,4)}function not(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Fn(t/60|0,"0",2)+Fn(t%60,"0",2)}function qee(e,t){return Fn(e.getUTCDate(),t,2)}function rot(e,t){return Fn(e.getUTCHours(),t,2)}function iot(e,t){return Fn(e.getUTCHours()%12||12,t,2)}function oot(e,t){return Fn(1+kI.count($u(e),e),t,3)}function Rfe(e,t){return Fn(e.getUTCMilliseconds(),t,3)}function sot(e,t){return Rfe(e,t)+"000"}function aot(e,t){return Fn(e.getUTCMonth()+1,t,2)}function cot(e,t){return Fn(e.getUTCMinutes(),t,2)}function lot(e,t){return Fn(e.getUTCSeconds(),t,2)}function uot(e){var t=e.getUTCDay();return t===0?7:t}function dot(e,t){return Fn(MI.count($u(e)-1,e),t,2)}function Afe(e){var t=e.getUTCDay();return t>=4||t===0?Rv(e):Rv.ceil(e)}function hot(e,t){return e=Afe(e),Fn(Rv.count($u(e),e)+($u(e).getUTCDay()===4),t,2)}function fot(e){return e.getUTCDay()}function pot(e,t){return Fn(AA.count($u(e)-1,e),t,2)}function mot(e,t){return Fn(e.getUTCFullYear()%100,t,2)}function got(e,t){return e=Afe(e),Fn(e.getUTCFullYear()%100,t,2)}function vot(e,t){return Fn(e.getUTCFullYear()%1e4,t,4)}function yot(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Rv(e):Rv.ceil(e),Fn(e.getUTCFullYear()%1e4,t,4)}function _ot(){return"+0000"}function Xee(){return"%"}function Jee(e){return+e}function Qee(e){return Math.floor(+e/1e3)}var lg,Ofe,Ife;Eot({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Eot(e){return lg=Eit(e),Ofe=lg.format,lg.parse,Ife=lg.utcFormat,lg.utcParse,lg}function bot(e){return new Date(e)}function Sot(e){return e instanceof Date?+e:+new Date(+e)}function PB(e,t,n,i,a,l,d,f,m,v){var E=vB(),S=E.invert,T=E.domain,R=v(".%L"),I=v(":%S"),O=v("%I:%M"),P=v("%I %p"),D=v("%a %d"),k=v("%b %d"),M=v("%B"),$=v("%Y");function V(W){return(m(W)<W?R:f(W)<W?I:d(W)<W?O:l(W)<W?P:i(W)<W?a(W)<W?D:k:n(W)<W?M:$)(W)}return E.invert=function(W){return new Date(S(W))},E.domain=function(W){return arguments.length?T(Array.from(W,Sot)):T().map(bot)},E.ticks=function(W){var H=T();return e(H[0],H[H.length-1],W??10)},E.tickFormat=function(W,H){return H==null?V:v(H)},E.nice=function(W){var H=T();return(!W||typeof W.range!="function")&&(W=t(H[0],H[H.length-1],W??10)),W?T(mfe(H,W)):E},E.copy=function(){return zS(E,PB(e,t,n,i,a,l,d,f,m,v))},E}function wot(){return Ka.apply(PB(yit,_it,Bu,IB,LI,YS,AB,CB,Qf,Ofe).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Tot(){return Ka.apply(PB(git,vit,$u,xB,MI,kI,OB,RB,Qf,Ife).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function jI(){var e=0,t=1,n,i,a,l,d=Wo,f=!1,m;function v(S){return S==null||isNaN(S=+S)?m:d(a===0?.5:(S=(l(S)-n)*a,f?Math.max(0,Math.min(1,S)):S))}v.domain=function(S){return arguments.length?([e,t]=S,n=l(e=+e),i=l(t=+t),a=n===i?0:1/(i-n),v):[e,t]},v.clamp=function(S){return arguments.length?(f=!!S,v):f},v.interpolator=function(S){return arguments.length?(d=S,v):d};function E(S){return function(T){var R,I;return arguments.length?([R,I]=T,d=S(R,I),v):[d(0),d(1)]}}return v.range=E(gy),v.rangeRound=E(gB),v.unknown=function(S){return arguments.length?(m=S,v):m},function(S){return l=S,n=S(e),i=S(t),a=n===i?0:1/(i-n),v}}function Mh(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function xfe(){var e=Lh(jI()(Wo));return e.copy=function(){return Mh(e,xfe())},qu.apply(e,arguments)}function Pfe(){var e=EB(jI()).domain([1,10]);return e.copy=function(){return Mh(e,Pfe()).base(e.base())},qu.apply(e,arguments)}function Nfe(){var e=bB(jI());return e.copy=function(){return Mh(e,Nfe()).constant(e.constant())},qu.apply(e,arguments)}function NB(){var e=SB(jI());return e.copy=function(){return Mh(e,NB()).exponent(e.exponent())},qu.apply(e,arguments)}function Cot(){return NB.apply(null,arguments).exponent(.5)}function Dfe(){var e=[],t=Wo;function n(i){if(i!=null&&!isNaN(i=+i))return t((HS(e,i,1)-1)/(e.length-1))}return n.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let a of i)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(mh),n},n.interpolator=function(i){return arguments.length?(t=i,n):t},n.range=function(){return e.map((i,a)=>t(a/(e.length-1)))},n.quantiles=function(i){return Array.from({length:i+1},(a,l)=>drt(e,l/i))},n.copy=function(){return Dfe(t).domain(e)},qu.apply(n,arguments)}function UI(){var e=0,t=.5,n=1,i=1,a,l,d,f,m,v=Wo,E,S=!1,T;function R(O){return isNaN(O=+O)?T:(O=.5+((O=+E(O))-l)*(i*O<i*l?f:m),v(S?Math.max(0,Math.min(1,O)):O))}R.domain=function(O){return arguments.length?([e,t,n]=O,a=E(e=+e),l=E(t=+t),d=E(n=+n),f=a===l?0:.5/(l-a),m=l===d?0:.5/(d-l),i=l<a?-1:1,R):[e,t,n]},R.clamp=function(O){return arguments.length?(S=!!O,R):S},R.interpolator=function(O){return arguments.length?(v=O,R):v};function I(O){return function(P){var D,k,M;return arguments.length?([D,k,M]=P,v=jrt(O,[D,k,M]),R):[v(0),v(.5),v(1)]}}return R.range=I(gy),R.rangeRound=I(gB),R.unknown=function(O){return arguments.length?(T=O,R):T},function(O){return E=O,a=O(e),l=O(t),d=O(n),f=a===l?0:.5/(l-a),m=l===d?0:.5/(d-l),i=l<a?-1:1,R}}function kfe(){var e=Lh(UI()(Wo));return e.copy=function(){return Mh(e,kfe())},qu.apply(e,arguments)}function Lfe(){var e=EB(UI()).domain([.1,1,10]);return e.copy=function(){return Mh(e,Lfe()).base(e.base())},qu.apply(e,arguments)}function Mfe(){var e=bB(UI());return e.copy=function(){return Mh(e,Mfe()).constant(e.constant())},qu.apply(e,arguments)}function DB(){var e=SB(UI());return e.copy=function(){return Mh(e,DB()).exponent(e.exponent())},qu.apply(e,arguments)}function Rot(){return DB.apply(null,arguments).exponent(.5)}const Zee=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Gb,scaleDiverging:kfe,scaleDivergingLog:Lfe,scaleDivergingPow:DB,scaleDivergingSqrt:Rot,scaleDivergingSymlog:Mfe,scaleIdentity:pfe,scaleImplicit:_j,scaleLinear:TA,scaleLog:gfe,scaleOrdinal:fB,scalePoint:QE,scalePow:wB,scaleQuantile:_fe,scaleQuantize:Efe,scaleRadial:yfe,scaleSequential:xfe,scaleSequentialLog:Pfe,scaleSequentialPow:NB,scaleSequentialQuantile:Dfe,scaleSequentialSqrt:Cot,scaleSequentialSymlog:Nfe,scaleSqrt:sit,scaleSymlog:vfe,scaleThreshold:bfe,scaleTime:wot,scaleUtc:Tot,tickFormat:ffe},Symbol.toStringTag,{value:"Module"}));var Aot=ay;function Oot(e,t,n){for(var i=-1,a=e.length;++i<a;){var l=e[i],d=t(l);if(d!=null&&(f===void 0?d===d&&!Aot(d):n(d,f)))var f=d,m=l}return m}var VI=Oot;function Iot(e,t){return e>t}var jfe=Iot,xot=VI,Pot=jfe,Not=py;function Dot(e){return e&&e.length?xot(e,Not,Pot):void 0}var kot=Dot;const FI=zn(kot);function Lot(e,t){return e<t}var Ufe=Lot,Mot=VI,jot=Ufe,Uot=py;function Vot(e){return e&&e.length?Mot(e,Uot,jot):void 0}var Fot=Vot;const BI=zn(Fot);var Bot=HF,$ot=kh,Wot=Khe,Got=ws;function Hot(e,t){var n=Got(e)?Bot:Wot;return n(e,$ot(t))}var Kot=Hot,zot=Ghe,Yot=Kot;function qot(e,t){return zot(Yot(e,t),1)}var Xot=qot;const Jot=zn(Xot);var Qot=aB;function Zot(e,t){return Qot(e,t)}var est=Zot;const $I=zn(est);var vy=1e9,tst={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},LB,$r=!0,Ga="[DecimalError] ",up=Ga+"Invalid argument: ",kB=Ga+"Exponent out of range: ",yy=Math.floor,Bf=Math.pow,nst=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Gs,Ki=1e7,Dr=7,Vfe=9007199254740991,OA=yy(Vfe/Dr),ft={};ft.absoluteValue=ft.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ft.comparedTo=ft.cmp=function(e){var t,n,i,a,l=this;if(e=new l.constructor(e),l.s!==e.s)return l.s||-e.s;if(l.e!==e.e)return l.e>e.e^l.s<0?1:-1;for(i=l.d.length,a=e.d.length,t=0,n=i<a?i:a;t<n;++t)if(l.d[t]!==e.d[t])return l.d[t]>e.d[t]^l.s<0?1:-1;return i===a?0:i>a^l.s<0?1:-1};ft.decimalPlaces=ft.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Dr;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};ft.dividedBy=ft.div=function(e){return Nu(this,new this.constructor(e))};ft.dividedToIntegerBy=ft.idiv=function(e){var t=this,n=t.constructor;return gr(Nu(t,new n(e),0,1),n.precision)};ft.equals=ft.eq=function(e){return!this.cmp(e)};ft.exponent=function(){return Ai(this)};ft.greaterThan=ft.gt=function(e){return this.cmp(e)>0};ft.greaterThanOrEqualTo=ft.gte=function(e){return this.cmp(e)>=0};ft.isInteger=ft.isint=function(){return this.e>this.d.length-2};ft.isNegative=ft.isneg=function(){return this.s<0};ft.isPositive=ft.ispos=function(){return this.s>0};ft.isZero=function(){return this.s===0};ft.lessThan=ft.lt=function(e){return this.cmp(e)<0};ft.lessThanOrEqualTo=ft.lte=function(e){return this.cmp(e)<1};ft.logarithm=ft.log=function(e){var t,n=this,i=n.constructor,a=i.precision,l=a+5;if(e===void 0)e=new i(10);else if(e=new i(e),e.s<1||e.eq(Gs))throw Error(Ga+"NaN");if(n.s<1)throw Error(Ga+(n.s?"NaN":"-Infinity"));return n.eq(Gs)?new i(0):($r=!1,t=Nu(qb(n,l),qb(e,l),l),$r=!0,gr(t,a))};ft.minus=ft.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?$fe(t,e):Ffe(t,(e.s=-e.s,e))};ft.modulo=ft.mod=function(e){var t,n=this,i=n.constructor,a=i.precision;if(e=new i(e),!e.s)throw Error(Ga+"NaN");return n.s?($r=!1,t=Nu(n,e,0,1).times(e),$r=!0,n.minus(t)):gr(new i(n),a)};ft.naturalExponential=ft.exp=function(){return Bfe(this)};ft.naturalLogarithm=ft.ln=function(){return qb(this)};ft.negated=ft.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ft.plus=ft.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Ffe(t,e):$fe(t,(e.s=-e.s,e))};ft.precision=ft.sd=function(e){var t,n,i,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(up+e);if(t=Ai(a)+1,i=a.d.length-1,n=i*Dr+1,i=a.d[i],i){for(;i%10==0;i/=10)n--;for(i=a.d[0];i>=10;i/=10)n++}return e&&t>n?t:n};ft.squareRoot=ft.sqrt=function(){var e,t,n,i,a,l,d,f=this,m=f.constructor;if(f.s<1){if(!f.s)return new m(0);throw Error(Ga+"NaN")}for(e=Ai(f),$r=!1,a=Math.sqrt(+f),a==0||a==1/0?(t=El(f.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=yy((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),i=new m(t)):i=new m(a.toString()),n=m.precision,a=d=n+3;;)if(l=i,i=l.plus(Nu(f,l,d+2)).times(.5),El(l.d).slice(0,d)===(t=El(i.d)).slice(0,d)){if(t=t.slice(d-3,d+1),a==d&&t=="4999"){if(gr(l,n+1,0),l.times(l).eq(f)){i=l;break}}else if(t!="9999")break;d+=4}return $r=!0,gr(i,n)};ft.times=ft.mul=function(e){var t,n,i,a,l,d,f,m,v,E=this,S=E.constructor,T=E.d,R=(e=new S(e)).d;if(!E.s||!e.s)return new S(0);for(e.s*=E.s,n=E.e+e.e,m=T.length,v=R.length,m<v&&(l=T,T=R,R=l,d=m,m=v,v=d),l=[],d=m+v,i=d;i--;)l.push(0);for(i=v;--i>=0;){for(t=0,a=m+i;a>i;)f=l[a]+R[i]*T[a-i-1]+t,l[a--]=f%Ki|0,t=f/Ki|0;l[a]=(l[a]+t)%Ki|0}for(;!l[--d];)l.pop();return t?++n:l.shift(),e.d=l,e.e=n,$r?gr(e,S.precision):e};ft.toDecimalPlaces=ft.todp=function(e,t){var n=this,i=n.constructor;return n=new i(n),e===void 0?n:(Pl(e,0,vy),t===void 0?t=i.rounding:Pl(t,0,8),gr(n,e+Ai(n)+1,t))};ft.toExponential=function(e,t){var n,i=this,a=i.constructor;return e===void 0?n=Tp(i,!0):(Pl(e,0,vy),t===void 0?t=a.rounding:Pl(t,0,8),i=gr(new a(i),e+1,t),n=Tp(i,!0,e+1)),n};ft.toFixed=function(e,t){var n,i,a=this,l=a.constructor;return e===void 0?Tp(a):(Pl(e,0,vy),t===void 0?t=l.rounding:Pl(t,0,8),i=gr(new l(a),e+Ai(a)+1,t),n=Tp(i.abs(),!1,e+Ai(i)+1),a.isneg()&&!a.isZero()?"-"+n:n)};ft.toInteger=ft.toint=function(){var e=this,t=e.constructor;return gr(new t(e),Ai(e)+1,t.rounding)};ft.toNumber=function(){return+this};ft.toPower=ft.pow=function(e){var t,n,i,a,l,d,f=this,m=f.constructor,v=12,E=+(e=new m(e));if(!e.s)return new m(Gs);if(f=new m(f),!f.s){if(e.s<1)throw Error(Ga+"Infinity");return f}if(f.eq(Gs))return f;if(i=m.precision,e.eq(Gs))return gr(f,i);if(t=e.e,n=e.d.length-1,d=t>=n,l=f.s,d){if((n=E<0?-E:E)<=Vfe){for(a=new m(Gs),t=Math.ceil(i/Dr+4),$r=!1;n%2&&(a=a.times(f),tte(a.d,t)),n=yy(n/2),n!==0;)f=f.times(f),tte(f.d,t);return $r=!0,e.s<0?new m(Gs).div(a):gr(a,i)}}else if(l<0)throw Error(Ga+"NaN");return l=l<0&&e.d[Math.max(t,n)]&1?-1:1,f.s=1,$r=!1,a=e.times(qb(f,i+v)),$r=!0,a=Bfe(a),a.s=l,a};ft.toPrecision=function(e,t){var n,i,a=this,l=a.constructor;return e===void 0?(n=Ai(a),i=Tp(a,n<=l.toExpNeg||n>=l.toExpPos)):(Pl(e,1,vy),t===void 0?t=l.rounding:Pl(t,0,8),a=gr(new l(a),e,t),n=Ai(a),i=Tp(a,e<=n||n<=l.toExpNeg,e)),i};ft.toSignificantDigits=ft.tosd=function(e,t){var n=this,i=n.constructor;return e===void 0?(e=i.precision,t=i.rounding):(Pl(e,1,vy),t===void 0?t=i.rounding:Pl(t,0,8)),gr(new i(n),e,t)};ft.toString=ft.valueOf=ft.val=ft.toJSON=ft[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Ai(e),n=e.constructor;return Tp(e,t<=n.toExpNeg||t>=n.toExpPos)};function Ffe(e,t){var n,i,a,l,d,f,m,v,E=e.constructor,S=E.precision;if(!e.s||!t.s)return t.s||(t=new E(e)),$r?gr(t,S):t;if(m=e.d,v=t.d,d=e.e,a=t.e,m=m.slice(),l=d-a,l){for(l<0?(i=m,l=-l,f=v.length):(i=v,a=d,f=m.length),d=Math.ceil(S/Dr),f=d>f?d+1:f+1,l>f&&(l=f,i.length=1),i.reverse();l--;)i.push(0);i.reverse()}for(f=m.length,l=v.length,f-l<0&&(l=f,i=v,v=m,m=i),n=0;l;)n=(m[--l]=m[l]+v[l]+n)/Ki|0,m[l]%=Ki;for(n&&(m.unshift(n),++a),f=m.length;m[--f]==0;)m.pop();return t.d=m,t.e=a,$r?gr(t,S):t}function Pl(e,t,n){if(e!==~~e||e<t||e>n)throw Error(up+e)}function El(e){var t,n,i,a=e.length-1,l="",d=e[0];if(a>0){for(l+=d,t=1;t<a;t++)i=e[t]+"",n=Dr-i.length,n&&(l+=Gd(n)),l+=i;d=e[t],i=d+"",n=Dr-i.length,n&&(l+=Gd(n))}else if(d===0)return"0";for(;d%10===0;)d/=10;return l+d}var Nu=function(){function e(i,a){var l,d=0,f=i.length;for(i=i.slice();f--;)l=i[f]*a+d,i[f]=l%Ki|0,d=l/Ki|0;return d&&i.unshift(d),i}function t(i,a,l,d){var f,m;if(l!=d)m=l>d?1:-1;else for(f=m=0;f<l;f++)if(i[f]!=a[f]){m=i[f]>a[f]?1:-1;break}return m}function n(i,a,l){for(var d=0;l--;)i[l]-=d,d=i[l]<a[l]?1:0,i[l]=d*Ki+i[l]-a[l];for(;!i[0]&&i.length>1;)i.shift()}return function(i,a,l,d){var f,m,v,E,S,T,R,I,O,P,D,k,M,$,V,W,H,J,ee=i.constructor,le=i.s==a.s?1:-1,he=i.d,de=a.d;if(!i.s)return new ee(i);if(!a.s)throw Error(Ga+"Division by zero");for(m=i.e-a.e,H=de.length,V=he.length,R=new ee(le),I=R.d=[],v=0;de[v]==(he[v]||0);)++v;if(de[v]>(he[v]||0)&&--m,l==null?k=l=ee.precision:d?k=l+(Ai(i)-Ai(a))+1:k=l,k<0)return new ee(0);if(k=k/Dr+2|0,v=0,H==1)for(E=0,de=de[0],k++;(v<V||E)&&k--;v++)M=E*Ki+(he[v]||0),I[v]=M/de|0,E=M%de|0;else{for(E=Ki/(de[0]+1)|0,E>1&&(de=e(de,E),he=e(he,E),H=de.length,V=he.length),$=H,O=he.slice(0,H),P=O.length;P<H;)O[P++]=0;J=de.slice(),J.unshift(0),W=de[0],de[1]>=Ki/2&&++W;do E=0,f=t(de,O,H,P),f<0?(D=O[0],H!=P&&(D=D*Ki+(O[1]||0)),E=D/W|0,E>1?(E>=Ki&&(E=Ki-1),S=e(de,E),T=S.length,P=O.length,f=t(S,O,T,P),f==1&&(E--,n(S,H<T?J:de,T))):(E==0&&(f=E=1),S=de.slice()),T=S.length,T<P&&S.unshift(0),n(O,S,P),f==-1&&(P=O.length,f=t(de,O,H,P),f<1&&(E++,n(O,H<P?J:de,P))),P=O.length):f===0&&(E++,O=[0]),I[v++]=E,f&&O[0]?O[P++]=he[$]||0:(O=[he[$]],P=1);while(($++<V||O[0]!==void 0)&&k--)}return I[0]||I.shift(),R.e=m,gr(R,d?l+Ai(R)+1:l)}}();function Bfe(e,t){var n,i,a,l,d,f,m=0,v=0,E=e.constructor,S=E.precision;if(Ai(e)>16)throw Error(kB+Ai(e));if(!e.s)return new E(Gs);for($r=!1,f=S,d=new E(.03125);e.abs().gte(.1);)e=e.times(d),v+=5;for(i=Math.log(Bf(2,v))/Math.LN10*2+5|0,f+=i,n=a=l=new E(Gs),E.precision=f;;){if(a=gr(a.times(e),f),n=n.times(++m),d=l.plus(Nu(a,n,f)),El(d.d).slice(0,f)===El(l.d).slice(0,f)){for(;v--;)l=gr(l.times(l),f);return E.precision=S,t==null?($r=!0,gr(l,S)):l}l=d}}function Ai(e){for(var t=e.e*Dr,n=e.d[0];n>=10;n/=10)t++;return t}function ML(e,t,n){if(t>e.LN10.sd())throw $r=!0,n&&(e.precision=n),Error(Ga+"LN10 precision limit exceeded");return gr(new e(e.LN10),t)}function Gd(e){for(var t="";e--;)t+="0";return t}function qb(e,t){var n,i,a,l,d,f,m,v,E,S=1,T=10,R=e,I=R.d,O=R.constructor,P=O.precision;if(R.s<1)throw Error(Ga+(R.s?"NaN":"-Infinity"));if(R.eq(Gs))return new O(0);if(t==null?($r=!1,v=P):v=t,R.eq(10))return t==null&&($r=!0),ML(O,v);if(v+=T,O.precision=v,n=El(I),i=n.charAt(0),l=Ai(R),Math.abs(l)<15e14){for(;i<7&&i!=1||i==1&&n.charAt(1)>3;)R=R.times(e),n=El(R.d),i=n.charAt(0),S++;l=Ai(R),i>1?(R=new O("0."+n),l++):R=new O(i+"."+n.slice(1))}else return m=ML(O,v+2,P).times(l+""),R=qb(new O(i+"."+n.slice(1)),v-T).plus(m),O.precision=P,t==null?($r=!0,gr(R,P)):R;for(f=d=R=Nu(R.minus(Gs),R.plus(Gs),v),E=gr(R.times(R),v),a=3;;){if(d=gr(d.times(E),v),m=f.plus(Nu(d,new O(a),v)),El(m.d).slice(0,v)===El(f.d).slice(0,v))return f=f.times(2),l!==0&&(f=f.plus(ML(O,v+2,P).times(l+""))),f=Nu(f,new O(S),v),O.precision=P,t==null?($r=!0,gr(f,P)):f;f=m,a+=2}}function ete(e,t){var n,i,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(n<0&&(n=i),n+=+t.slice(i+1),t=t.substring(0,i)):n<0&&(n=t.length),i=0;t.charCodeAt(i)===48;)++i;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(i,a),t){if(a-=i,n=n-i-1,e.e=yy(n/Dr),e.d=[],i=(n+1)%Dr,n<0&&(i+=Dr),i<a){for(i&&e.d.push(+t.slice(0,i)),a-=Dr;i<a;)e.d.push(+t.slice(i,i+=Dr));t=t.slice(i),i=Dr-t.length}else i-=a;for(;i--;)t+="0";if(e.d.push(+t),$r&&(e.e>OA||e.e<-OA))throw Error(kB+n)}else e.s=0,e.e=0,e.d=[0];return e}function gr(e,t,n){var i,a,l,d,f,m,v,E,S=e.d;for(d=1,l=S[0];l>=10;l/=10)d++;if(i=t-d,i<0)i+=Dr,a=t,v=S[E=0];else{if(E=Math.ceil((i+1)/Dr),l=S.length,E>=l)return e;for(v=l=S[E],d=1;l>=10;l/=10)d++;i%=Dr,a=i-Dr+d}if(n!==void 0&&(l=Bf(10,d-a-1),f=v/l%10|0,m=t<0||S[E+1]!==void 0||v%l,m=n<4?(f||m)&&(n==0||n==(e.s<0?3:2)):f>5||f==5&&(n==4||m||n==6&&(i>0?a>0?v/Bf(10,d-a):0:S[E-1])%10&1||n==(e.s<0?8:7))),t<1||!S[0])return m?(l=Ai(e),S.length=1,t=t-l-1,S[0]=Bf(10,(Dr-t%Dr)%Dr),e.e=yy(-t/Dr)||0):(S.length=1,S[0]=e.e=e.s=0),e;if(i==0?(S.length=E,l=1,E--):(S.length=E+1,l=Bf(10,Dr-i),S[E]=a>0?(v/Bf(10,d-a)%Bf(10,a)|0)*l:0),m)for(;;)if(E==0){(S[0]+=l)==Ki&&(S[0]=1,++e.e);break}else{if(S[E]+=l,S[E]!=Ki)break;S[E--]=0,l=1}for(i=S.length;S[--i]===0;)S.pop();if($r&&(e.e>OA||e.e<-OA))throw Error(kB+Ai(e));return e}function $fe(e,t){var n,i,a,l,d,f,m,v,E,S,T=e.constructor,R=T.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new T(e),$r?gr(t,R):t;if(m=e.d,S=t.d,i=t.e,v=e.e,m=m.slice(),d=v-i,d){for(E=d<0,E?(n=m,d=-d,f=S.length):(n=S,i=v,f=m.length),a=Math.max(Math.ceil(R/Dr),f)+2,d>a&&(d=a,n.length=1),n.reverse(),a=d;a--;)n.push(0);n.reverse()}else{for(a=m.length,f=S.length,E=a<f,E&&(f=a),a=0;a<f;a++)if(m[a]!=S[a]){E=m[a]<S[a];break}d=0}for(E&&(n=m,m=S,S=n,t.s=-t.s),f=m.length,a=S.length-f;a>0;--a)m[f++]=0;for(a=S.length;a>d;){if(m[--a]<S[a]){for(l=a;l&&m[--l]===0;)m[l]=Ki-1;--m[l],m[a]+=Ki}m[a]-=S[a]}for(;m[--f]===0;)m.pop();for(;m[0]===0;m.shift())--i;return m[0]?(t.d=m,t.e=i,$r?gr(t,R):t):new T(0)}function Tp(e,t,n){var i,a=Ai(e),l=El(e.d),d=l.length;return t?(n&&(i=n-d)>0?l=l.charAt(0)+"."+l.slice(1)+Gd(i):d>1&&(l=l.charAt(0)+"."+l.slice(1)),l=l+(a<0?"e":"e+")+a):a<0?(l="0."+Gd(-a-1)+l,n&&(i=n-d)>0&&(l+=Gd(i))):a>=d?(l+=Gd(a+1-d),n&&(i=n-a-1)>0&&(l=l+"."+Gd(i))):((i=a+1)<d&&(l=l.slice(0,i)+"."+l.slice(i)),n&&(i=n-d)>0&&(a+1===d&&(l+="."),l+=Gd(i))),e.s<0?"-"+l:l}function tte(e,t){if(e.length>t)return e.length=t,!0}function Wfe(e){var t,n,i;function a(l){var d=this;if(!(d instanceof a))return new a(l);if(d.constructor=a,l instanceof a){d.s=l.s,d.e=l.e,d.d=(l=l.d)?l.slice():l;return}if(typeof l=="number"){if(l*0!==0)throw Error(up+l);if(l>0)d.s=1;else if(l<0)l=-l,d.s=-1;else{d.s=0,d.e=0,d.d=[0];return}if(l===~~l&&l<1e7){d.e=0,d.d=[l];return}return ete(d,l.toString())}else if(typeof l!="string")throw Error(up+l);if(l.charCodeAt(0)===45?(l=l.slice(1),d.s=-1):d.s=1,nst.test(l))ete(d,l);else throw Error(up+l)}if(a.prototype=ft,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=Wfe,a.config=a.set=rst,e===void 0&&(e={}),e)for(i=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<i.length;)e.hasOwnProperty(n=i[t++])||(e[n]=this[n]);return a.config(e),a}function rst(e){if(!e||typeof e!="object")throw Error(Ga+"Object expected");var t,n,i,a=["precision",1,vy,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((i=e[n=a[t]])!==void 0)if(yy(i)===i&&i>=a[t+1]&&i<=a[t+2])this[n]=i;else throw Error(up+n+": "+i);if((i=e[n="LN10"])!==void 0)if(i==Math.LN10)this[n]=new this(i);else throw Error(up+n+": "+i);return this}var LB=Wfe(tst);Gs=new LB(1);const sr=LB;function ist(e){return cst(e)||ast(e)||sst(e)||ost()}function ost(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sst(e,t){if(e){if(typeof e=="string")return wj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wj(e,t)}}function ast(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function cst(e){if(Array.isArray(e))return wj(e)}function wj(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var lst=function(t){return t},Gfe={},Hfe=function(t){return t===Gfe},nte=function(t){return function n(){return arguments.length===0||arguments.length===1&&Hfe(arguments.length<=0?void 0:arguments[0])?n:t.apply(void 0,arguments)}},ust=function e(t,n){return t===1?n:nte(function(){for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];var d=a.filter(function(f){return f!==Gfe}).length;return d>=t?n.apply(void 0,a):e(t-d,nte(function(){for(var f=arguments.length,m=new Array(f),v=0;v<f;v++)m[v]=arguments[v];var E=a.map(function(S){return Hfe(S)?m.shift():S});return n.apply(void 0,ist(E).concat(m))}))})},WI=function(t){return ust(t.length,t)},Tj=function(t,n){for(var i=[],a=t;a<n;++a)i[a-t]=a;return i},dst=WI(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),hst=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(!n.length)return lst;var a=n.reverse(),l=a[0],d=a.slice(1);return function(){return d.reduce(function(f,m){return m(f)},l.apply(void 0,arguments))}},Cj=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},Kfe=function(t){var n=null,i=null;return function(){for(var a=arguments.length,l=new Array(a),d=0;d<a;d++)l[d]=arguments[d];return n&&l.every(function(f,m){return f===n[m]})||(n=l,i=t.apply(void 0,l)),i}};function fst(e){var t;return e===0?t=1:t=Math.floor(new sr(e).abs().log(10).toNumber())+1,t}function pst(e,t,n){for(var i=new sr(e),a=0,l=[];i.lt(t)&&a<1e5;)l.push(i.toNumber()),i=i.add(n),a++;return l}var mst=WI(function(e,t,n){var i=+e,a=+t;return i+n*(a-i)}),gst=WI(function(e,t,n){var i=t-+e;return i=i||1/0,(n-e)/i}),vst=WI(function(e,t,n){var i=t-+e;return i=i||1/0,Math.max(0,Math.min(1,(n-e)/i))});const GI={rangeStep:pst,getDigitCount:fst,interpolateNumber:mst,uninterpolateNumber:gst,uninterpolateTruncation:vst};function Rj(e){return Est(e)||_st(e)||zfe(e)||yst()}function yst(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _st(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function Est(e){if(Array.isArray(e))return Aj(e)}function Xb(e,t){return wst(e)||Sst(e,t)||zfe(e,t)||bst()}function bst(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zfe(e,t){if(e){if(typeof e=="string")return Aj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Aj(e,t)}}function Aj(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Sst(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],i=!0,a=!1,l=void 0;try{for(var d=e[Symbol.iterator](),f;!(i=(f=d.next()).done)&&(n.push(f.value),!(t&&n.length===t));i=!0);}catch(m){a=!0,l=m}finally{try{!i&&d.return!=null&&d.return()}finally{if(a)throw l}}return n}}function wst(e){if(Array.isArray(e))return e}function Yfe(e){var t=Xb(e,2),n=t[0],i=t[1],a=n,l=i;return n>i&&(a=i,l=n),[a,l]}function qfe(e,t,n){if(e.lte(0))return new sr(0);var i=GI.getDigitCount(e.toNumber()),a=new sr(10).pow(i),l=e.div(a),d=i!==1?.05:.1,f=new sr(Math.ceil(l.div(d).toNumber())).add(n).mul(d),m=f.mul(a);return t?m:new sr(Math.ceil(m))}function Tst(e,t,n){var i=1,a=new sr(e);if(!a.isint()&&n){var l=Math.abs(e);l<1?(i=new sr(10).pow(GI.getDigitCount(e)-1),a=new sr(Math.floor(a.div(i).toNumber())).mul(i)):l>1&&(a=new sr(Math.floor(e)))}else e===0?a=new sr(Math.floor((t-1)/2)):n||(a=new sr(Math.floor(e)));var d=Math.floor((t-1)/2),f=hst(dst(function(m){return a.add(new sr(m-d).mul(i)).toNumber()}),Tj);return f(0,t)}function Xfe(e,t,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new sr(0),tickMin:new sr(0),tickMax:new sr(0)};var l=qfe(new sr(t).sub(e).div(n-1),i,a),d;e<=0&&t>=0?d=new sr(0):(d=new sr(e).add(t).div(2),d=d.sub(new sr(d).mod(l)));var f=Math.ceil(d.sub(e).div(l).toNumber()),m=Math.ceil(new sr(t).sub(d).div(l).toNumber()),v=f+m+1;return v>n?Xfe(e,t,n,i,a+1):(v<n&&(m=t>0?m+(n-v):m,f=t>0?f:f+(n-v)),{step:l,tickMin:d.sub(new sr(f).mul(l)),tickMax:d.add(new sr(m).mul(l))})}function Cst(e){var t=Xb(e,2),n=t[0],i=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,d=Math.max(a,2),f=Yfe([n,i]),m=Xb(f,2),v=m[0],E=m[1];if(v===-1/0||E===1/0){var S=E===1/0?[v].concat(Rj(Tj(0,a-1).map(function(){return 1/0}))):[].concat(Rj(Tj(0,a-1).map(function(){return-1/0})),[E]);return n>i?Cj(S):S}if(v===E)return Tst(v,a,l);var T=Xfe(v,E,d,l),R=T.step,I=T.tickMin,O=T.tickMax,P=GI.rangeStep(I,O.add(new sr(.1).mul(R)),R);return n>i?Cj(P):P}function Rst(e,t){var n=Xb(e,2),i=n[0],a=n[1],l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,d=Yfe([i,a]),f=Xb(d,2),m=f[0],v=f[1];if(m===-1/0||v===1/0)return[i,a];if(m===v)return[m];var E=Math.max(t,2),S=qfe(new sr(v).sub(m).div(E-1),l,0),T=[].concat(Rj(GI.rangeStep(new sr(m),new sr(v).sub(new sr(.99).mul(S)),S)),[v]);return i>a?Cj(T):T}var Ast=Kfe(Cst),Ost=Kfe(Rst),Ist="Invariant failed";function Cp(e,t){throw new Error(Ist)}var xst=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Av(e){"@babel/helpers - typeof";return Av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Av(e)}function IA(){return IA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},IA.apply(this,arguments)}function Pst(e,t){return Lst(e)||kst(e,t)||Dst(e,t)||Nst()}function Nst(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dst(e,t){if(e){if(typeof e=="string")return rte(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rte(e,t)}}function rte(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function kst(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,a,l,d,f=[],m=!0,v=!1;try{if(l=(n=n.call(e)).next,t!==0)for(;!(m=(i=l.call(n)).done)&&(f.push(i.value),f.length!==t);m=!0);}catch(E){v=!0,a=E}finally{try{if(!m&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(v)throw a}}return f}}function Lst(e){if(Array.isArray(e))return e}function Mst(e,t){if(e==null)return{};var n=jst(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function jst(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function Ust(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vst(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Zfe(i.key),i)}}function Fst(e,t,n){return t&&Vst(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Bst(e,t,n){return t=xA(t),$st(e,Jfe()?Reflect.construct(t,n||[],xA(e).constructor):t.apply(e,n))}function $st(e,t){if(t&&(Av(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wst(e)}function Wst(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jfe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Jfe=function(){return!!e})()}function xA(e){return xA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},xA(e)}function Gst(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oj(e,t)}function Oj(e,t){return Oj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},Oj(e,t)}function Qfe(e,t,n){return t=Zfe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zfe(e){var t=Hst(e,"string");return Av(t)=="symbol"?t:t+""}function Hst(e,t){if(Av(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Av(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var HI=function(e){function t(){return Ust(this,t),Bst(this,t,arguments)}return Gst(t,e),Fst(t,[{key:"render",value:function(){var i=this.props,a=i.offset,l=i.layout,d=i.width,f=i.dataKey,m=i.data,v=i.dataPointFormatter,E=i.xAxis,S=i.yAxis,T=Mst(i,xst),R=Vt(T,!1);this.props.direction==="x"&&E.type!=="number"&&Cp();var I=m.map(function(O){var P=v(O,f),D=P.x,k=P.y,M=P.value,$=P.errorVal;if(!$)return null;var V=[],W,H;if(Array.isArray($)){var J=Pst($,2);W=J[0],H=J[1]}else W=H=$;if(l==="vertical"){var ee=E.scale,le=k+a,he=le+d,de=le-d,ae=ee(M-W),ce=ee(M+H);V.push({x1:ce,y1:he,x2:ce,y2:de}),V.push({x1:ae,y1:le,x2:ce,y2:le}),V.push({x1:ae,y1:he,x2:ae,y2:de})}else if(l==="horizontal"){var ge=S.scale,ye=D+a,te=ye-d,ne=ye+d,ue=ge(M-W),_e=ge(M+H);V.push({x1:te,y1:_e,x2:ne,y2:_e}),V.push({x1:ye,y1:ue,x2:ye,y2:_e}),V.push({x1:te,y1:ue,x2:ne,y2:ue})}return se.createElement(er,IA({className:"recharts-errorBar",key:"bar-".concat(V.map(function(Ce){return"".concat(Ce.x1,"-").concat(Ce.x2,"-").concat(Ce.y1,"-").concat(Ce.y2)}))},R),V.map(function(Ce){return se.createElement("line",IA({},Ce,{key:"line-".concat(Ce.x1,"-").concat(Ce.x2,"-").concat(Ce.y1,"-").concat(Ce.y2)}))}))});return se.createElement(er,{className:"recharts-errorBars"},I)}}])}(se.Component);Qfe(HI,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});Qfe(HI,"displayName","ErrorBar");function Jb(e){"@babel/helpers - typeof";return Jb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jb(e)}function ite(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Pf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ite(Object(n),!0).forEach(function(i){Kst(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ite(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Kst(e,t,n){return t=zst(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zst(e){var t=Yst(e,"string");return Jb(t)=="symbol"?t:t+""}function Yst(e,t){if(Jb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Jb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var epe=function(t){var n=t.children,i=t.formattedGraphicalItems,a=t.legendWidth,l=t.legendContent,d=$s(n,ph);if(!d)return null;var f=ph.defaultProps,m=f!==void 0?Pf(Pf({},f),d.props):{},v;return d.props&&d.props.payload?v=d.props&&d.props.payload:l==="children"?v=(i||[]).reduce(function(E,S){var T=S.item,R=S.props,I=R.sectors||R.data||[];return E.concat(I.map(function(O){return{type:d.props.iconType||T.props.legendType,value:O.name,color:O.fill,payload:O}}))},[]):v=(i||[]).map(function(E){var S=E.item,T=S.type.defaultProps,R=T!==void 0?Pf(Pf({},T),S.props):{},I=R.dataKey,O=R.name,P=R.legendType,D=R.hide;return{inactive:D,dataKey:I,type:m.iconType||P||"square",color:MB(S),value:O||I,payload:R}}),Pf(Pf(Pf({},m),ph.getWithHeight(d,a)),{},{payload:v,item:d})};function Qb(e){"@babel/helpers - typeof";return Qb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qb(e)}function ote(e){return Qst(e)||Jst(e)||Xst(e)||qst()}function qst(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xst(e,t){if(e){if(typeof e=="string")return Ij(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ij(e,t)}}function Jst(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qst(e){if(Array.isArray(e))return Ij(e)}function Ij(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ste(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function di(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ste(Object(n),!0).forEach(function(i){qg(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ste(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function qg(e,t,n){return t=Zst(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zst(e){var t=eat(e,"string");return Qb(t)=="symbol"?t:t+""}function eat(e,t){if(Qb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Qb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function To(e,t,n){return En(e)||En(t)?n:Mi(t)?qs(e,t,n):Xt(t)?t(e):n}function ZE(e,t,n,i){var a=Jot(e,function(f){return To(f,t)});if(n==="number"){var l=a.filter(function(f){return rt(f)||parseFloat(f)});return l.length?[BI(l),FI(l)]:[1/0,-1/0]}var d=i?a.filter(function(f){return!En(f)}):a;return d.map(function(f){return Mi(f)||f instanceof Date?f:""})}var tat=function(t){var n,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,d=-1,f=(n=i==null?void 0:i.length)!==null&&n!==void 0?n:0;if(f<=1)return 0;if(l&&l.axisType==="angleAxis"&&Math.abs(Math.abs(l.range[1]-l.range[0])-360)<=1e-6)for(var m=l.range,v=0;v<f;v++){var E=v>0?a[v-1].coordinate:a[f-1].coordinate,S=a[v].coordinate,T=v>=f-1?a[0].coordinate:a[v+1].coordinate,R=void 0;if(Bo(S-E)!==Bo(T-S)){var I=[];if(Bo(T-S)===Bo(m[1]-m[0])){R=T;var O=S+m[1]-m[0];I[0]=Math.min(O,(O+E)/2),I[1]=Math.max(O,(O+E)/2)}else{R=E;var P=T+m[1]-m[0];I[0]=Math.min(S,(P+S)/2),I[1]=Math.max(S,(P+S)/2)}var D=[Math.min(S,(R+S)/2),Math.max(S,(R+S)/2)];if(t>D[0]&&t<=D[1]||t>=I[0]&&t<=I[1]){d=a[v].index;break}}else{var k=Math.min(E,T),M=Math.max(E,T);if(t>(k+S)/2&&t<=(M+S)/2){d=a[v].index;break}}}else for(var $=0;$<f;$++)if($===0&&t<=(i[$].coordinate+i[$+1].coordinate)/2||$>0&&$<f-1&&t>(i[$].coordinate+i[$-1].coordinate)/2&&t<=(i[$].coordinate+i[$+1].coordinate)/2||$===f-1&&t>(i[$].coordinate+i[$-1].coordinate)/2){d=i[$].index;break}return d},MB=function(t){var n,i=t,a=i.type.displayName,l=(n=t.type)!==null&&n!==void 0&&n.defaultProps?di(di({},t.type.defaultProps),t.props):t.props,d=l.stroke,f=l.fill,m;switch(a){case"Line":m=d;break;case"Area":case"Radar":m=d&&d!=="none"?d:f;break;default:m=f;break}return m},nat=function(t){var n=t.barSize,i=t.totalSize,a=t.stackGroups,l=a===void 0?{}:a;if(!l)return{};for(var d={},f=Object.keys(l),m=0,v=f.length;m<v;m++)for(var E=l[f[m]].stackGroups,S=Object.keys(E),T=0,R=S.length;T<R;T++){var I=E[S[T]],O=I.items,P=I.cateAxisId,D=O.filter(function(H){return xu(H.type).indexOf("Bar")>=0});if(D&&D.length){var k=D[0].type.defaultProps,M=k!==void 0?di(di({},k),D[0].props):D[0].props,$=M.barSize,V=M[P];d[V]||(d[V]=[]);var W=En($)?n:$;d[V].push({item:D[0],stackList:D.slice(1),barSize:En(W)?void 0:$o(W,i,0)})}}return d},rat=function(t){var n=t.barGap,i=t.barCategoryGap,a=t.bandSize,l=t.sizeList,d=l===void 0?[]:l,f=t.maxBarSize,m=d.length;if(m<1)return null;var v=$o(n,a,0,!0),E,S=[];if(d[0].barSize===+d[0].barSize){var T=!1,R=a/m,I=d.reduce(function($,V){return $+V.barSize||0},0);I+=(m-1)*v,I>=a&&(I-=(m-1)*v,v=0),I>=a&&R>0&&(T=!0,R*=.9,I=m*R);var O=(a-I)/2>>0,P={offset:O-v,size:0};E=d.reduce(function($,V){var W={item:V.item,position:{offset:P.offset+P.size+v,size:T?R:V.barSize}},H=[].concat(ote($),[W]);return P=H[H.length-1].position,V.stackList&&V.stackList.length&&V.stackList.forEach(function(J){H.push({item:J,position:P})}),H},S)}else{var D=$o(i,a,0,!0);a-2*D-(m-1)*v<=0&&(v=0);var k=(a-2*D-(m-1)*v)/m;k>1&&(k>>=0);var M=f===+f?Math.min(k,f):k;E=d.reduce(function($,V,W){var H=[].concat(ote($),[{item:V.item,position:{offset:D+(k+v)*W+(k-M)/2,size:M}}]);return V.stackList&&V.stackList.length&&V.stackList.forEach(function(J){H.push({item:J,position:H[H.length-1].position})}),H},S)}return E},iat=function(t,n,i,a){var l=i.children,d=i.width,f=i.margin,m=d-(f.left||0)-(f.right||0),v=epe({children:l,legendWidth:m});if(v){var E=a||{},S=E.width,T=E.height,R=v.align,I=v.verticalAlign,O=v.layout;if((O==="vertical"||O==="horizontal"&&I==="middle")&&R!=="center"&&rt(t[R]))return di(di({},t),{},qg({},R,t[R]+(S||0)));if((O==="horizontal"||O==="vertical"&&R==="center")&&I!=="middle"&&rt(t[I]))return di(di({},t),{},qg({},I,t[I]+(T||0)))}return t},oat=function(t,n,i){return En(n)?!0:t==="horizontal"?n==="yAxis":t==="vertical"||i==="x"?n==="xAxis":i==="y"?n==="yAxis":!0},tpe=function(t,n,i,a,l){var d=n.props.children,f=Ba(d,HI).filter(function(v){return oat(a,l,v.props.direction)});if(f&&f.length){var m=f.map(function(v){return v.props.dataKey});return t.reduce(function(v,E){var S=To(E,i);if(En(S))return v;var T=Array.isArray(S)?[BI(S),FI(S)]:[S,S],R=m.reduce(function(I,O){var P=To(E,O,0),D=T[0]-Math.abs(Array.isArray(P)?P[0]:P),k=T[1]+Math.abs(Array.isArray(P)?P[1]:P);return[Math.min(D,I[0]),Math.max(k,I[1])]},[1/0,-1/0]);return[Math.min(R[0],v[0]),Math.max(R[1],v[1])]},[1/0,-1/0])}return null},sat=function(t,n,i,a,l){var d=n.map(function(f){return tpe(t,f,i,l,a)}).filter(function(f){return!En(f)});return d&&d.length?d.reduce(function(f,m){return[Math.min(f[0],m[0]),Math.max(f[1],m[1])]},[1/0,-1/0]):null},npe=function(t,n,i,a,l){var d=n.map(function(m){var v=m.props.dataKey;return i==="number"&&v&&tpe(t,m,v,a)||ZE(t,v,i,l)});if(i==="number")return d.reduce(function(m,v){return[Math.min(m[0],v[0]),Math.max(m[1],v[1])]},[1/0,-1/0]);var f={};return d.reduce(function(m,v){for(var E=0,S=v.length;E<S;E++)f[v[E]]||(f[v[E]]=!0,m.push(v[E]));return m},[])},rpe=function(t,n){return t==="horizontal"&&n==="xAxis"||t==="vertical"&&n==="yAxis"||t==="centric"&&n==="angleAxis"||t==="radial"&&n==="radiusAxis"},Zf=function(t,n,i){if(!t)return null;var a=t.scale,l=t.duplicateDomain,d=t.type,f=t.range,m=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,v=(n||i)&&d==="category"&&a.bandwidth?a.bandwidth()/m:0;if(v=t.axisType==="angleAxis"&&(f==null?void 0:f.length)>=2?Bo(f[0]-f[1])*2*v:v,n&&(t.ticks||t.niceTicks)){var E=(t.ticks||t.niceTicks).map(function(S){var T=l?l.indexOf(S):S;return{coordinate:a(T)+v,value:S,offset:v}});return E.filter(function(S){return!WS(S.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(S,T){return{coordinate:a(S)+v,value:S,index:T,offset:v}}):a.ticks&&!i?a.ticks(t.tickCount).map(function(S){return{coordinate:a(S)+v,value:S,offset:v}}):a.domain().map(function(S,T){return{coordinate:a(S)+v,value:l?l[S]:S,index:T,offset:v}})},jL=new WeakMap,$C=function(t,n){if(typeof n!="function")return t;jL.has(t)||jL.set(t,new WeakMap);var i=jL.get(t);if(i.has(n))return i.get(n);var a=function(){t.apply(void 0,arguments),n.apply(void 0,arguments)};return i.set(n,a),a},ipe=function(t,n,i){var a=t.scale,l=t.type,d=t.layout,f=t.axisType;if(a==="auto")return d==="radial"&&f==="radiusAxis"?{scale:Gb(),realScaleType:"band"}:d==="radial"&&f==="angleAxis"?{scale:TA(),realScaleType:"linear"}:l==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!i)?{scale:QE(),realScaleType:"point"}:l==="category"?{scale:Gb(),realScaleType:"band"}:{scale:TA(),realScaleType:"linear"};if(bp(a)){var m="scale".concat(CI(a));return{scale:(Zee[m]||QE)(),realScaleType:Zee[m]?m:"point"}}return Xt(a)?{scale:a}:{scale:QE(),realScaleType:"point"}},ate=1e-4,ope=function(t){var n=t.domain();if(!(!n||n.length<=2)){var i=n.length,a=t.range(),l=Math.min(a[0],a[1])-ate,d=Math.max(a[0],a[1])+ate,f=t(n[0]),m=t(n[i-1]);(f<l||f>d||m<l||m>d)&&t.domain([n[0],n[i-1]])}},aat=function(t,n){if(!t)return null;for(var i=0,a=t.length;i<a;i++)if(t[i].item===n)return t[i].position;return null},cat=function(t,n){if(!n||n.length!==2||!rt(n[0])||!rt(n[1]))return t;var i=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]),l=[t[0],t[1]];return(!rt(t[0])||t[0]<i)&&(l[0]=i),(!rt(t[1])||t[1]>a)&&(l[1]=a),l[0]>a&&(l[0]=a),l[1]<i&&(l[1]=i),l},lat=function(t){var n=t.length;if(!(n<=0))for(var i=0,a=t[0].length;i<a;++i)for(var l=0,d=0,f=0;f<n;++f){var m=WS(t[f][i][1])?t[f][i][0]:t[f][i][1];m>=0?(t[f][i][0]=l,t[f][i][1]=l+m,l=t[f][i][1]):(t[f][i][0]=d,t[f][i][1]=d+m,d=t[f][i][1])}},uat=function(t){var n=t.length;if(!(n<=0))for(var i=0,a=t[0].length;i<a;++i)for(var l=0,d=0;d<n;++d){var f=WS(t[d][i][1])?t[d][i][0]:t[d][i][1];f>=0?(t[d][i][0]=l,t[d][i][1]=l+f,l=t[d][i][1]):(t[d][i][0]=0,t[d][i][1]=0)}},dat={sign:lat,expand:Aqe,none:_v,silhouette:Oqe,wiggle:Iqe,positive:uat},hat=function(t,n,i){var a=n.map(function(f){return f.props.dataKey}),l=dat[i],d=Rqe().keys(a).value(function(f,m){return+To(f,m,0)}).order(ej).offset(l);return d(t)},fat=function(t,n,i,a,l,d){if(!t)return null;var f=d?n.reverse():n,m={},v=f.reduce(function(S,T){var R,I=(R=T.type)!==null&&R!==void 0&&R.defaultProps?di(di({},T.type.defaultProps),T.props):T.props,O=I.stackId,P=I.hide;if(P)return S;var D=I[i],k=S[D]||{hasStack:!1,stackGroups:{}};if(Mi(O)){var M=k.stackGroups[O]||{numericAxisId:i,cateAxisId:a,items:[]};M.items.push(T),k.hasStack=!0,k.stackGroups[O]=M}else k.stackGroups[GS("_stackId_")]={numericAxisId:i,cateAxisId:a,items:[T]};return di(di({},S),{},qg({},D,k))},m),E={};return Object.keys(v).reduce(function(S,T){var R=v[T];if(R.hasStack){var I={};R.stackGroups=Object.keys(R.stackGroups).reduce(function(O,P){var D=R.stackGroups[P];return di(di({},O),{},qg({},P,{numericAxisId:i,cateAxisId:a,items:D.items,stackedData:hat(t,D.items,l)}))},I)}return di(di({},S),{},qg({},T,R))},E)},spe=function(t,n){var i=n.realScaleType,a=n.type,l=n.tickCount,d=n.originalDomain,f=n.allowDecimals,m=i||n.scale;if(m!=="auto"&&m!=="linear")return null;if(l&&a==="number"&&d&&(d[0]==="auto"||d[1]==="auto")){var v=t.domain();if(!v.length)return null;var E=Ast(v,l,f);return t.domain([BI(E),FI(E)]),{niceTicks:E}}if(l&&a==="number"){var S=t.domain(),T=Ost(S,l,f);return{niceTicks:T}}return null},cte=function(t){var n=t.axis,i=t.ticks,a=t.offset,l=t.bandSize,d=t.entry,f=t.index;if(n.type==="category")return i[f]?i[f].coordinate+a:null;var m=To(d,n.dataKey,n.domain[f]);return En(m)?null:n.scale(m)-l/2+a},pat=function(t){var n=t.numericAxis,i=n.scale.domain();if(n.type==="number"){var a=Math.min(i[0],i[1]),l=Math.max(i[0],i[1]);return a<=0&&l>=0?0:l<0?l:a}return i[0]},mat=function(t,n){var i,a=(i=t.type)!==null&&i!==void 0&&i.defaultProps?di(di({},t.type.defaultProps),t.props):t.props,l=a.stackId;if(Mi(l)){var d=n[l];if(d){var f=d.items.indexOf(t);return f>=0?d.stackedData[f]:null}}return null},gat=function(t){return t.reduce(function(n,i){return[BI(i.concat([n[0]]).filter(rt)),FI(i.concat([n[1]]).filter(rt))]},[1/0,-1/0])},ape=function(t,n,i){return Object.keys(t).reduce(function(a,l){var d=t[l],f=d.stackedData,m=f.reduce(function(v,E){var S=gat(E.slice(n,i+1));return[Math.min(v[0],S[0]),Math.max(v[1],S[1])]},[1/0,-1/0]);return[Math.min(m[0],a[0]),Math.max(m[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},lte=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,ute=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,xj=function(t,n,i){if(Xt(t))return t(n,i);if(!Array.isArray(t))return n;var a=[];if(rt(t[0]))a[0]=i?t[0]:Math.min(t[0],n[0]);else if(lte.test(t[0])){var l=+lte.exec(t[0])[1];a[0]=n[0]-l}else Xt(t[0])?a[0]=t[0](n[0]):a[0]=n[0];if(rt(t[1]))a[1]=i?t[1]:Math.max(t[1],n[1]);else if(ute.test(t[1])){var d=+ute.exec(t[1])[1];a[1]=n[1]+d}else Xt(t[1])?a[1]=t[1](n[1]):a[1]=n[1];return a},PA=function(t,n,i){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!i||a>0)return a}if(t&&n&&n.length>=2){for(var l=lB(n,function(S){return S.coordinate}),d=1/0,f=1,m=l.length;f<m;f++){var v=l[f],E=l[f-1];d=Math.min((v.coordinate||0)-(E.coordinate||0),d)}return d===1/0?0:d}return i?void 0:0},dte=function(t,n,i){return!t||!t.length||$I(t,qs(i,"type.defaultProps.domain"))?n:t},cpe=function(t,n){var i=t.type.defaultProps?di(di({},t.type.defaultProps),t.props):t.props,a=i.dataKey,l=i.name,d=i.unit,f=i.formatter,m=i.tooltipType,v=i.chartType,E=i.hide;return di(di({},Vt(t,!1)),{},{dataKey:a,unit:d,formatter:f,name:l||a,color:MB(t),value:To(n,a),type:m,payload:n,chartType:v,hide:E})};function Zb(e){"@babel/helpers - typeof";return Zb=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zb(e)}function hte(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function du(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hte(Object(n),!0).forEach(function(i){lpe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hte(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function lpe(e,t,n){return t=vat(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vat(e){var t=yat(e,"string");return Zb(t)=="symbol"?t:t+""}function yat(e,t){if(Zb(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Zb(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _at(e,t){return wat(e)||Sat(e,t)||bat(e,t)||Eat()}function Eat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bat(e,t){if(e){if(typeof e=="string")return fte(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fte(e,t)}}function fte(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Sat(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,a,l,d,f=[],m=!0,v=!1;try{if(l=(n=n.call(e)).next,t!==0)for(;!(m=(i=l.call(n)).done)&&(f.push(i.value),f.length!==t);m=!0);}catch(E){v=!0,a=E}finally{try{if(!m&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(v)throw a}}return f}}function wat(e){if(Array.isArray(e))return e}var NA=Math.PI/180,Tat=function(t){return t*180/Math.PI},wr=function(t,n,i,a){return{x:t+Math.cos(-NA*a)*i,y:n+Math.sin(-NA*a)*i}},upe=function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(i.left||0)-(i.right||0)),Math.abs(n-(i.top||0)-(i.bottom||0)))/2},Cat=function(t,n,i,a,l){var d=t.width,f=t.height,m=t.startAngle,v=t.endAngle,E=$o(t.cx,d,d/2),S=$o(t.cy,f,f/2),T=upe(d,f,i),R=$o(t.innerRadius,T,0),I=$o(t.outerRadius,T,T*.8),O=Object.keys(n);return O.reduce(function(P,D){var k=n[D],M=k.domain,$=k.reversed,V;if(En(k.range))a==="angleAxis"?V=[m,v]:a==="radiusAxis"&&(V=[R,I]),$&&(V=[V[1],V[0]]);else{V=k.range;var W=V,H=_at(W,2);m=H[0],v=H[1]}var J=ipe(k,l),ee=J.realScaleType,le=J.scale;le.domain(M).range(V),ope(le);var he=spe(le,du(du({},k),{},{realScaleType:ee})),de=du(du(du({},k),he),{},{range:V,radius:I,realScaleType:ee,scale:le,cx:E,cy:S,innerRadius:R,outerRadius:I,startAngle:m,endAngle:v});return du(du({},P),{},lpe({},D,de))},{})},Rat=function(t,n){var i=t.x,a=t.y,l=n.x,d=n.y;return Math.sqrt(Math.pow(i-l,2)+Math.pow(a-d,2))},Aat=function(t,n){var i=t.x,a=t.y,l=n.cx,d=n.cy,f=Rat({x:i,y:a},{x:l,y:d});if(f<=0)return{radius:f};var m=(i-l)/f,v=Math.acos(m);return a>d&&(v=2*Math.PI-v),{radius:f,angle:Tat(v),angleInRadian:v}},Oat=function(t){var n=t.startAngle,i=t.endAngle,a=Math.floor(n/360),l=Math.floor(i/360),d=Math.min(a,l);return{startAngle:n-d*360,endAngle:i-d*360}},Iat=function(t,n){var i=n.startAngle,a=n.endAngle,l=Math.floor(i/360),d=Math.floor(a/360),f=Math.min(l,d);return t+f*360},pte=function(t,n){var i=t.x,a=t.y,l=Aat({x:i,y:a},n),d=l.radius,f=l.angle,m=n.innerRadius,v=n.outerRadius;if(d<m||d>v)return!1;if(d===0)return!0;var E=Oat(n),S=E.startAngle,T=E.endAngle,R=f,I;if(S<=T){for(;R>T;)R-=360;for(;R<S;)R+=360;I=R>=S&&R<=T}else{for(;R>S;)R-=360;for(;R<T;)R+=360;I=R>=T&&R<=S}return I?du(du({},n),{},{radius:d,angle:Iat(R,n)}):null},dpe=function(t){return!N.isValidElement(t)&&!Xt(t)&&typeof t!="boolean"?t.className:""};function eS(e){"@babel/helpers - typeof";return eS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eS(e)}var xat=["offset"];function Pat(e){return Lat(e)||kat(e)||Dat(e)||Nat()}function Nat(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dat(e,t){if(e){if(typeof e=="string")return Pj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pj(e,t)}}function kat(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Lat(e){if(Array.isArray(e))return Pj(e)}function Pj(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Mat(e,t){if(e==null)return{};var n=jat(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function jat(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function mte(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Di(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?mte(Object(n),!0).forEach(function(i){Uat(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mte(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Uat(e,t,n){return t=Vat(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vat(e){var t=Fat(e,"string");return eS(t)=="symbol"?t:t+""}function Fat(e,t){if(eS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(eS(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tS(){return tS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},tS.apply(this,arguments)}var Bat=function(t){var n=t.value,i=t.formatter,a=En(t.children)?n:t.children;return Xt(i)?i(a):a},$at=function(t,n){var i=Bo(n-t),a=Math.min(Math.abs(n-t),360);return i*a},Wat=function(t,n,i){var a=t.position,l=t.viewBox,d=t.offset,f=t.className,m=l,v=m.cx,E=m.cy,S=m.innerRadius,T=m.outerRadius,R=m.startAngle,I=m.endAngle,O=m.clockWise,P=(S+T)/2,D=$at(R,I),k=D>=0?1:-1,M,$;a==="insideStart"?(M=R+k*d,$=O):a==="insideEnd"?(M=I-k*d,$=!O):a==="end"&&(M=I+k*d,$=O),$=D<=0?$:!$;var V=wr(v,E,P,M),W=wr(v,E,P,M+($?1:-1)*359),H="M".concat(V.x,",").concat(V.y,`
    A`).concat(P,",").concat(P,",0,1,").concat($?0:1,`,
    `).concat(W.x,",").concat(W.y),J=En(t.id)?GS("recharts-radial-line-"):t.id;return se.createElement("text",tS({},i,{dominantBaseline:"central",className:un("recharts-radial-bar-label",f)}),se.createElement("defs",null,se.createElement("path",{id:J,d:H})),se.createElement("textPath",{xlinkHref:"#".concat(J)},n))},Gat=function(t){var n=t.viewBox,i=t.offset,a=t.position,l=n,d=l.cx,f=l.cy,m=l.innerRadius,v=l.outerRadius,E=l.startAngle,S=l.endAngle,T=(E+S)/2;if(a==="outside"){var R=wr(d,f,v+i,T),I=R.x,O=R.y;return{x:I,y:O,textAnchor:I>=d?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:d,y:f,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:d,y:f,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:d,y:f,textAnchor:"middle",verticalAnchor:"end"};var P=(m+v)/2,D=wr(d,f,P,T),k=D.x,M=D.y;return{x:k,y:M,textAnchor:"middle",verticalAnchor:"middle"}},Hat=function(t){var n=t.viewBox,i=t.parentViewBox,a=t.offset,l=t.position,d=n,f=d.x,m=d.y,v=d.width,E=d.height,S=E>=0?1:-1,T=S*a,R=S>0?"end":"start",I=S>0?"start":"end",O=v>=0?1:-1,P=O*a,D=O>0?"end":"start",k=O>0?"start":"end";if(l==="top"){var M={x:f+v/2,y:m-S*a,textAnchor:"middle",verticalAnchor:R};return Di(Di({},M),i?{height:Math.max(m-i.y,0),width:v}:{})}if(l==="bottom"){var $={x:f+v/2,y:m+E+T,textAnchor:"middle",verticalAnchor:I};return Di(Di({},$),i?{height:Math.max(i.y+i.height-(m+E),0),width:v}:{})}if(l==="left"){var V={x:f-P,y:m+E/2,textAnchor:D,verticalAnchor:"middle"};return Di(Di({},V),i?{width:Math.max(V.x-i.x,0),height:E}:{})}if(l==="right"){var W={x:f+v+P,y:m+E/2,textAnchor:k,verticalAnchor:"middle"};return Di(Di({},W),i?{width:Math.max(i.x+i.width-W.x,0),height:E}:{})}var H=i?{width:v,height:E}:{};return l==="insideLeft"?Di({x:f+P,y:m+E/2,textAnchor:k,verticalAnchor:"middle"},H):l==="insideRight"?Di({x:f+v-P,y:m+E/2,textAnchor:D,verticalAnchor:"middle"},H):l==="insideTop"?Di({x:f+v/2,y:m+T,textAnchor:"middle",verticalAnchor:I},H):l==="insideBottom"?Di({x:f+v/2,y:m+E-T,textAnchor:"middle",verticalAnchor:R},H):l==="insideTopLeft"?Di({x:f+P,y:m+T,textAnchor:k,verticalAnchor:I},H):l==="insideTopRight"?Di({x:f+v-P,y:m+T,textAnchor:D,verticalAnchor:I},H):l==="insideBottomLeft"?Di({x:f+P,y:m+E-T,textAnchor:k,verticalAnchor:R},H):l==="insideBottomRight"?Di({x:f+v-P,y:m+E-T,textAnchor:D,verticalAnchor:R},H):cy(l)&&(rt(l.x)||Xf(l.x))&&(rt(l.y)||Xf(l.y))?Di({x:f+$o(l.x,v),y:m+$o(l.y,E),textAnchor:"end",verticalAnchor:"end"},H):Di({x:f+v/2,y:m+E/2,textAnchor:"middle",verticalAnchor:"middle"},H)},Kat=function(t){return"cx"in t&&rt(t.cx)};function Yi(e){var t=e.offset,n=t===void 0?5:t,i=Mat(e,xat),a=Di({offset:n},i),l=a.viewBox,d=a.position,f=a.value,m=a.children,v=a.content,E=a.className,S=E===void 0?"":E,T=a.textBreakAll;if(!l||En(f)&&En(m)&&!N.isValidElement(v)&&!Xt(v))return null;if(N.isValidElement(v))return N.cloneElement(v,a);var R;if(Xt(v)){if(R=N.createElement(v,a),N.isValidElement(R))return R}else R=Bat(a);var I=Kat(l),O=Vt(a,!0);if(I&&(d==="insideStart"||d==="insideEnd"||d==="end"))return Wat(a,R,O);var P=I?Gat(a):Hat(a);return se.createElement(wp,tS({className:un("recharts-label",S)},O,P,{breakAll:T}),R)}Yi.displayName="Label";var hpe=function(t){var n=t.cx,i=t.cy,a=t.angle,l=t.startAngle,d=t.endAngle,f=t.r,m=t.radius,v=t.innerRadius,E=t.outerRadius,S=t.x,T=t.y,R=t.top,I=t.left,O=t.width,P=t.height,D=t.clockWise,k=t.labelViewBox;if(k)return k;if(rt(O)&&rt(P)){if(rt(S)&&rt(T))return{x:S,y:T,width:O,height:P};if(rt(R)&&rt(I))return{x:R,y:I,width:O,height:P}}return rt(S)&&rt(T)?{x:S,y:T,width:0,height:0}:rt(n)&&rt(i)?{cx:n,cy:i,startAngle:l||a||0,endAngle:d||a||0,innerRadius:v||0,outerRadius:E||m||f||0,clockWise:D}:t.viewBox?t.viewBox:{}},zat=function(t,n){return t?t===!0?se.createElement(Yi,{key:"label-implicit",viewBox:n}):Mi(t)?se.createElement(Yi,{key:"label-implicit",viewBox:n,value:t}):N.isValidElement(t)?t.type===Yi?N.cloneElement(t,{key:"label-implicit",viewBox:n}):se.createElement(Yi,{key:"label-implicit",content:t,viewBox:n}):Xt(t)?se.createElement(Yi,{key:"label-implicit",content:t,viewBox:n}):cy(t)?se.createElement(Yi,tS({viewBox:n},t,{key:"label-implicit"})):null:null},Yat=function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&i&&!t.label)return null;var a=t.children,l=hpe(t),d=Ba(a,Yi).map(function(m,v){return N.cloneElement(m,{viewBox:n||l,key:"label-".concat(v)})});if(!i)return d;var f=zat(t.label,n||l);return[f].concat(Pat(d))};Yi.parseViewBox=hpe;Yi.renderCallByParent=Yat;function qat(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var Xat=qat;const Jat=zn(Xat);function nS(e){"@babel/helpers - typeof";return nS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nS(e)}var Qat=["valueAccessor"],Zat=["data","dataKey","clockWise","id","textBreakAll"];function ect(e){return ict(e)||rct(e)||nct(e)||tct()}function tct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nct(e,t){if(e){if(typeof e=="string")return Nj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nj(e,t)}}function rct(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ict(e){if(Array.isArray(e))return Nj(e)}function Nj(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function DA(){return DA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},DA.apply(this,arguments)}function gte(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function vte(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gte(Object(n),!0).forEach(function(i){oct(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gte(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function oct(e,t,n){return t=sct(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sct(e){var t=act(e,"string");return nS(t)=="symbol"?t:t+""}function act(e,t){if(nS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(nS(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yte(e,t){if(e==null)return{};var n=cct(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function cct(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var lct=function(t){return Array.isArray(t.value)?Jat(t.value):t.value};function gh(e){var t=e.valueAccessor,n=t===void 0?lct:t,i=yte(e,Qat),a=i.data,l=i.dataKey,d=i.clockWise,f=i.id,m=i.textBreakAll,v=yte(i,Zat);return!a||!a.length?null:se.createElement(er,{className:"recharts-label-list"},a.map(function(E,S){var T=En(l)?n(E,S):To(E&&E.payload,l),R=En(f)?{}:{id:"".concat(f,"-").concat(S)};return se.createElement(Yi,DA({},Vt(E,!0),v,R,{parentViewBox:E.parentViewBox,value:T,textBreakAll:m,viewBox:Yi.parseViewBox(En(d)?E:vte(vte({},E),{},{clockWise:d})),key:"label-".concat(S),index:S}))}))}gh.displayName="LabelList";function uct(e,t){return e?e===!0?se.createElement(gh,{key:"labelList-implicit",data:t}):se.isValidElement(e)||Xt(e)?se.createElement(gh,{key:"labelList-implicit",data:t,content:e}):cy(e)?se.createElement(gh,DA({data:t},e,{key:"labelList-implicit"})):null:null}function dct(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var i=e.children,a=Ba(i,gh).map(function(d,f){return N.cloneElement(d,{data:t,key:"labelList-".concat(f)})});if(!n)return a;var l=uct(e.label,t);return[l].concat(ect(a))}gh.renderCallByParent=dct;function rS(e){"@babel/helpers - typeof";return rS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rS(e)}function Dj(){return Dj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Dj.apply(this,arguments)}function _te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Ete(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_te(Object(n),!0).forEach(function(i){hct(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_te(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function hct(e,t,n){return t=fct(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fct(e){var t=pct(e,"string");return rS(t)=="symbol"?t:t+""}function pct(e,t){if(rS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(rS(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mct=function(t,n){var i=Bo(n-t),a=Math.min(Math.abs(n-t),359.999);return i*a},WC=function(t){var n=t.cx,i=t.cy,a=t.radius,l=t.angle,d=t.sign,f=t.isExternal,m=t.cornerRadius,v=t.cornerIsExternal,E=m*(f?1:-1)+a,S=Math.asin(m/E)/NA,T=v?l:l+d*S,R=wr(n,i,E,T),I=wr(n,i,a,T),O=v?l-d*S:l,P=wr(n,i,E*Math.cos(S*NA),O);return{center:R,circleTangency:I,lineTangency:P,theta:S}},fpe=function(t){var n=t.cx,i=t.cy,a=t.innerRadius,l=t.outerRadius,d=t.startAngle,f=t.endAngle,m=mct(d,f),v=d+m,E=wr(n,i,l,d),S=wr(n,i,l,v),T="M ".concat(E.x,",").concat(E.y,`
    A `).concat(l,",").concat(l,`,0,
    `).concat(+(Math.abs(m)>180),",").concat(+(d>v),`,
    `).concat(S.x,",").concat(S.y,`
  `);if(a>0){var R=wr(n,i,a,d),I=wr(n,i,a,v);T+="L ".concat(I.x,",").concat(I.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(m)>180),",").concat(+(d<=v),`,
            `).concat(R.x,",").concat(R.y," Z")}else T+="L ".concat(n,",").concat(i," Z");return T},gct=function(t){var n=t.cx,i=t.cy,a=t.innerRadius,l=t.outerRadius,d=t.cornerRadius,f=t.forceCornerRadius,m=t.cornerIsExternal,v=t.startAngle,E=t.endAngle,S=Bo(E-v),T=WC({cx:n,cy:i,radius:l,angle:v,sign:S,cornerRadius:d,cornerIsExternal:m}),R=T.circleTangency,I=T.lineTangency,O=T.theta,P=WC({cx:n,cy:i,radius:l,angle:E,sign:-S,cornerRadius:d,cornerIsExternal:m}),D=P.circleTangency,k=P.lineTangency,M=P.theta,$=m?Math.abs(v-E):Math.abs(v-E)-O-M;if($<0)return f?"M ".concat(I.x,",").concat(I.y,`
        a`).concat(d,",").concat(d,",0,0,1,").concat(d*2,`,0
        a`).concat(d,",").concat(d,",0,0,1,").concat(-d*2,`,0
      `):fpe({cx:n,cy:i,innerRadius:a,outerRadius:l,startAngle:v,endAngle:E});var V="M ".concat(I.x,",").concat(I.y,`
    A`).concat(d,",").concat(d,",0,0,").concat(+(S<0),",").concat(R.x,",").concat(R.y,`
    A`).concat(l,",").concat(l,",0,").concat(+($>180),",").concat(+(S<0),",").concat(D.x,",").concat(D.y,`
    A`).concat(d,",").concat(d,",0,0,").concat(+(S<0),",").concat(k.x,",").concat(k.y,`
  `);if(a>0){var W=WC({cx:n,cy:i,radius:a,angle:v,sign:S,isExternal:!0,cornerRadius:d,cornerIsExternal:m}),H=W.circleTangency,J=W.lineTangency,ee=W.theta,le=WC({cx:n,cy:i,radius:a,angle:E,sign:-S,isExternal:!0,cornerRadius:d,cornerIsExternal:m}),he=le.circleTangency,de=le.lineTangency,ae=le.theta,ce=m?Math.abs(v-E):Math.abs(v-E)-ee-ae;if(ce<0&&d===0)return"".concat(V,"L").concat(n,",").concat(i,"Z");V+="L".concat(de.x,",").concat(de.y,`
      A`).concat(d,",").concat(d,",0,0,").concat(+(S<0),",").concat(he.x,",").concat(he.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(ce>180),",").concat(+(S>0),",").concat(H.x,",").concat(H.y,`
      A`).concat(d,",").concat(d,",0,0,").concat(+(S<0),",").concat(J.x,",").concat(J.y,"Z")}else V+="L".concat(n,",").concat(i,"Z");return V},vct={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},ppe=function(t){var n=Ete(Ete({},vct),t),i=n.cx,a=n.cy,l=n.innerRadius,d=n.outerRadius,f=n.cornerRadius,m=n.forceCornerRadius,v=n.cornerIsExternal,E=n.startAngle,S=n.endAngle,T=n.className;if(d<l||E===S)return null;var R=un("recharts-sector",T),I=d-l,O=$o(f,I,0,!0),P;return O>0&&Math.abs(E-S)<360?P=gct({cx:i,cy:a,innerRadius:l,outerRadius:d,cornerRadius:Math.min(O,I/2),forceCornerRadius:m,cornerIsExternal:v,startAngle:E,endAngle:S}):P=fpe({cx:i,cy:a,innerRadius:l,outerRadius:d,startAngle:E,endAngle:S}),se.createElement("path",Dj({},Vt(n,!0),{className:R,d:P,role:"img"}))};function iS(e){"@babel/helpers - typeof";return iS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iS(e)}function kj(){return kj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},kj.apply(this,arguments)}function bte(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Ste(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bte(Object(n),!0).forEach(function(i){yct(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bte(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function yct(e,t,n){return t=_ct(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _ct(e){var t=Ect(e,"string");return iS(t)=="symbol"?t:t+""}function Ect(e,t){if(iS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(iS(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wte={curveBasisClosed:mqe,curveBasisOpen:gqe,curveBasis:pqe,curveBumpX:eqe,curveBumpY:tqe,curveLinearClosed:vqe,curveLinear:AI,curveMonotoneX:yqe,curveMonotoneY:_qe,curveNatural:Eqe,curveStep:bqe,curveStepAfter:wqe,curveStepBefore:Sqe},GC=function(t){return t.x===+t.x&&t.y===+t.y},mE=function(t){return t.x},gE=function(t){return t.y},bct=function(t,n){if(Xt(t))return t;var i="curve".concat(CI(t));return(i==="curveMonotone"||i==="curveBump")&&n?wte["".concat(i).concat(n==="vertical"?"Y":"X")]:wte[i]||AI},Sct=function(t){var n=t.type,i=n===void 0?"linear":n,a=t.points,l=a===void 0?[]:a,d=t.baseLine,f=t.layout,m=t.connectNulls,v=m===void 0?!1:m,E=bct(i,f),S=v?l.filter(function(O){return GC(O)}):l,T;if(Array.isArray(d)){var R=v?d.filter(function(O){return GC(O)}):d,I=S.map(function(O,P){return Ste(Ste({},O),{},{base:R[P]})});return f==="vertical"?T=kC().y(gE).x1(mE).x0(function(O){return O.base.x}):T=kC().x(mE).y1(gE).y0(function(O){return O.base.y}),T.defined(GC).curve(E),T(I)}return f==="vertical"&&rt(d)?T=kC().y(gE).x1(mE).x0(d):rt(d)?T=kC().x(mE).y1(gE).y0(d):T=uhe().x(mE).y(gE),T.defined(GC).curve(E),T(S)},Lj=function(t){var n=t.className,i=t.points,a=t.path,l=t.pathRef;if((!i||!i.length)&&!a)return null;var d=i&&i.length?Sct(t):a;return se.createElement("path",kj({},Vt(t,!1),iA(t),{className:un("recharts-curve",n),d,ref:l}))},mpe={exports:{}},wct="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Tct=wct,Cct=Tct;function gpe(){}function vpe(){}vpe.resetWarningCache=gpe;var Rct=function(){function e(i,a,l,d,f,m){if(m!==Cct){var v=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw v.name="Invariant Violation",v}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:vpe,resetWarningCache:gpe};return n.PropTypes=n,n};mpe.exports=Rct();var Act=mpe.exports;const Hn=zn(Act);var Oct=Object.getOwnPropertyNames,Ict=Object.getOwnPropertySymbols,xct=Object.prototype.hasOwnProperty;function Tte(e,t){return function(i,a,l){return e(i,a,l)&&t(i,a,l)}}function HC(e){return function(n,i,a){if(!n||!i||typeof n!="object"||typeof i!="object")return e(n,i,a);var l=a.cache,d=l.get(n),f=l.get(i);if(d&&f)return d===i&&f===n;l.set(n,i),l.set(i,n);var m=e(n,i,a);return l.delete(n),l.delete(i),m}}function Cte(e){return Oct(e).concat(Ict(e))}var Pct=Object.hasOwn||function(e,t){return xct.call(e,t)};function jp(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var Nct="__v",Dct="__o",kct="_owner",Rte=Object.getOwnPropertyDescriptor,Ate=Object.keys;function Lct(e,t,n){var i=e.length;if(t.length!==i)return!1;for(;i-- >0;)if(!n.equals(e[i],t[i],i,i,e,t,n))return!1;return!0}function Mct(e,t){return jp(e.getTime(),t.getTime())}function jct(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function Uct(e,t){return e===t}function Ote(e,t,n){var i=e.size;if(i!==t.size)return!1;if(!i)return!0;for(var a=new Array(i),l=e.entries(),d,f,m=0;(d=l.next())&&!d.done;){for(var v=t.entries(),E=!1,S=0;(f=v.next())&&!f.done;){if(a[S]){S++;continue}var T=d.value,R=f.value;if(n.equals(T[0],R[0],m,S,e,t,n)&&n.equals(T[1],R[1],T[0],R[0],e,t,n)){E=a[S]=!0;break}S++}if(!E)return!1;m++}return!0}var Vct=jp;function Fct(e,t,n){var i=Ate(e),a=i.length;if(Ate(t).length!==a)return!1;for(;a-- >0;)if(!ype(e,t,n,i[a]))return!1;return!0}function vE(e,t,n){var i=Cte(e),a=i.length;if(Cte(t).length!==a)return!1;for(var l,d,f;a-- >0;)if(l=i[a],!ype(e,t,n,l)||(d=Rte(e,l),f=Rte(t,l),(d||f)&&(!d||!f||d.configurable!==f.configurable||d.enumerable!==f.enumerable||d.writable!==f.writable)))return!1;return!0}function Bct(e,t){return jp(e.valueOf(),t.valueOf())}function $ct(e,t){return e.source===t.source&&e.flags===t.flags}function Ite(e,t,n){var i=e.size;if(i!==t.size)return!1;if(!i)return!0;for(var a=new Array(i),l=e.values(),d,f;(d=l.next())&&!d.done;){for(var m=t.values(),v=!1,E=0;(f=m.next())&&!f.done;){if(!a[E]&&n.equals(d.value,f.value,d.value,f.value,e,t,n)){v=a[E]=!0;break}E++}if(!v)return!1}return!0}function Wct(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function Gct(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function ype(e,t,n,i){return(i===kct||i===Dct||i===Nct)&&(e.$$typeof||t.$$typeof)?!0:Pct(t,i)&&n.equals(e[i],t[i],i,i,e,t,n)}var Hct="[object Arguments]",Kct="[object Boolean]",zct="[object Date]",Yct="[object Error]",qct="[object Map]",Xct="[object Number]",Jct="[object Object]",Qct="[object RegExp]",Zct="[object Set]",elt="[object String]",tlt="[object URL]",nlt=Array.isArray,xte=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Pte=Object.assign,rlt=Object.prototype.toString.call.bind(Object.prototype.toString);function ilt(e){var t=e.areArraysEqual,n=e.areDatesEqual,i=e.areErrorsEqual,a=e.areFunctionsEqual,l=e.areMapsEqual,d=e.areNumbersEqual,f=e.areObjectsEqual,m=e.arePrimitiveWrappersEqual,v=e.areRegExpsEqual,E=e.areSetsEqual,S=e.areTypedArraysEqual,T=e.areUrlsEqual;return function(I,O,P){if(I===O)return!0;if(I==null||O==null)return!1;var D=typeof I;if(D!==typeof O)return!1;if(D!=="object")return D==="number"?d(I,O,P):D==="function"?a(I,O,P):!1;var k=I.constructor;if(k!==O.constructor)return!1;if(k===Object)return f(I,O,P);if(nlt(I))return t(I,O,P);if(xte!=null&&xte(I))return S(I,O,P);if(k===Date)return n(I,O,P);if(k===RegExp)return v(I,O,P);if(k===Map)return l(I,O,P);if(k===Set)return E(I,O,P);var M=rlt(I);return M===zct?n(I,O,P):M===Qct?v(I,O,P):M===qct?l(I,O,P):M===Zct?E(I,O,P):M===Jct?typeof I.then!="function"&&typeof O.then!="function"&&f(I,O,P):M===tlt?T(I,O,P):M===Yct?i(I,O,P):M===Hct?f(I,O,P):M===Kct||M===Xct||M===elt?m(I,O,P):!1}}function olt(e){var t=e.circular,n=e.createCustomConfig,i=e.strict,a={areArraysEqual:i?vE:Lct,areDatesEqual:Mct,areErrorsEqual:jct,areFunctionsEqual:Uct,areMapsEqual:i?Tte(Ote,vE):Ote,areNumbersEqual:Vct,areObjectsEqual:i?vE:Fct,arePrimitiveWrappersEqual:Bct,areRegExpsEqual:$ct,areSetsEqual:i?Tte(Ite,vE):Ite,areTypedArraysEqual:i?vE:Wct,areUrlsEqual:Gct};if(n&&(a=Pte({},a,n(a))),t){var l=HC(a.areArraysEqual),d=HC(a.areMapsEqual),f=HC(a.areObjectsEqual),m=HC(a.areSetsEqual);a=Pte({},a,{areArraysEqual:l,areMapsEqual:d,areObjectsEqual:f,areSetsEqual:m})}return a}function slt(e){return function(t,n,i,a,l,d,f){return e(t,n,f)}}function alt(e){var t=e.circular,n=e.comparator,i=e.createState,a=e.equals,l=e.strict;if(i)return function(m,v){var E=i(),S=E.cache,T=S===void 0?t?new WeakMap:void 0:S,R=E.meta;return n(m,v,{cache:T,equals:a,meta:R,strict:l})};if(t)return function(m,v){return n(m,v,{cache:new WeakMap,equals:a,meta:void 0,strict:l})};var d={cache:void 0,equals:a,meta:void 0,strict:l};return function(m,v){return n(m,v,d)}}var clt=jh();jh({strict:!0});jh({circular:!0});jh({circular:!0,strict:!0});jh({createInternalComparator:function(){return jp}});jh({strict:!0,createInternalComparator:function(){return jp}});jh({circular:!0,createInternalComparator:function(){return jp}});jh({circular:!0,createInternalComparator:function(){return jp},strict:!0});function jh(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,i=e.createInternalComparator,a=e.createState,l=e.strict,d=l===void 0?!1:l,f=olt(e),m=ilt(f),v=i?i(m):slt(m);return alt({circular:n,comparator:m,createState:a,equals:v,strict:d})}function llt(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Nte(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=function a(l){n<0&&(n=l),l-n>t?(e(l),n=-1):llt(a)};requestAnimationFrame(i)}function Mj(e){"@babel/helpers - typeof";return Mj=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mj(e)}function ult(e){return plt(e)||flt(e)||hlt(e)||dlt()}function dlt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hlt(e,t){if(e){if(typeof e=="string")return Dte(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Dte(e,t)}}function Dte(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function flt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function plt(e){if(Array.isArray(e))return e}function mlt(){var e={},t=function(){return null},n=!1,i=function a(l){if(!n){if(Array.isArray(l)){if(!l.length)return;var d=l,f=ult(d),m=f[0],v=f.slice(1);if(typeof m=="number"){Nte(a.bind(null,v),m);return}a(m),Nte(a.bind(null,v));return}Mj(l)==="object"&&(e=l,t(e)),typeof l=="function"&&l()}};return{stop:function(){n=!0},start:function(l){n=!1,i(l)},subscribe:function(l){return t=l,function(){t=function(){return null}}}}}function oS(e){"@babel/helpers - typeof";return oS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oS(e)}function kte(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Lte(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?kte(Object(n),!0).forEach(function(i){_pe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kte(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function _pe(e,t,n){return t=glt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function glt(e){var t=vlt(e,"string");return oS(t)==="symbol"?t:String(t)}function vlt(e,t){if(oS(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(oS(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ylt=function(t,n){return[Object.keys(t),Object.keys(n)].reduce(function(i,a){return i.filter(function(l){return a.includes(l)})})},_lt=function(t){return t},Elt=function(t){return t.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},eb=function(t,n){return Object.keys(n).reduce(function(i,a){return Lte(Lte({},i),{},_pe({},a,t(a,n[a])))},{})},Mte=function(t,n,i){return t.map(function(a){return"".concat(Elt(a)," ").concat(n,"ms ").concat(i)}).join(",")};function blt(e,t){return Tlt(e)||wlt(e,t)||Epe(e,t)||Slt()}function Slt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wlt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,a,l,d,f=[],m=!0,v=!1;try{if(l=(n=n.call(e)).next,t!==0)for(;!(m=(i=l.call(n)).done)&&(f.push(i.value),f.length!==t);m=!0);}catch(E){v=!0,a=E}finally{try{if(!m&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(v)throw a}}return f}}function Tlt(e){if(Array.isArray(e))return e}function Clt(e){return Olt(e)||Alt(e)||Epe(e)||Rlt()}function Rlt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Epe(e,t){if(e){if(typeof e=="string")return jj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jj(e,t)}}function Alt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Olt(e){if(Array.isArray(e))return jj(e)}function jj(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var kA=1e-4,bpe=function(t,n){return[0,3*t,3*n-6*t,3*t-3*n+1]},Spe=function(t,n){return t.map(function(i,a){return i*Math.pow(n,a)}).reduce(function(i,a){return i+a})},jte=function(t,n){return function(i){var a=bpe(t,n);return Spe(a,i)}},Ilt=function(t,n){return function(i){var a=bpe(t,n),l=[].concat(Clt(a.map(function(d,f){return d*f}).slice(1)),[0]);return Spe(l,i)}},Ute=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=n[0],l=n[1],d=n[2],f=n[3];if(n.length===1)switch(n[0]){case"linear":a=0,l=0,d=1,f=1;break;case"ease":a=.25,l=.1,d=.25,f=1;break;case"ease-in":a=.42,l=0,d=1,f=1;break;case"ease-out":a=.42,l=0,d=.58,f=1;break;case"ease-in-out":a=0,l=0,d=.58,f=1;break;default:{var m=n[0].split("(");if(m[0]==="cubic-bezier"&&m[1].split(")")[0].split(",").length===4){var v=m[1].split(")")[0].split(",").map(function(P){return parseFloat(P)}),E=blt(v,4);a=E[0],l=E[1],d=E[2],f=E[3]}}}var S=jte(a,d),T=jte(l,f),R=Ilt(a,d),I=function(D){return D>1?1:D<0?0:D},O=function(D){for(var k=D>1?1:D,M=k,$=0;$<8;++$){var V=S(M)-k,W=R(M);if(Math.abs(V-k)<kA||W<kA)return T(M);M=I(M-V/W)}return T(M)};return O.isStepper=!1,O},xlt=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.stiff,i=n===void 0?100:n,a=t.damping,l=a===void 0?8:a,d=t.dt,f=d===void 0?17:d,m=function(E,S,T){var R=-(E-S)*i,I=T*l,O=T+(R-I)*f/1e3,P=T*f/1e3+E;return Math.abs(P-S)<kA&&Math.abs(O)<kA?[S,0]:[P,O]};return m.isStepper=!0,m.dt=f,m},Plt=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=n[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Ute(a);case"spring":return xlt();default:if(a.split("(")[0]==="cubic-bezier")return Ute(a)}return typeof a=="function"?a:null};function sS(e){"@babel/helpers - typeof";return sS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sS(e)}function Vte(e){return klt(e)||Dlt(e)||wpe(e)||Nlt()}function Nlt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dlt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function klt(e){if(Array.isArray(e))return Vj(e)}function Fte(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function io(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Fte(Object(n),!0).forEach(function(i){Uj(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fte(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Uj(e,t,n){return t=Llt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Llt(e){var t=Mlt(e,"string");return sS(t)==="symbol"?t:String(t)}function Mlt(e,t){if(sS(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(sS(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jlt(e,t){return Flt(e)||Vlt(e,t)||wpe(e,t)||Ult()}function Ult(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wpe(e,t){if(e){if(typeof e=="string")return Vj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vj(e,t)}}function Vj(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Vlt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,a,l,d,f=[],m=!0,v=!1;try{if(l=(n=n.call(e)).next,t!==0)for(;!(m=(i=l.call(n)).done)&&(f.push(i.value),f.length!==t);m=!0);}catch(E){v=!0,a=E}finally{try{if(!m&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(v)throw a}}return f}}function Flt(e){if(Array.isArray(e))return e}var LA=function(t,n,i){return t+(n-t)*i},Fj=function(t){var n=t.from,i=t.to;return n!==i},Blt=function e(t,n,i){var a=eb(function(l,d){if(Fj(d)){var f=t(d.from,d.to,d.velocity),m=jlt(f,2),v=m[0],E=m[1];return io(io({},d),{},{from:v,velocity:E})}return d},n);return i<1?eb(function(l,d){return Fj(d)?io(io({},d),{},{velocity:LA(d.velocity,a[l].velocity,i),from:LA(d.from,a[l].from,i)}):d},n):e(t,a,i-1)};const $lt=function(e,t,n,i,a){var l=ylt(e,t),d=l.reduce(function(P,D){return io(io({},P),{},Uj({},D,[e[D],t[D]]))},{}),f=l.reduce(function(P,D){return io(io({},P),{},Uj({},D,{from:e[D],velocity:0,to:t[D]}))},{}),m=-1,v,E,S=function(){return null},T=function(){return eb(function(D,k){return k.from},f)},R=function(){return!Object.values(f).filter(Fj).length},I=function(D){v||(v=D);var k=D-v,M=k/n.dt;f=Blt(n,f,M),a(io(io(io({},e),t),T())),v=D,R()||(m=requestAnimationFrame(S))},O=function(D){E||(E=D);var k=(D-E)/i,M=eb(function(V,W){return LA.apply(void 0,Vte(W).concat([n(k)]))},d);if(a(io(io(io({},e),t),M)),k<1)m=requestAnimationFrame(S);else{var $=eb(function(V,W){return LA.apply(void 0,Vte(W).concat([n(1)]))},d);a(io(io(io({},e),t),$))}};return S=n.isStepper?I:O,function(){return requestAnimationFrame(S),function(){cancelAnimationFrame(m)}}};function Ov(e){"@babel/helpers - typeof";return Ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ov(e)}var Wlt=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Glt(e,t){if(e==null)return{};var n=Hlt(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Hlt(e,t){if(e==null)return{};var n={},i=Object.keys(e),a,l;for(l=0;l<i.length;l++)a=i[l],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function UL(e){return qlt(e)||Ylt(e)||zlt(e)||Klt()}function Klt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zlt(e,t){if(e){if(typeof e=="string")return Bj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bj(e,t)}}function Ylt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qlt(e){if(Array.isArray(e))return Bj(e)}function Bj(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Bte(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function gc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Bte(Object(n),!0).forEach(function(i){PE(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bte(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function PE(e,t,n){return t=Tpe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xlt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jlt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Tpe(i.key),i)}}function Qlt(e,t,n){return t&&Jlt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Tpe(e){var t=Zlt(e,"string");return Ov(t)==="symbol"?t:String(t)}function Zlt(e,t){if(Ov(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Ov(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eut(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$j(e,t)}function $j(e,t){return $j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},$j(e,t)}function tut(e){var t=nut();return function(){var i=MA(e),a;if(t){var l=MA(this).constructor;a=Reflect.construct(i,arguments,l)}else a=i.apply(this,arguments);return Wj(this,a)}}function Wj(e,t){if(t&&(Ov(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Gj(e)}function Gj(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nut(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function MA(e){return MA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},MA(e)}var Wu=function(e){eut(n,e);var t=tut(n);function n(i,a){var l;Xlt(this,n),l=t.call(this,i,a);var d=l.props,f=d.isActive,m=d.attributeName,v=d.from,E=d.to,S=d.steps,T=d.children,R=d.duration;if(l.handleStyleChange=l.handleStyleChange.bind(Gj(l)),l.changeStyle=l.changeStyle.bind(Gj(l)),!f||R<=0)return l.state={style:{}},typeof T=="function"&&(l.state={style:E}),Wj(l);if(S&&S.length)l.state={style:S[0].style};else if(v){if(typeof T=="function")return l.state={style:v},Wj(l);l.state={style:m?PE({},m,v):v}}else l.state={style:{}};return l}return Qlt(n,[{key:"componentDidMount",value:function(){var a=this.props,l=a.isActive,d=a.canBegin;this.mounted=!0,!(!l||!d)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var l=this.props,d=l.isActive,f=l.canBegin,m=l.attributeName,v=l.shouldReAnimate,E=l.to,S=l.from,T=this.state.style;if(f){if(!d){var R={style:m?PE({},m,E):E};this.state&&T&&(m&&T[m]!==E||!m&&T!==E)&&this.setState(R);return}if(!(clt(a.to,E)&&a.canBegin&&a.isActive)){var I=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var O=I||v?S:a.to;if(this.state&&T){var P={style:m?PE({},m,O):O};(m&&T[m]!==O||!m&&T!==O)&&this.setState(P)}this.runAnimation(gc(gc({},this.props),{},{from:O,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var l=this,d=a.from,f=a.to,m=a.duration,v=a.easing,E=a.begin,S=a.onAnimationEnd,T=a.onAnimationStart,R=$lt(d,f,Plt(v),m,this.changeStyle),I=function(){l.stopJSAnimation=R()};this.manager.start([T,E,I,m,S])}},{key:"runStepAnimation",value:function(a){var l=this,d=a.steps,f=a.begin,m=a.onAnimationStart,v=d[0],E=v.style,S=v.duration,T=S===void 0?0:S,R=function(O,P,D){if(D===0)return O;var k=P.duration,M=P.easing,$=M===void 0?"ease":M,V=P.style,W=P.properties,H=P.onAnimationEnd,J=D>0?d[D-1]:P,ee=W||Object.keys(V);if(typeof $=="function"||$==="spring")return[].concat(UL(O),[l.runJSAnimation.bind(l,{from:J.style,to:V,duration:k,easing:$}),k]);var le=Mte(ee,k,$),he=gc(gc(gc({},J.style),V),{},{transition:le});return[].concat(UL(O),[he,k,H]).filter(_lt)};return this.manager.start([m].concat(UL(d.reduce(R,[E,Math.max(T,f)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=mlt());var l=a.begin,d=a.duration,f=a.attributeName,m=a.to,v=a.easing,E=a.onAnimationStart,S=a.onAnimationEnd,T=a.steps,R=a.children,I=this.manager;if(this.unSubscribe=I.subscribe(this.handleStyleChange),typeof v=="function"||typeof R=="function"||v==="spring"){this.runJSAnimation(a);return}if(T.length>1){this.runStepAnimation(a);return}var O=f?PE({},f,m):m,P=Mte(Object.keys(O),d,v);I.start([E,l,gc(gc({},O),{},{transition:P}),d,S])}},{key:"render",value:function(){var a=this.props,l=a.children;a.begin;var d=a.duration;a.attributeName,a.easing;var f=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var m=Glt(a,Wlt),v=N.Children.count(l),E=this.state.style;if(typeof l=="function")return l(E);if(!f||v===0||d<=0)return l;var S=function(R){var I=R.props,O=I.style,P=O===void 0?{}:O,D=I.className,k=N.cloneElement(R,gc(gc({},m),{},{style:gc(gc({},P),E),className:D}));return k};return v===1?S(N.Children.only(l)):se.createElement("div",null,N.Children.map(l,function(T){return S(T)}))}}]),n}(N.PureComponent);Wu.displayName="Animate";Wu.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Wu.propTypes={from:Hn.oneOfType([Hn.object,Hn.string]),to:Hn.oneOfType([Hn.object,Hn.string]),attributeName:Hn.string,duration:Hn.number,begin:Hn.number,easing:Hn.oneOfType([Hn.string,Hn.func]),steps:Hn.arrayOf(Hn.shape({duration:Hn.number.isRequired,style:Hn.object.isRequired,easing:Hn.oneOfType([Hn.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Hn.func]),properties:Hn.arrayOf("string"),onAnimationEnd:Hn.func})),children:Hn.oneOfType([Hn.node,Hn.func]),isActive:Hn.bool,canBegin:Hn.bool,onAnimationEnd:Hn.func,shouldReAnimate:Hn.bool,onAnimationStart:Hn.func,onAnimationReStart:Hn.func};function aS(e){"@babel/helpers - typeof";return aS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},aS(e)}function jA(){return jA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},jA.apply(this,arguments)}function rut(e,t){return aut(e)||sut(e,t)||out(e,t)||iut()}function iut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function out(e,t){if(e){if(typeof e=="string")return $te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $te(e,t)}}function $te(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function sut(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,a,l,d,f=[],m=!0,v=!1;try{if(l=(n=n.call(e)).next,t!==0)for(;!(m=(i=l.call(n)).done)&&(f.push(i.value),f.length!==t);m=!0);}catch(E){v=!0,a=E}finally{try{if(!m&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(v)throw a}}return f}}function aut(e){if(Array.isArray(e))return e}function Wte(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Gte(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Wte(Object(n),!0).forEach(function(i){cut(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wte(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function cut(e,t,n){return t=lut(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lut(e){var t=uut(e,"string");return aS(t)=="symbol"?t:t+""}function uut(e,t){if(aS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(aS(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hte=function(t,n,i,a,l){var d=Math.min(Math.abs(i)/2,Math.abs(a)/2),f=a>=0?1:-1,m=i>=0?1:-1,v=a>=0&&i>=0||a<0&&i<0?1:0,E;if(d>0&&l instanceof Array){for(var S=[0,0,0,0],T=0,R=4;T<R;T++)S[T]=l[T]>d?d:l[T];E="M".concat(t,",").concat(n+f*S[0]),S[0]>0&&(E+="A ".concat(S[0],",").concat(S[0],",0,0,").concat(v,",").concat(t+m*S[0],",").concat(n)),E+="L ".concat(t+i-m*S[1],",").concat(n),S[1]>0&&(E+="A ".concat(S[1],",").concat(S[1],",0,0,").concat(v,`,
        `).concat(t+i,",").concat(n+f*S[1])),E+="L ".concat(t+i,",").concat(n+a-f*S[2]),S[2]>0&&(E+="A ".concat(S[2],",").concat(S[2],",0,0,").concat(v,`,
        `).concat(t+i-m*S[2],",").concat(n+a)),E+="L ".concat(t+m*S[3],",").concat(n+a),S[3]>0&&(E+="A ".concat(S[3],",").concat(S[3],",0,0,").concat(v,`,
        `).concat(t,",").concat(n+a-f*S[3])),E+="Z"}else if(d>0&&l===+l&&l>0){var I=Math.min(d,l);E="M ".concat(t,",").concat(n+f*I,`
            A `).concat(I,",").concat(I,",0,0,").concat(v,",").concat(t+m*I,",").concat(n,`
            L `).concat(t+i-m*I,",").concat(n,`
            A `).concat(I,",").concat(I,",0,0,").concat(v,",").concat(t+i,",").concat(n+f*I,`
            L `).concat(t+i,",").concat(n+a-f*I,`
            A `).concat(I,",").concat(I,",0,0,").concat(v,",").concat(t+i-m*I,",").concat(n+a,`
            L `).concat(t+m*I,",").concat(n+a,`
            A `).concat(I,",").concat(I,",0,0,").concat(v,",").concat(t,",").concat(n+a-f*I," Z")}else E="M ".concat(t,",").concat(n," h ").concat(i," v ").concat(a," h ").concat(-i," Z");return E},dut=function(t,n){if(!t||!n)return!1;var i=t.x,a=t.y,l=n.x,d=n.y,f=n.width,m=n.height;if(Math.abs(f)>0&&Math.abs(m)>0){var v=Math.min(l,l+f),E=Math.max(l,l+f),S=Math.min(d,d+m),T=Math.max(d,d+m);return i>=v&&i<=E&&a>=S&&a<=T}return!1},hut={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},jB=function(t){var n=Gte(Gte({},hut),t),i=N.useRef(),a=N.useState(-1),l=rut(a,2),d=l[0],f=l[1];N.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var $=i.current.getTotalLength();$&&f($)}catch{}},[]);var m=n.x,v=n.y,E=n.width,S=n.height,T=n.radius,R=n.className,I=n.animationEasing,O=n.animationDuration,P=n.animationBegin,D=n.isAnimationActive,k=n.isUpdateAnimationActive;if(m!==+m||v!==+v||E!==+E||S!==+S||E===0||S===0)return null;var M=un("recharts-rectangle",R);return k?se.createElement(Wu,{canBegin:d>0,from:{width:E,height:S,x:m,y:v},to:{width:E,height:S,x:m,y:v},duration:O,animationEasing:I,isActive:k},function($){var V=$.width,W=$.height,H=$.x,J=$.y;return se.createElement(Wu,{canBegin:d>0,from:"0px ".concat(d===-1?1:d,"px"),to:"".concat(d,"px 0px"),attributeName:"strokeDasharray",begin:P,duration:O,isActive:D,easing:I},se.createElement("path",jA({},Vt(n,!0),{className:M,d:Hte(H,J,V,W,T),ref:i})))}):se.createElement("path",jA({},Vt(n,!0),{className:M,d:Hte(m,v,E,S,T)}))},fut=["points","className","baseLinePoints","connectNulls"];function Dg(){return Dg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Dg.apply(this,arguments)}function put(e,t){if(e==null)return{};var n=mut(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function mut(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function Kte(e){return _ut(e)||yut(e)||vut(e)||gut()}function gut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vut(e,t){if(e){if(typeof e=="string")return Hj(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Hj(e,t)}}function yut(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _ut(e){if(Array.isArray(e))return Hj(e)}function Hj(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var zte=function(t){return t&&t.x===+t.x&&t.y===+t.y},Eut=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[[]];return t.forEach(function(i){zte(i)?n[n.length-1].push(i):n[n.length-1].length>0&&n.push([])}),zte(t[0])&&n[n.length-1].push(t[0]),n[n.length-1].length<=0&&(n=n.slice(0,-1)),n},tb=function(t,n){var i=Eut(t);n&&(i=[i.reduce(function(l,d){return[].concat(Kte(l),Kte(d))},[])]);var a=i.map(function(l){return l.reduce(function(d,f,m){return"".concat(d).concat(m===0?"M":"L").concat(f.x,",").concat(f.y)},"")}).join("");return i.length===1?"".concat(a,"Z"):a},but=function(t,n,i){var a=tb(t,i);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(tb(n.reverse(),i).slice(1))},Sut=function(t){var n=t.points,i=t.className,a=t.baseLinePoints,l=t.connectNulls,d=put(t,fut);if(!n||!n.length)return null;var f=un("recharts-polygon",i);if(a&&a.length){var m=d.stroke&&d.stroke!=="none",v=but(n,a,l);return se.createElement("g",{className:f},se.createElement("path",Dg({},Vt(d,!0),{fill:v.slice(-1)==="Z"?d.fill:"none",stroke:"none",d:v})),m?se.createElement("path",Dg({},Vt(d,!0),{fill:"none",d:tb(n,l)})):null,m?se.createElement("path",Dg({},Vt(d,!0),{fill:"none",d:tb(a,l)})):null)}var E=tb(n,l);return se.createElement("path",Dg({},Vt(d,!0),{fill:E.slice(-1)==="Z"?d.fill:"none",className:f,d:E}))};function Kj(){return Kj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Kj.apply(this,arguments)}var UB=function(t){var n=t.cx,i=t.cy,a=t.r,l=t.className,d=un("recharts-dot",l);return n===+n&&i===+i&&a===+a?se.createElement("circle",Kj({},Vt(t,!1),iA(t),{className:d,cx:n,cy:i,r:a})):null};function cS(e){"@babel/helpers - typeof";return cS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cS(e)}var wut=["x","y","top","left","width","height","className"];function zj(){return zj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},zj.apply(this,arguments)}function Yte(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Tut(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Yte(Object(n),!0).forEach(function(i){Cut(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yte(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Cut(e,t,n){return t=Rut(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rut(e){var t=Aut(e,"string");return cS(t)=="symbol"?t:t+""}function Aut(e,t){if(cS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(cS(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Out(e,t){if(e==null)return{};var n=Iut(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Iut(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}var xut=function(t,n,i,a,l,d){return"M".concat(t,",").concat(l,"v").concat(a,"M").concat(d,",").concat(n,"h").concat(i)},Put=function(t){var n=t.x,i=n===void 0?0:n,a=t.y,l=a===void 0?0:a,d=t.top,f=d===void 0?0:d,m=t.left,v=m===void 0?0:m,E=t.width,S=E===void 0?0:E,T=t.height,R=T===void 0?0:T,I=t.className,O=Out(t,wut),P=Tut({x:i,y:l,top:f,left:v,width:S,height:R},O);return!rt(i)||!rt(l)||!rt(S)||!rt(R)||!rt(f)||!rt(v)?null:se.createElement("path",zj({},Vt(P,!0),{className:un("recharts-cross",I),d:xut(i,l,S,R,f,v)}))},Nut=VI,Dut=jfe,kut=kh;function Lut(e,t){return e&&e.length?Nut(e,kut(t),Dut):void 0}var Mut=Lut;const jut=zn(Mut);var Uut=VI,Vut=kh,Fut=Ufe;function But(e,t){return e&&e.length?Uut(e,Vut(t),Fut):void 0}var $ut=But;const Wut=zn($ut);var Gut=["cx","cy","angle","ticks","axisLine"],Hut=["ticks","tick","angle","tickFormatter","stroke"];function Iv(e){"@babel/helpers - typeof";return Iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iv(e)}function nb(){return nb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},nb.apply(this,arguments)}function qte(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Nf(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qte(Object(n),!0).forEach(function(i){KI(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qte(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Xte(e,t){if(e==null)return{};var n=Kut(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Kut(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function zut(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jte(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Rpe(i.key),i)}}function Yut(e,t,n){return t&&Jte(e.prototype,t),n&&Jte(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function qut(e,t,n){return t=UA(t),Xut(e,Cpe()?Reflect.construct(t,n||[],UA(e).constructor):t.apply(e,n))}function Xut(e,t){if(t&&(Iv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jut(e)}function Jut(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Cpe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Cpe=function(){return!!e})()}function UA(e){return UA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},UA(e)}function Qut(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yj(e,t)}function Yj(e,t){return Yj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},Yj(e,t)}function KI(e,t,n){return t=Rpe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rpe(e){var t=Zut(e,"string");return Iv(t)=="symbol"?t:t+""}function Zut(e,t){if(Iv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Iv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var zI=function(e){function t(){return zut(this,t),qut(this,t,arguments)}return Qut(t,e),Yut(t,[{key:"getTickValueCoord",value:function(i){var a=i.coordinate,l=this.props,d=l.angle,f=l.cx,m=l.cy;return wr(f,m,a,d)}},{key:"getTickTextAnchor",value:function(){var i=this.props.orientation,a;switch(i){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var i=this.props,a=i.cx,l=i.cy,d=i.angle,f=i.ticks,m=jut(f,function(E){return E.coordinate||0}),v=Wut(f,function(E){return E.coordinate||0});return{cx:a,cy:l,startAngle:d,endAngle:d,innerRadius:v.coordinate||0,outerRadius:m.coordinate||0}}},{key:"renderAxisLine",value:function(){var i=this.props,a=i.cx,l=i.cy,d=i.angle,f=i.ticks,m=i.axisLine,v=Xte(i,Gut),E=f.reduce(function(I,O){return[Math.min(I[0],O.coordinate),Math.max(I[1],O.coordinate)]},[1/0,-1/0]),S=wr(a,l,E[0],d),T=wr(a,l,E[1],d),R=Nf(Nf(Nf({},Vt(v,!1)),{},{fill:"none"},Vt(m,!1)),{},{x1:S.x,y1:S.y,x2:T.x,y2:T.y});return se.createElement("line",nb({className:"recharts-polar-radius-axis-line"},R))}},{key:"renderTicks",value:function(){var i=this,a=this.props,l=a.ticks,d=a.tick,f=a.angle,m=a.tickFormatter,v=a.stroke,E=Xte(a,Hut),S=this.getTickTextAnchor(),T=Vt(E,!1),R=Vt(d,!1),I=l.map(function(O,P){var D=i.getTickValueCoord(O),k=Nf(Nf(Nf(Nf({textAnchor:S,transform:"rotate(".concat(90-f,", ").concat(D.x,", ").concat(D.y,")")},T),{},{stroke:"none",fill:v},R),{},{index:P},D),{},{payload:O});return se.createElement(er,nb({className:un("recharts-polar-radius-axis-tick",dpe(d)),key:"tick-".concat(O.coordinate)},Sp(i.props,O,P)),t.renderTickItem(d,k,m?m(O.value,P):O.value))});return se.createElement(er,{className:"recharts-polar-radius-axis-ticks"},I)}},{key:"render",value:function(){var i=this.props,a=i.ticks,l=i.axisLine,d=i.tick;return!a||!a.length?null:se.createElement(er,{className:un("recharts-polar-radius-axis",this.props.className)},l&&this.renderAxisLine(),d&&this.renderTicks(),Yi.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(i,a,l){var d;return se.isValidElement(i)?d=se.cloneElement(i,a):Xt(i)?d=i(a):d=se.createElement(wp,nb({},a,{className:"recharts-polar-radius-axis-tick-value"}),l),d}}])}(N.PureComponent);KI(zI,"displayName","PolarRadiusAxis");KI(zI,"axisType","radiusAxis");KI(zI,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function xv(e){"@babel/helpers - typeof";return xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xv(e)}function Hf(){return Hf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Hf.apply(this,arguments)}function Qte(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Df(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Qte(Object(n),!0).forEach(function(i){YI(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qte(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function edt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zte(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Ope(i.key),i)}}function tdt(e,t,n){return t&&Zte(e.prototype,t),n&&Zte(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ndt(e,t,n){return t=VA(t),rdt(e,Ape()?Reflect.construct(t,n||[],VA(e).constructor):t.apply(e,n))}function rdt(e,t){if(t&&(xv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return idt(e)}function idt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ape(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ape=function(){return!!e})()}function VA(e){return VA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},VA(e)}function odt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qj(e,t)}function qj(e,t){return qj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},qj(e,t)}function YI(e,t,n){return t=Ope(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ope(e){var t=sdt(e,"string");return xv(t)=="symbol"?t:t+""}function sdt(e,t){if(xv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(xv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var adt=Math.PI/180,cdt=1e-5,qI=function(e){function t(){return edt(this,t),ndt(this,t,arguments)}return odt(t,e),tdt(t,[{key:"getTickLineCoord",value:function(i){var a=this.props,l=a.cx,d=a.cy,f=a.radius,m=a.orientation,v=a.tickSize,E=v||8,S=wr(l,d,f,i.coordinate),T=wr(l,d,f+(m==="inner"?-1:1)*E,i.coordinate);return{x1:S.x,y1:S.y,x2:T.x,y2:T.y}}},{key:"getTickTextAnchor",value:function(i){var a=this.props.orientation,l=Math.cos(-i.coordinate*adt),d;return l>cdt?d=a==="outer"?"start":"end":l<-1e-5?d=a==="outer"?"end":"start":d="middle",d}},{key:"renderAxisLine",value:function(){var i=this.props,a=i.cx,l=i.cy,d=i.radius,f=i.axisLine,m=i.axisLineType,v=Df(Df({},Vt(this.props,!1)),{},{fill:"none"},Vt(f,!1));if(m==="circle")return se.createElement(UB,Hf({className:"recharts-polar-angle-axis-line"},v,{cx:a,cy:l,r:d}));var E=this.props.ticks,S=E.map(function(T){return wr(a,l,d,T.coordinate)});return se.createElement(Sut,Hf({className:"recharts-polar-angle-axis-line"},v,{points:S}))}},{key:"renderTicks",value:function(){var i=this,a=this.props,l=a.ticks,d=a.tick,f=a.tickLine,m=a.tickFormatter,v=a.stroke,E=Vt(this.props,!1),S=Vt(d,!1),T=Df(Df({},E),{},{fill:"none"},Vt(f,!1)),R=l.map(function(I,O){var P=i.getTickLineCoord(I),D=i.getTickTextAnchor(I),k=Df(Df(Df({textAnchor:D},E),{},{stroke:"none",fill:v},S),{},{index:O,payload:I,x:P.x2,y:P.y2});return se.createElement(er,Hf({className:un("recharts-polar-angle-axis-tick",dpe(d)),key:"tick-".concat(I.coordinate)},Sp(i.props,I,O)),f&&se.createElement("line",Hf({className:"recharts-polar-angle-axis-tick-line"},T,P)),d&&t.renderTickItem(d,k,m?m(I.value,O):I.value))});return se.createElement(er,{className:"recharts-polar-angle-axis-ticks"},R)}},{key:"render",value:function(){var i=this.props,a=i.ticks,l=i.radius,d=i.axisLine;return l<=0||!a||!a.length?null:se.createElement(er,{className:un("recharts-polar-angle-axis",this.props.className)},d&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(i,a,l){var d;return se.isValidElement(i)?d=se.cloneElement(i,a):Xt(i)?d=i(a):d=se.createElement(wp,Hf({},a,{className:"recharts-polar-angle-axis-tick-value"}),l),d}}])}(N.PureComponent);YI(qI,"displayName","PolarAngleAxis");YI(qI,"axisType","angleAxis");YI(qI,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var ldt=khe,udt=ldt(Object.getPrototypeOf,Object),ddt=udt,hdt=zu,fdt=ddt,pdt=Yu,mdt="[object Object]",gdt=Function.prototype,vdt=Object.prototype,Ipe=gdt.toString,ydt=vdt.hasOwnProperty,_dt=Ipe.call(Object);function Edt(e){if(!pdt(e)||hdt(e)!=mdt)return!1;var t=fdt(e);if(t===null)return!0;var n=ydt.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Ipe.call(n)==_dt}var bdt=Edt;const Sdt=zn(bdt);var wdt=zu,Tdt=Yu,Cdt="[object Boolean]";function Rdt(e){return e===!0||e===!1||Tdt(e)&&wdt(e)==Cdt}var Adt=Rdt;const Odt=zn(Adt);function lS(e){"@babel/helpers - typeof";return lS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lS(e)}function FA(){return FA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},FA.apply(this,arguments)}function Idt(e,t){return Ddt(e)||Ndt(e,t)||Pdt(e,t)||xdt()}function xdt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pdt(e,t){if(e){if(typeof e=="string")return ene(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ene(e,t)}}function ene(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Ndt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,a,l,d,f=[],m=!0,v=!1;try{if(l=(n=n.call(e)).next,t!==0)for(;!(m=(i=l.call(n)).done)&&(f.push(i.value),f.length!==t);m=!0);}catch(E){v=!0,a=E}finally{try{if(!m&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(v)throw a}}return f}}function Ddt(e){if(Array.isArray(e))return e}function tne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function nne(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?tne(Object(n),!0).forEach(function(i){kdt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function kdt(e,t,n){return t=Ldt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ldt(e){var t=Mdt(e,"string");return lS(t)=="symbol"?t:t+""}function Mdt(e,t){if(lS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(lS(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rne=function(t,n,i,a,l){var d=i-a,f;return f="M ".concat(t,",").concat(n),f+="L ".concat(t+i,",").concat(n),f+="L ".concat(t+i-d/2,",").concat(n+l),f+="L ".concat(t+i-d/2-a,",").concat(n+l),f+="L ".concat(t,",").concat(n," Z"),f},jdt={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Udt=function(t){var n=nne(nne({},jdt),t),i=N.useRef(),a=N.useState(-1),l=Idt(a,2),d=l[0],f=l[1];N.useEffect(function(){if(i.current&&i.current.getTotalLength)try{var M=i.current.getTotalLength();M&&f(M)}catch{}},[]);var m=n.x,v=n.y,E=n.upperWidth,S=n.lowerWidth,T=n.height,R=n.className,I=n.animationEasing,O=n.animationDuration,P=n.animationBegin,D=n.isUpdateAnimationActive;if(m!==+m||v!==+v||E!==+E||S!==+S||T!==+T||E===0&&S===0||T===0)return null;var k=un("recharts-trapezoid",R);return D?se.createElement(Wu,{canBegin:d>0,from:{upperWidth:0,lowerWidth:0,height:T,x:m,y:v},to:{upperWidth:E,lowerWidth:S,height:T,x:m,y:v},duration:O,animationEasing:I,isActive:D},function(M){var $=M.upperWidth,V=M.lowerWidth,W=M.height,H=M.x,J=M.y;return se.createElement(Wu,{canBegin:d>0,from:"0px ".concat(d===-1?1:d,"px"),to:"".concat(d,"px 0px"),attributeName:"strokeDasharray",begin:P,duration:O,easing:I},se.createElement("path",FA({},Vt(n,!0),{className:k,d:rne(H,J,$,V,W),ref:i})))}):se.createElement("g",null,se.createElement("path",FA({},Vt(n,!0),{className:k,d:rne(m,v,E,S,T)})))},Vdt=["option","shapeType","propTransformer","activeClassName","isActive"];function uS(e){"@babel/helpers - typeof";return uS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uS(e)}function Fdt(e,t){if(e==null)return{};var n=Bdt(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Bdt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function ine(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function BA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ine(Object(n),!0).forEach(function(i){$dt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ine(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function $dt(e,t,n){return t=Wdt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Wdt(e){var t=Gdt(e,"string");return uS(t)=="symbol"?t:t+""}function Gdt(e,t){if(uS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(uS(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hdt(e,t){return BA(BA({},t),e)}function Kdt(e,t){return e==="symbols"}function one(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return se.createElement(jB,n);case"trapezoid":return se.createElement(Udt,n);case"sector":return se.createElement(ppe,n);case"symbols":if(Kdt(t))return se.createElement(eB,n);break;default:return null}}function zdt(e){return N.isValidElement(e)?e.props:e}function xpe(e){var t=e.option,n=e.shapeType,i=e.propTransformer,a=i===void 0?Hdt:i,l=e.activeClassName,d=l===void 0?"recharts-active-shape":l,f=e.isActive,m=Fdt(e,Vdt),v;if(N.isValidElement(t))v=N.cloneElement(t,BA(BA({},m),zdt(t)));else if(Xt(t))v=t(m);else if(Sdt(t)&&!Odt(t)){var E=a(t,m);v=se.createElement(one,{shapeType:n,elementProps:E})}else{var S=m;v=se.createElement(one,{shapeType:n,elementProps:S})}return f?se.createElement(er,{className:d},v):v}function XI(e,t){return t!=null&&"trapezoids"in e.props}function JI(e,t){return t!=null&&"sectors"in e.props}function dS(e,t){return t!=null&&"points"in e.props}function Ydt(e,t){var n,i,a=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,l=e.y===(t==null||(i=t.labelViewBox)===null||i===void 0?void 0:i.y)||e.y===t.y;return a&&l}function qdt(e,t){var n=e.endAngle===t.endAngle,i=e.startAngle===t.startAngle;return n&&i}function Xdt(e,t){var n=e.x===t.x,i=e.y===t.y,a=e.z===t.z;return n&&i&&a}function Jdt(e,t){var n;return XI(e,t)?n=Ydt:JI(e,t)?n=qdt:dS(e,t)&&(n=Xdt),n}function Qdt(e,t){var n;return XI(e,t)?n="trapezoids":JI(e,t)?n="sectors":dS(e,t)&&(n="points"),n}function Zdt(e,t){if(XI(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(JI(e,t)){var i;return(i=t.tooltipPayload)===null||i===void 0||(i=i[0])===null||i===void 0||(i=i.payload)===null||i===void 0?void 0:i.payload}return dS(e,t)?t.payload:{}}function eht(e){var t=e.activeTooltipItem,n=e.graphicalItem,i=e.itemData,a=Qdt(n,t),l=Zdt(n,t),d=i.filter(function(m,v){var E=$I(l,m),S=n.props[a].filter(function(I){var O=Jdt(n,t);return O(I,t)}),T=n.props[a].indexOf(S[S.length-1]),R=v===T;return E&&R}),f=i.indexOf(d[d.length-1]);return f}var pR;function Pv(e){"@babel/helpers - typeof";return Pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pv(e)}function kg(){return kg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},kg.apply(this,arguments)}function sne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Er(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sne(Object(n),!0).forEach(function(i){La(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function tht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ane(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Npe(i.key),i)}}function nht(e,t,n){return t&&ane(e.prototype,t),n&&ane(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function rht(e,t,n){return t=$A(t),iht(e,Ppe()?Reflect.construct(t,n||[],$A(e).constructor):t.apply(e,n))}function iht(e,t){if(t&&(Pv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oht(e)}function oht(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ppe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ppe=function(){return!!e})()}function $A(e){return $A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},$A(e)}function sht(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xj(e,t)}function Xj(e,t){return Xj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},Xj(e,t)}function La(e,t,n){return t=Npe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Npe(e){var t=aht(e,"string");return Pv(t)=="symbol"?t:t+""}function aht(e,t){if(Pv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Pv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Xu=function(e){function t(n){var i;return tht(this,t),i=rht(this,t,[n]),La(i,"pieRef",null),La(i,"sectorRefs",[]),La(i,"id",GS("recharts-pie-")),La(i,"handleAnimationEnd",function(){var a=i.props.onAnimationEnd;i.setState({isAnimationFinished:!0}),Xt(a)&&a()}),La(i,"handleAnimationStart",function(){var a=i.props.onAnimationStart;i.setState({isAnimationFinished:!1}),Xt(a)&&a()}),i.state={isAnimationFinished:!n.isAnimationActive,prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,sectorToFocus:0},i}return sht(t,e),nht(t,[{key:"isActiveIndex",value:function(i){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(i)!==-1:i===a}},{key:"hasActiveIndex",value:function(){var i=this.props.activeIndex;return Array.isArray(i)?i.length!==0:i||i===0}},{key:"renderLabels",value:function(i){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var l=this.props,d=l.label,f=l.labelLine,m=l.dataKey,v=l.valueKey,E=Vt(this.props,!1),S=Vt(d,!1),T=Vt(f,!1),R=d&&d.offsetRadius||20,I=i.map(function(O,P){var D=(O.startAngle+O.endAngle)/2,k=wr(O.cx,O.cy,O.outerRadius+R,D),M=Er(Er(Er(Er({},E),O),{},{stroke:"none"},S),{},{index:P,textAnchor:t.getTextAnchor(k.x,O.cx)},k),$=Er(Er(Er(Er({},E),O),{},{fill:"none",stroke:O.fill},T),{},{index:P,points:[wr(O.cx,O.cy,O.outerRadius,D),k]}),V=m;return En(m)&&En(v)?V="value":En(m)&&(V=v),se.createElement(er,{key:"label-".concat(O.startAngle,"-").concat(O.endAngle,"-").concat(O.midAngle,"-").concat(P)},f&&t.renderLabelLineItem(f,$,"line"),t.renderLabelItem(d,M,To(O,V)))});return se.createElement(er,{className:"recharts-pie-labels"},I)}},{key:"renderSectorsStatically",value:function(i){var a=this,l=this.props,d=l.activeShape,f=l.blendStroke,m=l.inactiveShape;return i.map(function(v,E){if((v==null?void 0:v.startAngle)===0&&(v==null?void 0:v.endAngle)===0&&i.length!==1)return null;var S=a.isActiveIndex(E),T=m&&a.hasActiveIndex()?m:null,R=S?d:T,I=Er(Er({},v),{},{stroke:f?v.fill:v.stroke,tabIndex:-1});return se.createElement(er,kg({ref:function(P){P&&!a.sectorRefs.includes(P)&&a.sectorRefs.push(P)},tabIndex:-1,className:"recharts-pie-sector"},Sp(a.props,v,E),{key:"sector-".concat(v==null?void 0:v.startAngle,"-").concat(v==null?void 0:v.endAngle,"-").concat(v.midAngle,"-").concat(E)}),se.createElement(xpe,kg({option:R,isActive:S,shapeType:"sector"},I)))})}},{key:"renderSectorsWithAnimation",value:function(){var i=this,a=this.props,l=a.sectors,d=a.isAnimationActive,f=a.animationBegin,m=a.animationDuration,v=a.animationEasing,E=a.animationId,S=this.state,T=S.prevSectors,R=S.prevIsAnimationActive;return se.createElement(Wu,{begin:f,duration:m,isActive:d,easing:v,from:{t:0},to:{t:1},key:"pie-".concat(E,"-").concat(R),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(I){var O=I.t,P=[],D=l&&l[0],k=D.startAngle;return l.forEach(function(M,$){var V=T&&T[$],W=$>0?qs(M,"paddingAngle",0):0;if(V){var H=Wd(V.endAngle-V.startAngle,M.endAngle-M.startAngle),J=Er(Er({},M),{},{startAngle:k+W,endAngle:k+H(O)+W});P.push(J),k=J.endAngle}else{var ee=M.endAngle,le=M.startAngle,he=Wd(0,ee-le),de=he(O),ae=Er(Er({},M),{},{startAngle:k+W,endAngle:k+de+W});P.push(ae),k=ae.endAngle}}),se.createElement(er,null,i.renderSectorsStatically(P))})}},{key:"attachKeyboardHandlers",value:function(i){var a=this;i.onkeydown=function(l){if(!l.altKey)switch(l.key){case"ArrowLeft":{var d=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[d].focus(),a.setState({sectorToFocus:d});break}case"ArrowRight":{var f=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[f].focus(),a.setState({sectorToFocus:f});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var i=this.props,a=i.sectors,l=i.isAnimationActive,d=this.state.prevSectors;return l&&a&&a.length&&(!d||!$I(d,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var i=this,a=this.props,l=a.hide,d=a.sectors,f=a.className,m=a.label,v=a.cx,E=a.cy,S=a.innerRadius,T=a.outerRadius,R=a.isAnimationActive,I=this.state.isAnimationFinished;if(l||!d||!d.length||!rt(v)||!rt(E)||!rt(S)||!rt(T))return null;var O=un("recharts-pie",f);return se.createElement(er,{tabIndex:this.props.rootTabIndex,className:O,ref:function(D){i.pieRef=D}},this.renderSectors(),m&&this.renderLabels(d),Yi.renderCallByParent(this.props,null,!1),(!R||I)&&gh.renderCallByParent(this.props,d,!1))}}],[{key:"getDerivedStateFromProps",value:function(i,a){return a.prevIsAnimationActive!==i.isAnimationActive?{prevIsAnimationActive:i.isAnimationActive,prevAnimationId:i.animationId,curSectors:i.sectors,prevSectors:[],isAnimationFinished:!0}:i.isAnimationActive&&i.animationId!==a.prevAnimationId?{prevAnimationId:i.animationId,curSectors:i.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:i.sectors!==a.curSectors?{curSectors:i.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(i,a){return i>a?"start":i<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(i,a,l){if(se.isValidElement(i))return se.cloneElement(i,a);if(Xt(i))return i(a);var d=un("recharts-pie-label-line",typeof i!="boolean"?i.className:"");return se.createElement(Lj,kg({},a,{key:l,type:"linear",className:d}))}},{key:"renderLabelItem",value:function(i,a,l){if(se.isValidElement(i))return se.cloneElement(i,a);var d=l;if(Xt(i)&&(d=i(a),se.isValidElement(d)))return d;var f=un("recharts-pie-label-text",typeof i!="boolean"&&!Xt(i)?i.className:"");return se.createElement(wp,kg({},a,{alignmentBaseline:"middle",className:f}),d)}}])}(N.PureComponent);pR=Xu;La(Xu,"displayName","Pie");La(Xu,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!my.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});La(Xu,"parseDeltaAngle",function(e,t){var n=Bo(t-e),i=Math.min(Math.abs(t-e),360);return n*i});La(Xu,"getRealPieData",function(e){var t=e.data,n=e.children,i=Vt(e,!1),a=Ba(n,NI);return t&&t.length?t.map(function(l,d){return Er(Er(Er({payload:l},i),l),a&&a[d]&&a[d].props)}):a&&a.length?a.map(function(l){return Er(Er({},i),l.props)}):[]});La(Xu,"parseCoordinateOfPie",function(e,t){var n=t.top,i=t.left,a=t.width,l=t.height,d=upe(a,l),f=i+$o(e.cx,a,a/2),m=n+$o(e.cy,l,l/2),v=$o(e.innerRadius,d,0),E=$o(e.outerRadius,d,d*.8),S=e.maxRadius||Math.sqrt(a*a+l*l)/2;return{cx:f,cy:m,innerRadius:v,outerRadius:E,maxRadius:S}});La(Xu,"getComposedData",function(e){var t=e.item,n=e.offset,i=t.type.defaultProps!==void 0?Er(Er({},t.type.defaultProps),t.props):t.props,a=pR.getRealPieData(i);if(!a||!a.length)return null;var l=i.cornerRadius,d=i.startAngle,f=i.endAngle,m=i.paddingAngle,v=i.dataKey,E=i.nameKey,S=i.valueKey,T=i.tooltipType,R=Math.abs(i.minAngle),I=pR.parseCoordinateOfPie(i,n),O=pR.parseDeltaAngle(d,f),P=Math.abs(O),D=v;En(v)&&En(S)?(Pu(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),D="value"):En(v)&&(Pu(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),D=S);var k=a.filter(function(J){return To(J,D,0)!==0}).length,M=(P>=360?k:k-1)*m,$=P-k*R-M,V=a.reduce(function(J,ee){var le=To(ee,D,0);return J+(rt(le)?le:0)},0),W;if(V>0){var H;W=a.map(function(J,ee){var le=To(J,D,0),he=To(J,E,ee),de=(rt(le)?le:0)/V,ae;ee?ae=H.endAngle+Bo(O)*m*(le!==0?1:0):ae=d;var ce=ae+Bo(O)*((le!==0?R:0)+de*$),ge=(ae+ce)/2,ye=(I.innerRadius+I.outerRadius)/2,te=[{name:he,value:le,payload:J,dataKey:D,type:T}],ne=wr(I.cx,I.cy,ye,ge);return H=Er(Er(Er({percent:de,cornerRadius:l,name:he,tooltipPayload:te,midAngle:ge,middleRadius:ye,tooltipPosition:ne},J),I),{},{value:To(J,D),startAngle:ae,endAngle:ce,payload:J,paddingAngle:Bo(O)*m}),H})}return Er(Er({},I),{},{sectors:W,data:a})});var cht=Math.ceil,lht=Math.max;function uht(e,t,n,i){for(var a=-1,l=lht(cht((t-e)/(n||1)),0),d=Array(l);l--;)d[i?l:++a]=e,e+=n;return d}var dht=uht,hht=Qhe,fht=1/0,pht=17976931348623157e292;function mht(e){if(!e)return e===0?e:0;if(e=hht(e),e===fht||e===-1/0){var t=e<0?-1:1;return t*pht}return e===e?e:0}var ght=mht,vht=dht,yht=PI,VL=ght;function _ht(e){return function(t,n,i){return i&&typeof i!="number"&&yht(t,n,i)&&(n=i=void 0),t=VL(t),n===void 0?(n=t,t=0):n=VL(n),i=i===void 0?t<n?1:-1:VL(i),vht(t,n,i,e)}}var Eht=_ht,bht=Eht,Sht=bht(),wht=Sht;const WA=zn(wht);function hS(e){"@babel/helpers - typeof";return hS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hS(e)}function cne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function lne(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?cne(Object(n),!0).forEach(function(i){Dpe(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Dpe(e,t,n){return t=Tht(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tht(e){var t=Cht(e,"string");return hS(t)=="symbol"?t:t+""}function Cht(e,t){if(hS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(hS(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rht=["Webkit","Moz","O","ms"],Aht=function(t,n){var i=t.replace(/(\w)/,function(l){return l.toUpperCase()}),a=Rht.reduce(function(l,d){return lne(lne({},l),{},Dpe({},d+i,n))},{});return a[t]=n,a};function Nv(e){"@babel/helpers - typeof";return Nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nv(e)}function GA(){return GA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},GA.apply(this,arguments)}function une(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function FL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?une(Object(n),!0).forEach(function(i){Fs(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):une(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Oht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Lpe(i.key),i)}}function Iht(e,t,n){return t&&dne(e.prototype,t),n&&dne(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function xht(e,t,n){return t=HA(t),Pht(e,kpe()?Reflect.construct(t,n||[],HA(e).constructor):t.apply(e,n))}function Pht(e,t){if(t&&(Nv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nht(e)}function Nht(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kpe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kpe=function(){return!!e})()}function HA(e){return HA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},HA(e)}function Dht(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jj(e,t)}function Jj(e,t){return Jj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},Jj(e,t)}function Fs(e,t,n){return t=Lpe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lpe(e){var t=kht(e,"string");return Nv(t)=="symbol"?t:t+""}function kht(e,t){if(Nv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Nv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Lht=function(t){var n=t.data,i=t.startIndex,a=t.endIndex,l=t.x,d=t.width,f=t.travellerWidth;if(!n||!n.length)return{};var m=n.length,v=QE().domain(WA(0,m)).range([l,l+d-f]),E=v.domain().map(function(S){return v(S)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:v(i),endX:v(a),scale:v,scaleValues:E}},hne=function(t){return t.changedTouches&&!!t.changedTouches.length},Dv=function(e){function t(n){var i;return Oht(this,t),i=xht(this,t,[n]),Fs(i,"handleDrag",function(a){i.leaveTimer&&(clearTimeout(i.leaveTimer),i.leaveTimer=null),i.state.isTravellerMoving?i.handleTravellerMove(a):i.state.isSlideMoving&&i.handleSlideDrag(a)}),Fs(i,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&i.handleDrag(a.changedTouches[0])}),Fs(i,"handleDragEnd",function(){i.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=i.props,l=a.endIndex,d=a.onDragEnd,f=a.startIndex;d==null||d({endIndex:l,startIndex:f})}),i.detachDragEndListener()}),Fs(i,"handleLeaveWrapper",function(){(i.state.isTravellerMoving||i.state.isSlideMoving)&&(i.leaveTimer=window.setTimeout(i.handleDragEnd,i.props.leaveTimeOut))}),Fs(i,"handleEnterSlideOrTraveller",function(){i.setState({isTextActive:!0})}),Fs(i,"handleLeaveSlideOrTraveller",function(){i.setState({isTextActive:!1})}),Fs(i,"handleSlideDragStart",function(a){var l=hne(a)?a.changedTouches[0]:a;i.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:l.pageX}),i.attachDragEndListener()}),i.travellerDragStartHandlers={startX:i.handleTravellerDragStart.bind(i,"startX"),endX:i.handleTravellerDragStart.bind(i,"endX")},i.state={},i}return Dht(t,e),Iht(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(i){var a=i.startX,l=i.endX,d=this.state.scaleValues,f=this.props,m=f.gap,v=f.data,E=v.length-1,S=Math.min(a,l),T=Math.max(a,l),R=t.getIndexInRange(d,S),I=t.getIndexInRange(d,T);return{startIndex:R-R%m,endIndex:I===E?E:I-I%m}}},{key:"getTextOfTick",value:function(i){var a=this.props,l=a.data,d=a.tickFormatter,f=a.dataKey,m=To(l[i],f,i);return Xt(d)?d(m,i):m}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(i){var a=this.state,l=a.slideMoveStartX,d=a.startX,f=a.endX,m=this.props,v=m.x,E=m.width,S=m.travellerWidth,T=m.startIndex,R=m.endIndex,I=m.onChange,O=i.pageX-l;O>0?O=Math.min(O,v+E-S-f,v+E-S-d):O<0&&(O=Math.max(O,v-d,v-f));var P=this.getIndex({startX:d+O,endX:f+O});(P.startIndex!==T||P.endIndex!==R)&&I&&I(P),this.setState({startX:d+O,endX:f+O,slideMoveStartX:i.pageX})}},{key:"handleTravellerDragStart",value:function(i,a){var l=hne(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:i,brushMoveStartX:l.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(i){var a=this.state,l=a.brushMoveStartX,d=a.movingTravellerId,f=a.endX,m=a.startX,v=this.state[d],E=this.props,S=E.x,T=E.width,R=E.travellerWidth,I=E.onChange,O=E.gap,P=E.data,D={startX:this.state.startX,endX:this.state.endX},k=i.pageX-l;k>0?k=Math.min(k,S+T-R-v):k<0&&(k=Math.max(k,S-v)),D[d]=v+k;var M=this.getIndex(D),$=M.startIndex,V=M.endIndex,W=function(){var J=P.length-1;return d==="startX"&&(f>m?$%O===0:V%O===0)||f<m&&V===J||d==="endX"&&(f>m?V%O===0:$%O===0)||f>m&&V===J};this.setState(Fs(Fs({},d,v+k),"brushMoveStartX",i.pageX),function(){I&&W()&&I(M)})}},{key:"handleTravellerMoveKeyboard",value:function(i,a){var l=this,d=this.state,f=d.scaleValues,m=d.startX,v=d.endX,E=this.state[a],S=f.indexOf(E);if(S!==-1){var T=S+i;if(!(T===-1||T>=f.length)){var R=f[T];a==="startX"&&R>=v||a==="endX"&&R<=m||this.setState(Fs({},a,R),function(){l.props.onChange(l.getIndex({startX:l.state.startX,endX:l.state.endX}))})}}}},{key:"renderBackground",value:function(){var i=this.props,a=i.x,l=i.y,d=i.width,f=i.height,m=i.fill,v=i.stroke;return se.createElement("rect",{stroke:v,fill:m,x:a,y:l,width:d,height:f})}},{key:"renderPanorama",value:function(){var i=this.props,a=i.x,l=i.y,d=i.width,f=i.height,m=i.data,v=i.children,E=i.padding,S=N.Children.only(v);return S?se.cloneElement(S,{x:a,y:l,width:d,height:f,margin:E,compact:!0,data:m}):null}},{key:"renderTravellerLayer",value:function(i,a){var l,d,f=this,m=this.props,v=m.y,E=m.travellerWidth,S=m.height,T=m.traveller,R=m.ariaLabel,I=m.data,O=m.startIndex,P=m.endIndex,D=Math.max(i,this.props.x),k=FL(FL({},Vt(this.props,!1)),{},{x:D,y:v,width:E,height:S}),M=R||"Min value: ".concat((l=I[O])===null||l===void 0?void 0:l.name,", Max value: ").concat((d=I[P])===null||d===void 0?void 0:d.name);return se.createElement(er,{tabIndex:0,role:"slider","aria-label":M,"aria-valuenow":i,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(V){["ArrowLeft","ArrowRight"].includes(V.key)&&(V.preventDefault(),V.stopPropagation(),f.handleTravellerMoveKeyboard(V.key==="ArrowRight"?1:-1,a))},onFocus:function(){f.setState({isTravellerFocused:!0})},onBlur:function(){f.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(T,k))}},{key:"renderSlide",value:function(i,a){var l=this.props,d=l.y,f=l.height,m=l.stroke,v=l.travellerWidth,E=Math.min(i,a)+v,S=Math.max(Math.abs(a-i)-v,0);return se.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:m,fillOpacity:.2,x:E,y:d,width:S,height:f})}},{key:"renderText",value:function(){var i=this.props,a=i.startIndex,l=i.endIndex,d=i.y,f=i.height,m=i.travellerWidth,v=i.stroke,E=this.state,S=E.startX,T=E.endX,R=5,I={pointerEvents:"none",fill:v};return se.createElement(er,{className:"recharts-brush-texts"},se.createElement(wp,GA({textAnchor:"end",verticalAnchor:"middle",x:Math.min(S,T)-R,y:d+f/2},I),this.getTextOfTick(a)),se.createElement(wp,GA({textAnchor:"start",verticalAnchor:"middle",x:Math.max(S,T)+m+R,y:d+f/2},I),this.getTextOfTick(l)))}},{key:"render",value:function(){var i=this.props,a=i.data,l=i.className,d=i.children,f=i.x,m=i.y,v=i.width,E=i.height,S=i.alwaysShowText,T=this.state,R=T.startX,I=T.endX,O=T.isTextActive,P=T.isSlideMoving,D=T.isTravellerMoving,k=T.isTravellerFocused;if(!a||!a.length||!rt(f)||!rt(m)||!rt(v)||!rt(E)||v<=0||E<=0)return null;var M=un("recharts-brush",l),$=se.Children.count(d)===1,V=Aht("userSelect","none");return se.createElement(er,{className:M,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:V},this.renderBackground(),$&&this.renderPanorama(),this.renderSlide(R,I),this.renderTravellerLayer(R,"startX"),this.renderTravellerLayer(I,"endX"),(O||P||D||k||S)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(i){var a=i.x,l=i.y,d=i.width,f=i.height,m=i.stroke,v=Math.floor(l+f/2)-1;return se.createElement(se.Fragment,null,se.createElement("rect",{x:a,y:l,width:d,height:f,fill:m,stroke:"none"}),se.createElement("line",{x1:a+1,y1:v,x2:a+d-1,y2:v,fill:"none",stroke:"#fff"}),se.createElement("line",{x1:a+1,y1:v+2,x2:a+d-1,y2:v+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(i,a){var l;return se.isValidElement(i)?l=se.cloneElement(i,a):Xt(i)?l=i(a):l=t.renderDefaultTraveller(a),l}},{key:"getDerivedStateFromProps",value:function(i,a){var l=i.data,d=i.width,f=i.x,m=i.travellerWidth,v=i.updateId,E=i.startIndex,S=i.endIndex;if(l!==a.prevData||v!==a.prevUpdateId)return FL({prevData:l,prevTravellerWidth:m,prevUpdateId:v,prevX:f,prevWidth:d},l&&l.length?Lht({data:l,width:d,x:f,travellerWidth:m,startIndex:E,endIndex:S}):{scale:null,scaleValues:null});if(a.scale&&(d!==a.prevWidth||f!==a.prevX||m!==a.prevTravellerWidth)){a.scale.range([f,f+d-m]);var T=a.scale.domain().map(function(R){return a.scale(R)});return{prevData:l,prevTravellerWidth:m,prevUpdateId:v,prevX:f,prevWidth:d,startX:a.scale(i.startIndex),endX:a.scale(i.endIndex),scaleValues:T}}return null}},{key:"getIndexInRange",value:function(i,a){for(var l=i.length,d=0,f=l-1;f-d>1;){var m=Math.floor((d+f)/2);i[m]>a?f=m:d=m}return a>=i[f]?f:d}}])}(N.PureComponent);Fs(Dv,"displayName","Brush");Fs(Dv,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var Mht=cB;function jht(e,t){var n;return Mht(e,function(i,a,l){return n=t(i,a,l),!n}),!!n}var Uht=jht,Vht=Rhe,Fht=kh,Bht=Uht,$ht=ws,Wht=PI;function Ght(e,t,n){var i=$ht(e)?Vht:Bht;return n&&Wht(e,t,n)&&(t=void 0),i(e,Fht(t))}var Hht=Ght;const Kht=zn(Hht);var Il=function(t,n){var i=t.alwaysShow,a=t.ifOverflow;return i&&(a="extendDomain"),a===n},fne=zhe;function zht(e,t,n){t=="__proto__"&&fne?fne(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var Yht=zht,qht=Yht,Xht=Hhe,Jht=kh;function Qht(e,t){var n={};return t=Jht(t),Xht(e,function(i,a,l){qht(n,a,t(i,a,l))}),n}var Zht=Qht;const eft=zn(Zht);function tft(e,t){for(var n=-1,i=e==null?0:e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}var nft=tft,rft=cB;function ift(e,t){var n=!0;return rft(e,function(i,a,l){return n=!!t(i,a,l),n}),n}var oft=ift,sft=nft,aft=oft,cft=kh,lft=ws,uft=PI;function dft(e,t,n){var i=lft(e)?sft:aft;return n&&uft(e,t,n)&&(t=void 0),i(e,cft(t))}var hft=dft;const fft=zn(hft);var pft=["x","y"];function fS(e){"@babel/helpers - typeof";return fS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fS(e)}function Qj(){return Qj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Qj.apply(this,arguments)}function pne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function yE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pne(Object(n),!0).forEach(function(i){mft(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function mft(e,t,n){return t=gft(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gft(e){var t=vft(e,"string");return fS(t)=="symbol"?t:t+""}function vft(e,t){if(fS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(fS(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yft(e,t){if(e==null)return{};var n=_ft(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function _ft(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function Eft(e,t){var n=e.x,i=e.y,a=yft(e,pft),l="".concat(n),d=parseInt(l,10),f="".concat(i),m=parseInt(f,10),v="".concat(t.height||a.height),E=parseInt(v,10),S="".concat(t.width||a.width),T=parseInt(S,10);return yE(yE(yE(yE(yE({},t),a),d?{x:d}:{}),m?{y:m}:{}),{},{height:E,width:T,name:t.name,radius:t.radius})}function mne(e){return se.createElement(xpe,Qj({shapeType:"rectangle",propTransformer:Eft,activeClassName:"recharts-active-bar"},e))}var bft=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(i,a){if(typeof t=="number")return t;var l=typeof i=="number";return l?t(i,a):(l||Cp(),n)}},Sft=["value","background"],Mpe;function kv(e){"@babel/helpers - typeof";return kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kv(e)}function wft(e,t){if(e==null)return{};var n=Tft(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Tft(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function KA(){return KA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},KA.apply(this,arguments)}function gne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Ti(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gne(Object(n),!0).forEach(function(i){nh(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Cft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Upe(i.key),i)}}function Rft(e,t,n){return t&&vne(e.prototype,t),n&&vne(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Aft(e,t,n){return t=zA(t),Oft(e,jpe()?Reflect.construct(t,n||[],zA(e).constructor):t.apply(e,n))}function Oft(e,t){if(t&&(kv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ift(e)}function Ift(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jpe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jpe=function(){return!!e})()}function zA(e){return zA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},zA(e)}function xft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zj(e,t)}function Zj(e,t){return Zj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},Zj(e,t)}function nh(e,t,n){return t=Upe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Upe(e){var t=Pft(e,"string");return kv(t)=="symbol"?t:t+""}function Pft(e,t){if(kv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(kv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Uh=function(e){function t(){var n;Cft(this,t);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return n=Aft(this,t,[].concat(a)),nh(n,"state",{isAnimationFinished:!1}),nh(n,"id",GS("recharts-bar-")),nh(n,"handleAnimationEnd",function(){var d=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),d&&d()}),nh(n,"handleAnimationStart",function(){var d=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),d&&d()}),n}return xft(t,e),Rft(t,[{key:"renderRectanglesStatically",value:function(i){var a=this,l=this.props,d=l.shape,f=l.dataKey,m=l.activeIndex,v=l.activeBar,E=Vt(this.props,!1);return i&&i.map(function(S,T){var R=T===m,I=R?v:d,O=Ti(Ti(Ti({},E),S),{},{isActive:R,option:I,index:T,dataKey:f,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return se.createElement(er,KA({className:"recharts-bar-rectangle"},Sp(a.props,S,T),{key:"rectangle-".concat(S==null?void 0:S.x,"-").concat(S==null?void 0:S.y,"-").concat(S==null?void 0:S.value,"-").concat(T)}),se.createElement(mne,O))})}},{key:"renderRectanglesWithAnimation",value:function(){var i=this,a=this.props,l=a.data,d=a.layout,f=a.isAnimationActive,m=a.animationBegin,v=a.animationDuration,E=a.animationEasing,S=a.animationId,T=this.state.prevData;return se.createElement(Wu,{begin:m,duration:v,isActive:f,easing:E,from:{t:0},to:{t:1},key:"bar-".concat(S),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(R){var I=R.t,O=l.map(function(P,D){var k=T&&T[D];if(k){var M=Wd(k.x,P.x),$=Wd(k.y,P.y),V=Wd(k.width,P.width),W=Wd(k.height,P.height);return Ti(Ti({},P),{},{x:M(I),y:$(I),width:V(I),height:W(I)})}if(d==="horizontal"){var H=Wd(0,P.height),J=H(I);return Ti(Ti({},P),{},{y:P.y+P.height-J,height:J})}var ee=Wd(0,P.width),le=ee(I);return Ti(Ti({},P),{},{width:le})});return se.createElement(er,null,i.renderRectanglesStatically(O))})}},{key:"renderRectangles",value:function(){var i=this.props,a=i.data,l=i.isAnimationActive,d=this.state.prevData;return l&&a&&a.length&&(!d||!$I(d,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var i=this,a=this.props,l=a.data,d=a.dataKey,f=a.activeIndex,m=Vt(this.props.background,!1);return l.map(function(v,E){v.value;var S=v.background,T=wft(v,Sft);if(!S)return null;var R=Ti(Ti(Ti(Ti(Ti({},T),{},{fill:"#eee"},S),m),Sp(i.props,v,E)),{},{onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd,dataKey:d,index:E,className:"recharts-bar-background-rectangle"});return se.createElement(mne,KA({key:"background-bar-".concat(E),option:i.props.background,isActive:E===f},R))})}},{key:"renderErrorBar",value:function(i,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var l=this.props,d=l.data,f=l.xAxis,m=l.yAxis,v=l.layout,E=l.children,S=Ba(E,HI);if(!S)return null;var T=v==="vertical"?d[0].height/2:d[0].width/2,R=function(P,D){var k=Array.isArray(P.value)?P.value[1]:P.value;return{x:P.x,y:P.y,value:k,errorVal:To(P,D)}},I={clipPath:i?"url(#clipPath-".concat(a,")"):null};return se.createElement(er,I,S.map(function(O){return se.cloneElement(O,{key:"error-bar-".concat(a,"-").concat(O.props.dataKey),data:d,xAxis:f,yAxis:m,layout:v,offset:T,dataPointFormatter:R})}))}},{key:"render",value:function(){var i=this.props,a=i.hide,l=i.data,d=i.className,f=i.xAxis,m=i.yAxis,v=i.left,E=i.top,S=i.width,T=i.height,R=i.isAnimationActive,I=i.background,O=i.id;if(a||!l||!l.length)return null;var P=this.state.isAnimationFinished,D=un("recharts-bar",d),k=f&&f.allowDataOverflow,M=m&&m.allowDataOverflow,$=k||M,V=En(O)?this.id:O;return se.createElement(er,{className:D},k||M?se.createElement("defs",null,se.createElement("clipPath",{id:"clipPath-".concat(V)},se.createElement("rect",{x:k?v:v-S/2,y:M?E:E-T/2,width:k?S:S*2,height:M?T:T*2}))):null,se.createElement(er,{className:"recharts-bar-rectangles",clipPath:$?"url(#clipPath-".concat(V,")"):null},I?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar($,V),(!R||P)&&gh.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(i,a){return i.animationId!==a.prevAnimationId?{prevAnimationId:i.animationId,curData:i.data,prevData:a.curData}:i.data!==a.curData?{curData:i.data}:null}}])}(N.PureComponent);Mpe=Uh;nh(Uh,"displayName","Bar");nh(Uh,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!my.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});nh(Uh,"getComposedData",function(e){var t=e.props,n=e.item,i=e.barPosition,a=e.bandSize,l=e.xAxis,d=e.yAxis,f=e.xAxisTicks,m=e.yAxisTicks,v=e.stackedData,E=e.dataStartIndex,S=e.displayedData,T=e.offset,R=aat(i,n);if(!R)return null;var I=t.layout,O=n.type.defaultProps,P=O!==void 0?Ti(Ti({},O),n.props):n.props,D=P.dataKey,k=P.children,M=P.minPointSize,$=I==="horizontal"?d:l,V=v?$.scale.domain():null,W=pat({numericAxis:$}),H=Ba(k,NI),J=S.map(function(ee,le){var he,de,ae,ce,ge,ye;v?he=cat(v[E+le],V):(he=To(ee,D),Array.isArray(he)||(he=[W,he]));var te=bft(M,Mpe.defaultProps.minPointSize)(he[1],le);if(I==="horizontal"){var ne,ue=[d.scale(he[0]),d.scale(he[1])],_e=ue[0],Ce=ue[1];de=cte({axis:l,ticks:f,bandSize:a,offset:R.offset,entry:ee,index:le}),ae=(ne=Ce??_e)!==null&&ne!==void 0?ne:void 0,ce=R.size;var Ie=_e-Ce;if(ge=Number.isNaN(Ie)?0:Ie,ye={x:de,y:d.y,width:ce,height:d.height},Math.abs(te)>0&&Math.abs(ge)<Math.abs(te)){var Ge=Bo(ge||te)*(Math.abs(te)-Math.abs(ge));ae-=Ge,ge+=Ge}}else{var Ze=[l.scale(he[0]),l.scale(he[1])],wt=Ze[0],Ft=Ze[1];if(de=wt,ae=cte({axis:d,ticks:m,bandSize:a,offset:R.offset,entry:ee,index:le}),ce=Ft-wt,ge=R.size,ye={x:l.x,y:ae,width:l.width,height:ge},Math.abs(te)>0&&Math.abs(ce)<Math.abs(te)){var ze=Bo(ce||te)*(Math.abs(te)-Math.abs(ce));ce+=ze}}return Ti(Ti(Ti({},ee),{},{x:de,y:ae,width:ce,height:ge,value:v?he:he[1],payload:ee,background:ye},H&&H[le]&&H[le].props),{},{tooltipPayload:[cpe(n,ee)],tooltipPosition:{x:de+ce/2,y:ae+ge/2}})});return Ti({data:J,layout:I},T)});function pS(e){"@babel/helpers - typeof";return pS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pS(e)}function Nft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Vpe(i.key),i)}}function Dft(e,t,n){return t&&yne(e.prototype,t),n&&yne(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Cc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_ne(Object(n),!0).forEach(function(i){QI(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_ne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function QI(e,t,n){return t=Vpe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vpe(e){var t=kft(e,"string");return pS(t)=="symbol"?t:t+""}function kft(e,t){if(pS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(pS(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lft=function(t,n,i,a,l){var d=t.width,f=t.height,m=t.layout,v=t.children,E=Object.keys(n),S={left:i.left,leftMirror:i.left,right:d-i.right,rightMirror:d-i.right,top:i.top,topMirror:i.top,bottom:f-i.bottom,bottomMirror:f-i.bottom},T=!!$s(v,Uh);return E.reduce(function(R,I){var O=n[I],P=O.orientation,D=O.domain,k=O.padding,M=k===void 0?{}:k,$=O.mirror,V=O.reversed,W="".concat(P).concat($?"Mirror":""),H,J,ee,le,he;if(O.type==="number"&&(O.padding==="gap"||O.padding==="no-gap")){var de=D[1]-D[0],ae=1/0,ce=O.categoricalDomain.sort(Wze);if(ce.forEach(function(Ze,wt){wt>0&&(ae=Math.min((Ze||0)-(ce[wt-1]||0),ae))}),Number.isFinite(ae)){var ge=ae/de,ye=O.layout==="vertical"?i.height:i.width;if(O.padding==="gap"&&(H=ge*ye/2),O.padding==="no-gap"){var te=$o(t.barCategoryGap,ge*ye),ne=ge*ye/2;H=ne-te-(ne-te)/ye*te}}}a==="xAxis"?J=[i.left+(M.left||0)+(H||0),i.left+i.width-(M.right||0)-(H||0)]:a==="yAxis"?J=m==="horizontal"?[i.top+i.height-(M.bottom||0),i.top+(M.top||0)]:[i.top+(M.top||0)+(H||0),i.top+i.height-(M.bottom||0)-(H||0)]:J=O.range,V&&(J=[J[1],J[0]]);var ue=ipe(O,l,T),_e=ue.scale,Ce=ue.realScaleType;_e.domain(D).range(J),ope(_e);var Ie=spe(_e,Cc(Cc({},O),{},{realScaleType:Ce}));a==="xAxis"?(he=P==="top"&&!$||P==="bottom"&&$,ee=i.left,le=S[W]-he*O.height):a==="yAxis"&&(he=P==="left"&&!$||P==="right"&&$,ee=S[W]-he*O.width,le=i.top);var Ge=Cc(Cc(Cc({},O),Ie),{},{realScaleType:Ce,x:ee,y:le,scale:_e,width:a==="xAxis"?i.width:O.width,height:a==="yAxis"?i.height:O.height});return Ge.bandSize=PA(Ge,Ie),!O.hide&&a==="xAxis"?S[W]+=(he?-1:1)*Ge.height:O.hide||(S[W]+=(he?-1:1)*Ge.width),Cc(Cc({},R),{},QI({},I,Ge))},{})},Fpe=function(t,n){var i=t.x,a=t.y,l=n.x,d=n.y;return{x:Math.min(i,l),y:Math.min(a,d),width:Math.abs(l-i),height:Math.abs(d-a)}},Mft=function(t){var n=t.x1,i=t.y1,a=t.x2,l=t.y2;return Fpe({x:n,y:i},{x:a,y:l})},Bpe=function(){function e(t){Nft(this,e),this.scale=t}return Dft(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=i.bandAware,l=i.position;if(n!==void 0){if(l)switch(l){case"start":return this.scale(n);case"middle":{var d=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+d}case"end":{var f=this.bandwidth?this.bandwidth():0;return this.scale(n)+f}default:return this.scale(n)}if(a){var m=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+m}return this.scale(n)}}},{key:"isInRange",value:function(n){var i=this.range(),a=i[0],l=i[i.length-1];return a<=l?n>=a&&n<=l:n>=l&&n<=a}}],[{key:"create",value:function(n){return new e(n)}}])}();QI(Bpe,"EPS",1e-4);var VB=function(t){var n=Object.keys(t).reduce(function(i,a){return Cc(Cc({},i),{},QI({},a,Bpe.create(t[a])))},{});return Cc(Cc({},n),{},{apply:function(a){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=l.bandAware,f=l.position;return eft(a,function(m,v){return n[v].apply(m,{bandAware:d,position:f})})},isInRange:function(a){return fft(a,function(l,d){return n[d].isInRange(l)})}})};function jft(e){return(e%180+180)%180}var Uft=function(t){var n=t.width,i=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l=jft(a),d=l*Math.PI/180,f=Math.atan(i/n),m=d>f&&d<Math.PI-f?i/Math.sin(d):n/Math.cos(d);return Math.abs(m)},Vft=zKe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),$pe=N.createContext(void 0),Wpe=N.createContext(void 0),Gpe=N.createContext(void 0),Fft=N.createContext({}),Hpe=N.createContext(void 0),Kpe=N.createContext(0),zpe=N.createContext(0),Ene=function(t){var n=t.state,i=n.xAxisMap,a=n.yAxisMap,l=n.offset,d=t.clipPathId,f=t.children,m=t.width,v=t.height,E=Vft(l);return se.createElement($pe.Provider,{value:i},se.createElement(Wpe.Provider,{value:a},se.createElement(Fft.Provider,{value:l},se.createElement(Gpe.Provider,{value:E},se.createElement(Hpe.Provider,{value:d},se.createElement(Kpe.Provider,{value:v},se.createElement(zpe.Provider,{value:m},f)))))))},Bft=function(){return N.useContext(Hpe)},Ype=function(t){var n=N.useContext($pe);n==null&&Cp();var i=n[t];return i==null&&Cp(),i},qpe=function(t){var n=N.useContext(Wpe);n==null&&Cp();var i=n[t];return i==null&&Cp(),i},$ft=function(){var t=N.useContext(Gpe);return t},Xpe=function(){return N.useContext(zpe)},Jpe=function(){return N.useContext(Kpe)};function Lv(e){"@babel/helpers - typeof";return Lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lv(e)}function Wft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gft(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,Zpe(i.key),i)}}function Hft(e,t,n){return t&&Gft(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kft(e,t,n){return t=YA(t),zft(e,Qpe()?Reflect.construct(t,n||[],YA(e).constructor):t.apply(e,n))}function zft(e,t){if(t&&(Lv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Yft(e)}function Yft(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Qpe(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Qpe=function(){return!!e})()}function YA(e){return YA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},YA(e)}function qft(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eU(e,t)}function eU(e,t){return eU=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},eU(e,t)}function bne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Sne(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bne(Object(n),!0).forEach(function(i){FB(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function FB(e,t,n){return t=Zpe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zpe(e){var t=Xft(e,"string");return Lv(t)=="symbol"?t:t+""}function Xft(e,t){if(Lv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Lv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Jft(e,t){return tpt(e)||ept(e,t)||Zft(e,t)||Qft()}function Qft(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zft(e,t){if(e){if(typeof e=="string")return wne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wne(e,t)}}function wne(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ept(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,a,l,d,f=[],m=!0,v=!1;try{if(l=(n=n.call(e)).next,t!==0)for(;!(m=(i=l.call(n)).done)&&(f.push(i.value),f.length!==t);m=!0);}catch(E){v=!0,a=E}finally{try{if(!m&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(v)throw a}}return f}}function tpt(e){if(Array.isArray(e))return e}function tU(){return tU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},tU.apply(this,arguments)}var npt=function(t,n){var i;return se.isValidElement(t)?i=se.cloneElement(t,n):Xt(t)?i=t(n):i=se.createElement("line",tU({},n,{className:"recharts-reference-line-line"})),i},rpt=function(t,n,i,a,l,d,f,m,v){var E=l.x,S=l.y,T=l.width,R=l.height;if(i){var I=v.y,O=t.y.apply(I,{position:d});if(Il(v,"discard")&&!t.y.isInRange(O))return null;var P=[{x:E+T,y:O},{x:E,y:O}];return m==="left"?P.reverse():P}if(n){var D=v.x,k=t.x.apply(D,{position:d});if(Il(v,"discard")&&!t.x.isInRange(k))return null;var M=[{x:k,y:S+R},{x:k,y:S}];return f==="top"?M.reverse():M}if(a){var $=v.segment,V=$.map(function(W){return t.apply(W,{position:d})});return Il(v,"discard")&&Kht(V,function(W){return!t.isInRange(W)})?null:V}return null};function ipt(e){var t=e.x,n=e.y,i=e.segment,a=e.xAxisId,l=e.yAxisId,d=e.shape,f=e.className,m=e.alwaysShow,v=Bft(),E=Ype(a),S=qpe(l),T=$ft();if(!v||!T)return null;Pu(m===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var R=VB({x:E.scale,y:S.scale}),I=Mi(t),O=Mi(n),P=i&&i.length===2,D=rpt(R,I,O,P,T,e.position,E.orientation,S.orientation,e);if(!D)return null;var k=Jft(D,2),M=k[0],$=M.x,V=M.y,W=k[1],H=W.x,J=W.y,ee=Il(e,"hidden")?"url(#".concat(v,")"):void 0,le=Sne(Sne({clipPath:ee},Vt(e,!0)),{},{x1:$,y1:V,x2:H,y2:J});return se.createElement(er,{className:un("recharts-reference-line",f)},npt(d,le),Yi.renderCallByParent(e,Mft({x1:$,y1:V,x2:H,y2:J})))}var BB=function(e){function t(){return Wft(this,t),Kft(this,t,arguments)}return qft(t,e),Hft(t,[{key:"render",value:function(){return se.createElement(ipt,this.props)}}])}(se.Component);FB(BB,"displayName","ReferenceLine");FB(BB,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function nU(){return nU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},nU.apply(this,arguments)}function Mv(e){"@babel/helpers - typeof";return Mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mv(e)}function Tne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Cne(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Tne(Object(n),!0).forEach(function(i){ZI(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function opt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function spt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,tme(i.key),i)}}function apt(e,t,n){return t&&spt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function cpt(e,t,n){return t=qA(t),lpt(e,eme()?Reflect.construct(t,n||[],qA(e).constructor):t.apply(e,n))}function lpt(e,t){if(t&&(Mv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return upt(e)}function upt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eme(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eme=function(){return!!e})()}function qA(e){return qA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},qA(e)}function dpt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rU(e,t)}function rU(e,t){return rU=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},rU(e,t)}function ZI(e,t,n){return t=tme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tme(e){var t=hpt(e,"string");return Mv(t)=="symbol"?t:t+""}function hpt(e,t){if(Mv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Mv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var fpt=function(t){var n=t.x,i=t.y,a=t.xAxis,l=t.yAxis,d=VB({x:a.scale,y:l.scale}),f=d.apply({x:n,y:i},{bandAware:!0});return Il(t,"discard")&&!d.isInRange(f)?null:f},ex=function(e){function t(){return opt(this,t),cpt(this,t,arguments)}return dpt(t,e),apt(t,[{key:"render",value:function(){var i=this.props,a=i.x,l=i.y,d=i.r,f=i.alwaysShow,m=i.clipPathId,v=Mi(a),E=Mi(l);if(Pu(f===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!v||!E)return null;var S=fpt(this.props);if(!S)return null;var T=S.x,R=S.y,I=this.props,O=I.shape,P=I.className,D=Il(this.props,"hidden")?"url(#".concat(m,")"):void 0,k=Cne(Cne({clipPath:D},Vt(this.props,!0)),{},{cx:T,cy:R});return se.createElement(er,{className:un("recharts-reference-dot",P)},t.renderDot(O,k),Yi.renderCallByParent(this.props,{x:T-d,y:R-d,width:2*d,height:2*d}))}}])}(se.Component);ZI(ex,"displayName","ReferenceDot");ZI(ex,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});ZI(ex,"renderDot",function(e,t){var n;return se.isValidElement(e)?n=se.cloneElement(e,t):Xt(e)?n=e(t):n=se.createElement(UB,nU({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function iU(){return iU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},iU.apply(this,arguments)}function jv(e){"@babel/helpers - typeof";return jv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jv(e)}function Rne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Ane(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Rne(Object(n),!0).forEach(function(i){tx(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function ppt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mpt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,rme(i.key),i)}}function gpt(e,t,n){return t&&mpt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function vpt(e,t,n){return t=XA(t),ypt(e,nme()?Reflect.construct(t,n||[],XA(e).constructor):t.apply(e,n))}function ypt(e,t){if(t&&(jv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _pt(e)}function _pt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nme(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nme=function(){return!!e})()}function XA(e){return XA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},XA(e)}function Ept(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oU(e,t)}function oU(e,t){return oU=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},oU(e,t)}function tx(e,t,n){return t=rme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rme(e){var t=bpt(e,"string");return jv(t)=="symbol"?t:t+""}function bpt(e,t){if(jv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(jv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Spt=function(t,n,i,a,l){var d=l.x1,f=l.x2,m=l.y1,v=l.y2,E=l.xAxis,S=l.yAxis;if(!E||!S)return null;var T=VB({x:E.scale,y:S.scale}),R={x:t?T.x.apply(d,{position:"start"}):T.x.rangeMin,y:i?T.y.apply(m,{position:"start"}):T.y.rangeMin},I={x:n?T.x.apply(f,{position:"end"}):T.x.rangeMax,y:a?T.y.apply(v,{position:"end"}):T.y.rangeMax};return Il(l,"discard")&&(!T.isInRange(R)||!T.isInRange(I))?null:Fpe(R,I)},nx=function(e){function t(){return ppt(this,t),vpt(this,t,arguments)}return Ept(t,e),gpt(t,[{key:"render",value:function(){var i=this.props,a=i.x1,l=i.x2,d=i.y1,f=i.y2,m=i.className,v=i.alwaysShow,E=i.clipPathId;Pu(v===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var S=Mi(a),T=Mi(l),R=Mi(d),I=Mi(f),O=this.props.shape;if(!S&&!T&&!R&&!I&&!O)return null;var P=Spt(S,T,R,I,this.props);if(!P&&!O)return null;var D=Il(this.props,"hidden")?"url(#".concat(E,")"):void 0;return se.createElement(er,{className:un("recharts-reference-area",m)},t.renderRect(O,Ane(Ane({clipPath:D},Vt(this.props,!0)),P)),Yi.renderCallByParent(this.props,P))}}])}(se.Component);tx(nx,"displayName","ReferenceArea");tx(nx,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});tx(nx,"renderRect",function(e,t){var n;return se.isValidElement(e)?n=se.cloneElement(e,t):Xt(e)?n=e(t):n=se.createElement(jB,iU({},t,{className:"recharts-reference-area-rect"})),n});function ime(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var i=[],a=0;a<e.length;a+=t)i.push(e[a]);return i}function wpt(e,t,n){var i={width:e.width+t.width,height:e.height+t.height};return Uft(i,n)}function Tpt(e,t,n){var i=n==="width",a=e.x,l=e.y,d=e.width,f=e.height;return t===1?{start:i?a:l,end:i?a+d:l+f}:{start:i?a+d:l+f,end:i?a:l}}function JA(e,t,n,i,a){if(e*t<e*i||e*t>e*a)return!1;var l=n();return e*(t-e*l/2-i)>=0&&e*(t+e*l/2-a)<=0}function Cpt(e,t){return ime(e,t+1)}function Rpt(e,t,n,i,a){for(var l=(i||[]).slice(),d=t.start,f=t.end,m=0,v=1,E=d,S=function(){var I=i==null?void 0:i[m];if(I===void 0)return{v:ime(i,v)};var O=m,P,D=function(){return P===void 0&&(P=n(I,O)),P},k=I.coordinate,M=m===0||JA(e,k,D,E,f);M||(m=0,E=d,v+=1),M&&(E=k+e*(D()/2+a),m+=v)},T;v<=l.length;)if(T=S(),T)return T.v;return[]}function mS(e){"@babel/helpers - typeof";return mS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mS(e)}function One(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function So(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?One(Object(n),!0).forEach(function(i){Apt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):One(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Apt(e,t,n){return t=Opt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Opt(e){var t=Ipt(e,"string");return mS(t)=="symbol"?t:t+""}function Ipt(e,t){if(mS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(mS(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xpt(e,t,n,i,a){for(var l=(i||[]).slice(),d=l.length,f=t.start,m=t.end,v=function(T){var R=l[T],I,O=function(){return I===void 0&&(I=n(R,T)),I};if(T===d-1){var P=e*(R.coordinate+e*O()/2-m);l[T]=R=So(So({},R),{},{tickCoord:P>0?R.coordinate-P*e:R.coordinate})}else l[T]=R=So(So({},R),{},{tickCoord:R.coordinate});var D=JA(e,R.tickCoord,O,f,m);D&&(m=R.tickCoord-e*(O()/2+a),l[T]=So(So({},R),{},{isShow:!0}))},E=d-1;E>=0;E--)v(E);return l}function Ppt(e,t,n,i,a,l){var d=(i||[]).slice(),f=d.length,m=t.start,v=t.end;if(l){var E=i[f-1],S=n(E,f-1),T=e*(E.coordinate+e*S/2-v);d[f-1]=E=So(So({},E),{},{tickCoord:T>0?E.coordinate-T*e:E.coordinate});var R=JA(e,E.tickCoord,function(){return S},m,v);R&&(v=E.tickCoord-e*(S/2+a),d[f-1]=So(So({},E),{},{isShow:!0}))}for(var I=l?f-1:f,O=function(k){var M=d[k],$,V=function(){return $===void 0&&($=n(M,k)),$};if(k===0){var W=e*(M.coordinate-e*V()/2-m);d[k]=M=So(So({},M),{},{tickCoord:W<0?M.coordinate-W*e:M.coordinate})}else d[k]=M=So(So({},M),{},{tickCoord:M.coordinate});var H=JA(e,M.tickCoord,V,m,v);H&&(m=M.tickCoord+e*(V()/2+a),d[k]=So(So({},M),{},{isShow:!0}))},P=0;P<I;P++)O(P);return d}function Npt(e,t,n){var i=e.tick,a=e.ticks,l=e.viewBox,d=e.minTickGap,f=e.orientation,m=e.interval,v=e.tickFormatter,E=e.unit,S=e.angle;if(!a||!a.length||!i)return[];if(rt(m)||my.isSsr)return Cpt(a,typeof m=="number"&&rt(m)?m:0);var T=[],R=f==="top"||f==="bottom"?"width":"height",I=E&&R==="width"?JE(E,{fontSize:t,letterSpacing:n}):{width:0,height:0},O=function(M,$){var V=Xt(v)?v(M.value,$):M.value;return R==="width"?wpt(JE(V,{fontSize:t,letterSpacing:n}),I,S):JE(V,{fontSize:t,letterSpacing:n})[R]},P=a.length>=2?Bo(a[1].coordinate-a[0].coordinate):1,D=Tpt(l,P,R);return m==="equidistantPreserveStart"?Rpt(P,D,O,a,d):(m==="preserveStart"||m==="preserveStartEnd"?T=Ppt(P,D,O,a,d,m==="preserveStartEnd"):T=xpt(P,D,O,a,d),T.filter(function(k){return k.isShow}))}var Dpt=["viewBox"],kpt=["viewBox"],Lpt=["ticks"];function Uv(e){"@babel/helpers - typeof";return Uv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uv(e)}function Lg(){return Lg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Lg.apply(this,arguments)}function Ine(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Mo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ine(Object(n),!0).forEach(function(i){$B(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ine(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function BL(e,t){if(e==null)return{};var n=Mpt(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Mpt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function jpt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,sme(i.key),i)}}function Upt(e,t,n){return t&&xne(e.prototype,t),n&&xne(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Vpt(e,t,n){return t=QA(t),Fpt(e,ome()?Reflect.construct(t,n||[],QA(e).constructor):t.apply(e,n))}function Fpt(e,t){if(t&&(Uv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Bpt(e)}function Bpt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ome(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ome=function(){return!!e})()}function QA(e){return QA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},QA(e)}function $pt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sU(e,t)}function sU(e,t){return sU=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},sU(e,t)}function $B(e,t,n){return t=sme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sme(e){var t=Wpt(e,"string");return Uv(t)=="symbol"?t:t+""}function Wpt(e,t){if(Uv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Uv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var rx=function(e){function t(n){var i;return jpt(this,t),i=Vpt(this,t,[n]),i.state={fontSize:"",letterSpacing:""},i}return $pt(t,e),Upt(t,[{key:"shouldComponentUpdate",value:function(i,a){var l=i.viewBox,d=BL(i,Dpt),f=this.props,m=f.viewBox,v=BL(f,kpt);return!zg(l,m)||!zg(d,v)||!zg(a,this.state)}},{key:"componentDidMount",value:function(){var i=this.layerReference;if(i){var a=i.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(i){var a=this.props,l=a.x,d=a.y,f=a.width,m=a.height,v=a.orientation,E=a.tickSize,S=a.mirror,T=a.tickMargin,R,I,O,P,D,k,M=S?-1:1,$=i.tickSize||E,V=rt(i.tickCoord)?i.tickCoord:i.coordinate;switch(v){case"top":R=I=i.coordinate,P=d+ +!S*m,O=P-M*$,k=O-M*T,D=V;break;case"left":O=P=i.coordinate,I=l+ +!S*f,R=I-M*$,D=R-M*T,k=V;break;case"right":O=P=i.coordinate,I=l+ +S*f,R=I+M*$,D=R+M*T,k=V;break;default:R=I=i.coordinate,P=d+ +S*m,O=P+M*$,k=O+M*T,D=V;break}return{line:{x1:R,y1:O,x2:I,y2:P},tick:{x:D,y:k}}}},{key:"getTickTextAnchor",value:function(){var i=this.props,a=i.orientation,l=i.mirror,d;switch(a){case"left":d=l?"start":"end";break;case"right":d=l?"end":"start";break;default:d="middle";break}return d}},{key:"getTickVerticalAnchor",value:function(){var i=this.props,a=i.orientation,l=i.mirror,d="end";switch(a){case"left":case"right":d="middle";break;case"top":d=l?"start":"end";break;default:d=l?"end":"start";break}return d}},{key:"renderAxisLine",value:function(){var i=this.props,a=i.x,l=i.y,d=i.width,f=i.height,m=i.orientation,v=i.mirror,E=i.axisLine,S=Mo(Mo(Mo({},Vt(this.props,!1)),Vt(E,!1)),{},{fill:"none"});if(m==="top"||m==="bottom"){var T=+(m==="top"&&!v||m==="bottom"&&v);S=Mo(Mo({},S),{},{x1:a,y1:l+T*f,x2:a+d,y2:l+T*f})}else{var R=+(m==="left"&&!v||m==="right"&&v);S=Mo(Mo({},S),{},{x1:a+R*d,y1:l,x2:a+R*d,y2:l+f})}return se.createElement("line",Lg({},S,{className:un("recharts-cartesian-axis-line",qs(E,"className"))}))}},{key:"renderTicks",value:function(i,a,l){var d=this,f=this.props,m=f.tickLine,v=f.stroke,E=f.tick,S=f.tickFormatter,T=f.unit,R=Npt(Mo(Mo({},this.props),{},{ticks:i}),a,l),I=this.getTickTextAnchor(),O=this.getTickVerticalAnchor(),P=Vt(this.props,!1),D=Vt(E,!1),k=Mo(Mo({},P),{},{fill:"none"},Vt(m,!1)),M=R.map(function($,V){var W=d.getTickLineCoord($),H=W.line,J=W.tick,ee=Mo(Mo(Mo(Mo({textAnchor:I,verticalAnchor:O},P),{},{stroke:"none",fill:v},D),J),{},{index:V,payload:$,visibleTicksCount:R.length,tickFormatter:S});return se.createElement(er,Lg({className:"recharts-cartesian-axis-tick",key:"tick-".concat($.value,"-").concat($.coordinate,"-").concat($.tickCoord)},Sp(d.props,$,V)),m&&se.createElement("line",Lg({},k,H,{className:un("recharts-cartesian-axis-tick-line",qs(m,"className"))})),E&&t.renderTickItem(E,ee,"".concat(Xt(S)?S($.value,V):$.value).concat(T||"")))});return se.createElement("g",{className:"recharts-cartesian-axis-ticks"},M)}},{key:"render",value:function(){var i=this,a=this.props,l=a.axisLine,d=a.width,f=a.height,m=a.ticksGenerator,v=a.className,E=a.hide;if(E)return null;var S=this.props,T=S.ticks,R=BL(S,Lpt),I=T;return Xt(m)&&(I=T&&T.length>0?m(this.props):m(R)),d<=0||f<=0||!I||!I.length?null:se.createElement(er,{className:un("recharts-cartesian-axis",v),ref:function(P){i.layerReference=P}},l&&this.renderAxisLine(),this.renderTicks(I,this.state.fontSize,this.state.letterSpacing),Yi.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(i,a,l){var d;return se.isValidElement(i)?d=se.cloneElement(i,a):Xt(i)?d=i(a):d=se.createElement(wp,Lg({},a,{className:"recharts-cartesian-axis-tick-value"}),l),d}}])}(N.Component);$B(rx,"displayName","CartesianAxis");$B(rx,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});function Vv(e){"@babel/helpers - typeof";return Vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vv(e)}function Gpt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hpt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,lme(i.key),i)}}function Kpt(e,t,n){return t&&Hpt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function zpt(e,t,n){return t=ZA(t),Ypt(e,ame()?Reflect.construct(t,n||[],ZA(e).constructor):t.apply(e,n))}function Ypt(e,t){if(t&&(Vv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return qpt(e)}function qpt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ame(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ame=function(){return!!e})()}function ZA(e){return ZA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ZA(e)}function Xpt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aU(e,t)}function aU(e,t){return aU=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},aU(e,t)}function cme(e,t,n){return t=lme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lme(e){var t=Jpt(e,"string");return Vv(t)=="symbol"?t:t+""}function Jpt(e,t){if(Vv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Vv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function cU(){return cU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},cU.apply(this,arguments)}function Qpt(e){var t=e.xAxisId,n=Xpe(),i=Jpe(),a=Ype(t);return a==null?null:se.createElement(rx,cU({},a,{className:un("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:n,height:i},ticksGenerator:function(d){return Zf(d,!0)}}))}var qS=function(e){function t(){return Gpt(this,t),zpt(this,t,arguments)}return Xpt(t,e),Kpt(t,[{key:"render",value:function(){return se.createElement(Qpt,this.props)}}])}(se.Component);cme(qS,"displayName","XAxis");cme(qS,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Fv(e){"@babel/helpers - typeof";return Fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fv(e)}function Zpt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function emt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,hme(i.key),i)}}function tmt(e,t,n){return t&&emt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function nmt(e,t,n){return t=eO(t),rmt(e,ume()?Reflect.construct(t,n||[],eO(e).constructor):t.apply(e,n))}function rmt(e,t){if(t&&(Fv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return imt(e)}function imt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ume(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ume=function(){return!!e})()}function eO(e){return eO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},eO(e)}function omt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lU(e,t)}function lU(e,t){return lU=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},lU(e,t)}function dme(e,t,n){return t=hme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hme(e){var t=smt(e,"string");return Fv(t)=="symbol"?t:t+""}function smt(e,t){if(Fv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Fv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function uU(){return uU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},uU.apply(this,arguments)}var amt=function(t){var n=t.yAxisId,i=Xpe(),a=Jpe(),l=qpe(n);return l==null?null:se.createElement(rx,uU({},l,{className:un("recharts-".concat(l.axisType," ").concat(l.axisType),l.className),viewBox:{x:0,y:0,width:i,height:a},ticksGenerator:function(f){return Zf(f,!0)}}))},XS=function(e){function t(){return Zpt(this,t),nmt(this,t,arguments)}return omt(t,e),tmt(t,[{key:"render",value:function(){return se.createElement(amt,this.props)}}])}(se.Component);dme(XS,"displayName","YAxis");dme(XS,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function Pne(e){return dmt(e)||umt(e)||lmt(e)||cmt()}function cmt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lmt(e,t){if(e){if(typeof e=="string")return dU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dU(e,t)}}function umt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function dmt(e){if(Array.isArray(e))return dU(e)}function dU(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var hU=function(t,n,i,a,l){var d=Ba(t,BB),f=Ba(t,ex),m=[].concat(Pne(d),Pne(f)),v=Ba(t,nx),E="".concat(a,"Id"),S=a[0],T=n;if(m.length&&(T=m.reduce(function(O,P){if(P.props[E]===i&&Il(P.props,"extendDomain")&&rt(P.props[S])){var D=P.props[S];return[Math.min(O[0],D),Math.max(O[1],D)]}return O},T)),v.length){var R="".concat(S,"1"),I="".concat(S,"2");T=v.reduce(function(O,P){if(P.props[E]===i&&Il(P.props,"extendDomain")&&rt(P.props[R])&&rt(P.props[I])){var D=P.props[R],k=P.props[I];return[Math.min(O[0],D,k),Math.max(O[1],D,k)]}return O},T)}return l&&l.length&&(T=l.reduce(function(O,P){return rt(P)?[Math.min(O[0],P),Math.max(O[1],P)]:O},T)),T},fme={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function a(m,v,E){this.fn=m,this.context=v,this.once=E||!1}function l(m,v,E,S,T){if(typeof E!="function")throw new TypeError("The listener must be a function");var R=new a(E,S||m,T),I=n?n+v:v;return m._events[I]?m._events[I].fn?m._events[I]=[m._events[I],R]:m._events[I].push(R):(m._events[I]=R,m._eventsCount++),m}function d(m,v){--m._eventsCount===0?m._events=new i:delete m._events[v]}function f(){this._events=new i,this._eventsCount=0}f.prototype.eventNames=function(){var v=[],E,S;if(this._eventsCount===0)return v;for(S in E=this._events)t.call(E,S)&&v.push(n?S.slice(1):S);return Object.getOwnPropertySymbols?v.concat(Object.getOwnPropertySymbols(E)):v},f.prototype.listeners=function(v){var E=n?n+v:v,S=this._events[E];if(!S)return[];if(S.fn)return[S.fn];for(var T=0,R=S.length,I=new Array(R);T<R;T++)I[T]=S[T].fn;return I},f.prototype.listenerCount=function(v){var E=n?n+v:v,S=this._events[E];return S?S.fn?1:S.length:0},f.prototype.emit=function(v,E,S,T,R,I){var O=n?n+v:v;if(!this._events[O])return!1;var P=this._events[O],D=arguments.length,k,M;if(P.fn){switch(P.once&&this.removeListener(v,P.fn,void 0,!0),D){case 1:return P.fn.call(P.context),!0;case 2:return P.fn.call(P.context,E),!0;case 3:return P.fn.call(P.context,E,S),!0;case 4:return P.fn.call(P.context,E,S,T),!0;case 5:return P.fn.call(P.context,E,S,T,R),!0;case 6:return P.fn.call(P.context,E,S,T,R,I),!0}for(M=1,k=new Array(D-1);M<D;M++)k[M-1]=arguments[M];P.fn.apply(P.context,k)}else{var $=P.length,V;for(M=0;M<$;M++)switch(P[M].once&&this.removeListener(v,P[M].fn,void 0,!0),D){case 1:P[M].fn.call(P[M].context);break;case 2:P[M].fn.call(P[M].context,E);break;case 3:P[M].fn.call(P[M].context,E,S);break;case 4:P[M].fn.call(P[M].context,E,S,T);break;default:if(!k)for(V=1,k=new Array(D-1);V<D;V++)k[V-1]=arguments[V];P[M].fn.apply(P[M].context,k)}}return!0},f.prototype.on=function(v,E,S){return l(this,v,E,S,!1)},f.prototype.once=function(v,E,S){return l(this,v,E,S,!0)},f.prototype.removeListener=function(v,E,S,T){var R=n?n+v:v;if(!this._events[R])return this;if(!E)return d(this,R),this;var I=this._events[R];if(I.fn)I.fn===E&&(!T||I.once)&&(!S||I.context===S)&&d(this,R);else{for(var O=0,P=[],D=I.length;O<D;O++)(I[O].fn!==E||T&&!I[O].once||S&&I[O].context!==S)&&P.push(I[O]);P.length?this._events[R]=P.length===1?P[0]:P:d(this,R)}return this},f.prototype.removeAllListeners=function(v){var E;return v?(E=n?n+v:v,this._events[E]&&d(this,E)):(this._events=new i,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=n,f.EventEmitter=f,e.exports=f})(fme);var hmt=fme.exports;const fmt=zn(hmt);var $L=new fmt,WL="recharts.syncMouseEvents";function gS(e){"@babel/helpers - typeof";return gS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gS(e)}function pmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mmt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,pme(i.key),i)}}function gmt(e,t,n){return t&&mmt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function GL(e,t,n){return t=pme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pme(e){var t=vmt(e,"string");return gS(t)=="symbol"?t:t+""}function vmt(e,t){if(gS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(gS(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ymt=function(){function e(){pmt(this,e),GL(this,"activeIndex",0),GL(this,"coordinateList",[]),GL(this,"layout","horizontal")}return gmt(e,[{key:"setDetails",value:function(n){var i,a=n.coordinateList,l=a===void 0?null:a,d=n.container,f=d===void 0?null:d,m=n.layout,v=m===void 0?null:m,E=n.offset,S=E===void 0?null:E,T=n.mouseHandlerCallback,R=T===void 0?null:T;this.coordinateList=(i=l??this.coordinateList)!==null&&i!==void 0?i:[],this.container=f??this.container,this.layout=v??this.layout,this.offset=S??this.offset,this.mouseHandlerCallback=R??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,i;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),l=a.x,d=a.y,f=a.height,m=this.coordinateList[this.activeIndex].coordinate,v=((n=window)===null||n===void 0?void 0:n.scrollX)||0,E=((i=window)===null||i===void 0?void 0:i.scrollY)||0,S=l+m+v,T=d+this.offset.top+f/2+E;this.mouseHandlerCallback({pageX:S,pageY:T})}}}])}();function _mt(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var i=e==null?void 0:e[0],a=e==null?void 0:e[1];if(i&&a&&rt(i)&&rt(a))return!0}return!1}function Emt(e,t,n,i){var a=i/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-a,width:e==="horizontal"?i:n.width-1,height:e==="horizontal"?n.height-1:i}}function mme(e){var t=e.cx,n=e.cy,i=e.radius,a=e.startAngle,l=e.endAngle,d=wr(t,n,i,a),f=wr(t,n,i,l);return{points:[d,f],cx:t,cy:n,radius:i,startAngle:a,endAngle:l}}function bmt(e,t,n){var i,a,l,d;if(e==="horizontal")i=t.x,l=i,a=n.top,d=n.top+n.height;else if(e==="vertical")a=t.y,d=a,i=n.left,l=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var f=t.cx,m=t.cy,v=t.innerRadius,E=t.outerRadius,S=t.angle,T=wr(f,m,v,S),R=wr(f,m,E,S);i=T.x,a=T.y,l=R.x,d=R.y}else return mme(t);return[{x:i,y:a},{x:l,y:d}]}function vS(e){"@babel/helpers - typeof";return vS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vS(e)}function Nne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function KC(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Nne(Object(n),!0).forEach(function(i){Smt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Smt(e,t,n){return t=wmt(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wmt(e){var t=Tmt(e,"string");return vS(t)=="symbol"?t:t+""}function Tmt(e,t){if(vS(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(vS(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cmt(e){var t,n,i=e.element,a=e.tooltipEventType,l=e.isActive,d=e.activeCoordinate,f=e.activePayload,m=e.offset,v=e.activeTooltipIndex,E=e.tooltipAxisBandSize,S=e.layout,T=e.chartName,R=(t=i.props.cursor)!==null&&t!==void 0?t:(n=i.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!i||!R||!l||!d||T!=="ScatterChart"&&a!=="axis")return null;var I,O=Lj;if(T==="ScatterChart")I=d,O=Put;else if(T==="BarChart")I=Emt(S,d,m,E),O=jB;else if(S==="radial"){var P=mme(d),D=P.cx,k=P.cy,M=P.radius,$=P.startAngle,V=P.endAngle;I={cx:D,cy:k,startAngle:$,endAngle:V,innerRadius:M,outerRadius:M},O=ppe}else I={points:bmt(S,d,m)},O=Lj;var W=KC(KC(KC(KC({stroke:"#ccc",pointerEvents:"none"},m),I),Vt(R,!1)),{},{payload:f,payloadIndex:v,className:un("recharts-tooltip-cursor",R.className)});return N.isValidElement(R)?N.cloneElement(R,W):N.createElement(O,W)}var Rmt=["item"],Amt=["children","className","width","height","style","compact","title","desc"];function Bv(e){"@babel/helpers - typeof";return Bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bv(e)}function Mg(){return Mg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Mg.apply(this,arguments)}function Dne(e,t){return xmt(e)||Imt(e,t)||vme(e,t)||Omt()}function Omt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Imt(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,a,l,d,f=[],m=!0,v=!1;try{if(l=(n=n.call(e)).next,t!==0)for(;!(m=(i=l.call(n)).done)&&(f.push(i.value),f.length!==t);m=!0);}catch(E){v=!0,a=E}finally{try{if(!m&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(v)throw a}}return f}}function xmt(e){if(Array.isArray(e))return e}function kne(e,t){if(e==null)return{};var n=Pmt(e,t),i,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)i=l[a],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function Pmt(e,t){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(t.indexOf(i)>=0)continue;n[i]=e[i]}return n}function Nmt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dmt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,yme(i.key),i)}}function kmt(e,t,n){return t&&Dmt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lmt(e,t,n){return t=tO(t),Mmt(e,gme()?Reflect.construct(t,n||[],tO(e).constructor):t.apply(e,n))}function Mmt(e,t){if(t&&(Bv(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jmt(e)}function jmt(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gme(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gme=function(){return!!e})()}function tO(e){return tO=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},tO(e)}function Umt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fU(e,t)}function fU(e,t){return fU=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,a){return i.__proto__=a,i},fU(e,t)}function $v(e){return Bmt(e)||Fmt(e)||vme(e)||Vmt()}function Vmt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vme(e,t){if(e){if(typeof e=="string")return pU(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pU(e,t)}}function Fmt(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Bmt(e){if(Array.isArray(e))return pU(e)}function pU(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Lne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Lne(Object(n),!0).forEach(function(i){kt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lne(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function kt(e,t,n){return t=yme(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yme(e){var t=$mt(e,"string");return Bv(t)=="symbol"?t:t+""}function $mt(e,t){if(Bv(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(Bv(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wmt={xAxis:["bottom","top"],yAxis:["left","right"]},Gmt={width:"100%",height:"100%"},_me={x:0,y:0};function zC(e){return e}var Hmt=function(t,n){return n==="horizontal"?t.x:n==="vertical"?t.y:n==="centric"?t.angle:t.radius},Kmt=function(t,n,i,a){var l=n.find(function(E){return E&&E.index===i});if(l){if(t==="horizontal")return{x:l.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:l.coordinate};if(t==="centric"){var d=l.coordinate,f=a.radius;return Le(Le(Le({},a),wr(a.cx,a.cy,f,d)),{},{angle:d,radius:f})}var m=l.coordinate,v=a.angle;return Le(Le(Le({},a),wr(a.cx,a.cy,m,v)),{},{angle:v,radius:m})}return _me},ix=function(t,n){var i=n.graphicalItems,a=n.dataStartIndex,l=n.dataEndIndex,d=(i??[]).reduce(function(f,m){var v=m.props.data;return v&&v.length?[].concat($v(f),$v(v)):f},[]);return d.length>0?d:t&&t.length&&rt(a)&&rt(l)?t.slice(a,l+1):[]};function Eme(e){return e==="number"?[0,"auto"]:void 0}var mU=function(t,n,i,a){var l=t.graphicalItems,d=t.tooltipAxis,f=ix(n,t);return i<0||!l||!l.length||i>=f.length?null:l.reduce(function(m,v){var E,S=(E=v.props.data)!==null&&E!==void 0?E:n;S&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=i&&(S=S.slice(t.dataStartIndex,t.dataEndIndex+1));var T;if(d.dataKey&&!d.allowDuplicatedCategory){var R=S===void 0?f:S;T=W2(R,d.dataKey,a)}else T=S&&S[i]||f[i];return T?[].concat($v(m),[cpe(v,T)]):m},[])},Mne=function(t,n,i,a){var l=a||{x:t.chartX,y:t.chartY},d=Hmt(l,i),f=t.orderedTooltipTicks,m=t.tooltipAxis,v=t.tooltipTicks,E=tat(d,f,v,m);if(E>=0&&v){var S=v[E]&&v[E].value,T=mU(t,n,E,S),R=Kmt(i,f,E,l);return{activeTooltipIndex:E,activeLabel:S,activePayload:T,activeCoordinate:R}}return null},zmt=function(t,n){var i=n.axes,a=n.graphicalItems,l=n.axisType,d=n.axisIdKey,f=n.stackGroups,m=n.dataStartIndex,v=n.dataEndIndex,E=t.layout,S=t.children,T=t.stackOffset,R=rpe(E,l);return i.reduce(function(I,O){var P,D=O.type.defaultProps!==void 0?Le(Le({},O.type.defaultProps),O.props):O.props,k=D.type,M=D.dataKey,$=D.allowDataOverflow,V=D.allowDuplicatedCategory,W=D.scale,H=D.ticks,J=D.includeHidden,ee=D[d];if(I[ee])return I;var le=ix(t.data,{graphicalItems:a.filter(function(Ie){var Ge,Ze=d in Ie.props?Ie.props[d]:(Ge=Ie.type.defaultProps)===null||Ge===void 0?void 0:Ge[d];return Ze===ee}),dataStartIndex:m,dataEndIndex:v}),he=le.length,de,ae,ce;_mt(D.domain,$,k)&&(de=xj(D.domain,null,$),R&&(k==="number"||W!=="auto")&&(ce=ZE(le,M,"category")));var ge=Eme(k);if(!de||de.length===0){var ye,te=(ye=D.domain)!==null&&ye!==void 0?ye:ge;if(M){if(de=ZE(le,M,k),k==="category"&&R){var ne=$ze(de);V&&ne?(ae=de,de=WA(0,he)):V||(de=dte(te,de,O).reduce(function(Ie,Ge){return Ie.indexOf(Ge)>=0?Ie:[].concat($v(Ie),[Ge])},[]))}else if(k==="category")V?de=de.filter(function(Ie){return Ie!==""&&!En(Ie)}):de=dte(te,de,O).reduce(function(Ie,Ge){return Ie.indexOf(Ge)>=0||Ge===""||En(Ge)?Ie:[].concat($v(Ie),[Ge])},[]);else if(k==="number"){var ue=sat(le,a.filter(function(Ie){var Ge,Ze,wt=d in Ie.props?Ie.props[d]:(Ge=Ie.type.defaultProps)===null||Ge===void 0?void 0:Ge[d],Ft="hide"in Ie.props?Ie.props.hide:(Ze=Ie.type.defaultProps)===null||Ze===void 0?void 0:Ze.hide;return wt===ee&&(J||!Ft)}),M,l,E);ue&&(de=ue)}R&&(k==="number"||W!=="auto")&&(ce=ZE(le,M,"category"))}else R?de=WA(0,he):f&&f[ee]&&f[ee].hasStack&&k==="number"?de=T==="expand"?[0,1]:ape(f[ee].stackGroups,m,v):de=npe(le,a.filter(function(Ie){var Ge=d in Ie.props?Ie.props[d]:Ie.type.defaultProps[d],Ze="hide"in Ie.props?Ie.props.hide:Ie.type.defaultProps.hide;return Ge===ee&&(J||!Ze)}),k,E,!0);if(k==="number")de=hU(S,de,ee,l,H),te&&(de=xj(te,de,$));else if(k==="category"&&te){var _e=te,Ce=de.every(function(Ie){return _e.indexOf(Ie)>=0});Ce&&(de=_e)}}return Le(Le({},I),{},kt({},ee,Le(Le({},D),{},{axisType:l,domain:de,categoricalDomain:ce,duplicateDomain:ae,originalDomain:(P=D.domain)!==null&&P!==void 0?P:ge,isCategorical:R,layout:E})))},{})},Ymt=function(t,n){var i=n.graphicalItems,a=n.Axis,l=n.axisType,d=n.axisIdKey,f=n.stackGroups,m=n.dataStartIndex,v=n.dataEndIndex,E=t.layout,S=t.children,T=ix(t.data,{graphicalItems:i,dataStartIndex:m,dataEndIndex:v}),R=T.length,I=rpe(E,l),O=-1;return i.reduce(function(P,D){var k=D.type.defaultProps!==void 0?Le(Le({},D.type.defaultProps),D.props):D.props,M=k[d],$=Eme("number");if(!P[M]){O++;var V;return I?V=WA(0,R):f&&f[M]&&f[M].hasStack?(V=ape(f[M].stackGroups,m,v),V=hU(S,V,M,l)):(V=xj($,npe(T,i.filter(function(W){var H,J,ee=d in W.props?W.props[d]:(H=W.type.defaultProps)===null||H===void 0?void 0:H[d],le="hide"in W.props?W.props.hide:(J=W.type.defaultProps)===null||J===void 0?void 0:J.hide;return ee===M&&!le}),"number",E),a.defaultProps.allowDataOverflow),V=hU(S,V,M,l)),Le(Le({},P),{},kt({},M,Le(Le({axisType:l},a.defaultProps),{},{hide:!0,orientation:qs(Wmt,"".concat(l,".").concat(O%2),null),domain:V,originalDomain:$,isCategorical:I,layout:E})))}return P},{})},qmt=function(t,n){var i=n.axisType,a=i===void 0?"xAxis":i,l=n.AxisComp,d=n.graphicalItems,f=n.stackGroups,m=n.dataStartIndex,v=n.dataEndIndex,E=t.children,S="".concat(a,"Id"),T=Ba(E,l),R={};return T&&T.length?R=zmt(t,{axes:T,graphicalItems:d,axisType:a,axisIdKey:S,stackGroups:f,dataStartIndex:m,dataEndIndex:v}):d&&d.length&&(R=Ymt(t,{Axis:l,graphicalItems:d,axisType:a,axisIdKey:S,stackGroups:f,dataStartIndex:m,dataEndIndex:v})),R},Xmt=function(t){var n=fg(t),i=Zf(n,!1,!0);return{tooltipTicks:i,orderedTooltipTicks:lB(i,function(a){return a.coordinate}),tooltipAxis:n,tooltipAxisBandSize:PA(n,i)}},jne=function(t){var n=t.children,i=t.defaultShowTooltip,a=$s(n,Dv),l=0,d=0;return t.data&&t.data.length!==0&&(d=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(l=a.props.startIndex),a.props.endIndex>=0&&(d=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:l,dataEndIndex:d,activeTooltipIndex:-1,isTooltipActive:!!i}},Jmt=function(t){return!t||!t.length?!1:t.some(function(n){var i=xu(n&&n.type);return i&&i.indexOf("Bar")>=0})},Une=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Qmt=function(t,n){var i=t.props,a=t.graphicalItems,l=t.xAxisMap,d=l===void 0?{}:l,f=t.yAxisMap,m=f===void 0?{}:f,v=i.width,E=i.height,S=i.children,T=i.margin||{},R=$s(S,Dv),I=$s(S,ph),O=Object.keys(m).reduce(function(V,W){var H=m[W],J=H.orientation;return!H.mirror&&!H.hide?Le(Le({},V),{},kt({},J,V[J]+H.width)):V},{left:T.left||0,right:T.right||0}),P=Object.keys(d).reduce(function(V,W){var H=d[W],J=H.orientation;return!H.mirror&&!H.hide?Le(Le({},V),{},kt({},J,qs(V,"".concat(J))+H.height)):V},{top:T.top||0,bottom:T.bottom||0}),D=Le(Le({},P),O),k=D.bottom;R&&(D.bottom+=R.props.height||Dv.defaultProps.height),I&&n&&(D=iat(D,a,i,n));var M=v-D.left-D.right,$=E-D.top-D.bottom;return Le(Le({brushBottom:k},D),{},{width:Math.max(M,0),height:Math.max($,0)})},Zmt=function(t,n){if(n==="xAxis")return t[n].width;if(n==="yAxis")return t[n].height},bme=function(t){var n=t.chartName,i=t.GraphicalChild,a=t.defaultTooltipEventType,l=a===void 0?"axis":a,d=t.validateTooltipEventTypes,f=d===void 0?["axis"]:d,m=t.axisComponents,v=t.legendContent,E=t.formatAxisMap,S=t.defaultProps,T=function(D,k){var M=k.graphicalItems,$=k.stackGroups,V=k.offset,W=k.updateId,H=k.dataStartIndex,J=k.dataEndIndex,ee=D.barSize,le=D.layout,he=D.barGap,de=D.barCategoryGap,ae=D.maxBarSize,ce=Une(le),ge=ce.numericAxisName,ye=ce.cateAxisName,te=Jmt(M),ne=[];return M.forEach(function(ue,_e){var Ce=ix(D.data,{graphicalItems:[ue],dataStartIndex:H,dataEndIndex:J}),Ie=ue.type.defaultProps!==void 0?Le(Le({},ue.type.defaultProps),ue.props):ue.props,Ge=Ie.dataKey,Ze=Ie.maxBarSize,wt=Ie["".concat(ge,"Id")],Ft=Ie["".concat(ye,"Id")],ze={},Nt=m.reduce(function(Ji,na){var Yo=k["".concat(na.axisType,"Map")],ni=Ie["".concat(na.axisType,"Id")];Yo&&Yo[ni]||na.axisType==="zAxis"||Cp();var Fh=Yo[ni];return Le(Le({},Ji),{},kt(kt({},na.axisType,Fh),"".concat(na.axisType,"Ticks"),Zf(Fh)))},ze),we=Nt[ye],He=Nt["".concat(ye,"Ticks")],Ke=$&&$[wt]&&$[wt].hasStack&&mat(ue,$[wt].stackGroups),Re=xu(ue.type).indexOf("Bar")>=0,at=PA(we,He),mt=[],At=te&&nat({barSize:ee,stackGroups:$,totalSize:Zmt(Nt,ye)});if(Re){var nn,Mr,Mn=En(Ze)?ae:Ze,ar=(nn=(Mr=PA(we,He,!0))!==null&&Mr!==void 0?Mr:Mn)!==null&&nn!==void 0?nn:0;mt=rat({barGap:he,barCategoryGap:de,bandSize:ar!==at?ar:at,sizeList:At[Ft],maxBarSize:Mn}),ar!==at&&(mt=mt.map(function(Ji){return Le(Le({},Ji),{},{position:Le(Le({},Ji.position),{},{offset:Ji.position.offset-ar/2})})}))}var Ya=ue&&ue.type&&ue.type.getComposedData;Ya&&ne.push({props:Le(Le({},Ya(Le(Le({},Nt),{},{displayedData:Ce,props:D,dataKey:Ge,item:ue,bandSize:at,barPosition:mt,offset:V,stackedData:Ke,layout:le,dataStartIndex:H,dataEndIndex:J}))),{},kt(kt(kt({key:ue.key||"item-".concat(_e)},ge,Nt[ge]),ye,Nt[ye]),"animationId",W)),childIndex:eYe(ue,D.children),item:ue})}),ne},R=function(D,k){var M=D.props,$=D.dataStartIndex,V=D.dataEndIndex,W=D.updateId;if(!oZ({props:M}))return null;var H=M.children,J=M.layout,ee=M.stackOffset,le=M.data,he=M.reverseStackOrder,de=Une(J),ae=de.numericAxisName,ce=de.cateAxisName,ge=Ba(H,i),ye=fat(le,ge,"".concat(ae,"Id"),"".concat(ce,"Id"),ee,he),te=m.reduce(function(Ie,Ge){var Ze="".concat(Ge.axisType,"Map");return Le(Le({},Ie),{},kt({},Ze,qmt(M,Le(Le({},Ge),{},{graphicalItems:ge,stackGroups:Ge.axisType===ae&&ye,dataStartIndex:$,dataEndIndex:V}))))},{}),ne=Qmt(Le(Le({},te),{},{props:M,graphicalItems:ge}),k==null?void 0:k.legendBBox);Object.keys(te).forEach(function(Ie){te[Ie]=E(M,te[Ie],ne,Ie.replace("Map",""),n)});var ue=te["".concat(ce,"Map")],_e=Xmt(ue),Ce=T(M,Le(Le({},te),{},{dataStartIndex:$,dataEndIndex:V,updateId:W,graphicalItems:ge,stackGroups:ye,offset:ne}));return Le(Le({formattedGraphicalItems:Ce,graphicalItems:ge,offset:ne,stackGroups:ye},_e),te)},I=function(P){function D(k){var M,$,V;return Nmt(this,D),V=Lmt(this,D,[k]),kt(V,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),kt(V,"accessibilityManager",new ymt),kt(V,"handleLegendBBoxUpdate",function(W){if(W){var H=V.state,J=H.dataStartIndex,ee=H.dataEndIndex,le=H.updateId;V.setState(Le({legendBBox:W},R({props:V.props,dataStartIndex:J,dataEndIndex:ee,updateId:le},Le(Le({},V.state),{},{legendBBox:W}))))}}),kt(V,"handleReceiveSyncEvent",function(W,H,J){if(V.props.syncId===W){if(J===V.eventEmitterSymbol&&typeof V.props.syncMethod!="function")return;V.applySyncEvent(H)}}),kt(V,"handleBrushChange",function(W){var H=W.startIndex,J=W.endIndex;if(H!==V.state.dataStartIndex||J!==V.state.dataEndIndex){var ee=V.state.updateId;V.setState(function(){return Le({dataStartIndex:H,dataEndIndex:J},R({props:V.props,dataStartIndex:H,dataEndIndex:J,updateId:ee},V.state))}),V.triggerSyncEvent({dataStartIndex:H,dataEndIndex:J})}}),kt(V,"handleMouseEnter",function(W){var H=V.getMouseInfo(W);if(H){var J=Le(Le({},H),{},{isTooltipActive:!0});V.setState(J),V.triggerSyncEvent(J);var ee=V.props.onMouseEnter;Xt(ee)&&ee(J,W)}}),kt(V,"triggeredAfterMouseMove",function(W){var H=V.getMouseInfo(W),J=H?Le(Le({},H),{},{isTooltipActive:!0}):{isTooltipActive:!1};V.setState(J),V.triggerSyncEvent(J);var ee=V.props.onMouseMove;Xt(ee)&&ee(J,W)}),kt(V,"handleItemMouseEnter",function(W){V.setState(function(){return{isTooltipActive:!0,activeItem:W,activePayload:W.tooltipPayload,activeCoordinate:W.tooltipPosition||{x:W.cx,y:W.cy}}})}),kt(V,"handleItemMouseLeave",function(){V.setState(function(){return{isTooltipActive:!1}})}),kt(V,"handleMouseMove",function(W){W.persist(),V.throttleTriggeredAfterMouseMove(W)}),kt(V,"handleMouseLeave",function(W){V.throttleTriggeredAfterMouseMove.cancel();var H={isTooltipActive:!1};V.setState(H),V.triggerSyncEvent(H);var J=V.props.onMouseLeave;Xt(J)&&J(H,W)}),kt(V,"handleOuterEvent",function(W){var H=Zze(W),J=qs(V.props,"".concat(H));if(H&&Xt(J)){var ee,le;/.*touch.*/i.test(H)?le=V.getMouseInfo(W.changedTouches[0]):le=V.getMouseInfo(W),J((ee=le)!==null&&ee!==void 0?ee:{},W)}}),kt(V,"handleClick",function(W){var H=V.getMouseInfo(W);if(H){var J=Le(Le({},H),{},{isTooltipActive:!0});V.setState(J),V.triggerSyncEvent(J);var ee=V.props.onClick;Xt(ee)&&ee(J,W)}}),kt(V,"handleMouseDown",function(W){var H=V.props.onMouseDown;if(Xt(H)){var J=V.getMouseInfo(W);H(J,W)}}),kt(V,"handleMouseUp",function(W){var H=V.props.onMouseUp;if(Xt(H)){var J=V.getMouseInfo(W);H(J,W)}}),kt(V,"handleTouchMove",function(W){W.changedTouches!=null&&W.changedTouches.length>0&&V.throttleTriggeredAfterMouseMove(W.changedTouches[0])}),kt(V,"handleTouchStart",function(W){W.changedTouches!=null&&W.changedTouches.length>0&&V.handleMouseDown(W.changedTouches[0])}),kt(V,"handleTouchEnd",function(W){W.changedTouches!=null&&W.changedTouches.length>0&&V.handleMouseUp(W.changedTouches[0])}),kt(V,"handleDoubleClick",function(W){var H=V.props.onDoubleClick;if(Xt(H)){var J=V.getMouseInfo(W);H(J,W)}}),kt(V,"handleContextMenu",function(W){var H=V.props.onContextMenu;if(Xt(H)){var J=V.getMouseInfo(W);H(J,W)}}),kt(V,"triggerSyncEvent",function(W){V.props.syncId!==void 0&&$L.emit(WL,V.props.syncId,W,V.eventEmitterSymbol)}),kt(V,"applySyncEvent",function(W){var H=V.props,J=H.layout,ee=H.syncMethod,le=V.state.updateId,he=W.dataStartIndex,de=W.dataEndIndex;if(W.dataStartIndex!==void 0||W.dataEndIndex!==void 0)V.setState(Le({dataStartIndex:he,dataEndIndex:de},R({props:V.props,dataStartIndex:he,dataEndIndex:de,updateId:le},V.state)));else if(W.activeTooltipIndex!==void 0){var ae=W.chartX,ce=W.chartY,ge=W.activeTooltipIndex,ye=V.state,te=ye.offset,ne=ye.tooltipTicks;if(!te)return;if(typeof ee=="function")ge=ee(ne,W);else if(ee==="value"){ge=-1;for(var ue=0;ue<ne.length;ue++)if(ne[ue].value===W.activeLabel){ge=ue;break}}var _e=Le(Le({},te),{},{x:te.left,y:te.top}),Ce=Math.min(ae,_e.x+_e.width),Ie=Math.min(ce,_e.y+_e.height),Ge=ne[ge]&&ne[ge].value,Ze=mU(V.state,V.props.data,ge),wt=ne[ge]?{x:J==="horizontal"?ne[ge].coordinate:Ce,y:J==="horizontal"?Ie:ne[ge].coordinate}:_me;V.setState(Le(Le({},W),{},{activeLabel:Ge,activeCoordinate:wt,activePayload:Ze,activeTooltipIndex:ge}))}else V.setState(W)}),kt(V,"renderCursor",function(W){var H,J=V.state,ee=J.isTooltipActive,le=J.activeCoordinate,he=J.activePayload,de=J.offset,ae=J.activeTooltipIndex,ce=J.tooltipAxisBandSize,ge=V.getTooltipEventType(),ye=(H=W.props.active)!==null&&H!==void 0?H:ee,te=V.props.layout,ne=W.key||"_recharts-cursor";return se.createElement(Cmt,{key:ne,activeCoordinate:le,activePayload:he,activeTooltipIndex:ae,chartName:n,element:W,isActive:ye,layout:te,offset:de,tooltipAxisBandSize:ce,tooltipEventType:ge})}),kt(V,"renderPolarAxis",function(W,H,J){var ee=qs(W,"type.axisType"),le=qs(V.state,"".concat(ee,"Map")),he=W.type.defaultProps,de=he!==void 0?Le(Le({},he),W.props):W.props,ae=le&&le[de["".concat(ee,"Id")]];return N.cloneElement(W,Le(Le({},ae),{},{className:un(ee,ae.className),key:W.key||"".concat(H,"-").concat(J),ticks:Zf(ae,!0)}))}),kt(V,"renderPolarGrid",function(W){var H=W.props,J=H.radialLines,ee=H.polarAngles,le=H.polarRadius,he=V.state,de=he.radiusAxisMap,ae=he.angleAxisMap,ce=fg(de),ge=fg(ae),ye=ge.cx,te=ge.cy,ne=ge.innerRadius,ue=ge.outerRadius;return N.cloneElement(W,{polarAngles:Array.isArray(ee)?ee:Zf(ge,!0).map(function(_e){return _e.coordinate}),polarRadius:Array.isArray(le)?le:Zf(ce,!0).map(function(_e){return _e.coordinate}),cx:ye,cy:te,innerRadius:ne,outerRadius:ue,key:W.key||"polar-grid",radialLines:J})}),kt(V,"renderLegend",function(){var W=V.state.formattedGraphicalItems,H=V.props,J=H.children,ee=H.width,le=H.height,he=V.props.margin||{},de=ee-(he.left||0)-(he.right||0),ae=epe({children:J,formattedGraphicalItems:W,legendWidth:de,legendContent:v});if(!ae)return null;var ce=ae.item,ge=kne(ae,Rmt);return N.cloneElement(ce,Le(Le({},ge),{},{chartWidth:ee,chartHeight:le,margin:he,onBBoxUpdate:V.handleLegendBBoxUpdate}))}),kt(V,"renderTooltip",function(){var W,H=V.props,J=H.children,ee=H.accessibilityLayer,le=$s(J,Na);if(!le)return null;var he=V.state,de=he.isTooltipActive,ae=he.activeCoordinate,ce=he.activePayload,ge=he.activeLabel,ye=he.offset,te=(W=le.props.active)!==null&&W!==void 0?W:de;return N.cloneElement(le,{viewBox:Le(Le({},ye),{},{x:ye.left,y:ye.top}),active:te,label:ge,payload:te?ce:[],coordinate:ae,accessibilityLayer:ee})}),kt(V,"renderBrush",function(W){var H=V.props,J=H.margin,ee=H.data,le=V.state,he=le.offset,de=le.dataStartIndex,ae=le.dataEndIndex,ce=le.updateId;return N.cloneElement(W,{key:W.key||"_recharts-brush",onChange:$C(V.handleBrushChange,W.props.onChange),data:ee,x:rt(W.props.x)?W.props.x:he.left,y:rt(W.props.y)?W.props.y:he.top+he.height+he.brushBottom-(J.bottom||0),width:rt(W.props.width)?W.props.width:he.width,startIndex:de,endIndex:ae,updateId:"brush-".concat(ce)})}),kt(V,"renderReferenceElement",function(W,H,J){if(!W)return null;var ee=V,le=ee.clipPathId,he=V.state,de=he.xAxisMap,ae=he.yAxisMap,ce=he.offset,ge=W.type.defaultProps||{},ye=W.props,te=ye.xAxisId,ne=te===void 0?ge.xAxisId:te,ue=ye.yAxisId,_e=ue===void 0?ge.yAxisId:ue;return N.cloneElement(W,{key:W.key||"".concat(H,"-").concat(J),xAxis:de[ne],yAxis:ae[_e],viewBox:{x:ce.left,y:ce.top,width:ce.width,height:ce.height},clipPathId:le})}),kt(V,"renderActivePoints",function(W){var H=W.item,J=W.activePoint,ee=W.basePoint,le=W.childIndex,he=W.isRange,de=[],ae=H.props.key,ce=H.item.type.defaultProps!==void 0?Le(Le({},H.item.type.defaultProps),H.item.props):H.item.props,ge=ce.activeDot,ye=ce.dataKey,te=Le(Le({index:le,dataKey:ye,cx:J.x,cy:J.y,r:4,fill:MB(H.item),strokeWidth:2,stroke:"#fff",payload:J.payload,value:J.value},Vt(ge,!1)),iA(ge));return de.push(D.renderActiveDot(ge,te,"".concat(ae,"-activePoint-").concat(le))),ee?de.push(D.renderActiveDot(ge,Le(Le({},te),{},{cx:ee.x,cy:ee.y}),"".concat(ae,"-basePoint-").concat(le))):he&&de.push(null),de}),kt(V,"renderGraphicChild",function(W,H,J){var ee=V.filterFormatItem(W,H,J);if(!ee)return null;var le=V.getTooltipEventType(),he=V.state,de=he.isTooltipActive,ae=he.tooltipAxis,ce=he.activeTooltipIndex,ge=he.activeLabel,ye=V.props.children,te=$s(ye,Na),ne=ee.props,ue=ne.points,_e=ne.isRange,Ce=ne.baseLine,Ie=ee.item.type.defaultProps!==void 0?Le(Le({},ee.item.type.defaultProps),ee.item.props):ee.item.props,Ge=Ie.activeDot,Ze=Ie.hide,wt=Ie.activeBar,Ft=Ie.activeShape,ze=!!(!Ze&&de&&te&&(Ge||wt||Ft)),Nt={};le!=="axis"&&te&&te.props.trigger==="click"?Nt={onClick:$C(V.handleItemMouseEnter,W.props.onClick)}:le!=="axis"&&(Nt={onMouseLeave:$C(V.handleItemMouseLeave,W.props.onMouseLeave),onMouseEnter:$C(V.handleItemMouseEnter,W.props.onMouseEnter)});var we=N.cloneElement(W,Le(Le({},ee.props),Nt));function He(na){return typeof ae.dataKey=="function"?ae.dataKey(na.payload):null}if(ze)if(ce>=0){var Ke,Re;if(ae.dataKey&&!ae.allowDuplicatedCategory){var at=typeof ae.dataKey=="function"?He:"payload.".concat(ae.dataKey.toString());Ke=W2(ue,at,ge),Re=_e&&Ce&&W2(Ce,at,ge)}else Ke=ue==null?void 0:ue[ce],Re=_e&&Ce&&Ce[ce];if(Ft||wt){var mt=W.props.activeIndex!==void 0?W.props.activeIndex:ce;return[N.cloneElement(W,Le(Le(Le({},ee.props),Nt),{},{activeIndex:mt})),null,null]}if(!En(Ke))return[we].concat($v(V.renderActivePoints({item:ee,activePoint:Ke,basePoint:Re,childIndex:ce,isRange:_e})))}else{var At,nn=(At=V.getItemByXY(V.state.activeCoordinate))!==null&&At!==void 0?At:{graphicalItem:we},Mr=nn.graphicalItem,Mn=Mr.item,ar=Mn===void 0?W:Mn,Ya=Mr.childIndex,Ji=Le(Le(Le({},ee.props),Nt),{},{activeIndex:Ya});return[N.cloneElement(ar,Ji),null,null]}return _e?[we,null,null]:[we,null]}),kt(V,"renderCustomized",function(W,H,J){return N.cloneElement(W,Le(Le({key:"recharts-customized-".concat(J)},V.props),V.state))}),kt(V,"renderMap",{CartesianGrid:{handler:zC,once:!0},ReferenceArea:{handler:V.renderReferenceElement},ReferenceLine:{handler:zC},ReferenceDot:{handler:V.renderReferenceElement},XAxis:{handler:zC},YAxis:{handler:zC},Brush:{handler:V.renderBrush,once:!0},Bar:{handler:V.renderGraphicChild},Line:{handler:V.renderGraphicChild},Area:{handler:V.renderGraphicChild},Radar:{handler:V.renderGraphicChild},RadialBar:{handler:V.renderGraphicChild},Scatter:{handler:V.renderGraphicChild},Pie:{handler:V.renderGraphicChild},Funnel:{handler:V.renderGraphicChild},Tooltip:{handler:V.renderCursor,once:!0},PolarGrid:{handler:V.renderPolarGrid,once:!0},PolarAngleAxis:{handler:V.renderPolarAxis},PolarRadiusAxis:{handler:V.renderPolarAxis},Customized:{handler:V.renderCustomized}}),V.clipPathId="".concat((M=k.id)!==null&&M!==void 0?M:GS("recharts"),"-clip"),V.throttleTriggeredAfterMouseMove=Zhe(V.triggeredAfterMouseMove,($=k.throttleDelay)!==null&&$!==void 0?$:1e3/60),V.state={},V}return Umt(D,P),kmt(D,[{key:"componentDidMount",value:function(){var M,$;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(M=this.props.margin.left)!==null&&M!==void 0?M:0,top:($=this.props.margin.top)!==null&&$!==void 0?$:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var M=this.props,$=M.children,V=M.data,W=M.height,H=M.layout,J=$s($,Na);if(J){var ee=J.props.defaultIndex;if(!(typeof ee!="number"||ee<0||ee>this.state.tooltipTicks.length-1)){var le=this.state.tooltipTicks[ee]&&this.state.tooltipTicks[ee].value,he=mU(this.state,V,ee,le),de=this.state.tooltipTicks[ee].coordinate,ae=(this.state.offset.top+W)/2,ce=H==="horizontal",ge=ce?{x:de,y:ae}:{y:de,x:ae},ye=this.state.formattedGraphicalItems.find(function(ne){var ue=ne.item;return ue.type.name==="Scatter"});ye&&(ge=Le(Le({},ge),ye.props.points[ee].tooltipPosition),he=ye.props.points[ee].tooltipPayload);var te={activeTooltipIndex:ee,isTooltipActive:!0,activeLabel:le,activePayload:he,activeCoordinate:ge};this.setState(te),this.renderCursor(J),this.accessibilityManager.setIndex(ee)}}}},{key:"getSnapshotBeforeUpdate",value:function(M,$){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==$.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==M.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==M.margin){var V,W;this.accessibilityManager.setDetails({offset:{left:(V=this.props.margin.left)!==null&&V!==void 0?V:0,top:(W=this.props.margin.top)!==null&&W!==void 0?W:0}})}return null}},{key:"componentDidUpdate",value:function(M){H2([$s(M.children,Na)],[$s(this.props.children,Na)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var M=$s(this.props.children,Na);if(M&&typeof M.props.shared=="boolean"){var $=M.props.shared?"axis":"item";return f.indexOf($)>=0?$:l}return l}},{key:"getMouseInfo",value:function(M){if(!this.container)return null;var $=this.container,V=$.getBoundingClientRect(),W=Int(V),H={chartX:Math.round(M.pageX-W.left),chartY:Math.round(M.pageY-W.top)},J=V.width/$.offsetWidth||1,ee=this.inRange(H.chartX,H.chartY,J);if(!ee)return null;var le=this.state,he=le.xAxisMap,de=le.yAxisMap,ae=this.getTooltipEventType(),ce=Mne(this.state,this.props.data,this.props.layout,ee);if(ae!=="axis"&&he&&de){var ge=fg(he).scale,ye=fg(de).scale,te=ge&&ge.invert?ge.invert(H.chartX):null,ne=ye&&ye.invert?ye.invert(H.chartY):null;return Le(Le({},H),{},{xValue:te,yValue:ne},ce)}return ce?Le(Le({},H),ce):null}},{key:"inRange",value:function(M,$){var V=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,W=this.props.layout,H=M/V,J=$/V;if(W==="horizontal"||W==="vertical"){var ee=this.state.offset,le=H>=ee.left&&H<=ee.left+ee.width&&J>=ee.top&&J<=ee.top+ee.height;return le?{x:H,y:J}:null}var he=this.state,de=he.angleAxisMap,ae=he.radiusAxisMap;if(de&&ae){var ce=fg(de);return pte({x:H,y:J},ce)}return null}},{key:"parseEventsOfWrapper",value:function(){var M=this.props.children,$=this.getTooltipEventType(),V=$s(M,Na),W={};V&&$==="axis"&&(V.props.trigger==="click"?W={onClick:this.handleClick}:W={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var H=iA(this.props,this.handleOuterEvent);return Le(Le({},H),W)}},{key:"addListener",value:function(){$L.on(WL,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){$L.removeListener(WL,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(M,$,V){for(var W=this.state.formattedGraphicalItems,H=0,J=W.length;H<J;H++){var ee=W[H];if(ee.item===M||ee.props.key===M.key||$===xu(ee.item.type)&&V===ee.childIndex)return ee}return null}},{key:"renderClipPath",value:function(){var M=this.clipPathId,$=this.state.offset,V=$.left,W=$.top,H=$.height,J=$.width;return se.createElement("defs",null,se.createElement("clipPath",{id:M},se.createElement("rect",{x:V,y:W,height:H,width:J})))}},{key:"getXScales",value:function(){var M=this.state.xAxisMap;return M?Object.entries(M).reduce(function($,V){var W=Dne(V,2),H=W[0],J=W[1];return Le(Le({},$),{},kt({},H,J.scale))},{}):null}},{key:"getYScales",value:function(){var M=this.state.yAxisMap;return M?Object.entries(M).reduce(function($,V){var W=Dne(V,2),H=W[0],J=W[1];return Le(Le({},$),{},kt({},H,J.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(M){var $;return($=this.state.xAxisMap)===null||$===void 0||($=$[M])===null||$===void 0?void 0:$.scale}},{key:"getYScaleByAxisId",value:function(M){var $;return($=this.state.yAxisMap)===null||$===void 0||($=$[M])===null||$===void 0?void 0:$.scale}},{key:"getItemByXY",value:function(M){var $=this.state,V=$.formattedGraphicalItems,W=$.activeItem;if(V&&V.length)for(var H=0,J=V.length;H<J;H++){var ee=V[H],le=ee.props,he=ee.item,de=he.type.defaultProps!==void 0?Le(Le({},he.type.defaultProps),he.props):he.props,ae=xu(he.type);if(ae==="Bar"){var ce=(le.data||[]).find(function(ne){return dut(M,ne)});if(ce)return{graphicalItem:ee,payload:ce}}else if(ae==="RadialBar"){var ge=(le.data||[]).find(function(ne){return pte(M,ne)});if(ge)return{graphicalItem:ee,payload:ge}}else if(XI(ee,W)||JI(ee,W)||dS(ee,W)){var ye=eht({graphicalItem:ee,activeTooltipItem:W,itemData:de.data}),te=de.activeIndex===void 0?ye:de.activeIndex;return{graphicalItem:Le(Le({},ee),{},{childIndex:te}),payload:dS(ee,W)?de.data[ye]:ee.props.data[ye]}}}return null}},{key:"render",value:function(){var M=this;if(!oZ(this))return null;var $=this.props,V=$.children,W=$.className,H=$.width,J=$.height,ee=$.style,le=$.compact,he=$.title,de=$.desc,ae=kne($,Amt),ce=Vt(ae,!1);if(le)return se.createElement(Ene,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},se.createElement(z2,Mg({},ce,{width:H,height:J,title:he,desc:de}),this.renderClipPath(),aZ(V,this.renderMap)));if(this.props.accessibilityLayer){var ge,ye;ce.tabIndex=(ge=this.props.tabIndex)!==null&&ge!==void 0?ge:0,ce.role=(ye=this.props.role)!==null&&ye!==void 0?ye:"application",ce.onKeyDown=function(ne){M.accessibilityManager.keyboardEvent(ne)},ce.onFocus=function(){M.accessibilityManager.focus()}}var te=this.parseEventsOfWrapper();return se.createElement(Ene,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},se.createElement("div",Mg({className:un("recharts-wrapper",W),style:Le({position:"relative",cursor:"default",width:H,height:J},ee)},te,{ref:function(ue){M.container=ue}}),se.createElement(z2,Mg({},ce,{width:H,height:J,title:he,desc:de,style:Gmt}),this.renderClipPath(),aZ(V,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(N.Component);kt(I,"displayName",n),kt(I,"defaultProps",Le({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},S)),kt(I,"getDerivedStateFromProps",function(P,D){var k=P.dataKey,M=P.data,$=P.children,V=P.width,W=P.height,H=P.layout,J=P.stackOffset,ee=P.margin,le=D.dataStartIndex,he=D.dataEndIndex;if(D.updateId===void 0){var de=jne(P);return Le(Le(Le({},de),{},{updateId:0},R(Le(Le({props:P},de),{},{updateId:0}),D)),{},{prevDataKey:k,prevData:M,prevWidth:V,prevHeight:W,prevLayout:H,prevStackOffset:J,prevMargin:ee,prevChildren:$})}if(k!==D.prevDataKey||M!==D.prevData||V!==D.prevWidth||W!==D.prevHeight||H!==D.prevLayout||J!==D.prevStackOffset||!zg(ee,D.prevMargin)){var ae=jne(P),ce={chartX:D.chartX,chartY:D.chartY,isTooltipActive:D.isTooltipActive},ge=Le(Le({},Mne(D,M,H)),{},{updateId:D.updateId+1}),ye=Le(Le(Le({},ae),ce),ge);return Le(Le(Le({},ye),R(Le({props:P},ye),D)),{},{prevDataKey:k,prevData:M,prevWidth:V,prevHeight:W,prevLayout:H,prevStackOffset:J,prevMargin:ee,prevChildren:$})}if(!H2($,D.prevChildren)){var te,ne,ue,_e,Ce=$s($,Dv),Ie=Ce&&(te=(ne=Ce.props)===null||ne===void 0?void 0:ne.startIndex)!==null&&te!==void 0?te:le,Ge=Ce&&(ue=(_e=Ce.props)===null||_e===void 0?void 0:_e.endIndex)!==null&&ue!==void 0?ue:he,Ze=Ie!==le||Ge!==he,wt=!En(M),Ft=wt&&!Ze?D.updateId:D.updateId+1;return Le(Le({updateId:Ft},R(Le(Le({props:P},D),{},{updateId:Ft,dataStartIndex:Ie,dataEndIndex:Ge}),D)),{},{prevChildren:$,dataStartIndex:Ie,dataEndIndex:Ge})}return null}),kt(I,"renderActiveDot",function(P,D,k){var M;return N.isValidElement(P)?M=N.cloneElement(P,D):Xt(P)?M=P(D):M=se.createElement(UB,D),se.createElement(er,{className:"recharts-active-dot",key:k},M)});var O=N.forwardRef(function(D,k){return se.createElement(I,Mg({},D,{ref:k}))});return O.displayName=I.displayName,O},Sme=bme({chartName:"BarChart",GraphicalChild:Uh,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:qS},{axisType:"yAxis",AxisComp:XS}],formatAxisMap:Lft}),egt=bme({chartName:"PieChart",GraphicalChild:Xu,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:qI},{axisType:"radiusAxis",AxisComp:zI}],formatAxisMap:Cat,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});function Ln(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Qs(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Vo(e,t){const n=Ln(e);return isNaN(t)?Qs(e,NaN):(t&&n.setDate(n.getDate()+t),n)}function Lc(e,t){const n=Ln(e);if(isNaN(t))return Qs(e,NaN);if(!t)return n;const i=n.getDate(),a=Qs(e,n.getTime());a.setMonth(n.getMonth()+t+1,0);const l=a.getDate();return i>=l?a:(n.setFullYear(a.getFullYear(),a.getMonth(),i),n)}const WB=6048e5,tgt=864e5;let ngt={};function JS(){return ngt}function Nl(e,t){var f,m,v,E;const n=JS(),i=(t==null?void 0:t.weekStartsOn)??((m=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((E=(v=n.locale)==null?void 0:v.options)==null?void 0:E.weekStartsOn)??0,a=Ln(e),l=a.getDay(),d=(l<i?7:0)+l-i;return a.setDate(a.getDate()-d),a.setHours(0,0,0,0),a}function Rp(e){return Nl(e,{weekStartsOn:1})}function wme(e){const t=Ln(e),n=t.getFullYear(),i=Qs(e,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const a=Rp(i),l=Qs(e,0);l.setFullYear(n,0,4),l.setHours(0,0,0,0);const d=Rp(l);return t.getTime()>=a.getTime()?n+1:t.getTime()>=d.getTime()?n:n-1}function Wv(e){const t=Ln(e);return t.setHours(0,0,0,0),t}function nO(e){const t=Ln(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function bl(e,t){const n=Wv(e),i=Wv(t),a=+n-nO(n),l=+i-nO(i);return Math.round((a-l)/tgt)}function rgt(e){const t=wme(e),n=Qs(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),Rp(n)}function gU(e,t){const n=t*7;return Vo(e,n)}function igt(e,t){return Lc(e,t*12)}function ogt(e){let t;return e.forEach(function(n){const i=Ln(n);(t===void 0||t<i||isNaN(Number(i)))&&(t=i)}),t||new Date(NaN)}function sgt(e){let t;return e.forEach(n=>{const i=Ln(n);(!t||t>i||isNaN(+i))&&(t=i)}),t||new Date(NaN)}function ys(e,t){const n=Wv(e),i=Wv(t);return+n==+i}function GB(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function agt(e){if(!GB(e)&&typeof e!="number")return!1;const t=Ln(e);return!isNaN(Number(t))}function yS(e,t){const n=Ln(e),i=Ln(t),a=n.getFullYear()-i.getFullYear(),l=n.getMonth()-i.getMonth();return a*12+l}function cgt(e,t,n){const i=Nl(e,n),a=Nl(t,n),l=+i-nO(i),d=+a-nO(a);return Math.round((l-d)/WB)}function HB(e){const t=Ln(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function Ss(e){const t=Ln(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Tme(e){const t=Ln(e),n=Qs(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}function KB(e,t){var f,m,v,E;const n=JS(),i=(t==null?void 0:t.weekStartsOn)??((m=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:m.weekStartsOn)??n.weekStartsOn??((E=(v=n.locale)==null?void 0:v.options)==null?void 0:E.weekStartsOn)??0,a=Ln(e),l=a.getDay(),d=(l<i?-7:0)+6-(l-i);return a.setDate(a.getDate()+d),a.setHours(23,59,59,999),a}function Cme(e){return KB(e,{weekStartsOn:1})}const lgt={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ugt=(e,t,n)=>{let i;const a=lgt[e];return typeof a=="string"?i=a:t===1?i=a.one:i=a.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function HL(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const dgt={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},hgt={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},fgt={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},pgt={date:HL({formats:dgt,defaultWidth:"full"}),time:HL({formats:hgt,defaultWidth:"full"}),dateTime:HL({formats:fgt,defaultWidth:"full"})},mgt={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ggt=(e,t,n,i)=>mgt[e];function _E(e){return(t,n)=>{const i=n!=null&&n.context?String(n.context):"standalone";let a;if(i==="formatting"&&e.formattingValues){const d=e.defaultFormattingWidth||e.defaultWidth,f=n!=null&&n.width?String(n.width):d;a=e.formattingValues[f]||e.formattingValues[d]}else{const d=e.defaultWidth,f=n!=null&&n.width?String(n.width):e.defaultWidth;a=e.values[f]||e.values[d]}const l=e.argumentCallback?e.argumentCallback(t):t;return a[l]}}const vgt={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ygt={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},_gt={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Egt={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},bgt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Sgt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},wgt=(e,t)=>{const n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Tgt={ordinalNumber:wgt,era:_E({values:vgt,defaultWidth:"wide"}),quarter:_E({values:ygt,defaultWidth:"wide",argumentCallback:e=>e-1}),month:_E({values:_gt,defaultWidth:"wide"}),day:_E({values:Egt,defaultWidth:"wide"}),dayPeriod:_E({values:bgt,defaultWidth:"wide",formattingValues:Sgt,defaultFormattingWidth:"wide"})};function EE(e){return(t,n={})=>{const i=n.width,a=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],l=t.match(a);if(!l)return null;const d=l[0],f=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],m=Array.isArray(f)?Rgt(f,S=>S.test(d)):Cgt(f,S=>S.test(d));let v;v=e.valueCallback?e.valueCallback(m):m,v=n.valueCallback?n.valueCallback(v):v;const E=t.slice(d.length);return{value:v,rest:E}}}function Cgt(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function Rgt(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function Agt(e){return(t,n={})=>{const i=t.match(e.matchPattern);if(!i)return null;const a=i[0],l=t.match(e.parsePattern);if(!l)return null;let d=e.valueCallback?e.valueCallback(l[0]):l[0];d=n.valueCallback?n.valueCallback(d):d;const f=t.slice(a.length);return{value:d,rest:f}}}const Ogt=/^(\d+)(th|st|nd|rd)?/i,Igt=/\d+/i,xgt={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Pgt={any:[/^b/i,/^(a|c)/i]},Ngt={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Dgt={any:[/1/i,/2/i,/3/i,/4/i]},kgt={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Lgt={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Mgt={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},jgt={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Ugt={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Vgt={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Fgt={ordinalNumber:Agt({matchPattern:Ogt,parsePattern:Igt,valueCallback:e=>parseInt(e,10)}),era:EE({matchPatterns:xgt,defaultMatchWidth:"wide",parsePatterns:Pgt,defaultParseWidth:"any"}),quarter:EE({matchPatterns:Ngt,defaultMatchWidth:"wide",parsePatterns:Dgt,defaultParseWidth:"any",valueCallback:e=>e+1}),month:EE({matchPatterns:kgt,defaultMatchWidth:"wide",parsePatterns:Lgt,defaultParseWidth:"any"}),day:EE({matchPatterns:Mgt,defaultMatchWidth:"wide",parsePatterns:jgt,defaultParseWidth:"any"}),dayPeriod:EE({matchPatterns:Ugt,defaultMatchWidth:"any",parsePatterns:Vgt,defaultParseWidth:"any"})},Rme={code:"en-US",formatDistance:ugt,formatLong:pgt,formatRelative:ggt,localize:Tgt,match:Fgt,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Bgt(e){const t=Ln(e);return bl(t,Tme(t))+1}function Ame(e){const t=Ln(e),n=+Rp(t)-+rgt(t);return Math.round(n/WB)+1}function Ome(e,t){var E,S,T,R;const n=Ln(e),i=n.getFullYear(),a=JS(),l=(t==null?void 0:t.firstWeekContainsDate)??((S=(E=t==null?void 0:t.locale)==null?void 0:E.options)==null?void 0:S.firstWeekContainsDate)??a.firstWeekContainsDate??((R=(T=a.locale)==null?void 0:T.options)==null?void 0:R.firstWeekContainsDate)??1,d=Qs(e,0);d.setFullYear(i+1,0,l),d.setHours(0,0,0,0);const f=Nl(d,t),m=Qs(e,0);m.setFullYear(i,0,l),m.setHours(0,0,0,0);const v=Nl(m,t);return n.getTime()>=f.getTime()?i+1:n.getTime()>=v.getTime()?i:i-1}function $gt(e,t){var f,m,v,E;const n=JS(),i=(t==null?void 0:t.firstWeekContainsDate)??((m=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??n.firstWeekContainsDate??((E=(v=n.locale)==null?void 0:v.options)==null?void 0:E.firstWeekContainsDate)??1,a=Ome(e,t),l=Qs(e,0);return l.setFullYear(a,0,i),l.setHours(0,0,0,0),Nl(l,t)}function Ime(e,t){const n=Ln(e),i=+Nl(n,t)-+$gt(n,t);return Math.round(i/WB)+1}function Qn(e,t){const n=e<0?"-":"",i=Math.abs(e).toString().padStart(t,"0");return n+i}const Nd={y(e,t){const n=e.getFullYear(),i=n>0?n:1-n;return Qn(t==="yy"?i%100:i,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):Qn(n+1,2)},d(e,t){return Qn(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return Qn(e.getHours()%12||12,t.length)},H(e,t){return Qn(e.getHours(),t.length)},m(e,t){return Qn(e.getMinutes(),t.length)},s(e,t){return Qn(e.getSeconds(),t.length)},S(e,t){const n=t.length,i=e.getMilliseconds(),a=Math.trunc(i*Math.pow(10,n-3));return Qn(a,t.length)}},ug={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Vne={G:function(e,t,n){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});case"GGGG":default:return n.era(i,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const i=e.getFullYear(),a=i>0?i:1-i;return n.ordinalNumber(a,{unit:"year"})}return Nd.y(e,t)},Y:function(e,t,n,i){const a=Ome(e,i),l=a>0?a:1-a;if(t==="YY"){const d=l%100;return Qn(d,2)}return t==="Yo"?n.ordinalNumber(l,{unit:"year"}):Qn(l,t.length)},R:function(e,t){const n=wme(e);return Qn(n,t.length)},u:function(e,t){const n=e.getFullYear();return Qn(n,t.length)},Q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return Qn(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return Qn(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,n){const i=e.getMonth();switch(t){case"M":case"MM":return Nd.M(e,t);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,n){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return Qn(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,n,i){const a=Ime(e,i);return t==="wo"?n.ordinalNumber(a,{unit:"week"}):Qn(a,t.length)},I:function(e,t,n){const i=Ame(e);return t==="Io"?n.ordinalNumber(i,{unit:"week"}):Qn(i,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Nd.d(e,t)},D:function(e,t,n){const i=Bgt(e);return t==="Do"?n.ordinalNumber(i,{unit:"dayOfYear"}):Qn(i,t.length)},E:function(e,t,n){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});case"EEEE":default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,n,i){const a=e.getDay(),l=(a-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(l);case"ee":return Qn(l,2);case"eo":return n.ordinalNumber(l,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,n,i){const a=e.getDay(),l=(a-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(l);case"cc":return Qn(l,t.length);case"co":return n.ordinalNumber(l,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,n){const i=e.getDay(),a=i===0?7:i;switch(t){case"i":return String(a);case"ii":return Qn(a,t.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});case"iiii":default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,n){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,n){const i=e.getHours();let a;switch(i===12?a=ug.noon:i===0?a=ug.midnight:a=i/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,n){const i=e.getHours();let a;switch(i>=17?a=ug.evening:i>=12?a=ug.afternoon:i>=4?a=ug.morning:a=ug.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let i=e.getHours()%12;return i===0&&(i=12),n.ordinalNumber(i,{unit:"hour"})}return Nd.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Nd.H(e,t)},K:function(e,t,n){const i=e.getHours()%12;return t==="Ko"?n.ordinalNumber(i,{unit:"hour"}):Qn(i,t.length)},k:function(e,t,n){let i=e.getHours();return i===0&&(i=24),t==="ko"?n.ordinalNumber(i,{unit:"hour"}):Qn(i,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Nd.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Nd.s(e,t)},S:function(e,t){return Nd.S(e,t)},X:function(e,t,n){const i=e.getTimezoneOffset();if(i===0)return"Z";switch(t){case"X":return Bne(i);case"XXXX":case"XX":return $f(i);case"XXXXX":case"XXX":default:return $f(i,":")}},x:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"x":return Bne(i);case"xxxx":case"xx":return $f(i);case"xxxxx":case"xxx":default:return $f(i,":")}},O:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Fne(i,":");case"OOOO":default:return"GMT"+$f(i,":")}},z:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Fne(i,":");case"zzzz":default:return"GMT"+$f(i,":")}},t:function(e,t,n){const i=Math.trunc(e.getTime()/1e3);return Qn(i,t.length)},T:function(e,t,n){const i=e.getTime();return Qn(i,t.length)}};function Fne(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),a=Math.trunc(i/60),l=i%60;return l===0?n+String(a):n+String(a)+t+Qn(l,2)}function Bne(e,t){return e%60===0?(e>0?"-":"+")+Qn(Math.abs(e)/60,2):$f(e,t)}function $f(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),a=Qn(Math.trunc(i/60),2),l=Qn(i%60,2);return n+a+t+l}const $ne=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},xme=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},Wgt=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],i=n[1],a=n[2];if(!a)return $ne(e,t);let l;switch(i){case"P":l=t.dateTime({width:"short"});break;case"PP":l=t.dateTime({width:"medium"});break;case"PPP":l=t.dateTime({width:"long"});break;case"PPPP":default:l=t.dateTime({width:"full"});break}return l.replace("{{date}}",$ne(i,t)).replace("{{time}}",xme(a,t))},Ggt={p:xme,P:Wgt},Hgt=/^D+$/,Kgt=/^Y+$/,zgt=["D","DD","YY","YYYY"];function Ygt(e){return Hgt.test(e)}function qgt(e){return Kgt.test(e)}function Xgt(e,t,n){const i=Jgt(e,t,n);if(console.warn(i),zgt.includes(e))throw new RangeError(i)}function Jgt(e,t,n){const i=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${i} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Qgt=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Zgt=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,evt=/^'([^]*?)'?$/,tvt=/''/g,nvt=/[a-zA-Z]/;function Vh(e,t,n){var E,S,T,R,I,O,P,D;const i=JS(),a=(n==null?void 0:n.locale)??i.locale??Rme,l=(n==null?void 0:n.firstWeekContainsDate)??((S=(E=n==null?void 0:n.locale)==null?void 0:E.options)==null?void 0:S.firstWeekContainsDate)??i.firstWeekContainsDate??((R=(T=i.locale)==null?void 0:T.options)==null?void 0:R.firstWeekContainsDate)??1,d=(n==null?void 0:n.weekStartsOn)??((O=(I=n==null?void 0:n.locale)==null?void 0:I.options)==null?void 0:O.weekStartsOn)??i.weekStartsOn??((D=(P=i.locale)==null?void 0:P.options)==null?void 0:D.weekStartsOn)??0,f=Ln(e);if(!agt(f))throw new RangeError("Invalid time value");let m=t.match(Zgt).map(k=>{const M=k[0];if(M==="p"||M==="P"){const $=Ggt[M];return $(k,a.formatLong)}return k}).join("").match(Qgt).map(k=>{if(k==="''")return{isToken:!1,value:"'"};const M=k[0];if(M==="'")return{isToken:!1,value:rvt(k)};if(Vne[M])return{isToken:!0,value:k};if(M.match(nvt))throw new RangeError("Format string contains an unescaped latin alphabet character `"+M+"`");return{isToken:!1,value:k}});a.localize.preprocessor&&(m=a.localize.preprocessor(f,m));const v={firstWeekContainsDate:l,weekStartsOn:d,locale:a};return m.map(k=>{if(!k.isToken)return k.value;const M=k.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&qgt(M)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&Ygt(M))&&Xgt(M,t,String(e));const $=Vne[M[0]];return $(f,M,a.localize,v)}).join("")}function rvt(e){const t=e.match(evt);return t?t[1].replace(tvt,"'"):e}function ivt(e){const t=Ln(e),n=t.getFullYear(),i=t.getMonth(),a=Qs(e,0);return a.setFullYear(n,i+1,0),a.setHours(0,0,0,0),a.getDate()}function ovt(e){return Math.trunc(+Ln(e)/1e3)}function svt(e){const t=Ln(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(0,0,0,0),t}function avt(e,t){return cgt(svt(e),Ss(e),t)+1}function vU(e,t){const n=Ln(e),i=Ln(t);return n.getTime()>i.getTime()}function Pme(e,t){const n=Ln(e),i=Ln(t);return+n<+i}function zB(e,t){const n=Ln(e),i=Ln(t);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()}function cvt(e,t){const n=Ln(e),i=Ln(t);return n.getFullYear()===i.getFullYear()}function KL(e,t){return Vo(e,-t)}function zL(e,t){const n=Ln(e),i=n.getFullYear(),a=n.getDate(),l=Qs(e,0);l.setFullYear(i,t,15),l.setHours(0,0,0,0);const d=ivt(l);return n.setMonth(t,Math.min(a,d)),n}function Wne(e,t){const n=Ln(e);return isNaN(+n)?Qs(e,NaN):(n.setFullYear(t),n)}var Ut=function(){return Ut=Object.assign||function(t){for(var n,i=1,a=arguments.length;i<a;i++){n=arguments[i];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},Ut.apply(this,arguments)};function lvt(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,i=Object.getOwnPropertySymbols(e);a<i.length;a++)t.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(e,i[a])&&(n[i[a]]=e[i[a]]);return n}function Nme(e,t,n){for(var i=0,a=t.length,l;i<a;i++)(l||!(i in t))&&(l||(l=Array.prototype.slice.call(t,0,i)),l[i]=t[i]);return e.concat(l||Array.prototype.slice.call(t))}function QS(e){return e.mode==="multiple"}function ZS(e){return e.mode==="range"}function ox(e){return e.mode==="single"}var uvt={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function dvt(e,t){return Vh(e,"LLLL y",t)}function hvt(e,t){return Vh(e,"d",t)}function fvt(e,t){return Vh(e,"LLLL",t)}function pvt(e){return"".concat(e)}function mvt(e,t){return Vh(e,"cccccc",t)}function gvt(e,t){return Vh(e,"yyyy",t)}var vvt=Object.freeze({__proto__:null,formatCaption:dvt,formatDay:hvt,formatMonthCaption:fvt,formatWeekNumber:pvt,formatWeekdayName:mvt,formatYearCaption:gvt}),yvt=function(e,t,n){return Vh(e,"do MMMM (EEEE)",n)},_vt=function(){return"Month: "},Evt=function(){return"Go to next month"},bvt=function(){return"Go to previous month"},Svt=function(e,t){return Vh(e,"cccc",t)},wvt=function(e){return"Week n. ".concat(e)},Tvt=function(){return"Year: "},Cvt=Object.freeze({__proto__:null,labelDay:yvt,labelMonthDropdown:_vt,labelNext:Evt,labelPrevious:bvt,labelWeekNumber:wvt,labelWeekday:Svt,labelYearDropdown:Tvt});function Rvt(){var e="buttons",t=uvt,n=Rme,i={},a={},l=1,d={},f=new Date;return{captionLayout:e,classNames:t,formatters:vvt,labels:Cvt,locale:n,modifiersClassNames:i,modifiers:a,numberOfMonths:l,styles:d,today:f,mode:"default"}}function Avt(e){var t=e.fromYear,n=e.toYear,i=e.fromMonth,a=e.toMonth,l=e.fromDate,d=e.toDate;return i?l=Ss(i):t&&(l=new Date(t,0,1)),a?d=HB(a):n&&(d=new Date(n,11,31)),{fromDate:l?Wv(l):void 0,toDate:d?Wv(d):void 0}}var Dme=N.createContext(void 0);function Ovt(e){var t,n=e.initialProps,i=Rvt(),a=Avt(n),l=a.fromDate,d=a.toDate,f=(t=n.captionLayout)!==null&&t!==void 0?t:i.captionLayout;f!=="buttons"&&(!l||!d)&&(f="buttons");var m;(ox(n)||QS(n)||ZS(n))&&(m=n.onSelect);var v=Ut(Ut(Ut({},i),n),{captionLayout:f,classNames:Ut(Ut({},i.classNames),n.classNames),components:Ut({},n.components),formatters:Ut(Ut({},i.formatters),n.formatters),fromDate:l,labels:Ut(Ut({},i.labels),n.labels),mode:n.mode||i.mode,modifiers:Ut(Ut({},i.modifiers),n.modifiers),modifiersClassNames:Ut(Ut({},i.modifiersClassNames),n.modifiersClassNames),onSelect:m,styles:Ut(Ut({},i.styles),n.styles),toDate:d});return _.jsx(Dme.Provider,{value:v,children:e.children})}function Cr(){var e=N.useContext(Dme);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function kme(e){var t=Cr(),n=t.locale,i=t.classNames,a=t.styles,l=t.formatters.formatCaption;return _.jsx("div",{className:i.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:l(e.displayMonth,{locale:n})})}function Ivt(e){return _.jsx("svg",Ut({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:_.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Lme(e){var t,n,i=e.onChange,a=e.value,l=e.children,d=e.caption,f=e.className,m=e.style,v=Cr(),E=(n=(t=v.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&n!==void 0?n:Ivt;return _.jsxs("div",{className:f,style:m,children:[_.jsx("span",{className:v.classNames.vhidden,children:e["aria-label"]}),_.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:v.classNames.dropdown,style:v.styles.dropdown,value:a,onChange:i,children:l}),_.jsxs("div",{className:v.classNames.caption_label,style:v.styles.caption_label,"aria-hidden":"true",children:[d,_.jsx(E,{className:v.classNames.dropdown_icon,style:v.styles.dropdown_icon})]})]})}function xvt(e){var t,n=Cr(),i=n.fromDate,a=n.toDate,l=n.styles,d=n.locale,f=n.formatters.formatMonthCaption,m=n.classNames,v=n.components,E=n.labels.labelMonthDropdown;if(!i)return _.jsx(_.Fragment,{});if(!a)return _.jsx(_.Fragment,{});var S=[];if(cvt(i,a))for(var T=Ss(i),R=i.getMonth();R<=a.getMonth();R++)S.push(zL(T,R));else for(var T=Ss(new Date),R=0;R<=11;R++)S.push(zL(T,R));var I=function(P){var D=Number(P.target.value),k=zL(Ss(e.displayMonth),D);e.onChange(k)},O=(t=v==null?void 0:v.Dropdown)!==null&&t!==void 0?t:Lme;return _.jsx(O,{name:"months","aria-label":E(),className:m.dropdown_month,style:l.dropdown_month,onChange:I,value:e.displayMonth.getMonth(),caption:f(e.displayMonth,{locale:d}),children:S.map(function(P){return _.jsx("option",{value:P.getMonth(),children:f(P,{locale:d})},P.getMonth())})})}function Pvt(e){var t,n=e.displayMonth,i=Cr(),a=i.fromDate,l=i.toDate,d=i.locale,f=i.styles,m=i.classNames,v=i.components,E=i.formatters.formatYearCaption,S=i.labels.labelYearDropdown,T=[];if(!a)return _.jsx(_.Fragment,{});if(!l)return _.jsx(_.Fragment,{});for(var R=a.getFullYear(),I=l.getFullYear(),O=R;O<=I;O++)T.push(Wne(Tme(new Date),O));var P=function(k){var M=Wne(Ss(n),Number(k.target.value));e.onChange(M)},D=(t=v==null?void 0:v.Dropdown)!==null&&t!==void 0?t:Lme;return _.jsx(D,{name:"years","aria-label":S(),className:m.dropdown_year,style:f.dropdown_year,onChange:P,value:n.getFullYear(),caption:E(n,{locale:d}),children:T.map(function(k){return _.jsx("option",{value:k.getFullYear(),children:E(k,{locale:d})},k.getFullYear())})})}function Nvt(e,t){var n=N.useState(e),i=n[0],a=n[1],l=t===void 0?i:t;return[l,a]}function Dvt(e){var t=e.month,n=e.defaultMonth,i=e.today,a=t||n||i||new Date,l=e.toDate,d=e.fromDate,f=e.numberOfMonths,m=f===void 0?1:f;if(l&&yS(l,a)<0){var v=-1*(m-1);a=Lc(l,v)}return d&&yS(a,d)<0&&(a=d),Ss(a)}function kvt(){var e=Cr(),t=Dvt(e),n=Nvt(t,e.month),i=n[0],a=n[1],l=function(d){var f;if(!e.disableNavigation){var m=Ss(d);a(m),(f=e.onMonthChange)===null||f===void 0||f.call(e,m)}};return[i,l]}function Lvt(e,t){for(var n=t.reverseMonths,i=t.numberOfMonths,a=Ss(e),l=Ss(Lc(a,i)),d=yS(l,a),f=[],m=0;m<d;m++){var v=Lc(a,m);f.push(v)}return n&&(f=f.reverse()),f}function Mvt(e,t){if(!t.disableNavigation){var n=t.toDate,i=t.pagedNavigation,a=t.numberOfMonths,l=a===void 0?1:a,d=i?l:1,f=Ss(e);if(!n)return Lc(f,d);var m=yS(n,e);if(!(m<l))return Lc(f,d)}}function jvt(e,t){if(!t.disableNavigation){var n=t.fromDate,i=t.pagedNavigation,a=t.numberOfMonths,l=a===void 0?1:a,d=i?l:1,f=Ss(e);if(!n)return Lc(f,-d);var m=yS(f,n);if(!(m<=0))return Lc(f,-d)}}var Mme=N.createContext(void 0);function Uvt(e){var t=Cr(),n=kvt(),i=n[0],a=n[1],l=Lvt(i,t),d=Mvt(i,t),f=jvt(i,t),m=function(S){return l.some(function(T){return zB(S,T)})},v=function(S,T){m(S)||(T&&Pme(S,T)?a(Lc(S,1+t.numberOfMonths*-1)):a(S))},E={currentMonth:i,displayMonths:l,goToMonth:a,goToDate:v,previousMonth:f,nextMonth:d,isDateDisplayed:m};return _.jsx(Mme.Provider,{value:E,children:e.children})}function e0(){var e=N.useContext(Mme);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function Gne(e){var t,n=Cr(),i=n.classNames,a=n.styles,l=n.components,d=e0().goToMonth,f=function(E){d(Lc(E,e.displayIndex?-e.displayIndex:0))},m=(t=l==null?void 0:l.CaptionLabel)!==null&&t!==void 0?t:kme,v=_.jsx(m,{id:e.id,displayMonth:e.displayMonth});return _.jsxs("div",{className:i.caption_dropdowns,style:a.caption_dropdowns,children:[_.jsx("div",{className:i.vhidden,children:v}),_.jsx(xvt,{onChange:f,displayMonth:e.displayMonth}),_.jsx(Pvt,{onChange:f,displayMonth:e.displayMonth})]})}function Vvt(e){return _.jsx("svg",Ut({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:_.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Fvt(e){return _.jsx("svg",Ut({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:_.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var rO=N.forwardRef(function(e,t){var n=Cr(),i=n.classNames,a=n.styles,l=[i.button_reset,i.button];e.className&&l.push(e.className);var d=l.join(" "),f=Ut(Ut({},a.button_reset),a.button);return e.style&&Object.assign(f,e.style),_.jsx("button",Ut({},e,{ref:t,type:"button",className:d,style:f}))});function Bvt(e){var t,n,i=Cr(),a=i.dir,l=i.locale,d=i.classNames,f=i.styles,m=i.labels,v=m.labelPrevious,E=m.labelNext,S=i.components;if(!e.nextMonth&&!e.previousMonth)return _.jsx(_.Fragment,{});var T=v(e.previousMonth,{locale:l}),R=[d.nav_button,d.nav_button_previous].join(" "),I=E(e.nextMonth,{locale:l}),O=[d.nav_button,d.nav_button_next].join(" "),P=(t=S==null?void 0:S.IconRight)!==null&&t!==void 0?t:Fvt,D=(n=S==null?void 0:S.IconLeft)!==null&&n!==void 0?n:Vvt;return _.jsxs("div",{className:d.nav,style:f.nav,children:[!e.hidePrevious&&_.jsx(rO,{name:"previous-month","aria-label":T,className:R,style:f.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?_.jsx(P,{className:d.nav_icon,style:f.nav_icon}):_.jsx(D,{className:d.nav_icon,style:f.nav_icon})}),!e.hideNext&&_.jsx(rO,{name:"next-month","aria-label":I,className:O,style:f.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?_.jsx(D,{className:d.nav_icon,style:f.nav_icon}):_.jsx(P,{className:d.nav_icon,style:f.nav_icon})})]})}function Hne(e){var t=Cr().numberOfMonths,n=e0(),i=n.previousMonth,a=n.nextMonth,l=n.goToMonth,d=n.displayMonths,f=d.findIndex(function(I){return zB(e.displayMonth,I)}),m=f===0,v=f===d.length-1,E=t>1&&(m||!v),S=t>1&&(v||!m),T=function(){i&&l(i)},R=function(){a&&l(a)};return _.jsx(Bvt,{displayMonth:e.displayMonth,hideNext:E,hidePrevious:S,nextMonth:a,previousMonth:i,onPreviousClick:T,onNextClick:R})}function $vt(e){var t,n=Cr(),i=n.classNames,a=n.disableNavigation,l=n.styles,d=n.captionLayout,f=n.components,m=(t=f==null?void 0:f.CaptionLabel)!==null&&t!==void 0?t:kme,v;return a?v=_.jsx(m,{id:e.id,displayMonth:e.displayMonth}):d==="dropdown"?v=_.jsx(Gne,{displayMonth:e.displayMonth,id:e.id}):d==="dropdown-buttons"?v=_.jsxs(_.Fragment,{children:[_.jsx(Gne,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),_.jsx(Hne,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):v=_.jsxs(_.Fragment,{children:[_.jsx(m,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),_.jsx(Hne,{displayMonth:e.displayMonth,id:e.id})]}),_.jsx("div",{className:i.caption,style:l.caption,children:v})}function Wvt(e){var t=Cr(),n=t.footer,i=t.styles,a=t.classNames.tfoot;return n?_.jsx("tfoot",{className:a,style:i.tfoot,children:_.jsx("tr",{children:_.jsx("td",{colSpan:8,children:n})})}):_.jsx(_.Fragment,{})}function Gvt(e,t,n){for(var i=n?Rp(new Date):Nl(new Date,{locale:e,weekStartsOn:t}),a=[],l=0;l<7;l++){var d=Vo(i,l);a.push(d)}return a}function Hvt(){var e=Cr(),t=e.classNames,n=e.styles,i=e.showWeekNumber,a=e.locale,l=e.weekStartsOn,d=e.ISOWeek,f=e.formatters.formatWeekdayName,m=e.labels.labelWeekday,v=Gvt(a,l,d);return _.jsxs("tr",{style:n.head_row,className:t.head_row,children:[i&&_.jsx("td",{style:n.head_cell,className:t.head_cell}),v.map(function(E,S){return _.jsx("th",{scope:"col",className:t.head_cell,style:n.head_cell,"aria-label":m(E,{locale:a}),children:f(E,{locale:a})},S)})]})}function Kvt(){var e,t=Cr(),n=t.classNames,i=t.styles,a=t.components,l=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:Hvt;return _.jsx("thead",{style:i.head,className:n.head,children:_.jsx(l,{})})}function zvt(e){var t=Cr(),n=t.locale,i=t.formatters.formatDay;return _.jsx(_.Fragment,{children:i(e.date,{locale:n})})}var YB=N.createContext(void 0);function Yvt(e){if(!QS(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return _.jsx(YB.Provider,{value:t,children:e.children})}return _.jsx(qvt,{initialProps:e.initialProps,children:e.children})}function qvt(e){var t=e.initialProps,n=e.children,i=t.selected,a=t.min,l=t.max,d=function(v,E,S){var T,R;(T=t.onDayClick)===null||T===void 0||T.call(t,v,E,S);var I=!!(E.selected&&a&&(i==null?void 0:i.length)===a);if(!I){var O=!!(!E.selected&&l&&(i==null?void 0:i.length)===l);if(!O){var P=i?Nme([],i):[];if(E.selected){var D=P.findIndex(function(k){return ys(v,k)});P.splice(D,1)}else P.push(v);(R=t.onSelect)===null||R===void 0||R.call(t,P,v,E,S)}}},f={disabled:[]};i&&f.disabled.push(function(v){var E=l&&i.length>l-1,S=i.some(function(T){return ys(T,v)});return!!(E&&!S)});var m={selected:i,onDayClick:d,modifiers:f};return _.jsx(YB.Provider,{value:m,children:n})}function qB(){var e=N.useContext(YB);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function Xvt(e,t){var n=t||{},i=n.from,a=n.to;return i&&a?ys(a,e)&&ys(i,e)?void 0:ys(a,e)?{from:a,to:void 0}:ys(i,e)?void 0:vU(i,e)?{from:e,to:a}:{from:i,to:e}:a?vU(e,a)?{from:a,to:e}:{from:e,to:a}:i?Pme(e,i)?{from:e,to:i}:{from:i,to:e}:{from:e,to:void 0}}var XB=N.createContext(void 0);function Jvt(e){if(!ZS(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return _.jsx(XB.Provider,{value:t,children:e.children})}return _.jsx(Qvt,{initialProps:e.initialProps,children:e.children})}function Qvt(e){var t=e.initialProps,n=e.children,i=t.selected,a=i||{},l=a.from,d=a.to,f=t.min,m=t.max,v=function(R,I,O){var P,D;(P=t.onDayClick)===null||P===void 0||P.call(t,R,I,O);var k=Xvt(R,i);(D=t.onSelect)===null||D===void 0||D.call(t,k,R,I,O)},E={range_start:[],range_end:[],range_middle:[],disabled:[]};if(l?(E.range_start=[l],d?(E.range_end=[d],ys(l,d)||(E.range_middle=[{after:l,before:d}])):E.range_end=[l]):d&&(E.range_start=[d],E.range_end=[d]),f&&(l&&!d&&E.disabled.push({after:KL(l,f-1),before:Vo(l,f-1)}),l&&d&&E.disabled.push({after:l,before:Vo(l,f-1)}),!l&&d&&E.disabled.push({after:KL(d,f-1),before:Vo(d,f-1)})),m){if(l&&!d&&(E.disabled.push({before:Vo(l,-m+1)}),E.disabled.push({after:Vo(l,m-1)})),l&&d){var S=bl(d,l)+1,T=m-S;E.disabled.push({before:KL(l,T)}),E.disabled.push({after:Vo(d,T)})}!l&&d&&(E.disabled.push({before:Vo(d,-m+1)}),E.disabled.push({after:Vo(d,m-1)}))}return _.jsx(XB.Provider,{value:{selected:i,onDayClick:v,modifiers:E},children:n})}function JB(){var e=N.useContext(XB);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function mR(e){return Array.isArray(e)?Nme([],e):e!==void 0?[e]:[]}function Zvt(e){var t={};return Object.entries(e).forEach(function(n){var i=n[0],a=n[1];t[i]=mR(a)}),t}var Mc;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Mc||(Mc={}));var eyt=Mc.Selected,su=Mc.Disabled,tyt=Mc.Hidden,nyt=Mc.Today,YL=Mc.RangeEnd,qL=Mc.RangeMiddle,XL=Mc.RangeStart,ryt=Mc.Outside;function iyt(e,t,n){var i,a=(i={},i[eyt]=mR(e.selected),i[su]=mR(e.disabled),i[tyt]=mR(e.hidden),i[nyt]=[e.today],i[YL]=[],i[qL]=[],i[XL]=[],i[ryt]=[],i);return e.fromDate&&a[su].push({before:e.fromDate}),e.toDate&&a[su].push({after:e.toDate}),QS(e)?a[su]=a[su].concat(t.modifiers[su]):ZS(e)&&(a[su]=a[su].concat(n.modifiers[su]),a[XL]=n.modifiers[XL],a[qL]=n.modifiers[qL],a[YL]=n.modifiers[YL]),a}var jme=N.createContext(void 0);function oyt(e){var t=Cr(),n=qB(),i=JB(),a=iyt(t,n,i),l=Zvt(t.modifiers),d=Ut(Ut({},a),l);return _.jsx(jme.Provider,{value:d,children:e.children})}function Ume(){var e=N.useContext(jme);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function syt(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function ayt(e){return!!(e&&typeof e=="object"&&"from"in e)}function cyt(e){return!!(e&&typeof e=="object"&&"after"in e)}function lyt(e){return!!(e&&typeof e=="object"&&"before"in e)}function uyt(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function dyt(e,t){var n,i=t.from,a=t.to;if(i&&a){var l=bl(a,i)<0;l&&(n=[a,i],i=n[0],a=n[1]);var d=bl(e,i)>=0&&bl(a,e)>=0;return d}return a?ys(a,e):i?ys(i,e):!1}function hyt(e){return GB(e)}function fyt(e){return Array.isArray(e)&&e.every(GB)}function pyt(e,t){return t.some(function(n){if(typeof n=="boolean")return n;if(hyt(n))return ys(e,n);if(fyt(n))return n.includes(e);if(ayt(n))return dyt(e,n);if(uyt(n))return n.dayOfWeek.includes(e.getDay());if(syt(n)){var i=bl(n.before,e),a=bl(n.after,e),l=i>0,d=a<0,f=vU(n.before,n.after);return f?d&&l:l||d}return cyt(n)?bl(e,n.after)>0:lyt(n)?bl(n.before,e)>0:typeof n=="function"?n(e):!1})}function QB(e,t,n){var i=Object.keys(t).reduce(function(l,d){var f=t[d];return pyt(e,f)&&l.push(d),l},[]),a={};return i.forEach(function(l){return a[l]=!0}),n&&!zB(e,n)&&(a.outside=!0),a}function myt(e,t){for(var n=Ss(e[0]),i=HB(e[e.length-1]),a,l,d=n;d<=i;){var f=QB(d,t),m=!f.disabled&&!f.hidden;if(!m){d=Vo(d,1);continue}if(f.selected)return d;f.today&&!l&&(l=d),a||(a=d),d=Vo(d,1)}return l||a}var gyt=365;function Vme(e,t){var n=t.moveBy,i=t.direction,a=t.context,l=t.modifiers,d=t.retry,f=d===void 0?{count:0,lastFocused:e}:d,m=a.weekStartsOn,v=a.fromDate,E=a.toDate,S=a.locale,T={day:Vo,week:gU,month:Lc,year:igt,startOfWeek:function(P){return a.ISOWeek?Rp(P):Nl(P,{locale:S,weekStartsOn:m})},endOfWeek:function(P){return a.ISOWeek?Cme(P):KB(P,{locale:S,weekStartsOn:m})}},R=T[n](e,i==="after"?1:-1);i==="before"&&v?R=ogt([v,R]):i==="after"&&E&&(R=sgt([E,R]));var I=!0;if(l){var O=QB(R,l);I=!O.disabled&&!O.hidden}return I?R:f.count>gyt?f.lastFocused:Vme(R,{moveBy:n,direction:i,context:a,modifiers:l,retry:Ut(Ut({},f),{count:f.count+1})})}var Fme=N.createContext(void 0);function vyt(e){var t=e0(),n=Ume(),i=N.useState(),a=i[0],l=i[1],d=N.useState(),f=d[0],m=d[1],v=myt(t.displayMonths,n),E=a??(f&&t.isDateDisplayed(f))?f:v,S=function(){m(a),l(void 0)},T=function(P){l(P)},R=Cr(),I=function(P,D){if(a){var k=Vme(a,{moveBy:P,direction:D,context:R,modifiers:n});ys(a,k)||(t.goToDate(k,a),T(k))}},O={focusedDay:a,focusTarget:E,blur:S,focus:T,focusDayAfter:function(){return I("day","after")},focusDayBefore:function(){return I("day","before")},focusWeekAfter:function(){return I("week","after")},focusWeekBefore:function(){return I("week","before")},focusMonthBefore:function(){return I("month","before")},focusMonthAfter:function(){return I("month","after")},focusYearBefore:function(){return I("year","before")},focusYearAfter:function(){return I("year","after")},focusStartOfWeek:function(){return I("startOfWeek","before")},focusEndOfWeek:function(){return I("endOfWeek","after")}};return _.jsx(Fme.Provider,{value:O,children:e.children})}function ZB(){var e=N.useContext(Fme);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function yyt(e,t){var n=Ume(),i=QB(e,n,t);return i}var e3=N.createContext(void 0);function _yt(e){if(!ox(e.initialProps)){var t={selected:void 0};return _.jsx(e3.Provider,{value:t,children:e.children})}return _.jsx(Eyt,{initialProps:e.initialProps,children:e.children})}function Eyt(e){var t=e.initialProps,n=e.children,i=function(l,d,f){var m,v,E;if((m=t.onDayClick)===null||m===void 0||m.call(t,l,d,f),d.selected&&!t.required){(v=t.onSelect)===null||v===void 0||v.call(t,void 0,l,d,f);return}(E=t.onSelect)===null||E===void 0||E.call(t,l,l,d,f)},a={selected:t.selected,onDayClick:i};return _.jsx(e3.Provider,{value:a,children:n})}function Bme(){var e=N.useContext(e3);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function byt(e,t){var n=Cr(),i=Bme(),a=qB(),l=JB(),d=ZB(),f=d.focusDayAfter,m=d.focusDayBefore,v=d.focusWeekAfter,E=d.focusWeekBefore,S=d.blur,T=d.focus,R=d.focusMonthBefore,I=d.focusMonthAfter,O=d.focusYearBefore,P=d.focusYearAfter,D=d.focusStartOfWeek,k=d.focusEndOfWeek,M=function(te){var ne,ue,_e,Ce;ox(n)?(ne=i.onDayClick)===null||ne===void 0||ne.call(i,e,t,te):QS(n)?(ue=a.onDayClick)===null||ue===void 0||ue.call(a,e,t,te):ZS(n)?(_e=l.onDayClick)===null||_e===void 0||_e.call(l,e,t,te):(Ce=n.onDayClick)===null||Ce===void 0||Ce.call(n,e,t,te)},$=function(te){var ne;T(e),(ne=n.onDayFocus)===null||ne===void 0||ne.call(n,e,t,te)},V=function(te){var ne;S(),(ne=n.onDayBlur)===null||ne===void 0||ne.call(n,e,t,te)},W=function(te){var ne;(ne=n.onDayMouseEnter)===null||ne===void 0||ne.call(n,e,t,te)},H=function(te){var ne;(ne=n.onDayMouseLeave)===null||ne===void 0||ne.call(n,e,t,te)},J=function(te){var ne;(ne=n.onDayPointerEnter)===null||ne===void 0||ne.call(n,e,t,te)},ee=function(te){var ne;(ne=n.onDayPointerLeave)===null||ne===void 0||ne.call(n,e,t,te)},le=function(te){var ne;(ne=n.onDayTouchCancel)===null||ne===void 0||ne.call(n,e,t,te)},he=function(te){var ne;(ne=n.onDayTouchEnd)===null||ne===void 0||ne.call(n,e,t,te)},de=function(te){var ne;(ne=n.onDayTouchMove)===null||ne===void 0||ne.call(n,e,t,te)},ae=function(te){var ne;(ne=n.onDayTouchStart)===null||ne===void 0||ne.call(n,e,t,te)},ce=function(te){var ne;(ne=n.onDayKeyUp)===null||ne===void 0||ne.call(n,e,t,te)},ge=function(te){var ne;switch(te.key){case"ArrowLeft":te.preventDefault(),te.stopPropagation(),n.dir==="rtl"?f():m();break;case"ArrowRight":te.preventDefault(),te.stopPropagation(),n.dir==="rtl"?m():f();break;case"ArrowDown":te.preventDefault(),te.stopPropagation(),v();break;case"ArrowUp":te.preventDefault(),te.stopPropagation(),E();break;case"PageUp":te.preventDefault(),te.stopPropagation(),te.shiftKey?O():R();break;case"PageDown":te.preventDefault(),te.stopPropagation(),te.shiftKey?P():I();break;case"Home":te.preventDefault(),te.stopPropagation(),D();break;case"End":te.preventDefault(),te.stopPropagation(),k();break}(ne=n.onDayKeyDown)===null||ne===void 0||ne.call(n,e,t,te)},ye={onClick:M,onFocus:$,onBlur:V,onKeyDown:ge,onKeyUp:ce,onMouseEnter:W,onMouseLeave:H,onPointerEnter:J,onPointerLeave:ee,onTouchCancel:le,onTouchEnd:he,onTouchMove:de,onTouchStart:ae};return ye}function Syt(){var e=Cr(),t=Bme(),n=qB(),i=JB(),a=ox(e)?t.selected:QS(e)?n.selected:ZS(e)?i.selected:void 0;return a}function wyt(e){return Object.values(Mc).includes(e)}function Tyt(e,t){var n=[e.classNames.day];return Object.keys(t).forEach(function(i){var a=e.modifiersClassNames[i];if(a)n.push(a);else if(wyt(i)){var l=e.classNames["day_".concat(i)];l&&n.push(l)}}),n}function Cyt(e,t){var n=Ut({},e.styles.day);return Object.keys(t).forEach(function(i){var a;n=Ut(Ut({},n),(a=e.modifiersStyles)===null||a===void 0?void 0:a[i])}),n}function Ryt(e,t,n){var i,a,l,d=Cr(),f=ZB(),m=yyt(e,t),v=byt(e,m),E=Syt(),S=!!(d.onDayClick||d.mode!=="default");N.useEffect(function(){var W;m.outside||f.focusedDay&&S&&ys(f.focusedDay,e)&&((W=n.current)===null||W===void 0||W.focus())},[f.focusedDay,e,n,S,m.outside]);var T=Tyt(d,m).join(" "),R=Cyt(d,m),I=!!(m.outside&&!d.showOutsideDays||m.hidden),O=(l=(a=d.components)===null||a===void 0?void 0:a.DayContent)!==null&&l!==void 0?l:zvt,P=_.jsx(O,{date:e,displayMonth:t,activeModifiers:m}),D={style:R,className:T,children:P,role:"gridcell"},k=f.focusTarget&&ys(f.focusTarget,e)&&!m.outside,M=f.focusedDay&&ys(f.focusedDay,e),$=Ut(Ut(Ut({},D),(i={disabled:m.disabled,role:"gridcell"},i["aria-selected"]=m.selected,i.tabIndex=M||k?0:-1,i)),v),V={isButton:S,isHidden:I,activeModifiers:m,selectedDays:E,buttonProps:$,divProps:D};return V}function Ayt(e){var t=N.useRef(null),n=Ryt(e.date,e.displayMonth,t);return n.isHidden?_.jsx("div",{role:"gridcell"}):n.isButton?_.jsx(rO,Ut({name:"day",ref:t},n.buttonProps)):_.jsx("div",Ut({},n.divProps))}function Oyt(e){var t=e.number,n=e.dates,i=Cr(),a=i.onWeekNumberClick,l=i.styles,d=i.classNames,f=i.locale,m=i.labels.labelWeekNumber,v=i.formatters.formatWeekNumber,E=v(Number(t),{locale:f});if(!a)return _.jsx("span",{className:d.weeknumber,style:l.weeknumber,children:E});var S=m(Number(t),{locale:f}),T=function(R){a(t,n,R)};return _.jsx(rO,{name:"week-number","aria-label":S,className:d.weeknumber,style:l.weeknumber,onClick:T,children:E})}function Iyt(e){var t,n,i=Cr(),a=i.styles,l=i.classNames,d=i.showWeekNumber,f=i.components,m=(t=f==null?void 0:f.Day)!==null&&t!==void 0?t:Ayt,v=(n=f==null?void 0:f.WeekNumber)!==null&&n!==void 0?n:Oyt,E;return d&&(E=_.jsx("td",{className:l.cell,style:a.cell,children:_.jsx(v,{number:e.weekNumber,dates:e.dates})})),_.jsxs("tr",{className:l.row,style:a.row,children:[E,e.dates.map(function(S){return _.jsx("td",{className:l.cell,style:a.cell,role:"presentation",children:_.jsx(m,{displayMonth:e.displayMonth,date:S})},ovt(S))})]})}function Kne(e,t,n){for(var i=n!=null&&n.ISOWeek?Cme(t):KB(t,n),a=n!=null&&n.ISOWeek?Rp(e):Nl(e,n),l=bl(i,a),d=[],f=0;f<=l;f++)d.push(Vo(a,f));var m=d.reduce(function(v,E){var S=n!=null&&n.ISOWeek?Ame(E):Ime(E,n),T=v.find(function(R){return R.weekNumber===S});return T?(T.dates.push(E),v):(v.push({weekNumber:S,dates:[E]}),v)},[]);return m}function xyt(e,t){var n=Kne(Ss(e),HB(e),t);if(t!=null&&t.useFixedWeeks){var i=avt(e,t);if(i<6){var a=n[n.length-1],l=a.dates[a.dates.length-1],d=gU(l,6-i),f=Kne(gU(l,1),d,t);n.push.apply(n,f)}}return n}function Pyt(e){var t,n,i,a=Cr(),l=a.locale,d=a.classNames,f=a.styles,m=a.hideHead,v=a.fixedWeeks,E=a.components,S=a.weekStartsOn,T=a.firstWeekContainsDate,R=a.ISOWeek,I=xyt(e.displayMonth,{useFixedWeeks:!!v,ISOWeek:R,locale:l,weekStartsOn:S,firstWeekContainsDate:T}),O=(t=E==null?void 0:E.Head)!==null&&t!==void 0?t:Kvt,P=(n=E==null?void 0:E.Row)!==null&&n!==void 0?n:Iyt,D=(i=E==null?void 0:E.Footer)!==null&&i!==void 0?i:Wvt;return _.jsxs("table",{id:e.id,className:d.table,style:f.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!m&&_.jsx(O,{}),_.jsx("tbody",{className:d.tbody,style:f.tbody,children:I.map(function(k){return _.jsx(P,{displayMonth:e.displayMonth,dates:k.dates,weekNumber:k.weekNumber},k.weekNumber)})}),_.jsx(D,{displayMonth:e.displayMonth})]})}function Nyt(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Dyt=Nyt()?N.useLayoutEffect:N.useEffect,JL=!1,kyt=0;function zne(){return"react-day-picker-".concat(++kyt)}function Lyt(e){var t,n=e??(JL?zne():null),i=N.useState(n),a=i[0],l=i[1];return Dyt(function(){a===null&&l(zne())},[]),N.useEffect(function(){JL===!1&&(JL=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function Myt(e){var t,n,i=Cr(),a=i.dir,l=i.classNames,d=i.styles,f=i.components,m=e0().displayMonths,v=Lyt(i.id?"".concat(i.id,"-").concat(e.displayIndex):void 0),E=i.id?"".concat(i.id,"-grid-").concat(e.displayIndex):void 0,S=[l.month],T=d.month,R=e.displayIndex===0,I=e.displayIndex===m.length-1,O=!R&&!I;a==="rtl"&&(t=[R,I],I=t[0],R=t[1]),R&&(S.push(l.caption_start),T=Ut(Ut({},T),d.caption_start)),I&&(S.push(l.caption_end),T=Ut(Ut({},T),d.caption_end)),O&&(S.push(l.caption_between),T=Ut(Ut({},T),d.caption_between));var P=(n=f==null?void 0:f.Caption)!==null&&n!==void 0?n:$vt;return _.jsxs("div",{className:S.join(" "),style:T,children:[_.jsx(P,{id:v,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),_.jsx(Pyt,{id:E,"aria-labelledby":v,displayMonth:e.displayMonth})]},e.displayIndex)}function jyt(e){var t=Cr(),n=t.classNames,i=t.styles;return _.jsx("div",{className:n.months,style:i.months,children:e.children})}function Uyt(e){var t,n,i=e.initialProps,a=Cr(),l=ZB(),d=e0(),f=N.useState(!1),m=f[0],v=f[1];N.useEffect(function(){a.initialFocus&&l.focusTarget&&(m||(l.focus(l.focusTarget),v(!0)))},[a.initialFocus,m,l.focus,l.focusTarget,l]);var E=[a.classNames.root,a.className];a.numberOfMonths>1&&E.push(a.classNames.multiple_months),a.showWeekNumber&&E.push(a.classNames.with_weeknumber);var S=Ut(Ut({},a.styles.root),a.style),T=Object.keys(i).filter(function(I){return I.startsWith("data-")}).reduce(function(I,O){var P;return Ut(Ut({},I),(P={},P[O]=i[O],P))},{}),R=(n=(t=i.components)===null||t===void 0?void 0:t.Months)!==null&&n!==void 0?n:jyt;return _.jsx("div",Ut({className:E.join(" "),style:S,dir:a.dir,id:a.id,nonce:i.nonce,title:i.title,lang:i.lang},T,{children:_.jsx(R,{children:d.displayMonths.map(function(I,O){return _.jsx(Myt,{displayIndex:O,displayMonth:I},O)})})}))}function Vyt(e){var t=e.children,n=lvt(e,["children"]);return _.jsx(Ovt,{initialProps:n,children:_.jsx(Uvt,{children:_.jsx(_yt,{initialProps:n,children:_.jsx(Yvt,{initialProps:n,children:_.jsx(Jvt,{initialProps:n,children:_.jsx(oyt,{children:_.jsx(vyt,{children:t})})})})})})})}function Fyt(e){return _.jsx(Vyt,Ut({},e,{children:_.jsx(Uyt,{initialProps:e})}))}function $me({className:e,classNames:t,showOutsideDays:n=!0,...i}){return _.jsx(Fyt,{showOutsideDays:n,className:gt("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:gt(N2({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:gt(N2({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...a})=>_.jsx(RLe,{className:"h-4 w-4"}),IconRight:({...a})=>_.jsx(Zoe,{className:"h-4 w-4"})},...i})}$me.displayName="Calendar";const Dd=[{level:"CA Foundation",subjects:["Principles and Practice of Accounting","Business Laws and Business Correspondence and Reporting","Business Mathematics, Logical Reasoning and Statistics","Business Economics and Business and Commercial Knowledge"]},{level:"CA Intermediate",subjects:["Accounting","Corporate and Other Laws","Cost and Management Accounting","Taxation","Advanced Accounting","Auditing and Assurance","Enterprise Information Systems & Strategic Management","Financial Management & Economics for Finance"]},{level:"CA Final",subjects:["Financial Reporting","Strategic Financial Management","Advanced Auditing and Professional Ethics","Corporate and Economic Laws","Strategic Cost Management and Performance Evaluation","Direct Tax Laws and International Taxation","Indirect Tax Laws"]}],t3=N.forwardRef(({className:e,...t},n)=>_.jsx("div",{className:"relative w-full overflow-auto",children:_.jsx("table",{ref:n,className:gt("w-full caption-bottom text-sm",e),...t})}));t3.displayName="Table";const n3=N.forwardRef(({className:e,...t},n)=>_.jsx("thead",{ref:n,className:gt("[&_tr]:border-b",e),...t}));n3.displayName="TableHeader";const r3=N.forwardRef(({className:e,...t},n)=>_.jsx("tbody",{ref:n,className:gt("[&_tr:last-child]:border-0",e),...t}));r3.displayName="TableBody";const Byt=N.forwardRef(({className:e,...t},n)=>_.jsx("tfoot",{ref:n,className:gt("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Byt.displayName="TableFooter";const _S=N.forwardRef(({className:e,...t},n)=>_.jsx("tr",{ref:n,className:gt("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));_S.displayName="TableRow";const yu=N.forwardRef(({className:e,...t},n)=>_.jsx("th",{ref:n,className:gt("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));yu.displayName="TableHead";const _u=N.forwardRef(({className:e,...t},n)=>_.jsx("td",{ref:n,className:gt("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));_u.displayName="TableCell";const $yt=N.forwardRef(({className:e,...t},n)=>_.jsx("caption",{ref:n,className:gt("mt-4 text-sm text-muted-foreground",e),...t}));$yt.displayName="TableCaption";function QL(e){return`${e.toFixed(1)} hrs`}const Wyt=()=>{var de;N.useEffect(()=>{window.scrollTo(0,0)},[]);const[e,t]=N.useState(Dd[0].level),n=((de=Dd.find(ae=>ae.level===e))==null?void 0:de.subjects)||[],[i,a]=N.useState([]),[l,d]=N.useState(!0),[f,m]=N.useState(null),{user:v}=jc();N.useEffect(()=>{v&&(d(!0),Wt.from("study_sessions").select("*").eq("user_id",v.id).then(({data:ae,error:ce})=>{if(ce){m("Failed to load sessions"),d(!1);return}ae&&a(ae.map(ge=>({id:ge.id,subject:ge.subject,date:new Date(ge.date),startTime:ge.start_time||"09:00",endTime:ge.end_time||"10:00",notes:ge.description||""}))),d(!1)}))},[v]),N.useEffect(()=>{if(!v||l)return;const ae=i.map(ce=>{const[ge,ye]=ce.startTime.split(":").map(Number),[te,ne]=ce.endTime.split(":").map(Number),ue=Math.round(te+ne/60-(ge+ye/60));return{id:ce.id,user_id:v.id,subject:ce.subject,date:ce.date instanceof Date?ce.date.toISOString():ce.date,description:ce.notes||"",title:ce.subject+" session",duration:ue>0?ue:1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}});ae.length>0&&Wt.from("study_sessions").upsert(ae,{onConflict:"id"}).then(({error:ce})=>{ce&&(alert("Failed to save to Supabase: "+ce.message),console.error("Supabase upsert error:",ce))})},[i,v,l]);const[E,S]=N.useState(!1),[T,R]=N.useState(()=>{var ce;const ae=localStorage.getItem("newSession");if(ae)try{const ge=JSON.parse(ae);return{...ge,date:new Date(ge.date)}}catch{}return{id:Date.now(),subject:((ce=Dd.find(ge=>ge.level===Dd[0].level))==null?void 0:ce.subjects[0])||"",date:new Date,startTime:"09:00",endTime:"10:00",notes:""}}),[I,O]=N.useState(()=>{const ae=localStorage.getItem("plannerDate");if(ae)try{return new Date(ae)}catch{}return new Date}),P=i.filter(ae=>I&&ae.date.toDateString()===I.toDateString());N.useEffect(()=>{localStorage.setItem("studySessions",JSON.stringify(i))},[i]),N.useEffect(()=>{localStorage.setItem("newSession",JSON.stringify(T))},[T]),N.useEffect(()=>{I&&localStorage.setItem("plannerDate",I.toISOString())},[I]);const[D,k]=N.useState(!1),M=()=>{var ae;a([...i,{...T,id:crypto.randomUUID()}]),S(!1),R({id:crypto.randomUUID(),subject:((ae=Dd.find(ce=>ce.level===Dd[0].level))==null?void 0:ae.subjects[0])||"",date:new Date,startTime:"09:00",endTime:"10:00",notes:""}),k(!0),setTimeout(()=>k(!1),2e3)},$=ae=>{a(ce=>ce.filter(ge=>ge.id!==ae))};function V(){let ae=0;for(const ce of i){const[ge,ye]=ce.startTime.split(":").map(Number),[te,ne]=ce.endTime.split(":").map(Number);let ue=te+ne/60-(ge+ye/60);ue>0&&(ae+=ue)}return ae}const W=V();function H(){const ae=new Date,ce=new Date(ae);ce.setDate(ae.getDate()-ae.getDay());let ge=0;for(const ye of i)if(ye.date>=ce&&ye.date<=ae){const[te,ne]=ye.startTime.split(":").map(Number),[ue,_e]=ye.endTime.split(":").map(Number);let Ce=ue+_e/60-(te+ne/60);Ce>0&&(ge+=Ce)}return ge}const J=H();function ee(){const ae={};for(const ye of i){const[te,ne]=ye.startTime.split(":").map(Number),[ue,_e]=ye.endTime.split(":").map(Number);let Ce=ue+_e/60-(te+ne/60);Ce>0&&(ae[ye.subject]=(ae[ye.subject]||0)+Ce)}let ce="-",ge=0;for(const ye of Object.keys(ae))ae[ye]>ge&&(ce=ye,ge=ae[ye]);return{subject:ce,hours:ge}}const le=ee();function he(){const ae={};for(const ce of i){const[ge,ye]=ce.startTime.split(":").map(Number),[te,ne]=ce.endTime.split(":").map(Number);let ue=te+ne/60-(ge+ye/60);ue>0&&(ae[ce.subject]=(ae[ce.subject]||0)+ue)}return ae}return he(),_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"container py-8 md:py-12",children:_.jsx(Nr,{children:_.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Study Planner"})})}),_.jsxs("div",{className:"space-y-6",children:[_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[_.jsxs(Zn,{children:[_.jsxs(Zr,{className:"pb-2",children:[_.jsx(pr,{className:"text-sm font-medium text-muted-foreground",children:"Total Study Time"}),_.jsx(ms,{className:"text-2xl font-bold",children:QL(W)})]}),_.jsx(mr,{children:_.jsxs("div",{className:"text-xs text-muted-foreground",children:["Across ",i.length," sessions"]})})]}),_.jsxs(Zn,{children:[_.jsxs(Zr,{className:"pb-2",children:[_.jsx(pr,{className:"text-sm font-medium text-muted-foreground",children:"This Week"}),_.jsx(ms,{className:"text-2xl font-bold",children:QL(J)})]}),_.jsx(mr,{children:_.jsx("div",{className:"text-xs text-muted-foreground",children:J>0?`Aiming for ~${Math.ceil(J/7*30)}h this month`:"No study sessions this week"})})]}),_.jsxs(Zn,{children:[_.jsxs(Zr,{className:"pb-2",children:[_.jsx(pr,{className:"text-sm font-medium text-muted-foreground",children:"Top Subject"}),_.jsx(ms,{className:"text-2xl font-bold",children:le.subject})]}),_.jsx(mr,{children:_.jsx("div",{className:"text-xs text-muted-foreground",children:le.hours>0?`${QL(le.hours)} studied`:"No data yet"})})]})]}),_.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[_.jsx("div",{className:"lg:col-span-2 space-y-6",children:_.jsx(Nr,{delay:.1,children:_.jsxs(Zn,{children:[_.jsxs(Zr,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[_.jsxs("div",{children:[_.jsx(pr,{children:"Calendar"}),_.jsx(ms,{children:"Plan your study sessions"})]}),_.jsxs(hh,{open:E,onOpenChange:S,children:[_.jsx(fh,{asChild:!0,children:_.jsx(vn,{children:"Add Session"})}),_.jsxs(Tu,{className:"sm:max-w-[425px]",children:[_.jsxs(Cu,{children:[_.jsx(Au,{children:"Add Study Session"}),_.jsx(Ou,{children:"Create a new study session for your calendar."})]}),_.jsxs("div",{className:"grid gap-4 py-4",children:[_.jsxs("div",{className:"grid gap-2",children:[_.jsx(fr,{htmlFor:"level",children:"CA Level"}),_.jsxs(yl,{value:e,onValueChange:ae=>{var ge;t(ae);const ce=((ge=Dd.find(ye=>ye.level===ae))==null?void 0:ge.subjects[0])||"";R(ye=>({...ye,subject:ce}))},children:[_.jsx(Oc,{id:"level",children:_.jsx(_l,{placeholder:"Select CA Level"})}),_.jsx(Ic,{children:Dd.map(ae=>_.jsx(Kn,{value:ae.level,children:ae.level},ae.level))})]})]}),_.jsxs("div",{className:"grid gap-2",children:[_.jsx(fr,{htmlFor:"subject",children:"Subject"}),_.jsxs(yl,{value:T.subject,onValueChange:ae=>R({...T,subject:ae}),children:[_.jsx(Oc,{id:"subject",children:_.jsx(_l,{placeholder:"Select subject"})}),_.jsx(Ic,{children:n.map(ae=>_.jsx(Kn,{value:ae,children:ae},ae))})]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[_.jsxs("div",{className:"grid gap-2",children:[_.jsx(fr,{htmlFor:"start-time",children:"Start Time"}),_.jsx(_n,{id:"start-time",type:"time",value:T.startTime,onChange:ae=>R({...T,startTime:ae.target.value})})]}),_.jsxs("div",{className:"grid gap-2",children:[_.jsx(fr,{htmlFor:"end-time",children:"End Time"}),_.jsx(_n,{id:"end-time",type:"time",value:T.endTime,onChange:ae=>R({...T,endTime:ae.target.value})})]})]}),_.jsxs("div",{className:"grid gap-2",children:[_.jsx(fr,{htmlFor:"notes",children:"Notes (Optional)"}),_.jsx(_n,{id:"notes",value:T.notes,onChange:ae=>R({...T,notes:ae.target.value}),placeholder:"Topics to cover, chapters to read, etc."})]})]}),_.jsx(Ru,{children:_.jsx(vn,{onClick:M,children:"Add Session"})})]})]})]}),_.jsx(mr,{className:"pl-2",children:_.jsxs("div",{className:"flex flex-col md:flex-row",children:[_.jsx("div",{className:"md:w-1/2",children:_.jsx($me,{mode:"single",selected:I,onSelect:O,className:"rounded-md border",initialFocus:!0})}),_.jsxs("div",{className:"md:w-1/2 p-4 space-y-4",children:[_.jsx("h3",{className:"font-medium",children:I?Vh(I,"MMMM d, yyyy"):"Select a date"}),P.length===0?_.jsx("p",{className:"text-muted-foreground",children:"No study sessions scheduled for this date."}):_.jsx("div",{className:"space-y-3",children:P.map(ae=>_.jsxs("div",{className:"p-3 border rounded-md",children:[_.jsxs("div",{className:"flex justify-between mb-1",children:[_.jsx("h4",{className:"font-medium",children:ae.subject}),_.jsx(vn,{variant:"ghost",size:"sm",className:"h-5 text-xs",onClick:()=>$(ae.id),children:"Delete"})]}),_.jsxs("p",{className:"text-sm text-muted-foreground",children:[ae.startTime," - ",ae.endTime]}),ae.notes&&_.jsx("p",{className:"text-sm mt-1",children:ae.notes})]},ae.id))})]})]})})]})})}),_.jsx("div",{className:"space-y-6",children:_.jsx(Nr,{delay:.4,children:_.jsxs(Zn,{children:[_.jsx(Zr,{children:_.jsx(pr,{children:"Study Tips"})}),_.jsx(mr,{className:"space-y-4",children:_.jsxs("div",{className:"space-y-2",children:[_.jsx("h4",{className:"font-medium",children:"Effective CA Exam Preparation"}),_.jsxs("ul",{className:"list-disc pl-4 space-y-1 text-sm",children:[_.jsx("li",{children:"Focus on understanding concepts rather than memorization"}),_.jsx("li",{children:"Practice previous year question papers"}),_.jsx("li",{children:"Maintain a separate notebook for formulas and key points"}),_.jsx("li",{children:"Use the Pomodoro technique for focused study sessions"}),_.jsx("li",{children:"Alternate between difficult and easier subjects"})]})]})})]})})})]})]})]}),_.jsx("div",{className:"fixed bottom-4 right-4 z-0 opacity-60 pointer-events-none select-none"}),_.jsx("div",{className:"fixed bottom-8 right-8 z-50",children:_.jsx(cp,{name:"book-light",className:"w-36 h-36 drop-shadow-xl transition-all duration-500",on:D})})]})};var Wme={exports:{}},Gme={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gv=N;function Gyt(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Hyt=typeof Object.is=="function"?Object.is:Gyt,Kyt=Gv.useState,zyt=Gv.useEffect,Yyt=Gv.useLayoutEffect,qyt=Gv.useDebugValue;function Xyt(e,t){var n=t(),i=Kyt({inst:{value:n,getSnapshot:t}}),a=i[0].inst,l=i[1];return Yyt(function(){a.value=n,a.getSnapshot=t,ZL(a)&&l({inst:a})},[e,n,t]),zyt(function(){return ZL(a)&&l({inst:a}),e(function(){ZL(a)&&l({inst:a})})},[e]),qyt(n),n}function ZL(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Hyt(e,n)}catch{return!0}}function Jyt(e,t){return t()}var Qyt=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Jyt:Xyt;Gme.useSyncExternalStore=Gv.useSyncExternalStore!==void 0?Gv.useSyncExternalStore:Qyt;Wme.exports=Gme;var Zyt=Wme.exports;function e_t(){return Zyt.useSyncExternalStore(t_t,()=>!0,()=>!1)}function t_t(){return()=>{}}var i3="Avatar",[n_t,DEt]=ta(i3),[r_t,Hme]=n_t(i3),Kme=N.forwardRef((e,t)=>{const{__scopeAvatar:n,...i}=e,[a,l]=N.useState("idle");return _.jsx(r_t,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:l,children:_.jsx(yt.span,{...i,ref:t})})});Kme.displayName=i3;var zme="AvatarImage",Yme=N.forwardRef((e,t)=>{const{__scopeAvatar:n,src:i,onLoadingStatusChange:a=()=>{},...l}=e,d=Hme(zme,n),f=i_t(i,l),m=hi(v=>{a(v),d.onImageLoadingStatusChange(v)});return Ei(()=>{f!=="idle"&&m(f)},[f,m]),f==="loaded"?_.jsx(yt.img,{...l,ref:t,src:i}):null});Yme.displayName=zme;var qme="AvatarFallback",Xme=N.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:i,...a}=e,l=Hme(qme,n),[d,f]=N.useState(i===void 0);return N.useEffect(()=>{if(i!==void 0){const m=window.setTimeout(()=>f(!0),i);return()=>window.clearTimeout(m)}},[i]),d&&l.imageLoadingStatus!=="loaded"?_.jsx(yt.span,{...a,ref:t}):null});Xme.displayName=qme;function Yne(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function i_t(e,{referrerPolicy:t,crossOrigin:n}){const i=e_t(),a=N.useRef(null),l=i?(a.current||(a.current=new window.Image),a.current):null,[d,f]=N.useState(()=>Yne(l,e));return Ei(()=>{f(Yne(l,e))},[l,e]),Ei(()=>{const m=S=>()=>{f(S)};if(!l)return;const v=m("loaded"),E=m("error");return l.addEventListener("load",v),l.addEventListener("error",E),t&&(l.referrerPolicy=t),typeof n=="string"&&(l.crossOrigin=n),()=>{l.removeEventListener("load",v),l.removeEventListener("error",E)}},[l,n,t]),d}var Jme=Kme,Qme=Yme,Zme=Xme;const rb=N.forwardRef(({className:e,...t},n)=>_.jsx(Jme,{ref:n,className:gt("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));rb.displayName=Jme.displayName;const ege=N.forwardRef(({className:e,...t},n)=>_.jsx(Qme,{ref:n,className:gt("aspect-square h-full w-full",e),...t}));ege.displayName=Qme.displayName;const ib=N.forwardRef(({className:e,...t},n)=>_.jsx(Zme,{ref:n,className:gt("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));ib.displayName=Zme.displayName;function o_t(e,t){return N.useReducer((n,i)=>t[n][i]??n,e)}var o3="ScrollArea",[tge,kEt]=ta(o3),[s_t,za]=tge(o3),nge=N.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:i="hover",dir:a,scrollHideDelay:l=600,...d}=e,[f,m]=N.useState(null),[v,E]=N.useState(null),[S,T]=N.useState(null),[R,I]=N.useState(null),[O,P]=N.useState(null),[D,k]=N.useState(0),[M,$]=N.useState(0),[V,W]=N.useState(!1),[H,J]=N.useState(!1),ee=fn(t,he=>m(he)),le=jS(a);return _.jsx(s_t,{scope:n,type:i,dir:le,scrollHideDelay:l,scrollArea:f,viewport:v,onViewportChange:E,content:S,onContentChange:T,scrollbarX:R,onScrollbarXChange:I,scrollbarXEnabled:V,onScrollbarXEnabledChange:W,scrollbarY:O,onScrollbarYChange:P,scrollbarYEnabled:H,onScrollbarYEnabledChange:J,onCornerWidthChange:k,onCornerHeightChange:$,children:_.jsx(yt.div,{dir:le,...d,ref:ee,style:{position:"relative","--radix-scroll-area-corner-width":D+"px","--radix-scroll-area-corner-height":M+"px",...e.style}})})});nge.displayName=o3;var rge="ScrollAreaViewport",ige=N.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:i,nonce:a,...l}=e,d=za(rge,n),f=N.useRef(null),m=fn(t,f,d.onViewportChange);return _.jsxs(_.Fragment,{children:[_.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),_.jsx(yt.div,{"data-radix-scroll-area-viewport":"",...l,ref:m,style:{overflowX:d.scrollbarXEnabled?"scroll":"hidden",overflowY:d.scrollbarYEnabled?"scroll":"hidden",...e.style},children:_.jsx("div",{ref:d.onContentChange,style:{minWidth:"100%",display:"table"},children:i})})]})});ige.displayName=rge;var Ml="ScrollAreaScrollbar",s3=N.forwardRef((e,t)=>{const{forceMount:n,...i}=e,a=za(Ml,e.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:d}=a,f=e.orientation==="horizontal";return N.useEffect(()=>(f?l(!0):d(!0),()=>{f?l(!1):d(!1)}),[f,l,d]),a.type==="hover"?_.jsx(a_t,{...i,ref:t,forceMount:n}):a.type==="scroll"?_.jsx(c_t,{...i,ref:t,forceMount:n}):a.type==="auto"?_.jsx(oge,{...i,ref:t,forceMount:n}):a.type==="always"?_.jsx(a3,{...i,ref:t}):null});s3.displayName=Ml;var a_t=N.forwardRef((e,t)=>{const{forceMount:n,...i}=e,a=za(Ml,e.__scopeScrollArea),[l,d]=N.useState(!1);return N.useEffect(()=>{const f=a.scrollArea;let m=0;if(f){const v=()=>{window.clearTimeout(m),d(!0)},E=()=>{m=window.setTimeout(()=>d(!1),a.scrollHideDelay)};return f.addEventListener("pointerenter",v),f.addEventListener("pointerleave",E),()=>{window.clearTimeout(m),f.removeEventListener("pointerenter",v),f.removeEventListener("pointerleave",E)}}},[a.scrollArea,a.scrollHideDelay]),_.jsx(Ao,{present:n||l,children:_.jsx(oge,{"data-state":l?"visible":"hidden",...i,ref:t})})}),c_t=N.forwardRef((e,t)=>{const{forceMount:n,...i}=e,a=za(Ml,e.__scopeScrollArea),l=e.orientation==="horizontal",d=ax(()=>m("SCROLL_END"),100),[f,m]=o_t("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return N.useEffect(()=>{if(f==="idle"){const v=window.setTimeout(()=>m("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(v)}},[f,a.scrollHideDelay,m]),N.useEffect(()=>{const v=a.viewport,E=l?"scrollLeft":"scrollTop";if(v){let S=v[E];const T=()=>{const R=v[E];S!==R&&(m("SCROLL"),d()),S=R};return v.addEventListener("scroll",T),()=>v.removeEventListener("scroll",T)}},[a.viewport,l,m,d]),_.jsx(Ao,{present:n||f!=="hidden",children:_.jsx(a3,{"data-state":f==="hidden"?"hidden":"visible",...i,ref:t,onPointerEnter:et(e.onPointerEnter,()=>m("POINTER_ENTER")),onPointerLeave:et(e.onPointerLeave,()=>m("POINTER_LEAVE"))})})}),oge=N.forwardRef((e,t)=>{const n=za(Ml,e.__scopeScrollArea),{forceMount:i,...a}=e,[l,d]=N.useState(!1),f=e.orientation==="horizontal",m=ax(()=>{if(n.viewport){const v=n.viewport.offsetWidth<n.viewport.scrollWidth,E=n.viewport.offsetHeight<n.viewport.scrollHeight;d(f?v:E)}},10);return Hv(n.viewport,m),Hv(n.content,m),_.jsx(Ao,{present:i||l,children:_.jsx(a3,{"data-state":l?"visible":"hidden",...a,ref:t})})}),a3=N.forwardRef((e,t)=>{const{orientation:n="vertical",...i}=e,a=za(Ml,e.__scopeScrollArea),l=N.useRef(null),d=N.useRef(0),[f,m]=N.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),v=uge(f.viewport,f.content),E={...i,sizes:f,onSizesChange:m,hasThumb:v>0&&v<1,onThumbChange:T=>l.current=T,onThumbPointerUp:()=>d.current=0,onThumbPointerDown:T=>d.current=T};function S(T,R){return p_t(T,d.current,f,R)}return n==="horizontal"?_.jsx(l_t,{...E,ref:t,onThumbPositionChange:()=>{if(a.viewport&&l.current){const T=a.viewport.scrollLeft,R=qne(T,f,a.dir);l.current.style.transform=`translate3d(${R}px, 0, 0)`}},onWheelScroll:T=>{a.viewport&&(a.viewport.scrollLeft=T)},onDragScroll:T=>{a.viewport&&(a.viewport.scrollLeft=S(T,a.dir))}}):n==="vertical"?_.jsx(u_t,{...E,ref:t,onThumbPositionChange:()=>{if(a.viewport&&l.current){const T=a.viewport.scrollTop,R=qne(T,f);l.current.style.transform=`translate3d(0, ${R}px, 0)`}},onWheelScroll:T=>{a.viewport&&(a.viewport.scrollTop=T)},onDragScroll:T=>{a.viewport&&(a.viewport.scrollTop=S(T))}}):null}),l_t=N.forwardRef((e,t)=>{const{sizes:n,onSizesChange:i,...a}=e,l=za(Ml,e.__scopeScrollArea),[d,f]=N.useState(),m=N.useRef(null),v=fn(t,m,l.onScrollbarXChange);return N.useEffect(()=>{m.current&&f(getComputedStyle(m.current))},[m]),_.jsx(age,{"data-orientation":"horizontal",...a,ref:v,sizes:n,style:{bottom:0,left:l.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:l.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":sx(n)+"px",...e.style},onThumbPointerDown:E=>e.onThumbPointerDown(E.x),onDragScroll:E=>e.onDragScroll(E.x),onWheelScroll:(E,S)=>{if(l.viewport){const T=l.viewport.scrollLeft+E.deltaX;e.onWheelScroll(T),hge(T,S)&&E.preventDefault()}},onResize:()=>{m.current&&l.viewport&&d&&i({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:m.current.clientWidth,paddingStart:oO(d.paddingLeft),paddingEnd:oO(d.paddingRight)}})}})}),u_t=N.forwardRef((e,t)=>{const{sizes:n,onSizesChange:i,...a}=e,l=za(Ml,e.__scopeScrollArea),[d,f]=N.useState(),m=N.useRef(null),v=fn(t,m,l.onScrollbarYChange);return N.useEffect(()=>{m.current&&f(getComputedStyle(m.current))},[m]),_.jsx(age,{"data-orientation":"vertical",...a,ref:v,sizes:n,style:{top:0,right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":sx(n)+"px",...e.style},onThumbPointerDown:E=>e.onThumbPointerDown(E.y),onDragScroll:E=>e.onDragScroll(E.y),onWheelScroll:(E,S)=>{if(l.viewport){const T=l.viewport.scrollTop+E.deltaY;e.onWheelScroll(T),hge(T,S)&&E.preventDefault()}},onResize:()=>{m.current&&l.viewport&&d&&i({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:m.current.clientHeight,paddingStart:oO(d.paddingTop),paddingEnd:oO(d.paddingBottom)}})}})}),[d_t,sge]=tge(Ml),age=N.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:i,hasThumb:a,onThumbChange:l,onThumbPointerUp:d,onThumbPointerDown:f,onThumbPositionChange:m,onDragScroll:v,onWheelScroll:E,onResize:S,...T}=e,R=za(Ml,n),[I,O]=N.useState(null),P=fn(t,ee=>O(ee)),D=N.useRef(null),k=N.useRef(""),M=R.viewport,$=i.content-i.viewport,V=hi(E),W=hi(m),H=ax(S,10);function J(ee){if(D.current){const le=ee.clientX-D.current.left,he=ee.clientY-D.current.top;v({x:le,y:he})}}return N.useEffect(()=>{const ee=le=>{const he=le.target;(I==null?void 0:I.contains(he))&&V(le,$)};return document.addEventListener("wheel",ee,{passive:!1}),()=>document.removeEventListener("wheel",ee,{passive:!1})},[M,I,$,V]),N.useEffect(W,[i,W]),Hv(I,H),Hv(R.content,H),_.jsx(d_t,{scope:n,scrollbar:I,hasThumb:a,onThumbChange:hi(l),onThumbPointerUp:hi(d),onThumbPositionChange:W,onThumbPointerDown:hi(f),children:_.jsx(yt.div,{...T,ref:P,style:{position:"absolute",...T.style},onPointerDown:et(e.onPointerDown,ee=>{ee.button===0&&(ee.target.setPointerCapture(ee.pointerId),D.current=I.getBoundingClientRect(),k.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",R.viewport&&(R.viewport.style.scrollBehavior="auto"),J(ee))}),onPointerMove:et(e.onPointerMove,J),onPointerUp:et(e.onPointerUp,ee=>{const le=ee.target;le.hasPointerCapture(ee.pointerId)&&le.releasePointerCapture(ee.pointerId),document.body.style.webkitUserSelect=k.current,R.viewport&&(R.viewport.style.scrollBehavior=""),D.current=null})})})}),iO="ScrollAreaThumb",cge=N.forwardRef((e,t)=>{const{forceMount:n,...i}=e,a=sge(iO,e.__scopeScrollArea);return _.jsx(Ao,{present:n||a.hasThumb,children:_.jsx(h_t,{ref:t,...i})})}),h_t=N.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:i,...a}=e,l=za(iO,n),d=sge(iO,n),{onThumbPositionChange:f}=d,m=fn(t,S=>d.onThumbChange(S)),v=N.useRef(void 0),E=ax(()=>{v.current&&(v.current(),v.current=void 0)},100);return N.useEffect(()=>{const S=l.viewport;if(S){const T=()=>{if(E(),!v.current){const R=m_t(S,f);v.current=R,f()}};return f(),S.addEventListener("scroll",T),()=>S.removeEventListener("scroll",T)}},[l.viewport,E,f]),_.jsx(yt.div,{"data-state":d.hasThumb?"visible":"hidden",...a,ref:m,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...i},onPointerDownCapture:et(e.onPointerDownCapture,S=>{const R=S.target.getBoundingClientRect(),I=S.clientX-R.left,O=S.clientY-R.top;d.onThumbPointerDown({x:I,y:O})}),onPointerUp:et(e.onPointerUp,d.onThumbPointerUp)})});cge.displayName=iO;var c3="ScrollAreaCorner",lge=N.forwardRef((e,t)=>{const n=za(c3,e.__scopeScrollArea),i=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&i?_.jsx(f_t,{...e,ref:t}):null});lge.displayName=c3;var f_t=N.forwardRef((e,t)=>{const{__scopeScrollArea:n,...i}=e,a=za(c3,n),[l,d]=N.useState(0),[f,m]=N.useState(0),v=!!(l&&f);return Hv(a.scrollbarX,()=>{var S;const E=((S=a.scrollbarX)==null?void 0:S.offsetHeight)||0;a.onCornerHeightChange(E),m(E)}),Hv(a.scrollbarY,()=>{var S;const E=((S=a.scrollbarY)==null?void 0:S.offsetWidth)||0;a.onCornerWidthChange(E),d(E)}),v?_.jsx(yt.div,{...i,ref:t,style:{width:l,height:f,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function oO(e){return e?parseInt(e,10):0}function uge(e,t){const n=e/t;return isNaN(n)?0:n}function sx(e){const t=uge(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=(e.scrollbar.size-n)*t;return Math.max(i,18)}function p_t(e,t,n,i="ltr"){const a=sx(n),l=a/2,d=t||l,f=a-d,m=n.scrollbar.paddingStart+d,v=n.scrollbar.size-n.scrollbar.paddingEnd-f,E=n.content-n.viewport,S=i==="ltr"?[0,E]:[E*-1,0];return dge([m,v],S)(e)}function qne(e,t,n="ltr"){const i=sx(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,l=t.scrollbar.size-a,d=t.content-t.viewport,f=l-i,m=n==="ltr"?[0,d]:[d*-1,0],v=j2(e,m);return dge([0,d],[0,f])(v)}function dge(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const i=(t[1]-t[0])/(e[1]-e[0]);return t[0]+i*(n-e[0])}}function hge(e,t){return e>0&&e<t}var m_t=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},i=0;return function a(){const l={left:e.scrollLeft,top:e.scrollTop},d=n.left!==l.left,f=n.top!==l.top;(d||f)&&t(),n=l,i=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(i)};function ax(e,t){const n=hi(e),i=N.useRef(0);return N.useEffect(()=>()=>window.clearTimeout(i.current),[]),N.useCallback(()=>{window.clearTimeout(i.current),i.current=window.setTimeout(n,t)},[n,t])}function Hv(e,t){const n=hi(t);Ei(()=>{let i=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(i),i=window.requestAnimationFrame(n)});return a.observe(e),()=>{window.cancelAnimationFrame(i),a.unobserve(e)}}},[e,n])}var fge=nge,g_t=ige,v_t=lge;const pge=N.forwardRef(({className:e,children:t,...n},i)=>_.jsxs(fge,{ref:i,className:gt("relative overflow-hidden",e),...n,children:[_.jsx(g_t,{className:"h-full w-full rounded-[inherit]",children:t}),_.jsx(mge,{}),_.jsx(v_t,{})]}));pge.displayName=fge.displayName;const mge=N.forwardRef(({className:e,orientation:t="vertical",...n},i)=>_.jsx(s3,{ref:i,orientation:t,className:gt("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...n,children:_.jsx(cge,{className:"relative flex-1 rounded-full bg-border"})}));mge.displayName=s3.displayName;class y_t{generateRoomCode(){return Math.floor(1e5+Math.random()*9e5)}generateAgoraChannel(t){return`room_${t.replace(/[^a-zA-Z0-9]/g,"")}`}convertParticipants(t){return t?Array.isArray(t)?t.map(n=>String(n)):[]:[]}async create(t){const n=this.generateRoomCode();try{const{data:i,error:a}=await Wt.from("study_rooms").insert([{...t,room_code:n,voice_enabled:!0,daily_room_url:this.generateAgoraChannel(n.toString())}]).select().single();if(a)throw console.error("Error creating study room:",a),new Error(a.message);return console.log("Study room created successfully:",i),{...i,participants:this.convertParticipants(i.participants)}}catch(i){throw console.error("Error in StudyRoomService.create:",i),i}}async getAll(){try{const{data:t,error:n}=await Wt.from("study_rooms").select("*").order("created_at",{ascending:!1});if(n)throw console.error("Error fetching study rooms:",n),new Error(n.message);return(t||[]).map(i=>({...i,participants:this.convertParticipants(i.participants)}))}catch(t){throw console.error("Error in StudyRoomService.getAll:",t),t}}async getRoomByCode(t){try{const{data:n,error:i}=await Wt.from("study_rooms").select("*").eq("room_code",t).single();return i?(console.error("Error fetching study room by code:",i),null):n?{...n,participants:this.convertParticipants(n.participants)}:null}catch(n){throw console.error("Error in StudyRoomService.getRoomByCode:",n),n}}async joinRoom(t,n){try{const i=await this.getRoomByCode(t);if(!i)throw new Error("Room not found");if(i.participants.includes(n)){console.log("User already in the room");return}const a=[...i.participants,n],{error:l}=await Wt.from("study_rooms").update({participants:a}).eq("room_code",t);if(l)throw console.error("Error joining study room:",l),new Error(l.message)}catch(i){throw console.error("Error in StudyRoomService.joinRoom:",i),i}}async leaveRoom(t,n){try{const i=await this.getRoomByCode(t);if(!i)throw new Error("Room not found");if(!i.participants.includes(n)){console.log("User not in the room");return}const a=i.participants.filter(d=>d!==n),{error:l}=await Wt.from("study_rooms").update({participants:a}).eq("room_code",t);if(l)throw console.error("Error leaving study room:",l),new Error(l.message)}catch(i){throw console.error("Error in StudyRoomService.leaveRoom:",i),i}}async deleteRoom(t){try{const{error:n}=await Wt.from("study_rooms").delete().eq("id",t);if(n)throw console.error("Error deleting study room:",n),new Error(n.message)}catch(n){throw console.error("Error in StudyRoomService.deleteRoom:",n),n}}async toggleVoiceChat(t,n){try{const{error:i}=await Wt.from("study_rooms").update({voice_enabled:n}).eq("id",t);if(i)throw console.error("Error toggling voice chat:",i),new Error(i.message)}catch(i){throw console.error("Error in StudyRoomService.toggleVoiceChat:",i),i}}}const kd=new y_t;var gge={exports:{}};(function(e,t){(function(n,i){e.exports=i()})(Ri,function(){function n(r,o){return o.forEach(function(s){s&&typeof s!="string"&&!Array.isArray(s)&&Object.keys(s).forEach(function(c){if(c!=="default"&&!(c in r)){var u=Object.getOwnPropertyDescriptor(s,c);Object.defineProperty(r,c,u.get?u:{enumerable:!0,get:function(){return s[c]}})}})}),Object.freeze(r)}var i=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Ri<"u"?Ri:typeof self<"u"?self:{};function a(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var l=function(r){try{return!!r()}catch{return!0}},d=!l(function(){var r=(function(){}).bind();return typeof r!="function"||r.hasOwnProperty("prototype")}),f=d,m=Function.prototype,v=m.call,E=f&&m.bind.bind(v,v),S=f?E:function(r){return function(){return v.apply(r,arguments)}},T=S({}.isPrototypeOf),R=function(r){return r&&r.Math===Math&&r},I=R(typeof globalThis=="object"&&globalThis)||R(typeof window=="object"&&window)||R(typeof self=="object"&&self)||R(typeof i=="object"&&i)||R(typeof i=="object"&&i)||function(){return this}()||Function("return this")(),O=d,P=Function.prototype,D=P.apply,k=P.call,M=typeof Reflect=="object"&&Reflect.apply||(O?k.bind(D):function(){return k.apply(D,arguments)}),$=S,V=$({}.toString),W=$("".slice),H=function(r){return W(V(r),8,-1)},J=H,ee=S,le=function(r){if(J(r)==="Function")return ee(r)},he=typeof document=="object"&&document.all,de=he===void 0&&he!==void 0?function(r){return typeof r=="function"||r===he}:function(r){return typeof r=="function"},ae={},ce=!l(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),ge=d,ye=Function.prototype.call,te=ge?ye.bind(ye):function(){return ye.apply(ye,arguments)},ne={},ue={}.propertyIsEnumerable,_e=Object.getOwnPropertyDescriptor,Ce=_e&&!ue.call({1:2},1);ne.f=Ce?function(r){var o=_e(this,r);return!!o&&o.enumerable}:ue;var Ie,Ge,Ze=function(r,o){return{enumerable:!(1&r),configurable:!(2&r),writable:!(4&r),value:o}},wt=l,Ft=H,ze=Object,Nt=S("".split),we=wt(function(){return!ze("z").propertyIsEnumerable(0)})?function(r){return Ft(r)==="String"?Nt(r,""):ze(r)}:ze,He=function(r){return r==null},Ke=He,Re=TypeError,at=function(r){if(Ke(r))throw new Re("Can't call method on "+r);return r},mt=we,At=at,nn=function(r){return mt(At(r))},Mr=de,Mn=function(r){return typeof r=="object"?r!==null:Mr(r)},ar={},Ya=ar,Ji=I,na=de,Yo=function(r){return na(r)?r:void 0},ni=function(r,o){return arguments.length<2?Yo(Ya[r])||Yo(Ji[r]):Ya[r]&&Ya[r][o]||Ji[r]&&Ji[r][o]},Fh=I.navigator,Oo=Fh&&Fh.userAgent,lo=Oo?String(Oo):"",t0=I,_y=lo,Bh=t0.process,n0=t0.Deno,Ey=Bh&&Bh.versions||n0&&n0.version,Up=Ey&&Ey.v8;Up&&(Ge=(Ie=Up.split("."))[0]>0&&Ie[0]<4?1:+(Ie[0]+Ie[1])),!Ge&&_y&&(!(Ie=_y.match(/Edge\/(\d+)/))||Ie[1]>=74)&&(Ie=_y.match(/Chrome\/(\d+)/))&&(Ge=+Ie[1]);var qo=Ge,by=qo,Ju=l,lx=I.String,Qu=!!Object.getOwnPropertySymbols&&!Ju(function(){var r=Symbol("symbol detection");return!lx(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&by&&by<41}),Sy=Qu&&!Symbol.sham&&typeof Symbol.iterator=="symbol",r0=ni,ux=de,wy=T,Fc=Object,$h=Sy?function(r){return typeof r=="symbol"}:function(r){var o=r0("Symbol");return ux(o)&&wy(o.prototype,Fc(r))},Gt=String,wn=function(r){try{return Gt(r)}catch{return"Object"}},vr=de,Ts=wn,Cs=TypeError,Wr=function(r){if(vr(r))return r;throw new Cs(Ts(r)+" is not a function")},jl=Wr,Rs=He,As=function(r,o){var s=r[o];return Rs(s)?void 0:jl(s)},d3=te,h3=de,f3=Mn,Age=TypeError,p3={exports:{}},m3=I,Oge=Object.defineProperty,Ige=I,xge=function(r,o){try{Oge(m3,r,{value:o,configurable:!0,writable:!0})}catch{m3[r]=o}return o},g3="__core-js_shared__",v3=p3.exports=Ige[g3]||xge(g3,{});(v3.versions||(v3.versions=[])).push({version:"3.42.0",mode:"pure",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.42.0/LICENSE",source:"https://github.com/zloirock/core-js"});var dx=p3.exports,y3=dx,Vp=function(r,o){return y3[r]||(y3[r]=o||{})},Pge=at,Nge=Object,Bc=function(r){return Nge(Pge(r))},Dge=Bc,kge=S({}.hasOwnProperty),bi=Object.hasOwn||function(r,o){return kge(Dge(r),o)},Lge=S,Mge=0,jge=Math.random(),Uge=Lge(1 .toString),hx=function(r){return"Symbol("+(r===void 0?"":r)+")_"+Uge(++Mge+jge,36)},Vge=Vp,_3=bi,Fge=hx,Bge=Qu,$ge=Sy,Fp=I.Symbol,fx=Vge("wks"),Wge=$ge?Fp.for||Fp:Fp&&Fp.withoutSetter||Fge,cr=function(r){return _3(fx,r)||(fx[r]=Bge&&_3(Fp,r)?Fp[r]:Wge("Symbol."+r)),fx[r]},Gge=te,E3=Mn,b3=$h,Hge=As,Kge=function(r,o){var s,c;if(h3(s=r.toString)&&!f3(c=d3(s,r))||h3(s=r.valueOf)&&!f3(c=d3(s,r)))return c;throw new Age("Can't convert object to primitive value")},zge=TypeError,Yge=cr("toPrimitive"),qge=function(r,o){if(!E3(r)||b3(r))return r;var s,c=Hge(r,Yge);if(c){if(s=Gge(c,r,o),!E3(s)||b3(s))return s;throw new zge("Can't convert object to primitive value")}return Kge(r)},Xge=$h,px=function(r){var o=qge(r,"string");return Xge(o)?o:o+""},S3=Mn,mx=I.document,Jge=S3(mx)&&S3(mx.createElement),gx=function(r){return Jge?mx.createElement(r):{}},Qge=gx,w3=!ce&&!l(function(){return Object.defineProperty(Qge("div"),"a",{get:function(){return 7}}).a!==7}),Zge=ce,eve=te,tve=ne,nve=Ze,rve=nn,ive=px,ove=bi,sve=w3,T3=Object.getOwnPropertyDescriptor;ae.f=Zge?T3:function(r,o){if(r=rve(r),o=ive(o),sve)try{return T3(r,o)}catch{}if(ove(r,o))return nve(!eve(tve.f,r,o),r[o])};var ave=l,cve=de,lve=/#|\.prototype\./,Ty=function(r,o){var s=dve[uve(r)];return s===fve||s!==hve&&(cve(o)?ave(o):!!o)},uve=Ty.normalize=function(r){return String(r).replace(lve,".").toLowerCase()},dve=Ty.data={},hve=Ty.NATIVE="N",fve=Ty.POLYFILL="P",C3=Ty,pve=Wr,mve=d,gve=le(le.bind),Zu=function(r,o){return pve(r),o===void 0?r:mve?gve(r,o):function(){return r.apply(o,arguments)}},ra={},R3=ce&&l(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),vve=Mn,yve=String,_ve=TypeError,Io=function(r){if(vve(r))return r;throw new _ve(yve(r)+" is not an object")},Eve=ce,bve=w3,Sve=R3,i0=Io,A3=px,wve=TypeError,vx=Object.defineProperty,Tve=Object.getOwnPropertyDescriptor,yx="enumerable",_x="configurable",Ex="writable";ra.f=Eve?Sve?function(r,o,s){if(i0(r),o=A3(o),i0(s),typeof r=="function"&&o==="prototype"&&"value"in s&&Ex in s&&!s[Ex]){var c=Tve(r,o);c&&c[Ex]&&(r[o]=s.value,s={configurable:_x in s?s[_x]:c[_x],enumerable:yx in s?s[yx]:c[yx],writable:!1})}return vx(r,o,s)}:vx:function(r,o,s){if(i0(r),o=A3(o),i0(s),bve)try{return vx(r,o,s)}catch{}if("get"in s||"set"in s)throw new wve("Accessors not supported");return"value"in s&&(r[o]=s.value),r};var Cve=ra,Rve=Ze,Wh=ce?function(r,o,s){return Cve.f(r,o,Rve(1,s))}:function(r,o,s){return r[o]=s,r},Cy=I,Ave=M,Ove=le,Ive=de,xve=ae.f,Pve=C3,Bp=ar,Nve=Zu,$p=Wh,O3=bi,Dve=function(r){var o=function(s,c,u){if(this instanceof o){switch(arguments.length){case 0:return new r;case 1:return new r(s);case 2:return new r(s,c)}return new r(s,c,u)}return Ave(r,this,arguments)};return o.prototype=r.prototype,o},Kt=function(r,o){var s,c,u,h,p,g,y,b,w,C=r.target,A=r.global,x=r.stat,B=r.proto,U=A?Cy:x?Cy[C]:Cy[C]&&Cy[C].prototype,F=A?Bp:Bp[C]||$p(Bp,C,{})[C],K=F.prototype;for(h in o)c=!(s=Pve(A?h:C+(x?".":"#")+h,r.forced))&&U&&O3(U,h),g=F[h],c&&(y=r.dontCallGetSet?(w=xve(U,h))&&w.value:U[h]),p=c&&y?y:o[h],(s||B||typeof g!=typeof p)&&(b=r.bind&&c?Nve(p,Cy):r.wrap&&c?Dve(p):B&&Ive(p)?Ove(p):p,(r.sham||p&&p.sham||g&&g.sham)&&$p(b,"sham",!0),$p(F,h,b),B&&(O3(Bp,u=C+"Prototype")||$p(Bp,u,{}),$p(Bp[u],h,p),r.real&&K&&(s||!K[h])&&$p(K,h,p)))},kve=Math.ceil,Lve=Math.floor,Mve=Math.trunc||function(r){var o=+r;return(o>0?Lve:kve)(o)},jve=Mve,bx=function(r){var o=+r;return o!=o||o===0?0:jve(o)},Uve=bx,Vve=Math.max,Fve=Math.min,Sx=function(r,o){var s=Uve(r);return s<0?Vve(s+o,0):Fve(s,o)},Bve=bx,$ve=Math.min,I3=function(r){var o=Bve(r);return o>0?$ve(o,9007199254740991):0},Wve=I3,ed=function(r){return Wve(r.length)},Gve=nn,Hve=Sx,Kve=ed,x3=function(r){return function(o,s,c){var u=Gve(o),h=Kve(u);if(h===0)return!r&&-1;var p,g=Hve(c,h);if(r&&s!=s){for(;h>g;)if((p=u[g++])!=p)return!0}else for(;h>g;g++)if((r||g in u)&&u[g]===s)return r||g||0;return!r&&-1}},wx={includes:x3(!0),indexOf:x3(!1)},zve=wx.includes;Kt({target:"Array",proto:!0,forced:l(function(){return!Array(1).includes()})},{includes:function(r){return zve(this,r,arguments.length>1?arguments[1]:void 0)}});var Yve=I,qve=ar,ia=function(r,o){var s=qve[r+"Prototype"],c=s&&s[o];if(c)return c;var u=Yve[r],h=u&&u.prototype;return h&&h[o]},Xve=ia("Array","includes"),Jve=Mn,Qve=H,Zve=cr("match"),P3=function(r){var o;return Jve(r)&&((o=r[Zve])!==void 0?!!o:Qve(r)==="RegExp")},eye=P3,tye=TypeError,N3={};N3[cr("toStringTag")]="z";var Tx=String(N3)==="[object z]",nye=Tx,rye=de,o0=H,iye=cr("toStringTag"),oye=Object,sye=o0(function(){return arguments}())==="Arguments",td=nye?o0:function(r){var o,s,c;return r===void 0?"Undefined":r===null?"Null":typeof(s=function(u,h){try{return u[h]}catch{}}(o=oye(r),iye))=="string"?s:sye?o0(o):(c=o0(o))==="Object"&&rye(o.callee)?"Arguments":c},aye=td,cye=String,Xo=function(r){if(aye(r)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return cye(r)},lye=cr("match"),uye=Kt,dye=function(r){if(eye(r))throw new tye("The method doesn't accept regular expressions");return r},hye=at,D3=Xo,fye=function(r){var o=/./;try{"/./"[r](o)}catch{try{return o[lye]=!1,"/./"[r](o)}catch{}}return!1},pye=S("".indexOf);uye({target:"String",proto:!0,forced:!fye("includes")},{includes:function(r){return!!~pye(D3(hye(this)),D3(dye(r)),arguments.length>1?arguments[1]:void 0)}});var mye=ia("String","includes"),k3=T,gye=Xve,vye=mye,Cx=Array.prototype,Rx=String.prototype,yye=function(r){var o=r.includes;return r===Cx||k3(Cx,r)&&o===Cx.includes?gye:typeof r=="string"||r===Rx||k3(Rx,r)&&o===Rx.includes?vye:o},Pe=a(yye),_ye=Wr,Eye=Bc,bye=we,Sye=ed,L3=TypeError,M3="Reduce of empty array with no initial value",wye=function(r){return function(o,s,c,u){var h=Eye(o),p=bye(h),g=Sye(h);if(_ye(s),g===0&&c<2)throw new L3(M3);var y=r?g-1:0,b=r?-1:1;if(c<2)for(;;){if(y in p){u=p[y],y+=b;break}if(y+=b,r?y<0:g<=y)throw new L3(M3)}for(;r?y>=0:g>y;y+=b)y in p&&(u=s(u,p[y],y,h));return u}},Tye={left:wye(!1)},Cye=l,s0=function(r,o){var s=[][r];return!!s&&Cye(function(){s.call(null,o||function(){return 1},1)})},Ry=I,Rye=lo,Aye=H,a0=function(r){return Rye.slice(0,r.length)===r},Ax=a0("Bun/")?"BUN":a0("Cloudflare-Workers")?"CLOUDFLARE":a0("Deno/")?"DENO":a0("Node.js/")?"NODE":Ry.Bun&&typeof Bun.version=="string"?"BUN":Ry.Deno&&typeof Deno.version=="object"?"DENO":Aye(Ry.process)==="process"?"NODE":Ry.window&&Ry.document?"BROWSER":"REST",c0=Ax==="NODE",Oye=Tye.left;Kt({target:"Array",proto:!0,forced:!c0&&qo>79&&qo<83||!s0("reduce")},{reduce:function(r){var o=arguments.length;return Oye(this,r,o,o>1?arguments[1]:void 0)}});var Iye=ia("Array","reduce"),xye=T,Pye=Iye,Ox=Array.prototype,Nye=function(r){var o=r.reduce;return r===Ox||xye(Ox,r)&&o===Ox.reduce?Pye:o},j3=Nye,oa=a(j3),Dye=H,Ay=Array.isArray||function(r){return Dye(r)==="Array"},kye=Kt,Lye=Ay,Mye=S([].reverse),U3=[1,2];kye({target:"Array",proto:!0,forced:String(U3)===String(U3.reverse())},{reverse:function(){return Lye(this)&&(this.length=this.length),Mye(this)}});var jye=ia("Array","reverse"),Uye=T,Vye=jye,Ix=Array.prototype,Fye=function(r){var o=r.reverse;return r===Ix||Uye(Ix,r)&&o===Ix.reverse?Vye:o},V3=Fye,F3=a(V3),Bye=hx,B3=Vp("keys"),l0=function(r){return B3[r]||(B3[r]=Bye(r))},$ye=!l(function(){function r(){}return r.prototype.constructor=null,Object.getPrototypeOf(new r)!==r.prototype}),Wye=bi,Gye=de,Hye=Bc,Kye=$ye,$3=l0("IE_PROTO"),xx=Object,zye=xx.prototype,Px=Kye?xx.getPrototypeOf:function(r){var o=Hye(r);if(Wye(o,$3))return o[$3];var s=o.constructor;return Gye(s)&&o instanceof s?s.prototype:o instanceof xx?zye:null},Yye=S,qye=Wr,Xye=Mn,Jye=function(r){return Xye(r)||r===null},Qye=String,Zye=TypeError,e_e=function(r,o,s){try{return Yye(qye(Object.getOwnPropertyDescriptor(r,o)[s]))}catch{}},t_e=Mn,n_e=at,r_e=function(r){if(Jye(r))return r;throw new Zye("Can't set "+Qye(r)+" as a prototype")},i_e=Object.setPrototypeOf||("__proto__"in{}?function(){var r,o=!1,s={};try{(r=e_e(Object.prototype,"__proto__","set"))(s,[]),o=s instanceof Array}catch{}return function(c,u){return n_e(c),r_e(u),t_e(c)&&(o?r(c,u):c.__proto__=u),c}}():void 0),u0={},d0={},Nx=bi,o_e=nn,s_e=wx.indexOf,a_e=d0,W3=S([].push),G3=function(r,o){var s,c=o_e(r),u=0,h=[];for(s in c)!Nx(a_e,s)&&Nx(c,s)&&W3(h,s);for(;o.length>u;)Nx(c,s=o[u++])&&(~s_e(h,s)||W3(h,s));return h},Dx=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],c_e=G3,l_e=Dx.concat("length","prototype");u0.f=Object.getOwnPropertyNames||function(r){return c_e(r,l_e)};var Oy={};Oy.f=Object.getOwnPropertySymbols;var u_e=ni,d_e=u0,h_e=Oy,f_e=Io,p_e=S([].concat),m_e=u_e("Reflect","ownKeys")||function(r){var o=d_e.f(f_e(r)),s=h_e.f;return s?p_e(o,s(r)):o},H3=bi,g_e=m_e,v_e=ae,y_e=ra,kx={},__e=G3,E_e=Dx,h0=Object.keys||function(r){return __e(r,E_e)},b_e=ce,S_e=R3,w_e=ra,T_e=Io,C_e=nn,R_e=h0;kx.f=b_e&&!S_e?Object.defineProperties:function(r,o){T_e(r);for(var s,c=C_e(o),u=R_e(o),h=u.length,p=0;h>p;)w_e.f(r,s=u[p++],c[s]);return r};var f0,K3=ni("document","documentElement"),A_e=Io,O_e=kx,z3=Dx,I_e=d0,x_e=K3,P_e=gx,Lx="prototype",Mx="script",Y3=l0("IE_PROTO"),jx=function(){},q3=function(r){return"<"+Mx+">"+r+"</"+Mx+">"},X3=function(r){r.write(q3("")),r.close();var o=r.parentWindow.Object;return r=null,o},p0=function(){try{f0=new ActiveXObject("htmlfile")}catch{}var r,o,s;p0=typeof document<"u"?document.domain&&f0?X3(f0):(o=P_e("iframe"),s="java"+Mx+":",o.style.display="none",x_e.appendChild(o),o.src=String(s),(r=o.contentWindow.document).open(),r.write(q3("document.F=Object")),r.close(),r.F):X3(f0);for(var c=z3.length;c--;)delete p0[Lx][z3[c]];return p0()};I_e[Y3]=!0;var Iy=Object.create||function(r,o){var s;return r!==null?(jx[Lx]=A_e(r),s=new jx,jx[Lx]=null,s[Y3]=r):s=p0(),o===void 0?s:O_e.f(s,o)},N_e=Mn,D_e=Wh,J3=Error,k_e=S("".replace),L_e=String(new J3("zxcasd").stack),Q3=/\n\s*at [^:]*:[^\n]*/,M_e=Q3.test(L_e),j_e=Ze,U_e=!l(function(){var r=new Error("a");return!("stack"in r)||(Object.defineProperty(r,"stack",j_e(1,7)),r.stack!==7)}),V_e=Wh,F_e=function(r,o){if(M_e&&typeof r=="string"&&!J3.prepareStackTrace)for(;o--;)r=k_e(r,Q3,"");return r},B_e=U_e,Z3=Error.captureStackTrace,Wp={},$_e=Wp,W_e=cr("iterator"),G_e=Array.prototype,e4=function(r){return r!==void 0&&($_e.Array===r||G_e[W_e]===r)},H_e=td,t4=As,K_e=He,z_e=Wp,Y_e=cr("iterator"),m0=function(r){if(!K_e(r))return t4(r,Y_e)||t4(r,"@@iterator")||z_e[H_e(r)]},q_e=te,X_e=Wr,J_e=Io,Q_e=wn,Z_e=m0,eEe=TypeError,Ux=function(r,o){var s=arguments.length<2?Z_e(r):o;if(X_e(s))return J_e(q_e(s,r));throw new eEe(Q_e(r)+" is not iterable")},tEe=te,n4=Io,nEe=As,r4=function(r,o,s){var c,u;n4(r);try{if(!(c=nEe(r,"return"))){if(o==="throw")throw s;return s}c=tEe(c,r)}catch(h){u=!0,c=h}if(o==="throw")throw s;if(u)throw c;return n4(c),s},rEe=Zu,iEe=te,oEe=Io,sEe=wn,aEe=e4,cEe=ed,i4=T,lEe=Ux,uEe=m0,o4=r4,dEe=TypeError,g0=function(r,o){this.stopped=r,this.result=o},s4=g0.prototype,xy=function(r,o,s){var c,u,h,p,g,y,b,w=s&&s.that,C=!(!s||!s.AS_ENTRIES),A=!(!s||!s.IS_RECORD),x=!(!s||!s.IS_ITERATOR),B=!(!s||!s.INTERRUPTED),U=rEe(o,w),F=function(z){return c&&o4(c,"normal",z),new g0(!0,z)},K=function(z){return C?(oEe(z),B?U(z[0],z[1],F):U(z[0],z[1])):B?U(z,F):U(z)};if(A)c=r.iterator;else if(x)c=r;else{if(!(u=uEe(r)))throw new dEe(sEe(r)+" is not iterable");if(aEe(u)){for(h=0,p=cEe(r);p>h;h++)if((g=K(r[h]))&&i4(s4,g))return g;return new g0(!1)}c=lEe(r,u)}for(y=A?r.next:c.next;!(b=iEe(y,c)).done;){try{g=K(b.value)}catch(z){o4(c,"throw",z)}if(typeof g=="object"&&g&&i4(s4,g))return g}return new g0(!1)},hEe=Xo,fEe=Kt,pEe=T,mEe=Px,v0=i_e,gEe=function(r,o,s){for(var c=g_e(o),u=y_e.f,h=v_e.f,p=0;p<c.length;p++){var g=c[p];H3(r,g)||s&&H3(s,g)||u(r,g,h(o,g))}},a4=Iy,Vx=Wh,Fx=Ze,vEe=function(r,o){N_e(o)&&"cause"in o&&D_e(r,"cause",o.cause)},yEe=function(r,o,s,c){B_e&&(Z3?Z3(r,o):V_e(r,"stack",F_e(s,c)))},_Ee=xy,EEe=function(r,o){return r===void 0?arguments.length<2?"":o:hEe(r)},bEe=cr("toStringTag"),y0=Error,SEe=[].push,Gp=function(r,o){var s,c=pEe(Bx,this);v0?s=v0(new y0,c?mEe(this):Bx):(s=c?this:a4(Bx),Vx(s,bEe,"Error")),o!==void 0&&Vx(s,"message",EEe(o)),yEe(s,Gp,s.stack,1),arguments.length>2&&vEe(s,arguments[2]);var u=[];return _Ee(r,SEe,{that:u}),Vx(s,"errors",u),s};v0?v0(Gp,y0):gEe(Gp,y0,{name:!0});var Bx=Gp.prototype=a4(y0.prototype,{constructor:Fx(1,Gp),message:Fx(1,""),name:Fx(1,"AggregateError")});fEe({global:!0},{AggregateError:Gp});var _0,Py,E0,wEe=de,c4=I.WeakMap,TEe=wEe(c4)&&/native code/.test(String(c4)),l4=I,CEe=Mn,REe=Wh,$x=bi,Wx=dx,AEe=l0,OEe=d0,u4="Object already initialized",Gx=l4.TypeError,IEe=l4.WeakMap;if(TEe||Wx.state){var $c=Wx.state||(Wx.state=new IEe);$c.get=$c.get,$c.has=$c.has,$c.set=$c.set,_0=function(r,o){if($c.has(r))throw new Gx(u4);return o.facade=r,$c.set(r,o),o},Py=function(r){return $c.get(r)||{}},E0=function(r){return $c.has(r)}}else{var Hp=AEe("state");OEe[Hp]=!0,_0=function(r,o){if($x(r,Hp))throw new Gx(u4);return o.facade=r,REe(r,Hp,o),o},Py=function(r){return $x(r,Hp)?r[Hp]:{}},E0=function(r){return $x(r,Hp)}}var Gh,d4,h4,Hh={set:_0,get:Py,has:E0,enforce:function(r){return E0(r)?Py(r):_0(r,{})},getterFor:function(r){return function(o){var s;if(!CEe(o)||(s=Py(o)).type!==r)throw new Gx("Incompatible receiver, "+r+" required");return s}}},Hx=ce,xEe=bi,f4=Function.prototype,PEe=Hx&&Object.getOwnPropertyDescriptor,p4=xEe(f4,"name"),m4={PROPER:p4&&(function(){}).name==="something",CONFIGURABLE:p4&&(!Hx||Hx&&PEe(f4,"name").configurable)},NEe=Wh,nd=function(r,o,s,c){return c&&c.enumerable?r[o]=s:NEe(r,o,s),r},DEe=l,kEe=de,LEe=Mn,MEe=Iy,g4=Px,jEe=nd,Kx=cr("iterator"),v4=!1;[].keys&&("next"in(h4=[].keys())?(d4=g4(g4(h4)))!==Object.prototype&&(Gh=d4):v4=!0);var UEe=!LEe(Gh)||DEe(function(){var r={};return Gh[Kx].call(r)!==r});kEe((Gh=UEe?{}:MEe(Gh))[Kx])||jEe(Gh,Kx,function(){return this});var y4={IteratorPrototype:Gh,BUGGY_SAFARI_ITERATORS:v4},VEe=td,FEe=Tx?{}.toString:function(){return"[object "+VEe(this)+"]"},BEe=Tx,$Ee=ra.f,WEe=Wh,GEe=bi,HEe=FEe,_4=cr("toStringTag"),Ul=function(r,o,s,c){var u=s?r:r&&r.prototype;u&&(GEe(u,_4)||$Ee(u,_4,{configurable:!0,value:o}),c&&!BEe&&WEe(u,"toString",HEe))},KEe=y4.IteratorPrototype,zEe=Iy,YEe=Ze,qEe=Ul,XEe=Wp,JEe=function(){return this},zx=function(r,o,s,c){var u=o+" Iterator";return r.prototype=zEe(KEe,{next:YEe(+!c,s)}),qEe(r,u,!1,!0),XEe[u]=JEe,r},QEe=Kt,ZEe=te,ebe=m4,tbe=zx,nbe=Px,rbe=Ul,E4=nd,b4=Wp,ibe=y4,obe=ebe.PROPER,b0=ibe.BUGGY_SAFARI_ITERATORS,Yx=cr("iterator"),S4="keys",S0="values",w4="entries",sbe=function(){return this},T4=function(r,o,s,c,u,h,p){tbe(s,o,c);var g,y,b,w=function(K){if(K===u&&U)return U;if(!b0&&K&&K in x)return x[K];switch(K){case S4:case S0:case w4:return function(){return new s(this,K)}}return function(){return new s(this)}},C=o+" Iterator",A=!1,x=r.prototype,B=x[Yx]||x["@@iterator"]||u&&x[u],U=!b0&&B||w(u),F=o==="Array"&&x.entries||B;if(F&&(g=nbe(F.call(new r)))!==Object.prototype&&g.next&&(rbe(g,C,!0,!0),b4[C]=sbe),obe&&u===S0&&B&&B.name!==S0&&(A=!0,U=function(){return ZEe(B,this)}),u)if(y={values:w(S0),keys:h?U:w(S4),entries:w(w4)},p)for(b in y)(b0||A||!(b in x))&&E4(x,b,y[b]);else QEe({target:o,proto:!0,forced:b0||A},y);return p&&x[Yx]!==U&&E4(x,Yx,U,{}),b4[o]=U,y},w0=function(r,o){return{value:r,done:o}},abe=nn,C4=Wp,R4=Hh;ra.f;var cbe=T4,T0=w0,A4="Array Iterator",lbe=R4.set,ube=R4.getterFor(A4);cbe(Array,"Array",function(r,o){lbe(this,{type:A4,target:abe(r),index:0,kind:o})},function(){var r=ube(this),o=r.target,s=r.index++;if(!o||s>=o.length)return r.target=null,T0(void 0,!0);switch(r.kind){case"keys":return T0(s,!1);case"values":return T0(o[s],!1)}return T0([s,o[s]],!1)},"values"),C4.Arguments=C4.Array;var dbe=ra,C0=function(r,o,s){return dbe.f(r,o,s)},hbe=ni,fbe=C0,pbe=ce,O4=cr("species"),mbe=T,gbe=TypeError,qx=function(r,o){if(mbe(o,r))return r;throw new gbe("Incorrect invocation")},vbe=de,Xx=dx,ybe=S(Function.toString);vbe(Xx.inspectSource)||(Xx.inspectSource=function(r){return ybe(r)});var I4=Xx.inspectSource,_be=S,Ebe=l,x4=de,bbe=td,Sbe=I4,P4=function(){},N4=ni("Reflect","construct"),Jx=/^\s*(?:class|function)\b/,wbe=_be(Jx.exec),Tbe=!Jx.test(P4),Ny=function(r){if(!x4(r))return!1;try{return N4(P4,[],r),!0}catch{return!1}},D4=function(r){if(!x4(r))return!1;switch(bbe(r)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Tbe||!!wbe(Jx,Sbe(r))}catch{return!0}};D4.sham=!0;var Dy,Kp,k4,Qx,R0=!N4||Ebe(function(){var r;return Ny(Ny.call)||!Ny(Object)||!Ny(function(){r=!0})||r})?D4:Ny,Cbe=R0,Rbe=wn,Abe=TypeError,L4=Io,Obe=function(r){if(Cbe(r))return r;throw new Abe(Rbe(r)+" is not a constructor")},Ibe=He,xbe=cr("species"),Zx=function(r,o){var s,c=L4(r).constructor;return c===void 0||Ibe(s=L4(c)[xbe])?o:Obe(s)},rd=S([].slice),Pbe=TypeError,Kh=function(r,o){if(r<o)throw new Pbe("Not enough arguments");return r},M4=/(?:ipad|iphone|ipod).*applewebkit/i.test(lo),Os=I,Nbe=M,Dbe=Zu,j4=de,kbe=bi,U4=l,V4=K3,Lbe=rd,F4=gx,Mbe=Kh,jbe=M4,Ube=c0,eP=Os.setImmediate,tP=Os.clearImmediate,Vbe=Os.process,nP=Os.Dispatch,Fbe=Os.Function,B4=Os.MessageChannel,Bbe=Os.String,rP=0,ky={},$4="onreadystatechange";U4(function(){Dy=Os.location});var iP=function(r){if(kbe(ky,r)){var o=ky[r];delete ky[r],o()}},oP=function(r){return function(){iP(r)}},W4=function(r){iP(r.data)},G4=function(r){Os.postMessage(Bbe(r),Dy.protocol+"//"+Dy.host)};eP&&tP||(eP=function(r){Mbe(arguments.length,1);var o=j4(r)?r:Fbe(r),s=Lbe(arguments,1);return ky[++rP]=function(){Nbe(o,void 0,s)},Kp(rP),rP},tP=function(r){delete ky[r]},Ube?Kp=function(r){Vbe.nextTick(oP(r))}:nP&&nP.now?Kp=function(r){nP.now(oP(r))}:B4&&!jbe?(Qx=(k4=new B4).port2,k4.port1.onmessage=W4,Kp=Dbe(Qx.postMessage,Qx)):Os.addEventListener&&j4(Os.postMessage)&&!Os.importScripts&&Dy&&Dy.protocol!=="file:"&&!U4(G4)?(Kp=G4,Os.addEventListener("message",W4,!1)):Kp=$4 in F4("script")?function(r){V4.appendChild(F4("script"))[$4]=function(){V4.removeChild(this),iP(r)}}:function(r){setTimeout(oP(r),0)});var A0={set:eP,clear:tP},H4=I,$be=ce,Wbe=Object.getOwnPropertyDescriptor,K4=function(r){if(!$be)return H4[r];var o=Wbe(H4,r);return o&&o.value},z4=function(){this.head=null,this.tail=null};z4.prototype={add:function(r){var o={item:r,next:null},s=this.tail;s?s.next=o:this.head=o,this.tail=o},get:function(){var r=this.head;if(r)return(this.head=r.next)===null&&(this.tail=null),r.item}};var zp,sP,aP,cP,Y4,q4=z4,Gbe=/ipad|iphone|ipod/i.test(lo)&&typeof Pebble<"u",Hbe=/web0s(?!.*chrome)/i.test(lo),Yp=I,Kbe=K4,X4=Zu,lP=A0.set,zbe=q4,Ybe=M4,qbe=Gbe,Xbe=Hbe,uP=c0,J4=Yp.MutationObserver||Yp.WebKitMutationObserver,Q4=Yp.document,Z4=Yp.process,O0=Yp.Promise,dP=Kbe("queueMicrotask");if(!dP){var I0=new zbe,x0=function(){var r,o;for(uP&&(r=Z4.domain)&&r.exit();o=I0.get();)try{o()}catch(s){throw I0.head&&zp(),s}r&&r.enter()};Ybe||uP||Xbe||!J4||!Q4?!qbe&&O0&&O0.resolve?((cP=O0.resolve(void 0)).constructor=O0,Y4=X4(cP.then,cP),zp=function(){Y4(x0)}):uP?zp=function(){Z4.nextTick(x0)}:(lP=X4(lP,Yp),zp=function(){lP(x0)}):(sP=!0,aP=Q4.createTextNode(""),new J4(x0).observe(aP,{characterData:!0}),zp=function(){aP.data=sP=!sP}),dP=function(r){I0.head||zp(),I0.add(r)}}var e5=dP,qp=function(r){try{return{error:!1,value:r()}}catch(o){return{error:!0,value:o}}},zh=I.Promise,Jbe=I,Ly=zh,Qbe=de,Zbe=C3,eSe=I4,tSe=cr,t5=Ax,hP=qo,n5=Ly&&Ly.prototype,nSe=tSe("species"),r5=Qbe(Jbe.PromiseRejectionEvent),rSe=Zbe("Promise",function(){var r=eSe(Ly),o=r!==String(Ly);if(!o&&hP===66||!n5.catch||!n5.finally)return!0;if(!hP||hP<51||!/native code/.test(r)){var s=new Ly(function(u){u(1)}),c=function(u){u(function(){},function(){})};if((s.constructor={})[nSe]=c,!(s.then(function(){})instanceof c))return!0}return!(o||t5!=="BROWSER"&&t5!=="DENO"||r5)}),My={CONSTRUCTOR:rSe,REJECTION_EVENT:r5},Wc={},i5=Wr,iSe=TypeError,oSe=function(r){var o,s;this.promise=new r(function(c,u){if(o!==void 0||s!==void 0)throw new iSe("Bad Promise constructor");o=c,s=u}),this.resolve=i5(o),this.reject=i5(s)};Wc.f=function(r){return new oSe(r)};var fP,o5,sSe=Kt,P0=c0,id=I,jy=te,aSe=nd,cSe=Ul,lSe=function(r){var o=hbe(r);pbe&&o&&!o[O4]&&fbe(o,O4,{configurable:!0,get:function(){return this}})},uSe=Wr,pP=de,dSe=Mn,hSe=qx,fSe=Zx,s5=A0.set,mP=e5,pSe=function(r,o){try{arguments.length===1?console.error(r):console.error(r,o)}catch{}},mSe=qp,gSe=q4,a5=Hh,gP=zh,c5=My,l5=Wc,N0="Promise",u5=c5.CONSTRUCTOR,vSe=c5.REJECTION_EVENT,vP=a5.getterFor(N0),ySe=a5.set,_Se=gP&&gP.prototype,Uy=gP,yP=_Se,d5=id.TypeError,_P=id.document,EP=id.process,bP=l5.f,ESe=bP,bSe=!!(_P&&_P.createEvent&&id.dispatchEvent),h5="unhandledrejection",f5=function(r){var o;return!(!dSe(r)||!pP(o=r.then))&&o},p5=function(r,o){var s,c,u,h=o.value,p=o.state===1,g=p?r.ok:r.fail,y=r.resolve,b=r.reject,w=r.domain;try{g?(p||(o.rejection===2&&wSe(o),o.rejection=1),g===!0?s=h:(w&&w.enter(),s=g(h),w&&(w.exit(),u=!0)),s===r.promise?b(new d5("Promise-chain cycle")):(c=f5(s))?jy(c,s,y,b):y(s)):b(h)}catch(C){w&&!u&&w.exit(),b(C)}},m5=function(r,o){r.notified||(r.notified=!0,mP(function(){for(var s,c=r.reactions;s=c.get();)p5(s,r);r.notified=!1,o&&!r.rejection&&SSe(r)}))},g5=function(r,o,s){var c,u;bSe?((c=_P.createEvent("Event")).promise=o,c.reason=s,c.initEvent(r,!1,!0),id.dispatchEvent(c)):c={promise:o,reason:s},!vSe&&(u=id["on"+r])?u(c):r===h5&&pSe("Unhandled promise rejection",s)},SSe=function(r){jy(s5,id,function(){var o,s=r.facade,c=r.value;if(v5(r)&&(o=mSe(function(){P0?EP.emit("unhandledRejection",c,s):g5(h5,s,c)}),r.rejection=P0||v5(r)?2:1,o.error))throw o.value})},v5=function(r){return r.rejection!==1&&!r.parent},wSe=function(r){jy(s5,id,function(){var o=r.facade;P0?EP.emit("rejectionHandled",o):g5("rejectionhandled",o,r.value)})},Xp=function(r,o,s){return function(c){r(o,c,s)}},Jp=function(r,o,s){r.done||(r.done=!0,s&&(r=s),r.value=o,r.state=2,m5(r,!0))},SP=function(r,o,s){if(!r.done){r.done=!0,s&&(r=s);try{if(r.facade===o)throw new d5("Promise can't be resolved itself");var c=f5(o);c?mP(function(){var u={done:!1};try{jy(c,o,Xp(SP,u,r),Xp(Jp,u,r))}catch(h){Jp(u,h,r)}}):(r.value=o,r.state=1,m5(r,!1))}catch(u){Jp({done:!1},u,r)}}};u5&&(yP=(Uy=function(r){hSe(this,yP),uSe(r),jy(fP,this);var o=vP(this);try{r(Xp(SP,o),Xp(Jp,o))}catch(s){Jp(o,s)}}).prototype,(fP=function(r){ySe(this,{type:N0,done:!1,notified:!1,parent:!1,reactions:new gSe,rejection:!1,state:0,value:null})}).prototype=aSe(yP,"then",function(r,o){var s=vP(this),c=bP(fSe(this,Uy));return s.parent=!0,c.ok=!pP(r)||r,c.fail=pP(o)&&o,c.domain=P0?EP.domain:void 0,s.state===0?s.reactions.add(c):mP(function(){p5(c,s)}),c.promise}),o5=function(){var r=new fP,o=vP(r);this.promise=r,this.resolve=Xp(SP,o),this.reject=Xp(Jp,o)},l5.f=bP=function(r){return r===Uy||r===void 0?new o5(r):ESe(r)}),sSe({global:!0,wrap:!0,forced:u5},{Promise:Uy}),cSe(Uy,N0,!1,!0),lSe(N0);var y5=cr("iterator"),_5=!1;try{var TSe=0,E5={next:function(){return{done:!!TSe++}},return:function(){_5=!0}};E5[y5]=function(){return this},Array.from(E5,function(){throw 2})}catch{}var CSe=zh,RSe=function(r,o){try{if(!o&&!_5)return!1}catch{return!1}var s=!1;try{var c={};c[y5]=function(){return{next:function(){return{done:s=!0}}}},r(c)}catch{}return s},D0=My.CONSTRUCTOR||!RSe(function(r){CSe.all(r).then(void 0,function(){})}),ASe=te,OSe=Wr,ISe=Wc,xSe=qp,PSe=xy;Kt({target:"Promise",stat:!0,forced:D0},{all:function(r){var o=this,s=ISe.f(o),c=s.resolve,u=s.reject,h=xSe(function(){var p=OSe(o.resolve),g=[],y=0,b=1;PSe(r,function(w){var C=y++,A=!1;b++,ASe(p,o,w).then(function(x){A||(A=!0,g[C]=x,--b||c(g))},u)}),--b||c(g)});return h.error&&u(h.value),s.promise}});var NSe=Kt,DSe=My.CONSTRUCTOR;zh&&zh.prototype,NSe({target:"Promise",proto:!0,forced:DSe,real:!0},{catch:function(r){return this.then(void 0,r)}});var kSe=te,LSe=Wr,MSe=Wc,jSe=qp,USe=xy;Kt({target:"Promise",stat:!0,forced:D0},{race:function(r){var o=this,s=MSe.f(o),c=s.reject,u=jSe(function(){var h=LSe(o.resolve);USe(r,function(p){kSe(h,o,p).then(s.resolve,c)})});return u.error&&c(u.value),s.promise}});var VSe=Wc;Kt({target:"Promise",stat:!0,forced:My.CONSTRUCTOR},{reject:function(r){var o=VSe.f(this);return(0,o.reject)(r),o.promise}});var FSe=Io,BSe=Mn,$Se=Wc,b5=function(r,o){if(FSe(r),BSe(o)&&o.constructor===r)return o;var s=$Se.f(r);return(0,s.resolve)(o),s.promise},WSe=Kt,GSe=zh,HSe=My.CONSTRUCTOR,KSe=b5,zSe=ni("Promise"),YSe=!HSe;WSe({target:"Promise",stat:!0,forced:!0},{resolve:function(r){return KSe(YSe&&this===zSe?GSe:this,r)}});var qSe=te,XSe=Wr,JSe=Wc,QSe=qp,ZSe=xy;Kt({target:"Promise",stat:!0,forced:D0},{allSettled:function(r){var o=this,s=JSe.f(o),c=s.resolve,u=s.reject,h=QSe(function(){var p=XSe(o.resolve),g=[],y=0,b=1;ZSe(r,function(w){var C=y++,A=!1;b++,qSe(p,o,w).then(function(x){A||(A=!0,g[C]={status:"fulfilled",value:x},--b||c(g))},function(x){A||(A=!0,g[C]={status:"rejected",reason:x},--b||c(g))})}),--b||c(g)});return h.error&&u(h.value),s.promise}});var e0e=te,t0e=Wr,n0e=ni,r0e=Wc,i0e=qp,o0e=xy,S5="No one promise resolved";Kt({target:"Promise",stat:!0,forced:D0},{any:function(r){var o=this,s=n0e("AggregateError"),c=r0e.f(o),u=c.resolve,h=c.reject,p=i0e(function(){var g=t0e(o.resolve),y=[],b=0,w=1,C=!1;o0e(r,function(A){var x=b++,B=!1;w++,e0e(g,o,A).then(function(U){B||C||(C=!0,u(U))},function(U){B||C||(B=!0,y[x]=U,--w||h(new s(y,S5)))})}),--w||h(new s(y,S5))});return p.error&&h(p.value),c.promise}});var s0e=Kt,a0e=M,c0e=rd,l0e=Wc,u0e=Wr,w5=qp,wP=I.Promise,T5=!1;s0e({target:"Promise",stat:!0,forced:!wP||!wP.try||w5(function(){wP.try(function(r){T5=r===8},8)}).error||!T5},{try:function(r){var o=arguments.length>1?c0e(arguments,1):[],s=l0e.f(this),c=w5(function(){return a0e(u0e(r),void 0,o)});return(c.error?s.reject:s.resolve)(c.value),s.promise}});var d0e=Wc;Kt({target:"Promise",stat:!0},{withResolvers:function(){var r=d0e.f(this);return{promise:r.promise,resolve:r.resolve,reject:r.reject}}});var h0e=Kt,TP=zh,f0e=l,p0e=ni,m0e=de,g0e=Zx,C5=b5,v0e=TP&&TP.prototype;h0e({target:"Promise",proto:!0,real:!0,forced:!!TP&&f0e(function(){v0e.finally.call({then:function(){}},function(){})})},{finally:function(r){var o=g0e(this,p0e("Promise")),s=m0e(r);return this.then(s?function(c){return C5(o,r()).then(function(){return c})}:r,s?function(c){return C5(o,r()).then(function(){throw c})}:r)}});var CP=S,y0e=bx,_0e=Xo,E0e=at,b0e=CP("".charAt),R5=CP("".charCodeAt),S0e=CP("".slice),A5=function(r){return function(o,s){var c,u,h=_0e(E0e(o)),p=y0e(s),g=h.length;return p<0||p>=g?r?"":void 0:(c=R5(h,p))<55296||c>56319||p+1===g||(u=R5(h,p+1))<56320||u>57343?r?b0e(h,p):c:r?S0e(h,p,p+2):u-56320+(c-55296<<10)+65536}},RP={codeAt:A5(!1),charAt:A5(!0)},w0e=RP.charAt,T0e=Xo,O5=Hh,C0e=T4,I5=w0,x5="String Iterator",R0e=O5.set,A0e=O5.getterFor(x5);C0e(String,"String",function(r){R0e(this,{type:x5,string:T0e(r),index:0})},function(){var r,o=A0e(this),s=o.string,c=o.index;return c>=s.length?I5(void 0,!0):(r=w0e(s,c),o.index+=r.length,I5(r,!1))});var O0e=ar.Promise,I0e={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},x0e=I,P0e=Ul,P5=Wp;for(var AP in I0e)P0e(x0e[AP],AP),P5[AP]=P5.Array;var N5=O0e,De=a(N5),N0e=ia("Array","values"),D0e=td,k0e=bi,L0e=T,M0e=N0e,OP=Array.prototype,j0e={DOMTokenList:!0,NodeList:!0},U0e=function(r){var o=r.values;return r===OP||L0e(OP,r)&&o===OP.values||k0e(j0e,D0e(r))?M0e:o},xo=a(U0e),D5=wn,V0e=TypeError,k5=rd,F0e=Math.floor,IP=function(r,o){var s=r.length;if(s<8)for(var c,u,h=1;h<s;){for(u=h,c=r[h];u&&o(r[u-1],c)>0;)r[u]=r[--u];u!==h++&&(r[u]=c)}else for(var p=F0e(s/2),g=IP(k5(r,0,p),o),y=IP(k5(r,p),o),b=g.length,w=y.length,C=0,A=0;C<b||A<w;)r[C+A]=C<b&&A<w?o(g[C],y[A])<=0?g[C++]:y[A++]:C<b?g[C++]:y[A++];return r},L5=IP,M5=lo.match(/firefox\/(\d+)/i),B0e=!!M5&&+M5[1],$0e=/MSIE|Trident/.test(lo),j5=lo.match(/AppleWebKit\/(\d+)\./),W0e=!!j5&&+j5[1],G0e=Kt,U5=S,H0e=Wr,K0e=Bc,V5=ed,z0e=function(r,o){if(!delete r[o])throw new V0e("Cannot delete property "+D5(o)+" of "+D5(r))},F5=Xo,xP=l,Y0e=L5,q0e=s0,B5=B0e,X0e=$0e,$5=qo,W5=W0e,od=[],G5=U5(od.sort),J0e=U5(od.push),Q0e=xP(function(){od.sort(void 0)}),Z0e=xP(function(){od.sort(null)}),ewe=q0e("sort"),H5=!xP(function(){if($5)return $5<70;if(!(B5&&B5>3)){if(X0e)return!0;if(W5)return W5<603;var r,o,s,c,u="";for(r=65;r<76;r++){switch(o=String.fromCharCode(r),r){case 66:case 69:case 70:case 72:s=3;break;case 68:case 71:s=4;break;default:s=2}for(c=0;c<47;c++)od.push({k:o+c,v:s})}for(od.sort(function(h,p){return p.v-h.v}),c=0;c<od.length;c++)o=od[c].k.charAt(0),u.charAt(u.length-1)!==o&&(u+=o);return u!=="DGBEFHACIJK"}});G0e({target:"Array",proto:!0,forced:Q0e||!Z0e||!ewe||!H5},{sort:function(r){r!==void 0&&H0e(r);var o=K0e(this);if(H5)return r===void 0?G5(o):G5(o,r);var s,c,u=[],h=V5(o);for(c=0;c<h;c++)c in o&&J0e(u,o[c]);for(Y0e(u,function(p){return function(g,y){return y===void 0?-1:g===void 0?1:p!==void 0?+p(g,y)||0:F5(g)>F5(y)?1:-1}}(r)),s=V5(u),c=0;c<s;)o[c]=u[c++];for(;c<h;)z0e(o,c++);return o}});var twe=ia("Array","sort"),nwe=T,rwe=twe,PP=Array.prototype,iwe=function(r){var o=r.sort;return r===PP||nwe(PP,r)&&o===PP.sort?rwe:o},Yh=a(iwe),owe=Kt,swe=S,awe=Sx,cwe=RangeError,K5=String.fromCharCode,z5=String.fromCodePoint,lwe=swe([].join);owe({target:"String",stat:!0,forced:!!z5&&z5.length!==1},{fromCodePoint:function(r){for(var o,s=[],c=arguments.length,u=0;c>u;){if(o=+arguments[u++],awe(o,1114111)!==o)throw new cwe(o+" is not a valid code point");s[u]=o<65536?K5(o):K5(55296+((o-=65536)>>10),o%1024+56320)}return lwe(s,"")}});var uwe=l,dwe=cr("iterator"),k0=!uwe(function(){var r=new URL("b?a=1&b=2&c=3","https://a"),o=r.searchParams,s=new URLSearchParams("a=1&a=2&b=3"),c="";return r.pathname="c%20d",o.forEach(function(u,h){o.delete("b"),c+=h+u}),s.delete("a",2),s.delete("b",void 0),!r.toJSON||!s.has("a",1)||s.has("a",2)||!s.has("a",void 0)||s.has("b")||!o.size&&!0||!o.sort||r.href!=="https://a/c%20d?a=1&c=3"||o.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!o[dwe]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("https://тест").host!=="xn--e1aybc"||new URL("https://a#б").hash!=="#%D0%B1"||c!=="a1c3"||new URL("https://x",void 0).host!=="x"}),hwe=nd,NP=Kt,Y5=I,DP=K4,fwe=ni,L0=te,qa=S,Vy=ce,q5=k0,X5=nd,pwe=C0,mwe=function(r,o,s){for(var c in o)s&&s.unsafe&&r[c]?r[c]=o[c]:hwe(r,c,o[c],s);return r},gwe=Ul,vwe=zx,kP=Hh,J5=qx,LP=de,ywe=bi,_we=Zu,Ewe=td,bwe=Io,Q5=Mn,Po=Xo,Swe=Iy,Z5=Ze,e$=Ux,wwe=m0,M0=w0,Qp=Kh,Twe=L5,Cwe=cr("iterator"),Zp="URLSearchParams",t$=Zp+"Iterator",n$=kP.set,sa=kP.getterFor(Zp),Rwe=kP.getterFor(t$),r$=DP("fetch"),j0=DP("Request"),Fy=DP("Headers"),MP=j0&&j0.prototype,i$=Fy&&Fy.prototype,Awe=Y5.TypeError,Owe=Y5.encodeURIComponent,Iwe=String.fromCharCode,xwe=fwe("String","fromCodePoint"),Pwe=parseInt,U0=qa("".charAt),o$=qa([].join),sd=qa([].push),s$=qa("".replace),Nwe=qa([].shift),a$=qa([].splice),c$=qa("".split),l$=qa("".slice),Dwe=qa(/./.exec),kwe=/\+/g,Lwe=/^[0-9a-f]+$/i,u$=function(r,o){var s=l$(r,o,o+2);return Dwe(Lwe,s)?Pwe(s,16):NaN},Mwe=function(r){for(var o=0,s=128;s>0&&r&s;s>>=1)o++;return o},jwe=function(r){var o=null;switch(r.length){case 1:o=r[0];break;case 2:o=(31&r[0])<<6|63&r[1];break;case 3:o=(15&r[0])<<12|(63&r[1])<<6|63&r[2];break;case 4:o=(7&r[0])<<18|(63&r[1])<<12|(63&r[2])<<6|63&r[3]}return o>1114111?null:o},d$=function(r){for(var o=(r=s$(r,kwe," ")).length,s="",c=0;c<o;){var u=U0(r,c);if(u==="%"){if(U0(r,c+1)==="%"||c+3>o){s+="%",c++;continue}var h=u$(r,c+1);if(h!=h){s+=u,c++;continue}c+=2;var p=Mwe(h);if(p===0)u=Iwe(h);else{if(p===1||p>4){s+="�",c++;continue}for(var g=[h],y=1;y<p&&!(++c+3>o||U0(r,c)!=="%");){var b=u$(r,c+1);if(b!=b){c+=3;break}if(b>191||b<128)break;sd(g,b),c+=2,y++}if(g.length!==p){s+="�";continue}var w=jwe(g);w===null?s+="�":u=xwe(w)}}s+=u,c++}return s},Uwe=/[!'()~]|%20/g,Vwe={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Fwe=function(r){return Vwe[r]},h$=function(r){return s$(Owe(r),Uwe,Fwe)},jP=vwe(function(r,o){n$(this,{type:t$,target:sa(r).entries,index:0,kind:o})},Zp,function(){var r=Rwe(this),o=r.target,s=r.index++;if(!o||s>=o.length)return r.target=null,M0(void 0,!0);var c=o[s];switch(r.kind){case"keys":return M0(c.key,!1);case"values":return M0(c.value,!1)}return M0([c.key,c.value],!1)},!0),f$=function(r){this.entries=[],this.url=null,r!==void 0&&(Q5(r)?this.parseObject(r):this.parseQuery(typeof r=="string"?U0(r,0)==="?"?l$(r,1):r:Po(r)))};f$.prototype={type:Zp,bindURL:function(r){this.url=r,this.update()},parseObject:function(r){var o,s,c,u,h,p,g,y=this.entries,b=wwe(r);if(b)for(s=(o=e$(r,b)).next;!(c=L0(s,o)).done;){if(h=(u=e$(bwe(c.value))).next,(p=L0(h,u)).done||(g=L0(h,u)).done||!L0(h,u).done)throw new Awe("Expected sequence with length 2");sd(y,{key:Po(p.value),value:Po(g.value)})}else for(var w in r)ywe(r,w)&&sd(y,{key:w,value:Po(r[w])})},parseQuery:function(r){if(r)for(var o,s,c=this.entries,u=c$(r,"&"),h=0;h<u.length;)(o=u[h++]).length&&(s=c$(o,"="),sd(c,{key:d$(Nwe(s)),value:d$(o$(s,"="))}))},serialize:function(){for(var r,o=this.entries,s=[],c=0;c<o.length;)r=o[c++],sd(s,h$(r.key)+"="+h$(r.value));return o$(s,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var V0=function(){J5(this,em);var r=n$(this,new f$(arguments.length>0?arguments[0]:void 0));Vy||(this.size=r.entries.length)},em=V0.prototype;if(mwe(em,{append:function(r,o){var s=sa(this);Qp(arguments.length,2),sd(s.entries,{key:Po(r),value:Po(o)}),Vy||this.length++,s.updateURL()},delete:function(r){for(var o=sa(this),s=Qp(arguments.length,1),c=o.entries,u=Po(r),h=s<2?void 0:arguments[1],p=h===void 0?h:Po(h),g=0;g<c.length;){var y=c[g];if(y.key!==u||p!==void 0&&y.value!==p)g++;else if(a$(c,g,1),p!==void 0)break}Vy||(this.size=c.length),o.updateURL()},get:function(r){var o=sa(this).entries;Qp(arguments.length,1);for(var s=Po(r),c=0;c<o.length;c++)if(o[c].key===s)return o[c].value;return null},getAll:function(r){var o=sa(this).entries;Qp(arguments.length,1);for(var s=Po(r),c=[],u=0;u<o.length;u++)o[u].key===s&&sd(c,o[u].value);return c},has:function(r){for(var o=sa(this).entries,s=Qp(arguments.length,1),c=Po(r),u=s<2?void 0:arguments[1],h=u===void 0?u:Po(u),p=0;p<o.length;){var g=o[p++];if(g.key===c&&(h===void 0||g.value===h))return!0}return!1},set:function(r,o){var s=sa(this);Qp(arguments.length,1);for(var c,u=s.entries,h=!1,p=Po(r),g=Po(o),y=0;y<u.length;y++)(c=u[y]).key===p&&(h?a$(u,y--,1):(h=!0,c.value=g));h||sd(u,{key:p,value:g}),Vy||(this.size=u.length),s.updateURL()},sort:function(){var r=sa(this);Twe(r.entries,function(o,s){return o.key>s.key?1:-1}),r.updateURL()},forEach:function(r){for(var o,s=sa(this).entries,c=_we(r,arguments.length>1?arguments[1]:void 0),u=0;u<s.length;)c((o=s[u++]).value,o.key,this)},keys:function(){return new jP(this,"keys")},values:function(){return new jP(this,"values")},entries:function(){return new jP(this,"entries")}},{enumerable:!0}),X5(em,Cwe,em.entries,{}),X5(em,"toString",function(){return sa(this).serialize()},{enumerable:!0}),Vy&&pwe(em,"size",{get:function(){return sa(this).entries.length},configurable:!0,enumerable:!0}),gwe(V0,Zp),NP({global:!0,forced:!q5},{URLSearchParams:V0}),!q5&&LP(Fy)){var Bwe=qa(i$.has),$we=qa(i$.set),p$=function(r){if(Q5(r)){var o,s=r.body;if(Ewe(s)===Zp)return o=r.headers?new Fy(r.headers):new Fy,Bwe(o,"content-type")||$we(o,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),Swe(r,{body:Z5(0,Po(s)),headers:Z5(0,o)})}return r};if(LP(r$)&&NP({global:!0,dontCallGetSet:!0,forced:!0},{fetch:function(r){return r$(r,arguments.length>1?p$(arguments[1]):{})}}),LP(j0)){var UP=function(r){return J5(this,MP),new j0(r,arguments.length>1?p$(arguments[1]):{})};MP.constructor=UP,UP.prototype=MP,NP({global:!0,dontCallGetSet:!0,forced:!0},{Request:UP})}}var aa,Wwe={URLSearchParams:V0,getState:sa},Gwe=ar.URLSearchParams,m$=ce,Hwe=S,Kwe=te,zwe=l,VP=h0,Ywe=Oy,qwe=ne,Xwe=Bc,Jwe=we,tm=Object.assign,g$=Object.defineProperty,Qwe=Hwe([].concat),Zwe=!tm||zwe(function(){if(m$&&tm({b:1},tm(g$({},"a",{enumerable:!0,get:function(){g$(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var r={},o={},s=Symbol("assign detection"),c="abcdefghijklmnopqrst";return r[s]=7,c.split("").forEach(function(u){o[u]=u}),tm({},r)[s]!==7||VP(tm({},o)).join("")!==c})?function(r,o){for(var s=Xwe(r),c=arguments.length,u=1,h=Ywe.f,p=qwe.f;c>u;)for(var g,y=Jwe(arguments[u++]),b=h?Qwe(VP(y),h(y)):VP(y),w=b.length,C=0;w>C;)g=b[C++],m$&&!Kwe(p,y,g)||(s[g]=y[g]);return s}:tm,eTe=Io,tTe=r4,nTe=ce,rTe=ra,iTe=Ze,FP=function(r,o,s){nTe?rTe.f(r,o,iTe(0,s)):r[o]=s},oTe=Zu,sTe=te,aTe=Bc,cTe=function(r,o,s,c){try{return c?o(eTe(s)[0],s[1]):o(s)}catch(u){tTe(r,"throw",u)}},lTe=e4,uTe=R0,dTe=ed,v$=FP,hTe=Ux,fTe=m0,y$=Array,qh=S,BP=2147483647,pTe=/[^\0-\u007E]/,_$=/[.\u3002\uFF0E\uFF61]/g,E$="Overflow: input needs wider integers to process",b$=RangeError,mTe=qh(_$.exec),nm=Math.floor,$P=String.fromCharCode,S$=qh("".charCodeAt),w$=qh([].join),ad=qh([].push),gTe=qh("".replace),vTe=qh("".split),yTe=qh("".toLowerCase),T$=function(r){return r+22+75*(r<26)},_Te=function(r,o,s){var c=0;for(r=s?nm(r/700):r>>1,r+=nm(r/o);r>455;)r=nm(r/35),c+=36;return nm(c+36*r/(r+38))},ETe=function(r){var o=[];r=function(K){for(var z=[],Q=0,ie=K.length;Q<ie;){var oe=S$(K,Q++);if(oe>=55296&&oe<=56319&&Q<ie){var re=S$(K,Q++);(64512&re)==56320?ad(z,((1023&oe)<<10)+(1023&re)+65536):(ad(z,oe),Q--)}else ad(z,oe)}return z}(r);var s,c,u=r.length,h=128,p=0,g=72;for(s=0;s<r.length;s++)(c=r[s])<128&&ad(o,$P(c));var y=o.length,b=y;for(y&&ad(o,"-");b<u;){var w=BP;for(s=0;s<r.length;s++)(c=r[s])>=h&&c<w&&(w=c);var C=b+1;if(w-h>nm((BP-p)/C))throw new b$(E$);for(p+=(w-h)*C,h=w,s=0;s<r.length;s++){if((c=r[s])<h&&++p>BP)throw new b$(E$);if(c===h){for(var A=p,x=36;;){var B=x<=g?1:x>=g+26?26:x-g;if(A<B)break;var U=A-B,F=36-B;ad(o,$P(T$(B+U%F))),A=nm(U/F),x+=36}ad(o,$P(T$(A))),g=_Te(p,C,b===y),p=0,b++}}p++,h++}return w$(o,"")},bTe=Kt,WP=ce,STe=k0,GP=I,C$=Zu,ca=S,F0=nd,la=C0,wTe=qx,HP=bi,KP=Zwe,rm=function(r){var o=aTe(r),s=uTe(this),c=arguments.length,u=c>1?arguments[1]:void 0,h=u!==void 0;h&&(u=oTe(u,c>2?arguments[2]:void 0));var p,g,y,b,w,C,A=fTe(o),x=0;if(!A||this===y$&&lTe(A))for(p=dTe(o),g=s?new this(p):y$(p);p>x;x++)C=h?u(o[x],x):o[x],v$(g,x,C);else for(g=s?new this:[],w=(b=hTe(o,A)).next;!(y=sTe(w,b)).done;x++)C=h?cTe(b,u,[y.value,x],!0):y.value,v$(g,x,C);return g.length=x,g},Xa=rd,TTe=RP.codeAt,CTe=function(r){var o,s,c=[],u=vTe(gTe(yTe(r),_$,"."),".");for(o=0;o<u.length;o++)s=u[o],ad(c,mTe(pTe,s)?"xn--"+ETe(s):s);return w$(c,".")},Vl=Xo,RTe=Ul,ATe=Kh,R$=Wwe,A$=Hh,OTe=A$.set,B0=A$.getterFor("URL"),ITe=R$.URLSearchParams,xTe=R$.getState,By=GP.URL,zP=GP.TypeError,$0=GP.parseInt,PTe=Math.floor,O$=Math.pow,ua=ca("".charAt),Ja=ca(/./.exec),$y=ca([].join),NTe=ca(1 .toString),DTe=ca([].pop),im=ca([].push),YP=ca("".replace),kTe=ca([].shift),LTe=ca("".split),Wy=ca("".slice),W0=ca("".toLowerCase),MTe=ca([].unshift),qP="Invalid scheme",Xh="Invalid host",I$="Invalid port",x$=/[a-z]/i,jTe=/[\d+-.a-z]/i,XP=/\d/,UTe=/^0x/i,VTe=/^[0-7]+$/,FTe=/^\d+$/,P$=/^[\da-f]+$/i,BTe=/[\0\t\n\r #%/:<>?@[\\\]^|]/,$Te=/[\0\t\n\r #/:<>?@[\\\]^|]/,WTe=/^[\u0000-\u0020]+/,GTe=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,HTe=/[\t\n\r]/g,Gy=function(r){var o,s,c,u;if(typeof r=="number"){for(o=[],s=0;s<4;s++)MTe(o,r%256),r=PTe(r/256);return $y(o,".")}if(typeof r=="object"){for(o="",c=function(h){for(var p=null,g=1,y=null,b=0,w=0;w<8;w++)h[w]!==0?(b>g&&(p=y,g=b),y=null,b=0):(y===null&&(y=w),++b);return b>g?y:p}(r),s=0;s<8;s++)u&&r[s]===0||(u&&(u=!1),c===s?(o+=s?":":"::",u=!0):(o+=NTe(r[s],16),s<7&&(o+=":")));return"["+o+"]"}return r},G0={},N$=KP({},G0,{" ":1,'"':1,"<":1,">":1,"`":1}),D$=KP({},N$,{"#":1,"?":1,"{":1,"}":1}),JP=KP({},D$,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),cd=function(r,o){var s=TTe(r,0);return s>32&&s<127&&!HP(o,r)?r:encodeURIComponent(r)},H0={ftp:21,file:null,http:80,https:443,ws:80,wss:443},Hy=function(r,o){var s;return r.length===2&&Ja(x$,ua(r,0))&&((s=ua(r,1))===":"||!o&&s==="|")},k$=function(r){var o;return r.length>1&&Hy(Wy(r,0,2))&&(r.length===2||(o=ua(r,2))==="/"||o==="\\"||o==="?"||o==="#")},KTe=function(r){return r==="."||W0(r)==="%2e"},QP={},L$={},ZP={},M$={},j$={},eN={},U$={},V$={},K0={},z0={},tN={},nN={},rN={},iN={},F$={},oN={},om={},Gc={},B$={},Jh={},Fl={},sN=function(r,o,s){var c,u,h,p=Vl(r);if(o){if(u=this.parse(p))throw new zP(u);this.searchParams=null}else{if(s!==void 0&&(c=new sN(s,!0)),u=this.parse(p,null,c))throw new zP(u);(h=xTe(new ITe)).bindURL(this),this.searchParams=h}};sN.prototype={type:"URL",parse:function(r,o,s){var c,u,h,p,g,y=this,b=o||QP,w=0,C="",A=!1,x=!1,B=!1;for(r=Vl(r),o||(y.scheme="",y.username="",y.password="",y.host=null,y.port=null,y.path=[],y.query=null,y.fragment=null,y.cannotBeABaseURL=!1,r=YP(r,WTe,""),r=YP(r,GTe,"$1")),r=YP(r,HTe,""),c=rm(r);w<=c.length;){switch(u=c[w],b){case QP:if(!u||!Ja(x$,u)){if(o)return qP;b=ZP;continue}C+=W0(u),b=L$;break;case L$:if(u&&(Ja(jTe,u)||u==="+"||u==="-"||u==="."))C+=W0(u);else{if(u!==":"){if(o)return qP;C="",b=ZP,w=0;continue}if(o&&(y.isSpecial()!==HP(H0,C)||C==="file"&&(y.includesCredentials()||y.port!==null)||y.scheme==="file"&&!y.host))return;if(y.scheme=C,o)return void(y.isSpecial()&&H0[y.scheme]===y.port&&(y.port=null));C="",y.scheme==="file"?b=iN:y.isSpecial()&&s&&s.scheme===y.scheme?b=M$:y.isSpecial()?b=V$:c[w+1]==="/"?(b=j$,w++):(y.cannotBeABaseURL=!0,im(y.path,""),b=B$)}break;case ZP:if(!s||s.cannotBeABaseURL&&u!=="#")return qP;if(s.cannotBeABaseURL&&u==="#"){y.scheme=s.scheme,y.path=Xa(s.path),y.query=s.query,y.fragment="",y.cannotBeABaseURL=!0,b=Fl;break}b=s.scheme==="file"?iN:eN;continue;case M$:if(u!=="/"||c[w+1]!=="/"){b=eN;continue}b=K0,w++;break;case j$:if(u==="/"){b=z0;break}b=Gc;continue;case eN:if(y.scheme=s.scheme,u===aa)y.username=s.username,y.password=s.password,y.host=s.host,y.port=s.port,y.path=Xa(s.path),y.query=s.query;else if(u==="/"||u==="\\"&&y.isSpecial())b=U$;else if(u==="?")y.username=s.username,y.password=s.password,y.host=s.host,y.port=s.port,y.path=Xa(s.path),y.query="",b=Jh;else{if(u!=="#"){y.username=s.username,y.password=s.password,y.host=s.host,y.port=s.port,y.path=Xa(s.path),y.path.length--,b=Gc;continue}y.username=s.username,y.password=s.password,y.host=s.host,y.port=s.port,y.path=Xa(s.path),y.query=s.query,y.fragment="",b=Fl}break;case U$:if(!y.isSpecial()||u!=="/"&&u!=="\\"){if(u!=="/"){y.username=s.username,y.password=s.password,y.host=s.host,y.port=s.port,b=Gc;continue}b=z0}else b=K0;break;case V$:if(b=K0,u!=="/"||ua(C,w+1)!=="/")continue;w++;break;case K0:if(u!=="/"&&u!=="\\"){b=z0;continue}break;case z0:if(u==="@"){A&&(C="%40"+C),A=!0,h=rm(C);for(var U=0;U<h.length;U++){var F=h[U];if(F!==":"||B){var K=cd(F,JP);B?y.password+=K:y.username+=K}else B=!0}C=""}else if(u===aa||u==="/"||u==="?"||u==="#"||u==="\\"&&y.isSpecial()){if(A&&C==="")return"Invalid authority";w-=rm(C).length+1,C="",b=tN}else C+=u;break;case tN:case nN:if(o&&y.scheme==="file"){b=oN;continue}if(u!==":"||x){if(u===aa||u==="/"||u==="?"||u==="#"||u==="\\"&&y.isSpecial()){if(y.isSpecial()&&C==="")return Xh;if(o&&C===""&&(y.includesCredentials()||y.port!==null))return;if(p=y.parseHost(C))return p;if(C="",b=om,o)return;continue}u==="["?x=!0:u==="]"&&(x=!1),C+=u}else{if(C==="")return Xh;if(p=y.parseHost(C))return p;if(C="",b=rN,o===nN)return}break;case rN:if(!Ja(XP,u)){if(u===aa||u==="/"||u==="?"||u==="#"||u==="\\"&&y.isSpecial()||o){if(C!==""){var z=$0(C,10);if(z>65535)return I$;y.port=y.isSpecial()&&z===H0[y.scheme]?null:z,C=""}if(o)return;b=om;continue}return I$}C+=u;break;case iN:if(y.scheme="file",u==="/"||u==="\\")b=F$;else{if(!s||s.scheme!=="file"){b=Gc;continue}switch(u){case aa:y.host=s.host,y.path=Xa(s.path),y.query=s.query;break;case"?":y.host=s.host,y.path=Xa(s.path),y.query="",b=Jh;break;case"#":y.host=s.host,y.path=Xa(s.path),y.query=s.query,y.fragment="",b=Fl;break;default:k$($y(Xa(c,w),""))||(y.host=s.host,y.path=Xa(s.path),y.shortenPath()),b=Gc;continue}}break;case F$:if(u==="/"||u==="\\"){b=oN;break}s&&s.scheme==="file"&&!k$($y(Xa(c,w),""))&&(Hy(s.path[0],!0)?im(y.path,s.path[0]):y.host=s.host),b=Gc;continue;case oN:if(u===aa||u==="/"||u==="\\"||u==="?"||u==="#"){if(!o&&Hy(C))b=Gc;else if(C===""){if(y.host="",o)return;b=om}else{if(p=y.parseHost(C))return p;if(y.host==="localhost"&&(y.host=""),o)return;C="",b=om}continue}C+=u;break;case om:if(y.isSpecial()){if(b=Gc,u!=="/"&&u!=="\\")continue}else if(o||u!=="?")if(o||u!=="#"){if(u!==aa&&(b=Gc,u!=="/"))continue}else y.fragment="",b=Fl;else y.query="",b=Jh;break;case Gc:if(u===aa||u==="/"||u==="\\"&&y.isSpecial()||!o&&(u==="?"||u==="#")){if((g=W0(g=C))===".."||g==="%2e."||g===".%2e"||g==="%2e%2e"?(y.shortenPath(),u==="/"||u==="\\"&&y.isSpecial()||im(y.path,"")):KTe(C)?u==="/"||u==="\\"&&y.isSpecial()||im(y.path,""):(y.scheme==="file"&&!y.path.length&&Hy(C)&&(y.host&&(y.host=""),C=ua(C,0)+":"),im(y.path,C)),C="",y.scheme==="file"&&(u===aa||u==="?"||u==="#"))for(;y.path.length>1&&y.path[0]==="";)kTe(y.path);u==="?"?(y.query="",b=Jh):u==="#"&&(y.fragment="",b=Fl)}else C+=cd(u,D$);break;case B$:u==="?"?(y.query="",b=Jh):u==="#"?(y.fragment="",b=Fl):u!==aa&&(y.path[0]+=cd(u,G0));break;case Jh:o||u!=="#"?u!==aa&&(u==="'"&&y.isSpecial()?y.query+="%27":y.query+=u==="#"?"%23":cd(u,G0)):(y.fragment="",b=Fl);break;case Fl:u!==aa&&(y.fragment+=cd(u,N$))}w++}},parseHost:function(r){var o,s,c;if(ua(r,0)==="["){if(ua(r,r.length-1)!=="]"||(o=function(u){var h,p,g,y,b,w,C,A=[0,0,0,0,0,0,0,0],x=0,B=null,U=0,F=function(){return ua(u,U)};if(F()===":"){if(ua(u,1)!==":")return;U+=2,B=++x}for(;F();){if(x===8)return;if(F()!==":"){for(h=p=0;p<4&&Ja(P$,F());)h=16*h+$0(F(),16),U++,p++;if(F()==="."){if(p===0||(U-=p,x>6))return;for(g=0;F();){if(y=null,g>0){if(!(F()==="."&&g<4))return;U++}if(!Ja(XP,F()))return;for(;Ja(XP,F());){if(b=$0(F(),10),y===null)y=b;else{if(y===0)return;y=10*y+b}if(y>255)return;U++}A[x]=256*A[x]+y,++g!=2&&g!==4||x++}if(g!==4)return;break}if(F()===":"){if(U++,!F())return}else if(F())return;A[x++]=h}else{if(B!==null)return;U++,B=++x}}if(B!==null)for(w=x-B,x=7;x!==0&&w>0;)C=A[x],A[x--]=A[B+w-1],A[B+--w]=C;else if(x!==8)return;return A}(Wy(r,1,-1)),!o))return Xh;this.host=o}else if(this.isSpecial()){if(r=CTe(r),Ja(BTe,r)||(o=function(u){var h,p,g,y,b,w,C,A=LTe(u,".");if(A.length&&A[A.length-1]===""&&A.length--,(h=A.length)>4)return u;for(p=[],g=0;g<h;g++){if((y=A[g])==="")return u;if(b=10,y.length>1&&ua(y,0)==="0"&&(b=Ja(UTe,y)?16:8,y=Wy(y,b===8?1:2)),y==="")w=0;else{if(!Ja(b===10?FTe:b===8?VTe:P$,y))return u;w=$0(y,b)}im(p,w)}for(g=0;g<h;g++)if(w=p[g],g===h-1){if(w>=O$(256,5-h))return null}else if(w>255)return null;for(C=DTe(p),g=0;g<p.length;g++)C+=p[g]*O$(256,3-g);return C}(r),o===null))return Xh;this.host=o}else{if(Ja($Te,r))return Xh;for(o="",s=rm(r),c=0;c<s.length;c++)o+=cd(s[c],G0);this.host=o}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme==="file"},includesCredentials:function(){return this.username!==""||this.password!==""},isSpecial:function(){return HP(H0,this.scheme)},shortenPath:function(){var r=this.path,o=r.length;!o||this.scheme==="file"&&o===1&&Hy(r[0],!0)||r.length--},serialize:function(){var r=this,o=r.scheme,s=r.username,c=r.password,u=r.host,h=r.port,p=r.path,g=r.query,y=r.fragment,b=o+":";return u!==null?(b+="//",r.includesCredentials()&&(b+=s+(c?":"+c:"")+"@"),b+=Gy(u),h!==null&&(b+=":"+h)):o==="file"&&(b+="//"),b+=r.cannotBeABaseURL?p[0]:p.length?"/"+$y(p,"/"):"",g!==null&&(b+="?"+g),y!==null&&(b+="#"+y),b},setHref:function(r){var o=this.parse(r);if(o)throw new zP(o);this.searchParams.update()},getOrigin:function(){var r=this.scheme,o=this.port;if(r==="blob")try{return new sm(r.path[0]).origin}catch{return"null"}return r!=="file"&&this.isSpecial()?r+"://"+Gy(this.host)+(o!==null?":"+o:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(r){this.parse(Vl(r)+":",QP)},getUsername:function(){return this.username},setUsername:function(r){var o=rm(Vl(r));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var s=0;s<o.length;s++)this.username+=cd(o[s],JP)}},getPassword:function(){return this.password},setPassword:function(r){var o=rm(Vl(r));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var s=0;s<o.length;s++)this.password+=cd(o[s],JP)}},getHost:function(){var r=this.host,o=this.port;return r===null?"":o===null?Gy(r):Gy(r)+":"+o},setHost:function(r){this.cannotBeABaseURL||this.parse(r,tN)},getHostname:function(){var r=this.host;return r===null?"":Gy(r)},setHostname:function(r){this.cannotBeABaseURL||this.parse(r,nN)},getPort:function(){var r=this.port;return r===null?"":Vl(r)},setPort:function(r){this.cannotHaveUsernamePasswordPort()||((r=Vl(r))===""?this.port=null:this.parse(r,rN))},getPathname:function(){var r=this.path;return this.cannotBeABaseURL?r[0]:r.length?"/"+$y(r,"/"):""},setPathname:function(r){this.cannotBeABaseURL||(this.path=[],this.parse(r,om))},getSearch:function(){var r=this.query;return r?"?"+r:""},setSearch:function(r){(r=Vl(r))===""?this.query=null:(ua(r,0)==="?"&&(r=Wy(r,1)),this.query="",this.parse(r,Jh)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var r=this.fragment;return r?"#"+r:""},setHash:function(r){(r=Vl(r))!==""?(ua(r,0)==="#"&&(r=Wy(r,1)),this.fragment="",this.parse(r,Fl)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var sm=function(r){var o=wTe(this,No),s=ATe(arguments.length,1)>1?arguments[1]:void 0,c=OTe(o,new sN(r,!1,s));WP||(o.href=c.serialize(),o.origin=c.getOrigin(),o.protocol=c.getProtocol(),o.username=c.getUsername(),o.password=c.getPassword(),o.host=c.getHost(),o.hostname=c.getHostname(),o.port=c.getPort(),o.pathname=c.getPathname(),o.search=c.getSearch(),o.searchParams=c.getSearchParams(),o.hash=c.getHash())},No=sm.prototype,da=function(r,o){return{get:function(){return B0(this)[r]()},set:o&&function(s){return B0(this)[o](s)},configurable:!0,enumerable:!0}};if(WP&&(la(No,"href",da("serialize","setHref")),la(No,"origin",da("getOrigin")),la(No,"protocol",da("getProtocol","setProtocol")),la(No,"username",da("getUsername","setUsername")),la(No,"password",da("getPassword","setPassword")),la(No,"host",da("getHost","setHost")),la(No,"hostname",da("getHostname","setHostname")),la(No,"port",da("getPort","setPort")),la(No,"pathname",da("getPathname","setPathname")),la(No,"search",da("getSearch","setSearch")),la(No,"searchParams",da("getSearchParams")),la(No,"hash",da("getHash","setHash"))),F0(No,"toJSON",function(){return B0(this).serialize()},{enumerable:!0}),F0(No,"toString",function(){return B0(this).serialize()},{enumerable:!0}),By){var $$=By.createObjectURL,W$=By.revokeObjectURL;$$&&F0(sm,"createObjectURL",C$($$,By)),W$&&F0(sm,"revokeObjectURL",C$(W$,By))}RTe(sm,"URL"),bTe({global:!0,forced:!STe,sham:!WP},{URL:sm});var zTe=Kt,G$=l,YTe=Kh,H$=Xo,qTe=k0,aN=ni("URL"),XTe=qTe&&G$(function(){aN.canParse()}),JTe=G$(function(){return aN.canParse.length!==1});zTe({target:"URL",stat:!0,forced:!XTe||JTe},{canParse:function(r){var o=YTe(arguments.length,1),s=H$(r),c=o<2||arguments[1]===void 0?void 0:H$(arguments[1]);try{return!!new aN(s,c)}catch{return!1}}});var QTe=Kt,ZTe=Kh,K$=Xo,eCe=k0,tCe=ni("URL");QTe({target:"URL",stat:!0,forced:!eCe},{parse:function(r){var o=ZTe(arguments.length,1),s=K$(r),c=o<2||arguments[1]===void 0?void 0:K$(arguments[1]);try{return new tCe(s,c)}catch{return null}}});var Y0=a(ar.URL);let z$=!0,Y$=!0;function q0(r,o,s){const c=r.match(o);return c&&c.length>=s&&parseInt(c[s],10)}function Qh(r,o,s){if(!r.RTCPeerConnection)return;const c=r.RTCPeerConnection.prototype,u=c.addEventListener;c.addEventListener=function(p,g){if(p!==o)return u.apply(this,arguments);const y=b=>{const w=s(b);w&&(g.handleEvent?g.handleEvent(w):g(w))};return this._eventMap=this._eventMap||{},this._eventMap[o]||(this._eventMap[o]=new Map),this._eventMap[o].set(g,y),u.apply(this,[p,y])};const h=c.removeEventListener;c.removeEventListener=function(p,g){if(p!==o||!this._eventMap||!this._eventMap[o])return h.apply(this,arguments);if(!this._eventMap[o].has(g))return h.apply(this,arguments);const y=this._eventMap[o].get(g);return this._eventMap[o].delete(g),this._eventMap[o].size===0&&delete this._eventMap[o],Object.keys(this._eventMap).length===0&&delete this._eventMap,h.apply(this,[p,y])},Object.defineProperty(c,"on"+o,{get(){return this["_on"+o]},set(p){this["_on"+o]&&(this.removeEventListener(o,this["_on"+o]),delete this["_on"+o]),p&&this.addEventListener(o,this["_on"+o]=p)},enumerable:!0,configurable:!0})}function nCe(r){return typeof r!="boolean"?new Error("Argument type: "+typeof r+". Please use a boolean."):(z$=r,r?"adapter.js logging disabled":"adapter.js logging enabled")}function rCe(r){return typeof r!="boolean"?new Error("Argument type: "+typeof r+". Please use a boolean."):(Y$=!r,"adapter.js deprecation warnings "+(r?"disabled":"enabled"))}function q$(){if(typeof window=="object"){if(z$)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function cN(r,o){Y$&&console.warn(r+" is deprecated, please use "+o+" instead.")}function X$(r){return Object.prototype.toString.call(r)==="[object Object]"}function J$(r){var o;return X$(r)?oa(o=Object.keys(r)).call(o,function(s,c){const u=X$(r[c]),h=u?J$(r[c]):r[c],p=u&&!Object.keys(h).length;return h===void 0||p?s:Object.assign(s,{[c]:h})},{}):r}function lN(r,o,s){o&&!s.has(o.id)&&(s.set(o.id,o),Object.keys(o).forEach(c=>{c.endsWith("Id")?lN(r,r.get(o[c]),s):c.endsWith("Ids")&&o[c].forEach(u=>{lN(r,r.get(u),s)})}))}function Q$(r,o,s){const c=s?"outbound-rtp":"inbound-rtp",u=new Map;if(o===null)return u;const h=[];return r.forEach(p=>{p.type==="track"&&p.trackIdentifier===o.id&&h.push(p)}),h.forEach(p=>{r.forEach(g=>{g.type===c&&g.trackId===p.id&&lN(r,g,u)})}),u}const Z$=q$;function eW(r,o){const s=r&&r.navigator;if(!s.mediaDevices)return;const c=function(p){if(typeof p!="object"||p.mandatory||p.optional)return p;const g={};return Object.keys(p).forEach(y=>{if(y==="require"||y==="advanced"||y==="mediaSource")return;const b=typeof p[y]=="object"?p[y]:{ideal:p[y]};b.exact!==void 0&&typeof b.exact=="number"&&(b.min=b.max=b.exact);const w=function(C,A){return C?C+A.charAt(0).toUpperCase()+A.slice(1):A==="deviceId"?"sourceId":A};if(b.ideal!==void 0){g.optional=g.optional||[];let C={};typeof b.ideal=="number"?(C[w("min",y)]=b.ideal,g.optional.push(C),C={},C[w("max",y)]=b.ideal,g.optional.push(C)):(C[w("",y)]=b.ideal,g.optional.push(C))}b.exact!==void 0&&typeof b.exact!="number"?(g.mandatory=g.mandatory||{},g.mandatory[w("",y)]=b.exact):["min","max"].forEach(C=>{b[C]!==void 0&&(g.mandatory=g.mandatory||{},g.mandatory[w(C,y)]=b[C])})}),p.advanced&&(g.optional=(g.optional||[]).concat(p.advanced)),g},u=function(p,g){if(o.version>=61)return g(p);if((p=JSON.parse(JSON.stringify(p)))&&typeof p.audio=="object"){const y=function(b,w,C){w in b&&!(C in b)&&(b[C]=b[w],delete b[w])};y((p=JSON.parse(JSON.stringify(p))).audio,"autoGainControl","googAutoGainControl"),y(p.audio,"noiseSuppression","googNoiseSuppression"),p.audio=c(p.audio)}if(p&&typeof p.video=="object"){let y=p.video.facingMode;y=y&&(typeof y=="object"?y:{ideal:y});const b=o.version<66;if(y&&(y.exact==="user"||y.exact==="environment"||y.ideal==="user"||y.ideal==="environment")&&(!s.mediaDevices.getSupportedConstraints||!s.mediaDevices.getSupportedConstraints().facingMode||b)){let w;if(delete p.video.facingMode,y.exact==="environment"||y.ideal==="environment"?w=["back","rear"]:y.exact!=="user"&&y.ideal!=="user"||(w=["front"]),w)return s.mediaDevices.enumerateDevices().then(C=>{let A=(C=C.filter(x=>x.kind==="videoinput")).find(x=>w.some(B=>{var U;return Pe(U=x.label.toLowerCase()).call(U,B)}));return!A&&C.length&&Pe(w).call(w,"back")&&(A=C[C.length-1]),A&&(p.video.deviceId=y.exact?{exact:A.deviceId}:{ideal:A.deviceId}),p.video=c(p.video),Z$("chrome: "+JSON.stringify(p)),g(p)})}p.video=c(p.video)}return Z$("chrome: "+JSON.stringify(p)),g(p)},h=function(p){return o.version>=64?p:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[p.name]||p.name,message:p.message,constraint:p.constraint||p.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(s.getUserMedia=(function(p,g,y){u(p,b=>{s.webkitGetUserMedia(b,g,w=>{y&&y(h(w))})})}).bind(s),s.mediaDevices.getUserMedia){const p=s.mediaDevices.getUserMedia.bind(s.mediaDevices);s.mediaDevices.getUserMedia=function(g){return u(g,y=>p(y).then(b=>{if(y.audio&&!b.getAudioTracks().length||y.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(w=>{w.stop()}),new DOMException("","NotFoundError");return b},b=>De.reject(h(b))))}}}function tW(r){r.MediaStream=r.MediaStream||r.webkitMediaStream}function nW(r){if(typeof r=="object"&&r.RTCPeerConnection&&!("ontrack"in r.RTCPeerConnection.prototype)){Object.defineProperty(r.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(s){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=s)},enumerable:!0,configurable:!0});const o=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=s=>{s.stream.addEventListener("addtrack",c=>{let u;u=r.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(p=>p.track&&p.track.id===c.track.id):{track:c.track};const h=new Event("track");h.track=c.track,h.receiver=u,h.transceiver={receiver:u},h.streams=[s.stream],this.dispatchEvent(h)}),s.stream.getTracks().forEach(c=>{let u;u=r.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(p=>p.track&&p.track.id===c.id):{track:c};const h=new Event("track");h.track=c,h.receiver=u,h.transceiver={receiver:u},h.streams=[s.stream],this.dispatchEvent(h)})},this.addEventListener("addstream",this._ontrackpoly)),o.apply(this,arguments)}}else Qh(r,"track",o=>(o.transceiver||Object.defineProperty(o,"transceiver",{value:{receiver:o.receiver}}),o))}function rW(r){if(typeof r=="object"&&r.RTCPeerConnection&&!("getSenders"in r.RTCPeerConnection.prototype)&&"createDTMFSender"in r.RTCPeerConnection.prototype){const o=function(u,h){return{track:h,get dtmf(){return this._dtmf===void 0&&(h.kind==="audio"?this._dtmf=u.createDTMFSender(h):this._dtmf=null),this._dtmf},_pc:u}};if(!r.RTCPeerConnection.prototype.getSenders){r.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const u=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addTrack=function(p,g){let y=u.apply(this,arguments);return y||(y=o(this,p),this._senders.push(y)),y};const h=r.RTCPeerConnection.prototype.removeTrack;r.RTCPeerConnection.prototype.removeTrack=function(p){h.apply(this,arguments);const g=this._senders.indexOf(p);g!==-1&&this._senders.splice(g,1)}}const s=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(u){this._senders=this._senders||[],s.apply(this,[u]),u.getTracks().forEach(h=>{this._senders.push(o(this,h))})};const c=r.RTCPeerConnection.prototype.removeStream;r.RTCPeerConnection.prototype.removeStream=function(u){this._senders=this._senders||[],c.apply(this,[u]),u.getTracks().forEach(h=>{const p=this._senders.find(g=>g.track===h);p&&this._senders.splice(this._senders.indexOf(p),1)})}}else if(typeof r=="object"&&r.RTCPeerConnection&&"getSenders"in r.RTCPeerConnection.prototype&&"createDTMFSender"in r.RTCPeerConnection.prototype&&r.RTCRtpSender&&!("dtmf"in r.RTCRtpSender.prototype)){const o=r.RTCPeerConnection.prototype.getSenders;r.RTCPeerConnection.prototype.getSenders=function(){const s=o.apply(this,[]);return s.forEach(c=>c._pc=this),s},Object.defineProperty(r.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function iW(r){if(!r.RTCPeerConnection)return;const o=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){const[s,c,u]=arguments;if(arguments.length>0&&typeof s=="function")return o.apply(this,arguments);if(o.length===0&&(arguments.length===0||typeof s!="function"))return o.apply(this,[]);const h=function(g){const y={};return g.result().forEach(b=>{const w={id:b.id,timestamp:b.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[b.type]||b.type};b.names().forEach(C=>{w[C]=b.stat(C)}),y[w.id]=w}),y},p=function(g){return new Map(Object.keys(g).map(y=>[y,g[y]]))};if(arguments.length>=2){const g=function(y){c(p(h(y)))};return o.apply(this,[g,s])}return new De((g,y)=>{o.apply(this,[function(b){g(p(h(b)))},y])}).then(c,u)}}function oW(r){if(!(typeof r=="object"&&r.RTCPeerConnection&&r.RTCRtpSender&&r.RTCRtpReceiver))return;if(!("getStats"in r.RTCRtpSender.prototype)){const s=r.RTCPeerConnection.prototype.getSenders;s&&(r.RTCPeerConnection.prototype.getSenders=function(){const u=s.apply(this,[]);return u.forEach(h=>h._pc=this),u});const c=r.RTCPeerConnection.prototype.addTrack;c&&(r.RTCPeerConnection.prototype.addTrack=function(){const u=c.apply(this,arguments);return u._pc=this,u}),r.RTCRtpSender.prototype.getStats=function(){const u=this;return this._pc.getStats().then(h=>Q$(h,u.track,!0))}}if(!("getStats"in r.RTCRtpReceiver.prototype)){const s=r.RTCPeerConnection.prototype.getReceivers;s&&(r.RTCPeerConnection.prototype.getReceivers=function(){const c=s.apply(this,[]);return c.forEach(u=>u._pc=this),c}),Qh(r,"track",c=>(c.receiver._pc=c.srcElement,c)),r.RTCRtpReceiver.prototype.getStats=function(){const c=this;return this._pc.getStats().then(u=>Q$(u,c.track,!1))}}if(!("getStats"in r.RTCRtpSender.prototype)||!("getStats"in r.RTCRtpReceiver.prototype))return;const o=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof r.MediaStreamTrack){const s=arguments[0];let c,u,h;return this.getSenders().forEach(p=>{p.track===s&&(c?h=!0:c=p)}),this.getReceivers().forEach(p=>(p.track===s&&(u?h=!0:u=p),p.track===s)),h||c&&u?De.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):c?c.getStats():u?u.getStats():De.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return o.apply(this,arguments)}}function sW(r){r.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(h=>this._shimmedLocalStreams[h][0])};const o=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addTrack=function(h,p){if(!p)return o.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const g=o.apply(this,arguments);return this._shimmedLocalStreams[p.id]?this._shimmedLocalStreams[p.id].indexOf(g)===-1&&this._shimmedLocalStreams[p.id].push(g):this._shimmedLocalStreams[p.id]=[p,g],g};const s=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(h){this._shimmedLocalStreams=this._shimmedLocalStreams||{},h.getTracks().forEach(y=>{if(this.getSenders().find(w=>w.track===y))throw new DOMException("Track already exists.","InvalidAccessError")});const p=this.getSenders();s.apply(this,arguments);const g=this.getSenders().filter(y=>p.indexOf(y)===-1);this._shimmedLocalStreams[h.id]=[h].concat(g)};const c=r.RTCPeerConnection.prototype.removeStream;r.RTCPeerConnection.prototype.removeStream=function(h){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[h.id],c.apply(this,arguments)};const u=r.RTCPeerConnection.prototype.removeTrack;r.RTCPeerConnection.prototype.removeTrack=function(h){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},h&&Object.keys(this._shimmedLocalStreams).forEach(p=>{const g=this._shimmedLocalStreams[p].indexOf(h);g!==-1&&this._shimmedLocalStreams[p].splice(g,1),this._shimmedLocalStreams[p].length===1&&delete this._shimmedLocalStreams[p]}),u.apply(this,arguments)}}function aW(r,o){if(!r.RTCPeerConnection)return;if(r.RTCPeerConnection.prototype.addTrack&&o.version>=65)return sW(r);const s=r.RTCPeerConnection.prototype.getLocalStreams;r.RTCPeerConnection.prototype.getLocalStreams=function(){const y=s.apply(this);return this._reverseStreams=this._reverseStreams||{},y.map(b=>this._reverseStreams[b.id])};const c=r.RTCPeerConnection.prototype.addStream;r.RTCPeerConnection.prototype.addStream=function(y){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},y.getTracks().forEach(b=>{if(this.getSenders().find(C=>C.track===b))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[y.id]){const b=new r.MediaStream(y.getTracks());this._streams[y.id]=b,this._reverseStreams[b.id]=y,y=b}c.apply(this,[y])};const u=r.RTCPeerConnection.prototype.removeStream;function h(y,b){let w=b.sdp;return Object.keys(y._reverseStreams||[]).forEach(C=>{const A=y._reverseStreams[C],x=y._streams[A.id];w=w.replace(new RegExp(x.id,"g"),A.id)}),new RTCSessionDescription({type:b.type,sdp:w})}r.RTCPeerConnection.prototype.removeStream=function(y){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.apply(this,[this._streams[y.id]||y]),delete this._reverseStreams[this._streams[y.id]?this._streams[y.id].id:y.id],delete this._streams[y.id]},r.RTCPeerConnection.prototype.addTrack=function(y,b){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const w=[].slice.call(arguments,1);if(w.length!==1||!w[0].getTracks().find(x=>x===y))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(x=>x.track===y))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const A=this._streams[b.id];if(A)A.addTrack(y),De.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const x=new r.MediaStream([y]);this._streams[b.id]=x,this._reverseStreams[x.id]=b,this.addStream(x)}return this.getSenders().find(x=>x.track===y)},["createOffer","createAnswer"].forEach(function(y){const b=r.RTCPeerConnection.prototype[y],w={[y](){const C=arguments;return arguments.length&&typeof arguments[0]=="function"?b.apply(this,[A=>{const x=h(this,A);C[0].apply(null,[x])},A=>{C[1]&&C[1].apply(null,A)},arguments[2]]):b.apply(this,arguments).then(A=>h(this,A))}};r.RTCPeerConnection.prototype[y]=w[y]});const p=r.RTCPeerConnection.prototype.setLocalDescription;r.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(y,b){let w=b.sdp;return Object.keys(y._reverseStreams||[]).forEach(C=>{const A=y._reverseStreams[C],x=y._streams[A.id];w=w.replace(new RegExp(A.id,"g"),x.id)}),new RTCSessionDescription({type:b.type,sdp:w})}(this,arguments[0]),p.apply(this,arguments)):p.apply(this,arguments)};const g=Object.getOwnPropertyDescriptor(r.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(r.RTCPeerConnection.prototype,"localDescription",{get(){const y=g.get.apply(this);return y.type===""?y:h(this,y)}}),r.RTCPeerConnection.prototype.removeTrack=function(y){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!y._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(y._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let b;this._streams=this._streams||{},Object.keys(this._streams).forEach(w=>{this._streams[w].getTracks().find(C=>y.track===C)&&(b=this._streams[w])}),b&&(b.getTracks().length===1?this.removeStream(this._reverseStreams[b.id]):b.removeTrack(y.track),this.dispatchEvent(new Event("negotiationneeded")))}}function uN(r,o){!r.RTCPeerConnection&&r.webkitRTCPeerConnection&&(r.RTCPeerConnection=r.webkitRTCPeerConnection),r.RTCPeerConnection&&o.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(s){const c=r.RTCPeerConnection.prototype[s],u={[s](){return arguments[0]=new(s==="addIceCandidate"?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)}};r.RTCPeerConnection.prototype[s]=u[s]})}function cW(r,o){Qh(r,"negotiationneeded",s=>{const c=s.target;if(!(o.version<72||c.getConfiguration&&c.getConfiguration().sdpSemantics==="plan-b")||c.signalingState==="stable")return s})}var lW=Object.freeze({__proto__:null,fixNegotiationNeeded:cW,shimAddTrackRemoveTrack:aW,shimAddTrackRemoveTrackWithNative:sW,shimGetDisplayMedia:function(r,o){r.navigator.mediaDevices&&"getDisplayMedia"in r.navigator.mediaDevices||r.navigator.mediaDevices&&(typeof o=="function"?r.navigator.mediaDevices.getDisplayMedia=function(s){return o(s).then(c=>{const u=s.video&&s.video.width,h=s.video&&s.video.height,p=s.video&&s.video.frameRate;return s.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:c,maxFrameRate:p||3}},u&&(s.video.mandatory.maxWidth=u),h&&(s.video.mandatory.maxHeight=h),r.navigator.mediaDevices.getUserMedia(s)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:rW,shimGetStats:iW,shimGetUserMedia:eW,shimMediaStream:tW,shimOnTrack:nW,shimPeerConnection:uN,shimSenderReceiverGetStats:oW});function uW(r,o){const s=r&&r.navigator,c=r&&r.MediaStreamTrack;if(s.getUserMedia=function(u,h,p){cN("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),s.mediaDevices.getUserMedia(u).then(h,p)},!(o.version>55&&"autoGainControl"in s.mediaDevices.getSupportedConstraints())){const u=function(p,g,y){g in p&&!(y in p)&&(p[y]=p[g],delete p[g])},h=s.mediaDevices.getUserMedia.bind(s.mediaDevices);if(s.mediaDevices.getUserMedia=function(p){return typeof p=="object"&&typeof p.audio=="object"&&(p=JSON.parse(JSON.stringify(p)),u(p.audio,"autoGainControl","mozAutoGainControl"),u(p.audio,"noiseSuppression","mozNoiseSuppression")),h(p)},c&&c.prototype.getSettings){const p=c.prototype.getSettings;c.prototype.getSettings=function(){const g=p.apply(this,arguments);return u(g,"mozAutoGainControl","autoGainControl"),u(g,"mozNoiseSuppression","noiseSuppression"),g}}if(c&&c.prototype.applyConstraints){const p=c.prototype.applyConstraints;c.prototype.applyConstraints=function(g){return this.kind==="audio"&&typeof g=="object"&&(g=JSON.parse(JSON.stringify(g)),u(g,"autoGainControl","mozAutoGainControl"),u(g,"noiseSuppression","mozNoiseSuppression")),p.apply(this,[g])}}}}function dW(r){typeof r=="object"&&r.RTCTrackEvent&&"receiver"in r.RTCTrackEvent.prototype&&!("transceiver"in r.RTCTrackEvent.prototype)&&Object.defineProperty(r.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function dN(r,o){if(typeof r!="object"||!r.RTCPeerConnection&&!r.mozRTCPeerConnection)return;!r.RTCPeerConnection&&r.mozRTCPeerConnection&&(r.RTCPeerConnection=r.mozRTCPeerConnection),o.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(u){const h=r.RTCPeerConnection.prototype[u],p={[u](){return arguments[0]=new(u==="addIceCandidate"?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]),h.apply(this,arguments)}};r.RTCPeerConnection.prototype[u]=p[u]});const s={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},c=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(){const[u,h,p]=arguments;return c.apply(this,[u||null]).then(g=>{if(o.version<53&&!h)try{g.forEach(y=>{y.type=s[y.type]||y.type})}catch(y){if(y.name!=="TypeError")throw y;g.forEach((b,w)=>{g.set(w,Object.assign({},b,{type:s[b.type]||b.type}))})}return g}).then(h,p)}}function hW(r){if(typeof r!="object"||!r.RTCPeerConnection||!r.RTCRtpSender||r.RTCRtpSender&&"getStats"in r.RTCRtpSender.prototype)return;const o=r.RTCPeerConnection.prototype.getSenders;o&&(r.RTCPeerConnection.prototype.getSenders=function(){const c=o.apply(this,[]);return c.forEach(u=>u._pc=this),c});const s=r.RTCPeerConnection.prototype.addTrack;s&&(r.RTCPeerConnection.prototype.addTrack=function(){const c=s.apply(this,arguments);return c._pc=this,c}),r.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):De.resolve(new Map)}}function fW(r){if(typeof r!="object"||!r.RTCPeerConnection||!r.RTCRtpSender||r.RTCRtpSender&&"getStats"in r.RTCRtpReceiver.prototype)return;const o=r.RTCPeerConnection.prototype.getReceivers;o&&(r.RTCPeerConnection.prototype.getReceivers=function(){const s=o.apply(this,[]);return s.forEach(c=>c._pc=this),s}),Qh(r,"track",s=>(s.receiver._pc=s.srcElement,s)),r.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function pW(r){r.RTCPeerConnection&&!("removeStream"in r.RTCPeerConnection.prototype)&&(r.RTCPeerConnection.prototype.removeStream=function(o){cN("removeStream","removeTrack"),this.getSenders().forEach(s=>{var c;s.track&&Pe(c=o.getTracks()).call(c,s.track)&&this.removeTrack(s)})})}function mW(r){r.DataChannel&&!r.RTCDataChannel&&(r.RTCDataChannel=r.DataChannel)}function gW(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const o=r.RTCPeerConnection.prototype.addTransceiver;o&&(r.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let s=arguments[1]&&arguments[1].sendEncodings;s===void 0&&(s=[]),s=[...s];const c=s.length>0;c&&s.forEach(h=>{if("rid"in h&&!/^[a-z0-9]{0,16}$/i.test(h.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in h&&!(parseFloat(h.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in h&&!(parseFloat(h.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const u=o.apply(this,arguments);if(c){const{sender:h}=u,p=h.getParameters();(!("encodings"in p)||p.encodings.length===1&&Object.keys(p.encodings[0]).length===0)&&(p.encodings=s,h.sendEncodings=s,this.setParametersPromises.push(h.setParameters(p).then(()=>{delete h.sendEncodings}).catch(()=>{delete h.sendEncodings})))}return u})}function vW(r){if(typeof r!="object"||!r.RTCRtpSender)return;const o=r.RTCRtpSender.prototype.getParameters;o&&(r.RTCRtpSender.prototype.getParameters=function(){const s=o.apply(this,arguments);return"encodings"in s||(s.encodings=[].concat(this.sendEncodings||[{}])),s})}function yW(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const o=r.RTCPeerConnection.prototype.createOffer;r.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?De.all(this.setParametersPromises).then(()=>o.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):o.apply(this,arguments)}}function _W(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const o=r.RTCPeerConnection.prototype.createAnswer;r.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?De.all(this.setParametersPromises).then(()=>o.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):o.apply(this,arguments)}}var EW=Object.freeze({__proto__:null,shimAddTransceiver:gW,shimCreateAnswer:_W,shimCreateOffer:yW,shimGetDisplayMedia:function(r,o){r.navigator.mediaDevices&&"getDisplayMedia"in r.navigator.mediaDevices||r.navigator.mediaDevices&&(r.navigator.mediaDevices.getDisplayMedia=function(s){if(!s||!s.video){const c=new DOMException("getDisplayMedia without video constraints is undefined");return c.name="NotFoundError",c.code=8,De.reject(c)}return s.video===!0?s.video={mediaSource:o}:s.video.mediaSource=o,r.navigator.mediaDevices.getUserMedia(s)})},shimGetParameters:vW,shimGetUserMedia:uW,shimOnTrack:dW,shimPeerConnection:dN,shimRTCDataChannel:mW,shimReceiverGetStats:fW,shimRemoveStream:pW,shimSenderGetStats:hW});function bW(r){if(typeof r=="object"&&r.RTCPeerConnection){if("getLocalStreams"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in r.RTCPeerConnection.prototype)){const o=r.RTCPeerConnection.prototype.addTrack;r.RTCPeerConnection.prototype.addStream=function(s){var c;this._localStreams||(this._localStreams=[]),Pe(c=this._localStreams).call(c,s)||this._localStreams.push(s),s.getAudioTracks().forEach(u=>o.call(this,u,s)),s.getVideoTracks().forEach(u=>o.call(this,u,s))},r.RTCPeerConnection.prototype.addTrack=function(s){for(var c=arguments.length,u=new Array(c>1?c-1:0),h=1;h<c;h++)u[h-1]=arguments[h];return u&&u.forEach(p=>{var g;this._localStreams?Pe(g=this._localStreams).call(g,p)||this._localStreams.push(p):this._localStreams=[p]}),o.apply(this,arguments)}}"removeStream"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.removeStream=function(o){this._localStreams||(this._localStreams=[]);const s=this._localStreams.indexOf(o);if(s===-1)return;this._localStreams.splice(s,1);const c=o.getTracks();this.getSenders().forEach(u=>{Pe(c).call(c,u.track)&&this.removeTrack(u)})})}}function SW(r){if(typeof r=="object"&&r.RTCPeerConnection&&("getRemoteStreams"in r.RTCPeerConnection.prototype||(r.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in r.RTCPeerConnection.prototype))){Object.defineProperty(r.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(s){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=s),this.addEventListener("track",this._onaddstreampoly=c=>{c.streams.forEach(u=>{var h;if(this._remoteStreams||(this._remoteStreams=[]),Pe(h=this._remoteStreams).call(h,u))return;this._remoteStreams.push(u);const p=new Event("addstream");p.stream=u,this.dispatchEvent(p)})})}});const o=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){const s=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(c){c.streams.forEach(u=>{if(s._remoteStreams||(s._remoteStreams=[]),s._remoteStreams.indexOf(u)>=0)return;s._remoteStreams.push(u);const h=new Event("addstream");h.stream=u,s.dispatchEvent(h)})}),o.apply(s,arguments)}}}function wW(r){if(typeof r!="object"||!r.RTCPeerConnection)return;const o=r.RTCPeerConnection.prototype,s=o.createOffer,c=o.createAnswer,u=o.setLocalDescription,h=o.setRemoteDescription,p=o.addIceCandidate;o.createOffer=function(y,b){const w=arguments.length>=2?arguments[2]:arguments[0],C=s.apply(this,[w]);return b?(C.then(y,b),De.resolve()):C},o.createAnswer=function(y,b){const w=arguments.length>=2?arguments[2]:arguments[0],C=c.apply(this,[w]);return b?(C.then(y,b),De.resolve()):C};let g=function(y,b,w){const C=u.apply(this,[y]);return w?(C.then(b,w),De.resolve()):C};o.setLocalDescription=g,g=function(y,b,w){const C=h.apply(this,[y]);return w?(C.then(b,w),De.resolve()):C},o.setRemoteDescription=g,g=function(y,b,w){const C=p.apply(this,[y]);return w?(C.then(b,w),De.resolve()):C},o.addIceCandidate=g}function TW(r){const o=r&&r.navigator;if(o.mediaDevices&&o.mediaDevices.getUserMedia){const s=o.mediaDevices,c=s.getUserMedia.bind(s);o.mediaDevices.getUserMedia=u=>c(CW(u))}!o.getUserMedia&&o.mediaDevices&&o.mediaDevices.getUserMedia&&(o.getUserMedia=(function(s,c,u){o.mediaDevices.getUserMedia(s).then(c,u)}).bind(o))}function CW(r){return r&&r.video!==void 0?Object.assign({},r,{video:J$(r.video)}):r}function RW(r){if(!r.RTCPeerConnection)return;const o=r.RTCPeerConnection;r.RTCPeerConnection=function(s,c){if(s&&s.iceServers){const u=[];for(let h=0;h<s.iceServers.length;h++){let p=s.iceServers[h];!p.hasOwnProperty("urls")&&p.hasOwnProperty("url")?(cN("RTCIceServer.url","RTCIceServer.urls"),p=JSON.parse(JSON.stringify(p)),p.urls=p.url,delete p.url,u.push(p)):u.push(s.iceServers[h])}s.iceServers=u}return new o(s,c)},r.RTCPeerConnection.prototype=o.prototype,"generateCertificate"in o&&Object.defineProperty(r.RTCPeerConnection,"generateCertificate",{get:()=>o.generateCertificate})}function AW(r){typeof r=="object"&&r.RTCTrackEvent&&"receiver"in r.RTCTrackEvent.prototype&&!("transceiver"in r.RTCTrackEvent.prototype)&&Object.defineProperty(r.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function OW(r){const o=r.RTCPeerConnection.prototype.createOffer;r.RTCPeerConnection.prototype.createOffer=function(s){if(s){s.offerToReceiveAudio!==void 0&&(s.offerToReceiveAudio=!!s.offerToReceiveAudio);const c=this.getTransceivers().find(h=>h.receiver.track.kind==="audio");s.offerToReceiveAudio===!1&&c?c.direction==="sendrecv"?c.setDirection?c.setDirection("sendonly"):c.direction="sendonly":c.direction==="recvonly"&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive"):s.offerToReceiveAudio!==!0||c||this.addTransceiver("audio",{direction:"recvonly"}),s.offerToReceiveVideo!==void 0&&(s.offerToReceiveVideo=!!s.offerToReceiveVideo);const u=this.getTransceivers().find(h=>h.receiver.track.kind==="video");s.offerToReceiveVideo===!1&&u?u.direction==="sendrecv"?u.setDirection?u.setDirection("sendonly"):u.direction="sendonly":u.direction==="recvonly"&&(u.setDirection?u.setDirection("inactive"):u.direction="inactive"):s.offerToReceiveVideo!==!0||u||this.addTransceiver("video",{direction:"recvonly"})}return o.apply(this,arguments)}}function IW(r){typeof r!="object"||r.AudioContext||(r.AudioContext=r.webkitAudioContext)}var xW=Object.freeze({__proto__:null,shimAudioContext:IW,shimCallbacksAPI:wW,shimConstraints:CW,shimCreateOfferLegacy:OW,shimGetUserMedia:TW,shimLocalStreamsAPI:bW,shimRTCIceServerUrls:RW,shimRemoteStreamsAPI:SW,shimTrackEventTransceiver:AW}),PW=`	
\v\f\r                　\u2028\u2029\uFEFF`,iCe=at,oCe=Xo,hN=PW,NW=S("".replace),sCe=RegExp("^["+hN+"]+"),aCe=RegExp("(^|[^"+hN+"])["+hN+"]+$"),cCe=function(r){return function(o){var s=oCe(iCe(o));return 1&r&&(s=NW(s,sCe,"")),2&r&&(s=NW(s,aCe,"$1")),s}},lCe={trim:cCe(3)},uCe=m4.PROPER,dCe=l,DW=PW,hCe=lCe.trim;Kt({target:"String",proto:!0,forced:function(r){return dCe(function(){return!!DW[r]()||"​᠎"[r]()!=="​᠎"||uCe&&DW[r].name!==r})}("trim")},{trim:function(){return hCe(this)}});var fCe=ia("String","trim"),pCe=T,mCe=fCe,fN=String.prototype,gCe=function(r){var o=r.trim;return typeof r=="string"||r===fN||pCe(fN,r)&&o===fN.trim?mCe:o},Oi=a(gCe),kW={exports:{}};(function(r){const o={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};o.localCName=o.generateIdentifier(),o.splitLines=function(s){return s.trim().split(`
`).map(c=>c.trim())},o.splitSections=function(s){return s.split(`
m=`).map((c,u)=>(u>0?"m="+c:c).trim()+`\r
`)},o.getDescription=function(s){const c=o.splitSections(s);return c&&c[0]},o.getMediaSections=function(s){const c=o.splitSections(s);return c.shift(),c},o.matchPrefix=function(s,c){return o.splitLines(s).filter(u=>u.indexOf(c)===0)},o.parseCandidate=function(s){let c;c=s.indexOf("a=candidate:")===0?s.substring(12).split(" "):s.substring(10).split(" ");const u={foundation:c[0],component:{1:"rtp",2:"rtcp"}[c[1]]||c[1],protocol:c[2].toLowerCase(),priority:parseInt(c[3],10),ip:c[4],address:c[4],port:parseInt(c[5],10),type:c[7]};for(let h=8;h<c.length;h+=2)switch(c[h]){case"raddr":u.relatedAddress=c[h+1];break;case"rport":u.relatedPort=parseInt(c[h+1],10);break;case"tcptype":u.tcpType=c[h+1];break;case"ufrag":u.ufrag=c[h+1],u.usernameFragment=c[h+1];break;default:u[c[h]]===void 0&&(u[c[h]]=c[h+1])}return u},o.writeCandidate=function(s){const c=[];c.push(s.foundation);const u=s.component;u==="rtp"?c.push(1):u==="rtcp"?c.push(2):c.push(u),c.push(s.protocol.toUpperCase()),c.push(s.priority),c.push(s.address||s.ip),c.push(s.port);const h=s.type;return c.push("typ"),c.push(h),h!=="host"&&s.relatedAddress&&s.relatedPort&&(c.push("raddr"),c.push(s.relatedAddress),c.push("rport"),c.push(s.relatedPort)),s.tcpType&&s.protocol.toLowerCase()==="tcp"&&(c.push("tcptype"),c.push(s.tcpType)),(s.usernameFragment||s.ufrag)&&(c.push("ufrag"),c.push(s.usernameFragment||s.ufrag)),"candidate:"+c.join(" ")},o.parseIceOptions=function(s){return s.substring(14).split(" ")},o.parseRtpMap=function(s){let c=s.substring(9).split(" ");const u={payloadType:parseInt(c.shift(),10)};return c=c[0].split("/"),u.name=c[0],u.clockRate=parseInt(c[1],10),u.channels=c.length===3?parseInt(c[2],10):1,u.numChannels=u.channels,u},o.writeRtpMap=function(s){let c=s.payloadType;s.preferredPayloadType!==void 0&&(c=s.preferredPayloadType);const u=s.channels||s.numChannels||1;return"a=rtpmap:"+c+" "+s.name+"/"+s.clockRate+(u!==1?"/"+u:"")+`\r
`},o.parseExtmap=function(s){const c=s.substring(9).split(" ");return{id:parseInt(c[0],10),direction:c[0].indexOf("/")>0?c[0].split("/")[1]:"sendrecv",uri:c[1],attributes:c.slice(2).join(" ")}},o.writeExtmap=function(s){return"a=extmap:"+(s.id||s.preferredId)+(s.direction&&s.direction!=="sendrecv"?"/"+s.direction:"")+" "+s.uri+(s.attributes?" "+s.attributes:"")+`\r
`},o.parseFmtp=function(s){const c={};let u;const h=s.substring(s.indexOf(" ")+1).split(";");for(let p=0;p<h.length;p++)u=h[p].trim().split("="),c[u[0].trim()]=u[1];return c},o.writeFmtp=function(s){let c="",u=s.payloadType;if(s.preferredPayloadType!==void 0&&(u=s.preferredPayloadType),s.parameters&&Object.keys(s.parameters).length){const h=[];Object.keys(s.parameters).forEach(p=>{s.parameters[p]!==void 0?h.push(p+"="+s.parameters[p]):h.push(p)}),c+="a=fmtp:"+u+" "+h.join(";")+`\r
`}return c},o.parseRtcpFb=function(s){const c=s.substring(s.indexOf(" ")+1).split(" ");return{type:c.shift(),parameter:c.join(" ")}},o.writeRtcpFb=function(s){let c="",u=s.payloadType;return s.preferredPayloadType!==void 0&&(u=s.preferredPayloadType),s.rtcpFeedback&&s.rtcpFeedback.length&&s.rtcpFeedback.forEach(h=>{c+="a=rtcp-fb:"+u+" "+h.type+(h.parameter&&h.parameter.length?" "+h.parameter:"")+`\r
`}),c},o.parseSsrcMedia=function(s){const c=s.indexOf(" "),u={ssrc:parseInt(s.substring(7,c),10)},h=s.indexOf(":",c);return h>-1?(u.attribute=s.substring(c+1,h),u.value=s.substring(h+1)):u.attribute=s.substring(c+1),u},o.parseSsrcGroup=function(s){const c=s.substring(13).split(" ");return{semantics:c.shift(),ssrcs:c.map(u=>parseInt(u,10))}},o.getMid=function(s){const c=o.matchPrefix(s,"a=mid:")[0];if(c)return c.substring(6)},o.parseFingerprint=function(s){const c=s.substring(14).split(" ");return{algorithm:c[0].toLowerCase(),value:c[1].toUpperCase()}},o.getDtlsParameters=function(s,c){return{role:"auto",fingerprints:o.matchPrefix(s+c,"a=fingerprint:").map(o.parseFingerprint)}},o.writeDtlsParameters=function(s,c){let u="a=setup:"+c+`\r
`;return s.fingerprints.forEach(h=>{u+="a=fingerprint:"+h.algorithm+" "+h.value+`\r
`}),u},o.parseCryptoLine=function(s){const c=s.substring(9).split(" ");return{tag:parseInt(c[0],10),cryptoSuite:c[1],keyParams:c[2],sessionParams:c.slice(3)}},o.writeCryptoLine=function(s){return"a=crypto:"+s.tag+" "+s.cryptoSuite+" "+(typeof s.keyParams=="object"?o.writeCryptoKeyParams(s.keyParams):s.keyParams)+(s.sessionParams?" "+s.sessionParams.join(" "):"")+`\r
`},o.parseCryptoKeyParams=function(s){if(s.indexOf("inline:")!==0)return null;const c=s.substring(7).split("|");return{keyMethod:"inline",keySalt:c[0],lifeTime:c[1],mkiValue:c[2]?c[2].split(":")[0]:void 0,mkiLength:c[2]?c[2].split(":")[1]:void 0}},o.writeCryptoKeyParams=function(s){return s.keyMethod+":"+s.keySalt+(s.lifeTime?"|"+s.lifeTime:"")+(s.mkiValue&&s.mkiLength?"|"+s.mkiValue+":"+s.mkiLength:"")},o.getCryptoParameters=function(s,c){return o.matchPrefix(s+c,"a=crypto:").map(o.parseCryptoLine)},o.getIceParameters=function(s,c){const u=o.matchPrefix(s+c,"a=ice-ufrag:")[0],h=o.matchPrefix(s+c,"a=ice-pwd:")[0];return u&&h?{usernameFragment:u.substring(12),password:h.substring(10)}:null},o.writeIceParameters=function(s){let c="a=ice-ufrag:"+s.usernameFragment+`\r
a=ice-pwd:`+s.password+`\r
`;return s.iceLite&&(c+=`a=ice-lite\r
`),c},o.parseRtpParameters=function(s){const c={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},u=o.splitLines(s)[0].split(" ");c.profile=u[2];for(let p=3;p<u.length;p++){const g=u[p],y=o.matchPrefix(s,"a=rtpmap:"+g+" ")[0];if(y){const b=o.parseRtpMap(y),w=o.matchPrefix(s,"a=fmtp:"+g+" ");switch(b.parameters=w.length?o.parseFmtp(w[0]):{},b.rtcpFeedback=o.matchPrefix(s,"a=rtcp-fb:"+g+" ").map(o.parseRtcpFb),c.codecs.push(b),b.name.toUpperCase()){case"RED":case"ULPFEC":c.fecMechanisms.push(b.name.toUpperCase())}}}o.matchPrefix(s,"a=extmap:").forEach(p=>{c.headerExtensions.push(o.parseExtmap(p))});const h=o.matchPrefix(s,"a=rtcp-fb:* ").map(o.parseRtcpFb);return c.codecs.forEach(p=>{h.forEach(g=>{p.rtcpFeedback.find(y=>y.type===g.type&&y.parameter===g.parameter)||p.rtcpFeedback.push(g)})}),c},o.writeRtpDescription=function(s,c){let u="";u+="m="+s+" ",u+=c.codecs.length>0?"9":"0",u+=" "+(c.profile||"UDP/TLS/RTP/SAVPF")+" ",u+=c.codecs.map(p=>p.preferredPayloadType!==void 0?p.preferredPayloadType:p.payloadType).join(" ")+`\r
`,u+=`c=IN IP4 0.0.0.0\r
`,u+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,c.codecs.forEach(p=>{u+=o.writeRtpMap(p),u+=o.writeFmtp(p),u+=o.writeRtcpFb(p)});let h=0;return c.codecs.forEach(p=>{p.maxptime>h&&(h=p.maxptime)}),h>0&&(u+="a=maxptime:"+h+`\r
`),c.headerExtensions&&c.headerExtensions.forEach(p=>{u+=o.writeExtmap(p)}),u},o.parseRtpEncodingParameters=function(s){const c=[],u=o.parseRtpParameters(s),h=u.fecMechanisms.indexOf("RED")!==-1,p=u.fecMechanisms.indexOf("ULPFEC")!==-1,g=o.matchPrefix(s,"a=ssrc:").map(A=>o.parseSsrcMedia(A)).filter(A=>A.attribute==="cname"),y=g.length>0&&g[0].ssrc;let b;const w=o.matchPrefix(s,"a=ssrc-group:FID").map(A=>A.substring(17).split(" ").map(x=>parseInt(x,10)));w.length>0&&w[0].length>1&&w[0][0]===y&&(b=w[0][1]),u.codecs.forEach(A=>{if(A.name.toUpperCase()==="RTX"&&A.parameters.apt){let x={ssrc:y,codecPayloadType:parseInt(A.parameters.apt,10)};y&&b&&(x.rtx={ssrc:b}),c.push(x),h&&(x=JSON.parse(JSON.stringify(x)),x.fec={ssrc:y,mechanism:p?"red+ulpfec":"red"},c.push(x))}}),c.length===0&&y&&c.push({ssrc:y});let C=o.matchPrefix(s,"b=");return C.length&&(C=C[0].indexOf("b=TIAS:")===0?parseInt(C[0].substring(7),10):C[0].indexOf("b=AS:")===0?1e3*parseInt(C[0].substring(5),10)*.95-16e3:void 0,c.forEach(A=>{A.maxBitrate=C})),c},o.parseRtcpParameters=function(s){const c={},u=o.matchPrefix(s,"a=ssrc:").map(g=>o.parseSsrcMedia(g)).filter(g=>g.attribute==="cname")[0];u&&(c.cname=u.value,c.ssrc=u.ssrc);const h=o.matchPrefix(s,"a=rtcp-rsize");c.reducedSize=h.length>0,c.compound=h.length===0;const p=o.matchPrefix(s,"a=rtcp-mux");return c.mux=p.length>0,c},o.writeRtcpParameters=function(s){let c="";return s.reducedSize&&(c+=`a=rtcp-rsize\r
`),s.mux&&(c+=`a=rtcp-mux\r
`),s.ssrc!==void 0&&s.cname&&(c+="a=ssrc:"+s.ssrc+" cname:"+s.cname+`\r
`),c},o.parseMsid=function(s){let c;const u=o.matchPrefix(s,"a=msid:");if(u.length===1)return c=u[0].substring(7).split(" "),{stream:c[0],track:c[1]};const h=o.matchPrefix(s,"a=ssrc:").map(p=>o.parseSsrcMedia(p)).filter(p=>p.attribute==="msid");return h.length>0?(c=h[0].value.split(" "),{stream:c[0],track:c[1]}):void 0},o.parseSctpDescription=function(s){const c=o.parseMLine(s),u=o.matchPrefix(s,"a=max-message-size:");let h;u.length>0&&(h=parseInt(u[0].substring(19),10)),isNaN(h)&&(h=65536);const p=o.matchPrefix(s,"a=sctp-port:");if(p.length>0)return{port:parseInt(p[0].substring(12),10),protocol:c.fmt,maxMessageSize:h};const g=o.matchPrefix(s,"a=sctpmap:");if(g.length>0){const y=g[0].substring(10).split(" ");return{port:parseInt(y[0],10),protocol:y[1],maxMessageSize:h}}},o.writeSctpDescription=function(s,c){let u=[];return u=s.protocol!=="DTLS/SCTP"?["m="+s.kind+" 9 "+s.protocol+" "+c.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+c.port+`\r
`]:["m="+s.kind+" 9 "+s.protocol+" "+c.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+c.port+" "+c.protocol+` 65535\r
`],c.maxMessageSize!==void 0&&u.push("a=max-message-size:"+c.maxMessageSize+`\r
`),u.join("")},o.generateSessionId=function(){return Math.random().toString().substr(2,22)},o.writeSessionBoilerplate=function(s,c,u){let h;const p=c!==void 0?c:2;return h=s||o.generateSessionId(),`v=0\r
o=`+(u||"thisisadapterortc")+" "+h+" "+p+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},o.getDirection=function(s,c){const u=o.splitLines(s);for(let h=0;h<u.length;h++)switch(u[h]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return u[h].substring(2)}return c?o.getDirection(c):"sendrecv"},o.getKind=function(s){return o.splitLines(s)[0].split(" ")[0].substring(2)},o.isRejected=function(s){return s.split(" ",2)[1]==="0"},o.parseMLine=function(s){const c=o.splitLines(s)[0].substring(2).split(" ");return{kind:c[0],port:parseInt(c[1],10),protocol:c[2],fmt:c.slice(3).join(" ")}},o.parseOLine=function(s){const c=o.matchPrefix(s,"o=")[0].substring(2).split(" ");return{username:c[0],sessionId:c[1],sessionVersion:parseInt(c[2],10),netType:c[3],addressType:c[4],address:c[5]}},o.isValidSDP=function(s){if(typeof s!="string"||s.length===0)return!1;const c=o.splitLines(s);for(let u=0;u<c.length;u++)if(c[u].length<2||c[u].charAt(1)!=="=")return!1;return!0},r.exports=o})(kW);var LW=kW.exports,am=a(LW),vCe=n({__proto__:null,default:am},[LW]);function X0(r){if(!r.RTCIceCandidate||r.RTCIceCandidate&&"foundation"in r.RTCIceCandidate.prototype)return;const o=r.RTCIceCandidate;r.RTCIceCandidate=function(s){if(typeof s=="object"&&s.candidate&&s.candidate.indexOf("a=")===0&&((s=JSON.parse(JSON.stringify(s))).candidate=s.candidate.substr(2)),s.candidate&&s.candidate.length){const c=new o(s),u=am.parseCandidate(s.candidate),h=Object.assign(c,u);return h.toJSON=function(){return{candidate:h.candidate,sdpMid:h.sdpMid,sdpMLineIndex:h.sdpMLineIndex,usernameFragment:h.usernameFragment}},h}return new o(s)},r.RTCIceCandidate.prototype=o.prototype,Qh(r,"icecandidate",s=>(s.candidate&&Object.defineProperty(s,"candidate",{value:new r.RTCIceCandidate(s.candidate),writable:"false"}),s))}function pN(r){!r.RTCIceCandidate||r.RTCIceCandidate&&"relayProtocol"in r.RTCIceCandidate.prototype||Qh(r,"icecandidate",o=>{if(o.candidate){const s=am.parseCandidate(o.candidate.candidate);s.type==="relay"&&(o.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[s.priority>>24])}return o})}function J0(r,o){if(!r.RTCPeerConnection)return;"sctp"in r.RTCPeerConnection.prototype||Object.defineProperty(r.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const s=function(g){if(!g||!g.sdp)return!1;const y=am.splitSections(g.sdp);return y.shift(),y.some(b=>{const w=am.parseMLine(b);return w&&w.kind==="application"&&w.protocol.indexOf("SCTP")!==-1})},c=function(g){const y=g.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(y===null||y.length<2)return-1;const b=parseInt(y[1],10);return b!=b?-1:b},u=function(g){let y=65536;return o.browser==="firefox"&&(y=o.version<57?g===-1?16384:2147483637:o.version<60?o.version===57?65535:65536:2147483637),y},h=function(g,y){let b=65536;o.browser==="firefox"&&o.version===57&&(b=65535);const w=am.matchPrefix(g.sdp,"a=max-message-size:");return w.length>0?b=parseInt(w[0].substr(19),10):o.browser==="firefox"&&y!==-1&&(b=2147483637),b},p=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,o.browser==="chrome"&&o.version>=76){const{sdpSemantics:g}=this.getConfiguration();g==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(s(arguments[0])){const g=c(arguments[0]),y=u(g),b=h(arguments[0],g);let w;w=y===0&&b===0?Number.POSITIVE_INFINITY:y===0||b===0?Math.max(y,b):Math.min(y,b);const C={};Object.defineProperty(C,"maxMessageSize",{get:()=>w}),this._sctp=C}return p.apply(this,arguments)}}function Q0(r){if(!r.RTCPeerConnection||!("createDataChannel"in r.RTCPeerConnection.prototype))return;function o(c,u){const h=c.send;c.send=function(){const p=arguments[0],g=p.length||p.size||p.byteLength;if(c.readyState==="open"&&u.sctp&&g>u.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+u.sctp.maxMessageSize+" bytes)");return h.apply(c,arguments)}}const s=r.RTCPeerConnection.prototype.createDataChannel;r.RTCPeerConnection.prototype.createDataChannel=function(){const c=s.apply(this,arguments);return o(c,this),c},Qh(r,"datachannel",c=>(o(c.channel,c.target),c))}function mN(r){if(!r.RTCPeerConnection||"connectionState"in r.RTCPeerConnection.prototype)return;const o=r.RTCPeerConnection.prototype;Object.defineProperty(o,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(o,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(s){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),s&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=s)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(s=>{const c=o[s];o[s]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=u=>{const h=u.target;if(h._lastConnectionState!==h.connectionState){h._lastConnectionState=h.connectionState;const p=new Event("connectionstatechange",u);h.dispatchEvent(p)}return u},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),c.apply(this,arguments)}})}function gN(r,o){if(!r.RTCPeerConnection||o.browser==="chrome"&&o.version>=71||o.browser==="safari"&&o.version>=605)return;const s=r.RTCPeerConnection.prototype.setRemoteDescription;r.RTCPeerConnection.prototype.setRemoteDescription=function(c){if(c&&c.sdp&&c.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const u=c.sdp.split(`
`).filter(h=>Oi(h).call(h)!=="a=extmap-allow-mixed").join(`
`);r.RTCSessionDescription&&c instanceof r.RTCSessionDescription?arguments[0]=new r.RTCSessionDescription({type:c.type,sdp:u}):c.sdp=u}return s.apply(this,arguments)}}function Z0(r,o){if(!r.RTCPeerConnection||!r.RTCPeerConnection.prototype)return;const s=r.RTCPeerConnection.prototype.addIceCandidate;s&&s.length!==0&&(r.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(o.browser==="chrome"&&o.version<78||o.browser==="firefox"&&o.version<68||o.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?De.resolve():s.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),De.resolve())})}function ew(r,o){if(!r.RTCPeerConnection||!r.RTCPeerConnection.prototype)return;const s=r.RTCPeerConnection.prototype.setLocalDescription;s&&s.length!==0&&(r.RTCPeerConnection.prototype.setLocalDescription=function(){let c=arguments[0]||{};if(typeof c!="object"||c.type&&c.sdp)return s.apply(this,arguments);if(c={type:c.type,sdp:c.sdp},!c.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":c.type="offer";break;default:c.type="answer"}return c.sdp||c.type!=="offer"&&c.type!=="answer"?s.apply(this,[c]):(c.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(u=>s.apply(this,[u]))})}var yCe=Object.freeze({__proto__:null,removeExtmapAllowMixed:gN,shimAddIceCandidateNullOrEmpty:Z0,shimConnectionState:mN,shimMaxMessageSize:J0,shimParameterlessSetLocalDescription:ew,shimRTCIceCandidate:X0,shimRTCIceCandidateRelayProtocol:pN,shimSendThrowTypeError:Q0});(function(){let{window:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const s=q$,c=function(h){const p={browser:null,version:null};if(h===void 0||!h.navigator)return p.browser="Not a browser.",p;const{navigator:g}=h;if(g.mozGetUserMedia)p.browser="firefox",p.version=q0(g.userAgent,/Firefox\/(\d+)\./,1);else if(g.webkitGetUserMedia||h.isSecureContext===!1&&h.webkitRTCPeerConnection)p.browser="chrome",p.version=q0(g.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!h.RTCPeerConnection||!g.userAgent.match(/AppleWebKit\/(\d+)\./))return p.browser="Not a supported browser.",p;p.browser="safari",p.version=q0(g.userAgent,/AppleWebKit\/(\d+)\./,1),p.supportsUnifiedPlan=h.RTCRtpTransceiver&&"currentDirection"in h.RTCRtpTransceiver.prototype}return p}(r),u={browserDetails:c,commonShim:yCe,extractVersion:q0,disableLog:nCe,disableWarnings:rCe,sdp:vCe};switch(c.browser){case"chrome":if(!lW||!uN||!o.shimChrome)return s("Chrome shim is not included in this adapter release."),u;if(c.version===null)return s("Chrome shim can not determine version, not shimming."),u;s("adapter.js shimming chrome."),u.browserShim=lW,Z0(r,c),ew(r),eW(r,c),tW(r),uN(r,c),nW(r),aW(r,c),rW(r),iW(r),oW(r),cW(r,c),X0(r),pN(r),mN(r),J0(r,c),Q0(r),gN(r,c);break;case"firefox":if(!EW||!dN||!o.shimFirefox)return s("Firefox shim is not included in this adapter release."),u;s("adapter.js shimming firefox."),u.browserShim=EW,Z0(r,c),ew(r),uW(r,c),dN(r,c),dW(r),pW(r),hW(r),fW(r),mW(r),gW(r),vW(r),yW(r),_W(r),X0(r),mN(r),J0(r,c),Q0(r);break;case"safari":if(!xW||!o.shimSafari)return s("Safari shim is not included in this adapter release."),u;s("adapter.js shimming safari."),u.browserShim=xW,Z0(r,c),ew(r),RW(r),OW(r),wW(r),bW(r),SW(r),AW(r),TW(r),IW(r),X0(r),pN(r),J0(r,c),Q0(r),gN(r,c);break;default:s("Unsupported browser!")}})({window:typeof window>"u"?void 0:window});var vN=I;Kt({global:!0,forced:vN.globalThis!==vN},{globalThis:vN});var MW=a(I),yN={exports:{}};(function(r,o){(function(s,c){var u="function",h="undefined",p="object",g="string",y="major",b="model",w="name",C="type",A="vendor",x="version",B="architecture",U="console",F="mobile",K="tablet",z="smarttv",Q="wearable",ie="embedded",oe="Amazon",re="Apple",me="ASUS",Ee="BlackBerry",xe="Browser",Me="Chrome",pt="Firefox",ut="Google",nt="Huawei",hn="LG",en="Microsoft",ro="Motorola",be="Opera",Oe="Samsung",Ve="Sharp",Se="Sony",j="Xiaomi",X="Zebra",Z="Facebook",Ae="Chromium OS",ct="Mac OS",ln=" Browser",dr=function(or){for(var hr={},gn=0;gn<or.length;gn++)hr[or[gn].toUpperCase()]=or[gn];return hr},js=function(or,hr){return typeof or===g&&Ra(hr).indexOf(Ra(or))!==-1},Ra=function(or){return or.toLowerCase()},X_=function(or,hr){if(typeof or===g)return or=or.replace(/^\s\s*/,""),typeof hr===h?or:or.substring(0,500)},Af=function(or,hr){for(var gn,go,dc,Gn,nu,Rt,hc=0;hc<hr.length&&!nu;){var Of=hr[hc],ll=hr[hc+1];for(gn=go=0;gn<Of.length&&!nu&&Of[gn];)if(nu=Of[gn++].exec(or))for(dc=0;dc<ll.length;dc++)Rt=nu[++go],typeof(Gn=ll[dc])===p&&Gn.length>0?Gn.length===2?typeof Gn[1]==u?this[Gn[0]]=Gn[1].call(this,Rt):this[Gn[0]]=Gn[1]:Gn.length===3?typeof Gn[1]!==u||Gn[1].exec&&Gn[1].test?this[Gn[0]]=Rt?Rt.replace(Gn[1],Gn[2]):c:this[Gn[0]]=Rt?Gn[1].call(this,Rt,Gn[2]):c:Gn.length===4&&(this[Gn[0]]=Rt?Gn[3].call(this,Rt.replace(Gn[1],Gn[2])):c):this[Gn]=Rt||c;hc+=2}},Zm=function(or,hr){for(var gn in hr)if(typeof hr[gn]===p&&hr[gn].length>0){for(var go=0;go<hr[gn].length;go++)if(js(hr[gn][go],or))return gn==="?"?c:gn}else if(js(hr[gn],or))return gn==="?"?c:gn;return hr.hasOwnProperty("*")?hr["*"]:or},XT={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},JT={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[x,[w,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[x,[w,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[w,x],[/opios[\/ ]+([\w\.]+)/i],[x,[w,be+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[x,[w,be+" GX"]],[/\bopr\/([\w\.]+)/i],[x,[w,be]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[x,[w,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[x,[w,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[w,x],[/quark(?:pc)?\/([-\w\.]+)/i],[x,[w,"Quark"]],[/\bddg\/([\w\.]+)/i],[x,[w,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[x,[w,"UC"+xe]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[x,[w,"WeChat"]],[/konqueror\/([\w\.]+)/i],[x,[w,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[x,[w,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[x,[w,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[x,[w,"Smart Lenovo "+xe]],[/(avast|avg)\/([\w\.]+)/i],[[w,/(.+)/,"$1 Secure "+xe],x],[/\bfocus\/([\w\.]+)/i],[x,[w,pt+" Focus"]],[/\bopt\/([\w\.]+)/i],[x,[w,be+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[x,[w,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[x,[w,"Dolphin"]],[/coast\/([\w\.]+)/i],[x,[w,be+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[x,[w,"MIUI"+ln]],[/fxios\/([\w\.-]+)/i],[x,[w,pt]],[/\bqihoobrowser\/?([\w\.]*)/i],[x,[w,"360"]],[/\b(qq)\/([\w\.]+)/i],[[w,/(.+)/,"$1Browser"],x],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[w,/(.+)/,"$1"+ln],x],[/samsungbrowser\/([\w\.]+)/i],[x,[w,Oe+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[x,[w,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[w,"Sogou Mobile"],x],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[w,x],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[w],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[x,w],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[w,Z],x],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[w,x],[/\bgsa\/([\w\.]+) .*safari\//i],[x,[w,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[x,[w,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[x,[w,Me+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[w,Me+" WebView"],x],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[x,[w,"Android "+xe]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[w,x],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[x,[w,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[x,w],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[w,[x,Zm,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[w,x],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[w,"Netscape"],x],[/(wolvic|librewolf)\/([\w\.]+)/i],[w,x],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[x,[w,pt+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[w,[x,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[w,[x,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[B,"amd64"]],[/(ia32(?=;))/i],[[B,Ra]],[/((?:i[346]|x)86)[;\)]/i],[[B,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[B,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[B,"armhf"]],[/windows (ce|mobile); ppc;/i],[[B,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[B,/ower/,"",Ra]],[/(sun4\w)[;\)]/i],[[B,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[B,Ra]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[b,[A,Oe],[C,K]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[b,[A,Oe],[C,F]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[b,[A,re],[C,F]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[b,[A,re],[C,K]],[/(macintosh);/i],[b,[A,re]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[b,[A,Ve],[C,F]],[/(?:honor)([-\w ]+)[;\)]/i],[b,[A,"Honor"],[C,F]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[b,[A,nt],[C,K]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[b,[A,nt],[C,F]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[b,/_/g," "],[A,j],[C,F]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[b,/_/g," "],[A,j],[C,K]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[b,[A,"OPPO"],[C,F]],[/\b(opd2\d{3}a?) bui/i],[b,[A,"OPPO"],[C,K]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[b,[A,"Vivo"],[C,F]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[b,[A,"Realme"],[C,F]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[b,[A,ro],[C,F]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[b,[A,ro],[C,K]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[b,[A,hn],[C,K]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[b,[A,hn],[C,F]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[b,[A,"Lenovo"],[C,K]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[b,/_/g," "],[A,"Nokia"],[C,F]],[/(pixel c)\b/i],[b,[A,ut],[C,K]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[b,[A,ut],[C,F]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[b,[A,Se],[C,F]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[b,"Xperia Tablet"],[A,Se],[C,K]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[b,[A,"OnePlus"],[C,F]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[b,[A,oe],[C,K]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[b,/(.+)/g,"Fire Phone $1"],[A,oe],[C,F]],[/(playbook);[-\w\),; ]+(rim)/i],[b,A,[C,K]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[b,[A,Ee],[C,F]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[b,[A,me],[C,K]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[b,[A,me],[C,F]],[/(nexus 9)/i],[b,[A,"HTC"],[C,K]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[A,[b,/_/g," "],[C,F]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[b,[A,"TCL"],[C,K]],[/(itel) ((\w+))/i],[[A,Ra],b,[C,Zm,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[b,[A,"Acer"],[C,K]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[b,[A,"Meizu"],[C,F]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[b,[A,"Ulefone"],[C,F]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[b,[A,"Energizer"],[C,F]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[b,[A,"Cat"],[C,F]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[b,[A,"Smartfren"],[C,F]],[/droid.+; (a(?:015|06[35]|142p?))/i],[b,[A,"Nothing"],[C,F]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[A,b,[C,F]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[A,b,[C,K]],[/(surface duo)/i],[b,[A,en],[C,K]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[b,[A,"Fairphone"],[C,F]],[/(u304aa)/i],[b,[A,"AT&T"],[C,F]],[/\bsie-(\w*)/i],[b,[A,"Siemens"],[C,F]],[/\b(rct\w+) b/i],[b,[A,"RCA"],[C,K]],[/\b(venue[\d ]{2,7}) b/i],[b,[A,"Dell"],[C,K]],[/\b(q(?:mv|ta)\w+) b/i],[b,[A,"Verizon"],[C,K]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[b,[A,"Barnes & Noble"],[C,K]],[/\b(tm\d{3}\w+) b/i],[b,[A,"NuVision"],[C,K]],[/\b(k88) b/i],[b,[A,"ZTE"],[C,K]],[/\b(nx\d{3}j) b/i],[b,[A,"ZTE"],[C,F]],[/\b(gen\d{3}) b.+49h/i],[b,[A,"Swiss"],[C,F]],[/\b(zur\d{3}) b/i],[b,[A,"Swiss"],[C,K]],[/\b((zeki)?tb.*\b) b/i],[b,[A,"Zeki"],[C,K]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[A,"Dragon Touch"],b,[C,K]],[/\b(ns-?\w{0,9}) b/i],[b,[A,"Insignia"],[C,K]],[/\b((nxa|next)-?\w{0,9}) b/i],[b,[A,"NextBook"],[C,K]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[A,"Voice"],b,[C,F]],[/\b(lvtel\-)?(v1[12]) b/i],[[A,"LvTel"],b,[C,F]],[/\b(ph-1) /i],[b,[A,"Essential"],[C,F]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[b,[A,"Envizen"],[C,K]],[/\b(trio[-\w\. ]+) b/i],[b,[A,"MachSpeed"],[C,K]],[/\btu_(1491) b/i],[b,[A,"Rotor"],[C,K]],[/(shield[\w ]+) b/i],[b,[A,"Nvidia"],[C,K]],[/(sprint) (\w+)/i],[A,b,[C,F]],[/(kin\.[onetw]{3})/i],[[b,/\./g," "],[A,en],[C,F]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[b,[A,X],[C,K]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[b,[A,X],[C,F]],[/smart-tv.+(samsung)/i],[A,[C,z]],[/hbbtv.+maple;(\d+)/i],[[b,/^/,"SmartTV"],[A,Oe],[C,z]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[A,hn],[C,z]],[/(apple) ?tv/i],[A,[b,re+" TV"],[C,z]],[/crkey/i],[[b,Me+"cast"],[A,ut],[C,z]],[/droid.+aft(\w+)( bui|\))/i],[b,[A,oe],[C,z]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[b,[A,Ve],[C,z]],[/(bravia[\w ]+)( bui|\))/i],[b,[A,Se],[C,z]],[/(mitv-\w{5}) bui/i],[b,[A,j],[C,z]],[/Hbbtv.*(technisat) (.*);/i],[A,b,[C,z]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[A,X_],[b,X_],[C,z]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[C,z]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[A,b,[C,U]],[/droid.+; (shield) bui/i],[b,[A,"Nvidia"],[C,U]],[/(playstation [345portablevi]+)/i],[b,[A,Se],[C,U]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[b,[A,en],[C,U]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[b,[A,Oe],[C,Q]],[/((pebble))app/i],[A,b,[C,Q]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[b,[A,re],[C,Q]],[/droid.+; (glass) \d/i],[b,[A,ut],[C,Q]],[/droid.+; (wt63?0{2,3})\)/i],[b,[A,X],[C,Q]],[/droid.+; (glass) \d/i],[b,[A,ut],[C,Q]],[/(pico) (4|neo3(?: link|pro)?)/i],[A,b,[C,Q]],[/; (quest( \d| pro)?)/i],[b,[A,Z],[C,Q]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[A,[C,ie]],[/(aeobc)\b/i],[b,[A,oe],[C,ie]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[b,[C,F]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[b,[C,K]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[C,K]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[C,F]],[/(android[-\w\. ]{0,9});.+buil/i],[b,[A,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[x,[w,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[w,x],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[x,[w,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[w,x],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[x,w]],os:[[/microsoft (windows) (vista|xp)/i],[w,x],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[w,[x,Zm,XT]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[x,Zm,XT],[w,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[x,/_/g,"."],[w,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[w,ct],[x,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[x,w],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[w,x],[/\(bb(10);/i],[x,[w,Ee]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[x,[w,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[x,[w,pt+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[x,[w,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[x,[w,"watchOS"]],[/crkey\/([\d\.]+)/i],[x,[w,Me+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[w,Ae],x],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[w,x],[/(sunos) ?([\w\.\d]*)/i],[[w,"Solaris"],x],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[w,x]]},Us=function(or,hr){if(typeof or===p&&(hr=or,or=c),!(this instanceof Us))return new Us(or,hr).getResult();var gn=typeof s!==h&&s.navigator?s.navigator:c,go=or||(gn&&gn.userAgent?gn.userAgent:""),dc=gn&&gn.userAgentData?gn.userAgentData:c,Gn=hr?function(Rt,hc){var Of={};for(var ll in Rt)hc[ll]&&hc[ll].length%2==0?Of[ll]=hc[ll].concat(Rt[ll]):Of[ll]=Rt[ll];return Of}(JT,hr):JT,nu=gn&&gn.userAgent==go;return this.getBrowser=function(){var Rt={};return Rt[w]=c,Rt[x]=c,Af.call(Rt,go,Gn.browser),Rt[y]=function(hc){return typeof hc===g?hc.replace(/[^\d\.]/g,"").split(".")[0]:c}(Rt[x]),nu&&gn&&gn.brave&&typeof gn.brave.isBrave==u&&(Rt[w]="Brave"),Rt},this.getCPU=function(){var Rt={};return Rt[B]=c,Af.call(Rt,go,Gn.cpu),Rt},this.getDevice=function(){var Rt={};return Rt[A]=c,Rt[b]=c,Rt[C]=c,Af.call(Rt,go,Gn.device),nu&&!Rt[C]&&dc&&dc.mobile&&(Rt[C]=F),nu&&Rt[b]=="Macintosh"&&gn&&typeof gn.standalone!==h&&gn.maxTouchPoints&&gn.maxTouchPoints>2&&(Rt[b]="iPad",Rt[C]=K),Rt},this.getEngine=function(){var Rt={};return Rt[w]=c,Rt[x]=c,Af.call(Rt,go,Gn.engine),Rt},this.getOS=function(){var Rt={};return Rt[w]=c,Rt[x]=c,Af.call(Rt,go,Gn.os),nu&&!Rt[w]&&dc&&dc.platform&&dc.platform!="Unknown"&&(Rt[w]=dc.platform.replace(/chrome os/i,Ae).replace(/macos/i,ct)),Rt},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return go},this.setUA=function(Rt){return go=typeof Rt===g&&Rt.length>500?X_(Rt,500):Rt,this},this.setUA(go),this};Us.VERSION="0.7.40",Us.BROWSER=dr([w,x,y]),Us.CPU=dr([B]),Us.DEVICE=dr([b,A,C,U,F,z,K,Q,ie]),Us.ENGINE=Us.OS=dr([w,x]),r.exports&&(o=r.exports=Us),o.UAParser=Us;var tu=typeof s!==h&&(s.jQuery||s.Zepto);if(tu&&!tu.ua){var QT=new Us;tu.ua=QT.getResult(),tu.ua.get=function(){return QT.getUA()},tu.ua.set=function(or){QT.setUA(or);var hr=QT.getResult();for(var gn in hr)tu.ua[gn]=hr[gn]}}})(typeof window=="object"?window:i)})(yN,yN.exports);var _Ce=a(yN.exports),jW=A0.clear;Kt({global:!0,bind:!0,forced:I.clearImmediate!==jW},{clearImmediate:jW});var UW=I,ECe=M,bCe=de,SCe=Ax,wCe=lo,TCe=rd,CCe=Kh,RCe=UW.Function,ACe=/MSIE .\./.test(wCe)||SCe==="BUN"&&function(){var r=UW.Bun.version.split(".");return r.length<3||r[0]==="0"&&(r[1]<3||r[1]==="3"&&r[2]==="0")}(),OCe=Kt,VW=I,FW=A0.set,ICe=function(r,o){var s=1;return ACe?function(c,u){var h=CCe(arguments.length,1)>s,p=bCe(c)?c:RCe(c),g=h?TCe(arguments,s):[],y=h?function(){ECe(p,this,g)}:p;return r(y)}:r},BW=VW.setImmediate?ICe(FW):FW;OCe({global:!0,bind:!0,forced:VW.setImmediate!==BW},{setImmediate:BW});var $W=a(ar.setImmediate),xCe=I,PCe=e5,NCe=Wr,DCe=Kh,kCe=ce;Kt({global:!0,dontCallGetSet:!0,forced:l(function(){return kCe&&Object.getOwnPropertyDescriptor(xCe,"queueMicrotask").value.length!==1})},{queueMicrotask:function(r){DCe(arguments.length,1),PCe(NCe(r))}});var WW=a(ar.queueMicrotask);function GW(r,o){return function(){return r.apply(o,arguments)}}const{toString:LCe}=Object.prototype,{getPrototypeOf:_N}=Object,{iterator:tw,toStringTag:HW}=Symbol,nw=(EN=Object.create(null),r=>{const o=LCe.call(r);return EN[o]||(EN[o]=o.slice(8,-1).toLowerCase())});var EN;const Qa=r=>(r=r.toLowerCase(),o=>nw(o)===r),rw=r=>o=>typeof o===r,{isArray:cm}=Array,Ky=rw("undefined"),KW=Qa("ArrayBuffer"),MCe=rw("string"),Jo=rw("function"),zW=rw("number"),iw=r=>r!==null&&typeof r=="object",ow=r=>{if(nw(r)!=="object")return!1;const o=_N(r);return!(o!==null&&o!==Object.prototype&&Object.getPrototypeOf(o)!==null||HW in r||tw in r)},jCe=Qa("Date"),UCe=Qa("File"),VCe=Qa("Blob"),FCe=Qa("FileList"),BCe=Qa("URLSearchParams"),[$Ce,WCe,GCe,HCe]=["ReadableStream","Request","Response","Headers"].map(Qa);function zy(r,o){let s,c,{allOwnKeys:u=!1}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(r!=null)if(typeof r!="object"&&(r=[r]),cm(r))for(s=0,c=r.length;s<c;s++)o.call(null,r[s],s,r);else{const h=u?Object.getOwnPropertyNames(r):Object.keys(r),p=h.length;let g;for(s=0;s<p;s++)g=h[s],o.call(null,r[g],g,r)}}function YW(r,o){o=o.toLowerCase();const s=Object.keys(r);let c,u=s.length;for(;u-- >0;)if(c=s[u],o===c.toLowerCase())return c;return null}const Zh=MW!==void 0?MW:typeof self<"u"?self:typeof window<"u"?window:Ri,qW=r=>!Ky(r)&&r!==Zh,KCe=(bN=typeof Uint8Array<"u"&&_N(Uint8Array),r=>bN&&r instanceof bN);var bN;const zCe=Qa("HTMLFormElement"),XW=(r=>{let{hasOwnProperty:o}=r;return(s,c)=>o.call(s,c)})(Object.prototype),YCe=Qa("RegExp"),JW=(r,o)=>{const s=Object.getOwnPropertyDescriptors(r),c={};zy(s,(u,h)=>{let p;(p=o(u,h,r))!==!1&&(c[h]=p||u)}),Object.defineProperties(r,c)},qCe=Qa("AsyncFunction"),QW=(ZW=typeof $W=="function",e6=Jo(Zh.postMessage),ZW?$W:e6?(SN="axios@".concat(Math.random()),sw=[],Zh.addEventListener("message",r=>{let{source:o,data:s}=r;o===Zh&&s===SN&&sw.length&&sw.shift()()},!1),r=>{sw.push(r),Zh.postMessage(SN,"*")}):r=>setTimeout(r));var ZW,e6,SN,sw;const XCe=WW!==void 0?WW.bind(Zh):typeof process<"u"&&process.nextTick||QW;var Ne={isArray:cm,isArrayBuffer:KW,isBuffer:function(r){return r!==null&&!Ky(r)&&r.constructor!==null&&!Ky(r.constructor)&&Jo(r.constructor.isBuffer)&&r.constructor.isBuffer(r)},isFormData:r=>{let o;return r&&(typeof FormData=="function"&&r instanceof FormData||Jo(r.append)&&((o=nw(r))==="formdata"||o==="object"&&Jo(r.toString)&&r.toString()==="[object FormData]"))},isArrayBufferView:function(r){let o;return o=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(r):r&&r.buffer&&KW(r.buffer),o},isString:MCe,isNumber:zW,isBoolean:r=>r===!0||r===!1,isObject:iw,isPlainObject:ow,isReadableStream:$Ce,isRequest:WCe,isResponse:GCe,isHeaders:HCe,isUndefined:Ky,isDate:jCe,isFile:UCe,isBlob:VCe,isRegExp:YCe,isFunction:Jo,isStream:r=>iw(r)&&Jo(r.pipe),isURLSearchParams:BCe,isTypedArray:KCe,isFileList:FCe,forEach:zy,merge:function r(){const{caseless:o}=qW(this)&&this||{},s={},c=(u,h)=>{const p=o&&YW(s,h)||h;ow(s[p])&&ow(u)?s[p]=r(s[p],u):ow(u)?s[p]=r({},u):cm(u)?s[p]=u.slice():s[p]=u};for(let u=0,h=arguments.length;u<h;u++)arguments[u]&&zy(arguments[u],c);return s},extend:function(r,o,s){let{allOwnKeys:c}=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return zy(o,(u,h)=>{s&&Jo(u)?r[h]=GW(u,s):r[h]=u},{allOwnKeys:c}),r},trim:r=>Oi(r)?Oi(r).call(r):r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),inherits:(r,o,s,c)=>{r.prototype=Object.create(o.prototype,c),r.prototype.constructor=r,Object.defineProperty(r,"super",{value:o.prototype}),s&&Object.assign(r.prototype,s)},toFlatObject:(r,o,s,c)=>{let u,h,p;const g={};if(o=o||{},r==null)return o;do{for(u=Object.getOwnPropertyNames(r),h=u.length;h-- >0;)p=u[h],c&&!c(p,r,o)||g[p]||(o[p]=r[p],g[p]=!0);r=s!==!1&&_N(r)}while(r&&(!s||s(r,o))&&r!==Object.prototype);return o},kindOf:nw,kindOfTest:Qa,endsWith:(r,o,s)=>{r=String(r),(s===void 0||s>r.length)&&(s=r.length),s-=o.length;const c=r.indexOf(o,s);return c!==-1&&c===s},toArray:r=>{if(!r)return null;if(cm(r))return r;let o=r.length;if(!zW(o))return null;const s=new Array(o);for(;o-- >0;)s[o]=r[o];return s},forEachEntry:(r,o)=>{const s=(r&&r[tw]).call(r);let c;for(;(c=s.next())&&!c.done;){const u=c.value;o.call(r,u[0],u[1])}},matchAll:(r,o)=>{let s;const c=[];for(;(s=r.exec(o))!==null;)c.push(s);return c},isHTMLForm:zCe,hasOwnProperty:XW,hasOwnProp:XW,reduceDescriptors:JW,freezeMethods:r=>{JW(r,(o,s)=>{if(Jo(r)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const c=r[s];Jo(c)&&(o.enumerable=!1,"writable"in o?o.writable=!1:o.set||(o.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")}))})},toObjectSet:(r,o)=>{const s={},c=u=>{u.forEach(h=>{s[h]=!0})};return cm(r)?c(r):c(String(r).split(o)),s},toCamelCase:r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(o,s,c){return s.toUpperCase()+c}),noop:()=>{},toFiniteNumber:(r,o)=>r!=null&&Number.isFinite(r=+r)?r:o,findKey:YW,global:Zh,isContextDefined:qW,isSpecCompliantForm:function(r){return!!(r&&Jo(r.append)&&r[HW]==="FormData"&&r[tw])},toJSONObject:r=>{const o=new Array(10),s=(c,u)=>{if(iw(c)){if(o.indexOf(c)>=0)return;if(!("toJSON"in c)){o[u]=c;const h=cm(c)?[]:{};return zy(c,(p,g)=>{const y=s(p,u+1);!Ky(y)&&(h[g]=y)}),o[u]=void 0,h}}return c};return s(r,0)},isAsyncFn:qCe,isThenable:r=>r&&(iw(r)||Jo(r))&&Jo(r.then)&&Jo(r.catch),setImmediate:QW,asap:XCe,isIterable:r=>r!=null&&Jo(r[tw])};function Jt(r,o,s,c,u){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=r,this.name="AxiosError",o&&(this.code=o),s&&(this.config=s),c&&(this.request=c),u&&(this.response=u,this.status=u.status?u.status:null)}Ne.inherits(Jt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ne.toJSONObject(this.config),code:this.code,status:this.status}}});const t6=Jt.prototype,n6={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(r=>{n6[r]={value:r}}),Object.defineProperties(Jt,n6),Object.defineProperty(t6,"isAxiosError",{value:!0}),Jt.from=(r,o,s,c,u,h)=>{const p=Object.create(t6);return Ne.toFlatObject(r,p,function(g){return g!==Error.prototype},g=>g!=="isAxiosError"),Jt.call(p,r.message,o,s,c,u),p.cause=r,p.name=r.name,h&&Object.assign(p,h),p};function wN(r){return Ne.isPlainObject(r)||Ne.isArray(r)}function r6(r){return Ne.endsWith(r,"[]")?r.slice(0,-2):r}function i6(r,o,s){return r?r.concat(o).map(function(c,u){return c=r6(c),!s&&u?"["+c+"]":c}).join(s?".":""):o}const JCe=Ne.toFlatObject(Ne,{},null,function(r){return/^is[A-Z]/.test(r)});function aw(r,o,s){if(!Ne.isObject(r))throw new TypeError("target must be an object");o=o||new FormData;const c=(s=Ne.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(A,x){return!Ne.isUndefined(x[A])})).metaTokens,u=s.visitor||b,h=s.dots,p=s.indexes,g=(s.Blob||typeof Blob<"u"&&Blob)&&Ne.isSpecCompliantForm(o);if(!Ne.isFunction(u))throw new TypeError("visitor must be a function");function y(A){if(A===null)return"";if(Ne.isDate(A))return A.toISOString();if(!g&&Ne.isBlob(A))throw new Jt("Blob is not supported. Use a Buffer instead.");return Ne.isArrayBuffer(A)||Ne.isTypedArray(A)?g&&typeof Blob=="function"?new Blob([A]):Buffer.from(A):A}function b(A,x,B){let U=A;if(A&&!B&&typeof A=="object"){if(Ne.endsWith(x,"{}"))x=c?x:x.slice(0,-2),A=JSON.stringify(A);else if(Ne.isArray(A)&&function(F){return Ne.isArray(F)&&!F.some(wN)}(A)||(Ne.isFileList(A)||Ne.endsWith(x,"[]"))&&(U=Ne.toArray(A)))return x=r6(x),U.forEach(function(F,K){!Ne.isUndefined(F)&&F!==null&&o.append(p===!0?i6([x],K,h):p===null?x:x+"[]",y(F))}),!1}return!!wN(A)||(o.append(i6(B,x,h),y(A)),!1)}const w=[],C=Object.assign(JCe,{defaultVisitor:b,convertValue:y,isVisitable:wN});if(!Ne.isObject(r))throw new TypeError("data must be an object");return function A(x,B){if(!Ne.isUndefined(x)){if(w.indexOf(x)!==-1)throw Error("Circular reference detected in "+B.join("."));w.push(x),Ne.forEach(x,function(U,F){(!(Ne.isUndefined(U)||U===null)&&u.call(o,U,Ne.isString(F)?Oi(F).call(F):F,B,C))===!0&&A(U,B?B.concat(F):[F])}),w.pop()}}(r),o}function o6(r){const o={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(s){return o[s]})}function TN(r,o){this._pairs=[],r&&aw(r,this,o)}const s6=TN.prototype;function QCe(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function a6(r,o,s){if(!o)return r;const c=s&&s.encode||QCe;Ne.isFunction(s)&&(s={serialize:s});const u=s&&s.serialize;let h;if(h=u?u(o,s):Ne.isURLSearchParams(o)?o.toString():new TN(o,s).toString(c),h){const p=r.indexOf("#");p!==-1&&(r=r.slice(0,p)),r+=(r.indexOf("?")===-1?"?":"&")+h}return r}s6.append=function(r,o){this._pairs.push([r,o])},s6.toString=function(r){const o=r?function(s){return r.call(this,s,o6)}:o6;return this._pairs.map(function(s){return o(s[0])+"="+o(s[1])},"").join("&")};var c6=class{constructor(){this.handlers=[]}use(r,o,s){return this.handlers.push({fulfilled:r,rejected:o,synchronous:!!s&&s.synchronous,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){Ne.forEach(this.handlers,function(o){o!==null&&r(o)})}},l6={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},u6={exports:{}},ZCe=Kt,eRe=ce,d6=ra.f;ZCe({target:"Object",stat:!0,forced:Object.defineProperty!==d6,sham:!eRe},{defineProperty:d6});var h6=ar.Object,tRe=u6.exports=function(r,o,s){return h6.defineProperty(r,o,s)};h6.defineProperty.sham&&(tRe.sham=!0);var f6=a(u6.exports),nRe=TypeError,p6=Ay,rRe=R0,iRe=Mn,oRe=cr("species"),m6=Array,sRe=function(r){var o;return p6(r)&&(o=r.constructor,(rRe(o)&&(o===m6||p6(o.prototype))||iRe(o)&&(o=o[oRe])===null)&&(o=void 0)),o===void 0?m6:o},g6=function(r,o){return new(sRe(r))(o===0?0:o)},aRe=l,cRe=qo,lRe=cr("species"),v6=function(r){return cRe>=51||!aRe(function(){var o=[];return(o.constructor={})[lRe]=function(){return{foo:1}},o[r](Boolean).foo!==1})},uRe=Kt,dRe=l,hRe=Ay,fRe=Mn,pRe=Bc,mRe=ed,y6=function(r){if(r>9007199254740991)throw nRe("Maximum allowed index exceeded");return r},_6=FP,gRe=g6,vRe=v6,yRe=qo,E6=cr("isConcatSpreadable"),_Re=yRe>=51||!dRe(function(){var r=[];return r[E6]=!1,r.concat()[0]!==r}),ERe=function(r){if(!fRe(r))return!1;var o=r[E6];return o!==void 0?!!o:hRe(r)};uRe({target:"Array",proto:!0,forced:!_Re||!vRe("concat")},{concat:function(r){var o,s,c,u,h,p=pRe(this),g=gRe(p,0),y=0;for(o=-1,c=arguments.length;o<c;o++)if(ERe(h=o===-1?p:arguments[o]))for(u=mRe(h),y6(y+u),s=0;s<u;s++,y++)s in h&&_6(g,y,h[s]);else y6(y+1),_6(g,y++,h);return g.length=y,g}});var b6={},bRe=H,SRe=nn,S6=u0.f,wRe=rd,w6=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];b6.f=function(r){return w6&&bRe(r)==="Window"?function(o){try{return S6(o)}catch{return wRe(w6)}}(r):S6(SRe(r))};var lm={},TRe=cr;lm.f=TRe;var T6=ar,CRe=bi,RRe=lm,ARe=ra.f,Gr=function(r){var o=T6.Symbol||(T6.Symbol={});CRe(o,r)||ARe(o,r,{value:RRe.f(r)})},ORe=te,IRe=ni,xRe=cr,PRe=nd,C6=function(){var r=IRe("Symbol"),o=r&&r.prototype,s=o&&o.valueOf,c=xRe("toPrimitive");o&&!o[c]&&PRe(o,c,function(u){return ORe(s,this)},{})},NRe=Zu,DRe=we,kRe=Bc,LRe=ed,MRe=g6,R6=S([].push),jRe=function(r){var o=r===1,s=r===2,c=r===3,u=r===4,h=r===6,p=r===7,g=r===5||h;return function(y,b,w,C){for(var A,x,B=kRe(y),U=DRe(B),F=LRe(U),K=NRe(b,w),z=0,Q=C||MRe,ie=o?Q(y,F):s||p?Q(y,0):void 0;F>z;z++)if((g||z in U)&&(x=K(A=U[z],z,B),r))if(o)ie[z]=x;else if(x)switch(r){case 3:return!0;case 5:return A;case 6:return z;case 2:R6(ie,A)}else switch(r){case 4:return!1;case 7:R6(ie,A)}return h?-1:c||u?u:ie}},A6={forEach:jRe(0)},cw=Kt,Yy=I,CN=te,URe=S,um=ce,dm=Qu,VRe=l,Ui=bi,FRe=T,RN=Io,lw=nn,AN=px,BRe=Xo,ON=Ze,hm=Iy,O6=h0,$Re=u0,I6=b6,WRe=Oy,x6=ae,P6=ra,GRe=kx,N6=ne,D6=nd,HRe=C0,IN=Vp,k6=d0,L6=hx,KRe=cr,zRe=lm,YRe=Gr,qRe=C6,XRe=Ul,M6=Hh,uw=A6.forEach,Qo=l0("hidden"),dw="Symbol",qy="prototype",JRe=M6.set,j6=M6.getterFor(dw),Za=Object[qy],ef=Yy.Symbol,hw=ef&&ef[qy],QRe=Yy.RangeError,ZRe=Yy.TypeError,xN=Yy.QObject,U6=x6.f,tf=P6.f,V6=I6.f,eAe=N6.f,F6=URe([].push),Bl=IN("symbols"),Xy=IN("op-symbols"),tAe=IN("wks"),PN=!xN||!xN[qy]||!xN[qy].findChild,B6=function(r,o,s){var c=U6(Za,o);c&&delete Za[o],tf(r,o,s),c&&r!==Za&&tf(Za,o,c)},NN=um&&VRe(function(){return hm(tf({},"a",{get:function(){return tf(this,"a",{value:7}).a}})).a!==7})?B6:tf,DN=function(r,o){var s=Bl[r]=hm(hw);return JRe(s,{type:dw,tag:r,description:o}),um||(s.description=o),s},fw=function(r,o,s){r===Za&&fw(Xy,o,s),RN(r);var c=AN(o);return RN(s),Ui(Bl,c)?(s.enumerable?(Ui(r,Qo)&&r[Qo][c]&&(r[Qo][c]=!1),s=hm(s,{enumerable:ON(0,!1)})):(Ui(r,Qo)||tf(r,Qo,ON(1,hm(null))),r[Qo][c]=!0),NN(r,c,s)):tf(r,c,s)},kN=function(r,o){RN(r);var s=lw(o),c=O6(s).concat(H6(s));return uw(c,function(u){um&&!CN($6,s,u)||fw(r,u,s[u])}),r},$6=function(r){var o=AN(r),s=CN(eAe,this,o);return!(this===Za&&Ui(Bl,o)&&!Ui(Xy,o))&&(!(s||!Ui(this,o)||!Ui(Bl,o)||Ui(this,Qo)&&this[Qo][o])||s)},W6=function(r,o){var s=lw(r),c=AN(o);if(s!==Za||!Ui(Bl,c)||Ui(Xy,c)){var u=U6(s,c);return!u||!Ui(Bl,c)||Ui(s,Qo)&&s[Qo][c]||(u.enumerable=!0),u}},G6=function(r){var o=V6(lw(r)),s=[];return uw(o,function(c){Ui(Bl,c)||Ui(k6,c)||F6(s,c)}),s},H6=function(r){var o=r===Za,s=V6(o?Xy:lw(r)),c=[];return uw(s,function(u){!Ui(Bl,u)||o&&!Ui(Za,u)||F6(c,Bl[u])}),c};dm||(ef=function(){if(FRe(hw,this))throw new ZRe("Symbol is not a constructor");var r=arguments.length&&arguments[0]!==void 0?BRe(arguments[0]):void 0,o=L6(r),s=function(c){var u=this===void 0?Yy:this;u===Za&&CN(s,Xy,c),Ui(u,Qo)&&Ui(u[Qo],o)&&(u[Qo][o]=!1);var h=ON(1,c);try{NN(u,o,h)}catch(p){if(!(p instanceof QRe))throw p;B6(u,o,h)}};return um&&PN&&NN(Za,o,{configurable:!0,set:s}),DN(o,r)},D6(hw=ef[qy],"toString",function(){return j6(this).tag}),D6(ef,"withoutSetter",function(r){return DN(L6(r),r)}),N6.f=$6,P6.f=fw,GRe.f=kN,x6.f=W6,$Re.f=I6.f=G6,WRe.f=H6,zRe.f=function(r){return DN(KRe(r),r)},um&&HRe(hw,"description",{configurable:!0,get:function(){return j6(this).description}})),cw({global:!0,wrap:!0,forced:!dm,sham:!dm},{Symbol:ef}),uw(O6(tAe),function(r){YRe(r)}),cw({target:dw,stat:!0,forced:!dm},{useSetter:function(){PN=!0},useSimple:function(){PN=!1}}),cw({target:"Object",stat:!0,forced:!dm,sham:!um},{create:function(r,o){return o===void 0?hm(r):kN(hm(r),o)},defineProperty:fw,defineProperties:kN,getOwnPropertyDescriptor:W6}),cw({target:"Object",stat:!0,forced:!dm},{getOwnPropertyNames:G6}),qRe(),XRe(ef,dw),k6[Qo]=!0;var K6=Qu&&!!Symbol.for&&!!Symbol.keyFor,nAe=Kt,rAe=ni,iAe=bi,oAe=Xo,z6=Vp,sAe=K6,LN=z6("string-to-symbol-registry"),aAe=z6("symbol-to-string-registry");nAe({target:"Symbol",stat:!0,forced:!sAe},{for:function(r){var o=oAe(r);if(iAe(LN,o))return LN[o];var s=rAe("Symbol")(o);return LN[o]=s,aAe[s]=o,s}});var cAe=Kt,lAe=bi,uAe=$h,dAe=wn,hAe=K6,Y6=Vp("symbol-to-string-registry");cAe({target:"Symbol",stat:!0,forced:!hAe},{keyFor:function(r){if(!uAe(r))throw new TypeError(dAe(r)+" is not a symbol");if(lAe(Y6,r))return Y6[r]}});var q6=Ay,fAe=de,X6=H,pAe=Xo,J6=S([].push),mAe=Kt,Q6=ni,Z6=M,gAe=te,Jy=S,eG=l,tG=de,nG=$h,rG=rd,vAe=function(r){if(fAe(r))return r;if(q6(r)){for(var o=r.length,s=[],c=0;c<o;c++){var u=r[c];typeof u=="string"?J6(s,u):typeof u!="number"&&X6(u)!=="Number"&&X6(u)!=="String"||J6(s,pAe(u))}var h=s.length,p=!0;return function(g,y){if(p)return p=!1,y;if(q6(this))return y;for(var b=0;b<h;b++)if(s[b]===g)return y}}},yAe=Qu,_Ae=String,ld=Q6("JSON","stringify"),pw=Jy(/./.exec),iG=Jy("".charAt),EAe=Jy("".charCodeAt),bAe=Jy("".replace),SAe=Jy(1 .toString),wAe=/[\uD800-\uDFFF]/g,oG=/^[\uD800-\uDBFF]$/,sG=/^[\uDC00-\uDFFF]$/,aG=!yAe||eG(function(){var r=Q6("Symbol")("stringify detection");return ld([r])!=="[null]"||ld({a:r})!=="{}"||ld(Object(r))!=="{}"}),cG=eG(function(){return ld("\uDF06\uD834")!=='"\\udf06\\ud834"'||ld("\uDEAD")!=='"\\udead"'}),TAe=function(r,o){var s=rG(arguments),c=vAe(o);if(tG(c)||r!==void 0&&!nG(r))return s[1]=function(u,h){if(tG(c)&&(h=gAe(c,this,_Ae(u),h)),!nG(h))return h},Z6(ld,null,s)},CAe=function(r,o,s){var c=iG(s,o-1),u=iG(s,o+1);return pw(oG,r)&&!pw(sG,u)||pw(sG,r)&&!pw(oG,c)?"\\u"+SAe(EAe(r,0),16):r};ld&&mAe({target:"JSON",stat:!0,forced:aG||cG},{stringify:function(r,o,s){var c=rG(arguments),u=Z6(aG?TAe:ld,null,c);return cG&&typeof u=="string"?bAe(u,wAe,CAe):u}});var lG=Oy,RAe=Bc;Kt({target:"Object",stat:!0,forced:!Qu||l(function(){lG.f(1)})},{getOwnPropertySymbols:function(r){var o=lG.f;return o?o(RAe(r)):[]}}),Gr("asyncIterator"),Gr("hasInstance"),Gr("isConcatSpreadable"),Gr("iterator"),Gr("match"),Gr("matchAll"),Gr("replace"),Gr("search"),Gr("species"),Gr("split");var AAe=C6;Gr("toPrimitive"),AAe();var OAe=ni,IAe=Ul;Gr("toStringTag"),IAe(OAe("Symbol"),"Symbol"),Gr("unscopables"),Ul(I.JSON,"JSON",!0);var xAe=ar.Symbol,PAe=cr,NAe=ra.f,uG=PAe("metadata"),dG=Function.prototype;dG[uG]===void 0&&NAe(dG,uG,{value:null}),Gr("asyncDispose"),Gr("dispose"),Gr("metadata");var DAe=xAe,kAe=S,MN=ni("Symbol"),LAe=MN.keyFor,MAe=kAe(MN.prototype.valueOf),hG=MN.isRegisteredSymbol||function(r){try{return LAe(MAe(r))!==void 0}catch{return!1}};Kt({target:"Symbol",stat:!0},{isRegisteredSymbol:hG});for(var jAe=Vp,fG=ni,UAe=S,VAe=$h,FAe=cr,mw=fG("Symbol"),pG=mw.isWellKnownSymbol,mG=fG("Object","getOwnPropertyNames"),BAe=UAe(mw.prototype.valueOf),gG=jAe("wks"),jN=0,vG=mG(mw),$Ae=vG.length;jN<$Ae;jN++)try{var yG=vG[jN];VAe(mw[yG])&&FAe(yG)}catch{}var _G=function(r){if(pG&&pG(r))return!0;try{for(var o=BAe(r),s=0,c=mG(gG),u=c.length;s<u;s++)if(gG[c[s]]==o)return!0}catch{}return!1};Kt({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:_G}),Gr("customMatcher"),Gr("observable"),Kt({target:"Symbol",stat:!0},{isRegistered:hG}),Kt({target:"Symbol",stat:!0,forced:!0},{isWellKnown:_G}),Gr("matcher"),Gr("metadataKey"),Gr("patternMatch"),Gr("replaceAll");var fm=a(DAe),EG=a(lm.f("iterator"));function Qy(r){return Qy=typeof fm=="function"&&typeof EG=="symbol"?function(o){return typeof o}:function(o){return o&&typeof fm=="function"&&o.constructor===fm&&o!==fm.prototype?"symbol":typeof o},Qy(r)}var WAe=a(lm.f("toPrimitive"));function GAe(r){var o=function(s,c){if(Qy(s)!="object"||!s)return s;var u=s[WAe];if(u!==void 0){var h=u.call(s,c);if(Qy(h)!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(c==="string"?String:Number)(s)}(r,"string");return Qy(o)=="symbol"?o:o+""}function G(r,o,s){return(o=GAe(o))in r?f6(r,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[o]=s,r}var bG=a(Gwe),HAe={isBrowser:!0,classes:{URLSearchParams:bG!==void 0?bG:TN,FormData:typeof FormData<"u"?FormData:null,Blob:typeof Blob<"u"?Blob:null},protocols:["http","https","file","blob","url","data"]};const UN=typeof window<"u"&&typeof document<"u",VN=typeof navigator=="object"&&navigator||void 0,KAe=UN&&(!VN||["ReactNative","NativeScript","NS"].indexOf(VN.product)<0),zAe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",YAe=UN&&window.location.href||"http://localhost";function SG(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function wG(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?SG(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):SG(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}var uo=wG(wG({},Object.freeze({__proto__:null,hasBrowserEnv:UN,hasStandardBrowserEnv:KAe,hasStandardBrowserWebWorkerEnv:zAe,navigator:VN,origin:YAe})),HAe),qAe=Io,XAe=te,JAe=bi,QAe=T,ZAe=function(){var r=qAe(this),o="";return r.hasIndices&&(o+="d"),r.global&&(o+="g"),r.ignoreCase&&(o+="i"),r.multiline&&(o+="m"),r.dotAll&&(o+="s"),r.unicode&&(o+="u"),r.unicodeSets&&(o+="v"),r.sticky&&(o+="y"),o},TG=RegExp.prototype,CG=function(r){var o=r.flags;return o!==void 0||"flags"in TG||JAe(r,"flags")||!QAe(TG,r)?o:XAe(ZAe,r)},eOe=RP.charAt,RG=te,tOe=Io,nOe=de,rOe=H,iOe=/./.exec,oOe=TypeError,sOe=Kt,AG=te,OG=le,aOe=zx,gw=w0,IG=at,xG=I3,Zy=Xo,cOe=Io,lOe=Mn,uOe=H,dOe=P3,PG=CG,hOe=As,fOe=l,pOe=Zx,mOe=function(r,o,s){return o+(s?eOe(r,o).length:1)},gOe=function(r,o){var s=r.exec;if(nOe(s)){var c=RG(s,r,o);return c!==null&&tOe(c),c}if(rOe(r)==="RegExp")return RG(iOe,r,o);throw new oOe("RegExp#exec called on incompatible receiver")},NG=Hh,vOe=cr("matchAll"),DG="RegExp String",kG=DG+" Iterator",yOe=NG.set,_Oe=NG.getterFor(kG),EOe=TypeError,FN=OG("".indexOf),vw=OG("".matchAll),BN=!!vw&&!fOe(function(){vw("a",/./)}),bOe=aOe(function(r,o,s,c){yOe(this,{type:kG,regexp:r,string:o,global:s,unicode:c,done:!1})},DG,function(){var r=_Oe(this);if(r.done)return gw(void 0,!0);var o=r.regexp,s=r.string,c=gOe(o,s);return c===null?(r.done=!0,gw(void 0,!0)):r.global?(Zy(c[0])===""&&(o.lastIndex=mOe(s,xG(o.lastIndex),r.unicode)),gw(c,!1)):(r.done=!0,gw(c,!1))}),LG=function(r){var o,s,c,u=cOe(this),h=Zy(r),p=pOe(u,RegExp),g=Zy(PG(u));return o=new p(p===RegExp?u.source:u,g),s=!!~FN(g,"g"),c=!!~FN(g,"u"),o.lastIndex=xG(u.lastIndex),new bOe(o,h,s,c)};sOe({target:"String",proto:!0,forced:BN},{matchAll:function(r){var o,s,c,u,h=IG(this);if(lOe(r)){if(dOe(r)&&(o=Zy(IG(PG(r))),!~FN(o,"g")))throw new EOe("`.matchAll` does not allow non-global regexes");if(BN)return vw(h,r);if((c=hOe(r,vOe))===void 0&&uOe(r)==="RegExp"&&(c=LG),c)return AG(c,r,h)}else if(BN)return vw(h,r);return s=Zy(h),u=new RegExp(r,"g"),AG(LG,u,s)}});var SOe=ia("String","matchAll"),wOe=T,TOe=SOe,$N=String.prototype,COe=function(r){var o=r.matchAll;return typeof r=="string"||r===$N||wOe($N,r)&&o===$N.matchAll?TOe:o},ROe=a(COe);function MG(r){function o(s,c,u,h){let p=s[h++];if(p==="__proto__")return!0;const g=Number.isFinite(+p),y=h>=s.length;return p=!p&&Ne.isArray(u)?u.length:p,y?(Ne.hasOwnProp(u,p)?u[p]=[u[p],c]:u[p]=c,!g):(u[p]&&Ne.isObject(u[p])||(u[p]=[]),o(s,c,u[p],h)&&Ne.isArray(u[p])&&(u[p]=function(b){const w={},C=Object.keys(b);let A;const x=C.length;let B;for(A=0;A<x;A++)B=C[A],w[B]=b[B];return w}(u[p])),!g)}if(Ne.isFormData(r)&&Ne.isFunction(r.entries)){const s={};return Ne.forEachEntry(r,(c,u)=>{o(function(h){return ROe(Ne).call(Ne,/\w+|\[(\w*)]/g,h).map(p=>p[0]==="[]"?"":p[1]||p[0])}(c),u,s,0)}),s}return null}const WN={transitional:l6,adapter:["xhr","http","fetch"],transformRequest:[function(r,o){const s=o.getContentType()||"",c=s.indexOf("application/json")>-1,u=Ne.isObject(r);if(u&&Ne.isHTMLForm(r)&&(r=new FormData(r)),Ne.isFormData(r))return c?JSON.stringify(MG(r)):r;if(Ne.isArrayBuffer(r)||Ne.isBuffer(r)||Ne.isStream(r)||Ne.isFile(r)||Ne.isBlob(r)||Ne.isReadableStream(r))return r;if(Ne.isArrayBufferView(r))return r.buffer;if(Ne.isURLSearchParams(r))return o.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let h;if(u){if(s.indexOf("application/x-www-form-urlencoded")>-1)return function(p,g){return aw(p,new uo.classes.URLSearchParams,Object.assign({visitor:function(y,b,w,C){return uo.isNode&&Ne.isBuffer(y)?(this.append(b,y.toString("base64")),!1):C.defaultVisitor.apply(this,arguments)}},g))}(r,this.formSerializer).toString();if((h=Ne.isFileList(r))||s.indexOf("multipart/form-data")>-1){const p=this.env&&this.env.FormData;return aw(h?{"files[]":r}:r,p&&new p,this.formSerializer)}}return u||c?(o.setContentType("application/json",!1),function(p,g,y){if(Ne.isString(p))try{return(g||JSON.parse)(p),Oi(Ne).call(Ne,p)}catch(b){if(b.name!=="SyntaxError")throw b}return(y||JSON.stringify)(p)}(r)):r}],transformResponse:[function(r){const o=this.transitional||WN.transitional,s=o&&o.forcedJSONParsing,c=this.responseType==="json";if(Ne.isResponse(r)||Ne.isReadableStream(r))return r;if(r&&Ne.isString(r)&&(s&&!this.responseType||c)){const u=!(o&&o.silentJSONParsing)&&c;try{return JSON.parse(r)}catch(h){if(u)throw h.name==="SyntaxError"?Jt.from(h,Jt.ERR_BAD_RESPONSE,this,null,this.response):h}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:uo.classes.FormData,Blob:uo.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ne.forEach(["delete","get","head","post","put","patch"],r=>{WN.headers[r]={}});var GN=WN;const AOe=Ne.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),jG=Symbol("internals");function e_(r){var o;return r&&Oi(o=String(r)).call(o).toLowerCase()}function yw(r){return r===!1||r==null?r:Ne.isArray(r)?r.map(yw):String(r)}function HN(r,o,s,c,u){return Ne.isFunction(c)?c.call(this,o,s):(u&&(o=s),Ne.isString(o)?Ne.isString(c)?o.indexOf(c)!==-1:Ne.isRegExp(c)?c.test(o):void 0:void 0)}class _w{constructor(o){o&&this.set(o)}set(o,s,c){const u=this;function h(y,b,w){const C=e_(b);if(!C)throw new Error("header name must be a non-empty string");const A=Ne.findKey(u,C);(!A||u[A]===void 0||w===!0||w===void 0&&u[A]!==!1)&&(u[A||b]=yw(y))}const p=(y,b)=>Ne.forEach(y,(w,C)=>h(w,C,b));if(Ne.isPlainObject(o)||o instanceof this.constructor)p(o,s);else if(Ne.isString(o)&&(o=Oi(o).call(o))&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(Oi(g=o).call(g)))p((y=>{const b={};let w,C,A;return y&&y.split(`
`).forEach(function(x){var B,U;A=x.indexOf(":"),w=Oi(B=x.substring(0,A)).call(B).toLowerCase(),C=Oi(U=x.substring(A+1)).call(U),!w||b[w]&&AOe[w]||(w==="set-cookie"?b[w]?b[w].push(C):b[w]=[C]:b[w]=b[w]?b[w]+", "+C:C)}),b})(o),s);else if(Ne.isObject(o)&&Ne.isIterable(o)){let y,b,w={};for(const C of o){if(!Ne.isArray(C))throw TypeError("Object iterator must return a key-value pair");w[b=C[0]]=(y=w[b])?Ne.isArray(y)?[...y,C[1]]:[y,C[1]]:C[1]}p(w,s)}else o!=null&&h(s,o,c);var g;return this}get(o,s){if(o=e_(o)){const c=Ne.findKey(this,o);if(c){const u=this[c];if(!s)return u;if(s===!0)return function(h){const p=Object.create(null),g=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let y;for(;y=g.exec(h);)p[y[1]]=y[2];return p}(u);if(Ne.isFunction(s))return s.call(this,u,c);if(Ne.isRegExp(s))return s.exec(u);throw new TypeError("parser must be boolean|regexp|function")}}}has(o,s){if(o=e_(o)){const c=Ne.findKey(this,o);return!(!c||this[c]===void 0||s&&!HN(0,this[c],c,s))}return!1}delete(o,s){const c=this;let u=!1;function h(p){if(p=e_(p)){const g=Ne.findKey(c,p);!g||s&&!HN(0,c[g],g,s)||(delete c[g],u=!0)}}return Ne.isArray(o)?o.forEach(h):h(o),u}clear(o){const s=Object.keys(this);let c=s.length,u=!1;for(;c--;){const h=s[c];o&&!HN(0,this[h],h,o,!0)||(delete this[h],u=!0)}return u}normalize(o){const s=this,c={};return Ne.forEach(this,(u,h)=>{var p;const g=Ne.findKey(c,h);if(g)return s[g]=yw(u),void delete s[h];const y=o?function(b){return Oi(b).call(b).toLowerCase().replace(/([a-z\d])(\w*)/g,(w,C,A)=>C.toUpperCase()+A)}(h):Oi(p=String(h)).call(p);y!==h&&delete s[h],s[y]=yw(u),c[y]=!0}),this}concat(){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return this.constructor.concat(this,...s)}toJSON(o){const s=Object.create(null);return Ne.forEach(this,(c,u)=>{c!=null&&c!==!1&&(s[u]=o&&Ne.isArray(c)?c.join(", "):c)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(o=>{let[s,c]=o;return s+": "+c}).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(o){return o instanceof this?o:new this(o)}static concat(o){const s=new this(o);for(var c=arguments.length,u=new Array(c>1?c-1:0),h=1;h<c;h++)u[h-1]=arguments[h];return u.forEach(p=>s.set(p)),s}static accessor(o){const s=(this[jG]=this[jG]={accessors:{}}).accessors,c=this.prototype;function u(h){const p=e_(h);s[p]||(function(g,y){const b=Ne.toCamelCase(" "+y);["get","set","has"].forEach(w=>{Object.defineProperty(g,w+b,{value:function(C,A,x){return this[w].call(this,y,C,A,x)},configurable:!0})})}(c,h),s[p]=!0)}return Ne.isArray(o)?o.forEach(u):u(o),this}}_w.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Ne.reduceDescriptors(_w.prototype,(r,o)=>{let{value:s}=r,c=o[0].toUpperCase()+o.slice(1);return{get:()=>s,set(u){this[c]=u}}}),Ne.freezeMethods(_w);var ec=_w;function KN(r,o){const s=this||GN,c=o||s,u=ec.from(c.headers);let h=c.data;return Ne.forEach(r,function(p){h=p.call(s,h,u.normalize(),o?o.status:void 0)}),u.normalize(),h}function UG(r){return!(!r||!r.__CANCEL__)}function pm(r,o,s){Jt.call(this,r??"canceled",Jt.ERR_CANCELED,o,s),this.name="CanceledError"}function VG(r,o,s){const c=s.config.validateStatus;s.status&&c&&!c(s.status)?o(new Jt("Request failed with status code "+s.status,[Jt.ERR_BAD_REQUEST,Jt.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s)):r(s)}Ne.inherits(pm,Jt,{__CANCEL__:!0});const Ew=function(r,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,c=0;const u=function(h,p){h=h||10;const g=new Array(h),y=new Array(h);let b,w=0,C=0;return p=p!==void 0?p:1e3,function(A){const x=Date.now(),B=y[C];b||(b=x),g[w]=A,y[w]=x;let U=C,F=0;for(;U!==w;)F+=g[U++],U%=h;if(w=(w+1)%h,w===C&&(C=(C+1)%h),x-b<p)return;const K=B&&x-B;return K?Math.round(1e3*F/K):void 0}}(50,250);return function(h,p){let g,y,b=0,w=1e3/p;const C=function(A){b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Date.now(),g=null,y&&(clearTimeout(y),y=null),h.apply(null,A)};return[function(){const A=Date.now(),x=A-b;for(var B=arguments.length,U=new Array(B),F=0;F<B;F++)U[F]=arguments[F];x>=w?C(U,A):(g=U,y||(y=setTimeout(()=>{y=null,C(g)},w-x)))},()=>g&&C(g)]}(h=>{const p=h.loaded,g=h.lengthComputable?h.total:void 0,y=p-c,b=u(y);c=p,r({loaded:p,total:g,progress:g?p/g:void 0,bytes:y,rate:b||void 0,estimated:b&&g&&p<=g?(g-p)/b:void 0,event:h,lengthComputable:g!=null,[o?"download":"upload"]:!0})},s)},FG=(r,o)=>{const s=r!=null;return[c=>o[0]({lengthComputable:s,total:r,loaded:c}),o[1]]},BG=r=>function(){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return Ne.asap(()=>r(...s))};var OOe=uo.hasStandardBrowserEnv?((r,o)=>s=>(s=new Y0(s,uo.origin),r.protocol===s.protocol&&r.host===s.host&&(o||r.port===s.port)))(new Y0(uo.origin),uo.navigator&&/(msie|trident)/i.test(uo.navigator.userAgent)):()=>!0,IOe=uo.hasStandardBrowserEnv?{write(r,o,s,c,u,h){const p=[r+"="+encodeURIComponent(o)];Ne.isNumber(s)&&p.push("expires="+new Date(s).toGMTString()),Ne.isString(c)&&p.push("path="+c),Ne.isString(u)&&p.push("domain="+u),h===!0&&p.push("secure"),document.cookie=p.join("; ")},read(r){const o=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return o?decodeURIComponent(o[3]):null},remove(r){this.write(r,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function $G(r,o,s){let c=!function(u){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(u)}(o);return r&&(c||s==0)?function(u,h){return h?u.replace(/\/?\/$/,"")+"/"+h.replace(/^\/+/,""):u}(r,o):o}function WG(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}const GG=r=>r instanceof ec?function(o){for(var s=1;s<arguments.length;s++){var c=arguments[s]!=null?arguments[s]:{};s%2?WG(Object(c),!0).forEach(function(u){G(o,u,c[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(c)):WG(Object(c)).forEach(function(u){Object.defineProperty(o,u,Object.getOwnPropertyDescriptor(c,u))})}return o}({},r):r;function nf(r,o){o=o||{};const s={};function c(b,w,C,A){return Ne.isPlainObject(b)&&Ne.isPlainObject(w)?Ne.merge.call({caseless:A},b,w):Ne.isPlainObject(w)?Ne.merge({},w):Ne.isArray(w)?w.slice():w}function u(b,w,C,A){return Ne.isUndefined(w)?Ne.isUndefined(b)?void 0:c(void 0,b,0,A):c(b,w,0,A)}function h(b,w){if(!Ne.isUndefined(w))return c(void 0,w)}function p(b,w){return Ne.isUndefined(w)?Ne.isUndefined(b)?void 0:c(void 0,b):c(void 0,w)}function g(b,w,C){return C in o?c(b,w):C in r?c(void 0,b):void 0}const y={url:h,method:h,data:h,baseURL:p,transformRequest:p,transformResponse:p,paramsSerializer:p,timeout:p,timeoutMessage:p,withCredentials:p,withXSRFToken:p,adapter:p,responseType:p,xsrfCookieName:p,xsrfHeaderName:p,onUploadProgress:p,onDownloadProgress:p,decompress:p,maxContentLength:p,maxBodyLength:p,beforeRedirect:p,transport:p,httpAgent:p,httpsAgent:p,cancelToken:p,socketPath:p,responseEncoding:p,validateStatus:g,headers:(b,w,C)=>u(GG(b),GG(w),0,!0)};return Ne.forEach(Object.keys(Object.assign({},r,o)),function(b){const w=y[b]||u,C=w(r[b],o[b],b);Ne.isUndefined(C)&&w!==g||(s[b]=C)}),s}var HG=r=>{const o=nf({},r);let s,{data:c,withXSRFToken:u,xsrfHeaderName:h,xsrfCookieName:p,headers:g,auth:y}=o;if(o.headers=g=ec.from(g),o.url=a6($G(o.baseURL,o.url,o.allowAbsoluteUrls),r.params,r.paramsSerializer),y&&g.set("Authorization","Basic "+btoa((y.username||"")+":"+(y.password?unescape(encodeURIComponent(y.password)):""))),Ne.isFormData(c)){if(uo.hasStandardBrowserEnv||uo.hasStandardBrowserWebWorkerEnv)g.setContentType(void 0);else if((s=g.getContentType())!==!1){const[b,...w]=s?s.split(";").map(C=>Oi(C).call(C)).filter(Boolean):[];g.setContentType([b||"multipart/form-data",...w].join("; "))}}if(uo.hasStandardBrowserEnv&&(u&&Ne.isFunction(u)&&(u=u(o)),u||u!==!1&&OOe(o.url))){const b=h&&p&&IOe.read(p);b&&g.set(h,b)}return o},xOe=typeof XMLHttpRequest<"u"&&function(r){return new De(function(o,s){const c=HG(r);let u=c.data;const h=ec.from(c.headers).normalize();let p,g,y,b,w,{responseType:C,onUploadProgress:A,onDownloadProgress:x}=c;function B(){b&&b(),w&&w(),c.cancelToken&&c.cancelToken.unsubscribe(p),c.signal&&c.signal.removeEventListener("abort",p)}let U=new XMLHttpRequest;function F(){if(!U)return;const z=ec.from("getAllResponseHeaders"in U&&U.getAllResponseHeaders());VG(function(Q){o(Q),B()},function(Q){s(Q),B()},{data:C&&C!=="text"&&C!=="json"?U.response:U.responseText,status:U.status,statusText:U.statusText,headers:z,config:r,request:U}),U=null}U.open(c.method.toUpperCase(),c.url,!0),U.timeout=c.timeout,"onloadend"in U?U.onloadend=F:U.onreadystatechange=function(){U&&U.readyState===4&&(U.status!==0||U.responseURL&&U.responseURL.indexOf("file:")===0)&&setTimeout(F)},U.onabort=function(){U&&(s(new Jt("Request aborted",Jt.ECONNABORTED,r,U)),U=null)},U.onerror=function(){s(new Jt("Network Error",Jt.ERR_NETWORK,r,U)),U=null},U.ontimeout=function(){let z=c.timeout?"timeout of "+c.timeout+"ms exceeded":"timeout exceeded";const Q=c.transitional||l6;c.timeoutErrorMessage&&(z=c.timeoutErrorMessage),s(new Jt(z,Q.clarifyTimeoutError?Jt.ETIMEDOUT:Jt.ECONNABORTED,r,U)),U=null},u===void 0&&h.setContentType(null),"setRequestHeader"in U&&Ne.forEach(h.toJSON(),function(z,Q){U.setRequestHeader(Q,z)}),Ne.isUndefined(c.withCredentials)||(U.withCredentials=!!c.withCredentials),C&&C!=="json"&&(U.responseType=c.responseType),x&&([y,w]=Ew(x,!0),U.addEventListener("progress",y)),A&&U.upload&&([g,b]=Ew(A),U.upload.addEventListener("progress",g),U.upload.addEventListener("loadend",b)),(c.cancelToken||c.signal)&&(p=z=>{U&&(s(!z||z.type?new pm(null,r,U):z),U.abort(),U=null)},c.cancelToken&&c.cancelToken.subscribe(p),c.signal&&(c.signal.aborted?p():c.signal.addEventListener("abort",p)));const K=function(z){const Q=/^([-+\w]{1,25})(:?\/\/|:)/.exec(z);return Q&&Q[1]||""}(c.url);K&&uo.protocols.indexOf(K)===-1?s(new Jt("Unsupported protocol "+K+":",Jt.ERR_BAD_REQUEST,r)):U.send(u||null)})},POe=(r,o)=>{const{length:s}=r=r?r.filter(Boolean):[];if(o||s){let c,u=new AbortController;const h=function(b){if(!c){c=!0,g();const w=b instanceof Error?b:this.reason;u.abort(w instanceof Jt?w:new pm(w instanceof Error?w.message:w))}};let p=o&&setTimeout(()=>{p=null,h(new Jt("timeout ".concat(o," of ms exceeded"),Jt.ETIMEDOUT))},o);const g=()=>{r&&(p&&clearTimeout(p),p=null,r.forEach(b=>{b.unsubscribe?b.unsubscribe(h):b.removeEventListener("abort",h)}),r=null)};r.forEach(b=>b.addEventListener("abort",h));const{signal:y}=u;return y.unsubscribe=()=>Ne.asap(g),y}},zN=a(N5),KG=lm.f("asyncIterator"),NOe=a(KG);function YN(r,o){this.v=r,this.k=o}function Is(r){return function(){return new t_(r.apply(this,arguments))}}function t_(r){var o,s;function c(h,p){try{var g=r[h](p),y=g.value,b=y instanceof YN;zN.resolve(b?y.v:y).then(function(w){if(b){var C=h==="return"?"return":"next";if(!y.k||w.done)return c(C,w);w=r[C](w).value}u(g.done?"return":"normal",w)},function(w){c("throw",w)})}catch(w){u("throw",w)}}function u(h,p){switch(h){case"return":o.resolve({value:p,done:!0});break;case"throw":o.reject(p);break;default:o.resolve({value:p,done:!1})}(o=o.next)?c(o.key,o.arg):s=null}this._invoke=function(h,p){return new zN(function(g,y){var b={key:h,arg:p,resolve:g,reject:y,next:null};s?s=s.next=b:(o=s=b,c(h,p))})},typeof r.return!="function"&&(this.return=void 0)}function Ot(r){return new YN(r,0)}function bw(r){var o={},s=!1;function c(u,h){return s=!0,h=new zN(function(p){p(r[u](h))}),{done:!1,value:new YN(h,1)}}return o[fm!==void 0&&EG||"@@iterator"]=function(){return this},o.next=function(u){return s?(s=!1,u):c("next",u)},typeof r.throw=="function"&&(o.throw=function(u){if(s)throw s=!1,u;return c("throw",u)}),typeof r.return=="function"&&(o.return=function(u){return s?(s=!1,u):c("return",u)}),o}t_.prototype[typeof fm=="function"&&NOe||"@@asyncIterator"]=function(){return this},t_.prototype.next=function(r){return this._invoke("next",r)},t_.prototype.throw=function(r){return this._invoke("throw",r)},t_.prototype.return=function(r){return this._invoke("return",r)};var qN=a(KG);function XN(r){var o,s,c,u=2;for(typeof Symbol<"u"&&(s=qN,c=Symbol.iterator);u--;){if(s&&(o=r[s])!=null)return o.call(r);if(c&&(o=r[c])!=null)return new Sw(o.call(r));s="@@asyncIterator",c="@@iterator"}throw new TypeError("Object is not async iterable")}function Sw(r){function o(s){if(Object(s)!==s)return De.reject(new TypeError(s+" is not an object."));var c=s.done;return De.resolve(s.value).then(function(u){return{value:u,done:c}})}return Sw=function(s){this.s=s,this.n=s.next},Sw.prototype={s:null,n:null,next:function(){return o(this.n.apply(this.s,arguments))},return:function(s){var c=this.s.return;return c===void 0?De.resolve({value:s,done:!0}):o(c.apply(this.s,arguments))},throw:function(s){var c=this.s.return;return c===void 0?De.reject(s):o(c.apply(this.s,arguments))}},new Sw(r)}const DOe=function*(r,o){let s=r.byteLength;if(!o||s<o)return void(yield r);let c,u=0;for(;u<s;)c=u+o,yield r.slice(u,c),u=c},kOe=function(){var r=Is(function*(o,s){var c,u=!1,h=!1;try{for(var p,g=XN(LOe(o));u=!(p=yield Ot(g.next())).done;u=!1){const y=p.value;yield*bw(XN(DOe(y,s)))}}catch(y){h=!0,c=y}finally{try{u&&g.return!=null&&(yield Ot(g.return()))}finally{if(h)throw c}}});return function(o,s){return r.apply(this,arguments)}}(),LOe=function(){var r=Is(function*(o){if(o[qN])return void(yield*bw(XN(o)));const s=o.getReader();try{for(;;){const{done:c,value:u}=yield Ot(s.read());if(c)break;yield u}}finally{yield Ot(s.cancel())}});return function(o){return r.apply(this,arguments)}}(),zG=(r,o,s,c)=>{const u=kOe(r,o);let h,p=0,g=y=>{h||(h=!0,c&&c(y))};return new ReadableStream({async pull(y){try{const{done:b,value:w}=await u.next();if(b)return g(),void y.close();let C=w.byteLength;if(s){let A=p+=C;s(A)}y.enqueue(new Uint8Array(w))}catch(b){throw g(b),b}},cancel:y=>(g(y),u.return())},{highWaterMark:2})};function YG(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function qG(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?YG(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):YG(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}const ww=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",XG=ww&&typeof ReadableStream=="function",MOe=ww&&(typeof TextEncoder=="function"?(JG=new TextEncoder,r=>JG.encode(r)):async r=>new Uint8Array(await new Response(r).arrayBuffer()));var JG;const QG=function(r){try{for(var o=arguments.length,s=new Array(o>1?o-1:0),c=1;c<o;c++)s[c-1]=arguments[c];return!!r(...s)}catch{return!1}},jOe=XG&&QG(()=>{let r=!1;const o=new Request(uo.origin,{body:new ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type");return r&&!o}),JN=XG&&QG(()=>Ne.isReadableStream(new Response("").body)),Tw={stream:JN&&(r=>r.body)};var ZG;ww&&(ZG=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(r=>{!Tw[r]&&(Tw[r]=Ne.isFunction(ZG[r])?o=>o[r]():(o,s)=>{throw new Jt("Response type '".concat(r,"' is not supported"),Jt.ERR_NOT_SUPPORT,s)})}));const UOe=async(r,o)=>{const s=Ne.toFiniteNumber(r.getContentLength());return s??(async c=>c==null?0:Ne.isBlob(c)?c.size:Ne.isSpecCompliantForm(c)?(await new Request(uo.origin,{method:"POST",body:c}).arrayBuffer()).byteLength:Ne.isArrayBufferView(c)||Ne.isArrayBuffer(c)?c.byteLength:(Ne.isURLSearchParams(c)&&(c+=""),Ne.isString(c)?(await MOe(c)).byteLength:void 0))(o)};var VOe=ww&&(async r=>{let{url:o,method:s,data:c,signal:u,cancelToken:h,timeout:p,onDownloadProgress:g,onUploadProgress:y,responseType:b,headers:w,withCredentials:C="same-origin",fetchOptions:A}=HG(r);b=b?(b+"").toLowerCase():"text";let x,B=POe([u,h&&h.toAbortSignal()],p);const U=B&&B.unsubscribe&&(()=>{B.unsubscribe()});let F;try{if(y&&jOe&&s!=="get"&&s!=="head"&&(F=await UOe(w,c))!==0){let oe,re=new Request(o,{method:"POST",body:c,duplex:"half"});if(Ne.isFormData(c)&&(oe=re.headers.get("content-type"))&&w.setContentType(oe),re.body){const[me,Ee]=FG(F,Ew(BG(y)));c=zG(re.body,65536,me,Ee)}}Ne.isString(C)||(C=C?"include":"omit");const K="credentials"in Request.prototype;x=new Request(o,qG(qG({},A),{},{signal:B,method:s.toUpperCase(),headers:w.normalize().toJSON(),body:c,duplex:"half",credentials:K?C:void 0}));let z=await fetch(x);const Q=JN&&(b==="stream"||b==="response");if(JN&&(g||Q&&U)){const oe={};["status","statusText","headers"].forEach(xe=>{oe[xe]=z[xe]});const re=Ne.toFiniteNumber(z.headers.get("content-length")),[me,Ee]=g&&FG(re,Ew(BG(g),!0))||[];z=new Response(zG(z.body,65536,me,()=>{Ee&&Ee(),U&&U()}),oe)}b=b||"text";let ie=await Tw[Ne.findKey(Tw,b)||"text"](z,r);return!Q&&U&&U(),await new De((oe,re)=>{VG(oe,re,{data:ie,headers:ec.from(z.headers),status:z.status,statusText:z.statusText,config:r,request:x})})}catch(K){throw U&&U(),K&&K.name==="TypeError"&&/Load failed|fetch/i.test(K.message)?Object.assign(new Jt("Network Error",Jt.ERR_NETWORK,r,x),{cause:K.cause||K}):Jt.from(K,K&&K.code,r,x)}});const QN={http:null,xhr:xOe,fetch:VOe};Ne.forEach(QN,(r,o)=>{if(r){try{Object.defineProperty(r,"name",{value:o})}catch{}Object.defineProperty(r,"adapterName",{value:o})}});const e8=r=>"- ".concat(r),FOe=r=>Ne.isFunction(r)||r===null||r===!1;var t8={getAdapter:r=>{r=Ne.isArray(r)?r:[r];const{length:o}=r;let s,c;const u={};for(let h=0;h<o;h++){let p;if(s=r[h],c=s,!FOe(s)&&(c=QN[(p=String(s)).toLowerCase()],c===void 0))throw new Jt("Unknown adapter '".concat(p,"'"));if(c)break;u[p||"#"+h]=c}if(!c){const h=Object.entries(u).map(p=>{let[g,y]=p;return"adapter ".concat(g," ")+(y===!1?"is not supported by the environment":"is not available in the build")});throw new Jt("There is no suitable adapter to dispatch the request "+(o?h.length>1?`since :
`+h.map(e8).join(`
`):" "+e8(h[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return c},adapters:QN};function ZN(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new pm(null,r)}function n8(r){return ZN(r),r.headers=ec.from(r.headers),r.data=KN.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),t8.getAdapter(r.adapter||GN.adapter)(r).then(function(o){return ZN(r),o.data=KN.call(r,r.transformResponse,o),o.headers=ec.from(o.headers),o},function(o){return UG(o)||(ZN(r),o&&o.response&&(o.response.data=KN.call(r,r.transformResponse,o.response),o.response.headers=ec.from(o.response.headers))),De.reject(o)})}const r8="1.9.0",Cw={};["object","boolean","number","function","string","symbol"].forEach((r,o)=>{Cw[r]=function(s){return typeof s===r||"a"+(o<1?"n ":" ")+r}});const i8={};Cw.transitional=function(r,o,s){function c(u,h){return"[Axios v"+r8+"] Transitional option '"+u+"'"+h+(s?". "+s:"")}return(u,h,p)=>{if(r===!1)throw new Jt(c(h," has been removed"+(o?" in "+o:"")),Jt.ERR_DEPRECATED);return o&&!i8[h]&&(i8[h]=!0,console.warn(c(h," has been deprecated since v"+o+" and will be removed in the near future"))),!r||r(u,h,p)}},Cw.spelling=function(r){return(o,s)=>(console.warn("".concat(s," is likely a misspelling of ").concat(r)),!0)};var Rw={assertOptions:function(r,o,s){if(typeof r!="object")throw new Jt("options must be an object",Jt.ERR_BAD_OPTION_VALUE);const c=Object.keys(r);let u=c.length;for(;u-- >0;){const h=c[u],p=o[h];if(p){const g=r[h],y=g===void 0||p(g,h,r);if(y!==!0)throw new Jt("option "+h+" must be "+y,Jt.ERR_BAD_OPTION_VALUE)}else if(s!==!0)throw new Jt("Unknown option "+h,Jt.ERR_BAD_OPTION)}},validators:Cw};const Hc=Rw.validators;let Aw=class{constructor(r){this.defaults=r||{},this.interceptors={request:new c6,response:new c6}}async request(r,o){try{return await this._request(r,o)}catch(s){if(s instanceof Error){let c={};Error.captureStackTrace?Error.captureStackTrace(c):c=new Error;const u=c.stack?c.stack.replace(/^.+\n/,""):"";try{s.stack?u&&!String(s.stack).endsWith(u.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+u):s.stack=u}catch{}}throw s}}_request(r,o){typeof r=="string"?(o=o||{}).url=r:o=r||{},o=nf(this.defaults,o);const{transitional:s,paramsSerializer:c,headers:u}=o;s!==void 0&&Rw.assertOptions(s,{silentJSONParsing:Hc.transitional(Hc.boolean),forcedJSONParsing:Hc.transitional(Hc.boolean),clarifyTimeoutError:Hc.transitional(Hc.boolean)},!1),c!=null&&(Ne.isFunction(c)?o.paramsSerializer={serialize:c}:Rw.assertOptions(c,{encode:Hc.function,serialize:Hc.function},!0)),o.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?o.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:o.allowAbsoluteUrls=!0),Rw.assertOptions(o,{baseUrl:Hc.spelling("baseURL"),withXsrfToken:Hc.spelling("withXSRFToken")},!0),o.method=(o.method||this.defaults.method||"get").toLowerCase();let h=u&&Ne.merge(u.common,u[o.method]);u&&Ne.forEach(["delete","get","head","post","put","patch","common"],x=>{delete u[x]}),o.headers=ec.concat(h,u);const p=[];let g=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(o)===!1||(g=g&&x.synchronous,p.unshift(x.fulfilled,x.rejected))});const y=[];let b;this.interceptors.response.forEach(function(x){y.push(x.fulfilled,x.rejected)});let w,C=0;if(!g){const x=[n8.bind(this),void 0];for(x.unshift.apply(x,p),x.push.apply(x,y),w=x.length,b=De.resolve(o);C<w;)b=b.then(x[C++],x[C++]);return b}w=p.length;let A=o;for(C=0;C<w;){const x=p[C++],B=p[C++];try{A=x(A)}catch(U){B.call(this,U);break}}try{b=n8.call(this,A)}catch(x){return De.reject(x)}for(C=0,w=y.length;C<w;)b=b.then(y[C++],y[C++]);return b}getUri(r){return a6($G((r=nf(this.defaults,r)).baseURL,r.url,r.allowAbsoluteUrls),r.params,r.paramsSerializer)}};Ne.forEach(["delete","get","head","options"],function(r){Aw.prototype[r]=function(o,s){return this.request(nf(s||{},{method:r,url:o,data:(s||{}).data}))}}),Ne.forEach(["post","put","patch"],function(r){function o(s){return function(c,u,h){return this.request(nf(h||{},{method:r,headers:s?{"Content-Type":"multipart/form-data"}:{},url:c,data:u}))}}Aw.prototype[r]=o(),Aw.prototype[r+"Form"]=o(!0)});var Ow=Aw;class e1{constructor(o){if(typeof o!="function")throw new TypeError("executor must be a function.");let s;this.promise=new De(function(u){s=u});const c=this;this.promise.then(u=>{if(!c._listeners)return;let h=c._listeners.length;for(;h-- >0;)c._listeners[h](u);c._listeners=null}),this.promise.then=u=>{let h;const p=new De(g=>{c.subscribe(g),h=g}).then(u);return p.cancel=function(){c.unsubscribe(h)},p},o(function(u,h,p){c.reason||(c.reason=new pm(u,h,p),s(c.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(o){this.reason?o(this.reason):this._listeners?this._listeners.push(o):this._listeners=[o]}unsubscribe(o){if(!this._listeners)return;const s=this._listeners.indexOf(o);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const o=new AbortController,s=c=>{o.abort(c)};return this.subscribe(s),o.signal.unsubscribe=()=>this.unsubscribe(s),o.signal}static source(){let o;return{token:new e1(function(c){o=c}),cancel:o}}}var BOe=e1;const t1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(t1).forEach(r=>{let[o,s]=r;t1[s]=o});var $Oe=t1;const Si=function r(o){const s=new Ow(o),c=GW(Ow.prototype.request,s);return Ne.extend(c,Ow.prototype,s,{allOwnKeys:!0}),Ne.extend(c,s,null,{allOwnKeys:!0}),c.create=function(u){return r(nf(o,u))},c}(GN);Si.Axios=Ow,Si.CanceledError=pm,Si.CancelToken=BOe,Si.isCancel=UG,Si.VERSION=r8,Si.toFormData=aw,Si.AxiosError=Jt,Si.Cancel=Si.CanceledError,Si.all=function(r){return De.all(r)},Si.spread=function(r){return function(o){return r.apply(null,o)}},Si.isAxiosError=function(r){return Ne.isObject(r)&&r.isAxiosError===!0},Si.mergeConfig=nf,Si.AxiosHeaders=ec,Si.formToJSON=r=>MG(Ne.isHTMLForm(r)?new FormData(r):r),Si.getAdapter=t8.getAdapter,Si.HttpStatusCode=$Oe,Si.default=Si;var Qi=Si;const WOe=()=>{};function n_(){const r={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:WOe};return r.promise=new De((o,s)=>{r.resolve=c=>{r.isFinished||(r.isResolved=!0,r.isFinished=!0,o(c),r.value=c)},r.reject=c=>{r.isFinished||(r.isRejected=!0,r.isFinished=!0,s(c))}}),r}const Iw=new Map,xw=new Map,Kc=new Map;let Rr=function(r){return r.WIN_10="Windows 10",r.WIN_81="Windows 8.1",r.WIN_8="Windows 8",r.WIN_7="Windows 7",r.WIN_VISTA="Windows Vista",r.WIN_SERVER_2003="Windows Server 2003",r.WIN_XP="Windows XP",r.WIN_2000="Windows 2000",r.ANDROID="Android",r.HARMONY_OS="HarmonyOS",r.OPEN_BSD="Open BSD",r.SUN_OS="Sun OS",r.LINUX="Linux",r.IOS="iOS",r.MAC_OS="Mac OS",r.CHROMIUM_OS="Chromium OS",r.QNX="QNX",r.UNIX="UNIX",r.BEOS="BeOS",r.OS_2="OS/2",r.SEARCH_BOT="Search Bot",r}({}),Mt=function(r){return r.CHROME="Chrome",r.SAFARI="Safari",r.EDGE="Edge",r.FIREFOX="Firefox",r.OPERA="OPR",r.QQ="QQBrowser",r.WECHAT="MicroMessenger",r}({});const o8=new _Ce;let tc=o8.getResult(),n1=null;function It(r){if(!n1){tc=o8.getResult();const o=function(g){if(g.engine.name==="Blink"&&g.browser.name!=="WeChat")return Mt.CHROME;switch(g.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return Mt.CHROME;case"Safari":case"Mobile Safari":return Mt.SAFARI;case"Edge":return Mt.EDGE;case"Firefox":return Mt.FIREFOX;case"QQ":case"QQBrowser":return Mt.QQ;case"Opera":return Mt.OPERA;case"WeChat":return Mt.WECHAT;default:return g.browser.name||""}}(tc),s=s8(tc),c=function(g){return g.os.name==="Windows"?g.os.version?g.os.name+" "+g.os.version:g.os.name:g.os.name||""}(tc),u=tc.os.version,h=s8(tc,!1),p=tc.device.type;if(!(o&&s&&c&&u))return{name:o,version:s,os:c,osVersion:u,browserVersion:h,deviceType:p};n1={name:o,version:s,os:c,osVersion:u,browserVersion:h,deviceType:p}}return n1}function s8(r){let o,s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return o=r.engine.name==="Blink"?r.engine.version||"":r.browser.version||"",s?o.split(".")[0]:o}function Pw(){return It().os}function a8(){const r=It();return"".concat(r.os," ").concat(r.osVersion)}function Nw(){const r=It();return!!(tc.engine.name==="WebKit"&&r.os===Rr.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&r.name!==Mt.SAFARI||Vi()&&r.name!==Mt.SAFARI)}function $l(){return It().name===Mt.CHROME}function ri(){return It().name===Mt.SAFARI}function c8(){return It().name===Mt.EDGE}function xn(){return It().name===Mt.FIREFOX}function Vi(){return It().os===Rr.IOS}function r_(r){const o=It();return!(o.name!==Mt.CHROME||!o.osVersion)&&Number(o.version)>=r}function l8(r){const o=It();return!(o.name!==Mt.CHROME||!o.osVersion)&&Number(o.version)<r}function r1(r,o,s){const c=It();return!(c.name!==r||!c.osVersion)&&(s?Number(c.version)>=o&&Number(c.version)<=s:Number(c.version)===o)}function i1(r){const o=It();return!(o.name!==Mt.EDGE||!o.osVersion)&&Number(o.version)>=r}function u8(r){const o=It();return!(o.name!==Mt.SAFARI||!o.osVersion)&&Number(o.version)>=r}function d8(r,o,s){const c=It();if(c.os!==Rr.IOS||!c.osVersion)return!1;const u=c.osVersion.split(".");return o&&Number(u[0])===r&&Number(u[1])<o||Number(u[0])<r}function h8(r,o,s){const c=It();if(c.name!==Mt.SAFARI||!c.osVersion||!c.browserVersion)return!1;const u=c.browserVersion.split(".");return s?o&&Number(u[0])===r&&Number(u[1])<o||Number(u[0])<r:o?Number(u[0])===r&&Number(u[1])<=o||Number(u[0])<r:Number(u[0])<=r}function o1(r){const o=It();return!(o.name!==Mt.OPERA||!o.osVersion)&&Number(o.version)>=r}function f8(){const r=It();if(r.os!==Rr.IOS||!r.osVersion)return!1;const o=r.osVersion.split(".");return Number(o[0])<14||Number(o[0])===14&&Number(o[1])<=6}function mm(){const r=It();if(r.os!==Rr.IOS||!r.osVersion)return!1;const o=r.osVersion.split(".");return Number(o[0])===15}function s1(){const r=It();if(r.os!==Rr.IOS||!r.osVersion)return!1;const o=r.osVersion.split(".");return Number(o[0])===16}function p8(){const r=It();if(r.os!==Rr.IOS||!r.osVersion)return!1;const o=r.osVersion.split(".");return Number(o[0])===15&&Number(o[1])>=1}function ha(){return ri()&&navigator.maxTouchPoints>0}function m8(){return It().name===Mt.WECHAT}function g8(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function a1(){const r=Pw();return function(){const{deviceType:o}=It();return o==="mobile"||o==="tablet"}()||r===Rr.ANDROID||r===Rr.IOS||r===Rr.HARMONY_OS}function Wl(){const r=It();return r.name!==Mt.EDGE&&r.name!==Mt.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function Dw(){return Pw()===Rr.ANDROID}function i_(){const r=It();return Dw()&&(r.name===Mt.CHROME||r.name===Mt.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}function ot(r,o,s){return(o=function(c){var u=function(h,p){if(typeof h!="object"||!h)return h;var g=h[Symbol.toPrimitive];if(g!==void 0){var y=g.call(h,"string");if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(h)}(c);return typeof u=="symbol"?u:u+""}(o))in r?Object.defineProperty(r,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[o]=s,r}function v8(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function Ue(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?v8(Object(s),!0).forEach(function(c){ot(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):v8(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}let Y=function(r){return r.UNEXPECTED_ERROR="UNEXPECTED_ERROR",r.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",r.TIMEOUT="TIMEOUT",r.INVALID_PARAMS="INVALID_PARAMS",r.NOT_READABLE="NOT_READABLE",r.NOT_SUPPORTED="NOT_SUPPORTED",r.INVALID_OPERATION="INVALID_OPERATION",r.OPERATION_ABORTED="OPERATION_ABORTED",r.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",r.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",r.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",r.DATACHANNEL_FAILED="DATACHANNEL_FAILED",r.NETWORK_ERROR="NETWORK_ERROR",r.NETWORK_TIMEOUT="NETWORK_TIMEOUT",r.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",r.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",r.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",r.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",r.ELECTRON_IS_NULL="ELECTRON_IS_NULL",r.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",r.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",r.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",r.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",r.PERMISSION_DENIED="PERMISSION_DENIED",r.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",r.TRACK_IS_DISABLED="TRACK_IS_DISABLED",r.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",r.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",r.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",r.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",r.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",r.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",r.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",r.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",r.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",r.UID_CONFLICT="UID_CONFLICT",r.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",r.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",r.TOKEN_EXPIRE="TOKEN_EXPIRE",r.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",r.INVALID_TRACK="INVALID_TRACK",r.SENDER_NOT_FOUND="SENDER_NOT_FOUND",r.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",r.SET_ANSWER_FAILED="SET_ANSWER_FAILED",r.ICE_FAILED="ICE_FAILED",r.PC_CLOSED="PC_CLOSED",r.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",r.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",r.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",r.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",r.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",r.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",r.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",r.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",r.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",r.INVALID_REMOTE_USER="INVALID_REMOTE_USER",r.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",r.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",r.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",r.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",r.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",r.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",r.WS_ABORT="WS_ABORT",r.WS_DISCONNECT="WS_DISCONNECT",r.WS_ERR="WS_ERR",r.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",r.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",r.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",r.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",r.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",r.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",r.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",r.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",r.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",r.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",r.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",r.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",r.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",r.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",r.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",r.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",r.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",r.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",r.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",r.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",r.INVALID_PLUGIN="INVALID_PLUGIN",r.DISCONNECT_P2P="DISCONNECT_P2P",r.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",r.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",r.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",r.CREATE_DATACHANNEL_ERROR="CREATE_DATACHANNEL_ERROR",r.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",r.PROHIBITED_OPERATION="PROHIBITED_OPERATION",r.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",r.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED",r}({}),ve=class extends Error{constructor(r){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",s=arguments.length>2?arguments[2]:void 0;super(o),ot(this,"code",void 0),ot(this,"message",void 0),ot(this,"data",void 0),ot(this,"name","AgoraRTCException"),this.code=r,this.message="AgoraRTCError ".concat(this.code,": ").concat(o),this.data=s}toString(){return this.data?"".concat(this.message,`
data: `).concat(JSON.stringify(this.data)):this.message}print(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error",o=arguments.length>1?arguments[1]:void 0;return r==="error"&&(o||console).error(this.toString()),r==="warning"&&(o||console).warn(this.toString()),this}throw(r){throw this.print("error",r),this}};function Gl(r,o){if(typeof r!="boolean")throw new ve(Y.INVALID_PARAMS,"Invalid ".concat(o,": The value is of the boolean type."))}function yr(r,o,s){if(!Pe(s).call(s,r))throw new ve(Y.INVALID_PARAMS,"".concat(o," can only be set as ").concat(JSON.stringify(s)))}function Qt(r,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4;if(r<s||r>c||(!(arguments.length>4&&arguments[4]!==void 0)||arguments[4])&&!function(u){return typeof u=="number"&&u%1==0}(r))throw new ve(Y.INVALID_PARAMS,"invalid ".concat(o,": the value range is [").concat(s,", ").concat(c,"]. integer only"))}function c1(r,o){if(typeof r!="number"){if(!(r.min||r.max||r.ideal||r.exact))throw new ve(Y.INVALID_PARAMS,"".concat(o," is not a valid ConstrainLong"));r.min!==void 0&&Qt(r.min,"".concat(o,".min"),0,1/0),r.max!==void 0&&Qt(r.max,"".concat(o,".max"),1,1/0),r.exact!==void 0&&Qt(r.exact,"".concat(o,".exact"),1,1/0),r.ideal!==void 0&&Qt(r.ideal,"".concat(o,".ideal"),1,1/0)}else Qt(r,o,1,1/0)}function Hr(r,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,u=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(r==null)throw new ve(Y.INVALID_PARAMS,"".concat(o||"param"," cannot be empty"));if(!y8(r,s,c,u))throw new ve(Y.INVALID_PARAMS,"Invalid ".concat(o||"string param",": Length of the string: [").concat(s,",").concat(c,"].").concat(u?" ASCII characters only.":""))}function Hl(r,o){if(!Array.isArray(r))throw new ve(Y.INVALID_PARAMS,"".concat(o," should be an array"))}function Pn(r){return r==null}function y8(r){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,c=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof r=="string"&&r.length<=s&&r.length>=o&&(!c||function(u){if(typeof u!="string")return!1;for(let h=0;h<u.length;h+=1){const p=u.charCodeAt(h);if(p<0||p>255)return!1}return!0}(r))}var o_=function(r){return r.COVERED="COVERED",r.POSITION="POSITION",r.SIZE="SIZE",r.STYLE="STYLE",r}(o_||{}),l1=function(r){return r.UNMOUNTED="UNMOUNTED",r.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT",r}(l1||{});const _8=new class{constructor(){ot(this,"_clientSize",null),ot(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),ot(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),ot(this,"getStyle",r=>window.getComputedStyle(r,null)),ot(this,"checkCssVisibleProperty",r=>{var o;let s=!0;const c=this.getStyle(r),{display:u,visibility:h,opacity:p,filter:g}=c;return(u==="none"||Pe(o=["hidden","collapse"]).call(o,h)||Number(p)<.1)&&(s=!1),!!s&&(g&&g.split(" ").filter(y=>{var b;const w=y.split("(")[0];return Pe(b=["brightness","blur","opacity"]).call(b,w)}).map(y=>{const[b,w]=y.split(/\(|\)/);return[b,Number(w.match(/^[0-9\.]+/))]}).forEach(y=>{const[b,w]=y;switch(b){case"brightness":(w<.1||w>3)&&(s=!1);break;case"blur":w>3&&(s=!1);break;case"opacity":w<.1&&(s=!1)}}),s)}),ot(this,"checkPropertyUpToAllParentNodes",(r,o)=>{let s=!0,c=!0;const u=p=>o(p);let h=r;for(;h&&c;)u(h)||(s=!1,c=!1),h=h.parentElement,h||(c=!1);return s}),ot(this,"checkActualCssVisibleIncludeInherit",r=>this.checkPropertyUpToAllParentNodes(r,this.checkCssVisibleProperty)),ot(this,"getSizeAboutClient",r=>{const{width:o,height:s,left:c,right:u,top:h,bottom:p}=r.getBoundingClientRect(),g=this.getClientWidth(),y=this.getClientHeight();return{width:o,height:s,left:c,right:u,top:h,bottom:p,clientWidth:g,clientHeight:y,clientMin:Math.min(g,y)}}),ot(this,"checkActualSize",()=>{const{width:r,height:o,clientMin:s}=this._clientSize;return this.checkSizeIsVisible(r,o,s)}),ot(this,"elementFromPoint",(r,o)=>document.elementFromPoint?document.elementFromPoint(r,o):null),ot(this,"checkCoverForAPoint",(r,o,s)=>{const c=this.elementFromPoint(r,o);return c!==null&&c!==s}),ot(this,"getPointPositionList",()=>{const{width:r,height:o,left:s,top:c}=this._clientSize,u=r/6,h=o/6,p=[],g=10**6;for(let y=0;y<5;y++)for(let b=0;b<5;b++){const w=(s*g+(y===0?.1:y===4?(u*y*g-1e5)/g:u*y)*g)/g,C=(c*g+(b===0?.1:b===4?(h*b*g-1e5)/g:h*b)*g)/g;p.push({x:w,y:C})}return[...p]}),ot(this,"checkElementCover",r=>this.getPointPositionList().map(o=>this.checkCoverForAPoint(o.x,o.y,r)).filter(o=>!!o).length>6),ot(this,"checkSizeIsVisible",(r,o,s)=>(r>50||s/r<=10)&&(o>50||s/o<=10)),ot(this,"checkSizeOfPartInClient",()=>{const{left:r,right:o,top:s,bottom:c,clientHeight:u,clientWidth:h,clientMin:p}=this._clientSize;let g,y,b,w;if(r<0)g=0;else{if(!(r<h))return!1;g=r}if(o<0)return!1;if(y=o<h?o:h,s<0)b=0;else{if(!(s<u))return!1;b=s}if(c<0)return!1;w=c<u?c:u;const C=y-g,A=w-b;return this.checkSizeIsVisible(C,A,p)}),ot(this,"returnHiddenResult",r=>(this._clientSize=null,{visible:!1,reason:r})),ot(this,"checkOneElementVisible",r=>{if(r instanceof HTMLElement){if(this.checkElementIsMountedOnDom(r)){if(this.checkActualCssVisibleIncludeInherit(r)){if(this._clientSize=this.getSizeAboutClient(r),this.checkElementCover(r))return this.returnHiddenResult(o_.COVERED);{const o=this.checkActualSize(),s=this.checkSizeOfPartInClient();return o&&!s?this.returnHiddenResult(o_.POSITION):o?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(o_.SIZE)}}return this.returnHiddenResult(o_.STYLE)}return this.returnHiddenResult(l1.UNMOUNTED)}return this.returnHiddenResult(l1.INVALID_HTML_ELEMENT)}),ot(this,"checkElementIsMountedOnDom",r=>this.checkPropertyUpToAllParentNodes(r,o=>o.nodeName.toUpperCase()!=="HTML"?o.parentElement!==null:!!document.documentElement))}};function u1(r){return new TextEncoder().encode(r)}const E8=function(r,o){const s=new Uint8Array(r.byteLength+o.byteLength);return s.set(new Uint8Array(r),0),s.set(new Uint8Array(o),r.byteLength),s},d1=async r=>function(o,s){let c="";return new Uint8Array(o).forEach(u=>{c+=u.toString(s).padStart(2,"0")}),c}(await crypto.subtle.digest("SHA-256",u1(r)),16);let An=class{constructor(){ot(this,"_events",{}),ot(this,"addListener",this.on)}getListeners(r){return this._events[r]?this._events[r].map(o=>o.listener):[]}on(r,o){this._events[r]||(this._events[r]=[]);const s=this._events[r];this._indexOfListener(s,o)===-1&&s.push({listener:o,once:!1})}once(r,o){this._events[r]||(this._events[r]=[]);const s=this._events[r];this._indexOfListener(s,o)===-1&&s.push({listener:o,once:!0})}off(r,o){if(!this._events[r])return;const s=this._events[r],c=this._indexOfListener(s,o);c!==-1&&s.splice(c,1),this._events[r].length===0&&delete this._events[r]}removeAllListeners(r){r?delete this._events[r]:this._events={}}emit(r){this._events[r]||(this._events[r]=[]);const o=this._events[r].map(h=>h);for(var s=arguments.length,c=new Array(s>1?s-1:0),u=1;u<s;u++)c[u-1]=arguments[u];for(let h=0;h<o.length;h+=1){const p=o[h];p.once&&this.off(r,p.listener),p.listener.apply(this,c||[])}}safeEmit(r){for(var o=arguments.length,s=new Array(o>1?o-1:0),c=1;c<o;c++)s[c-1]=arguments[c];[...this._events[r]||[]].forEach(u=>{u.once&&this.off(r,u.listener);try{u.listener.apply(this,s)}catch(h){console.error("safeEmit event:".concat(r," error ").concat(h==null?void 0:h.toString()))}})}_indexOfListener(r,o){let s=r.length;for(;s--;)if(r[s].listener===o)return s;return-1}},s_=null;function b8(){if(s_)return s_;if(window.electron)return s_=window.electron;if(!window.require)return null;try{return s_=window.require("electron"),s_}catch{return null}}let Yn=function(r){return r.CREATE_CLIENT="createClient",r.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",r.SET_AREA="setArea",r.PRELOAD="PRELOAD",r.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",r.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",r.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",r.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",r.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",r.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",r.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",r.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",r.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",r.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",r.START_PROXY_SERVER="Client.startProxyServer",r.STOP_PROXY_SERVER="Client.stopProxyServer",r.SET_PROXY_SERVER="Client.setProxyServer",r.SET_TURN_SERVER="Client.setTurnServer",r.SET_CLIENT_ROLE="Client.setClientRole",r.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",r.ENABLE_DUAL_STREAM="Client.enableDualStream",r.DISABLE_DUAL_STREAM="Client.disableDualStream",r.JOIN="Client.join",r.LEAVE="Client.leave",r.PUBLISH="Client.publish",r.UNPUBLISH="Client.unpublish",r.SUBSCRIBE="Client.subscribe",r.MASS_SUBSCRIBE="Client.massSubscribe",r.MASS_UNSUBSCRIBE="Client.massUnsubscribe",r.UNSUBSCRIBE="Client.unsubscribe",r.RENEW_TOKEN="Client.renewToken",r.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",r.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",r.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",r.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",r.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",r.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",r.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",r.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",r.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",r.START_LIVE_STREAMING="Client.startLiveStreaming",r.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",r.STOP_LIVE_STREAMING="Client.stopLiveStreaming",r.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",r.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",r.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",r.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",r.SET_CONFIG_DISTRIBUTE="_configDistribute",r.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",r.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",r.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",r.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",r.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",r.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",r.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",r.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",r.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",r.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",r.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",r.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",r.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",r.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",r.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",r.LOCAL_VIDEO_SEND_SEI_DATA="LocalVideoTrack.sendSeiData",r.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",r.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",r.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",r.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",r.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",r.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",r.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",r.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",r.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",r.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",r.STREAM_TYPE_CHANGE="streamTypeChange",r.CONNECTION_STATE_CHANGE="connectionStateChange",r.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",r.IMAGE_MODERATION_UPLOAD="imageModerationUpload",r.REPUB_AFTER_PC_CONNECTED="repubAfterPCConnected",r}({}),Nn=function(r){return r.TRACER="tracer",r}({});function S8(r){return Qt(r.timeout,"config.timeout",0,1e5),Qt(r.timeoutFactor,"config.timeoutFactor",0,100,!1),Qt(r.maxRetryCount,"config.maxRetryConfig",0,1/0),Qt(r.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}let GOe=function(r){return r[r.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",r[r.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",r[r.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY",r}({}),Bt=function(r){return r.LEAVE="LEAVE",r.NETWORK_ERROR="NETWORK_ERROR",r.SERVER_ERROR="SERVER_ERROR",r.UID_BANNED="UID_BANNED",r.FALLBACK="FALLBACK",r.IP_BANNED="IP_BANNED",r.CHANNEL_BANNED="CHANNEL_BANNED",r.LICENSE_MISSING="LICENSE_MISSING",r.LICENSE_EXPIRED="LICENSE_EXPIRED",r.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",r.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",r.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",r.LICENSE_ILLEGAL="LICENSE_ILLEGAL",r.TOKEN_EXPIRE="TOKEN_EXPIRE",r}({});function a_(r){if(!Array.isArray(r)||r.length<1)return!1;try{r.forEach(o=>{if(!o.urls)throw Error()})}catch{return!1}return!0}function w8(r){return Hr(r.turnServerURL,"turnServerURL"),Hr(r.username,"username"),Hr(r.password,"password"),r.udpport&&Qt(r.udpport,"udpport",1,99999,!0),r.forceturn&&Gl(r.forceturn,"forceturn"),r.security&&Gl(r.security,"security"),r.tcpport&&Qt(r.tcpport,"tcpport",1,99999,!0),!0}function h1(r){return r.level!==void 0&&yr(r.level,"level",[1,2,3]),r.delay!==void 0&&Qt(r.delay,"delay",0,3e3,!0),!0}let _t=function(r){return r.PEERCONNECTION_STATE_CHANGE="peerconnection-state-change",r.AUDIO_METADATA="audio-metadata",r.CONNECTION_STATE_CHANGE="connection-state-change",r.MEDIA_RECONNECT_START="media-reconnect-start",r.MEDIA_RECONNECT_END="media-reconnect-end",r.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",r.USER_JOINED="user-joined",r.USER_LEAVED="user-left",r.USER_PUBLISHED="user-published",r.USER_UNPUBLISHED="user-unpublished",r.USER_INFO_UPDATED="user-info-updated",r.CLIENT_BANNED="client-banned",r.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",r.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",r.VOLUME_INDICATOR="volume-indicator",r.CRYPT_ERROR="crypt-error",r.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",r.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",r.NETWORK_QUALITY="network-quality",r.STREAM_TYPE_CHANGED="stream-type-changed",r.STREAM_FALLBACK="stream-fallback",r.RECEIVE_METADATA="receive-metadata",r.STREAM_MESSAGE="stream-message",r.LIVE_STREAMING_ERROR="live-streaming-error",r.LIVE_STREAMING_WARNING="live-streaming-warning",r.EXCEPTION="exception",r.ERROR="error",r.P2P_LOST="p2p_lost",r.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",r.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",r.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",r.PUBLISHED_USER_LIST="published-user-list",r.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",r.CONTENT_INSPECT_ERROR="content-inspect-error",r.CONTENT_INSPECT_RESULT="content-inspect-result",r.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change",r}({}),ii=function(r){return r.NETWORK_ERROR="NETWORK_ERROR",r.SERVER_ERROR="SERVER_ERROR",r.MULTI_IP="MULTI_IP",r.TIMEOUT="TIMEOUT",r.OFFLINE="OFFLINE",r.LEAVE="LEAVE",r.P2P_FAILED="P2P_FAILED",r.FALLBACK="FALLBACK",r.REGIONAL_DISTRIBUTION="REGIONAL_DISTRIBUTION",r}({}),Do=function(r){return r.ONLINE="ONLINE",r.OFFLINE="OFFLINE",r}({}),gm=function(r){return r.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",r.ONLINE="ONLINE",r.OFFLINE="OFFLINE",r}({});function oi(r,o){for(var s=arguments.length,c=new Array(s>2?s-2:0),u=2;u<s;u++)c[u-2]=arguments[u];return r.getListeners(o).length===0?De.reject(new ve(Y.UNEXPECTED_ERROR,"can not emit promise")):new De((h,p)=>{r.emit(o,...c,h,p)})}function rn(r,o){if(r.getListeners(o).length===0)return De.resolve();for(var s=arguments.length,c=new Array(s>2?s-2:0),u=2;u<s;u++)c[u-2]=arguments[u];return oi(r,o,...c)}function Zo(r,o){if(r.getListeners(o).length===0)return null;for(var s=arguments.length,c=new Array(s>2?s-2:0),u=2;u<s;u++)c[u-2]=arguments[u];return c_(r,o,...c)}function c_(r,o){let s=null,c=null;for(var u=arguments.length,h=new Array(u>2?u-2:0),p=2;p<u;p++)h[p-2]=arguments[p];if(r.emit(o,...h,g=>{s=g},g=>{c=g}),c!==null)throw c;if(s===null)throw new ve(Y.UNEXPECTED_ERROR,"handler is not sync");return s}const qn=new class extends An{set networkState(r){this.emit(gm.NETWORK_STATE_CHANGE,r,this._networkState),r===Do.ONLINE?this.emit(gm.ONLINE):r===Do.OFFLINE&&(this.onlineWaiter=new De(o=>{this.once(gm.ONLINE,()=>{this.onlineWaiter=void 0,o(Do.ONLINE)})}),this.emit(gm.OFFLINE)),this._networkState=r}get networkState(){return this._networkState}get isOnline(){return this._networkState===Do.ONLINE}constructor(){super(),ot(this,"_moduleName","network-indicator"),ot(this,"_networkState",Do.ONLINE),ot(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=Do.ONLINE}),window.addEventListener("offline",()=>{this.networkState=Do.OFFLINE})}};function kw(r,o){const s=r.indexOf(o);s!==-1&&r.splice(s,1)}function vm(r){const o=[];return r.forEach(s=>{o.indexOf(s)===-1&&o.push(s)}),o}function Lw(r){De!==void 0?De.resolve().then(r):setTimeout(r,0)}function On(r){return JSON.parse(JSON.stringify(r))}function rf(r){try{return On(r)}catch{return r}}const T8={};function ud(r,o){T8[o]||(T8[o]=!0,r())}function of(r){const o=window.atob(r),s=new Uint8Array(new ArrayBuffer(o.length));for(let c=0;c<o.length;c+=1)s[c]=o.charCodeAt(c);return s}function dd(r){let o="";for(let s=0;s<r.length;s+=1)o+=String.fromCharCode(r[s]);return window.btoa(o)}function C8(r){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,s=new TextEncoder().encode(r);if(s.length>o)s=s.slice(0,o);else if(s.length<o){const c=new Uint8Array(o);c.set(s),s=c}return s}function R8(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];const c=oa(o).call(o,(p,g)=>p+g.length,0),u=new Uint8Array(new ArrayBuffer(c));let h=0;return o.forEach(p=>{u.set(p,h),h+=p.length}),u}function zc(r){return window.TextEncoder?new TextEncoder().encode(r).length:r.length}function A8(r){let o=0;return(/DingTalk/i.test(navigator.userAgent)||/AliApp/i.test(navigator.userAgent))&&r.realFormData&&(r=r.realFormData),r.forEach(s=>{o+=typeof s=="string"?zc(s):s.size}),o+138}function HOe(r){const o=new ve(Y.TIMEOUT,"timeout");return new De((s,c)=>{window.setTimeout(()=>c(o),r)})}function Kr(r){return new De(o=>{window.setTimeout(o,r)})}function cn(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,o=arguments.length>1?arguments[1]:void 0;const s=Math.random().toString(16).substr(2,r).toLowerCase();return s.length===r?"".concat(o).concat(s):"".concat(o).concat(s)+cn(r-s.length,"")}function sf(){return cn(32,"").toUpperCase()}const Mw=()=>{},O8=new class{constructor(){ot(this,"fnMap",new Map)}throttleByKey(r,o,s,c){for(var u=arguments.length,h=new Array(u>4?u-4:0),p=4;p<u;p++)h[p-4]=arguments[p];if(this.fnMap.has(o)){const g=this.fnMap.get(o);if(g.threshold!==s){g.fn(...g.args),clearTimeout(g.timer);const y=window.setTimeout(()=>{const b=this.fnMap.get(o);b&&b.fn(...b.args),this.fnMap.delete(o)},s);this.fnMap.set(o,{fn:r,threshold:s,timer:y,args:h,skipFn:c})}else g.skipFn&&g.skipFn(...g.args),this.fnMap.set(o,Ue(Ue({},g),{},{fn:r,args:h,skipFn:c}))}else{const g=window.setTimeout(()=>{const y=this.fnMap.get(o);y&&y.fn(...y.args),this.fnMap.delete(o)},s);this.fnMap.set(o,{fn:r,threshold:s,timer:g,args:h,skipFn:c})}}},I8=O8.throttleByKey.bind(O8);function x8(r){return typeof r=="object"&&r!==null&&!(r instanceof RegExp)}function f1(r,o){if(!x8(r)||!x8(o)||Array.isArray(r)&&!Array.isArray(o)||!Array.isArray(r)&&Array.isArray(o))return o;if(Array.isArray(o)&&Array.isArray(r)){const s=[...r];for(let c=0;c<o.length;c++)s[c]=f1(r[c],o[c]);return s}{const s=Ue({},r);for(const c in o)Object.prototype.hasOwnProperty.call(o,c)&&(Object.prototype.hasOwnProperty.call(r,c)?s[c]=f1(r[c],o[c]):s[c]=o[c]);return s}}function P8(r,o){let s=[0];if(s=new Array(o).fill(0),r===0)return s;let c=0;for(;r>0&&(s[c]=255&r,r>>=8,c++,c!==o););return s}function p1(r){return typeof r=="number"?r:r.exact||r.ideal||r.max||r.min||0}function m1(r){return oa(r).call(r,(o,s)=>o+s,0)}function N8(r){const o="0123456789abcdef";function s(Q){let ie,oe="";for(ie=0;ie<=3;ie++)oe+=o.charAt(Q>>8*ie+4&15)+o.charAt(Q>>8*ie&15);return oe}function c(Q,ie){const oe=(65535&Q)+(65535&ie);return(Q>>16)+(ie>>16)+(oe>>16)<<16|65535&oe}function u(Q,ie,oe,re,me,Ee){return c(function(xe,Me){return xe<<Me|xe>>>32-Me}(c(c(ie,Q),c(re,Ee)),me),oe)}function h(Q,ie,oe,re,me,Ee,xe){return u(ie&oe|~ie&re,Q,ie,me,Ee,xe)}function p(Q,ie,oe,re,me,Ee,xe){return u(ie&re|oe&~re,Q,ie,me,Ee,xe)}function g(Q,ie,oe,re,me,Ee,xe){return u(ie^oe^re,Q,ie,me,Ee,xe)}function y(Q,ie,oe,re,me,Ee,xe){return u(oe^(ie|~re),Q,ie,me,Ee,xe)}const b=function(Q){let ie;const oe=1+(Q.length+8>>6),re=new Array(16*oe);for(ie=0;ie<16*oe;ie++)re[ie]=0;for(ie=0;ie<Q.length;ie++)re[ie>>2]|=Q.charCodeAt(ie)<<ie%4*8;return re[ie>>2]|=128<<ie%4*8,re[16*oe-2]=8*Q.length,re}(r);let w,C,A,x,B,U=1732584193,F=-271733879,K=-1732584194,z=271733878;for(w=0;w<b.length;w+=16)C=U,A=F,x=K,B=z,U=h(U,F,K,z,b[w+0],7,-680876936),z=h(z,U,F,K,b[w+1],12,-389564586),K=h(K,z,U,F,b[w+2],17,606105819),F=h(F,K,z,U,b[w+3],22,-1044525330),U=h(U,F,K,z,b[w+4],7,-176418897),z=h(z,U,F,K,b[w+5],12,1200080426),K=h(K,z,U,F,b[w+6],17,-1473231341),F=h(F,K,z,U,b[w+7],22,-45705983),U=h(U,F,K,z,b[w+8],7,1770035416),z=h(z,U,F,K,b[w+9],12,-1958414417),K=h(K,z,U,F,b[w+10],17,-42063),F=h(F,K,z,U,b[w+11],22,-1990404162),U=h(U,F,K,z,b[w+12],7,1804603682),z=h(z,U,F,K,b[w+13],12,-40341101),K=h(K,z,U,F,b[w+14],17,-1502002290),F=h(F,K,z,U,b[w+15],22,1236535329),U=p(U,F,K,z,b[w+1],5,-165796510),z=p(z,U,F,K,b[w+6],9,-1069501632),K=p(K,z,U,F,b[w+11],14,643717713),F=p(F,K,z,U,b[w+0],20,-373897302),U=p(U,F,K,z,b[w+5],5,-701558691),z=p(z,U,F,K,b[w+10],9,38016083),K=p(K,z,U,F,b[w+15],14,-660478335),F=p(F,K,z,U,b[w+4],20,-405537848),U=p(U,F,K,z,b[w+9],5,568446438),z=p(z,U,F,K,b[w+14],9,-1019803690),K=p(K,z,U,F,b[w+3],14,-187363961),F=p(F,K,z,U,b[w+8],20,1163531501),U=p(U,F,K,z,b[w+13],5,-1444681467),z=p(z,U,F,K,b[w+2],9,-51403784),K=p(K,z,U,F,b[w+7],14,1735328473),F=p(F,K,z,U,b[w+12],20,-1926607734),U=g(U,F,K,z,b[w+5],4,-378558),z=g(z,U,F,K,b[w+8],11,-2022574463),K=g(K,z,U,F,b[w+11],16,1839030562),F=g(F,K,z,U,b[w+14],23,-35309556),U=g(U,F,K,z,b[w+1],4,-1530992060),z=g(z,U,F,K,b[w+4],11,1272893353),K=g(K,z,U,F,b[w+7],16,-155497632),F=g(F,K,z,U,b[w+10],23,-1094730640),U=g(U,F,K,z,b[w+13],4,681279174),z=g(z,U,F,K,b[w+0],11,-358537222),K=g(K,z,U,F,b[w+3],16,-722521979),F=g(F,K,z,U,b[w+6],23,76029189),U=g(U,F,K,z,b[w+9],4,-640364487),z=g(z,U,F,K,b[w+12],11,-421815835),K=g(K,z,U,F,b[w+15],16,530742520),F=g(F,K,z,U,b[w+2],23,-995338651),U=y(U,F,K,z,b[w+0],6,-198630844),z=y(z,U,F,K,b[w+7],10,1126891415),K=y(K,z,U,F,b[w+14],15,-1416354905),F=y(F,K,z,U,b[w+5],21,-57434055),U=y(U,F,K,z,b[w+12],6,1700485571),z=y(z,U,F,K,b[w+3],10,-1894986606),K=y(K,z,U,F,b[w+10],15,-1051523),F=y(F,K,z,U,b[w+1],21,-2054922799),U=y(U,F,K,z,b[w+8],6,1873313359),z=y(z,U,F,K,b[w+15],10,-30611744),K=y(K,z,U,F,b[w+6],15,-1560198380),F=y(F,K,z,U,b[w+13],21,1309151649),U=y(U,F,K,z,b[w+4],6,-145523070),z=y(z,U,F,K,b[w+11],10,-1120210379),K=y(K,z,U,F,b[w+2],15,718787259),F=y(F,K,z,U,b[w+9],21,-343485551),U=c(U,C),F=c(F,A),K=c(K,x),z=c(z,B);return s(U)+s(F)+s(K)+s(z)}let KOe=1,D8=console,fi=class{static setLogger(r){D8=r}constructor(r,o){ot(this,"id",void 0),ot(this,"lockingPromise",De.resolve()),ot(this,"locks",0),ot(this,"name",""),ot(this,"lockId",void 0),this.lockId=KOe++,r&&(this.name=r),o&&(this.id=o),this.logger("created")}logger(r,o){const s=(this.id?"[".concat(this.id,"]"):"")+"[lock-".concat(this.name,"-").concat(this.lockId,"]"),c=r==="created"?"is ".concat(r,"."):"is ".concat(r,", current queue ").concat(this.locks,". ").concat(o??"");D8.debug("".concat(s," ").concat(c))}setId(r){this.id=r}get isLocked(){return this.locks>0}lock(r){let o;this.locks+=1,this.logger("locked",r);const s=new De(u=>{o=()=>{this.locks-=1,this.logger("unlocked",r),u()}}),c=this.lockingPromise.then(()=>o);return this.lockingPromise=this.lockingPromise.then(()=>s),c}};function ym(r,o){return function(s,c,u){const h=u.value;if(typeof h!="function")throw new Error("Cannot use mutex on object property.");return u.value=async function(){const p=this[o];if(!p)throw new Error("mutex property key ".concat(o," doesn't exist on ").concat(r));const g=await p.lock("From ".concat(r,".").concat(c));try{for(var y=arguments.length,b=new Array(y),w=0;w<y;w++)b[w]=arguments[w];return await h.apply(this,b)}finally{g()}},u}}const rr={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function g1(r,o){const s=Math.floor(o.timeout*Math.pow(o.timeoutFactor,r));return Math.min(o.maxRetryTimeout,s)}function nc(r,o,s,c){const u=Object.assign({},rr,c);let h=u.timeout;const p=async()=>{await function(b){return new De(w=>{window.setTimeout(w,b)})}(h),h*=u.timeoutFactor,h=Math.min(u.maxRetryTimeout,h)};let g=!1;const y=new De(async(b,w)=>{o=o||(()=>!1),s=s||(()=>!0);for(let C=0;C<u.maxRetryCount;C+=1){if(g)return w(new ve(Y.OPERATION_ABORTED));try{const A=await r();if(!o(A,C)||C+1===u.maxRetryCount)return b(A);await p()}catch(A){if(!s(A,C)||C+1===u.maxRetryCount)return w(A);await p()}}});return y.cancel=()=>g=!0,y}let jw,k8=class{constructor(r){ot(this,"input",[]),ot(this,"size",void 0),this.size=r}add(r){this.input.push(r),this.input.length>this.size&&this.input.splice(0,1)}mean(){var r;return this.input.length===0?0:oa(r=this.input).call(r,(o,s)=>o+s)/this.input.length}},Uw=0,v1=0;function y1(r,o,s,c){return new De((u,h)=>{o.responseType=o.responseType||"json",o.data&&!s?(o.data=JSON.stringify(o.data),Uw+=zc(o.data)):s&&(o.data.size?Uw+=o.data.size:o.data instanceof FormData?Uw+=A8(o.data):Uw+=zc(JSON.stringify(o.data))),o.headers=o.headers||{},o.headers["Content-Type"]=o.headers["Content-Type"]||"application/json",o.method="POST",o.url=r,Qi.request(o).then(p=>{typeof p.data=="string"?v1+=zc(p.data):p.data instanceof ArrayBuffer||p.data instanceof Uint8Array?v1+=p.data.byteLength:v1+=zc(JSON.stringify(p.data)),u(p.data)}).catch(p=>{Qi.isCancel(p)?h(new ve(Y.OPERATION_ABORTED,"cancel token canceled")):p.code==="ECONNABORTED"?h(new ve(Y.NETWORK_TIMEOUT,p.message)):p.response?h(new ve(Y.NETWORK_RESPONSE_ERROR,p.response.status)):h(new ve(Y.NETWORK_ERROR,p.message))})})}async function zOe(r,o){const s=new Blob([o.data],{type:"buffer"});return await y1(r,Ue(Ue({},o),{},{data:s,headers:{"Content-Type":"application/octet-stream"}}),!0)}const L8=()=>window.isSecureContext!==void 0;function fa(r){if(Array.isArray(r))return r.map(s=>s);if(!M8(r))return r;const o={};for(const s in r){const c=r[s];M8(c)||Array.isArray(c)?o[s]=fa(c):o[s]=c}return o}function M8(r){return!(typeof r!="object"||Array.isArray(r)||!r)}let _1=class{constructor(r){ot(this,"input",[]),ot(this,"size",void 0),this.size=r}add(r){this.input.push(r),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}};const Yc={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},l_={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:Yc,remoteCandidate:Yc},updateInterval:0},j8={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0,framesDroppedCount:0,outputFrameRate:0,packetsDiscarded:0,framesAssembledFromMultiplePackets:0,totalProcessingDelay:0,avgDecodeMs:0,avgFramesAssembledFromMultiplePacketsMs:0,avgProcessingDelayMs:0,avgInterFrameDelayMs:0,totalAssemblyTime:0},U8={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},V8={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},F8={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packetsDiscarded:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0,totalSamplesReceived:0,silentConcealedSamples:0,concealmentEvents:0,freezeMs80:0,freezeMs200:0,freezeSamples80:0,freezeSamples200:0};let E1=class{constructor(r,o){ot(this,"onFirstVideoReceived",void 0),ot(this,"onFirstVideoDecoded",void 0),ot(this,"onFirstAudioReceived",void 0),ot(this,"onFirstVideoDecodedTimeout",void 0),ot(this,"onFirstAudioDecoded",void 0),ot(this,"onSelectedLocalCandidateChanged",void 0),ot(this,"onSelectedRemoteCandidateChanged",void 0),ot(this,"videoIsReady",!1),ot(this,"videoIsReady2",{}),ot(this,"pc",void 0),ot(this,"options",void 0),ot(this,"intervalTimer",void 0),ot(this,"stats",fa(l_)),ot(this,"isFirstVideoReceived",{}),ot(this,"isFirstVideoDecoded",{}),ot(this,"isFirstAudioReceived",{}),ot(this,"isFirstAudioDecoded",{}),ot(this,"isFirstVideoDecodedTimeout",{}),ot(this,"lossRateWindowStats",[]),this.pc=r,this.options=o,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new De(r=>{r({local:Ue({},Yc),remote:Ue({},Yc)})})}setVideoIsReady(r){this.videoIsReady=r}setVideoIsReady2(r,o){this.videoIsReady2[r]=o}getVideoIsReady(r){return this.videoIsReady2[r]||!1}setIsFirstAudioDecoded(r){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(r){this.lossRateWindowStats.push(r),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const o=this.lossRateWindowStats.length,s=["videoSend","audioSend","videoRecv","audioRecv"];let c=0,u=0,h=0,p=0;for(const g of s)r[g].forEach((y,b)=>{if(!this.lossRateWindowStats[o-1][g][b]||!this.lossRateWindowStats[0][g][b])return;const w=this.lossRateWindowStats[o-1][g][b].packets-this.lossRateWindowStats[0][g][b].packets,C=this.lossRateWindowStats[o-1][g][b].packetsLost-this.lossRateWindowStats[0][g][b].packetsLost;g==="videoSend"||g==="audioSend"?(c+=w,h+=C):(u+=w,p+=C),Number.isNaN(w)||Number.isNaN(w)?y.packetLostRate=0:y.packetLostRate=w<=0||C<=0?0:C/(w+C)});r.sendPacketLossRate=c<=0||h<=0?0:h/(c+h),r.recvPacketLossRate=u<=0||p<=0?0:p/(u+p)}},YOe=class extends E1{constructor(){super(...arguments),ot(this,"_stats",l_),ot(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const r=await this._getStats(),o=this.statsResponsesToObjects(r);this._stats=fa(l_);const s=o.filter(u=>u.type==="ssrc");this.processSSRCStats(s);const c=o.find(u=>u.type==="VideoBwe");c&&this.processBandwidthStats(c),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(r){this._stats.bitrate={actualEncoded:Number(r.googActualEncBitrate),targetEncoded:Number(r.googTargetEncBitrate),retransmit:Number(r.googRetransmitBitrate),transmit:Number(r.googTransmitBitrate)},this._stats.sendBandwidth=Number(r.googAvailableSendBandwidth)}processSSRCStats(r){r.forEach(o=>{var s;const c=Pe(s=o.id).call(s,"send");switch("".concat(o.mediaType,"_").concat(c?"send":"recv")){case"video_send":{const u=fa(U8);u.codec=o.googCodecName,u.adaptionChangeReason="none",o.googCpuLimitedResolution&&(u.adaptionChangeReason="cpu"),o.googBandwidthLimitedResolution&&(u.adaptionChangeReason="bandwidth"),u.avgEncodeMs=Number(o.googAvgEncodeMs),u.inputFrame={width:Number(o.googFrameWidthInput)||Number(o.googFrameWidthSent),height:Number(o.googFrameHeightInput)||Number(o.googFrameHeightSent),frameRate:Number(o.googFrameRateInput)},u.sentFrame={width:Number(o.googFrameWidthSent),height:Number(o.googFrameHeightSent),frameRate:Number(o.googFrameRateInput)},u.firsCount=Number(o.googFirReceived),u.nacksCount=Number(o.googNacksReceived),u.plisCount=Number(o.googPlisReceived),u.frameCount=Number(o.framesEncoded),u.bytes=Number(o.bytesSent),u.packets=Number(o.packetsSent),u.packetsLost=Number(o.packetsLost),u.ssrc=Number(o.ssrc),u.rttMs=Number(o.googRtt||0),this._stats.videoSend.push(u),this._stats.rtt=u.rttMs;break}case"video_recv":{const u=fa(j8),h=this.lastDecodeVideoReceiverStats.get(Number(o.ssrc));if(u.codec=o.googCodecName,u.targetDelayMs=Number(o.googTargetDelayMs),u.renderDelayMs=Number(o.googRenderDelayMs),u.currentDelayMs=Number(o.googCurrentDelayMs),u.minPlayoutDelayMs=Number(o.googMinPlayoutDelayMs),u.decodeMs=Number(o.googDecodeMs),u.maxDecodeMs=Number(o.googMaxDecodeMs),u.receivedFrame={width:Number(o.googFrameWidthReceived),height:Number(o.googFrameHeightReceived),frameRate:Number(o.googFrameRateReceived)},u.decodedFrame={width:Number(o.googFrameWidthReceived),height:Number(o.googFrameHeightReceived),frameRate:Number(o.googFrameRateDecoded)},u.decodeFrameRate=Number(o.googFrameRateDecoded),u.outputFrame={width:Number(o.googFrameWidthReceived),height:Number(o.googFrameHeightReceived),frameRate:Number(o.googFrameRateOutput)},u.jitterBufferMs=Number(o.googJitterBufferMs),u.firsCount=Number(o.googFirsSent),u.nacksCount=Number(o.googNacksSent),u.plisCount=Number(o.googPlisSent),u.framesDecodeCount=Number(o.framesDecoded),u.bytes=Number(o.bytesReceived),u.packets=Number(o.packetsReceived),u.packetsLost=Number(o.packetsLost),u.ssrc=Number(o.ssrc),u.packets>0&&!this.isFirstVideoReceived[u.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(u.ssrc),this.isFirstVideoReceived[u.ssrc]=!0),u.framesDecodeCount>0&&!this.isFirstVideoDecoded[u.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(u.ssrc,u.decodedFrame.width,u.decodedFrame.height),this.isFirstVideoDecoded[u.ssrc]=!0),h){const p=h.stats,g=Date.now()-h.lts;u.framesDecodeFreezeTime=p.framesDecodeFreezeTime,u.framesDecodeInterval=p.framesDecodeInterval,u.framesDecodeCount>p.framesDecodeCount&&this.isFirstVideoDecoded[u.ssrc]?(h.lts=Date.now(),u.framesDecodeInterval=g,u.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(o.ssrc,10))?u.framesDecodeFreezeTime+=u.framesDecodeInterval:this.setVideoIsReady2(parseInt(o.ssrc,10),!0))):u.framesDecodeCount<h.stats.framesDecodeCount&&(u.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(u.ssrc,{stats:Ue({},u),lts:Date.now()}),this._stats.videoRecv.push(u);break}case"audio_recv":{const u=fa(F8);u.codec=o.googCodecName,u.outputLevel=Math.abs(Number(o.audioOutputLevel))/32767,u.decodingCNG=Number(o.googDecodingCNG),u.decodingCTN=Number(o.googDecodingCTN),u.decodingCTSG=Number(o.googDecodingCTSG),u.decodingNormal=Number(o.googDecodingNormal),u.decodingPLC=Number(o.googDecodingPLC),u.decodingPLCCNG=Number(o.googDecodingPLCCNG),u.expandRate=Number(o.googExpandRate),u.accelerateRate=Number(o.googAccelerateRate),u.preemptiveExpandRate=Number(o.googPreemptiveExpandRate),u.secondaryDecodedRate=Number(o.googSecondaryDecodedRate),u.speechExpandRate=Number(o.googSpeechExpandRate),u.preferredJitterBufferMs=Number(o.googPreferredJitterBufferMs),u.jitterBufferMs=Number(o.googJitterBufferMs),u.jitterMs=Number(o.googJitterReceived),u.bytes=Number(o.bytesReceived),u.packets=Number(o.packetsReceived),u.packetsLost=Number(o.packetsLost),u.ssrc=Number(o.ssrc),u.receivedFrames=Number(o.googDecodingCTN)||Number(o.packetsReceived),u.droppedFrames=Number(o.googDecodingPLC)+Number(o.googDecodingPLCCNG)||Number(o.packetsLost),u.receivedFrames>0&&!this.isFirstAudioReceived[u.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(u.ssrc),this.isFirstAudioReceived[u.ssrc]=!0),u.decodingNormal>0&&!this.isFirstAudioDecoded[u.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(u.ssrc),this.isFirstAudioDecoded[u.ssrc]=!0),this._stats.audioRecv.push(u);break}case"audio_send":{const u=fa(V8);u.codec=o.googCodecName,u.inputLevel=Math.abs(Number(o.audioInputLevel))/32767,u.aecReturnLoss=Number(o.googEchoCancellationReturnLoss||0),u.aecReturnLossEnhancement=Number(o.googEchoCancellationReturnLossEnhancement||0),u.residualEchoLikelihood=Number(o.googResidualEchoLikelihood||0),u.residualEchoLikelihoodRecentMax=Number(o.googResidualEchoLikelihoodRecentMax||0),u.bytes=Number(o.bytesSent),u.packets=Number(o.packetsSent),u.packetsLost=Number(o.packetsLost),u.ssrc=Number(o.ssrc),u.rttMs=Number(o.googRtt||0),this._stats.rtt=u.rttMs,this._stats.audioSend.push(u);break}}})}_getStats(){return new De((r,o)=>{this.pc.getStats(r,o)})}statsResponsesToObjects(r){const o=[];return r.result().forEach(s=>{const c={id:s.id,timestamp:s.timestamp.valueOf().toString(),type:s.type};s.names().forEach(u=>{c[u]=s.stat(u)}),o.push(c)}),o}},u_=function(r){return r.BANDWIDTH="bandwidth",r.CPU="cpu",r.NONE="none",r.OTHER="other",r}({}),Vw=function(r){return r.L1T1="L1T1",r.L1T2="L1T2",r.L1T3="L1T3",r.L1T3_KEY="L1T3_KEY",r.L2T1_KEY="L2T1_KEY",r.L2T2_KEY="L2T2_KEY",r.L2T3_KEY="L2T3_KEY",r.L3T1_KEY="L3T1_KEY",r.L3T2_KEY="L3T2_KEY",r.L3T3_KEY="L3T3_KEY",r}({}),b1=function(r){return r[r.new=0]="new",r[r.connecting=1]="connecting",r[r.connected=2]="connected",r[r.disconnected=3]="disconnected",r[r.failed=4]="failed",r[r.closed=5]="closed",r}({}),es=function(r){return r.CERTIFICATE="certificate",r.CODEC="codec",r.CANDIDATE_PAIR="candidate-pair",r.LOCAL_CANDIDATE="local-candidate",r.REMOTE_CANDIDATE="remote-candidate",r.INBOUND="inbound-rtp",r.TRACK="track",r.OUTBOUND="outbound-rtp",r.PC="peer-connection",r.REMOTE_INBOUND="remote-inbound-rtp",r.REMOTE_OUTBOUND="remote-outbound-rtp",r.TRANSPORT="transport",r.CSRC="csrc",r.DATA_CHANNEL="data-channel",r.STREAM="stream",r.SENDER="sender",r.RECEIVER="receiver",r}({});var _m=function(r){return r[r.kNone=1]="kNone",r[r.kMillisecondsFromSeconds=1e3]="kMillisecondsFromSeconds",r[r.kBytesToBits=8]="kBytesToBits",r}(_m||{});function d_(r,o,s,c){let u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:_m.kNone;if(!o)return;const h=Number(o[s]);if(typeof h!="number")return;const p=Number(o[c]);if(typeof p!="number")return;if(!r)return p?h/p*u:void 0;const g=Number(r[s]);if(typeof g!="number")return;const y=Number(r[c]);if(typeof y!="number")return;const b=p-y;return b?(h-g)/b*u:void 0}let B8=class extends E1{constructor(){super(...arguments),ot(this,"_stats",l_),ot(this,"report",void 0),ot(this,"lastDecodeVideoReceiverStats",new Map),ot(this,"lastVideoFramesRecv",new Map),ot(this,"lastVideoFramesSent",new Map),ot(this,"lastVideoFramesDecode",new Map),ot(this,"lastVideoFramesOutput",new Map),ot(this,"lastVideoJBDelay",new Map),ot(this,"lastAudioJBDelay",new Map),ot(this,"mediaBytesSent",new Map),ot(this,"mediaBytesRetransmit",new Map),ot(this,"mediaBytesTargetEncode",new Map),ot(this,"lastDecodeAudioReceiverStats",new Map),ot(this,"lastAudioConcealment",new Map),ot(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=fa(l_),this.report.forEach(r=>{switch(r.type){case es.OUTBOUND:case es.INBOUND:{const o=r.mediaType||r.kind,s=!o&&"frameWidth"in r,c=!o&&!("frameWidth"in r);r.type===es.OUTBOUND?o==="audio"||c?this.processAudioOutboundStats(r):(o==="video"||s)&&this.processVideoOutboundStats(r):r.type===es.INBOUND&&(o==="audio"||c?this.processAudioInboundStats(r):(o==="video"||s)&&this.processVideoInboundStats(r));break}case es.TRANSPORT:{const o=this.report.get(r.selectedCandidatePairId);o&&this.processCandidatePairStats(o);break}case es.CANDIDATE_PAIR:r.selected&&this.processCandidatePairStats(r)}}),this.updateSendBitrate(),this._stats.updateInterval=Date.now()-this.stats.timestamp,this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const r=await this.pc.getStats(),o={local:Ue({},Yc),remote:Ue({},Yc)};return r.forEach(s=>{let c;if(s.type===es.TRANSPORT&&(c=r.get(s.selectedCandidatePairId)),s.type===es.CANDIDATE_PAIR&&s.selected&&(c=s),c){const u=(h,p)=>{h.type=p.type,h.id=p.id,p.address&&(h.address=p.address),p.candidateType&&(h.candidateType=p.candidateType),p.port&&(h.port=p.port),p.priority&&(h.priority=p.priority),p.protocol&&(h.protocol=p.protocol),p.relayProtocol&&(h.relayProtocol=p.relayProtocol)};if(c.localCandidateId){const h=r.get(c.localCandidateId);h&&u(o.local,h)}if(c.remoteCandidateId){const h=r.get(c.remoteCandidateId);h&&u(o.remote,h)}}}),o}processCandidatePairStats(r){if(this._stats.sendBandwidth=r.availableOutgoingBitrate||0,r.currentRoundTripTime&&(this._stats.rtt=1e3*r.currentRoundTripTime),this._stats.videoSend.forEach(o=>{r.currentRoundTripTime&&(o.rttMs=1e3*r.currentRoundTripTime)}),this._stats.audioSend.forEach(o=>{r.currentRoundTripTime&&(o.rttMs=1e3*r.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=r.id,r.localCandidateId){const o=this.report.get(r.localCandidateId);o&&this.processCandidateStats(o)}if(r.remoteCandidateId){const o=this.report.get(r.remoteCandidateId);o&&this.processCandidateStats(o)}}processCandidateStats(r){let o;r.type===es.LOCAL_CANDIDATE&&(o=this._stats.selectedCandidatePair.localCandidate),r.type===es.REMOTE_CANDIDATE&&(o=this._stats.selectedCandidatePair.remoteCandidate),o&&(o.type=r.type,o.id=r.id,r.address&&(o.address=r.address),r.candidateType&&(o.candidateType=r.candidateType),r.port&&(o.port=r.port),r.priority&&(o.priority=r.priority),r.protocol&&(o.protocol=r.protocol),r.relayProtocol&&(o.relayProtocol=r.relayProtocol),r.type===es.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==o.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(Ue({},o),Ue({},this.stats.selectedCandidatePair.localCandidate)),r.type===es.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==o.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(Ue({},o),Ue({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(r){let o=this._stats.audioRecv.find(c=>c.ssrc===r.ssrc);o||(o=fa(F8),this._stats.audioRecv.push(o)),o.ssrc=r.ssrc,o.packets=r.packetsReceived,o.packetsLost=r.packetsLost,o.packetsDiscarded=r.packetsDiscarded,o.bytes=r.bytesReceived,o.jitterMs=1e3*r.jitter,o.retransmittedBytesReceived=r.retransmittedBytesReceived,o.retransmittedPacketsReceived=r.retransmittedPacketsReceived,o.totalProcessingDelay=r.totalProcessingDelay,o.jitterBufferEmittedCount=r.jitterBufferEmittedCount;const s=this.lastDecodeAudioReceiverStats.get(o.ssrc);o.avgProcessingDelayMs=d_(s,o,"totalProcessingDelay","jitterBufferEmittedCount",_m.kMillisecondsFromSeconds),this.processAudioTrackReceiverStats(r,r.trackId,o),this.calculateAudioFreeze(o,s,r),r.codecId&&(o.codec=this.getCodecFromCodecStats(r.codecId)),o.receivedFrames||(o.receivedFrames=r.packetsReceived),o.droppedFrames||(o.droppedFrames=r.packetsLost),o.receivedFrames>0&&!this.isFirstAudioReceived[o.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(o.ssrc),this.isFirstAudioReceived[o.ssrc]=!0),o.outputLevel&&o.outputLevel>0&&!this.isFirstAudioDecoded[o.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(o.ssrc),this.isFirstAudioDecoded[o.ssrc]=!0),typeof r.concealedSamples=="number"&&(o.concealedSamples=r.concealedSamples),this.lastDecodeAudioReceiverStats.set(o.ssrc,Ue({},o))}calculateAudioFreeze(r,o,s){const c=this.lastAudioConcealment.get(r.ssrc);if(o!=null&&c!=null){const u=c.lts,h=s.timestamp,p=h-u;if(p<=0)return;const g=r.concealedSamples-o.concealedSamples-0,y=c.nonSilent+g,b=r.totalSamplesReceived-o.totalSamplesReceived;if(b<=0)return;const w=80*b/p,C=200*b/p,A=p/b;let x=0;r.freezeSamples80=o.freezeSamples80,r.freezeMs80=o.freezeMs80,y>w&&(c.plc80>0?(r.freezeSamples80+=g,r.freezeMs80+=Math.round(g*A)):(r.freezeSamples80+=y,r.freezeMs80+=Math.round(y*A)),x=c.plc80+1);let B=0;r.freezeSamples200=o.freezeSamples200,r.freezeMs200=o.freezeMs200,y>C&&(c.plc200>0?(r.freezeSamples200+=g,r.freezeMs200+=Math.round(g*A)):(r.freezeSamples200+=y,r.freezeMs200+=Math.round(y*A)),B=c.plc200+1),this.lastAudioConcealment.set(r.ssrc,{nonSilent:g,lts:h,plc80:x,plc200:B})}else r.freezeSamples80=0,r.freezeSamples200=0,r.freezeMs80=0,r.freezeMs200=0,this.lastAudioConcealment.set(r.ssrc,{nonSilent:0,lts:s.timestamp,plc80:0,plc200:0})}processVideoInboundStats(r){let o=this._stats.videoRecv.find(p=>p.ssrc===r.ssrc);o||(o=fa(j8),this._stats.videoRecv.push(o)),o.ssrc=r.ssrc,o.packets=r.packetsReceived,o.packetsLost=r.packetsLost,o.bytes=r.bytesReceived,o.firsCount=r.firCount,o.nacksCount=r.nackCount,o.plisCount=r.pliCount,o.framesDecodeCount=r.framesDecoded,o.framesDroppedCount=r.framesDropped,o.totalInterFrameDelay=r.totalInterFrameDelay,o.totalSquaredInterFrameDelay=r.totalSquaredInterFrameDelay,o.totalFreezesDuration=r.totalFreezesDuration,o.totalProcessingDelay=r.totalProcessingDelay,o.packetsDiscarded=r.packetsDiscarded,o.framesAssembledFromMultiplePackets=r.framesAssembledFromMultiplePackets,o.totalAssemblyTime=r.totalAssemblyTime,o.keyFramesDecoded=r.keyFramesDecoded,o.retransmittedBytesReceived=r.retransmittedBytesReceived,o.retransmittedPacketsReceived=r.retransmittedPacketsReceived;const s=this.lastDecodeVideoReceiverStats.get(o.ssrc),c=this.lastVideoFramesDecode.get(o.ssrc),u=this.lastVideoFramesOutput.get(o.ssrc),h=Date.now();if(o.framesDecodeCount>0&&!this.isFirstVideoDecoded[o.ssrc]){const p=o.decodedFrame?o.decodedFrame.width:0,g=o.decodedFrame?o.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(o.ssrc,p,g),this.isFirstVideoDecoded[o.ssrc]=!0}if(s){const p=s.stats,g=h-s.lts;o.framesDecodeFreezeTime=p.framesDecodeFreezeTime,o.framesDecodeInterval=p.framesDecodeInterval,!this.isFirstVideoDecoded[o.ssrc]&&g>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[o.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(o.ssrc),this.isFirstVideoDecodedTimeout[o.ssrc]=!0),o.framesDecodeCount>p.framesDecodeCount&&this.isFirstVideoDecoded[o.ssrc]?(s.lts=Date.now(),o.framesDecodeInterval=g,o.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(r.ssrc))?o.framesDecodeFreezeTime+=o.framesDecodeInterval:this.setVideoIsReady2(parseInt(r.ssrc,10),!0))):o.framesDecodeCount<p.framesDecodeCount&&(o.framesDecodeInterval=0),r.framesDecoded&&r.qpSum&&(s.stats.framesDecodeCount>r.framesDecoded?o.qpSumPerFrame=r.qpSum/r.framesDecoded:o.qpSumPerFrame=(r.qpSum-s.qpSum)/(r.framesDecoded-s.stats.framesDecodeCount))}r.totalDecodeTime&&(o.decodeMs=1e3*r.totalDecodeTime,o.avgDecodeMs=d_(s==null?void 0:s.stats,o,"decodeMs","framesDecodeCount")),o.avgProcessingDelayMs=d_(s==null?void 0:s.stats,o,"totalProcessingDelay","framesDecodeCount",_m.kMillisecondsFromSeconds),o.avgFramesAssembledFromMultiplePacketsMs=d_(s==null?void 0:s.stats,o,"totalAssemblyTime","framesAssembledFromMultiplePackets",_m.kMillisecondsFromSeconds),o.avgInterFrameDelayMs=d_(s==null?void 0:s.stats,o,"totalInterFrameDelay","framesDecodeCount",_m.kMillisecondsFromSeconds),c&&h-c.lts>=800?(o.decodeFrameRate=Math.round((o.framesDecodeCount-c.count)/((h-c.lts)/1e3)),this.lastVideoFramesDecode.set(o.ssrc,{count:o.framesDecodeCount,lts:h,rate:o.decodeFrameRate})):c?o.decodeFrameRate=c.rate:this.lastVideoFramesDecode.set(o.ssrc,{count:o.framesDecodeCount,lts:h,rate:0}),o.framesDroppedCount&&r.framesReceived&&(u&&h-u.lts>=800?(o.outputFrameRate=Math.round((r.framesReceived-o.framesDroppedCount-u.count)/((h-u.lts)/1e3)),this.lastVideoFramesOutput.set(o.ssrc,{count:r.framesReceived-o.framesDroppedCount,lts:h,rate:Math.max(o.outputFrameRate,0)})):u?o.outputFrameRate=u.rate:this.lastVideoFramesOutput.set(o.ssrc,{count:r.framesReceived-o.framesDroppedCount,lts:h,rate:0})),this.processVideoTrackReceiverStats(r,r.trackId,o),r.codecId&&(o.codec=this.getCodecFromCodecStats(r.codecId)),r.framerateMean&&(o.framesRateFirefox=r.framerateMean),o.packets>0&&!this.isFirstVideoReceived[o.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(o.ssrc),this.isFirstVideoReceived[o.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(o.ssrc,{stats:Ue({},o),lts:s?s.lts:Date.now(),qpSum:r.qpSum})}processVideoOutboundStats(r){let o=this._stats.videoSend.find(c=>c.ssrc===r.ssrc);o||(o=fa(U8),this._stats.videoSend.push(o));const s=this.mediaBytesSent.get(r.ssrc);if(s)s.add(r.bytesSent);else{const c=new _1(10);c.add(r.bytesSent),this.mediaBytesSent.set(r.ssrc,c)}if(r.retransmittedBytesSent!==void 0){const c=this.mediaBytesRetransmit.get(r.ssrc);if(c)c.add(r.retransmittedBytesSent);else{const u=new _1(10);u.add(r.retransmittedBytesSent),this.mediaBytesRetransmit.set(r.ssrc,u)}}if(r.totalEncodedBytesTarget){const c=this.mediaBytesTargetEncode.get(r.ssrc);if(c)c.add(r.totalEncodedBytesTarget);else{const u=new _1(10);u.add(r.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(r.ssrc,u)}}if(o.ssrc=r.ssrc,o.bytes=r.bytesSent,o.packets=r.packetsSent,o.firsCount=r.firCount,o.nacksCount=r.nackCount,o.plisCount=r.pliCount,o.frameCount=r.framesEncoded,o.adaptionChangeReason=r.qualityLimitationReason,o.scalabilityMode=r.scalabilityMode,o.retransmittedBytesSent=r.retransmittedBytesSent,o.retransmittedPacketsSent=r.retransmittedPacketsSent,o.hugeFramesSent=r.hugeFramesSent,o.keyFramesEncoded=r.keyFramesEncoded,o.targetBitrate=r.targetBitrate,r.totalEncodeTime&&r.framesEncoded){const c=this.lastEncoderMs.get(r.ssrc);if(!c||c.lastFrameCount>r.framesEncoded)o.avgEncodeMs=1e3*r.totalEncodeTime/r.framesEncoded;else{const u=r.framesEncoded-c.lastFrameCount,h=r.totalEncodeTime-c.lastEncoderTime;o.avgEncodeMs=1e3*h/u}}if(r.framesEncoded&&r.qpSum){const c=this.lastEncoderMs.get(r.ssrc);!c||c.lastFrameCount>r.framesEncoded?o.qpSumPerFrame=r.qpSum/r.framesEncoded:o.qpSumPerFrame=(r.qpSum-c.lastQpSum)/(r.framesEncoded-c.lastFrameCount)}if(this.lastEncoderMs.set(r.ssrc,{lastFrameCount:r.framesEncoded,lastEncoderTime:r.totalEncodeTime,lastQpSum:r.qpSum,lts:Date.now()}),r.codecId&&(o.codec=this.getCodecFromCodecStats(r.codecId)),r.mediaSourceId&&this.processVideoMediaSource(r.mediaSourceId,o),this.processVideoTrackSenderStats(r,r.trackId,o),r.remoteId)this.processRemoteInboundStats(r.remoteId,o);else{const c=this.findRemoteStatsId(r.ssrc,es.REMOTE_INBOUND);c&&this.processRemoteInboundStats(c,o)}}processAudioOutboundStats(r){let o=this._stats.audioSend.find(s=>s.ssrc===r.ssrc);if(o||(o=fa(V8),this._stats.audioSend.push(o)),o.ssrc=r.ssrc,o.packets=r.packetsSent,o.bytes=r.bytesSent,o.retransmittedBytesSent=r.retransmittedBytesSent,o.retransmittedPacketsSent=r.retransmittedPacketsSent,r.mediaSourceId&&this.processAudioMediaSource(r.mediaSourceId,o),r.codecId&&(o.codec=this.getCodecFromCodecStats(r.codecId)),this.processAudioTrackSenderStats(r,r.trackId,o),r.remoteId)this.processRemoteInboundStats(r.remoteId,o);else{const s=this.findRemoteStatsId(r.ssrc,es.REMOTE_INBOUND);s&&this.processRemoteInboundStats(s,o)}}findRemoteStatsId(r,o){var s;const c=Array.from(xo(s=this.report).call(s)).find(u=>u.type===o&&u.ssrc===r);return c?c.id:null}processVideoMediaSource(r,o){const s=this.report.get(r);s&&s.width&&s.height&&s.framesPerSecond&&(o.inputFrame={width:s.width,height:s.height,frameRate:s.framesPerSecond})}processAudioMediaSource(r,o){const s=this.report.get(r);s&&(o.inputLevel=s.audioLevel)}processVideoTrackSenderStats(r,o,s){var c,u,h,p;const g=o?this.report.get(o):void 0,y=(c=g==null?void 0:g.framesSent)!==null&&c!==void 0?c:r.framesSent;if(typeof y!="number")return;let b=(u=g==null?void 0:g.frameWidth)!==null&&u!==void 0?u:r.frameWidth,w=(h=g==null?void 0:g.frameHeight)!==null&&h!==void 0?h:r.frameHeight,C=(p=g==null?void 0:g.framesPerSecond)!==null&&p!==void 0?p:r.framesPerSecond;if(typeof b=="number"&&typeof w=="number"||(b=0,w=0),C==null){const A=Date.now(),x=this.lastVideoFramesSent.get(s.ssrc);x&&A-x.lts>=800?(C=Math.round((y-x.count)/((A-x.lts)/1e3)),this.lastVideoFramesSent.set(s.ssrc,{count:y,lts:A,rate:C})):x?C=x.rate:this.lastVideoFramesSent.set(s.ssrc,{count:y,lts:A,rate:0})}s.sentFrame={width:b,height:w,frameRate:Math.max(0,C)}}processVideoTrackReceiverStats(r,o,s){var c,u,h,p,g;const y=o?this.report.get(o):void 0,b=(c=y==null?void 0:y.framesReceived)!==null&&c!==void 0?c:r.framesReceived,w=(u=y==null?void 0:y.frameWidth)!==null&&u!==void 0?u:r.frameWidth,C=(h=y==null?void 0:y.frameHeight)!==null&&h!==void 0?h:r.frameHeight,A=(p=y==null?void 0:y.jitterBufferDelay)!==null&&p!==void 0?p:r.jitterBufferDelay,x=(g=y==null?void 0:y.jitterBufferEmittedCount)!==null&&g!==void 0?g:r.jitterBufferEmittedCount;if(typeof b=="number"){const B=this.lastVideoFramesRecv.get(s.ssrc),U=Date.now();s.framesReceivedCount=b;let F=0;B&&U-B.lts>=800?(F=Math.round((b-B.count)/((U-B.lts)/1e3)),this.lastVideoFramesRecv.set(s.ssrc,{count:b,lts:U,rate:F})):B?F=B.rate:this.lastVideoFramesRecv.set(s.ssrc,{count:b,lts:U,rate:0}),s.receivedFrame={width:w||0,height:C||0,frameRate:F||0},s.decodedFrame={width:w||0,height:C||0,frameRate:s.decodeFrameRate||0},s.outputFrame={width:w||0,height:C||0,frameRate:s.outputFrameRate||s.decodeFrameRate||0}}if(A&&x){const B=this.lastVideoJBDelay.get(s.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let U=B.jitterBufferMs;const F=x-B.jitterBufferEmittedCount;F>0&&(U=1e3*(A-B.jitterBufferDelay)/F),s.jitterBufferMs=U,s.currentDelayMs=Math.round(U),this.lastVideoJBDelay.set(s.ssrc,{jitterBufferDelay:A,jitterBufferEmittedCount:x,jitterBufferMs:s.currentDelayMs})}}processAudioTrackSenderStats(r,o,s){var c,u,h,p;const g=o?this.report.get(o):void 0,y=(c=(u=g==null?void 0:g.echoReturnLoss)!==null&&u!==void 0?u:r.echoReturnLoss)!==null&&c!==void 0?c:0,b=(h=(p=g==null?void 0:g.echoReturnLossEnhancement)!==null&&p!==void 0?p:r.echoReturnLossEnhancement)!==null&&h!==void 0?h:0;s.aecReturnLoss=y,s.aecReturnLossEnhancement=b}processAudioTrackReceiverStats(r,o,s){var c,u,h,p,g,y,b,w,C;const A=o?this.report.get(o):void 0,x=(c=A==null?void 0:A.removedSamplesForAcceleration)!==null&&c!==void 0?c:r.removedSamplesForAcceleration,B=(u=A==null?void 0:A.totalSamplesReceived)!==null&&u!==void 0?u:r.totalSamplesReceived,U=(h=A==null?void 0:A.jitterBufferDelay)!==null&&h!==void 0?h:r.jitterBufferDelay,F=(p=A==null?void 0:A.jitterBufferEmittedCount)!==null&&p!==void 0?p:r.jitterBufferEmittedCount,K=(g=A==null?void 0:A.audioLevel)!==null&&g!==void 0?g:r==null?void 0:r.audioLevel,z=(y=A==null?void 0:A.totalSamplesDuration)!==null&&y!==void 0?y:r==null?void 0:r.totalSamplesDuration,Q=(b=A==null?void 0:A.concealedSamples)!==null&&b!==void 0?b:r.concealedSamples,ie=(w=A==null?void 0:A.silentConcealedSamples)!==null&&w!==void 0?w:r.silentConcealedSamples,oe=(C=A==null?void 0:A.concealmentEvents)!==null&&C!==void 0?C:r.concealmentEvents;if(typeof B=="number"&&(s.totalSamplesReceived=B),typeof ie=="number"&&(s.silentConcealedSamples=ie),typeof oe=="number"&&(s.concealmentEvents=oe),typeof Q=="number"&&(s.concealedSamples=Q),x&&B&&(s.accelerateRate=x/B),U&&F){const me=this.lastAudioJBDelay.get(s.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let Ee=me.jitterBufferMs;const xe=F-me.jitterBufferEmittedCount;xe>0&&(Ee=1e3*(U-me.jitterBufferDelay)/xe),s.jitterBufferMs=Math.round(Ee),this.lastAudioJBDelay.set(s.ssrc,{jitterBufferDelay:U,jitterBufferEmittedCount:F,jitterBufferMs:s.jitterBufferMs})}s.outputLevel=K;let re=1920;z&&B&&(re=B/z/50,s.receivedFrames=Math.round(B/re)),Q&&(s.droppedFrames=Math.round(Q/re))}processRemoteInboundStats(r,o){const s=this.report.get(r);s&&(o.packetsLost=s.packetsLost,s.roundTripTime&&(o.rttMs=1e3*s.roundTripTime),s.jitter&&(o.jitterMs=1e3*s.jitter),s.timestamp&&(o.timestamp=s.timestamp))}getCodecFromCodecStats(r){const o=this.report.get(r);if(!o)return"";const s=o.mimeType.match(/\/(.*)$/);return s&&s[1]?s[1]:""}updateSendBitrate(){let r=0,o=null,s=null;this.mediaBytesSent.forEach(u=>{r+=u.diffMean()}),this.mediaBytesRetransmit.forEach(u=>{o=o===null?u.diffMean():o+u.diffMean()}),this.mediaBytesTargetEncode.forEach(u=>{s=s===null?u.diffMean():s+u.diffMean()});const c=o!==null?r-o:r;this._stats.bitrate={actualEncoded:8*c/(this.options.updateInterval/1e3),transmit:8*r/(this.options.updateInterval/1e3)},o!==null&&(this._stats.bitrate.retransmit=8*o/(this.options.updateInterval/1e3)),s!==null&&(this._stats.bitrate.targetEncoded=8*s/(this.options.updateInterval/1e3))}},qOe=class extends E1{updateStats(){return De.resolve()}};function S1(r){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,u=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4;const h=function(){const p=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return p&&p[0]?Number(p[0].split("/")[1]):null}();return h?h<76?new YOe(r,{updateInterval:o,lossRateInterval:s,freezeRateLimit:c,firstVideoDecodedTimeout:u}):new B8(r,{updateInterval:o,lossRateInterval:s,freezeRateLimit:c,firstVideoDecodedTimeout:u}):function(p){if(!window.RTCStatsReport)return!1;const g=p.getStats();return!!(g instanceof De||function(y){return!!y&&(typeof y=="object"||typeof y=="function")&&typeof y.then=="function"}(g))}(r)?new B8(r,{updateInterval:o,lossRateInterval:s,freezeRateLimit:c,firstVideoDecodedTimeout:u}):new qOe(r,{updateInterval:o,lossRateInterval:s,freezeRateLimit:c,firstVideoDecodedTimeout:u})}const $8="websdk_ng_install_id";function w1(){try{if(q("INSTALL_ID"))return q("INSTALL_ID");let r=window.localStorage.getItem($8);return r||(r=sf(),window.localStorage.setItem($8,r)),Yt("INSTALL_ID",r),r}catch{return}}const xs=function(r){if(r.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return r;const o=r.match(/([0-9]+\.[0-9]+\.[0-9]+)\-([0-9]+)/);if(o&&o[1]&&o[2]){const s=o[1],c=o[2];return"".concat(s,".").concat(c)}return"4.0.0.999"}("4.23.4"),T1=function(){try{return JSON.parse("true")===!0}catch{return!0}}();let af=function(r){return r.Default="default",r.Auto="auto",r.Relay="relay",r.SdRtn="sd-rtn",r}({});const si=function(){const r="us".concat("erna","me"),o="pa".concat("sswo","rd"),s=["t","s","t"];s.splice(1,0,"e");const c=s.join(""),u=[];for(let g=0;g<6;g++)u.push("1");const h=u.join(""),p={};return p[r]=c,p[o]=h,Object.assign(p,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=si;const Fw={ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,ENABLE_USER_LICENSE_CHECK:!0,DISABLE_FEC:void 0,ENABLE_NTP_REPORT:!1,ENABLE_INSTANT_VIDEO:!1,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_LOSSBASED_BWE:!0,ENABLE_AUT_CC:!1,ENABLE_CC_FALLBACK:void 0,SUBSCRIBE_TWCC:!0,PUBLISH_TWCC:!1,ENABLE_SVC_DEFAULT_CODECS:["H264","VP8","VP9","AV1"],SVC:[],ENABLE_FULL_LINK_AV_SYNC:!1,SVC_MODE:null,PRE_SUB_NUM:2,ENABLE_AUT_FEEDBACK:!1,SVC_EXTENDED:["VP9"]},C1={MIN_FRAME_RATE:1,MAX_FRAME_RATE:30,MAX_THRESHOLD_FRAMERATE:30,BITRATE_MIN_THRESHOLD:100,BITRATE_MAX_THRESHOLD:100,MAX_SCALE:5,BWE_SCALE_UP_THRESHOLD:.6,BWE_SCALE_DOWN_THRESHOLD:.6,PERF_SCALE_UP_THRESHOLD:.7,PERF_SCALE_DOWN_THRESHOLD:.6,MOTION_RESOLUTION_FACTOR:.8,MOTION_BITRATE_FACTOR:.6,DETAIL_FRAMERATE_FACTOR:.8,DETAIL_BITRATE_FACTOR:.6,BALANCE_RESOLUTION_FACTOR:.9,BALANCE_FRAMERATE_FACTOR:.9,BALANCE_BITRATE_FACTOR:.6,OVERUSE_TIMES_THRESHOLD:10,UNDERUSE_TIMES_THRESHOLD:40},R1="v4.23.4-0-g17410532-dirty(6/5/2025, 4:24:52 PM)",A1={ENABLE_EVENT_REPORT:!0,UPLOAD_LOG:!1,ENABLE_AG_ADAPTATION:!0,FORCE_AG_HIGH_FRAMERATE:!1,FORCE_SUPPORT_AG_ADAPTATION:!1,ENCODER_CONFIG_LIMIT:{},CAMERA_CAPTURE_CONFIG:void 0,ENABLE_PRELOAD:!0,NEW_ICE_RESTART:!1,ICE_RESTART_INTERVAL:1e4,RESTART_SEQUENCE:["udp_tcp_relay","relay"],FIRST_TCP_CANDIDATE:!1,FIRST_TCP_CANDIDATE_INTERVAL:1e3,TURN_DOMAIN:"edge.agora.io",USE_TURN_IP:!1,NEW_TURN_MODE:void 0,NEW_FORCE_TURN:!1,USE_NEW_RENDER_FREEZE_TIME:!1},yn=Ue(Ue(Ue(Ue({},A1),{},{PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,NOT_REPORT_EVENT:[],PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,SHOW_REPORT_USER_INVOKER_LOG:!0,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:250,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!1,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{excludedLinks:[]},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,FIRST_H264_PROFILE_LEVEL_ID:"42001f",FIRST_PACKETIZATION_MODE:"",X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,FINGERPRINT:null,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,ENABLE_AUDIO_TOPN:!1,ENABLE_AUDIO_METADATA:!1,ENABLE_AUDIO_PTS_METADATA:!1,TOPN_SMOOTH_LEVEL:void 0,TOPN_NEW_SPEAKER_DELAY:void 0,TOPN_SWITCH_HOLD_MS:void 0,TOPN_AUDIO_GAIN:void 0,TOPN_SILENCE_THRESHOLD:250,AP_AREA:!0,ENABLE_ENCODED_TRANSFORM:!1,ENABLE_VIDEO_SEI:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,DATASTREAM_MAX_RETRANSMITS:10,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,USE_PURE_ENCRYPTION_MASTER_KEY:!1,ENABLE_AUDIO_RED:!1,OPUS_PTIME:void 0,AUDIO_DUPLICATE_NUM:void 0,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],USE_NEW_NETWORK_CONFIG:!1,AUTO_RESET_AUDIO_ROUTE:!1,PLUGIN_INFO:[],OVERUSE_DETECTOR_PARAMS:C1,CUSTOM_ADAPTATION_DEFAULT_MODE:"",HIDE_NO_POSTER:!1,AP_CACHE_NUM:10,AP_UPDATE_INTERVAL:12e4,AP_CACHE_LIFETIME:12e4,MAX_PRELOAD_ASYNC_LENGTH:3,DISABLE_SCREEN_SHARE_REMB:!1},Fw),{},{USE_CANDIDATE_FROM_AP_DETAIL:!1,AP_REQUEST_DETAIL:void 0,ENABLE_ROLE_SELECT_EDGE:!1,CLIENT_ROLE_OPTIONS:void 0,COMPATIBLE_SDP_EXTENSION:["gdpr_forbidden"],LIMIT_BITRATE:void 0,EXPERIMENTS:{},USE_PUB_RTX:!0,USE_SUB_RTX:!0,ENABLE_DATASTREAM_2:!1,USE_XR:!0,ENABLE_PREALLOC_PC:!1,ENABLE_PRE_SUB:!1,ENABLE_SVC:!1},{INSTALL_ID:""}),{},{K_MIN_RENDER_DELAY:66,USE_STANDARD_BITRATE_DEFAULT:!1,VIDEO_NEW_BITRATE_RATIO:void 0,VIDEO_STANDARD_BITRATE_VERSION:void 0,BASELINE_MORE_H264_BITRATE_RATIO:1.1});function Yt(r,o,s){var c,u,h;Pe(c=Object.keys(yn)).call(c,r)&&(!s&&Pe(u=Object.keys(rc)).call(u,r)||(yn[r]=o,r!=="ENABLE_VIDEO_SEI"&&r!=="ENABLE_AUDIO_TOPN"&&r!=="ENABLE_AUDIO_METADATA"&&r!=="ENABLE_AUDIO_PTS_METADATA"||o!==!0||(yn.ENABLE_ENCODED_TRANSFORM=!0,r==="ENABLE_AUDIO_PTS_METADATA"&&(yn.ENABLE_AUDIO_METADATA=!0)),r==="USE_NEW_NETWORK_CONFIG"&&o&&(h=!!o,yn.USE_NEW_NETWORK_CONFIG=h,h&&(yn.WEBCS_DOMAIN=["webrtc2-2.ap.sd-rtn.com"],yn.WEBCS_DOMAIN_BACKUP_LIST=["webrtc2-4.ap.sd-rtn.com"],yn.CDS_AP=["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],yn.ACCOUNT_REGISTER=["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],yn.EVENT_REPORT_DOMAIN="web-2.statscollector.sd-rtn.com",yn.EVENT_REPORT_BACKUP_DOMAIN="statscollector-1.agora.io",yn.GATEWAY_DOMAINS=["edge.sd-rtn.com"])),r==="ENABLE_PRE_SUB"&&o&&(yn.ENABLE_INSTANT_VIDEO=!0,yn.ENABLE_PREALLOC_PC=!0),r==="ENABLE_SVC"&&o&&(yn.ENABLE_AUT_CC=!0),r==="NEW_FORCE_TURN"&&o&&(yn.NEW_TURN_MODE||(yn.NEW_TURN_MODE=4))))}function q(r){return yn[r]}T1||(yn.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],yn.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],yn.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],yn.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],yn.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],yn.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],yn.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",yn.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",yn.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",yn.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",yn.AREAS=["NORTH_AMERICA","OVERSEA"]);let W8=function(r){return r[r.REALTIME=1]="REALTIME",r}({});const rc={};var St=function(r){return r.SET_SESSION_ID="SET_SESSION_ID",r.SET_P2P_ID="SET_P2P_id",r.SET_DC_ID="SET_DC_id",r.SET_UID="SET_UID",r.SET_INT_UID="SET_INT_UID",r.SET_PUB_ID="SET_PUB_ID",r.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",r.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",r.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",r.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",r.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",r.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",r.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",r.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",r.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",r.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",r.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",r.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",r.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",r.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",r.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",r.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",r.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",r.RESET_KEY_METRICS="RESET_KEY_METRICS",r.SET_USE_P2P="SET_USE_P2P",r.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE",r}(St||{});let Bw=function(r){return r.h264="h264",r.h265="h265",r.vp8="vp8",r.vp9="vp9",r.av1="av1",r}({});(function(r){r.opus="opus",r.pcma="pcma",r.pcmu="pcmu",r.g722="g722"})({});const G8=128,XOe=96,H8=1e3,Em=10;let JOe=0;var K8=(()=>{var r={8:(c,u,h)=>{h.r(u),h.d(u,{Parser:()=>xe,Printer:()=>hn,parse:()=>Oe,print:()=>Ve});const p=`
`,g="".concat("\r").concat(p),y=" ";let b;function w(Se){return Se>="0"&&Se<="9"}function C(Se){return Se>="!"&&Se<="~"}function A(Se){return C(Se)||Se>=""&&Se<="ÿ"}function x(Se){return Se==="!"||Se>="#"&&Se<="'"||Se>="*"&&Se<="+"||Se>="-"&&Se<="."||Se>="0"&&Se<="9"||Se>="A"&&Se<="Z"||Se>="^"&&Se<="~"}function B(Se){return Se>="1"&&Se<="9"}function U(Se){return Se>="A"&&Se<="Z"||Se>="a"&&Se<="z"}function F(Se){return Se==="d"||Se==="h"||Se==="m"||Se==="s"}function K(Se){return Se>""&&Se<"	"||Se>"\v"&&Se<"\f"||Se>""&&Se<"ÿ"}function z(Se){return U(Se)||w(Se)||Se==="+"||Se==="/"}function Q(Se){return w(Se)||U(Se)||Se==="+"||Se==="/"||Se==="-"||Se==="_"}function ie(Se){return U(Se)||w(Se)||Se==="+"||Se==="/"}function oe(Se,j){var X=Object.keys(Se);if(Object.getOwnPropertySymbols){var Z=Object.getOwnPropertySymbols(Se);j&&(Z=Z.filter(function(Ae){return Object.getOwnPropertyDescriptor(Se,Ae).enumerable})),X.push.apply(X,Z)}return X}function re(Se){for(var j=1;j<arguments.length;j++){var X=arguments[j]!=null?arguments[j]:{};j%2?oe(Object(X),!0).forEach(function(Z){me(Se,Z,X[Z])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Se,Object.getOwnPropertyDescriptors(X)):oe(Object(X)).forEach(function(Z){Object.defineProperty(Se,Z,Object.getOwnPropertyDescriptor(X,Z))})}return Se}function me(Se,j,X){return j in Se?Object.defineProperty(Se,j,{value:X,enumerable:!0,configurable:!0,writable:!0}):Se[j]=X,Se}(function(Se){Se.VERSION="v",Se.ORIGIN="o",Se.SESSION_NAME="s",Se.INFORMATION="i",Se.URI="u",Se.EMAIL="e",Se.PHONE="p",Se.CONNECTION="c",Se.BANDWIDTH="b",Se.TIME="t",Se.REPEAT="r",Se.ZONE_ADJUSTMENTS="z",Se.KEY="k",Se.ATTRIBUTE="a",Se.MEDIA="m"})(b||(b={}));class Ee{consumeText(j,X){let Z=X;for(;Z<j.length;){const Ae=j[Z];if(Ae==="\0"||Ae==="\r"||Ae===p)break;Z+=1}if(Z-X==0)throw new Error("Invalid text, at ".concat(j));return Z}consumeUnicastAddress(j,X,Z){return this.consumeTill(j,X,y)}consumeOneOrMore(j,X,Z){let Ae=X;for(;Z(j[Ae]);)Ae++;if(Ae-X==0)throw new Error("Invalid rule at ".concat(X,"."));return Ae}consumeSpace(j,X){if(j[X]===y)return X+1;throw new Error("Invalid space at ".concat(X,"."))}consumeIP4Address(j,X){let Z=X;for(let Ae=0;Ae<4;Ae++)if(Z=this.consumeDecimalUChar(j,Z),Ae!==3){if(j[Z]!==".")throw new Error("Invalid IP4 address.");Z++}return Z}consumeDecimalUChar(j,X){let Z=X;for(let ct=0;ct<3&&w(j[Z]);ct++,Z++);if(Z-X==0)throw new Error("Invalid decimal uchar.");const Ae=parseInt(j.slice(X,Z));if(Ae>=0&&Ae<=255)return Z;throw new Error("Invalid decimal uchar")}consumeIP6Address(j,X){let Z=this.consumeHexpart(j,X);return j[Z]===":"&&(Z+=1,Z=this.consumeIP4Address(j,Z)),Z}consumeHexpart(j,X){let Z=X;if(j[Z]===":"&&j[Z+1]===":"){Z+=2;try{Z=this.consumeHexseq(j,Z)}catch{}return Z}if(Z=this.consumeHexseq(j,Z),j[Z]===":"&&j[Z+1]===":"){Z+=2;try{Z=this.consumeHexseq(j,Z)}catch{}return Z}return Z}consumeHexseq(j,X){let Z=X;for(;Z=this.consumeHex4(j,Z),j[Z]===":"&&j[Z+1]!==":";)Z+=1;return Z}consumeHex4(j,X){let Z=0;for(;Z<4;Z++)if(!((Ae=j[X+Z])>="0"&&Ae<="9"||Ae>="a"&&Ae<="f"||Ae>="A"&&Ae<="F")){if(Z===0)throw new Error("Invalid hex 4");break}var Ae;return X+Z}consumeFQDN(j,X){let Z=X;for(;w(j[Z])||U(j[Z])||j[Z]==="-"||j[Z]===".";)Z+=1;if(Z-X<4)throw new Error("Invalid FQDN");return Z}consumeExtnAddr(j,X){return this.consumeOneOrMore(j,X,A)}consumeMulticastAddress(j,X,Z){switch(Z){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(j,X);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(j,X);default:try{return this.consumeFQDN(j,X)}catch{return this.consumeExtnAddr(j,X)}}}consumeIP6MulticastAddress(j,X){const Z=this.consumeHexpart(j,X);return j[Z]==="/"?this.consumeInteger(j,Z+1):Z}consumeIP4MulticastAddress(j,X){let Z=X+3;const Ae=j.slice(X,Z),ct=parseInt(Ae);if(ct<224||ct>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let ln=0;ln<3;ln++){if(j[Z]!==".")throw new Error("Invalid IP4 multicast address.");Z+=1,Z=this.consumeDecimalUChar(j,Z)}return j[Z]==="/"&&(Z+=1),Z=this.consumeTTL(j,Z),j[Z]==="/"&&(Z=this.consumeInteger(j,Z)),Z}consumeInteger(j,X){if(!B(j[X]))throw new Error("Invalid integer.");for(X+=1;w(j[X]);)X+=1;return X}consumeTTL(j,X){if(j[X]==="0")return X+1;if(!B(j[X]))throw new Error("Invalid TTL.");X+=1;for(let Z=0;Z<2&&w(j[X]);Z++)X+=1;return X}consumeToken(j,X){return this.consumeOneOrMore(j,X,x)}consumeTime(j,X){let Z=X;if(j[Z]==="0")return Z+1;for(B(j[Z])&&(Z+=1);w(j[Z]);)Z++;if(Z-X<10)throw new Error("Invalid time");return Z}consumeAddress(j,X){return this.consumeTill(j,X,y)}consumeTypedTime(j,X){let Z=X;return Z=this.consumeOneOrMore(j,Z,w),F(j[Z])?Z+1:Z}consumeRepeatInterval(j,X){if(!B(j[X]))throw new Error("Invalid repeat interval");for(X+=1;w(j[X]);)X+=1;return F(j[X])&&(X+=1),X}consumePort(j,X){return this.consumeOneOrMore(j,X,w)}consume(j,X,Z){for(let Ae=0;Ae<Z.length;Ae++){if(X+Ae>=j.length)throw new Error("consume exceeding value length");if(j[X+Ae]!==Z[Ae])throw new Error("consume ".concat(Z," failed at ").concat(Ae))}return X+Z.length}consumeTill(j,X,Z){let Ae=X;for(;Ae<j.length&&(typeof Z!="string"||j[Ae]!==Z)&&(typeof Z!="function"||!Z(j[Ae]));)Ae++;return Ae}}class xe extends Ee{constructor(){super(),me(this,"records",[]),me(this,"currentLine",0)}parse(j){const X=this.probeEOL(j);this.records=j.split(X).filter(tu=>!!Oi(tu).call(tu)).map(this.parseLine),this.currentLine=0;const Z=this.parseVersion(),Ae=this.parseOrigin(),ct=this.parseSessionName(),ln=this.parseInformation(),dr=this.parseUri(),js=this.parseEmail(),Ra=this.parsePhone(),X_=this.parseConnection(),Af=this.parseBandWidth(),Zm=this.parseTimeFields(),XT=this.parseKey(),JT=this.parseSessionAttribute(),Us=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:Z,origin:Ae,sessionName:ct,information:ln,uri:dr,emails:js,phones:Ra,connection:X_,bandwidths:Af,timeFields:Zm,key:XT,attributes:JT,mediaDescriptions:Us}}getCurrentRecord(){const j=this.records[this.currentLine];if(!j)throw new Error("Record doesn't exit.");return j}probeEOL(j){for(let X=0;X<j.length;X++)if(j[X]===p)return j[X-1]==="\r"?g:p;throw new Error("Invalid newline character.")}parseLine(j,X){if(j.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const Z=j[0];if(j[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:Z,value:j.slice(2),line:X,cur:0}}parseSessionAttribute(){const j=new pt;for(;this.currentLine<this.records.length;){const X=this.getCurrentRecord();if(X.type!==b.ATTRIBUTE)break;const Z={attField:this.extractOneOrMore(X,Ae=>x(Ae)&&Ae!==":"),_cur:0};X.value[X.cur]===":"&&(X.cur+=1,Z.attValue=this.extractOneOrMore(X,K)),j.parse(Z),this.currentLine++}return j.digest()}parseMediaAttributes(j){const X=new ut(j);for(;this.currentLine<this.records.length;){const Z=this.getCurrentRecord();if(Z.type!==b.ATTRIBUTE)break;const Ae={attField:this.extractOneOrMore(Z,ct=>x(ct)&&ct!==":"),_cur:0};Z.value[Z.cur]===":"&&(Z.cur+=1,Ae.attValue=this.extractOneOrMore(Z,K)),X.parse(Ae),this.currentLine++}return X.digest()}parseKey(){const j=this.getCurrentRecord();if(j.type===b.KEY){if(j.value==="prompt"||j.value==="clear:"||j.value==="base64:"||j.value==="uri:")return j.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const j=this.getCurrentRecord();if(j.type===b.ZONE_ADJUSTMENTS){const X=[];for(;;)try{const Z=this.extract(j,this.consumeTime);this.consumeSpaceForRecord(j);let Ae=!1;j.value[j.cur]==="-"&&(Ae=!0,j.cur+=1);const ct=this.extract(j,this.consumeTypedTime);X.push({time:Z,typedTime:ct,back:Ae})}catch{break}if(X.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,X}return[]}parseRepeat(){const j=[];for(;;){const X=this.getCurrentRecord();if(X.type!==b.REPEAT)break;{const Z=this.extract(X,this.consumeRepeatInterval),Ae=this.parseTypedTime(X);j.push({repeatInterval:Z,typedTimes:Ae}),this.currentLine++}}return j}parseTypedTime(j){const X=[];for(;;)try{this.consumeSpaceForRecord(j),X.push(this.extract(j,this.consumeTypedTime))}catch{break}if(X.length===0)throw new Error("Invalid typed time.");return X}parseTime(){const j=this.getCurrentRecord(),X=this.extract(j,this.consumeTime);this.consumeSpaceForRecord(j);const Z=this.extract(j,this.consumeTime);return this.currentLine++,{startTime:X,stopTime:Z}}parseBandWidth(){const j=[];for(;this.currentLine<this.records.length;){const X=this.getCurrentRecord();if(X.type!==b.BANDWIDTH)break;{const Z=this.extractOneOrMore(X,x);if(X.value[X.cur]!==":")throw new Error("Invalid bandwidth field.");X.cur++;const Ae=this.extractOneOrMore(X,w);j.push({bwtype:Z,bandwidth:Ae}),this.currentLine++}}return j}parseVersion(){const j=this.getCurrentRecord();if(j.type!==b.VERSION)throw new Error("first sdp record must be version");const X=j.value.slice(0,this.consumeOneOrMore(j.value,0,w));if(X.length!==j.value.length)throw new Error('invalid proto version, "v='.concat(j.value,'"'));return this.currentLine++,X}parseOrigin(){const j=this.getCurrentRecord();if(j.type!==b.ORIGIN)throw new Error("second line of sdp must be origin");const X=this.extractOneOrMore(j,A);this.consumeSpaceForRecord(j);const Z=this.extractOneOrMore(j,w);this.consumeSpaceForRecord(j);const Ae=this.extractOneOrMore(j,w);this.consumeSpaceForRecord(j);const ct=this.extractOneOrMore(j,x);this.consumeSpaceForRecord(j);const ln=this.extractOneOrMore(j,x);this.consumeSpaceForRecord(j);const dr=this.extract(j,this.consumeUnicastAddress);return this.currentLine++,{username:X,sessId:Z,sessVersion:Ae,nettype:ct,addrtype:ln,unicastAddress:dr}}parseSessionName(){const j=this.getCurrentRecord();if(j.type===b.SESSION_NAME){const X=this.extract(j,this.consumeText);return this.currentLine++,X}}parseInformation(){const j=this.getCurrentRecord();if(j.type!==b.INFORMATION)return;const X=this.extract(j,this.consumeText);return this.currentLine++,X}parseUri(){const j=this.getCurrentRecord();if(j.type===b.URI)return this.currentLine++,j.value}parseEmail(){const j=[];for(;;){const X=this.getCurrentRecord();if(X.type!==b.EMAIL)break;j.push(X.value),this.currentLine++}return j}parsePhone(){const j=[];for(;;){const X=this.getCurrentRecord();if(X.type!==b.PHONE)break;j.push(X.value),this.currentLine++}return j}parseConnection(){const j=this.getCurrentRecord();if(j.type===b.CONNECTION){const X=this.extractOneOrMore(j,x);this.consumeSpaceForRecord(j);const Z=this.extractOneOrMore(j,x);this.consumeSpaceForRecord(j);const Ae=this.extract(j,this.consumeAddress);return this.currentLine++,{nettype:X,addrtype:Z,address:Ae}}}parseMedia(){const j=this.getCurrentRecord(),X=this.extract(j,this.consumeToken);this.consumeSpaceForRecord(j);let Z=this.extract(j,this.consumePort);j.value[j.cur]==="/"&&(j.cur+=1,Z+=this.extract(j,this.consumeInteger)),this.consumeSpaceForRecord(j);const Ae=[];for(Ae.push(this.extract(j,this.consumeToken));j.value[j.cur]==="/";)j.cur+=1,Ae.push(this.extract(j,this.consumeToken));if(Ae.length===0)throw new Error("Invalid proto");const ct=this.parseFmt(j);return this.currentLine++,{mediaType:X,port:Z,protos:Ae,fmts:ct}}parseTimeFields(){const j=[];for(;this.getCurrentRecord().type===b.TIME;){const X=this.parseTime(),Z=this.parseRepeat(),Ae=this.parseZone();j.push({time:X,repeats:Z,zones:Ae})}return j}parseMediaDescription(){const j=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===b.MEDIA;){const X=this.parseMedia(),Z=this.parseInformation(),Ae=this.parseConnections(),ct=this.parseBandWidth(),ln=this.parseKey(),dr=this.parseMediaAttributes(X);j.push({media:X,information:Z,connections:Ae,bandwidths:ct,key:ln,attributes:dr})}return j}parseConnections(){const j=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===b.CONNECTION;)j.push(this.parseConnection());return j}parseFmt(j){const X=[];for(;;)try{this.consumeSpaceForRecord(j),X.push(this.extract(j,this.consumeToken))}catch{break}if(X.length===0)throw new Error("Invalid fmts");return X}extract(j,X){for(var Z=arguments.length,Ae=new Array(Z>2?Z-2:0),ct=2;ct<Z;ct++)Ae[ct-2]=arguments[ct];const ln=X.call(this,j.value,j.cur,...Ae),dr=j.value.slice(j.cur,ln);return j.cur=ln,dr}extractOneOrMore(j,X){const Z=this.consumeOneOrMore(j.value,j.cur,X),Ae=j.value.slice(j.cur,Z);return j.cur=Z,Ae}consumeSpaceForRecord(j){if(j.value[j.cur]!==y)throw new Error("Invalid space at ".concat(j.cur,"."));j.cur+=1}}class Me extends Ee{constructor(){super(...arguments),me(this,"attributes",void 0),me(this,"digested",!1)}extractOneOrMore(j,X,Z){const Ae=this.consumeOneOrMore(j.attValue,j._cur,X),ct=j.attValue.slice(j._cur,Ae),[ln,dr]=Z||[];if(typeof ln=="number"&&ct.length<ln)throw new Error("error in length, should be more or equal than ".concat(ln," characters."));if(typeof dr=="number"&&ct.length>dr)throw new Error("error in length, should be less or equal than ".concat(dr," characters."));return j._cur=Ae,ct}consumeAttributeSpace(j){if(j.attValue[j._cur]!==y)throw new Error("Invalid space at ".concat(j._cur,"."));j._cur+=1}extract(j,X){if(!j.attValue)throw new Error("Nothing to extract from attValue.");for(var Z=arguments.length,Ae=new Array(Z>2?Z-2:0),ct=2;ct<Z;ct++)Ae[ct-2]=arguments[ct];const ln=X.call(this,j.attValue,j._cur,...Ae),dr=j.attValue.slice(j._cur,ln);return j._cur=ln,dr}atEnd(j){if(!j.attValue)throw new Error;return j._cur>=j.attValue.length}peekChar(j){if(!j.attValue)throw new Error;return j.attValue[j._cur]}peek(j,X){if(!j.attValue)throw new Error;for(let Z=0;Z<X.length;Z++)if(X[Z]!==j.attValue[j._cur+Z])return!1;return!0}parseIceUfrag(j){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(j,z,[4,256])}parseIcePwd(j){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(j,z,[22,256])}parseIceOptions(j){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const X=[];for(;!this.atEnd(j);){X.push(this.extractOneOrMore(j,z));try{this.consumeAttributeSpace(j)}catch(Z){if(this.atEnd(j))break;throw Z}}this.attributes.iceOptions=X}parseFingerprint(j){const X=this.extract(j,this.consumeToken);this.consumeAttributeSpace(j);const Z=this.extract(j,this.consumeTill);this.attributes.fingerprints.push({hashFunction:X,fingerprint:Z})}parseExtmap(j){const X=this.extractOneOrMore(j,w);let Z;this.peekChar(j)==="/"&&(this.extract(j,this.consume,"/"),Z=this.extract(j,this.consumeToken)),this.consumeAttributeSpace(j);const Ae=this.extract(j,this.consumeTill,y),ct=re(re({entry:parseInt(X,10)},Z&&{direction:Z}),{},{extensionName:Ae});this.peekChar(j)===y&&(this.consumeAttributeSpace(j),ct.extensionAttributes=this.extract(j,this.consumeTill)),this.attributes.extmaps.push(ct)}parseSetup(j){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const X=this.extract(j,this.consumeTill);if(X!=="active"&&X!=="passive"&&X!=="actpass"&&X!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=X}}class pt extends Me{constructor(){super(...arguments),me(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(j){if(this.digested)throw new Error("already digested");try{switch(j.attField){case"group":this.parseGroup(j);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(j);break;case"ice-pwd":this.parseIcePwd(j);break;case"ice-options":this.parseIceOptions(j);break;case"fingerprint":this.parseFingerprint(j);break;case"setup":this.parseSetup(j);break;case"tls-id":this.parseTlsId(j);break;case"identity":this.parseIdentity(j);break;case"extmap":this.parseExtmap(j);break;case"msid-semantic":this.parseMsidSemantic(j);break;default:j.ignored=!0,this.attributes.unrecognized.push(j)}}catch(X){throw console.error("parsing session attribute ".concat(j.attField,' error, "a=').concat(j.attField,":").concat(j.attValue,'"')),X}if(!j.ignored&&j.attValue&&!this.atEnd(j))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(j){const X=this.extract(j,this.consumeToken),Z=[];for(;!this.atEnd(j)&&this.peekChar(j)===y;)this.consumeAttributeSpace(j),Z.push(this.extract(j,this.consumeToken));this.attributes.groups.push({semantic:X,identificationTag:Z})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(j){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(j,Q)}parseIdentity(j){const X=this.extractOneOrMore(j,ie),Z=[];for(;!this.atEnd(j)&&this.peekChar(j)===y;){this.consumeAttributeSpace(j);const Ae=this.extract(j,this.consumeToken);this.extract(j,this.consume,"=");const ct=this.extractOneOrMore(j,ln=>ln!==y&&K(ln));Z.push({name:Ae,value:ct})}this.attributes.identities.push({assertionValue:X,extensions:Z})}parseMsidSemantic(j){this.peekChar(j)===y&&this.consumeAttributeSpace(j);const X={semantic:this.extract(j,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(j)}catch{break}if(this.peekChar(j)==="*"){this.extract(j,this.consume,"*"),X.applyForAll=!0;break}{const Z=this.extract(j,this.consumeTill,y);X.identifierList.push(Z)}}this.attributes.msidSemantic=X}}class ut extends Me{constructor(j){super(),me(this,"attributes",void 0),j.protos.indexOf("RTP")!==-1||j.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(j){if(this.digested)throw new Error("already digested");try{switch(j.attField){case"extmap":this.parseExtmap(j);break;case"setup":this.parseSetup(j);break;case"ice-ufrag":this.parseIceUfrag(j);break;case"ice-pwd":this.parseIcePwd(j);break;case"ice-options":this.parseIceOptions(j);break;case"candidate":this.parseCandidate(j);break;case"remote-candidate":this.parseRemoteCandidate(j);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(j);break;case"rtpmap":this.parseRtpmap(j);break;case"ptime":this.parsePtime(j);break;case"maxptime":this.parseMaxPtime(j);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(j);break;case"ssrc":this.parseSSRC(j);break;case"fmtp":this.parseFmtp(j);break;case"rtcp-fb":this.parseRtcpFb(j);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(j);break;case"mid":this.parseMid(j);break;case"msid":this.parseMsid(j);break;case"imageattr":this.parseImageAttr(j);break;case"rid":this.parseRid(j);break;case"simulcast":this.parseSimulcast(j);break;case"sctp-port":this.parseSctpPort(j);break;case"max-message-size":this.parseMaxMessageSize(j);break;case"ssrc-group":this.parseSSRCGroup(j);break;default:j.ignored=!0,this.attributes.unrecognized.push(j)}}catch(X){throw console.error("parsing media attribute ".concat(j.attField,' error, "a=').concat(j.attField,":").concat(j.attValue,'"')),X}if(!j.ignored&&j.attValue&&!this.atEnd(j))throw new Error("attribute parsing error")}parseCandidate(j){const X=this.extractOneOrMore(j,z,[1,32]);this.consumeAttributeSpace(j);const Z=this.extractOneOrMore(j,w,[1,5]);this.consumeAttributeSpace(j);const Ae=this.extract(j,this.consumeToken);this.consumeAttributeSpace(j);const ct=this.extractOneOrMore(j,w,[1,10]);this.consumeAttributeSpace(j);const ln=this.extract(j,this.consumeAddress);this.consumeAttributeSpace(j);const dr=this.extract(j,this.consumePort);this.consumeAttributeSpace(j),this.extract(j,this.consume,"typ"),this.consumeAttributeSpace(j);const js={foundation:X,componentId:Z,transport:Ae,priority:ct,connectionAddress:ln,port:dr,type:this.extract(j,this.consumeToken),extension:{}};for(this.peek(j," raddr")&&(this.extract(j,this.consume," raddr"),this.consumeAttributeSpace(j),js.relAddr=this.extract(j,this.consumeAddress)),this.peek(j," rport")&&(this.extract(j,this.consume," rport"),this.consumeAttributeSpace(j),js.relPort=this.extract(j,this.consumePort));this.peekChar(j)===y;){this.consumeAttributeSpace(j);const Ra=this.extract(j,this.consumeToken);this.consumeAttributeSpace(j),js.extension[Ra]=this.extractOneOrMore(j,C)}this.attributes.candidates.push(js)}parseRemoteCandidate(j){const X=[];for(;;){const Z=this.extractOneOrMore(j,w,[1,5]);this.consumeAttributeSpace(j);const Ae=this.extract(j,this.consumeAddress);this.consumeAttributeSpace(j);const ct=this.extract(j,this.consumePort);X.push({componentId:Z,connectionAddress:Ae,port:ct});try{this.consumeAttributeSpace(j)}catch{break}}this.attributes.remoteCandidatesList.push(X)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(j){const X=this.extract(j,this.consumeToken);this.consumeAttributeSpace(j);const Z=this.extract(j,this.consumeTill,"/");this.extract(j,this.consume,"/");const Ae={encodingName:Z,clockRate:this.extractOneOrMore(j,w)};this.atEnd(j)||this.peekChar(j)!=="/"||(this.extract(j,this.consume,"/"),Ae.encodingParameters=parseInt(this.extract(j,this.consumeTill),10));const ct=this.attributes.payloads.find(ln=>ln.payloadType===parseInt(X,10));ct?ct.rtpMap=Ae:this.attributes.payloads.push({payloadType:parseInt(X,10),rtpMap:Ae,rtcpFeedbacks:[]})}parsePtime(j){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(j,this.consumeTill)}parseMaxPtime(j){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(j,this.consumeTill)}parseDirection(j){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=j.attField}parseSSRC(j){const X=this.extractOneOrMore(j,w);this.consumeAttributeSpace(j);const Z=this.extract(j,this.consumeTill,":");let Ae;this.peekChar(j)===":"&&(this.extract(j,this.consume,":"),Ae=this.extract(j,this.consumeTill));const ct=this.attributes.ssrcs.find(ln=>ln.ssrcId===parseInt(X,10));ct?ct.attributes[Z]=Ae:this.attributes.ssrcs.push({ssrcId:parseInt(X,10),attributes:{[Z]:Ae}})}parseFmtp(j){const X=this.extract(j,this.consumeTill,y);this.consumeAttributeSpace(j);const Z=this.extract(j,this.consumeTill),Ae={};Z.split(";").forEach(ln=>{let[dr,js]=ln.split("=");dr=Oi(dr).call(dr);const Ra=typeof js=="string"?Oi(js).call(js):null;typeof dr=="string"&&dr.length>0&&(Ae[dr]=Ra)});const ct=this.attributes.payloads.find(ln=>ln.payloadType===parseInt(X,10));ct?ct.fmtp={parameters:Ae}:this.attributes.payloads.push({payloadType:parseInt(X,10),rtcpFeedbacks:[],fmtp:{parameters:Ae}})}parseFmtParameters(j){const X={},Z=this.extract(j,this.consumeTill,"=");j._cur++;const Ae=this.extract(j,this.consumeTill,";");for(X[Z]=Ae;j.attValue[j._cur]===";";){const ct=this.extract(j,this.consumeTill,"=");j._cur++;const ln=this.extract(j,this.consumeTill,";");X[ct]=ln}return X}parseRtcpFb(j){let X="";X=this.peekChar(j)==="*"?this.extract(j,this.consume,"*"):this.extract(j,this.consumeTill,y),this.consumeAttributeSpace(j);const Z=this.extract(j,this.consumeTill,y);let Ae;if(Z==="trr-int")Ae={type:Z,interval:this.extract(j,this.consumeTill)};else{const ct={type:Z};this.peekChar(j)===y&&(this.consumeAttributeSpace(j),ct.parameter=this.extract(j,this.consumeToken),this.peekChar(j)===y&&(ct.additional=this.extract(j,this.consumeTill))),Ae=ct}if(X==="*")this.attributes.rtcpFeedbackWildcards.push(Ae);else{const ct=this.attributes.payloads.find(ln=>ln.payloadType===parseInt(X,10));ct?ct.rtcpFeedbacks.push(Ae):this.attributes.payloads.push({payloadType:parseInt(X,10),rtcpFeedbacks:[Ae]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(j){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const X={port:this.extract(j,this.consumePort)};this.peekChar(j)===y&&(this.consumeAttributeSpace(j),X.netType=this.extractOneOrMore(j,x),this.consumeAttributeSpace(j),X.addressType=this.extractOneOrMore(j,x),this.consumeAttributeSpace(j),X.address=this.extract(j,this.consumeAddress)),this.attributes.rtcp=X}parseMsid(j){const X={id:this.extractOneOrMore(j,x,[1,64])};this.peekChar(j)===y&&(this.consumeAttributeSpace(j),X.appdata=this.extractOneOrMore(j,x,[1,64])),this.attributes.msids.push(X)}parseImageAttr(j){this.attributes.imageattr.push(j.attValue)}parseRid(j){const X=this.extractOneOrMore(j,Ae=>U(Ae)||w(Ae)||Ae==="_"||Ae==="-");this.consumeAttributeSpace(j);const Z={id:X,direction:this.extract(j,this.consumeToken),params:[]};if(this.peekChar(j)===y){if(this.consumeAttributeSpace(j),this.peek(j,"pt=")){this.extract(j,this.consume,"pt=");const Ae=[];for(;;){const ct=this.extract(j,this.consumeToken);Ae.push(ct);try{this.extract(j,this.consume,",")}catch{break}}Z.payloads=Ae,this.peekChar(j)===y&&this.extract(j,this.consume,y)}for(;;){const Ae=this.extract(j,this.consumeToken);switch(Ae){case"depend":{const ct={type:Ae,rids:this.extract(j,this.consume,"=").split(",")};Z.params.push(ct);break}default:{const ct={type:Ae};this.peekChar(j)==="="&&(this.extract(j,this.consume,"="),ct.val=this.extract(j,this.consumeTill,";")),Z.params.push(ct)}}try{this.extract(j,this.consume,";")}catch{break}}}this.attributes.rids.push(Z)}parseSimulcast(j){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=j.attValue,this.extract(j,this.consumeTill)}parseSctpPort(j){this.attributes.sctpPort=this.extractOneOrMore(j,w,[1,5])}parseMaxMessageSize(j){this.attributes.maxMessageSize=this.extractOneOrMore(j,w,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(j){this.attributes.mid=this.extract(j,this.consumeToken)}parseSSRCGroup(j){const X=this.extract(j,this.consumeToken),Z=[];for(;;)try{this.consumeAttributeSpace(j);const Ae=this.extract(j,this.consumeInteger);Z.push(parseInt(Ae,10))}catch{break}this.attributes.ssrcGroups.push({semantic:X,ssrcIds:Z})}}function nt(Se,j,X){return j in Se?Object.defineProperty(Se,j,{value:X,enumerable:!0,configurable:!0,writable:!0}):Se[j]=X,Se}class hn{constructor(){nt(this,"eol",g)}print(j,X){let Z="";return X&&(this.eol=X),Z+=this.printVersion(j.version),Z+=this.printOrigin(j.origin),Z+=this.printSessionName(j.sessionName),Z+=this.printInformation(j.information),Z+=this.printUri(j.uri),Z+=this.printEmail(j.emails),Z+=this.printPhone(j.phones),Z+=this.printConnection(j.connection),Z+=this.printBandwidth(j.bandwidths),Z+=this.printTimeFields(j.timeFields),Z+=this.printKey(j.key),Z+=this.printSessionAttributes(j.attributes),Z+=this.printMediaDescription(j.mediaDescriptions),Z}printVersion(j){return"v=".concat(j).concat(this.eol)}printOrigin(j){return"o=".concat(j.username," ").concat(j.sessId," ").concat(j.sessVersion," ").concat(j.nettype," ").concat(j.addrtype," ").concat(j.unicastAddress).concat(this.eol)}printSessionName(j){return j?"s=".concat(j).concat(this.eol):""}printInformation(j){return j?"i=".concat(j).concat(this.eol):""}printUri(j){return j?"u=".concat(j).concat(this.eol):""}printEmail(j){let X="";for(const Z of j)X+="e=".concat(Z).concat(this.eol);return X}printPhone(j){let X="";for(const Z of j)X+="e=".concat(Z).concat(this.eol);return X}printConnection(j){return j?"c=".concat(j.nettype," ").concat(j.addrtype," ").concat(j.address).concat(this.eol):""}printBandwidth(j){let X="";for(const Z of j)X+="b=".concat(Z.bwtype,":").concat(Z.bandwidth).concat(this.eol);return X}printTimeFields(j){let X="";for(const Z of j){X+="t=".concat(Z.time.startTime," ").concat(Z.time.startTime).concat(this.eol);for(const Ae of Z.repeats)X+="r=".concat(Ae.repeatInterval," ").concat(Ae.typedTimes.join(" ")).concat(this.eol);Z.zoneAdjustments&&(X+="z=",X+="z=".concat(Z.zoneAdjustments.map(Ae=>"".concat(Ae.time," ").concat(Ae.back?"-":""," ").concat(Ae.typedTime)).join(" ")).concat(this.eol),X+=this.eol)}return X}printKey(j){return j?"k=".concat(j).concat(this.eol):""}printAttributes(j){let X="";for(const Z of j)X+="a=".concat(Z.attField).concat(Z.attValue?":".concat(Z.attValue):"").concat(this.eol);return X}printMediaDescription(j){let X="";for(const Z of j)X+=this.printMedia(Z.media),X+=this.printInformation(Z.information),X+=this.printConnections(Z.connections),X+=this.printBandwidth(Z.bandwidths),X+=this.printKey(Z.key),X+=this.printMediaAttributes(Z);return X}printConnections(j){let X="";for(const Z of j)X+=this.printConnection(Z);return X}printMedia(j){return"m=".concat(j.mediaType," ").concat(j.port," ").concat(j.protos.join("/")," ").concat(j.fmts.join(" ")).concat(this.eol)}printSessionAttributes(j){return new ro(this.eol).print(j)}printMediaAttributes(j){return new be(this.eol).print(j)}}class en{constructor(j){nt(this,"eol",void 0),this.eol=j}printIceUfrag(j){return j===void 0?"":"a=ice-ufrag:".concat(j).concat(this.eol)}printIcePwd(j){return j===void 0?"":"a=ice-pwd:".concat(j).concat(this.eol)}printIceOptions(j){return j===void 0?"":"a=ice-options:".concat(j.join(y)).concat(this.eol)}printFingerprints(j){return j.length>0?j.map(X=>"a=fingerprint:".concat(X.hashFunction).concat(y).concat(X.fingerprint)).join(this.eol)+this.eol:""}printExtmap(j){return j.map(X=>"a=extmap:".concat(X.entry).concat(X.direction?"/".concat(X.direction):"").concat(y).concat(X.extensionName).concat(X.extensionAttributes?"".concat(y).concat(X.extensionAttributes):"").concat(this.eol)).join("")}printSetup(j){return j===void 0?"":"a=setup:".concat(j).concat(this.eol)}printUnrecognized(j){return j.map(X=>"a=".concat(X.attField).concat(X.attValue?":".concat(X.attValue):"").concat(this.eol)).join("")}}class ro extends en{print(j){let X="";return X+=this.printGroups(j.groups),X+=this.printMsidSemantic(j.msidSemantic),X+=this.printIceLite(j.iceLite),X+=this.printIceUfrag(j.iceUfrag),X+=this.printIcePwd(j.icePwd),X+=this.printIceOptions(j.iceOptions),X+=this.printFingerprints(j.fingerprints),X+=this.printSetup(j.setup),X+=this.printTlsId(j.tlsId),X+=this.printIdentity(j.identities),X+=this.printExtmap(j.extmaps),X+=this.printUnrecognized(j.unrecognized),X}printGroups(j){let X="";return j.length>0&&(X+=j.map(Z=>"a=group:".concat(Z.semantic).concat(Z.identificationTag.map(Ae=>"".concat(y).concat(Ae)).join("")).concat(this.eol)).join("")),X}printIceLite(j){return j===void 0?"":"a=ice-lite"+this.eol}printTlsId(j){return j?"a=tls-id:".concat(j).concat(this.eol):""}printIdentity(j){return j.length===0?"":j.map(X=>"a=identity:".concat(X.assertionValue).concat(X.extensions.map(Z=>"".concat(y).concat(Z.name).concat(Z.value?"=".concat(Z.value):"")))).join(this.eol)+this.eol}printMsidSemantic(j){if(!j)return"";let X="a=msid-semantic:".concat(j.semantic);return j.applyForAll?X+="".concat(y,"*"):j.identifierList.length>0&&(X+=j.identifierList.map(Z=>"".concat(y).concat(Z))),X+this.eol}}class be extends en{print(j){const X=j.attributes;let Z="";return Z+=this.printRTCP(X.rtcp),Z+=this.printIceUfrag(X.iceUfrag),Z+=this.printIcePwd(X.icePwd),Z+=this.printIceOptions(X.iceOptions),Z+=this.printCandidates(X.candidates),Z+=this.printRemoteCandidatesList(X.remoteCandidatesList),Z+=this.printEndOfCandidates(X.endOfCandidates),Z+=this.printFingerprints(X.fingerprints),Z+=this.printSetup(X.setup),Z+=this.printMid(X.mid),Z+=this.printExtmap(X.extmaps),Z+=this.printRTPRelated(X),Z+=this.printPtime(X.ptime),Z+=this.printMaxPtime(X.maxPtime),Z+=this.printDirection(X.direction),Z+=this.printSSRCGroups(X.ssrcGroups),Z+=this.printSSRC(X.ssrcs),Z+=this.printRTCPMux(X.rtcpMux),Z+=this.printRTCPMuxOnly(X.rtcpMuxOnly),Z+=this.printRTCPRsize(X.rtcpRsize),Z+=this.printMSId(X.msids),Z+=this.printImageattr(X.imageattr),Z+=this.printRid(X.rids),Z+=this.printSimulcast(X.simulcast),Z+=this.printSCTPPort(X.sctpPort),Z+=this.printMaxMessageSize(X.maxMessageSize),Z+=this.printUnrecognized(X.unrecognized),Z}printCandidates(j){return j.map(X=>"a=candidate:".concat(X.foundation).concat(y).concat(X.componentId).concat(y).concat(X.transport).concat(y).concat(X.priority).concat(y).concat(X.connectionAddress).concat(y).concat(X.port).concat(y,"typ").concat(y).concat(X.type).concat(X.relAddr?"".concat(y,"raddr").concat(y).concat(X.relAddr):"").concat(X.relPort?"".concat(y,"rport").concat(y).concat(X.relPort):"").concat(Object.keys(X.extension).map(Z=>"".concat(y).concat(Z).concat(y).concat(X.extension[Z])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(j){return j.map(X=>"a=remote-candidates:".concat(X.join(y)).concat(this.eol)).join("")}printEndOfCandidates(j){return j===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(j){if(!j.payloads)return"";const X=j.payloads;let Z="";Z+=j.rtcpFeedbackWildcards.map(Ae=>this.printRTCPFeedback("*",Ae)).join("");for(const Ae of X)Z+=this.printRtpMap(Ae.payloadType,Ae.rtpMap),Z+=this.printFmtp(Ae.payloadType,Ae.fmtp),Z+=Ae.rtcpFeedbacks.map(ct=>this.printRTCPFeedback(Ae.payloadType,ct)).join("");return Z}printFmtp(j,X){if(!X)return"";const Z=Object.keys(X.parameters);return Z.length===1&&X.parameters[Z[0]]===null?"a=fmtp:".concat(j).concat(y).concat(Z[0]).concat(this.eol):"a=fmtp:".concat(j).concat(y).concat(Object.keys(X.parameters).map(Ae=>"".concat(Ae,"=").concat(X.parameters[Ae])).join(";")).concat(this.eol)}printRtpMap(j,X){return X?"a=rtpmap:".concat(j).concat(y).concat(X.encodingName,"/").concat(X.clockRate).concat(X.encodingParameters?"/".concat(X.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(j,X){let Z="a=rtcp-fb:".concat(j).concat(y),Ae=X;return Ae.type==="trr-int"?Z+="ttr-int".concat(y).concat(Ae.interval):(Z+="".concat(Ae.type),Ae.parameter&&(Z+="".concat(y).concat(Ae.parameter),Ae.additional&&(Z+="".concat(y).concat(Ae.additional)))),Z+this.eol}printPtime(j){return j===void 0?"":"a=ptime:".concat(j).concat(this.eol)}printMaxPtime(j){return j===void 0?"":"a=maxptime:".concat(j).concat(this.eol)}printDirection(j){return j===void 0?"":"a=".concat(j).concat(this.eol)}printSSRC(j){return j.map(X=>Object.keys(X.attributes).map(Z=>"a=ssrc:".concat(X.ssrcId.toString(10)).concat(y).concat(Z).concat(X.attributes[Z]?":".concat(X.attributes[Z]):"").concat(this.eol)).join("")).join("")}printRTCPMux(j){return j===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(j){return j===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(j){return j===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(j){if(j===void 0)return"";let X="a=rtcp:".concat(j.port);return j.netType&&(X+="".concat(y).concat(j.netType)),j.addressType&&(X+="".concat(y).concat(j.addressType)),j.address&&(X+="".concat(y).concat(j.address)),X+this.eol}printMSId(j){return j.map(X=>"a=msid:".concat(X.id).concat(X.appdata?"".concat(y).concat(X.appdata):"").concat(this.eol)).join("")}printImageattr(j){return j.map(X=>"a=imageattr:".concat(X).concat(this.eol)).join("")}printRid(j){return j.map(X=>{let Z="a=rid:".concat(X.id).concat(y).concat(X.direction);return X.payloads&&(Z+="".concat(y,"pt=").concat(X.payloads.join(","))),X.params.length>0&&(Z+="".concat(y).concat(X.params.map(Ae=>Ae.type==="depend"?"depend=".concat(Ae.rids.join(",")):"".concat(Ae.type,"=").concat(Ae.val)).join(";"))),Z+this.eol}).join("")}printSimulcast(j){return j===void 0?"":"a=simulcast:".concat(j).concat(this.eol)}printSCTPPort(j){return j===void 0?"":"a=sctp-port:".concat(j).concat(this.eol)}printMaxMessageSize(j){return j===void 0?"":"a=max-message-size:".concat(j).concat(this.eol)}printMid(j){return j===void 0?"":"a=mid:".concat(j).concat(this.eol)}printSSRCGroups(j){return j.map(X=>"a=ssrc-group:".concat(X.semantic).concat(X.ssrcIds.map(Z=>"".concat(y).concat(Z.toString(10))).join("")).concat(this.eol)).join("")}}function Oe(Se){return new xe().parse(Se)}function Ve(Se,j){return new hn().print(Se,j)}}},o={};function s(c){if(o[c])return o[c].exports;var u=o[c]={exports:{}};return r[c](u,u.exports,s),u.exports}return s.d=(c,u)=>{for(var h in u)s.o(u,h)&&!s.o(c,h)&&Object.defineProperty(c,h,{enumerable:!0,get:u[h]})},s.o=(c,u)=>Object.prototype.hasOwnProperty.call(c,u),s.r=c=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},s(8)})();function ho(r){return K8.parse(r)}function hd(r,o){return K8.print(r,o)}var QOe=ia("Array","keys"),ZOe=td,eIe=bi,tIe=T,nIe=QOe,O1=Array.prototype,rIe={DOMTokenList:!0,NodeList:!0},iIe=function(r){var o=r.keys;return r===O1||tIe(O1,r)&&o===O1.keys||eIe(rIe,ZOe(r))?nIe:o},ts=a(iIe);function Dn(r,o,s){return(o=function(c){var u=function(h,p){if(typeof h!="object"||!h)return h;var g=h[Symbol.toPrimitive];if(g!==void 0){var y=g.call(h,"string");if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(h)}(c);return typeof u=="symbol"?u:u+""}(o))in r?Object.defineProperty(r,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[o]=s,r}function z8(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function dt(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?z8(Object(s),!0).forEach(function(c){Dn(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):z8(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}const Y8=new class extends An{constructor(){super(...arguments),Dn(this,"currentUploadLogID",0)}reportLogUploadError(r){const{errorRange:o}=r;o[o.length-1]&&o[o.length-1]>this.currentUploadLogID&&(this.currentUploadLogID=o[o.length-1],this.emit("REPORT_LOG_UPLOAD",r))}};class oIe{constructor(o){Dn(this,"logger",void 0),Dn(this,"prefixLists",[]),this.logger=o}debug(){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];this.logger.debug(...this.prefixLists,...s)}info(){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];this.logger.info(...this.prefixLists,...s)}warning(){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];this.logger.warning(...this.prefixLists,...s)}error(){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];this.logger.error(...this.prefixLists,...s)}prefix(o){return this.prefixLists.push(o),this}popPrefix(){return this.prefixLists.pop(),this}}function I1(){const r=new Date;return r.toTimeString().split(" ")[0]+":"+r.getMilliseconds()}function q8(){const r=new Date,o=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return o?(o==null?void 0:o[0])+":"+r.getUTCMilliseconds():r.toTimeString().split(" ")[0]+":"+r.getMilliseconds()}const Ps={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},$w=Date.now(),h_=r=>{for(const o in Ps)if(Object.prototype.hasOwnProperty.call(Ps,o)&&Ps[o]===r)return o;return"DEFAULT"},L=new class{constructor(){Dn(this,"proxyServerURL",void 0),Dn(this,"logLevel",Ps.DEBUG),Dn(this,"uploadState","collecting"),Dn(this,"uploadLogWaitingList",[]),Dn(this,"uploadLogUploadingList",[]),Dn(this,"uploadErrorCount",0),Dn(this,"currentLogID",0),Dn(this,"url",void 0),Dn(this,"extLog",(r,o)=>{this.appendLogToWaitingList(r,...o)})}debug(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];const c=[Ps.DEBUG].concat(o);this.log.apply(this,c)}info(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];const c=[Ps.INFO].concat(o);this.log.apply(this,c)}warning(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];const c=[Ps.WARNING].concat(o);this.log.apply(this,c)}warn(){this.warning(...arguments)}error(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];const c=[Ps.ERROR].concat(o);this.log.apply(this,c)}upload(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];const c=[Ps.DEBUG].concat(o);this.uploadLog.apply(this,c)}setLogLevel(r){r=Math.min(Math.max(0,r),4),this.logLevel=r}enableLogUpload(){Yt("UPLOAD_LOG",!0)}disableLogUpload(){Yt("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(r){this.proxyServerURL=r}prefix(r){return new oIe(this).prefix(r)}log(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];if(Date.now()-$w<100)return void setTimeout(()=>{this.log(...o)},Date.now()-$w);const c=Math.max(0,Math.min(4,o[0]));if(o[0]=I1()+" Agora-SDK [".concat(h_(c),"]:"),this.appendLogToWaitingList(c,...o),c<this.logLevel)return;const u=I1()+" %cAgora-SDK [".concat(h_(c),"]:");let h=[];if(!q("USE_NEW_LOG"))switch(c){case Ps.DEBUG:h=[u,"color: #64B5F6;"].concat(o.slice(1)),console.log.apply(console,h);break;case Ps.INFO:h=[u,"color: #1E88E5; font-weight: bold;"].concat(o.slice(1)),console.log.apply(console,h);break;case Ps.WARNING:h=[u,"color: #FB8C00; font-weight: bold;"].concat(o.slice(1)),console.warn.apply(console,h);break;case Ps.ERROR:h=[u,"color: #B00020; font-weight: bold;"].concat(o.slice(1)),console.error.apply(console,h)}}uploadLog(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];if(Date.now()-$w<100)return void setTimeout(()=>{this.uploadLog(...o)},Date.now()-$w);const c=Math.max(0,Math.min(4,o[0]));o[0]=I1()+" Agora-SDK [".concat(h_(c),"]:"),this.appendLogToWaitingList(c,...o)}appendLogToWaitingList(r){if(!q("UPLOAD_LOG"))return;for(var o=arguments.length,s=new Array(o>1?o-1:0),c=1;c<o;c++)s[c-1]=arguments[c];Array.isArray(s[0])?s[0][0]=q8()+" Agora-SDK [".concat(h_(r),"]:"):s[0]=q8()+" Agora-SDK [".concat(h_(r),"]:");let u="";s.forEach(h=>{typeof h=="object"&&(h=JSON.stringify(h)),u+="".concat(h," ")}),this.uploadLogWaitingList.push({payload_str:u,log_level:r,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const r=this.uploadLogUploadingList,o={sdk_version:xs,process_id:q("PROCESS_ID"),payload:JSON.stringify(r)};return nc(async()=>{const s=await Qi.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(q("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(q("LOG_UPLOAD_SERVER"),"/upload/v1")),o,{responseType:"text"});if(s.data!=="OK"){const c=new Error("unexpected upload log response");throw c.response=s,c}},()=>(this.uploadLogUploadingList=[],!1),s=>{const c={status:-1,message:s.message,errorRange:r.map(u=>u.log_item_id)};return s.response?(c.status=s.response.status,c.data=s.response.data,c.headers=s.response.headers):s.request&&(c.status=s.request.status),Y8.reportLogUploadError(c),!0},{timeout:q("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:q("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,q("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),q("UPLOAD_LOG_INTERVAL"))}).catch(r=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),q("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),q("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}};var X8;function sIe(r){return Hr(r.reportId,"params.reportId",0,100,!1),Hr(r.category,"params.category",0,100,!1),Hr(r.event,"params.event",0,100,!1),Hr(r.label,"params.label",0,100,!1),Qt(r.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}(X8={}).FREE="free",X8.UPLOADING="uploading",function(r){r[r.MISC=0]="MISC",r[r.INTERNAL_EVENT=1]="INTERNAL_EVENT",r[r.PUBLIC_EVENT=2]="PUBLIC_EVENT",r[r.WEB_EVENT=3]="WEB_EVENT",r[r.INTERNAL_API=4]="INTERNAL_API",r[r.WEB_API=5]="WEB_API",r[r.PUBLIC_API=6]="PUBLIC_API"}({});const aIe={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let Ar=function(r){return r.PUBLISH="publish",r.SUBSCRIBE="subscribe",r.WS_COMPRESSOR_INIT="ws_compressor_init",r.SESSION_INIT="session_init",r.JOIN_CHOOSE_SERVER="join_choose_server",r.REQ_USER_ACCOUNT="req_user_account",r.JOIN_GATEWAY="join_gateway",r.REJOIN_GATEWAY="rejoin_gateway",r.STREAM_SWITCH="stream_switch",r.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",r.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",r.FIRST_VIDEO_RECEIVED="first_video_received",r.FIRST_AUDIO_RECEIVED="first_audio_received",r.FIRST_VIDEO_DECODE="first_video_decode",r.FIRST_AUDIO_DECODE="first_audio_decode",r.ON_ADD_AUDIO_STREAM="on_add_audio_stream",r.ON_ADD_VIDEO_STREAM="on_add_video_stream",r.ON_UPDATE_STREAM="on_update_stream",r.ON_REMOVE_STREAM="on_remove_stream",r.USER_ANALYTICS="req_user_analytics",r.PC_STATS="pc_stats",r.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities",r.AB_TEST="ab_test",r}({}),Tn=function(r){return r.SESSION="io.agora.pb.Wrtc.Session",r.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",r.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",r.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",r.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",r.PUBLISH="io.agora.pb.Wrtc.Publish",r.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",r.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",r.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",r.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",r.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",r.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",r.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",r.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",r.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",r.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",r.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",r.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",r.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",r.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",r.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",r.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",r.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",r.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",r.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",r.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",r.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",r.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",r.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",r.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",r.PC_STATS="io.agora.pb.Wrtc.PCStats",r.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities",r.AB_TEST="io.agora.pb.Wrtc.ABTest",r}({});(function(r){r[r.WORKER_EVENT=156]="WORKER_EVENT",r[r.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"})({});let cIe=function(r){return r[r.SESSION=26]="SESSION",r[r.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",r[r.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",r[r.JOIN_GATEWAY=28]="JOIN_GATEWAY",r[r.PUBLISH=30]="PUBLISH",r[r.SUBSCRIBE=29]="SUBSCRIBE",r[r.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",r[r.STREAM_SWITCH=32]="STREAM_SWITCH",r[r.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",r[r.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",r[r.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",r[r.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",r[r.API_INVOKE=41]="API_INVOKE",r[r.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",r[r.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",r[r.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",r[r.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",r[r.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",r[r.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",r[r.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",r[r.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",r[r.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",r[r.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",r[r.WORKER_EVENT=156]="WORKER_EVENT",r[r.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",r[r.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",r[r.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",r[r.USER_ANALYTICS=1e4]="USER_ANALYTICS",r[r.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED",r}({});function Qe(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(o,s,c){const u=c.value;if(typeof u=="function"){const h=r.className||o.__className__||(o.constructor.name==="AgoraRTCClient"?"Client":o.constructor.name);c.value=function(){for(var p,g=arguments.length,y=new Array(g),b=0;b<g;b++)y[b]=arguments[b];let w=y;if(r.argsMap)try{w=r.argsMap(this,...y)}catch(A){L.warning(A),w=[]}try{JSON.stringify(w)}catch{L.warning("arguments for method ".concat(h,".").concat(String(s)," not serializable for apiInvoke.")),w=[]}const C=(r.report||We).reportApiInvoke(this._sessionId||null,{id:this._clientId||((p=this.store)===null||p===void 0?void 0:p.clientId)||this._ID,name:"".concat(h,".").concat(String(s)),options:w,tag:Nn.TRACER,reportResult:r.reportResult},r.throttleTime);try{const A=u.apply(this,y);return A instanceof De?A.then(x=>(C.onSuccess(r.reportResult&&x),x)).catch(x=>{throw C.onError(x),x}):(C.onSuccess(r.reportResult&&A),A)}catch(A){throw C.onError(A),A}}}return c}}const We=new class{constructor(){Dn(this,"baseInfoMap",new Map),Dn(this,"proxyServer",void 0),Dn(this,"eventUploadTimer",void 0),Dn(this,"setSessionIdTimer",void 0),Dn(this,"url",void 0),Dn(this,"sids",new Set),Dn(this,"backupUrl",void 0),Dn(this,"_appId",void 0),Dn(this,"_aid",0),Dn(this,"keyEventUploadPendingItems",[]),Dn(this,"normalEventUploadPendingItems",[]),Dn(this,"apiInvokeUploadPendingItems",[]),Dn(this,"apiInvokeCount",0),Dn(this,"apiInvokeLoggedCount",0),Dn(this,"ltsList",[]),Dn(this,"lastSendNormalEventTime",Date.now()),Dn(this,"customReportCounterTimer",void 0),Dn(this,"customReportCount",0),Dn(this,"extApiInvoke",async r=>{for(const o of r){const s=dt(dt({},o),{},{sid:null,invokeId:++this.apiInvokeCount,tag:Nn.TRACER});this.sendApiInvoke(s)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),q("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),q("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(r){return this.baseInfoMap.get(r)}setAppId(r){this._appId=r,this._aid=parseInt(r.replace(/[a-fA-F0-9]{8}/g,o=>{let[s,c]=o;return s+c}),16)||0}reportApiInvoke(r,o,s){o.timeout=o.timeout||6e4,o.reportResult=o.reportResult===void 0||o.reportResult;const c=Date.now();this.apiInvokeCount+=1;const u=this.apiInvokeCount,h=!!q("SHOW_REPORT_INVOKER_LOG"),p=!!q("SHOW_REPORT_USER_INVOKER_LOG"),g=h||p&&o.id;g&&(this.apiInvokeLoggedCount+=1);const y=this.apiInvokeLoggedCount;function b(x,B){if(g){let U="[apiInvoke-".concat(y,"]");if(o.id&&(U+="[".concat(o.id,"]")),o.name&&(U+="[".concat(o.name,"]"),o.name===Yn.JOIN))return L.info("".concat(U," ").concat(x));L.info("".concat(U," ").concat(x),x==="start"?o.options:B||"")}}const w=()=>({tag:o.tag,invokeId:u,sid:r,name:o.name,apiInvokeTime:c,options:o.options,states:o.states||null});b("start");let C=!1;Kr(o.timeout).then(()=>{C||(this.sendApiInvoke(dt(dt({},w()),{},{error:Y.API_INVOKE_TIMEOUT,success:!1})),b("timeout"))});const A=new ve(Y.UNEXPECTED_ERROR,"".concat(o.name,": this api invoke is end"));return{onSuccess:x=>{const B=()=>{if(C)throw A;return C=!0,this.sendApiInvoke(dt(dt({},w()),{},{success:!0},o.reportResult&&{result:x})),b("onSuccess"),x};return s?I8(B,o.name+"Success",s,()=>C=!0):B()},onError:x=>{const B=()=>{if(C)throw x;C=!0,this.sendApiInvoke(dt(dt({},w()),{},{success:!1,error:x})),b("onFailure",x.toString())};return s?I8(B,o.name+"Error",s,()=>C=!0):B()}}}sessionInit(r,o){if(this.baseInfoMap.has(r))return;const s=Date.now(),c=this.createBaseInfo(r,s);c.cname=o.cname;const u=Object.assign({},{willUploadConsoleLog:q("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:T1?"global":"oversea",areas:q("AREAS")&&q("AREAS").join(",")},o.extend),{stringUid:h,channelProfile:p,channelMode:g,isABTestSuccess:y,lsid:b,clientRole:w}=o,C=Date.now(),A=dt(dt({},c),{},{eventType:Ar.SESSION_INIT,appid:o.appid,browser:navigator.userAgent,buildFormat:o.buildFormat,build:R1,lts:C,elapse:C-s,extend:JSON.stringify(u),mode:o.mode,process:q("PROCESS_ID"),appType:q("APP_TYPE"),success:!0,version:xs,stringUid:h,channelProfile:p,channelMode:g,isABTestSuccess:y,lsid:b,clientType:Pe(x=window.navigator.userAgent).call(x,"AgoraWebView")?42:20,clientRole:w,serviceId:q("PROCESS_ID"),extensionID:q("PLUGIN_INFO").join(",")||""});var x;this.send({type:Tn.SESSION,data:A},!0)}joinChooseServer(r,o){const s=this.baseInfoMap.get(r);if(!s)return;const c=s.info,u=Date.now(),h=dt(dt({},c),{},{role:o.role,eventType:Ar.JOIN_CHOOSE_SERVER,lts:u,eventElapse:o.elapse||u-o.lts,chooseServerAddr:o.csAddr,errorCode:o.ec,elapse:u-s.startTime,success:o.succ,chooseServerAddrList:JSON.stringify(o.serverList),uid:o.uid?parseInt(o.uid):null,cid:o.cid?parseInt(o.cid):null,chooseServerIp:o.csIp||"",opid:o.opid,unilbsServerIds:o.unilbsServerIds,extend:o.extend||void 0,isHttp3:o.isHttp3,corssRegionTagReq:o.corssRegionTagReq||void 0,corssRegionTagRes:o.corssRegionTagRes||void 0});this.send({type:Tn.JOIN_CHOOSE_SERVER,data:h},!0)}reqUserAccount(r,o){const s=this.baseInfoMap.get(r);if(!s)return;const c=s.info,u=Date.now(),h=dt(dt({},c),{},{eventType:Ar.REQ_USER_ACCOUNT,lts:u,success:o.success,serverAddress:o.serverAddr,stringUid:o.stringUid,uid:o.uid,errorCode:o.errorCode,elapse:o.elapse||u-s.startTime,eventElapse:u-o.lts,extend:JSON.stringify(o.extend)});this.send({type:Tn.REQ_USER_ACCOUNT,data:h},!0)}joinGateway(r,o){const s=this.baseInfoMap.get(r);if(!s)return;const c=s.info;o.vid&&(c.vid=o.vid),c.uid=o.uid,c.cid=o.cid;const u=Date.now(),{firstSuccess:h,addr:p,isProxy:g}=o,y=u-s.startTime,b=dt(dt({},c),{},{eventType:Ar.JOIN_GATEWAY,lts:u,gatewayAddr:o.addr,success:o.succ,errorCode:o.ec,errorMsg:o.errorMsg||"",elapse:y,eventElapse:u-o.lts,firstSuccess:h,signalChannel:o.signalChannel,preload:o.preload?1:0,installId:w1(),isABTestSuccess:o.isABTestSuccess?1:0}),w=b.success?1:0;if(o.succ&&(s.lastJoinSuccessTime=u),h)this.send({type:Tn.JOIN_GATEWAY,data:b},!0);else{let C;if(p)if(g){const x=p.match(/h=(\d{1,3}-){3}\d{1,3}/g),B=p.match(/p=[0-9]{1,6}/g);C={isSuccess:w,gatewayIp:x&&x.length?x[0].split("=")[1].replace(/-/g,"."):"",port:B&&B.length?B[0].split("=")[1]:"",isProxy:g?1:0}}else{const x=p.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),B=p.match(/(:|p=)[0-9]{1,6}/g);C={isSuccess:w,gatewayIp:x&&x.length?x[0].split("//")[1].replace(/-/g,"."):"",port:B&&B.length?B[0].split(/:|p=/g)[1]:"",isProxy:g?1:0}}else C={isSuccess:w,gatewayIp:"",port:"",isProxy:g?1:0};delete b.success,delete b.eventType,delete b.firstSuccess,b.vid=Number(b.vid);const A=Object.assign({},b,C,{eventType:Ar.REJOIN_GATEWAY});this.send({type:Tn.RE_JOIN_GATEWAY,data:A},!0)}}joinChannelTimeout(r,o){const s=this.baseInfoMap.get(r);if(!s)return;const c=Date.now(),u=dt(dt({},s.info),{},{lts:c,timeout:o,elapse:c-s.startTime});this.send({type:Tn.JOIN_CHANNEL_TIMEOUT,data:u},!0)}publish(r,o){const s=this.baseInfoMap.get(r);if(!s)return;const c=s.info,u=Date.now(),h=dt(dt({},c),{},{eventType:Ar.PUBLISH,lts:u,eventElapse:o.eventElapse,elapse:u-s.startTime,success:o.succ,errorCode:o.ec,videoName:o.videoName,audioName:o.audioName,screenName:o.screenName,screenshare:o.screenshare,audio:o.audio,video:o.video,p2pid:o.p2pid,publishRequestid:o.publishRequestid});this.send({type:Tn.PUBLISH,data:h},!0)}subscribe(r,o,s){const c=this.baseInfoMap.get(r);if(!c)return;const u=c.info,h=Date.now(),p=dt(dt({},u),{},{eventType:Ar.SUBSCRIBE,lts:h,eventElapse:o.eventElapse,elapse:h-c.startTime,success:o.succ,errorCode:o.ec,video:o.video,audio:o.audio,subscribeRequestid:o.subscribeRequestid,p2pid:o.p2pid,preSsrc:o.preSsrc?1:0},s&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof o.peerid=="string"?p.peerSuid=o.peerid:p.peer=o.peerid,this.send({type:Tn.SUBSCRIBE,data:p},!0)}wsCompressorInit(r){var o;const s=[...ts(o=this.baseInfoMap).call(o)],c=s.length?s[0]:"UnableToGetSid",u=this.baseInfoMap.get(c);if(!u)return;const h=u.info,p=Date.now(),g=dt(dt({},h),{},{eventType:Ar.WS_COMPRESSOR_INIT,lts:p,eventElapse:r.eventElapse,elapse:p-u.startTime,status:r.status?1:2});this.send({type:Tn.WS_COMPRESSOR_INIT,data:g},!0)}firstRemoteVideoDecode(r,o,s,c){const u=this.baseInfoMap.get(r);if(!u)return;const h=u.info,p=Date.now(),g=dt(dt(dt({},h),c),{},{elapse:p-u.startTime,eventType:o,lts:p,firstDecodeFrame:Math.max((c.firstFrame||p)-u.startTime,0),apEnd:Math.max(c.apEnd-u.startTime,0),apStart:Math.max(c.apStart-u.startTime,0),joinGwEnd:Math.max(c.joinGwEnd-u.startTime,0),joinGwStart:Math.max(c.joinGwStart-u.startTime,0),pcEnd:Math.max(c.pcEnd-u.startTime,0),pcStart:Math.max(c.pcStart-u.startTime,0),subscriberEnd:Math.max(c.subscriberEnd-u.startTime,0),subscriberStart:Math.max(c.subscriberStart-u.startTime,0),videoAddNotify:Math.max(c.videoAddNotify-u.startTime,0)});this.send({type:s,data:g},!0)}firstRemoteFrame(r,o,s,c){const u=this.baseInfoMap.get(r);if(!u)return;const h=u.info,p=Date.now(),g=dt(dt(dt({},h),c),{},{elapse:p-u.startTime,eventType:o,lts:p});this.send({type:s,data:g},!0)}abTest(r,o){const s=this.baseInfoMap.get(r);if(!s)return;const c=s.info,u=Date.now(),h=dt(dt(dt({},c),o),{},{vid:c.vid===void 0?0:Number(c.vid),elapse:u-s.startTime,eventType:Ar.AB_TEST,lts:u});this.send({type:Tn.AB_TEST,data:h},!0)}pcStats(r,o){const s=this.baseInfoMap.get(r);if(!s)return;const c=s.info,u=Date.now(),h=dt(dt(dt({},c),o),{},{vid:c.vid===void 0?0:Number(c.vid),elapse:u-s.startTime,eventType:Ar.PC_STATS,lts:u,preallocation:o.preallocation?1:0});this.send({type:Tn.PC_STATS,data:h},!0)}updateRemoteRTPCapabilities(r,o){if(r){const s=this.baseInfoMap.get(r);if(!s)return;const c=s.info,u=Date.now(),h=dt(dt(dt({},c),o),{},{vid:c.vid===void 0?0:Number(c.vid),eventType:Ar.UPDATE_REMOTE_RTPCAPABILITIES,lts:u});this.send({type:Tn.UPDATE_REMOTE_RTPCAPABILITIES,data:h},!0)}}onGatewayStream(r,o,s,c){const u=this.baseInfoMap.get(r);if(!u)return;const h=u.info,p=Date.now(),g=dt(dt(dt({},h),c),{},{eventType:o,lts:p});this.send({type:s,data:g},!0)}streamSwitch(r,o){const s=this.baseInfoMap.get(r);if(!s)return;const c=s.info,u=Date.now(),h=dt(dt({},c),{},{eventType:Ar.STREAM_SWITCH,lts:u,isDual:o.isdual,elapse:u-s.startTime,success:o.succ});this.send({type:Tn.STREAM_SWITCH,data:h},!0)}requestProxyAppCenter(r,o){const s=this.baseInfoMap.get(r);if(!s)return;const c=s.info,u=Date.now(),h=dt(dt({},c),{},{eventType:Ar.REQUEST_PROXY_APPCENTER,lts:u,eventElapse:u-o.lts,elapse:u-s.startTime,APAddr:o.APAddr,workerManagerList:o.workerManagerList,response:o.response,errorCode:o.ec,success:o.succ});this.send({type:Tn.REQUEST_PROXY_APPCENTER,data:h},!0)}requestProxyWorkerManager(r,o){const s=this.baseInfoMap.get(r);if(!s)return;const c=s.info,u=Date.now(),h=dt(dt({},c),{},{eventType:Ar.REQUEST_PROXY_WORKER_MANAGER,lts:u,eventElapse:u-o.lts,elapse:u-s.startTime,workerManagerAddr:o.workerManagerAddr,response:o.response,errorCode:o.ec,success:o.succ});this.send({type:Tn.REQUEST_PROXY_WORKER_MANAGER,data:h},!0)}setProxyServer(r){this.proxyServer=r,r?L.debug("reportProxyServerurl: ".concat(r)):L.debug("disable reportProxyServerurl: ".concat(r))}peerPublishStatus(r,o){const s=this.baseInfoMap.get(r);if(!s)return;const c=s.info,u=Date.now(),h=dt(dt({},c),{},{subscribeElapse:o.subscribeElapse,peer:o.peer,peerPublishDuration:Math.max(o.audioPublishDuration,o.videoPublishDuration),audiotag:o.audioPublishDuration>0?1:-1,videotag:o.videoPublishDuration>0?1:-1,lts:u,elapse:u-s.startTime,joinChannelSuccessElapse:u-(s.lastJoinSuccessTime||u),peerPublishDurationVideo:o.videoPublishDuration,peerPublishDurationAudio:o.audioPublishDuration});this.send({type:Tn.PEER_PUBLISH_STATUS,data:h},!0)}workerEvent(r,o){const s=this.baseInfoMap.get(r);if(!s)return;const c=s.info,u=Date.now();(function(h,p,g){const y=h[p];if(!y||typeof y!="string")return[h];h[p]="";const b=zc(JSON.stringify(h));let w=0;const C=[];let A=0;for(let x=0;x<y.length;x++)A+=y.charCodeAt(x)<=127?1:3,A<=g-b||(C[C.length]=Ue(Ue({},h),{},{[p]:y.substring(w,x)}),w=x,A=y.charCodeAt(x)<=127?1:3);return w!==y.length-1&&(C[C.length]=Ue(Ue({},h),{},{[p]:y.substring(w)})),C})(dt(dt(dt({},c),o),{},{elapse:u-s.startTime,lts:u,productType:"WebRTC"}),"payload",1300).forEach(h=>this.send({type:Tn.WORKER_EVENT,data:h},!0))}apworkerEvent(r,o){const s=this.baseInfoMap.get(r);if(!s)return;const c=s.info,u=Date.now(),h=dt(dt(dt({},c),o),{},{elapse:u-s.startTime,lts:u});this.send({type:Tn.AP_WORKER_EVENT,data:h},!0)}joinWebProxyAP(r,o){const s=this.baseInfoMap.get(r);if(!s)return;const c=s.info,u=Date.now(),h=dt(dt(dt({},c),o),{},{elapse:u-s.startTime,lts:u,extend:o.extend||void 0});this.send({type:Tn.JOIN_WEB_PROXY_AP,data:h},!0)}WebSocketQuit(r,o){const s=this.baseInfoMap.get(r);if(!s)return;const c=s.info,u=Date.now(),h=dt(dt(dt({},c),o),{},{elapse:u-s.startTime,lts:u});this.send({type:Tn.WEBSOCKET_QUIT,data:h},!0)}async sendCustomReportMessage(r,o){if(this.customReportCount+=o.length,this.customReportCount>q("CUSTOM_REPORT_LIMIT"))throw new ve(Y.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const s=Date.now(),c=o.map(u=>({type:Tn.USER_ANALYTICS,data:dt(dt({sid:r},u),{},{lts:s})}));try{q("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(c):await this.postDataToStatsCollector(c)}catch(u){throw L.error("send custom report message failed",u.toString()),new ve(Y.CUSTOM_REPORT_SEND_FAILED,u.message)}}sendApiInvoke(r){const o=q("NOT_REPORT_EVENT");if(r.tag&&Pe(o)&&Pe(o).call(o,r.tag))return!1;if(r.sid===null)return this.apiInvokeUploadPendingItems.push(r),!1;const s=this.baseInfoMap.get(r.sid);if(!s)return this.apiInvokeUploadPendingItems.push(r),!1;const{cname:c,uid:u,cid:h}=s.info;let p;if(r.lts=r.lts||Date.now(),r.error)if(r.error instanceof ve){const{code:y,message:b}=r.error;p=y||b||r.error.toString()}else p=r.error.toString();const g={invokeId:r.invokeId,sid:r.sid,cname:c,cid:h,uid:u,lts:r.lts,success:r.success,elapse:r.lts-s.startTime,execElapse:r.lts-r.apiInvokeTime,apiName:r.name,options:r.options?JSON.stringify(r.options):void 0,execStates:r.states?JSON.stringify(r.states):void 0,execResult:r.result?JSON.stringify(r.result):void 0,errorCode:r.error?p:void 0,errorMsg:r.error?JSON.stringify(r.error):void 0};return this.send({type:Tn.API_INVOKE,data:g},!1),!0}addSid(r){this.sids.add(r)}removeSid(r){this.sids.delete(r)}appendSessionId(){const r=this.apiInvokeUploadPendingItems;if(r.length===0)return;const o=Array.from(this.sids).find(s=>s!==null);o&&r.forEach(s=>{s&&(s.sid=o,this.sendApiInvoke(Object.assign({},s)))}),r.length=0}send(r,o){if(o)return this.keyEventUploadPendingItems.push(r),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(r),this.normalEventUploadPendingItems.length>q("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(r,o){const s=[],c=[];for(;r.length;){const h=r.shift();s.length<20?s.push(h):c.push(h)}r.push(...c);for(const h of[...s]){var u;this.ltsList.indexOf(h.data.lts)!==-1?(h.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(h.data.lts)):(this.ltsList.push(h.data.lts),Yh(u=this.ltsList).call(u,(p,g)=>p-g))}return o||(this.lastSendNormalEventTime=Date.now()),q("ENABLE_EVENT_REPORT")&&s.length&&(q("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(s):this.postDataToStatsCollector(s)).catch((h=>p=>{q("EVENT_REPORT_RETRY")&&(o?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(h):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(h),this.normalEventUploadPendingItems.length>q("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-q("NORMAL_EVENT_QUEUE_CAPACITY")),L.warning("report: drop normal events"))))})(s)),r}async postDataToStatsCollector2(r){qn.networkState===Do.OFFLINE&&await De.race([qn.onlineWaiter,Kr(2*rr.maxRetryTimeout)]);const o=u=>{let h=new Uint8Array;return u.forEach(p=>{const g=u1(JSON.stringify(p.data)),y=new ArrayBuffer(5),b=(C=>{let A=0;return Object.entries(Tn).forEach(x=>{let[B,U]=x;U===C.type&&(A=cIe[B])}),A})(p),w=new DataView(y);w.setUint16(0,g.byteLength,!0),w.setUint8(2,255&b),w.setUint8(3,b>>>8&255),w.setUint8(4,b>>>16&255),h=E8(h,new Uint8Array(y)),h=E8(h,g)}),h},s="event";let c=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(q("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(s):"https://".concat(q("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(s);for(let u=0;u<2;u+=1){u===1&&(c=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(q("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(s):"https://".concat(q("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(s));try{await y1(c,{timeout:1e4,data:o(r),headers:dt(dt({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(h){if(u===1)throw h;continue}return}}async postDataToStatsCollector(r){let o=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=(g=>{const y=g&&g.data.sid&&this.baseInfoMap.get(g.data.sid);return y&&y.info.vid&&+y.info.vid||0})(r[0]),c=s?void 0:this._aid,u={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:r.map(g=>JSON.stringify(g)),vid:s,aid:c};qn.networkState===Do.OFFLINE&&await De.race([qn.onlineWaiter,Kr(2*rr.maxRetryTimeout)]);const h=o?"/events/proto-raws":"/events/messages";let p=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(q("EVENT_REPORT_DOMAIN"),"&p=").concat(q("STATS_COLLECTOR_PORT"),"&d=").concat(h):"https://".concat(q("EVENT_REPORT_DOMAIN"),":").concat(q("STATS_COLLECTOR_PORT")).concat(h));for(let g=0;g<2;g+=1){g===1&&(p=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(q("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(q("STATS_COLLECTOR_PORT"),"&d=").concat(h):"https://".concat(q("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(q("STATS_COLLECTOR_PORT")).concat(h)));try{o?await zOe(p,{timeout:1e4,data:u}):await y1(p,{timeout:1e4,data:u})}catch(y){if(g===1)throw y;continue}return}}createBaseInfo(r,o){const s=Object.assign({},aIe);return s.sid=r,this.baseInfoMap.set(r,{info:s,startTime:o}),s}reportResourceTiming(r,o){const s=performance.getEntriesByName(r),c=s[s.length-1];c&&this.reportApiInvoke(o,{name:"Client.resourceTiming",options:c,tag:Nn.TRACER}).onSuccess()}};Y8.on("REPORT_LOG_UPLOAD",r=>{r.networkState=qn.networkState,We.reportApiInvoke(null,{name:"logUploadError",options:r,tag:Nn.TRACER}).onSuccess("logUploadError")});class pe extends ve{constructor(o){super(o,arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",arguments.length>2?arguments[2]:void 0),Dn(this,"name","AgoraRTCException")}print(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return super.print(o,L)}throw(){super.throw(L)}}const zr={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1,supportRequestVideoFrameCallback:!1,supportWebCrypto:!1};function xt(){return zr}function J8(){return"setSinkId"in HTMLAudioElement.prototype&&(!q("RESTRICTION_SET_PLAYBACK_DEVICE")||($l()||c8())&&!a1())}function Q8(){return!zr.supportUnifiedPlan||q("CHROME_FORCE_PLAN_B")&&Wl()}let Yr=function(r){return r.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",r.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",r.IOS_INTERRUPTION_START="ios-interruption-start",r.IOS_INTERRUPTION_END="ios-interruption-end",r.STATE_CHANGE="state-change",r}({});function bm(r,o,s){return{sampleRate:r,stereo:o,bitrate:s}}function Pt(r,o,s,c,u){return{width:r,height:o,frameRate:s,bitrateMin:c,bitrateMax:u}}function pa(r,o,s,c,u){return{width:{max:r},height:{max:o},frameRate:s,bitrateMin:c,bitrateMax:u}}function x1(r,o){return{numSpatialLayers:r,numTemporalLayers:o}}const lIe={"90p":Pt(160,90),"90p_1":Pt(160,90),"120p":Pt(160,120,15,30,65),"120p_1":Pt(160,120,15,30,65),"120p_3":Pt(120,120,15,30,50),"120p_4":Pt(212,120),"180p":Pt(320,180,15,30,140),"180p_1":Pt(320,180,15,30,140),"180p_3":Pt(180,180,15,30,100),"180p_4":Pt(240,180,15,30,120),"240p":Pt(320,240,15,40,200),"240p_1":Pt(320,240,15,40,200),"240p_3":Pt(240,240,15,40,140),"240p_4":Pt(424,240,15,40,220),"360p":Pt(640,360,15,80,400),"360p_1":Pt(640,360,15,80,400),"360p_3":Pt(360,360,15,80,260),"360p_4":Pt(640,360,30,80,600),"360p_6":Pt(360,360,30,80,400),"360p_7":Pt(480,360,15,80,320),"360p_8":Pt(480,360,30,80,490),"360p_9":Pt(640,360,15,80,800),"360p_10":Pt(640,360,24,80,800),"360p_11":Pt(640,360,24,80,1e3),"480p":Pt(640,480,15,100,500),"480p_1":Pt(640,480,15,100,500),"480p_2":Pt(640,480,30,100,1e3),"480p_3":Pt(480,480,15,100,400),"480p_4":Pt(640,480,30,100,750),"480p_6":Pt(480,480,30,100,600),"480p_8":Pt(848,480,15,100,610),"480p_9":Pt(848,480,30,100,930),"480p_10":Pt(640,480,10,100,400),"720p":Pt(1280,720,15,120,1130),"720p_auto":Pt(1280,720,30,900,3e3),"720p_1":Pt(1280,720,15,120,1130),"720p_2":Pt(1280,720,30,120,2e3),"720p_3":Pt(1280,720,30,120,1710),"720p_5":Pt(960,720,15,120,910),"720p_6":Pt(960,720,30,120,1380),"1080p":Pt(1920,1080,15,120,2080),"1080p_1":Pt(1920,1080,15,120,2080),"1080p_2":Pt(1920,1080,30,120,3e3),"1080p_3":Pt(1920,1080,30,120,3150),"1080p_5":Pt(1920,1080,60,120,4780),"1440p":Pt(2560,1440,30,120,4850),"1440p_1":Pt(2560,1440,30,120,4850),"1440p_2":Pt(2560,1440,60,120,7350),"4k":Pt(3840,2160,30,120,8910),"4k_1":Pt(3840,2160,30,120,8910),"4k_3":Pt(3840,2160,60,120,13500)},uIe={"480p":pa(640,480,5),"480p_1":pa(640,480,5),"480p_2":pa(640,480,30),"480p_3":pa(640,480,15),"720p":pa(1280,720,5),"720p_auto":Pt(1280,720,30,900,3e3),"720p_1":pa(1280,720,5),"720p_2":pa(1280,720,30),"720p_3":pa(1280,720,15),"1080p":pa(1920,1080,5),"1080p_1":pa(1920,1080,5),"1080p_2":pa(1920,1080,30),"1080p_3":pa(1920,1080,15)},dIe={"1SL1TL":x1(1,1),"3SL3TL":x1(3,3),"2SL3TL":x1(2,3)};function ma(r){return r||(r="480p_1"),typeof r=="string"?Object.assign({},lIe[r]):r}function P1(r){return typeof r=="string"?Object.assign({},uIe[r]):r}function Ww(r){return typeof r=="string"?Object.assign({},dIe[r]):r}const hIe={speech_low_quality:bm(16e3,!1),speech_standard:bm(32e3,!1,18),music_standard:bm(48e3,!1),standard_stereo:bm(48e3,!0,56),high_quality:bm(48e3,!1,128),high_quality_stereo:bm(48e3,!0,192)};function Gw(r){return typeof r=="string"?Object.assign({},hIe[r]):r}const Sm=[];function Z8(r){return yr(r,"mediaSource",["screen","window","application"]),!0}let Fe=function(r){return r.NEED_RENEGOTIATE="@need_renegotiate",r.NEED_REPLACE_TRACK="@need_replace_track",r.NEED_REPLACE_MIXING_TRACK="@need_replace_mixing_track",r.NEED_CLOSE="@need_close",r.NEED_ENABLE_TRACK="@need_enable_track",r.NEED_DISABLE_TRACK="@need_disable_track",r.NEED_SESSION_ID="@need_sid",r.SET_OPTIMIZATION_MODE="@set_optimization_mode",r.GET_STATS="@get_stats",r.GET_RTC_STATS="@get_rtc_stats",r.GET_LOW_VIDEO_TRACK="@get_low_video_track",r.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",r.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",r.NEED_UPDATE_VIDEO_SEND_PARAMETERS="@need_update_video_send_parameters",r.NEED_MUTE_TRACK="@need_mute_track",r.NEED_UNMUTE_TRACK="@need_unmute_track",r}({}),Zt=function(r){return r.SCREEN_TRACK="screen_track",r.CUSTOM_TRACK="custome_track",r.LOW_STREAM="low_stream",r.SCREEN_LOW_TRACK="screen_low_track",r}({}),wm=function(r){return r[r.HIGH_STREAM=0]="HIGH_STREAM",r[r.LOW_STREAM=1]="LOW_STREAM",r}({}),fIe=function(r){return r[r.HIGH_STREAM=0]="HIGH_STREAM",r[r.LOW_STREAM=1]="LOW_STREAM",r[r.HIGH_STREAM_LAYER1=4]="HIGH_STREAM_LAYER1",r[r.HIGH_STREAM_LAYER2=5]="HIGH_STREAM_LAYER2",r[r.HIGH_STREAM_LAYER3=6]="HIGH_STREAM_LAYER3",r[r.HIGH_STREAM_LAYER4=7]="HIGH_STREAM_LAYER4",r[r.HIGH_STREAM_LAYER5=8]="HIGH_STREAM_LAYER5",r[r.HIGH_STREAM_LAYER6=9]="HIGH_STREAM_LAYER6",r}({}),pIe=function(r){return r[r.DISABLE=0]="DISABLE",r[r.LOW_STREAM=1]="LOW_STREAM",r[r.AUDIO_ONLY=2]="AUDIO_ONLY",r[r.HIGH_STREAM_LAYER1=3]="HIGH_STREAM_LAYER1",r[r.HIGH_STREAM_LAYER2=4]="HIGH_STREAM_LAYER2",r[r.HIGH_STREAM_LAYER3=5]="HIGH_STREAM_LAYER3",r[r.HIGH_STREAM_LAYER4=6]="HIGH_STREAM_LAYER4",r[r.HIGH_STREAM_LAYER5=7]="HIGH_STREAM_LAYER5",r[r.HIGH_STREAM_LAYER6=8]="HIGH_STREAM_LAYER6",r}({}),cf=function(r){return r.TRANSCEIVER_UPDATED="transceiver-updated",r.SEI_TO_SEND="sei-to-send",r.SEI_RECEIVED="sei-received",r.TRACK_UPDATED="track-updated",r}({}),Tm=function(r){return r.SOURCE_STATE_CHANGE="source-state-change",r.TRACK_ENDED="track-ended",r.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",r.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",r.CLOSED="closed",r}({}),Cm=function(r){return r.FIRST_FRAME_DECODED="first-frame-decoded",r.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",r.VIDEO_STATE_CHANGED="video-state-changed",r}({}),Rm=function(r){return r.AUDIO="audio",r.VIDEO="video",r.DATA="data",r}({}),ns=function(r){return r.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",r.RECEIVE_TRACK_BUFFER="receive_track_buffer",r.ON_AUDIO_BUFFER="on_audio_buffer",r.UPDATE_SOURCE="update_source",r}({});(function(r){r.UPDATE_TRACK_SOURCE="update-track-source"})({});const N1={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},D1={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},eH={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receivePacketsDiscarded:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},mIe={uplinkNetworkQuality:0,downlinkNetworkQuality:0},tH={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let Fi=function(r){return r.ON_TRACK="on_track",r.ON_NODE="on_node",r}({}),rs=function(r){return r.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",r.REQUEST_CONSTRAINTS="request_constraints",r}({}),f_=function(r){return r.IDLE="IDLE",r.INITING="INITING",r.INITEND="INITEND",r}({}),lf=function(r){return r.STATE_CHANGE="state_change",r.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",r.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",r.CAMERA_DEVICE_CHANGED="cameraDeviceChanged",r}({}),wi=function(r){return r.NONE="none",r.INIT="init",r.CANPLAY="canplay",r.PLAYING="playing",r.PAUSED="paused",r.SUSPEND="suspend",r.STALLED="stalled",r.WAITING="waiting",r.ERROR="error",r.DESTROYED="destroyed",r.ABORT="abort",r.ENDED="ended",r.EMPTIED="emptied",r.LOADEDDATA="loadeddata",r}({}),qc=function(r){return r[r.VideoStateStopped=0]="VideoStateStopped",r[r.VideoStateStarting=1]="VideoStateStarting",r[r.VideoStateDecoding=2]="VideoStateDecoding",r[r.VideoStateFrozen=3]="VideoStateFrozen",r}({});const k1={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};let Hw=function(r){return r.OPEN="open",r.MESSAGE="message",r.CLOSE="close",r.CLOSING="closing",r.ERROR="error",r}({});function Tt(r,o,s,c,u){var h,p,g={};return Object.keys(c).forEach(function(y){g[y]=c[y]}),g.enumerable=!!g.enumerable,g.configurable=!!g.configurable,("value"in g||g.initializer)&&(g.writable=!0),g=oa(h=F3(p=s.slice()).call(p)).call(h,function(y,b){return b(r,o,y)||y},g),u&&g.initializer!==void 0&&(g.value=g.initializer?g.initializer.call(u):void 0,g.initializer=void 0),g.initializer===void 0?(Object.defineProperty(r,o,g),null):g}function fe(r,o,s){return(o=function(c){var u=function(h,p){if(typeof h!="object"||!h)return h;var g=h[Symbol.toPrimitive];if(g!==void 0){var y=g.call(h,"string");if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(h)}(c);return typeof u=="symbol"?u:u+""}(o))in r?Object.defineProperty(r,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[o]=s,r}function nH(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function Cn(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?nH(Object(s),!0).forEach(function(c){fe(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):nH(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}class rH extends An{set _mediaStreamTrack(o){o!==this.mediaStreamTrack&&(this.safeEmit(cf.TRACK_UPDATED,o),this.mediaStreamTrack=o)}get _mediaStreamTrack(){return this.mediaStreamTrack}constructor(o,s){super(),fe(this,"trackMediaType",void 0),fe(this,"_ID",void 0),fe(this,"_rtpTransceiver",void 0),fe(this,"_lowRtpTransceiver",void 0),fe(this,"_hints",[]),fe(this,"_isClosed",!1),fe(this,"_originMediaStreamTrack",void 0),fe(this,"mediaStreamTrack",void 0),fe(this,"_external",{}),this._ID=s||cn(8,"track-"),this._originMediaStreamTrack=o,this.mediaStreamTrack=o,function(c){Pe(Sm).call(Sm,c)||Sm.push(c)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(o){return o||ud(()=>{var s;We.reportApiInvoke(null,{name:Yn.GET_MEDIA_STREAM_TRACK,options:[],tag:Nn.TRACER}).onSuccess(((s=this._mediaStreamTrack)===null||s===void 0?void 0:s.label)||"")},this.mediaStreamTrack.id||this.getTrackId()),this._mediaStreamTrack}getRTCRtpTransceiver(o){return o===wm.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(o){const s=Sm.indexOf(o);s!==-1&&Sm.splice(s,1)}(this),this.emit(Tm.CLOSED),this.removeAllListeners(cf.SEI_RECEIVED)}_updateRtpTransceiver(o,s){if(s===wm.LOW_STREAM){if(this._lowRtpTransceiver===o)return;this._lowRtpTransceiver=o}else{if(this._rtpTransceiver===o)return;this._rtpTransceiver=o}this.emit(cf.TRANSCEIVER_UPDATED,o,s)}}class Am extends rH{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}constructor(o,s){super(o,s),fe(this,"_enabled",!0),fe(this,"_muted",!1),fe(this,"_isExternalTrack",!1),fe(this,"_isClosed",!1),fe(this,"_enabledMutex",void 0),fe(this,"processor",void 0),fe(this,"_processorContext",void 0),fe(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new fi("".concat(this.getTrackId())),o.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var o,s;return(o=(s=this._originMediaStreamTrack)===null||s===void 0?void 0:s.label)!==null&&o!==void 0?o:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,L.debug("[".concat(this.getTrackId(),"] close")),this.emit(Fe.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(o,s){let c=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=c,o!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),s&&this._originMediaStreamTrack.stop()),o.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=o,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await rn(this,Fe.NEED_REPLACE_TRACK,this),this.processor&&this._processorContext&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this._processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){L.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Tm.TRACK_ENDED)}stateCheck(o,s){if(L.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(o,": ").concat(s,"]")),Gl(s,o),this._enabled&&this._muted&&o==="enabled"&&s===!1)throw new ve(Y.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",L);if(!this._enabled&&!this._muted&&o==="muted"&&s===!0)throw new ve(Y.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",L)}getProcessorStats(){return this._processorContext&&this._processorContext.gatherStats()||[]}getProcessorUsage(){return this._processorContext?this._processorContext.gatherUsage():De.resolve([])}}const iH=window.AudioContext||window.webkitAudioContext;let is=null;const qt=new class extends An{constructor(){super(...arguments),fe(this,"prevState",void 0),fe(this,"curState",void 0),fe(this,"currentTime",void 0),fe(this,"currentTimeStuckAt",void 0),fe(this,"interruptDetectorTrack",void 0),fe(this,"onLocalAudioTrackMute",()=>{L.info("ios15-interruption-start"),this.emit(Yr.IOS_15_16_INTERRUPTION_START)}),fe(this,"onLocalAudioTrackUnmute",async()=>{L.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?L.info("ios15-interruption-end-canceled"):(is&&await is.suspend(),this.emit(Yr.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(r){L.debug("webaudio bindInterruptDetectorTrack ".concat(r.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=r,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(r){L.debug("webaudio unbindInterruptDetectorTrack ".concat(r.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===r&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function Om(){if(!is){if(function(){if(!iH)return void L.error("your browser is not support web audio");L.info("create audio context");const r=Cn({},q("WEBAUDIO_INIT_OPTIONS"));L.debug("audio context init option:",JSON.stringify(r)),is=new iH(r),qt.curState=is.state,is.onstatechange=()=>{qt.prevState=qt.curState,qt.curState=is?is.state:void 0;const{prevState:o,curState:s}=qt,c=s==="running",u=s==="interrupted",h=o==="running",p=o==="suspended",g=o==="interrupted",y=It().osVersion;(Vi()||ha())&&h&&u&&(L.info("ios".concat(y,"-interruption-start")),qt.emit(Yr.IOS_INTERRUPTION_START)),(Vi()||ha())&&(p||g)&&c&&(L.info("ios".concat(y,"-interruption-end")),qt.emit(Yr.IOS_INTERRUPTION_END)),o!==s&&qt.emit(Yr.STATE_CHANGE,s,o)},setInterval(()=>{var o;const s=(o=is)===null||o===void 0?void 0:o.currentTime;qt.currentTime!==s?(qt.currentTimeStuckAt&&(L.debug("AudioContext current time resume at ".concat(s)),qt.currentTimeStuckAt=void 0),qt.currentTime=s):(s!==qt.currentTimeStuckAt&&(We.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:s},tag:Nn.TRACER}).onSuccess(),L.warning("AudioContext current time stuck at ".concat(s))),qt.currentTimeStuckAt=s)},5e3),async function(o){const s=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let c,u=!1,h=!1,p=!1;function g(U){o.state==="running"?y(!1):Vi()||ha()?o.state==="suspended"&&(y(!0),U&&o.resume().then(b,b)):o.state!=="closed"&&(y(!0),U&&o.resume().then(b,b))}function y(U){if(u!==U){u=U;for(let F=0,K=s;F<K.length;F+=1){const z=K[F];U?window.addEventListener(z,w,{capture:!0,passive:!0}):window.removeEventListener(z,w,{capture:!0,passive:!0})}}}function b(){g(!1)}function w(){g(!0)}function C(U){if(!p)if(c.paused)if(U){let F;A(!1),p=!0;try{F=c.play(),F?F.then(x,x):(c.addEventListener("playing",x),c.addEventListener("abort",x),c.addEventListener("error",x))}catch{x()}}else A(!0);else A(!1)}function A(U){if(h!==U){h=U;for(let F=0,K=s;F<K.length;F++){const z=K[F];U?window.addEventListener(z,B,{capture:!0,passive:!0}):window.removeEventListener(z,B,{capture:!0,passive:!0})}}}function x(){c.removeEventListener("playing",x),c.removeEventListener("abort",x),c.removeEventListener("error",x),p=!1,C(!1)}function B(){C(!0)}if(Vi()){const U=o.createMediaStreamDestination(),F=document.createElement("div");F.innerHTML="<audio x-webkit-airplay='deny'></audio>",c=F.children.item(0),c.controls=!1,c.disableRemotePlayback=!0,c.preload="auto",c.srcObject=U.stream,C(!0)}qt.on(Yr.STATE_CHANGE,function(){g(!0)}),g(!1)}(is)}(),!is)throw new ve(Y.NOT_SUPPORTED,"can not create audio context");return is}return is}function uf(r){if(function(){if(L1!==null)return L1;const c=Om(),u=c.createBufferSource(),h=c.createGain(),p=c.createGain();u.connect(h),u.connect(p),u.disconnect(h);let g=!1;try{u.disconnect(h)}catch{g=!0}return u.disconnect(),L1=g,g}())return;const o=r.connect,s=r.disconnect;r.connect=(c,u,h)=>{var p;return r._inputNodes||(r._inputNodes=[]),Pe(p=r._inputNodes).call(p,c)||(c instanceof AudioNode?(r._inputNodes.push(c),o.call(r,c,u,h)):o.call(r,c,u)),r},r.disconnect=(c,u,h)=>{s.call(r),c?kw(r._inputNodes,c):r._inputNodes=[];for(const p of r._inputNodes)o.call(r,p)}}let L1=null;function M1(r,o){let s=!1;const c=1/o;if(q("DISABLE_WEBAUDIO")){const u=window.setInterval(()=>{s?window.clearInterval(u):r(performance.now()/1e3)},1e3*c)}else{const u=Om();let h=u.createGain();h.gain.value=0,h.connect(u.destination);const p=()=>{if(s)return void(h=null);const g=u.createOscillator();g.onended=p,g.connect(h),g.start(0),g.stop(u.currentTime+c),r(u.currentTime)};p()}return()=>{s=!0}}class oH{constructor(){fe(this,"context",void 0),fe(this,"analyserNode",void 0),fe(this,"sourceNode",void 0),this.context=Om(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(o){if(o!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=o,o==null||o.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||Vi()||ha()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const o=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(o);else{const c=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(c);for(let u=0;u<o.length;++u)o[u]=c[u]/128-1}const s=oa(o).call(o,(c,u)=>c+u*u,0)/o.length;return Math.max(10*Math.log10(s)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var o,s;(o=this.sourceNode)===null||o===void 0||o.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(s=this.sourceNode)===null||s===void 0||s.connect(this.analyserNode)}catch{L.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class sH extends An{get processSourceNode(){return this.sourceNode}set processedNode(o){var s;if(!this.isDestroyed&&this._processedNode!==o){try{var c;(c=this.sourceNode)===null||c===void 0||c.disconnect(this.outputNode)}catch{}(s=this._processedNode)===null||s===void 0||s.disconnect(),this._processedNode=o,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),fe(this,"outputNode",void 0),fe(this,"outputTrack",void 0),fe(this,"isPlayed",!1),fe(this,"sourceNode",void 0),fe(this,"context",void 0),fe(this,"audioBufferNode",void 0),fe(this,"destNode",void 0),fe(this,"audioOutputLevel",0),fe(this,"volumeLevelAnalyser",void 0),fe(this,"_processedNode",void 0),fe(this,"playNode",void 0),fe(this,"isDestroyed",!1),fe(this,"onNoAudioInput",void 0),fe(this,"isNoAudioInput",!1),fe(this,"_noAudioInputCount",0),this.context=Om(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),uf(this.outputNode),this.volumeLevelAnalyser=new oH}startGetAudioBuffer(o){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(o),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=s=>{this.emit(ns.ON_AUDIO_BUFFER,function(c){for(let u=0;u<c.outputBuffer.numberOfChannels;u+=1){const h=c.outputBuffer.getChannelData(u);for(let p=0;p<h.length;p+=1)h[p]=0}return c.inputBuffer}(s))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!xt().webAudioMediaStreamDest)throw new ve(Y.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(o){this.context.state!=="running"&&Lw(()=>{qt.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=o||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(o>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;Vi()||ha()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const s=this.volumeLevelAnalyser.getAnalyserNode();let c;s.getFloatTimeDomainData?(c=new Float32Array(s.fftSize),s.getFloatTimeDomainData(c)):(c=new Uint8Array(s.fftSize),s.getByteTimeDomainData(c));let u=!1;for(let h=0;h<c.length;h++)c[h]!==0&&(u=!0);return u?(this.isNoAudioInput=!1,!0):(await Kr(200),await this.checkHasAudioInput(o?o+1:1)&&u)}getAudioVolume(){return this.outputNode.gain.value}setVolume(o){this.outputNode.gain.setValueAtTime(o,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var o,s;(o=this.processedNode)===null||o===void 0||o.disconnect(),(s=this.sourceNode)===null||s===void 0||s.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var o;this.processedNode?(o=this.processedNode)===null||o===void 0||o.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class aH extends sH{get isFreeze(){return!1}constructor(o,s,c){var u;if(super(),fe(this,"sourceNode",void 0),fe(this,"track",void 0),fe(this,"clonedTrack",void 0),fe(this,"audioElement",void 0),fe(this,"isCurrentTrackCloned",!1),fe(this,"isRemoteTrack",!1),fe(this,"originVolumeLevelAnalyser",void 0),fe(this,"rebuildWebAudio",async()=>{if(L.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void L.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>L.info("resume success")),L.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const g=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?g.stop():this.isCurrentTrackCloned=!0;const y=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(y),uf(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const b=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(b,this.context.currentTime),uf(this.outputNode),this.emit(ns.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=y,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),o.kind!=="audio")throw new ve(Y.UNEXPECTED_ERROR);this.track=o;const h=new MediaStream([this.track]);if(this.isRemoteTrack=!!s,this.sourceNode=this.context.createMediaStreamSource(h),uf(this.sourceNode),c){const g=c.clone();g.enabled=!0,this.clonedTrack=g,L.debug("create an unmuted track ".concat(g.id," from the original track ").concat(c.id," to get the volume"));const y=this.context.createMediaStreamSource(new MediaStream([g]));uf(y),this.originVolumeLevelAnalyser=new oH,this.originVolumeLevelAnalyser.updateSource(y)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=h;const p=It();s&&p.os===Rr.IOS&&Number((u=p.osVersion)===null||u===void 0?void 0:u.split(".")[0])<15&&(qt.on(Yr.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(g=>{g||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(o){this.sourceNode.disconnect(),this.track=o,this.isCurrentTrackCloned=!1;const s=new MediaStream([o]);this.sourceNode=this.context.createMediaStreamSource(s),uf(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(ns.UPDATE_SOURCE),this.audioElement.srcObject=s}destroy(){var o;this.audioElement.srcObject=null,this.audioElement.remove(),qt.off("state-change",this.rebuildWebAudio),(o=this.originVolumeLevelAnalyser)===null||o===void 0||o.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(o){return this.context.createMediaStreamSource(new MediaStream([o]))}updateOriginTrack(o){const s=o.clone();s.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=s),L.debug("create an unmuted track ".concat(s.id," from the original track ").concat(o.id," to get the volume"));const c=this.context.createMediaStreamSource(new MediaStream([s]));uf(c),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(c)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function cH(r,o,s){const c=(h,p)=>h?typeof h!="number"?h.max||h.exact||h.ideal||h.min||p:h:p,u={audio:!!s&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:r,maxHeight:c(o.height,1080),maxWidth:c(o.width,1920)}}};return o.frameRate&&typeof o.frameRate!="number"?(u.video.mandatory.maxFrameRate=o.frameRate.max,u.video.mandatory.minFrameRate=o.frameRate.min):typeof o.frameRate=="number"&&(u.video.mandatory.maxFrameRate=o.frameRate),await navigator.mediaDevices.getUserMedia(u)}async function gIe(r,o){const s=await lH(r.mediaSource),{sourceId:c,audio:u}=await function(h){let p=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new De((g,y)=>{const b=document.createElement("div");b.innerText="share screen",b.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const w=document.createElement("div");w.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const C=document.createElement("div");C.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",C.setAttribute("style","height: 12%;");const A=document.createElement("div");A.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const x=document.createElement("div");x.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const B=document.createElement("button");B.innerHTML="cancel",B.setAttribute("style","width: 85px;"),B.onclick=()=>{document.body.removeChild(K);const z=new Error("NotAllowedError");z.name="NotAllowedError",y(z)};let U=p;const F=document.createElement("div");if(p){const z=document.createElement("input");z.setAttribute("type","checkbox");const Q=document.createElement("span");z.setAttribute("style","margin-right: 6px;"),Q.innerText="Share audio",z.checked=U,z.onchange=()=>{U=z.checked},F.appendChild(z),F.appendChild(Q)}x.appendChild(F),x.appendChild(B),w.appendChild(C),w.appendChild(A),w.appendChild(x);const K=document.createElement("div");K.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),K.appendChild(b),K.appendChild(w),document.body.appendChild(K),h.map(z=>{if(z.id){const Q=document.createElement("div");Q.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let ie=z.thumbnail;try{const{width:oe}=ie.getSize();oe>1920&&(ie=ie.resize({width:1920}))}catch(oe){throw oe&&oe.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),oe}Q.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+ie.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+z.name.replace(/[\u00A0-\u9999<>\&]/g,function(oe){return"&#"+oe.charCodeAt(0)+";"})+"</span>",Q.onclick=()=>{document.body.removeChild(K),g({sourceId:z.id,audio:U})},A.appendChild(Q)}})})}(s,o);return await cH(c,r,u)}async function lH(r){let o=["window","screen"];r!=="application"&&r!=="window"||(o=["window"]),r==="screen"&&(o=["screen"]);const s=b8();if(!s)throw console.error("failed to fetch electron, please mount it to window"),new ve(Y.ELECTRON_IS_NULL);let c=null;try{var u;c=((u=s.desktopCapturer)===null||u===void 0?void 0:u.getSources({types:o}))||s.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:o})}catch{c=null}c&&c.then||(c=new De((h,p)=>{s.desktopCapturer.getSources({types:o},(g,y)=>{g?p(g):h(y)})}));try{return await c}catch(h){throw new ve(Y.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,h.toString())}}const j1=new fi("safari");let uH=!1,dH=!1;async function os(r,o){let s=0,c=null;for(;s<2;)try{c=await vIe(r,o,s>0);break}catch(u){if(u instanceof ve)throw L.error("[".concat(o,"] ").concat(u.toString())),u;const h=Kw(u.name||u.code||u,u.message);if(h.code===Y.MEDIA_OPTION_INVALID){L.debug("[".concat(o,"] detect media option invalid, retry")),s+=1,await Kr(500);continue}throw L.error("[".concat(o,"] ").concat(h.toString())),h}if(!c)throw new ve(Y.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return c}async function vIe(r,o,s){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new ve(Y.NOT_SUPPORTED,"can not find getUserMedia");s&&(r.video&&(delete r.video.width,delete r.video.height),r.screen&&(delete r.screen.width,delete r.screen.height));const c=xt(),u=new MediaStream;if(r.audioSource&&u.addTrack(r.audioSource),r.videoSource&&u.addTrack(r.videoSource),!r.audio&&!r.video&&!r.screen)return L.debug("Using Video Source/ Audio Source"),u;if(r.screen)if(b8())r.screen.sourceId?Im(u,await cH(r.screen.sourceId,r.screen,!!r.screenAudio)):Im(u,await gIe(r.screen,!!r.screenAudio));else if($l()&&r.screen.extensionId&&r.screen.mandatory){if(!c.getStreamFromExtension)throw new ve(Y.NOT_SUPPORTED,"This browser does not support screen sharing");L.debug("[".concat(o,'] Screen access on chrome stable, looking for extension"'));const A=await(p=r.screen.extensionId,g=o,new De((x,B)=>{try{chrome.runtime.sendMessage(p,{getStream:!0},U=>{if(!U||!U.streamId)return L.error("[".concat(g,"] No response from Chrome Plugin. Plugin not installed properly"),U),void B(new ve(Y.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));x(U.streamId)})}catch(U){L.error("[".concat(g,"] AgoraRTC screensharing plugin is not accessible(").concat(p,")"),U.toString()),B(new ve(Y.CHROME_PLUGIN_NOT_INSTALL))}}));r.screen.mandatory.chromeMediaSourceId=A,Im(u,await navigator.mediaDevices.getUserMedia({video:{mandatory:r.screen.mandatory}}))}else if(c.getDisplayMedia){var h;r.screen.mediaSource&&Z8(r.screen.mediaSource);const A={width:r.screen.width,height:r.screen.height,frameRate:r.screen.frameRate,displaySurface:(h=r.screen.displaySurface)!==null&&h!==void 0?h:r.screen.mediaSource==="screen"?"monitor":r.screen.mediaSource},{selfBrowserSurface:x,surfaceSwitching:B,systemAudio:U,preferCurrentTab:F}=r.screen,K={selfBrowserSurface:x,surfaceSwitching:B,systemAudio:U,preferCurrentTab:F};!x&&delete K.selfBrowserSurface,!B&&delete K.surfaceSwitching,!U&&delete K.systemAudio,!F&&delete K.preferCurrentTab,L.debug("[".concat(o,"] getDisplayMedia:"),JSON.stringify({video:A,audio:r.screenAudio,controls:K})),Im(u,await navigator.mediaDevices.getDisplayMedia(Cn({video:A,audio:r.screenAudio},K)))}else{if(!xn())throw L.error("[".concat(o,"] This browser does not support screenSharing")),new ve(Y.NOT_SUPPORTED,"This browser does not support screen sharing");{r.screen.mediaSource&&Z8(r.screen.mediaSource);const A={video:{mediaSource:r.screen.mediaSource,width:r.screen.width,height:r.screen.height,frameRate:r.screen.frameRate}};L.debug("[".concat(o,"] getUserMedia: ").concat(JSON.stringify(A))),Im(u,await navigator.mediaDevices.getUserMedia(A))}}var p,g;if(!r.video&&!r.audio)return u;let y={video:r.video,audio:r.audio},b=q("MEDIA_DEVICE_CONSTRAINTS");if(b)try{typeof b=="string"&&(b=JSON.parse(b)),y=f1(y,b)}catch{}L.debug("[".concat(o,"] GetUserMedia"),JSON.stringify(y)),It();let w,C=null;(ri()||Vi()||Nw())&&(C=await j1.lock());try{w=await navigator.mediaDevices.getUserMedia(y)}catch(A){throw C&&C(),A}return y.audio&&(uH=!0),y.video&&(dH=!0),Im(u,w),C&&C(),u}function Kw(r,o){switch(r){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new ve(Y.MEDIA_OPTION_INVALID,"".concat(r,": ").concat(o));case"NotFoundError":case"DevicesNotFoundError":return new ve(Y.DEVICE_NOT_FOUND,"".concat(r,": ").concat(o));case"NotSupportedError":return new ve(Y.NOT_SUPPORTED,"".concat(r,": ").concat(o));case"NotReadableError":return new ve(Y.NOT_READABLE,"".concat(r,": ").concat(o));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new ve(Y.PERMISSION_DENIED,"".concat(r,": ").concat(o));case"ConstraintNotSatisfiedError":return new ve(Y.CONSTRAINT_NOT_SATISFIED,"".concat(r,": ").concat(o));default:return L.error("getUserMedia unexpected error",r),new ve(Y.UNEXPECTED_ERROR,"".concat(r,": ").concat(o))}}function Im(r,o){const s=r.getVideoTracks()[0],c=r.getAudioTracks()[0],u=o.getVideoTracks()[0],h=o.getAudioTracks()[0];h&&(c&&r.removeTrack(c),r.addTrack(h)),u&&(s&&r.removeTrack(s),r.addTrack(u))}const ss=new class extends An{get state(){return this._state}set state(r){r!==this._state&&(this.emit(lf.STATE_CHANGE,r),this._state=r)}constructor(){super(),fe(this,"_state",f_.IDLE),fe(this,"isAccessMicrophonePermission",!1),fe(this,"isAccessCameraPermission",!1),fe(this,"lastAccessMicrophonePermission",!1),fe(this,"lastAccessCameraPermission",!1),fe(this,"checkdeviceMatched",!1),fe(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(q("ENUMERATE_DEVICES_INTERVAL")||(Dw()||Pw()===Rr.HARMONY_OS)&&Wl())&&this.updateDevicesInfo()},q("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(r=>L.error(r.toString()))}async enumerateDevices(r,o){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new ve(Y.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const c=await navigator.mediaDevices.enumerateDevices(),u=this.checkMediaDeviceInfoIsOk(c);let h=!this.isAccessMicrophonePermission&&r,p=!this.isAccessCameraPermission&&o;u.audio&&(h=!1),u.video&&(p=!1);let g=null,y=null,b=null;if(!s&&(h||p)){if(j1.isLocked&&(L.debug("[device manager] wait GUM lock"),(await j1.lock())(),L.debug("[device manager] GUM unlock")),uH&&(h=!1,this.isAccessMicrophonePermission=!0),dH&&(p=!1,this.isAccessCameraPermission=!0),L.debug("[device manager] check media device permissions",r,o,h,p),h&&p){try{b=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(w){const C=Kw(w.name||w.code||w,w.message);if(C.code===Y.PERMISSION_DENIED)throw C;L.warning("getUserMedia failed in getDevices",C)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(h){try{g=await navigator.mediaDevices.getUserMedia({audio:r})}catch(w){const C=Kw(w.name||w.code||w,w.message);if(C.code===Y.PERMISSION_DENIED)throw C;L.warning("getUserMedia failed in getDevices",C)}this.isAccessMicrophonePermission=!0}else if(p){try{y=await navigator.mediaDevices.getUserMedia({video:o})}catch(w){const C=Kw(w.name||w.code||w,w.message);if(C.code===Y.PERMISSION_DENIED)throw C;L.warning("getUserMedia failed in getDevices",C)}this.isAccessCameraPermission=!0}L.debug("[device manager] mic permission",r,"cam permission",o)}try{const w=await navigator.mediaDevices.enumerateDevices();return g&&g.getTracks().forEach(C=>C.stop()),y&&y.getTracks().forEach(C=>C.stop()),b&&b.getTracks().forEach(C=>C.stop()),g=null,y=null,b=null,w}catch(w){return g&&g.getTracks().forEach(C=>C.stop()),y&&y.getTracks().forEach(C=>C.stop()),b&&b.getTracks().forEach(C=>C.stop()),g=null,y=null,b=null,new ve(Y.ENUMERATE_DEVICES_FAILED,w.toString()).throw()}}async getRecordingDevices(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,r)).filter(o=>o.kind==="audioinput")}async getCamerasDevices(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,r)).filter(o=>o.kind==="videoinput")}async getSpeakers(){let r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,r)).filter(o=>o.kind==="audiooutput")}searchDeviceIdByName(r){let o=null;return this.deviceInfoMap.forEach(s=>{s.device.label===r&&(o=s.device.deviceId)}),o}async getDeviceById(r){const o=(await this.enumerateDevices(!0,!0,!0)).find(s=>s.deviceId===r);if(!o)throw new ve(Y.DEVICE_NOT_FOUND,"deviceId: ".concat(r));return o}async init(){this.state=f_.INITING;try{await this.updateDevicesInfo(),this.state=f_.INITEND}catch(r){throw L.warning("Device Detection functionality cannot start properly.",r.toString()),this.state=f_.IDLE,(typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1")||new ve(Y.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),r}}async updateDevicesInfo(){const r=await this.enumerateDevices(!0,!0,!0),o=Date.now(),s=[];if(r[0]&&r[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const u=r.find(p=>p.kind==="audioinput"&&p.deviceId==="default"),h=r.find(p=>p.kind==="audiooutput"&&p.deviceId==="default");u&&h?h.groupId===u.groupId?L.debug("[device-check] default input ".concat(u.label," and output ").concat(h.label," is the same group")):L.debug("[device-check] default input ".concat(u.label," and output ").concat(h.label," is not the same group")):L.debug("[device-check] default input or output not found")}const c=this.checkMediaDeviceInfoIsOk(r);if(r.forEach(u=>{if(!u.deviceId)return;const h=this.deviceInfoMap.get("".concat(u.kind,"_").concat(u.deviceId));if((h?h.state:"INACTIVE")!=="ACTIVE"){const p={initAt:o,updateAt:o,device:u,state:"ACTIVE"};this.deviceInfoMap.set("".concat(u.kind,"_").concat(u.deviceId),p),s.push(p)}h&&(h.updateAt=o)}),this.deviceInfoMap.forEach((u,h)=>{u.state==="ACTIVE"&&u.updateAt!==o&&(u.state="INACTIVE",s.push(u))}),this.state!==f_.INITEND)return c.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(c.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));s.forEach(u=>{switch(u.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(lf.RECORDING_DEVICE_CHANGED,u);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(lf.CAMERA_DEVICE_CHANGED,u);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(lf.PLAYOUT_DEVICE_CHANGED,u)}}),c.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),c.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(r){const o=r.filter(u=>u.kind==="audioinput"),s=r.filter(u=>u.kind==="videoinput"),c={audio:!1,video:!1};for(const u of o)if(u.label&&u.deviceId){c.audio=!0;break}for(const u of s)if(u.label&&u.deviceId){c.video=!0;break}return c}};let U1=!1;const as=new class extends An{constructor(){super(...arguments),fe(this,"onAutoplayFailed",void 0),fe(this,"onAudioAutoplayFailed",void 0)}};function hH(){if(It(),!U1){const r=o=>{o.preventDefault(),U1=!1,i_()?document.body.removeEventListener("click",r,!0):(document.body.removeEventListener("touchstart",r,!0),document.body.removeEventListener("mousedown",r,!0))};U1=!0,i_()?document.body.addEventListener("click",r,!0):(document.body.addEventListener("touchstart",r,!0),document.body.addEventListener("mousedown",r,!0)),L.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),as.onAutoplayFailed?as.onAutoplayFailed():as.onAudioAutoplayFailed?L.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):L.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),as.emit("autoplay-failed")}}function fH(r,o,s,c){if(!r)return;const u=We.getBaseInfoBySessionId(r);if(!u)return;const h=u.info,p=Date.now(),g=Cn(Cn({},h),{},{vid:h.vid===void 0?0:Number(h.vid),lts:p,elapse:p-u.startTime,cbRegistered:as.onAutoplayFailed||as.onAudioAutoplayFailed?1:-1,errorMsg:s,mediaType:o,trackId:c,extend:void 0});We.send({type:Tn.AUTOPLAY_FAILED,data:g},!0)}const yIe=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],Zi=new class{constructor(){fe(this,"onAutoplayFailed",void 0),fe(this,"elementMap",new Map),fe(this,"elementStateMap",new Map),fe(this,"elementsNeedToResume",[]),fe(this,"sinkIdMap",new Map),fe(this,"autoResumeAfterInterruption",r=>{Array.from(this.elementMap.entries()).forEach(o=>{let[s,c]=o;const u=this.elementStateMap.get(s),h=c.srcObject.getAudioTracks()[0],p=h&&h.readyState;if(L.debug("resume after interrupted, ele: ".concat(u," audio: ").concat(p," ").concat(r)),p==="live"){if(r)return c.pause(),void c.play();if(qt.curState==="running")return mm()?(c.pause(),void c.play()):void(u&&u==="paused"&&c.play())}})}),fe(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(r=>{let[o,s]=r;const c=s.srcObject.getAudioTracks()[0];c&&c.readyState==="live"&&(L.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),s.pause(),s.play())})}),this.autoResumeAudioElement(),qt.on(Yr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),qt.on(Yr.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),qt.on(Yr.STATE_CHANGE,()=>{Vi()&&qt.prevState==="suspended"&&qt.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(r,o){const s=this.elementMap.get(r);if(this.sinkIdMap.set(r,o),s)try{await s.setSinkId(o)}catch(c){throw new ve(Y.PERMISSION_DENIED,"can not set sink id: "+c.toString())}}play(r,o,s,c){if(this.elementMap.has(o))return;const u=document.createElement("audio");u.autoplay=!0,u.srcObject=new MediaStream([r]),this.bindAudioElementEvents(o,u),this.elementMap.set(o,u),this.elementStateMap.set(o,wi.INIT),this.setVolume(o,s);const h=this.sinkIdMap.get(o);if(h)try{u.setSinkId(h).catch(g=>{L.warning("[".concat(o,"] set sink id failed"),g.toString())})}catch(g){L.warning("[".concat(o,"] set sink id failed"),g.toString())}const p=u.play();p&&p.then&&p.catch(g=>{c&&fH(c,"audio",g.message,o),L.warning("audio element play warning",g.toString()),this.elementMap.has(o)&&g.name==="NotAllowedError"&&(L.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(u),Lw(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),hH()}))})}updateTrack(r,o){const s=this.elementMap.get(r);s&&(s.srcObject=new MediaStream([o]))}isPlaying(r){return this.elementMap.has(r)&&this.elementStateMap.get(r)==="playing"}setVolume(r,o){const s=this.elementMap.get(r);s&&(o=Math.max(0,Math.min(100,o)),s.volume=o/100)}stop(r){const o=this.elementMap.get(r);if(this.sinkIdMap.delete(r),!o)return;const s=this.elementsNeedToResume.indexOf(o);this.elementsNeedToResume.splice(s,1),o.srcObject=null,o.remove(),this.elementMap.delete(r),this.elementStateMap.delete(r)}bindAudioElementEvents(r,o){yIe.forEach(s=>{o.addEventListener(s,c=>{const u=this.elementStateMap.get(r),h=c.type==="pause"?"paused":c.type;if(L.debug("[".concat(r,"] audio-element-status change ").concat(u," => ").concat(h)),c.type==="error"){const p=o==null?void 0:o.error;p&&L.error("[".concat(r,"] media error, code: ").concat(p.code,", message: ").concat(p.message))}this.elementStateMap.set(r,h)})})}getPlayerState(r){return this.elementStateMap.get(r)||"uninit"}autoResumeAudioElement(){const r=()=>{this.elementsNeedToResume.forEach(o=>{o.play().then(s=>{L.debug("Auto resume audio element success")}).catch(s=>{L.warning("Auto resume audio element failed!",s)})}),this.elementsNeedToResume=[]};new De(o=>{document.body?o():window.addEventListener("load",()=>o())}).then(()=>{i_()?document.body.addEventListener("click",r,!0):(document.body.addEventListener("touchstart",r,!0),document.body.addEventListener("mousedown",r,!0))})}};function Bn(){return function(r,o,s){const c=s.value;return typeof c=="function"&&(s.value=function(){this._isClosed&&new ve(Y.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",L);for(var u=arguments.length,h=new Array(u),p=0;p<u;p++)h[p]=arguments[p];const g=c.apply(this,h);return g instanceof De?new De((y,b)=>{g.then(y).catch(b)}):g}),s}}class pH extends An{constructor(o){super(),fe(this,"name","VideoProcessorDestination"),fe(this,"ID","0"),fe(this,"_source",void 0),fe(this,"videoContext",void 0),fe(this,"inputTrack",void 0),this.videoContext=o}get kind(){return"video"}get enabled(){return!0}pipe(){throw new ve(Y.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new ve(Y.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(o){if(o.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);o.track&&o.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=o.track,this.emit(Fi.ON_TRACK,o.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(Fi.ON_TRACK,void 0)}}class mH extends An{set chained(o){this._chained=o}get chained(){return this._chained}constructor(o,s){super(),fe(this,"constraintsMap",new Map),fe(this,"statsRegistry",[]),fe(this,"usageRegistry",[]),fe(this,"trackId",void 0),fe(this,"direction",void 0),fe(this,"_chained",!1),this.trackId=o,this.direction=s}async getConstraints(){return await oi(this,rs.REQUEST_CONSTRAINTS)}async requestApplyConstraints(o,s){var c;return L.info("processor ".concat(s.name," requestApplyConstraints for ").concat(this.trackId)),o&&this.constraintsMap.set(s,o),rn(this,rs.REQUEST_UPDATE_CONSTRAINTS,Array.from(xo(c=this.constraintsMap).call(c)))}async requestRevertConstraints(o){var s;if(this.constraintsMap.has(o))return L.info("processor ".concat(o.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(o),rn(this,rs.REQUEST_UPDATE_CONSTRAINTS,Array.from(xo(s=this.constraintsMap).call(s)))}registerStats(o,s,c){this.statsRegistry.find(u=>u.processorID===o.ID&&u.processorName===o.name&&u.type===s)||this.statsRegistry.push({processorName:o.name,processorID:o.ID,type:s,cb:c})}unregisterStats(o,s){const c=this.statsRegistry.findIndex(u=>u.processorID===o.ID&&u.processorName===o.name&&u.type===s);c!==-1&&this.statsRegistry.splice(c,1)}gatherStats(){const o=[];for(const{processorID:s,processorName:c,type:u,cb:h}of this.statsRegistry)try{const p=h();o.push({processorID:s,processorName:c,type:u,stats:p})}catch(p){L.error(new ve(Y.UNEXPECTED_ERROR,p.message))}return o}registerUsage(o,s){this.usageRegistry.find(c=>c.processorID===o.ID&&c.processorName===o.name)||this.usageRegistry.push({processorID:o.ID,processorName:o.name,cb:s})}unregisterUsage(o){const s=this.usageRegistry.findIndex(c=>c.processorID===o.ID&&c.processorName===o.name);s!==-1&&this.usageRegistry.splice(s,1)}async gatherUsage(){const o=[];if(!this.chained)return[];for(const{cb:s}of this.usageRegistry)try{let c=s();c instanceof De&&(c=await c),o.push(Cn(Cn({},c),{},{direction:this.direction}))}catch(c){L.error("gather extension usage error",c)}return o}getDirection(){return this.direction}}class gH extends An{constructor(o){super(),fe(this,"name","AudioProcessorDestination"),fe(this,"ID","0"),fe(this,"inputTrack",void 0),fe(this,"inputNode",void 0),fe(this,"audioProcessorContext",void 0),fe(this,"_source",void 0),this.audioProcessorContext=o}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new ve(Y.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new ve(Y.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(Fi.ON_TRACK,void 0),this.emit(Fi.ON_NODE,void 0)}updateInput(o){if(o.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);o.track&&this.inputTrack!==o.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=o.track,this.emit(Fi.ON_TRACK,this.inputTrack)),o.node&&this.inputNode!==o.node&&(this.audioProcessorContext.chained=!0,this.inputNode=o.node,this.emit(Fi.ON_NODE,this.inputNode))}}class vH extends An{set chained(o){this._chained=o}get chained(){return this._chained}constructor(o,s,c){super(),fe(this,"constraintsMap",new Map),fe(this,"statsRegistry",[]),fe(this,"audioContext",void 0),fe(this,"trackId",void 0),fe(this,"direction",void 0),fe(this,"usageRegistry",[]),fe(this,"_chained",!1),this.audioContext=o,this.trackId=s,this.direction=c}async getConstraints(){return oi(this,rs.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(o,s){var c;return L.info("processor ".concat(s.name," requestApplyConstraints for ").concat(this.trackId)),o&&this.constraintsMap.set(s,o),rn(this,rs.REQUEST_UPDATE_CONSTRAINTS,Array.from(xo(c=this.constraintsMap).call(c)))}async requestRevertConstraints(o){var s;if(this.constraintsMap.has(o))return this.constraintsMap.delete(o),rn(this,rs.REQUEST_UPDATE_CONSTRAINTS,Array.from(xo(s=this.constraintsMap).call(s)))}registerStats(o,s,c){this.statsRegistry.find(u=>u.processorID===o.ID&&u.processorName===o.name&&u.type===s)||this.statsRegistry.push({processorName:o.name,processorID:o.ID,type:s,cb:c})}unregisterStats(o,s){const c=this.statsRegistry.findIndex(u=>u.processorID===o.ID&&u.processorName===o.name&&u.type===s);c!==-1&&this.statsRegistry.splice(c,1)}gatherStats(){const o=[];for(const{processorID:s,processorName:c,type:u,cb:h}of this.statsRegistry)try{const p=h();o.push({processorID:s,processorName:c,type:u,stats:p})}catch(p){L.error(new ve(Y.UNEXPECTED_ERROR,p.message))}return o}registerUsage(o,s){this.usageRegistry.find(c=>c.processorID===o.ID&&c.processorName===o.name)||this.usageRegistry.push({processorID:o.ID,processorName:o.name,cb:s})}unregisterUsage(o){const s=this.usageRegistry.findIndex(c=>c.processorID===o.ID&&c.processorName===o.name);s!==-1&&this.usageRegistry.splice(s,1)}async gatherUsage(){const o=[];if(!this.chained)return[];for(const{cb:s}of this.usageRegistry)try{let c=s();c instanceof De&&(c=await c),o.push(Cn(Cn({},c),{},{direction:this.direction}))}catch(c){L.error("gather extension usage error",c)}return o}getDirection(){return this.direction}}class V1 extends An{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),fe(this,"context",void 0),fe(this,"processSourceNode",void 0),fe(this,"outputTrack",void 0),fe(this,"processedNode",void 0),fe(this,"clonedTrack",void 0),fe(this,"outputNode",void 0),this.outputNode=new _Ie}setVolume(){}createOutputTrack(){throw new ve(Y.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class _Ie{disconnect(){}connect(){}}function yH(r){return new De((o,s)=>{let c=!1;const u=document.createElement("video");u.setAttribute("autoplay",""),u.setAttribute("muted",""),u.muted=!0,u.autoplay=!0,u.setAttribute("playsinline",""),u.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(u);const h=Vi()?"canplay":"playing";u.addEventListener(h,()=>{const p=u.videoWidth,g=u.videoHeight;!p&&xn()||(c=!0,u.srcObject=null,u.remove(),o([p,g]))}),u.srcObject=new MediaStream([r]),u.play().catch(Mw),setTimeout(()=>{c||(u.srcObject=null,u.remove(),o([u.videoWidth,u.videoHeight]))},4e3)})}function zw(r){const o={};r.facingMode&&(o.facingMode=r.facingMode),r.cameraId&&(o.deviceId={exact:r.cameraId});const s=ma(r.encoderConfig);return s.width!=null&&(o.width=s.width),s.height!=null&&(o.height=s.height),!g8()&&s.frameRate&&(o.frameRate=s.frameRate),c8()&&typeof o.frameRate=="object"&&(o.frameRate.max=60),xn()&&(o.frameRate={ideal:30,max:30}),o}function _H(r){const o={};return g8()||(r.AGC!==void 0&&(o.autoGainControl=r.AGC),r.AEC!==void 0&&(o.echoCancellation=r.AEC),r.ANS!==void 0&&(o.noiseSuppression=r.ANS,$l()&&r.ANS&&(o.googHighpassFilter=r.ANS))),o}function EH(r){const o=_H(r);if(r.encoderConfig){const s=Gw(r.encoderConfig);o.channelCount=s.stereo?2:1,o.sampleRate=s.sampleRate,o.sampleSize=s.sampleSize}return r.microphoneId&&(o.deviceId={exact:r.microphoneId}),Dw()&&(o.sampleRate=void 0),o}const EIe=r=>{const o=r._encoderConfig;if(!o)return;const{frameRate:s,width:c,height:u}=r.getMediaStreamTrackSettings();let{frameRate:h=s,width:p=c,height:g=u}=o;if(!h||!p||!g)return;p=p1(p),g=p1(g),h=p1(h);const{max:y,min:b}=function(x,B,U){const F=200*Math.pow(U/15,.6)*Math.pow(x*B/640/360,.75);return{min:Math.floor(F),max:Math.floor(4*F)}}(p,g,h),{bitrateMax:w,bitrateMin:C}=o||{};w||L.debug("calculate bitrate: [w: ".concat(p,", h: ").concat(g,", fps: ").concat(h,"] => [brMax: ").concat(w,", brMin: ").concat(C,"]"));const{maxFramerate:A}=q("ENCODER_CONFIG_LIMIT");return A&&typeof A=="number"&&(h=Math.min(h,A)),{frameRate:h,bitrateMax:w||y,bitrateMin:C||b,scaleResolutionDownBy:1,scale:0}},bH=async(r,o,s)=>await(async(c,u,h)=>{const p=function(b){const w=[];for(let C=0;C<b.length;C+=2)w.push(parseInt(b.slice(C,C+2),16));return Uint8Array.from(w)}(N8(""+u+h)).slice(0,16),g=p.slice(0,12),y=await window.crypto.subtle.importKey("raw",p,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:g},y,c))})(r.buffer,o,s),F1=r=>{const o=document.createElement("canvas");return o.width=2,o.height=2,new De((s,c)=>{o.toBlob(async u=>{if(o.remove(),u){const h=await SH(u);s({buffer:h,width:o.width,height:o.height})}else c(new ve(Y.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},r,1)})},SH=async r=>{const o=await r.arrayBuffer();return new Uint8Array(o)};var wH,TH,CH,RH,AH,OH,IH,xH,PH,NH,DH,kH,LH,MH,jH,UH,VH,FH,In,BH,$H,WH,GH,HH,KH,Xc,zH,YH,qH,XH,JH,QH,ZH,eK,tK,nK,rK,iK,oK,ai;let jn=(wH=Qe({argsMap:(r,o)=>[r.getTrackId(),o],throttleTime:300}),TH=Qe({argsMap:(r,o)=>[r.getTrackId(),o]}),CH=Bn(),RH=ym("LocalAudioTrack","_enabledMutex"),AH=Qe({argsMap:(r,o)=>[r.getTrackId(),o]}),OH=Bn(),IH=ym("LocalAudioTrack","_enabledMutex"),xH=Qe({argsMap:(r,o)=>[r.getTrackId(),o]}),PH=Bn(),NH=Bn(),DH=Bn(),kH=Qe({argsMap:r=>[r.getTrackId()]}),LH=Bn(),MH=Qe({argsMap:r=>[r.getTrackId()]}),jH=Bn(),UH=Qe({argsMap:r=>[r.getTrackId()]}),VH=Qe({argsMap:(r,o)=>[r.getTrackId(),o.name]}),FH=Qe({argsMap:r=>[r.getTrackId()]}),Tt((In=class extends Am{get _source(){return this.initWebAudio()}set _source(r){this._trackSource=r}get processorContext(){return this._processorContext||(this._processorContext=this.initProcessor().processorContext),this._processorContext}get processorDestination(){return this._processorDestination||(this._processorDestination=this.initProcessor().processorDestination),this._processorDestination}get isPlaying(){return this._useAudioElement?Zi.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(r,o,s,c){super(r,s),fe(this,"trackMediaType",Rm.AUDIO),fe(this,"_encoderConfig",void 0),fe(this,"_trackSource",void 0),fe(this,"metadata",[]),fe(this,"_enabled",!0),fe(this,"_volume",100),fe(this,"_useAudioElement",!0),fe(this,"_bypassWebAudio",!1),fe(this,"processor",void 0),fe(this,"_processorContext",void 0),fe(this,"_processorDestination",void 0),fe(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=o,this._getOriginVolumeLevel=!!c,this._trackSource=new V1,q("DISABLE_WEBAUDIO")&&(this._bypassWebAudio=!0),q("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),ri()&&!is?setTimeout(()=>this.initWebAudio()):this.initWebAudio()}setVolume(r){Qt(r,"volume",0,1e3),this._volume=r,this._source.setVolume(r/100),this._useAudioElement&&Zi.setVolume(this.getTrackId(),r);try{if(this._bypassWebAudio)return void L.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const o=this._source.createOutputTrack();this._mediaStreamTrack!==o&&(this._mediaStreamTrack=o,rn(this,Fe.NEED_REPLACE_TRACK,this).then(()=>{L.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(s=>{L.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),s)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(r){if(!this._useAudioElement||!J8())throw new ve(Y.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Zi.setSinkID(this.getTrackId(),r)}async setEnabled(r,o,s){return this._setEnabled(r,o,s)}async _setEnabled(r,o,s){if(!s){if(r===this._enabled)return;this.stateCheck("enabled",r)}if(L.info("[".concat(this.getTrackId(),"] start setEnabled"),r),r){this._originMediaStreamTrack.enabled=!0;try{s||(this._enabled=!0),await rn(this,Fe.NEED_ENABLE_TRACK,this),L.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(r," success"))}catch(c){throw s||(this._enabled=!1),L.error("[".concat(this.getTrackId(),"] setEnabled to true error"),c.toString()),c}}else{this._originMediaStreamTrack.enabled=!1,s||(this._enabled=!1);try{await rn(this,Fe.NEED_DISABLE_TRACK,this)}catch(c){throw s||(this._enabled=!0),L.error("[".concat(this.getTrackId(),"] setEnabled to false error"),c.toString()),c}}}async setMuted(r){r!==this._muted&&(this.stateCheck("muted",r),this._muted=r,this._originMediaStreamTrack.enabled=!r,L.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(r)),r?await rn(this,Fe.NEED_MUTE_TRACK,this):await rn(this,Fe.NEED_UNMUTE_TRACK,this))}getStats(){return ud(()=>{L.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),Zo(this,Fe.GET_STATS)||Cn({},N1)}setAudioFrameCallback(r){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!r)return this._source.removeAllListeners(ns.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(o),this._source.removeAllListeners(ns.ON_AUDIO_BUFFER),this._source.on(ns.ON_AUDIO_BUFFER,s=>r(s))}play(){L.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(L.debug("[".concat(this.getTrackId(),"] start audio playback in element")),Zi.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){L.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?Zi.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this._processorDestination&&this.unbindProcessorDestinationEvents(this._processorDestination),this._processorContext&&this.unbindProcessorContextEvents(this._processorContext),this.unpipe(),this._processorDestination&&this._processorDestination._source&&this._processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];L.debug("[".concat(this.getTrackId(),"] update player source track")),r&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Zi.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(r,o){this._originMediaStreamTrack!==r&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),o&&this._originMediaStreamTrack.stop()),r.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=r,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this._processorContext&&this.processor.updateInput({track:r,context:this._processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await rn(this,Fe.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(r))}renewMediaStreamTrack(r){return De.resolve(void 0)}pipe(r){if(this._bypassWebAudio)throw new ve(Y.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===r)return r;if(r._source)throw new ve(Y.INVALID_OPERATION,"Processor ".concat(r.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=r,this.processor._source=this,r.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),r}unpipe(){var r;if(!this.processor)return;const o=this.processor;(r=this._source.processSourceNode)===null||r===void 0||r.disconnect(),this.processor._source=!1,this.processor=void 0,o.reset()}bindProcessorDestinationEvents(r){r.on(Fi.ON_TRACK,async o=>{o?o!==this._mediaStreamTrack&&(this._mediaStreamTrack=o,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(o),await rn(this,Fe.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await rn(this,Fe.NEED_REPLACE_TRACK,this))}),r.on(Fi.ON_NODE,o=>{this._source.processedNode=o})}unbindProcessorDestinationEvents(r){r.removeAllListeners(Fi.ON_TRACK),r.removeAllListeners(Fi.ON_NODE)}bindProcessorContextEvents(r){r.on(rs.REQUEST_CONSTRAINTS,async o=>{o(this._originMediaStreamTrack.getSettings())})}unbindProcessorContextEvents(r){r.removeAllListeners(rs.REQUEST_CONSTRAINTS)}initWebAudio(){return this._trackSource instanceof V1&&(this._trackSource=new aH(this._mediaStreamTrack,!1,this._getOriginVolumeLevel?this._mediaStreamTrack:void 0)),this._trackSource}initProcessor(){const r=new vH(this._source.context,this.getTrackId(),"local"),o=new gH(r);return this._processorContext=r,this._processorDestination=o,this.bindProcessorContextEvents(r),this.bindProcessorDestinationEvents(o),this._source.on(ns.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:r})}),this._useAudioElement&&(this._useAudioElement=!1,this.isPlaying&&(Zi.stop(this.getTrackId()),this._source.play()),rn(this,Fe.NEED_REPLACE_MIXING_TRACK,this).then(()=>{L.debug("[".concat(this.getTrackId(),"] replace from origin track to web audio track success"))}).catch(s=>{L.warning("[".concat(this.getTrackId(),"] replace from origin track to web audio track failed"),s)})),{processorContext:r,processorDestination:o}}}).prototype,"setVolume",[wH],Object.getOwnPropertyDescriptor(In.prototype,"setVolume"),In.prototype),Tt(In.prototype,"setPlaybackDevice",[TH,CH],Object.getOwnPropertyDescriptor(In.prototype,"setPlaybackDevice"),In.prototype),Tt(In.prototype,"setEnabled",[RH,AH,OH],Object.getOwnPropertyDescriptor(In.prototype,"setEnabled"),In.prototype),Tt(In.prototype,"setMuted",[IH,xH,PH],Object.getOwnPropertyDescriptor(In.prototype,"setMuted"),In.prototype),Tt(In.prototype,"getStats",[NH],Object.getOwnPropertyDescriptor(In.prototype,"getStats"),In.prototype),Tt(In.prototype,"setAudioFrameCallback",[DH],Object.getOwnPropertyDescriptor(In.prototype,"setAudioFrameCallback"),In.prototype),Tt(In.prototype,"play",[kH,LH],Object.getOwnPropertyDescriptor(In.prototype,"play"),In.prototype),Tt(In.prototype,"stop",[MH,jH],Object.getOwnPropertyDescriptor(In.prototype,"stop"),In.prototype),Tt(In.prototype,"close",[UH],Object.getOwnPropertyDescriptor(In.prototype,"close"),In.prototype),Tt(In.prototype,"pipe",[VH],Object.getOwnPropertyDescriptor(In.prototype,"pipe"),In.prototype),Tt(In.prototype,"unpipe",[FH],Object.getOwnPropertyDescriptor(In.prototype,"unpipe"),In.prototype),In),p_=(BH=Qe({argsMap:(r,o)=>[r.getTrackId(),o]}),$H=Bn(),WH=ym("MicrophoneAudioTrack","_enabledMutex"),GH=Qe({argsMap:(r,o,s)=>[r.getTrackId(),o,s]}),HH=Bn(),KH=Qe({argsMap:r=>[r.getTrackId()]}),Tt((Xc=class extends jn{get __className__(){return"MicrophoneAudioTrack"}constructor(r,o,s,c){super(r,o.encoderConfig?Gw(o.encoderConfig):{},c,q("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),fe(this,"_config",void 0),fe(this,"_deviceName","default"),fe(this,"_constraints",void 0),fe(this,"_originalConstraints",void 0),fe(this,"_enabled",!0),this._config=o,this._constraints=s,this._originalConstraints=s,this._deviceName=r.label,typeof o.bypassWebAudio=="boolean"&&(this._bypassWebAudio=o.bypassWebAudio),(mm()||s1())&&qt.bindInterruptDetectorTrack(this)}async setDevice(r){if(L.info("[".concat(this.getTrackId(),"] start set device to ").concat(r)),this._enabled)try{const o=await ss.getDeviceById(r),s={};s.audio=Cn({},this._constraints),s.audio.deviceId={exact:r},this._originMediaStreamTrack.stop();let c=null;try{c=await os(s,this.getTrackId())}catch(u){throw L.error("[".concat(this.getTrackId(),"] setDevice failed"),u.toString()),c=await os({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(c.getAudioTracks()[0],!1),u}await this._updateOriginMediaStreamTrack(c.getAudioTracks()[0],!1),this._deviceName=o.label,this._config.microphoneId=r,this._constraints.deviceId={exact:r}}catch(o){throw L.error("[".concat(this.getTrackId(),"] setDevice error"),o.toString()),o}else try{const o=await ss.getDeviceById(r);this._deviceName=o.label,this._config.microphoneId=r,this._constraints.deviceId={exact:r}}catch(o){throw L.error("[".concat(this.getTrackId(),"] setDevice error"),o.toString()),o}L.info("[".concat(this.getTrackId(),"] set device to ").concat(r," success"))}async setEnabled(r,o,s){if(o)return L.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(r);if(!s){if(r===this._enabled)return;this.stateCheck("enabled",r)}if(L.info("[".concat(this.getTrackId(),"] start setEnabled"),r),q("AUTO_RESET_AUDIO_ROUTE")&&(Vi()||ha())){const p=navigator.audioSession;p&&(r||(p.type="playback"),p.type="auto")}if(!r){var c;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(c=this._source.clonedTrack)===null||c===void 0||c.stop(),s||(this._enabled=!1);try{await rn(this,Fe.NEED_DISABLE_TRACK,this)}catch(p){throw L.error("[".concat(this.getTrackId(),"] setEnabled false failed"),p.toString()),p}return}const u=Cn({},this._constraints),h=ss.searchDeviceIdByName(this._deviceName);h&&!u.deviceId&&(u.deviceId=h);try{s||(this._enabled=!0);const p=await os({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(p.getAudioTracks()[0],!1),await rn(this,Fe.NEED_ENABLE_TRACK,this)}catch(p){throw s||(this._enabled=!1),L.error("[".concat(this.getTrackId(),"] setEnabled true failed"),p.toString()),p}L.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(mm()||s1())&&qt.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((Vi()||ha())&&this._enabled&&!this._isClosed&&qt.duringInterruption){const r=async()=>{qt.off(Yr.IOS_INTERRUPTION_END,r),this._enabled&&!this._isClosed&&(L.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};qt.on(Yr.IOS_INTERRUPTION_END,r)}else L.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Tm.TRACK_ENDED)}async renewMediaStreamTrack(r){const o=r||this._constraints,s=ss.searchDeviceIdByName(this._deviceName);if(s&&!o.deviceId&&(o.deviceId=s),this._constraints=o,this._enabled){this._originMediaStreamTrack.stop();const c=await os({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(c.getAudioTracks()[0],!0)}}bindProcessorContextEvents(r){super.bindProcessorContextEvents(r),r.on(rs.REQUEST_UPDATE_CONSTRAINTS,async(o,s,c)=>{try{const u=Object.assign({},this._originalConstraints,...o);await this.renewMediaStreamTrack(u),s()}catch(u){c(u)}})}unbindProcessorContextEvents(r){super.unbindProcessorContextEvents(r),r.removeAllListeners(rs.REQUEST_UPDATE_CONSTRAINTS)}}).prototype,"setDevice",[BH,$H],Object.getOwnPropertyDescriptor(Xc.prototype,"setDevice"),Xc.prototype),Tt(Xc.prototype,"setEnabled",[WH,GH,HH],Object.getOwnPropertyDescriptor(Xc.prototype,"setEnabled"),Xc.prototype),Tt(Xc.prototype,"close",[KH],Object.getOwnPropertyDescriptor(Xc.prototype,"close"),Xc.prototype),Xc),bIe=(zH=Qe({argsMap:(r,o)=>[r.getTrackId(),o,r.duration]}),YH=Bn(),qH=Qe({argsMap:r=>[r.getTrackId()]}),XH=Bn(),JH=Qe({argsMap:r=>[r.getTrackId()]}),QH=Bn(),ZH=Qe({argsMap:r=>[r.getTrackId()]}),eK=Bn(),tK=Qe({argsMap:r=>[r.getTrackId()]}),nK=Bn(),rK=Qe({argsMap:r=>[r.getTrackId()]}),iK=Qe({argsMap:r=>[r.getTrackId()]}),oK=Bn(),Tt((ai=class extends jn{get __className__(){return"BufferSourceAudioTrack"}constructor(r,o,s,c){super(o.createOutputTrack(),s,c),fe(this,"source",void 0),fe(this,"_bufferSource",void 0),this._useAudioElement=!1,this.source=r,this._bufferSource=o,this._bufferSource.on(ns.AUDIO_SOURCE_STATE_CHANGE,u=>{this.safeEmit(Tm.SOURCE_STATE_CHANGE,u)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(r){r&&this._bufferSource.updateOptions(r),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(r){this._bufferSource.seekAudioBuffer(r)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(r){Qt(r,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(r)}}).prototype,"startProcessAudioBuffer",[zH,YH],Object.getOwnPropertyDescriptor(ai.prototype,"startProcessAudioBuffer"),ai.prototype),Tt(ai.prototype,"pauseProcessAudioBuffer",[qH,XH],Object.getOwnPropertyDescriptor(ai.prototype,"pauseProcessAudioBuffer"),ai.prototype),Tt(ai.prototype,"seekAudioBuffer",[JH,QH],Object.getOwnPropertyDescriptor(ai.prototype,"seekAudioBuffer"),ai.prototype),Tt(ai.prototype,"resumeProcessAudioBuffer",[ZH,eK],Object.getOwnPropertyDescriptor(ai.prototype,"resumeProcessAudioBuffer"),ai.prototype),Tt(ai.prototype,"stopProcessAudioBuffer",[tK,nK],Object.getOwnPropertyDescriptor(ai.prototype,"stopProcessAudioBuffer"),ai.prototype),Tt(ai.prototype,"close",[rK],Object.getOwnPropertyDescriptor(ai.prototype,"close"),ai.prototype),Tt(ai.prototype,"setAudioBufferPlaybackSpeed",[iK,oK],Object.getOwnPropertyDescriptor(ai.prototype,"setAudioBufferPlaybackSpeed"),ai.prototype),ai);class lr extends jn{get __className__(){return"MixingAudioTrack"}get isActive(){for(const o of this.trackList)if(o._enabled&&!o._isClosed&&!o.muted)return!0;return!1}constructor(){const o=Om().createMediaStreamDestination();super(o.stream.getAudioTracks()[0],void 0,cn(8,"track-mix-")),fe(this,"trackList",void 0),fe(this,"destNode",void 0),this._useAudioElement=!1;try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=o,this.trackList=[]}hasAudioTrack(o){return this.trackList.indexOf(o)!==-1}addAudioTrack(o){this.trackList.indexOf(o)===-1?(L.debug("add ".concat(o.getTrackId()," to mixing track")),o._source.outputNode.connect(this.destNode),this.trackList.push(o),this.updateEncoderConfig()):L.debug("track ".concat(o.getTrackId()," is already added"))}removeAudioTrack(o){if(this.trackList.indexOf(o)!==-1){L.debug("remove ".concat(o.getTrackId()," from mixing track"));try{o._source.outputNode.disconnect(this.destNode)}catch{}kw(this.trackList,o),this.updateEncoderConfig()}}updateEncoderConfig(){const o={};this.trackList.forEach(s=>{s._encoderConfig&&((s._encoderConfig.bitrate||0)>(o.bitrate||0)&&(o.bitrate=s._encoderConfig.bitrate),(s._encoderConfig.sampleRate||0)>(o.sampleRate||0)&&(o.sampleRate=s._encoderConfig.sampleRate),(s._encoderConfig.sampleSize||0)>(o.sampleSize||0)&&(o.sampleSize=s._encoderConfig.sampleSize),s._encoderConfig.stereo&&(o.stereo=!0))}),this._encoderConfig=o}_updateRtpTransceiver(o){this._rtpTransceiver!==o&&(this._rtpTransceiver=o,this.trackList.forEach(s=>{s instanceof lr?s.emit(cf.TRANSCEIVER_UPDATED,o):s._updateRtpTransceiver(o)}))}}class SIe extends sH{set currentState(o){o!==this._currentState&&(this._currentState=o,this.safeEmit(ns.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(o){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),fe(this,"audioBuffer",void 0),fe(this,"sourceNode",void 0),fe(this,"startPlayTime",0),fe(this,"startPlayOffset",0),fe(this,"pausePlayTime",0),fe(this,"options",void 0),fe(this,"currentLoopCount",0),fe(this,"currentPlaybackSpeed",100),fe(this,"_currentState","stopped"),this.audioBuffer=o,this.options=s,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(o){this.currentState==="stopped"?(this.options=o,this.startPlayOffset=this.options.startPlayTime||0):L.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(o){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=o,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=o))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(o){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=o/100),this.currentPlaybackSpeed=o}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const o=this.context.createBufferSource();return o.buffer=this.audioBuffer,o.loop=!!this.options.loop,o.connect(this.outputNode),o.playbackRate.value=this.currentPlaybackSpeed/100,o}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const sK=new Map;function aK(r,o){if(r.length===0||o.length===0)return 1/0;const s=m1(r),c=m1(o);return Math.floor(c/s)}class B1{get rendFrameRate(){const o=Math.max(1,aK(this._render_interframe_delays_sizes,this._render_interframe_delays));return Math.floor(1e3/o)}get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(o){o!==this._videoElementStatus&&(L.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(o)),this._videoElementStatus=o)}get videoState(){return this._videoState}set videoState(o){var s;o!==this._videoState&&(this._videoState=o,(s=this.onVideoStateChanged)===null||s===void 0||s.call(this,this.videoState))}constructor(o){fe(this,"trackId",void 0),fe(this,"config",void 0),fe(this,"onFirstVideoFrameDecoded",void 0),fe(this,"onVideoStateChanged",void 0),fe(this,"freezeTimeCounterList",[]),fe(this,"renderFreezeAccTime",0),fe(this,"renderFreezeAccTime2",0),fe(this,"isKeepLastFrame",!1),fe(this,"timeUpdatedCount",0),fe(this,"freezeTime",0),fe(this,"playbackTime",0),fe(this,"lastTimeUpdatedTime",0),fe(this,"autoplayFailed",!1),fe(this,"videoTrack",void 0),fe(this,"videoElement",void 0),fe(this,"cacheVideoElement",void 0),fe(this,"_render_interframe_delays",[]),fe(this,"_render_interframe_delays_sizes",[]),fe(this,"_videoState",qc.VideoStateStopped),fe(this,"videoElementCheckInterval",void 0),fe(this,"videoElementFreezeTimeout",void 0),fe(this,"_videoElementStatus",wi.NONE),fe(this,"isGettingVideoDimensions",!1),fe(this,"startGetVideoDimensions",()=>{const s=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return L.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(s,500)};!this.isGettingVideoDimensions&&s()}),fe(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&qt.curState==="running"&&(L.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(a8())),p8()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),fe(this,"handleVideoEvents",s=>{switch(s.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=wi.PLAYING;break;case"loadeddata":if(this.videoState=qc.VideoStateStarting,this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=wi.CANPLAY;break;case"stalled":this.videoElementStatus=wi.STALLED;break;case"suspend":this.videoElementStatus=wi.SUSPEND;break;case"pause":this.videoElementStatus=wi.PAUSED,Vi()||ha()||ri()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(L.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=wi.WAITING;break;case"abort":this.videoElementStatus=wi.ABORT;break;case"ended":this.videoElementStatus=wi.ENDED;break;case"emptied":this.videoElementStatus=wi.EMPTIED;break;case"error":{const c=this.videoElement.error;c&&(this.videoElementStatus=wi.ERROR,L.error("[".concat(this.trackId,"] media error: ").concat(c.message," (").concat(c.code,")")));break}case"timeupdate":{const c=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=c);const u=c-this.lastTimeUpdatedTime,h=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=c,Jc.lastVisibleTime<Jc.lastHiddenTime||h<Jc.lastHiddenTime||h<Jc.lastVisibleTime)return;for(u>q("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=u),this.playbackTime+=u;this.playbackTime>=6e3;){this.playbackTime-=6e3;const p=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(p),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),fe(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(L.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(a8())),p8()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=o.trackId,this.config=o,o.element instanceof HTMLVideoElement?this.videoElement=o.element:this.videoElement=document.createElement("video"),qt.on(Yr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),qt.on(Yr.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var o;return(o=this.videoElement.parentElement)!==null&&o!==void 0?o:void 0}updateConfig(o){this.config=o,this.trackId=o.trackId,o.element!==this.videoElement&&(this.destroy(),this.videoElement=o.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(o){this.videoTrack!==o&&(this.videoTrack=o,this.initVideoElement())}play(o){const s=this.videoElement.play();s&&s.catch&&s.catch(u=>{o&&fH(o,"video",u.message,this.trackId),u.name==="NotAllowedError"?(L.warning("detected video element autoplay failed",u),this.autoplayFailed=!0,this.handleAutoPlayFailed()):L.warning("[".concat(this.trackId,"] play warning: "),u)});const c=It();if((c.name==="Safari"&&Number(c.version)===15||mm())&&s&&s.then){const u=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};s.then(u).catch(u)}}getCurrentFrame(){const o=document.createElement("canvas");o.width=this.videoElement.videoWidth,o.height=this.videoElement.videoHeight;const s=o.getContext("2d");if(!s)return L.error("create canvas context failed!"),new ImageData(2,2);s.drawImage(this.videoElement,0,0,o.width,o.height);const c=s.getImageData(0,0,o.width,o.height);return o.remove(),c}async getCurrentFrameToUint8Array(o){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const c=document.createElement("canvas");c.width=this.videoElement.videoWidth,c.height=this.videoElement.videoHeight;const u=c.getContext("2d");return u?(u.drawImage(this.videoElement,0,0,c.width,c.height),new De((h,p)=>{c.toBlob(async g=>{if(c.remove(),g){const y=await SH(g);h({buffer:y,width:c.width,height:c.height})}else p(new ve(Y.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},o,s<0?.1:s>1?1:s)})):await F1(o)}destroy(){qt.off(Yr.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),qt.off(Yr.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[],this.videoState=qc.VideoStateStopped}initVideoElement(){if(this.videoElementStatus=wi.INIT,!this.videoElementCheckInterval&&(cK.forEach(h=>{this.videoElement.addEventListener(h,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{(function(h){return h!==document.body&&document.body.contains(h)})(this.videoElement)||(this.videoElementStatus=wi.DESTROYED)},1e3),q("ENABLE_VIDEO_FRAME_CALLBACK"))){var o,s;let h;const p=()=>{document.visibilityState==="visible"&&(document.removeEventListener("visibilitychange",p),this.videoElementFreezeTimeout=window.setTimeout(g,q("VIDEO_FREEZE_DURATION")))},g=()=>{this.videoElementFreezeTimeout=void 0,this.videoState===qc.VideoStateDecoding&&(document.visibilityState==="visible"?this.videoState=qc.VideoStateFrozen:document.addEventListener("visibilitychange",p))},y=(b,w)=>{if(this.videoElementStatus===wi.PLAYING){if(h){const x=w.presentationTime-h.presentationTime,B=w.presentedFrames-h.presentedFrames;this._render_interframe_delays_sizes.push(B),this._render_interframe_delays.push(x);const U=m1(this._render_interframe_delays_sizes),F=U-this._render_interframe_delays_sizes[0];if(U>30&&F>5&&(this._render_interframe_delays_sizes.shift(),this._render_interframe_delays.shift()),this.videoState===qc.VideoStateStarting&&(this.videoState=qc.VideoStateDecoding),this.videoState===qc.VideoStateDecoding&&this.onVideoStateChanged&&(this.videoElementFreezeTimeout&&window.clearTimeout(this.videoElementFreezeTimeout),this.videoElementFreezeTimeout=window.setTimeout(g,q("VIDEO_FREEZE_DURATION"))),x<q("VIDEO_FREEZE_DURATION")&&this.videoState===qc.VideoStateFrozen&&(this.videoState=qc.VideoStateDecoding),x>q("VIDEO_FREEZE_DURATION")&&Jc.lastVisibleTime>=Jc.lastHiddenTime&&h.timestamp>Jc.lastVisibleTime&&h.timestamp>Jc.lastHiddenTime){const K=Math.min(66,aK(this._render_interframe_delays_sizes,this._render_interframe_delays)),z=Math.max(0,x-(B-1)*K);this.renderFreezeAccTime2+=z>K?z:0,this.renderFreezeAccTime+=x}}h=Cn(Cn({},w),{},{timestamp:b})}var C,A;q("ENABLE_VIDEO_FRAME_CALLBACK")&&((C=(A=this.videoElement).requestVideoFrameCallback)===null||C===void 0||C.call(A,y))};(o=(s=this.videoElement).requestVideoFrameCallback)===null||o===void 0||o.call(s,y)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),Dw()&&!q("HIDE_NO_POSTER")&&(this.videoElement.poster="noposter");const c=It();c.name==="Safari"&&Number(c.version)===15||mm()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,xn()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,xn()&&this.videoElement.load());const u=this.videoElement.play();u!==void 0&&u.catch(h=>{L.debug("[".concat(this.trackId,"] playback interrupted"),h.toString())})}resetVideoElement(){cK.forEach(o=>{this.videoElement&&this.videoElement.removeEventListener(o,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=wi.NONE}handleAutoPlayFailed(){const o=s=>{s.preventDefault(),this.videoElement.play().then(()=>{L.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(c=>{L.error(c)}),this.autoplayFailed=!1,i_()?document.body.removeEventListener("click",o,!0):(document.body.removeEventListener("touchstart",o,!0),document.body.removeEventListener("mousedown",o,!0))};i_()?document.body.addEventListener("click",o,!0):(document.body.addEventListener("touchstart",o,!0),document.body.addEventListener("mousedown",o,!0)),hH()}}const cK=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class lK extends B1{constructor(o){super(o),fe(this,"container",void 0),fe(this,"slot",void 0),this.slot=o.element,this.updateConfig(o)}updateConfig(o){this.config=o,this.trackId=o.trackId;const s=o.element;s!==this.slot&&(this.destroy(),this.slot=s),this.createElements()}updateVideoTrack(o){this.videoTrack!==o&&(this.videoTrack=o,this.createElements())}play(o){var s;(s=this.container)!==null&&s!==void 0&&s.contains(this.videoElement)&&super.play(o)}getCurrentFrame(){var o;return(o=this.container)!==null&&o!==void 0&&o.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(o){var s;let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(s=this.container)!==null&&s!==void 0&&s.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(o,c):await F1(o)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",q("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var o;!this.container||(o=this.container)!==null&&o!==void 0&&o.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var o;if((o=this.container)!==null&&o!==void 0&&o.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var o;(o=this.container)!==null&&o!==void 0&&o.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}var uK,dK,hK,fK,pK,mK,gK,vK,yK,_K,EK,bK,SK,wK,TK,CK,RK,AK,OK,IK,xK,PK,NK,DK,kK,LK,Et,MK,jK,UK,VK,FK,BK,$K,WK,cs;let pn=(uK=Qe({argsMap:(r,o,s)=>[r.getTrackId(),typeof o=="string"?o:o instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",s]}),dK=Bn(),hK=Qe({argsMap:r=>[r.getTrackId()]}),fK=ym("LocalVideoTrack","_enabledMutex"),pK=Qe({argsMap:(r,o)=>[r.getTrackId(),o]}),mK=Bn(),gK=ym("LocalVideoTrack","_enabledMutex"),vK=Qe({argsMap:(r,o)=>[r.getTrackId(),o]}),yK=Bn(),_K=Qe({argsMap:(r,o)=>[r.getTrackId(),o,r._saveEncodeBitrateRatio]}),EK=Bn(),bK=Qe({argsMap:(r,o)=>[r.getTrackId(),o]}),SK=Bn(),wK=Bn(),TK=Qe({argsMap:(r,o,s)=>[r.getTrackId(),o,s]}),CK=Bn(),RK=Bn(),AK=Bn(),OK=Bn(),IK=Bn(),xK=Bn(),PK=Bn(),NK=Qe({argsMap:(r,o)=>[r.getTrackId(),o.name]}),DK=Qe({argsMap:r=>[r.getTrackId()]}),kK=Qe({argsMap:r=>[r.getTrackId()]}),LK=Qe({argsMap:(r,o,s)=>[r.getTrackId(),o.label,s]}),Et=class vge extends Am{get videoHeight(){if(ri()){const{height:o}=this._mediaStreamTrack.getSettings();return this._videoHeight=o,this._videoHeight}return this._videoHeight}get videoWidth(){if(ri()){const{width:o}=this._mediaStreamTrack.getSettings();return this._videoWidth=o,this._videoWidth}return this._videoWidth}get isPlaying(){return!(!this._player||this._player.videoElementStatus!==wi.PLAYING)}get processorDestination(){return this._processorDestination}get processorContext(){return this._processorContext}set processorContext(o){this._processorContext=o}get __className__(){return"LocalVideoTrack"}constructor(o,s,c,u,h,p){if(super(o,h),fe(this,"trackMediaType",Rm.VIDEO),fe(this,"_player",void 0),fe(this,"isUseScaleResolutionDownBy",!1),fe(this,"_videoVisibleTimer",null),fe(this,"_previousVideoVisibleStatus",void 0),fe(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),fe(this,"_encoderConfig",void 0),fe(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),fe(this,"_optimizationMode",void 0),fe(this,"_saveEncodeBitrateRatio",1),fe(this,"_videoHeight",void 0),fe(this,"_videoWidth",void 0),fe(this,"_forceBitrateLimit",void 0),fe(this,"_enabled",!0),fe(this,"_processorDestination",void 0),fe(this,"_processorContext",void 0),ri()){const{width:g,height:y}=o.getSettings();this._videoWidth=g,this._videoHeight=y}else this.updateMediaStreamTrackResolution();if(this._scalabilityMode=c,this._optimizationMode=u,this._hints=p||[],s&&this._hints.indexOf(Zt.CUSTOM_TRACK)!==-1?this._encoderConfig=On(s):this._encoderConfig=s,this._hints.indexOf(Zt.SCREEN_TRACK)===-1)this.updateBitrateFromProfile();else if(r1(Mt.CHROME,115)&&Pw().indexOf("Windows")!==-1){const g=function(y,b){if("VideoFrame"in window&&"TransformStream"in window&&xt().supportWebRTCInsertableStream){const w=new MediaStreamTrackProcessor(y),C=new MediaStreamTrackGenerator({kind:"video"});let A,x,B=Date.now();const U=()=>{F&&(clearInterval(F),F=void 0),A&&(A.close(),A=void 0),y.stop(),x=void 0,C.removeEventListener("ended",U)};let F=window.setInterval(()=>{if(x&&A&&Date.now()-B>1e3)try{C.readyState==="live"?x.enqueue(A.clone()):U()}catch{U()}},1e3);const K=new TransformStream({transform:(z,Q)=>{C.readyState==="live"?(x=Q,B=Date.now(),A===void 0?(A=z,Q.enqueue(z.clone())):(Q.enqueue(A),A=z)):z.close()}});return C.addEventListener("ended",U),w.readable.pipeThrough(K).pipeTo(C.writable),C}}(o);g&&(L.info("local screen video track begin to inject frame"),this._mediaStreamTrack=g)}s&&this._hints.indexOf(Zt.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(s),this._processorContext=new mH(this.getTrackId(),"local"),this._processorDestination=new pH(this.processorContext),this.bindProcessorDestinationEvents()}play(o){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof o=="string"){const u=document.getElementById(o);u?o=u:(L.warning("[".concat(this.getTrackId(),'] can not find "#').concat(o,'" element, use document.body')),o=document.body)}L.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(o instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(s));const c=Cn(Cn(Cn({},this._getDefaultPlayerConfig()),s),{},{trackId:this.getTrackId(),element:o});this._player?this._player.updateConfig(c):(o instanceof HTMLVideoElement?this._player=new B1(c):this._player=new lK(c),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const u=this.getVideoElementVisibleStatus();this.safeEmit(Tm.VIDEO_ELEMENT_VISIBLE_STATUS,u)}catch{}},q("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,L.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(o,s){if(!s){if(o===this._enabled)return;this.stateCheck("enabled",o)}if(L.info("[".concat(this.getTrackId(),"] start setEnabled"),o),!o){this._originMediaStreamTrack.enabled=!1;try{await rn(this,Fe.NEED_DISABLE_TRACK,this)}catch(c){throw L.error("[".concat(this.getTrackId(),"] setEnabled to false error"),c.toString()),c}return s||(this._enabled=!1),void L.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await rn(this,Fe.NEED_ENABLE_TRACK,this)}catch(c){throw L.error("[".concat(this.getTrackId(),"] setEnabled to true error"),c.toString()),c}L.info("[".concat(this.getTrackId(),"] setEnabled to true success")),s||(this._enabled=!0)}async setMuted(o){o!==this._muted&&(this.stateCheck("muted",o),this._muted=o,this._originMediaStreamTrack.enabled=!o,L.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(o)),o?await rn(this,Fe.NEED_MUTE_TRACK,this):await rn(this,Fe.NEED_UNMUTE_TRACK,this))}async setSaveEncodeBitrateRatio(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._saveEncodeBitrateRatio;if(this._saveEncodeBitrateRatio!==1&&this._encoderConfig&&this._encoderConfig.bitrateMax&&this._encoderConfig.bitrateMin){this._encoderConfig.bitrateMin=Math.floor(this._encoderConfig.bitrateMin*o),this._encoderConfig.bitrateMax=Math.floor(this._encoderConfig.bitrateMax*o),L.debug("[".concat(this.getTrackId(),"] set save encode bitrate ratio, ").concat(o)),this._saveEncodeBitrateRatio=1;try{await rn(this,Fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(s){return s.throw(L)}}}async setEncoderConfiguration(o,s){if(!this._enabled)throw new ve(Y.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(o=ma(o),q("USE_STANDARD_BITRATE_DEFAULT")&&(delete o.bitrateMax,delete o.bitrateMin),this._forceBitrateLimit&&(o.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:o.bitrateMax,o.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:o.bitrateMin),o.width||o.height||o.frameRate){const c=zw({encoderConfig:o});(ri()||Vi()||ha())&&(c.deviceId=void 0),L.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(o),JSON.stringify(c));try{await this._originMediaStreamTrack.applyConstraints(c),this.updateMediaStreamTrackResolution()}catch(u){const h=new ve(Y.UNEXPECTED_ERROR,u.toString());throw L.error("[".concat(this.getTrackId(),"] applyConstraints error"),h.toString()),h}}this._encoderConfig=o,this._hints.indexOf(Zt.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await rn(this,Fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(c){return c.throw(L)}}getStats(){return ud(()=>{L.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),Zo(this,Fe.GET_STATS)||Cn({},D1)}async setBeautyEffect(o){L.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(o){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(o,s):await F1(o)}async setBitrateLimit(o){L.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(o))),o&&(this._forceBitrateLimit=o,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<o.max_bitrate?this._encoderConfig.bitrateMax:o.max_bitrate:this._encoderConfig.bitrateMax=o.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=o.min_bitrate))}async setOptimizationMode(o){if(o!=="motion"&&o!=="detail"&&o!=="balanced")return void L.error(Y.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const s=this._optimizationMode;try{this._optimizationMode=o,await rn(this,Fe.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this)}catch(c){throw this._optimizationMode=s,L.error("[".concat(this.getTrackId(),"] set optimization mode failed"),c.toString()),c}L.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(o,")"))}setScalabiltyMode(o){if(o.numSpatialLayers===1&&o.numTemporalLayers!==1)return L.error(Y.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=o,L.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(o,")"))}updateMediaStreamTrackResolution(){yH(this._originMediaStreamTrack).then(o=>{let[s,c]=o;this._videoHeight=c,this._videoWidth=s}).catch(Mw)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(o){if(!this._enabled)throw new ve(Y.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");L.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(o)),o=ma(o),this._forceBitrateLimit&&(o.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:o.bitrateMax,o.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:o.bitrateMin),this._encoderConfig=o,this._hints.indexOf(Zt.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await rn(this,Fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(s){return s.throw(L)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:o,height:s,frameRate:c}=this.getMediaStreamTrackSettings();if(!o||!s||!c)return;const{bitrateMax:u,bitrateMin:h}=this._encoderConfig;if(h==null||u==null){const{max:p,min:g}=function(y,b,w,C,A){const x=q("BITRATE_ADAPTER_TYPE");if(x==="DEFAULT_BITRATE")return{min:C,max:A};if(A===void 0){const B=Math.floor(200*Math.pow(w/15,.6)*Math.pow(y*b/640/360,.75));A=x==="STANDARD_BITRATE"?4*B:2*B,C=C??B}else C=C??Math.floor(A/10);return{min:C,max:A}}(o,s,c,h,u);if(this._encoderConfig.bitrateMin=g,this._encoderConfig.bitrateMax=p,q("VIDEO_STANDARD_BITRATE_VERSION")&&h==null&&u==null){const[y,b]=function(w,C,A){const x=4*Math.floor(2e5*Math.pow(A/15,.6)*Math.pow(w*C/230400,.75)),B=w*C,U=new Map([[19200,.9],[230400,.85],[518400,.75],[921600,.7],[2073600,.6],[3686400,.5]]),F=new Map([[230400,.95],[518400,.9],[921600,.85],[2073600,.8]]);let K=xo(U).call(U).next().value,z=1;if(U.has(B))K=U.get(B);else{var Q;const Me=Yh(Q=Array.from(U.entries())).call(Q,(ut,nt)=>{let[hn]=ut,[en]=nt;return hn-en}),pt=Me.find(ut=>{let[nt]=ut;return nt>B});if(pt){const ut=Me.indexOf(pt);if(ut>0){const nt=Me[ut-1],hn=(B-nt[0])/(pt[0]-nt[0]);K=nt[1]+hn*(pt[1]-nt[1])}else K=pt[1]}else K=Me[Me.length-1][1]}if(F.has(B))z=F.get(B);else{var ie;const Me=Yh(ie=Array.from(F.entries())).call(ie,(ut,nt)=>{let[hn]=ut,[en]=nt;return hn-en}),pt=Me.find(ut=>{let[nt]=ut;return nt>B});if(pt){const ut=Me.indexOf(pt);if(ut>0){const nt=Me[ut-1],hn=(B-nt[0])/(pt[0]-nt[0]);z=nt[1]+hn*(pt[1]-nt[1])}else z=pt[1]}else z=Me[Me.length-1][1]}const oe=q("VIDEO_NEW_BITRATE_RATIO");oe&&oe>0&&(K=oe/100);const re=Math.floor(x*K),me=Math.floor(65e4*Math.pow(w*C/230400,.5)*Math.pow(A/15,.69));let Ee=re;const xe=q("VIDEO_STANDARD_BITRATE_VERSION");return xe&&xe>0&&(xe===1?Ee=x:xe===2?Ee=re:xe===3&&(Ee=me)),[Math.floor(Ee/1e3),z]}(o,s,c);this._encoderConfig.bitrateMax=y,this._encoderConfig.bitrateMin=g?Math.min(g,y):y,this._saveEncodeBitrateRatio=b,L.debug("[".concat(this.getTrackId(),"] update new bitrate from profile, [w: ").concat(o,", h: ").concat(s,", fps: ").concat(c,"] => [brMax: ").concat(this._encoderConfig.bitrateMax,", brMin: ").concat(this._encoderConfig.bitrateMin,", save_bitrate_ratio: ").concat(this._saveEncodeBitrateRatio,"]"))}else L.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(o,", h: ").concat(s,", fps: ").concat(c,"] => [brMax: ").concat(p,", brMin: ").concat(g,"]")),this._saveEncodeBitrateRatio=1}}getVideoElementVisibleStatus(){try{var o,s;const c=this==null||(o=this._player)===null||o===void 0?void 0:o.getContainerElement(),u={track:this,element:this==null||(s=this._player)===null||s===void 0?void 0:s.getVideoElement(),slot:c==null?void 0:c.parentElement},{element:h,slot:p}=u;if(this.isPlaying&&h instanceof HTMLVideoElement&&p instanceof HTMLElement){const g=_8.checkOneElementVisible(h),y=Object.assign({},g);if(y.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=y.visible;const b=We.reportApiInvoke(null,{tag:Nn.TRACER,name:Yn.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});y.visible?b.onSuccess("Video is visible"):b.onSuccess("Invisible because of ".concat(y.reason))}return y}return}catch(c){throw new ve(Y.GET_VIDEO_ELEMENT_VISIBLE_ERROR,c.message)}}async renewMediaStreamTrack(o){}pipe(o){if(this.processor===o)return o;if(o._source)throw new ve(Y.INVALID_OPERATION,"Processor ".concat(o.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=o,this.processor._source=this,o.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),o}unpipe(){if(!this.processor)return;const o=this.processor;this.processor._source=void 0,this.processor=void 0,o.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(o){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],c=this._encoderConfig;o&&(c=Cn(Cn({},c),ma(o))),c=rf(c);const u=cn(8,"track-video-cloned-"),h=new vge(s?this._mediaStreamTrack.clone():this._mediaStreamTrack,c,rf(this._scalabilityMode),this._optimizationMode,u,rf(this._hints));return o&&c&&h.setEncoderConfiguration(c),L.debug("clone video track from ".concat(this.getTrackId()," to ").concat(u,", clone ").concat(s)),h}async replaceTrack(o,s){if(!(o instanceof MediaStreamTrack))throw new ve(Y.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(o.kind!=="video")throw new ve(Y.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(o,s,!0),this.updateMediaStreamTrackResolution()}sendSeiData(o){if(ud(()=>{We.reportApiInvoke(null,{name:Yn.LOCAL_VIDEO_SEND_SEI_DATA,options:[],tag:Nn.TRACER}).onSuccess("")},this._mediaStreamTrack.id||this.getTrackId()),!q("ENABLE_VIDEO_SEI")||!q("ENABLE_ENCODED_TRANSFORM"))return void L.warning('To send/receive SEI, please call AgoraRTC.setParameter("ENABLE_VIDEO_SEI", true) before instantiate IAgoraRtcClient');if(o instanceof Uint8Array==0)return new ve(Y.INVALID_PARAMS,"Invalid argument type, ILocalVideoTrack.sendSeiData() only accept Uint8Array argument.").throw();const s=this.getRTCRtpTransceiver();if(!s)return void L.warning("Video track is not published, SEI can not be send");const c=s.sender.getParameters();if(c.codecs.length===0)return;const u=c.codecs[0].mimeType.toLocaleLowerCase();u==="video/h264"?this.safeEmit("sei-to-send",o):L.warning("SEI is not supported by ".concat(u))}bindProcessorDestinationEvents(){this.processorDestination.on(Fi.ON_TRACK,async o=>{o?o!==this._mediaStreamTrack&&(this._mediaStreamTrack=o,this._updatePlayerSource(),await rn(this,Fe.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await rn(this,Fe.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Fi.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(rs.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(rs.REQUEST_CONSTRAINTS)}},Tt(Et.prototype,"play",[uK,dK],Object.getOwnPropertyDescriptor(Et.prototype,"play"),Et.prototype),Tt(Et.prototype,"stop",[hK],Object.getOwnPropertyDescriptor(Et.prototype,"stop"),Et.prototype),Tt(Et.prototype,"setEnabled",[fK,pK,mK],Object.getOwnPropertyDescriptor(Et.prototype,"setEnabled"),Et.prototype),Tt(Et.prototype,"setMuted",[gK,vK,yK],Object.getOwnPropertyDescriptor(Et.prototype,"setMuted"),Et.prototype),Tt(Et.prototype,"setSaveEncodeBitrateRatio",[_K,EK],Object.getOwnPropertyDescriptor(Et.prototype,"setSaveEncodeBitrateRatio"),Et.prototype),Tt(Et.prototype,"setEncoderConfiguration",[bK,SK],Object.getOwnPropertyDescriptor(Et.prototype,"setEncoderConfiguration"),Et.prototype),Tt(Et.prototype,"getStats",[wK],Object.getOwnPropertyDescriptor(Et.prototype,"getStats"),Et.prototype),Tt(Et.prototype,"setBeautyEffect",[TK,CK],Object.getOwnPropertyDescriptor(Et.prototype,"setBeautyEffect"),Et.prototype),Tt(Et.prototype,"getCurrentFrameData",[RK],Object.getOwnPropertyDescriptor(Et.prototype,"getCurrentFrameData"),Et.prototype),Tt(Et.prototype,"getCurrentFrameImage",[AK],Object.getOwnPropertyDescriptor(Et.prototype,"getCurrentFrameImage"),Et.prototype),Tt(Et.prototype,"setBitrateLimit",[OK],Object.getOwnPropertyDescriptor(Et.prototype,"setBitrateLimit"),Et.prototype),Tt(Et.prototype,"setOptimizationMode",[IK],Object.getOwnPropertyDescriptor(Et.prototype,"setOptimizationMode"),Et.prototype),Tt(Et.prototype,"setScalabiltyMode",[xK],Object.getOwnPropertyDescriptor(Et.prototype,"setScalabiltyMode"),Et.prototype),Tt(Et.prototype,"updateMediaStreamTrackResolution",[PK],Object.getOwnPropertyDescriptor(Et.prototype,"updateMediaStreamTrackResolution"),Et.prototype),Tt(Et.prototype,"pipe",[NK],Object.getOwnPropertyDescriptor(Et.prototype,"pipe"),Et.prototype),Tt(Et.prototype,"unpipe",[DK],Object.getOwnPropertyDescriptor(Et.prototype,"unpipe"),Et.prototype),Tt(Et.prototype,"close",[kK],Object.getOwnPropertyDescriptor(Et.prototype,"close"),Et.prototype),Tt(Et.prototype,"replaceTrack",[LK],Object.getOwnPropertyDescriptor(Et.prototype,"replaceTrack"),Et.prototype),Et),$1=(MK=Qe({argsMap:(r,o)=>[r.getTrackId(),o]}),jK=Bn(),UK=ym("CameraVideoTrack","_enabledMutex"),VK=Qe({argsMap:(r,o)=>[r.getTrackId(),o]}),FK=Bn(),BK=Qe({argsMap:(r,o)=>[r.getTrackId(),o]}),$K=Bn(),WK=Qe({argsMap:r=>[r.getTrackId()]}),cs=class yge extends pn{get __className__(){return"CameraVideoTrack"}constructor(o,s,c,u,h,p){super(o,ma(s.encoderConfig),u,h,p),fe(this,"_config",void 0),fe(this,"_originalConstraints",void 0),fe(this,"_constraints",void 0),fe(this,"_enabled",!0),fe(this,"_deviceName","default"),fe(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(mm()||s1())&&!function(){const g=It();if(g.os!==Rr.IOS||!g.osVersion)return!1;const y=g.osVersion.split(".");return Number(y[0])===15&&Number(y[1])>=2}()&&m8()&&this._enabled&&!this._isClosed&&(L.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=s,this._originalConstraints=c,this._constraints=c,this._deviceName=o.label,this._encoderConfig=ma(this._config.encoderConfig),qt.on(Yr.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),qt.on(Yr.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(o){return typeof o=="string"?this._setDeviceById(o):o.deviceId?this._setDeviceById(o.deviceId):o.facingMode?this._setDeviceByFacingModel(o.facingMode):void 0}async _setDeviceById(o){if(L.info("[".concat(this.getTrackId(),"] set device to ").concat(o)),this._enabled)try{const s=await ss.getDeviceById(o),c={};c.video=Cn({},this._constraints),c.video.deviceId={exact:o},c.video.facingMode=void 0,this._originMediaStreamTrack.stop();let u=null;try{u=await os(c,this.getTrackId())}catch(h){throw L.error("[".concat(this.getTrackId(),"] setDevice failed"),h.toString()),u=await os({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(u.getVideoTracks()[0],!1),h}await this._updateOriginMediaStreamTrack(u.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=s.label,this._config.cameraId=o,this._constraints.deviceId={exact:o}}catch(s){throw L.error("[".concat(this.getTrackId(),"] setDevice error"),s.toString()),s}else try{const s=await ss.getDeviceById(o);this._deviceName=s.label,this._config.cameraId=o,this._constraints.deviceId={exact:o}}catch(s){throw L.error("[".concat(this.getTrackId(),"] setDevice error"),s.toString()),s}L.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(o){L.info("[".concat(this.getTrackId(),"] set facingMode ").concat(o));const s={video:Cn(Cn({},this._constraints),{},{deviceId:void 0,facingMode:{exact:o}})};if(this._enabled){this._originMediaStreamTrack.stop();let c=null;try{c=await os(s,this.getTrackId())}catch(u){throw L.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),u.toString()),c=await os({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!1),u}await this._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=o,this._config.cameraId=void 0,this._constraints=Cn({},s.video),L.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(o,s){if(!s){if(o===this._enabled)return;this.stateCheck("enabled",o)}if(L.info("[".concat(this.getTrackId(),"] start setEnabled"),o),o){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const c=await os({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(c.getVideoTracks()[0],!1)}await rn(this,Fe.NEED_ENABLE_TRACK,this)}catch(c){throw L.error("[".concat(this.getTrackId(),"] setEnabled true error"),c.toString()),c}this.updateMediaStreamTrackResolution(),L.info("[".concat(this.getTrackId(),"] setEnabled to true success")),s||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),s||(this._enabled=!1);try{await rn(this,Fe.NEED_DISABLE_TRACK,this)}catch(c){throw L.error("[".concat(this.getTrackId(),"] setEnabled to false error"),c.toString()),c}L.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(o,s){if(!this._enabled)throw new ve(Y.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");o=ma(o),q("USE_STANDARD_BITRATE_DEFAULT")&&(delete o.bitrateMax,delete o.bitrateMin),this._forceBitrateLimit&&(o.bitrateMax=this._forceBitrateLimit.max_bitrate||o.bitrateMax,o.bitrateMin=this._forceBitrateLimit.min_bitrate||o.bitrateMin);const c=On(this._config);c.encoderConfig=o;const u=zw(c);(ri()||Vi()||ha())&&(u.deviceId=void 0),L.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(o),JSON.stringify(u));try{await this._originMediaStreamTrack.applyConstraints(u),this.updateMediaStreamTrackResolution()}catch(h){const p=new ve(Y.UNEXPECTED_ERROR,h.toString());throw L.error("[".concat(this.getTrackId(),"] applyConstraints error"),p.toString()),p}this._config=c,this._constraints=u,this._originalConstraints=u,this._encoderConfig=o,this._hints.indexOf(Zt.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await rn(this,Fe.NEED_UPDATE_VIDEO_ENCODER,this)}catch(h){return h.throw(L)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((Vi()||ha())&&this._enabled&&!this._isClosed&&qt.duringInterruption){const o=async()=>{qt.off(Yr.IOS_INTERRUPTION_END,o),this._enabled&&!this._isClosed&&(L.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};qt.on(Yr.IOS_INTERRUPTION_END,o)}else L.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(Tm.TRACK_ENDED)}async renewMediaStreamTrack(o){const s=o||this._constraints,c=ss.searchDeviceIdByName(this._deviceName);if(c&&!s.deviceId&&(s.deviceId={exact:c}),this._enabled){const u=await os({video:s},this.getTrackId());this._constraints=s,await this._updateOriginMediaStreamTrack(u.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),qt.off(Yr.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),qt.off(Yr.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(o){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1],c=this._encoderConfig;o&&(c=Cn(Cn({},c),ma(o))),c=rf(c);const u=cn(8,"track-cam-cloned-"),h=new yge(s?this._mediaStreamTrack.clone():this._mediaStreamTrack,rf(Cn(Cn({},this._config),{},{encoderConfig:c})),rf(this._constraints),rf(this._scalabilityMode),this._optimizationMode,u);return o&&c&&h.setEncoderConfiguration(c),L.debug("clone track from ".concat(this.getTrackId()," to ").concat(u,", clone ").concat(s)),h}bindProcessorContextEvents(){this.processorContext.on(rs.REQUEST_UPDATE_CONSTRAINTS,async(o,s,c)=>{try{const u=Object.assign({},this._originalConstraints,...o);await this.renewMediaStreamTrack(u),s()}catch(u){c(u)}}),this.processorContext.on(rs.REQUEST_CONSTRAINTS,async o=>{o(this._originMediaStreamTrack.getSettings())})}},Tt(cs.prototype,"setDevice",[MK,jK],Object.getOwnPropertyDescriptor(cs.prototype,"setDevice"),cs.prototype),Tt(cs.prototype,"setEnabled",[UK,VK,FK],Object.getOwnPropertyDescriptor(cs.prototype,"setEnabled"),cs.prototype),Tt(cs.prototype,"setEncoderConfiguration",[BK,$K],Object.getOwnPropertyDescriptor(cs.prototype,"setEncoderConfiguration"),cs.prototype),Tt(cs.prototype,"close",[WK],Object.getOwnPropertyDescriptor(cs.prototype,"close"),cs.prototype),cs);function W1(r,o,s,c){s.optimizationMode&&(c&&c.width&&c.height?(s.encoderConfig=Cn(Cn({},c),{},{bitrateMin:c.bitrateMin,bitrateMax:c.bitrateMax}),s.optimizationMode!=="motion"&&s.optimizationMode!=="detail"||(o.contentHint=s.optimizationMode,o.contentHint===s.optimizationMode?L.debug("[".concat(r,"] set content hint to"),s.optimizationMode):L.debug("[".concat(r,"] set content hint failed")))):L.warning("[".concat(r,"] can not apply optimization mode bitrate config, no encoderConfig")))}var GK,HK,KK,zK,Ns,YK,qK,XK,JK,QK,ZK,Ii;class ez extends rH{getUserId(){return this._userId}constructor(o,s,c,u){super(o,"track-".concat(o.kind,"-").concat(s,"-").concat(u.clientId,"_").concat(cn(5,""))),fe(this,"_userId",void 0),fe(this,"_uintId",void 0),fe(this,"_isDestroyed",!1),fe(this,"store",void 0),fe(this,"processor",void 0),fe(this,"processorContext",void 0),this._userId=s,this._uintId=c,this.store=u}_updateOriginMediaStreamTrack(o){this._originMediaStreamTrack=o,this._mediaStreamTrack=o,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,L.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let xm=(GK=Qe({argsMap:(r,o,s)=>[r.getTrackId(),typeof o=="string"?o:o instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",s]}),HK=Qe({argsMap:r=>[r.getTrackId()]}),KK=Qe({argsMap:(r,o)=>[r.getTrackId(),o.name]}),zK=Qe({argsMap:r=>[r.getTrackId()]}),Tt((Ns=class extends ez{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==wi.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(r,o,s,c){super(r,o,s,c),fe(this,"_videoVisibleTimer",null),fe(this,"_previousVideoVisibleStatus",void 0),fe(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),fe(this,"trackMediaType",Rm.VIDEO),fe(this,"_videoWidth",void 0),fe(this,"_videoHeight",void 0),fe(this,"_player",void 0),fe(this,"processorDestination",void 0),fe(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new mH(this.getTrackId(),"remote"),this.processorDestination=new pH(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return ud(()=>{L.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),Zo(this,Fe.GET_STATS)||Cn({},tH)}play(r){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof r=="string"){const c=document.getElementById(r);c?r=c:(L.warning("[".concat(this.getTrackId(),'] can not find "#').concat(r,'" element, use document.body')),r=document.body)}L.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(r instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(o));const s=Cn(Cn({fit:"cover"},o),{},{trackId:this.getTrackId(),element:r});this._player?this._player.updateConfig(s):(r instanceof HTMLVideoElement?this._player=new B1(s):this._player=new lK(s),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(Cm.FIRST_FRAME_DECODED)},this._player.onVideoStateChanged=c=>{this.safeEmit(Cm.VIDEO_STATE_CHANGED,c)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const c=this.getVideoElementVisibleStatus();this.safeEmit(Cm.VIDEO_ELEMENT_VISIBLE_STATUS,c)}catch{}},q("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,L.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){yH(this._originMediaStreamTrack).then(r=>{let[o,s]=r;this._videoHeight=s,this._videoWidth=o}).catch(Mw)}_updatePlayerSource(){L.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var r,o;const s=this==null||(r=this._player)===null||r===void 0?void 0:r.getContainerElement(),c={track:this,element:this==null||(o=this._player)===null||o===void 0?void 0:o.getVideoElement(),slot:s==null?void 0:s.parentElement},{element:u,slot:h}=c;if(this.isPlaying&&u instanceof HTMLVideoElement&&h instanceof HTMLElement){const p=_8.checkOneElementVisible(u),g=Object.assign({},p);if(g.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=g.visible;const y=We.reportApiInvoke(null,{tag:Nn.TRACER,name:Yn.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});g.visible?y.onSuccess("Video is visible"):y.onSuccess("Invisible because of ".concat(g.reason))}return g}return}catch(s){throw new ve(Y.GET_VIDEO_ELEMENT_VISIBLE_ERROR,s.message)}}pipe(r){if(this.processor===r)return r;if(r._source)throw new ve(Y.INVALID_OPERATION,"Processor ".concat(r.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=r,this.processor._source=this,r.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),r}unpipe(){if(!this.processor)return;const r=this.processor;this.processor._source=void 0,this.processor=void 0,r.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(Fi.ON_TRACK,async r=>{r?r!==this._mediaStreamTrack&&(this._mediaStreamTrack=r,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Fi.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}_onSei(r){this.emit(cf.SEI_RECEIVED,r)}}).prototype,"play",[GK],Object.getOwnPropertyDescriptor(Ns.prototype,"play"),Ns.prototype),Tt(Ns.prototype,"stop",[HK],Object.getOwnPropertyDescriptor(Ns.prototype,"stop"),Ns.prototype),Tt(Ns.prototype,"pipe",[KK],Object.getOwnPropertyDescriptor(Ns.prototype,"pipe"),Ns.prototype),Tt(Ns.prototype,"unpipe",[zK],Object.getOwnPropertyDescriptor(Ns.prototype,"unpipe"),Ns.prototype),Ns),Pm=(YK=Qe({argsMap:(r,o)=>[r.getTrackId(),o],throttleTime:300}),qK=Qe({argsMap:(r,o)=>[r.getTrackId(),o]}),XK=Qe({argsMap:r=>[r.getTrackId()]}),JK=Qe({argsMap:r=>[r.getTrackId()]}),QK=Qe({argsMap:(r,o)=>[r.getTrackId(),o.name]}),ZK=Qe({argsMap:r=>[r.getTrackId()]}),Tt((Ii=class extends ez{get isPlaying(){return this._useAudioElement?Zi.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(r,o,s,c){super(r,o,s,c),fe(this,"trackMediaType",Rm.AUDIO),fe(this,"_source",void 0),fe(this,"_useAudioElement",!0),fe(this,"_volume",100),fe(this,"processorContext",void 0),fe(this,"processorDestination",void 0),fe(this,"_played",!1),fe(this,"_bypassWebAudio",!1),q("DISABLE_WEBAUDIO")?(this._source=new V1,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new aH(r,!0),q("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(ns.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(Cm.FIRST_FRAME_DECODED)}),this.processorContext=new vH(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new gH(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(ns.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(r){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!r)return this._source.removeAllListeners(ns.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(o),this._source.removeAllListeners(ns.ON_AUDIO_BUFFER),this._source.on(ns.ON_AUDIO_BUFFER,s=>r(s))}setVolume(r){this._volume=r,this._useAudioElement?Zi.setVolume(this.getTrackId(),r):this._source.setVolume(r/100)}async setPlaybackDevice(r){if(!this._useAudioElement||!J8())throw new ve(Y.NOT_SUPPORTED,"your browser does not support setting the audio output device");await Zi.setSinkID(this.getTrackId(),r)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return ud(()=>{L.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),Zo(this,Fe.GET_STATS)||Cn({},eH)}play(){L.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(L.debug("[".concat(this.getTrackId(),"] use audio element to play")),Zi.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){L.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?Zi.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let r=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];L.debug("[".concat(this.getTrackId(),"] update player source track")),r&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&Zi.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(r){if(this._bypassWebAudio)throw new ve(Y.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===r)return r;if(r._source)throw new ve(Y.INVALID_OPERATION,"Processor ".concat(r.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=r,this.processor._source=this,r.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),r}unpipe(){var r;if(this._bypassWebAudio)throw new ve(Y.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const o=this.processor;(r=this._source.processSourceNode)===null||r===void 0||r.disconnect(),this.processor._source=!1,this.processor=void 0,o.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(Fi.ON_TRACK,async r=>{r?r!==this._mediaStreamTrack&&(this._mediaStreamTrack=r,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(r)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(Fi.ON_NODE,r=>{this._source.processedNode=r;const o=!r;this._useAudioElement!==o&&(this._played?(this.stop(),this._useAudioElement=o,this.play()):this._useAudioElement=o)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(Fi.ON_TRACK),this.processorDestination.removeAllListeners(Fi.ON_NODE)}}).prototype,"setVolume",[YK],Object.getOwnPropertyDescriptor(Ii.prototype,"setVolume"),Ii.prototype),Tt(Ii.prototype,"setPlaybackDevice",[qK],Object.getOwnPropertyDescriptor(Ii.prototype,"setPlaybackDevice"),Ii.prototype),Tt(Ii.prototype,"play",[XK],Object.getOwnPropertyDescriptor(Ii.prototype,"play"),Ii.prototype),Tt(Ii.prototype,"stop",[JK],Object.getOwnPropertyDescriptor(Ii.prototype,"stop"),Ii.prototype),Tt(Ii.prototype,"pipe",[QK],Object.getOwnPropertyDescriptor(Ii.prototype,"pipe"),Ii.prototype),Tt(Ii.prototype,"unpipe",[ZK],Object.getOwnPropertyDescriptor(Ii.prototype,"unpipe"),Ii.prototype),Ii);const Jc=new class extends An{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),fe(this,"_lastHiddenTime",0),fe(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),L.debug("current web page is ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};class tz extends An{constructor(o,s){super(),fe(this,"trackMediaType",Rm.DATA),fe(this,"_version",1),fe(this,"_type",3),fe(this,"_config",void 0),fe(this,"_originDataChannel",void 0),fe(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),fe(this,"_dataStreamPacketHandler",{serialize:c=>c,deserialize:c=>c}),fe(this,"_datachannelEventMap",new Map),this._config=o,s&&(this._originDataChannel=s,this._bandDataChannelEvents(s)),this._initPacketHeader()}useDataStream(o){this._dataStreamPacketHandler=o}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return q("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var o,s;return(o=(s=this._originDataChannel)===null||s===void 0?void 0:s.readyState)!==null&&o!==void 0?o:"connecting"}get _originDataChannelId(){var o,s;return(o=(s=this._originDataChannel)===null||s===void 0?void 0:s.id)!==null&&o!==void 0?o:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new De((o,s)=>{if(this._originDataChannel){this._originDataChannel.readyState==="open"&&o();const c=setTimeout(()=>{var u;s(new ve(Y.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat((u=this._originDataChannel)===null||u===void 0?void 0:u.id)))},1e4);this._originDataChannel.onopen=()=>{clearTimeout(c),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),o()},this._originDataChannel.onerror=()=>{throw clearTimeout(c),new ve(Y.DATACHANNEL_CONNECTION_TIMEOUT)}}else s(new ve(Y.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))})}_updateOriginDataChannel(o){this._originDataChannel=o,this._bandDataChannelEvents(o)}_initPacketHeader(){const o=new DataView(this._dataStreamPacketHeader);o.setUint16(0,this._version),o.setUint8(2,this._type),o.setUint8(3,this._config.id)}_bandDataChannelEvents(o){this._unbindDataChannelEvents(o),[Hw.OPEN,Hw.CLOSE,Hw.ERROR].forEach(s=>{const c=()=>{this.emit(s)};this._datachannelEventMap.set(s,c),o.addEventListener(s,c)})}_unbindDataChannelEvents(o){Array.from(this._datachannelEventMap.entries()).forEach(s=>{let[c,u]=s;o.removeEventListener(c,u)}),this._datachannelEventMap.clear()}}class wIe extends tz{constructor(o){super(o),fe(this,"_messageListener",void 0),this._messageListener=s=>{if(s.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const c=s.data.slice(0,this._dataStreamPacketHeader.byteLength),u=new DataView(c).getUint8(3);if(u!==this.id)return void(q("SHOW_DATASTREAM2_LOG")&&L.debug("invalid datachannel id: ".concat(u," !== ").concat(this.id)));let h=s.data.slice(this._dataStreamPacketHeader.byteLength);h=this._dataStreamPacketHandler.deserialize(h),this.emit(Hw.MESSAGE,h)}}_updateOriginDataChannel(o){super._updateOriginDataChannel(o),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class TIe extends tz{send(o){if(this._originDataChannel){let s=o;s=this._dataStreamPacketHandler.serialize(o);const c=new Uint8Array(this._dataStreamPacketHeader.byteLength+s.byteLength);c.set(new Uint8Array(this._dataStreamPacketHeader),0),c.set(new Uint8Array(s),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(c.buffer)}}}function Yw(){const r=new Blob([atob("ZnVuY3Rpb24gdCh0LGUsbil7bGV0IGE9bmV3IFVpbnQ4QXJyYXkodCxlLG4pLG89W10scj0wO2Zvcig7by5sZW5ndGg8bjspciszPG4mJjA9PT1hW3JdJiYwPT09YVtyKzFdJiYzPT09YVtyKzJdJiYoMD09PWFbciszXXx8MT09PWFbciszXXx8Mj09PWFbciszXXx8Mz09PWFbciszXSk/KG8ucHVzaChhW3JdLGFbcisxXSxhW3IrM10pLHIrPTQpOihvLnB1c2goYVtyXSkscisrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobyl9ZnVuY3Rpb24gZSh0LGUpe2NvbnN0IG49ZnVuY3Rpb24odCl7Y29uc3QgZT10Lmxlbmd0aDtsZXQgbj1bXSxhPTA7Zm9yKDthPGU7KWErMjxlJiYwPT09dFthXSYmMD09PXRbYSsxXSYmKDA9PT10W2ErMl18fDE9PT10W2ErMl18fDI9PT10W2ErMl18fDM9PT10W2ErMl0pPyhuLnB1c2godFthXSx0W2ErMV0sMyx0W2ErMl0pLGErPTMpOihuLnB1c2godFthXSksYSsrKTtyZXR1cm4gbmV3IFVpbnQ4QXJyYXkobil9KGUpLGE9bi5sZW5ndGgsbz1NYXRoLmZsb29yKGEvMjU1KSxyPWElMjU1LHM9bmV3IFVpbnQ4QXJyYXkoNitvKzErYSt0LmJ5dGVMZW5ndGgpO3NbMF09MCxzWzFdPTAsc1syXT0wLHNbM109MSxzWzRdPTYsc1s1XT0xMDE7bGV0IGk9MDtmb3IoO2k8bzspc1s2K2ldPTI1NSxpKys7cmV0dXJuIHNbNitpXT1yLGkrKyxzLnNldChuLDYraSkscy5zZXQobmV3IFVpbnQ4QXJyYXkodCksNitpK2EpLHMuYnVmZmVyfWNvbnN0IG49NzEsYT0xLG89MixyPTEscz0yO3ZhciBpOyFmdW5jdGlvbih0KXt0W3QuQVVESU9fTEVWRUw9MV09IkFVRElPX0xFVkVMIix0W3QuTUVUQURBVEE9Ml09Ik1FVEFEQVRBIix0W3QuQVVESU9fNjRfQklUX1BUUz0zXT0iQVVESU9fNjRfQklUX1BUUyJ9KGl8fChpPXt9KSk7bmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJTYWZhcmkiKT4tMSYmLTE9PT1uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIkNocm9tZSIpJiYoc2VsZi5vbnJ0Y3RyYW5zZm9ybT1mPT57Y29uc3QgdT1mLnRyYW5zZm9ybWVyO2xldCBkPVtdLGw9W107dS5vcHRpb25zLnBvcnQub25tZXNzYWdlPXQ9Pnt0LmRhdGEuc2VpJiZkLnB1c2godC5kYXRhLnNlaSksdC5kYXRhLm1ldGFkYXRhJiZsLnB1c2godC5kYXRhLm1ldGFkYXRhKX0sc2VsZi5wb3N0TWVzc2FnZSgic3RhcnRlZCIpO2NvbnN0IGc9dS5yZWFkYWJsZS5nZXRSZWFkZXIoKSxjPXUud3JpdGFibGUuZ2V0V3JpdGVyKCk7InNlaS1yeCI9PT11Lm9wdGlvbnMubmFtZT9mdW5jdGlvbiBlKG4pe2cucmVhZCgpLnRoZW4oKGE9PntpZighYS5kb25lKXtpZihhLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZFZpZGVvRnJhbWUpe2NvbnN0IGU9ZnVuY3Rpb24oZSl7Y29uc3Qgbj1uZXcgRGF0YVZpZXcoZS5kYXRhKTtsZXQgYT0wO2Zvcig7YSs0PGUuZGF0YS5ieXRlTGVuZ3RoOyl7aWYoMD09PW4uZ2V0VWludDgoYSswKSYmMD09PW4uZ2V0VWludDgoYSsxKSYmMD09PW4uZ2V0VWludDgoYSsyKSYmMT09PW4uZ2V0VWludDgoYSszKSYmNj09PW4uZ2V0VWludDgoYSs0KSl7bGV0IG89YSs2LHI9MCxzPTA7Zm9yKDsyNTU9PT0ocz1uLmdldFVpbnQ4KG8rKykpOylyKz0yNTU7cis9cztjb25zdCBpPXQoZS5kYXRhLG8scik7cmV0dXJuIG5ldyBVaW50OEFycmF5KGkpfWErK31yZXR1cm4gbnVsbH0oYS52YWx1ZSk7ZSYmbi5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3NlaTplfSl9Yy53cml0ZShhLnZhbHVlKSxuLm9wdGlvbnMucG9ydC5wb3N0TWVzc2FnZSh7dHJhbnNmb3JtZWQ6ITB9KSxlKG4pfX0pKX0odSk6InNlaS10eCI9PT11Lm9wdGlvbnMubmFtZT9mdW5jdGlvbiB0KG4pe2cucmVhZCgpLnRoZW4oKGE9PntpZighYS5kb25lKXtpZihhLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZFZpZGVvRnJhbWUpe2NvbnN0IHQ9ZC5zaGlmdCgpO3QmJihhLnZhbHVlLmRhdGE9ZShhLnZhbHVlLmRhdGEsdCkpfWMud3JpdGUoYS52YWx1ZSksbi5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3RyYW5zZm9ybWVkOiEwfSksdChuKX19KSl9KHUpOiJhdWRpby1tZXRhZGF0YS1yeCI9PT11Lm9wdGlvbnMubmFtZT9mdW5jdGlvbiB0KGUpe2cucmVhZCgpLnRoZW4oKGY9PntpZighZi5kb25lKXtpZihmLnZhbHVlIGluc3RhbmNlb2YgUlRDRW5jb2RlZEF1ZGlvRnJhbWUpe2NvbnN0IHQ9ZnVuY3Rpb24odCxlPSExKXtjb25zdCBmPXQuZ2V0VWludDgoMCk7aWYoZiE9PW4pcmV0dXJuO2NvbnN0IHU9dC5nZXRVaW50MTYoMSksZD1hK28rdSxsPW5ldyBVaW50OEFycmF5KHQuYnl0ZUxlbmd0aC1kKTtsLnNldChuZXcgVWludDhBcnJheSh0LmJ1ZmZlcixkLHQuYnl0ZUxlbmd0aC1kKSk7Y29uc3QgZz17bTpmLHRsdkxlbjp1LHRsdjpbXSxmcmFtZTpsfTtsZXQgYz1hK287Zm9yKDtjPGQ7KXtjb25zdCBuPXQuZ2V0VWludDgoYyksYT10LmdldFVpbnQxNihjK3IpLG89citzO2lmKG49PT1pLkFVRElPX0xFVkVMKXtsZXQgcj10LmdldFVpbnQ4KGMrbyk7Zm9yKGxldCBlPTE7ZTxhO2UrKylyPXI8PDh8dC5nZXRVaW50OChjK28rZSk7Zy50bHYucHVzaCh7dGFnOm4sbGVuZ3RoOmEsdmFsdWU6ZT8xMjdecj4+MToxMjcmcn0pfWVsc2UgaWYobj09PWkuTUVUQURBVEF8fG49PT1pLkFVRElPXzY0X0JJVF9QVFMpe2NvbnN0IGU9bmV3IFVpbnQ4QXJyYXkoYSk7Zm9yKGxldCBuPTA7bjxhO24rKyllW25dPXQuZ2V0VWludDgoYytvK24pO2cudGx2LnB1c2goe3RhZzpuLGxlbmd0aDphLHZhbHVlOmV9KX1jKz1vK2F9cmV0dXJuIGd9KG5ldyBEYXRhVmlldyhmLnZhbHVlLmRhdGEpKTtpZih0KXtjb25zdCBuPXQudGx2LmZpbmQoKHQ9PnQudGFnPT09aS5NRVRBREFUQXx8dC50YWc9PT1pLkFVRElPXzY0X0JJVF9QVFMpKTtuJiZuLnZhbHVlIGluc3RhbmNlb2YgVWludDhBcnJheSYmZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe21ldGFkYXRhOm4udmFsdWV9KSxmLnZhbHVlLmRhdGE9dC5mcmFtZS5idWZmZXJ9fWMud3JpdGUoZi52YWx1ZSksZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe3RyYW5zZm9ybWVkOiEwfSksdChlKX19KSl9KHUpOiJhdWRpby1tZXRhZGF0YS10eCI9PT11Lm9wdGlvbnMubmFtZSYmZnVuY3Rpb24gdChlKXtnLnJlYWQoKS50aGVuKChmPT57aWYoIWYuZG9uZSl7aWYoZS5vcHRpb25zLnBvcnQucG9zdE1lc3NhZ2Uoe2dldE1ldGFkYXRhOiEwfSksZi52YWx1ZSBpbnN0YW5jZW9mIFJUQ0VuY29kZWRBdWRpb0ZyYW1lKXtjb25zdCB0PWwuc2hpZnQoKTt0JiYoZi52YWx1ZS5kYXRhPWZ1bmN0aW9uKHQsZSxpKXtjb25zdCBmPWkuYnl0ZUxlbmd0aCx1PWYrcitzLGQ9YStvK3UsbD1uZXcgQXJyYXlCdWZmZXIodC5ieXRlTGVuZ3RoK2QpLGc9bmV3IERhdGFWaWV3KGwpO2cuc2V0VWludDgoMCxuKSxnLnNldFVpbnQxNigxLHUpLGcuc2V0VWludDgoMyxlKSxnLnNldFVpbnQxNig0LGYpO2ZvcihsZXQgdD0wO3Q8Zjt0KyspZy5zZXRVaW50OCg2K3QsaVt0XSk7Y29uc3QgYz1uZXcgVWludDhBcnJheShnLmJ1ZmZlcik7cmV0dXJuIGMuc2V0KG5ldyBVaW50OEFycmF5KHQpLGQpLGMuYnVmZmVyfShmLnZhbHVlLmRhdGEsaS5BVURJT182NF9CSVRfUFRTLHQpKX1jLndyaXRlKGYudmFsdWUpLGUub3B0aW9ucy5wb3J0LnBvc3RNZXNzYWdlKHt0cmFuc2Zvcm1lZDohMH0pLHQoZSl9fSkpfSh1KX0sc2VsZi5wb3N0TWVzc2FnZSgicmVnaXN0ZXJlZCIpKTsK")],{type:"text/javascript"});return setTimeout(()=>Y0.revokeObjectURL(r),0),new Worker(Y0.createObjectURL(r))}const nz=71,G1=1,H1=2,K1=1,rz=2;var Kl=function(r){return r[r.AUDIO_LEVEL=1]="AUDIO_LEVEL",r[r.METADATA=2]="METADATA",r[r.AUDIO_64_BIT_PTS=3]="AUDIO_64_BIT_PTS",r}(Kl||{});function iz(r){let o=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=r.getUint8(0);if(s!==nz)return;const c=r.getUint16(1),u=G1+H1+c,h=new Uint8Array(r.byteLength-u);h.set(new Uint8Array(r.buffer,u,r.byteLength-u));const p={m:s,tlvLen:c,tlv:[],frame:h};let g=G1+H1;for(;g<u;){const y=r.getUint8(g),b=r.getUint16(g+K1),w=K1+rz;if(y===Kl.AUDIO_LEVEL){let C=r.getUint8(g+w);for(let A=1;A<b;A++)C=C<<8|r.getUint8(g+w+A);p.tlv.push({tag:y,length:b,value:o?127^C>>1:127&C})}else if(y===Kl.METADATA||y===Kl.AUDIO_64_BIT_PTS){const C=new Uint8Array(b);for(let A=0;A<b;A++)C[A]=r.getUint8(g+w+A);p.tlv.push({tag:y,length:b,value:C})}g+=w+b}return p}const qw=new Map,Xw=127,df=1e-10,z1=139/13,Jw=new Map;function Y1(r,o,s){const c="".concat(r,"-").concat(o,"-").concat(s);let u=0;return Jw.has(c)?u=Jw.get(c):(u=Math.log(function(p,g){const y=p-g;g<y&&(g=y);let b=1;for(let w=p,C=1;w>g;w--,C++)b=b*w/C;return b}(o,r))+r*Math.log(.5)+(o-r)*Math.log(1-.5)-Math.log(s)+s*r,Jw.set(c,u)),u<df&&(u=df),u}function oz(r,o,s){const c=o.length,u=r.length/c;let h=!1;for(let p=0,g=0;p<c;p++){let y=0;for(let b=g+u;g<b;g++)r[g]>s&&y++;o[p]!==y&&(o[p]=y,h=!0)}return h}window.cache=Jw;let CIe=0;class sz{constructor(o){fe(this,"id",void 0),fe(this,"immediates",[]),fe(this,"lastNonSilence",-1),fe(this,"immediateSpeechActivityScore",df),fe(this,"lastLevelChangedTime",Date.now()),fe(this,"levels",[]),fe(this,"longs",[]),fe(this,"longSpeechActivityScore",df),fe(this,"mediums",[]),fe(this,"mediumSpeechActivityScore",df),fe(this,"minLevel",0),fe(this,"nextMinLevel",0),fe(this,"nextMinLevelWindowLength",0),fe(this,"energyScore",0),this.id=o||"".concat(CIe++),this.immediates.length=50,this.mediums.length=10,this.longs.length=1,this.levels.length=this.immediates.length}computeImmediates(){const o=this.immediates,s=this.levels,c=this.minLevel+z1;let u=!1;for(let h=0;h<o.length;++h){let p=s[h];p<c&&(p=0);const g=Math.floor(p/z1);o[h]!==g&&(o[h]=g,u=!0)}return u}computeLongs(){return oz(this.mediums,this.longs,4)}computeMediums(){return oz(this.immediates,this.mediums,7)}evaluateImmediateSpeechActivityScore(){this.immediateSpeechActivityScore=Y1(this.immediates[0],13,.78)}evaluateLongSpeechActivityScore(o){this.longSpeechActivityScore=Y1(this.longs[0],10,47),this.longSpeechActivityScore>df&&(this.lastNonSilence=o)}evaluateMediumSpeechActivityScore(){this.mediumSpeechActivityScore=Y1(this.mediums[0],5,24)}evaluateSpeechActivityScores(o){this.computeImmediates()&&(this.evaluateImmediateSpeechActivityScore(),this.computeMediums()&&(this.evaluateMediumSpeechActivityScore(),this.computeLongs()&&this.evaluateLongSpeechActivityScore(o)))}getLastLevelChangedTime(){return this.lastLevelChangedTime}getLevels(){var o;return"[".concat(F3(o=[...this.levels]).call(o).join(),"]")}getSpeechActivityScore(o){switch(o){case 0:return this.immediateSpeechActivityScore;case 1:return this.mediumSpeechActivityScore;case 2:return this.longSpeechActivityScore;default:throw new Error("interval "+o)}}levelChanged(o,s){if(this.lastLevelChangedTime<=s){this.lastLevelChangedTime=s;let c=o;return o<0&&(c=0),o>Xw&&(c=Xw),this.levels.unshift(c),this.levels.length>this.immediates.length&&this.levels.pop(),this.updateMinLevel(c),c>=this.minLevel+z1?c:c/2}return-1}levelTimedOut(){this.levelChanged(0,this.lastLevelChangedTime)}updateMinLevel(o){if(o!==0){if(this.minLevel===0||this.minLevel>o)return this.minLevel=o,this.nextMinLevel=0,void(this.nextMinLevelWindowLength=0);if(this.nextMinLevel===0)return this.nextMinLevel=o,void(this.nextMinLevelWindowLength=1);if(this.nextMinLevel>o&&(this.nextMinLevel=o),this.nextMinLevelWindowLength++,this.nextMinLevelWindowLength>=750){let s=Math.sqrt(this.minLevel*this.nextMinLevel);s<0?s=0:s>Xw&&(s=Xw),this.minLevel=s,this.nextMinLevel=0,this.nextMinLevelWindowLength=0}}}}class RIe{constructor(o){fe(this,"algorithm",void 0),this.algorithm=o}execute(){let o=!this.algorithm;if(!o)try{const s=this.algorithm.runInDecisionMaker(this);s<=0?o=!0:setTimeout(this.execute.bind(this),s)}catch{o=!0}o&&this.algorithm&&this.algorithm.decisionMakerExited(this)}}class q1{constructor(o,s,c){fe(this,"isDominant",void 0),fe(this,"energyRanking",void 0),fe(this,"energyScore",void 0),this.isDominant=o,this.energyRanking=s,this.energyScore=c}}class AIe extends An{constructor(o){super(),fe(this,"dominantId",null),fe(this,"lastDecisionTime",0),fe(this,"lastLevelChangedTime",0),fe(this,"lastLevelIdleTime",0),fe(this,"relativeSpeechActivities",[]),fe(this,"speakers",new Map),fe(this,"enableSilence",!1),fe(this,"timeoutToSilenceInterval",0),fe(this,"decisionMaker",null),fe(this,"loudest",[]),fe(this,"numLoudestToTrack",3),fe(this,"energyExpireTimeMs",250),fe(this,"energyAlphaPct",50),this.timeoutToSilenceInterval=o,this.enableSilence=o>0,this.relativeSpeechActivities.length=3}setLoudestConfig(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:3,s=arguments.length>1?arguments[1]:void 0,c=arguments.length>2?arguments[2]:void 0;this.numLoudestToTrack=o,s!=null&&(this.energyExpireTimeMs=s),c!=null&&(this.energyAlphaPct=c),this.loudest.length>o&&this.loudest.splice(o)}getDominantSpeaker(){return this.dominantId}isAmongLoudest(o){return this.loudest.some(s=>s.id===o)}levelChanged(o,s){const c=Date.now(),u=this.getOrCreateSpeaker(o);this.lastLevelChangedTime<c&&(this.lastLevelChangedTime=c,this.maybeStartDecisionMaker());const h=u.levelChanged(s,c);return this.updateLoudestList(u,h,c)}runInDecisionMaker(o){return this.decisionMaker!==o||this.lastDecisionTime>0&&this.lastDecisionTime-this.lastLevelChangedTime>=15e3?-1:this._runInDecisionMaker()}decisionMakerExited(o){this.decisionMaker===o&&(this.decisionMaker=null)}destroy(){this.decisionMaker=null,this.loudest.length=0,this.speakers.clear(),this.removeAllListeners()}addSpeakers(o){o.forEach(s=>{this.speakers.has(s.id)||this.speakers.set(s.id,s)})}removeSpeakers(o){o.forEach(s=>{this.speakers.delete(s.id)})}getOrCreateSpeaker(o){let s=this.speakers.get(o);return s||(s=new sz(o),this.speakers.set(o,s),this.maybeStartDecisionMaker()),s}updateLoudestList(o,s,c){const u=o.id===this.dominantId;if(s<0){let y=0;for(;y<this.loudest.length&&this.loudest[y]!==o;)++y;return new q1(u,y,o.energyScore)}if(o.energyScore=Math.floor((this.energyAlphaPct*s+(100-this.energyAlphaPct)*o.energyScore+50)/100),this.numLoudestToTrack===0)return new q1(u,0,o.energyScore);const h=c-this.energyExpireTimeMs;let p=0;for(;p<this.loudest.length;){const y=this.loudest[p];if(y.getLastLevelChangedTime()<h&&this.loudest.length>=this.numLoudestToTrack)this.loudest.splice(p,1);else if(y.id!==o.id)++p;else if(this.loudest.splice(p,1),this.loudest.length<this.numLoudestToTrack)break}let g=0;for(;g<this.loudest.length&&!(this.loudest[g].energyScore<o.energyScore);)++g;return g<this.numLoudestToTrack&&(this.loudest.splice(g,0,o),this.loudest.length>this.numLoudestToTrack&&this.loudest.splice(this.numLoudestToTrack,1)),new q1(u,g,o.energyScore)}maybeStartDecisionMaker(){!this.decisionMaker&&this.speakers.size>0&&(this.decisionMaker=new RIe(this),this.decisionMaker.execute())}makeDecision(o){let s=null,c=null;const u=this.speakers.size;let h=null;if(u===0)h=null;else if(u===1){var p;const g=xo(p=this.speakers).call(p).next().value;this.enableSilence&&g&&(h=g.id,g.evaluateSpeechActivityScores(o),o-g.lastNonSilence>this.timeoutToSilenceInterval&&(h=null))}else{let g=this.dominantId==null?null:this.speakers.get(this.dominantId);if(g==null){const w=this.speakers.entries().next();w.value&&(h=w.value[0],g=w.value[1])}else h=g.id;g!=null&&g.evaluateSpeechActivityScores(o);const y=this.relativeSpeechActivities;let b=2;for(const w of this.speakers.entries()){const[C,A]=w;if(A===g)continue;A.evaluateSpeechActivityScores(o);for(let F=0;F<y.length;++F){const K=g==null?df:g.getSpeechActivityScore(F);y[F]=Math.log(A.getSpeechActivityScore(F)/K)}const x=y[0],B=y[1],U=y[2];x>3&&B>2&&U>0&&B>b&&(b=B,h=C)}this.enableSilence&&g!=null&&h===g.id&&o-g.lastNonSilence>this.timeoutToSilenceInterval&&(h=null)}h==null&&!this.enableSilence||h===this.dominantId||(s=this.dominantId,this.dominantId=h,c=this.dominantId),c==null&&!this.enableSilence||c===s||this.emit("ActiveSpeakerChanged",c)}_runInDecisionMaker(){const o=Date.now(),s=300-(o-this.lastLevelIdleTime);let c=0;s<=0?(this.lastLevelIdleTime!==0&&this.timeoutIdleLevels(o),this.lastLevelIdleTime=o):c=s;let u=300-(o-this.lastDecisionTime);return u<=0&&(this.lastDecisionTime=o,this.makeDecision(o),u=300-(Date.now()-o)),u>0&&c>u&&(c=u),c}timeoutIdleLevels(o){const s=[];for(const u of xo(c=this.speakers).call(c)){var c;const h=o-u.getLastLevelChangedTime();36e5<h&&(this.dominantId==null||u.id!==this.dominantId)?s.push(u.id):300<h&&u.levelTimedOut()}s.forEach(u=>this.speakers.delete(u))}}const Nm=new Map;let ic=null,Qw=null;const az=3;let hf=[];const oc=new Map,Zw=new Map;class OIe{get samples(){return this.actives+this.inactives}get activeRate(){return this.actives/this.samples}constructor(o,s){fe(this,"id",void 0),fe(this,"track",void 0),fe(this,"score",0),fe(this,"active",!0),fe(this,"muted",!1),fe(this,"timer",0),fe(this,"actives",0),fe(this,"inactives",0),this.id=o,this.track=s,this.setActive(oc.size<3)}autoCheckActive(){this.autoSetActive(),this.autoAdjustActive(),this.resetTimer(),this.actives=0,this.inactives=0}autoSetActive(){const o=this.active;this.active=this.activeRate>=.8;const{actives:s,inactives:c}=function(){const u=[],h=[];return Array.from(xo(oc).call(oc)).forEach(p=>{p.active?u.push(p):h.push(p)}),{actives:u,inactives:h}}();if(s.length>3){let u;s.forEach(h=>{(!u||u.score>h.score)&&(u=h)}),u&&u.setActive(!1)}if(s.length<3&&c.length>0){let u;c.forEach(h=>{(!u||u.score<h.score)&&h.id!==this.id&&(u=h)}),u&&o&&!this.active&&(u.samples>40&&u.activeRate-this.activeRate>.4?u.setActive(!0):this.active=!0)}this.setMuted(!this.active)}setActive(o){this.active=o,this.resetTimer(),this.setMuted(!o)}autoAdjustActive(){this.active?this.autoSwitchToInactive():this.autoSwitchToActive()}autoSwitchToActive(){const o=function(s){let c;return Array.from(xo(oc).call(oc)).forEach(u=>{!u.active||u.id===s||u.samples<40||(!c||u.score<c.score)&&(c=u)}),c}(this.id);o&&this.activeRate-o.activeRate>.4&&(o.setActive(!1),this.setActive(!0))}autoSwitchToInactive(){const o=function(s){let c;return Array.from(xo(oc).call(oc)).forEach(u=>{u.active||u.id===s||u.samples<40||(!c||u.score>c.score)&&(c=u)}),c}(this.id);o&&o.activeRate-this.activeRate>.4&&(o.setActive(!0),this.setActive(!1))}addSample(o){o?this.actives+=1:this.inactives+=1,this.samples>66.66666666666667&&this.autoCheckActive()}setMuted(o){this.track&&(this.track.enabled=!o,this.muted=o)}resetTimer(){this.clearTimer(),this.timer=window.setTimeout(()=>{if(this.samples!==0)return this.samples<50?this.resetTimer():void this.autoCheckActive()},1e3)}clearTimer(){this.timer&&(clearTimeout(this.timer),this.timer=0)}}let eT;function cz(r){const o=oc.get(r);o&&(oc.delete(r),o.clearTimer())}const tT=new Map,IIe=new Map;function xIe(r,o,s){let c=new Uint8Array(r,o,s),u=[],h=0;for(;u.length<s;)h+3<s&&c[h]===0&&c[h+1]===0&&c[h+2]===3&&(c[h+3]===0||c[h+3]===1||c[h+3]===2||c[h+3]===3)?(u.push(c[h],c[h+1],c[h+3]),h+=4):(u.push(c[h]),h++);return new Uint8Array(u)}const nT=new Map,m_=new Map;(function(){const r=It();zr.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),zr.getStreamFromExtension=r.name===Mt.CHROME&&Number(r.version)>34,zr.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const o=new RTCPeerConnection;let s=!1;try{o.addTransceiver("audio"),s=!0}catch{}return o.close(),s}(),zr.supportMinBitrate=r.name===Mt.CHROME||r.name===Mt.EDGE,zr.supportSetRtpSenderParameters=function(){const o=It();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!Wl()||!(!ri()&&!Nw())||o.name===Mt.FIREFOX&&Number(o.version)>=64)}(),r.name===Mt.SAFARI&&(Number(r.version)>=14?zr.supportDualStream=!0:zr.supportDualStream=!1),zr.webAudioMediaStreamDest=function(){const o=It();return!(o.name===Mt.SAFARI&&Number(o.version)<12)}(),zr.supportReplaceTrack=!!window.RTCRtpSender&&typeof RTCRtpSender.prototype.replaceTrack=="function",zr.supportWebGL=typeof WebGLRenderingContext<"u",zr.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,Wl()||(zr.webAudioWithAEC=!0),zr.supportShareAudio=function(){const o=It();return(o.os===Rr.WIN_10||o.os===Rr.WIN_81||o.os===Rr.WIN_7||o.os===Rr.LINUX||o.os===Rr.MAC_OS||o.os===Rr.CHROMIUM_OS)&&o.name===Mt.CHROME&&Number(o.version)>=74}(),zr.supportDataChannel=!!(r_(76)||function(o){const s=It();return!(s.name!==Mt.FIREFOX||!s.osVersion)&&Number(s.version)>=o}(68)||u8(14)),zr.supportPCSetConfiguration=function(){const o=window.RTCPeerConnection;return!xn()&&!!o&&o.prototype.setConfiguration instanceof Function}(),zr.supportWebRTCEncodedTransform=function(){const o=It();return o.name==="Chrome"&&Number(o.version)>=87||o.name==="Safari"&&Number(o.version)>=15}(),zr.supportWebRTCInsertableStream=function(){const o=It();return(o.name===Mt.CHROME||o.name===Mt.EDGE)&&Number(o.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),zr.supportRequestVideoFrameCallback="requestVideoFrameCallback"in HTMLVideoElement.prototype,zr.supportWebCrypto=typeof window<"u"&&window.crypto!==void 0&&window.crypto.subtle!==void 0,Lw(()=>{zr.supportDualStreamEncoding=function(){const o=It();return!!q("DISABLE_WEBAUDIO")||o.name==="Safari"&&Number(o.version)>=14||!!(o.name==="Chrome"&&/Windows/i.test(o.os||"")&&Number(o.version)>=100&&q("CHROME_DUAL_STREAM_USE_ENCODING"))}(),L.debug("browser ua: ",navigator.userAgent),L.info("browser info: ",r),L.info("browser compatibility: ",zr)})})();const PIe=["CHINA","GLOBAL"],lz=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],ff=[],Dm=[];function pf(r,o){return!!o&&ff.some(s=>s.uid===r&&s.channelName===o)}function X1(){return Dm.length>0}var NIe=A6.forEach,uz=s0("forEach")?[].forEach:function(r){return NIe(this,r,arguments.length>1?arguments[1]:void 0)};Kt({target:"Array",proto:!0,forced:[].forEach!==uz},{forEach:uz});var DIe=ia("Array","forEach"),kIe=td,LIe=bi,MIe=T,jIe=DIe,J1=Array.prototype,UIe={DOMTokenList:!0,NodeList:!0},VIe=function(r){var o=r.forEach;return r===J1||MIe(J1,r)&&o===J1.forEach||LIe(UIe,kIe(r))?jIe:o},FIe=a(VIe),BIe=Bc,dz=h0;Kt({target:"Object",stat:!0,forced:l(function(){dz(1)})},{keys:function(r){return dz(BIe(r))}});var $Ie=a(ar.Object.keys),WIe=a(j3),GIe=a(V3),HIe=Kt,hz=Ay,KIe=R0,zIe=Mn,fz=Sx,YIe=ed,qIe=nn,XIe=FP,JIe=cr,QIe=rd,ZIe=v6("slice"),exe=JIe("species"),Q1=Array,txe=Math.max;HIe({target:"Array",proto:!0,forced:!ZIe},{slice:function(r,o){var s,c,u,h=qIe(this),p=YIe(h),g=fz(r,p),y=fz(o===void 0?p:o,p);if(hz(h)&&(s=h.constructor,(KIe(s)&&(s===Q1||hz(s.prototype))||zIe(s)&&(s=s[exe])===null)&&(s=void 0),s===Q1||s===void 0))return QIe(h,g,y);for(c=new(s===void 0?Q1:s)(txe(y-g,0)),u=0;g<y;g++,u++)g in h&&XIe(c,u,h[g]);return c.length=u,c}});var nxe=ia("Array","slice"),rxe=T,ixe=nxe,Z1=Array.prototype,oxe=function(r){var o=r.slice;return r===Z1||rxe(Z1,r)&&o===Z1.slice?ixe:o},sxe=a(oxe);function $e(r,o,s,c,u){var h,p,g,y={};return FIe(h=$Ie(c)).call(h,function(b){y[b]=c[b]}),y.enumerable=!!y.enumerable,y.configurable=!!y.configurable,("value"in y||y.initializer)&&(y.writable=!0),y=WIe(p=GIe(g=sxe(s).call(s)).call(g)).call(p,function(b,w){return w(r,o,b)||b},y),u&&y.initializer!==void 0&&(y.value=y.initializer?y.initializer.call(u):void 0,y.initializer=void 0),y.initializer===void 0?(f6(r,o,y),null):y}let rT=function(r){return r[r.ACCESS_POINT=101]="ACCESS_POINT",r[r.UNILBS=201]="UNILBS",r[r.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR",r}({}),eD=function(r){return r[r.IIIEGAL_APPID=1]="IIIEGAL_APPID",r[r.IIIEGAL_UID=2]="IIIEGAL_UID",r[r.INTERNAL_ERROR=3]="INTERNAL_ERROR",r}({}),ga=function(r){return r[r.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",r[r.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",r[r.INTERNAL_ERROR=8]="INTERNAL_ERROR",r[r.NO_AUTHORIZED=9]="NO_AUTHORIZED",r[r.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",r[r.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",r[r.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",r[r.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",r[r.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",r[r.USER_OVERLOAD=16]="USER_OVERLOAD",r[r.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",r[r.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND",r}({}),Bi=function(r){return r[r.NO_FLAG_SET=100]="NO_FLAG_SET",r[r.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",r[r.INVALID_FALG_SET=102]="INVALID_FALG_SET",r[r.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",r[r.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",r[r.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",r[r.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",r[r.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",r[r.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",r[r.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",r[r.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",r[r.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",r[r.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",r[r.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",r[r.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",r[r.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",r[r.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",r[r.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",r[r.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV",r}({}),Xe=function(r){return r[r.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",r[r.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",r[r.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",r[r.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",r[r.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",r[r.K_TICKET_INVALID=7]="K_TICKET_INVALID",r[r.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",r[r.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",r[r.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",r[r.K_UID_BANNED=14]="K_UID_BANNED",r[r.K_IP_BANNED=15]="K_IP_BANNED",r[r.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",r[r.DATASTREAM2_NOT_AVAILABLE=27]="DATASTREAM2_NOT_AVAILABLE",r[r.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",r[r.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",r[r.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",r[r.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",r[r.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",r[r.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",r[r.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",r[r.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",r[r.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",r[r.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",r[r.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",r[r.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",r[r.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",r[r.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",r[r.ERR_INVALID_UID=117]="ERR_INVALID_UID",r[r.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",r[r.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",r[r.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",r[r.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",r[r.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",r[r.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",r[r.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",r[r.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",r[r.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",r[r.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",r[r.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",r[r.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",r[r.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",r[r.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",r[r.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",r[r.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",r[r.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",r[r.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",r[r.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",r[r.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",r[r.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",r[r.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",r[r.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",r[r.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",r[r.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",r[r.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",r[r.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",r[r.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",r[r.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",r[r.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",r[r.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",r[r.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",r[r.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",r[r.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",r[r.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",r[r.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",r[r.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY",r}({}),dn=function(r){return r.CONNECTING="connecting",r.CONNECTED="connected",r.RECONNECTING="reconnecting",r.CLOSED="closed",r}({}),it=function(r){return r.WS_CONNECTED="ws_connected",r.WS_RECONNECTING="ws_reconnecting",r.WS_CLOSED="ws_closed",r.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",r.ON_BINARY_DATA="on_binary_data",r.REQUEST_RECOVER="request_recover",r.REQUEST_JOIN_INFO="request_join_info",r.REQUEST_REJOIN_INFO="req_rejoin_info",r.IS_P2P_DISCONNECTED="is_p2p_dis",r.DISCONNECT_P2P="dis_p2p",r.ABORT_P2P_EXECUTION="abort_p2p_execution",r.NEED_RENEW_SESSION="need-sid",r.REPORT_JOIN_GATEWAY="report_join_gateway",r.REQUEST_TIMEOUT="request_timeout",r.REQUEST_SUCCESS="request_success",r.JOIN_RESPONSE="join_response",r.PRE_CONNECT_PC="pre_connect_pc",r.P2P_CONNECTION="p2p_connection",r.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",r.P2P_SUBSCRIBE="p2p_subscribe",r.P2P_UNSUBSCRIBE="p2p_unsubscribe",r.P2P_EXCHANGE_SDP="p2p_exchange_sdp",r.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",r.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream",r.RECOVER_NOTIFICATION="recover_notification",r}({}),tt=function(r){return r.PING="ping",r.PING_BACK="ping_back",r.JOIN="join_v3",r.REJOIN="rejoin_v3",r.LEAVE="leave",r.SET_CLIENT_ROLE="set_client_role",r.PUBLISH="publish",r.PUBLISH_DATASTREAM="publish_datastream",r.UNPUBLISH="unpublish",r.UNPUBLISH_DATASTREAM="unpublish_datastream",r.SUBSCRIBE="subscribe",r.PRE_SUBSCRIBE="pre_subscribe",r.SUBSCRIBE_DATASTREAM="subscribe_datastream",r.SUBSCRIBE_STREAMS="subscribe_streams",r.UNSUBSCRIBE="unsubscribe",r.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",r.UNSUBSCRIBE_STREAMS="unsubscribe_streams",r.SUBSCRIBE_CHANGE="subscribe_change",r.TRAFFIC_STATS="traffic_stats",r.RENEW_TOKEN="renew_token",r.SWITCH_VIDEO_STREAM="switch_video_stream",r.DEFAULT_VIDEO_STREAM="default_video_stream",r.SET_FALLBACK_OPTION="set_fallback_option",r.GATEWAY_INFO="gateway_info",r.CONTROL="control",r.SEND_METADATA="send_metadata",r.DATA_STREAM="data_stream",r.PICK_SVC_LAYER="pick_svc_layer",r.RESTART_ICE="restart_ice",r.CONNECT_PC="connect_pc",r.SET_VIDEO_PROFILE="set_video_profile",r.SET_PARAMETER="set_parameter",r.SET_RTM2_FLAG="set_rtm2_flag",r}({}),g_=function(r){return r.WRTC_STATS="wrtc_stats",r.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",r.DENOISER_STATS="denoiser_stats",r.EXTENSION_USAGE_STATS="extension_usage_stats",r}({}),bt=function(r){return r.ON_USER_ONLINE="on_user_online",r.ON_USER_OFFLINE="on_user_offline",r.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",r.ON_PUBLISH_STREAM="on_publish_stream",r.ON_UPLINK_STATS="on_uplink_stats",r.ON_P2P_LOST="on_p2p_lost",r.ON_REMOVE_STREAM="on_remove_stream",r.ON_ADD_AUDIO_STREAM="on_add_audio_stream",r.ON_ADD_VIDEO_STREAM="on_add_video_stream",r.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",r.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",r.ON_USER_BANNED="on_user_banned",r.ON_USER_LICENSE_BANNED="on_user_license_banned",r.ON_NOTIFICATION="on_notification",r.ON_CRYPT_ERROR="on_crypt_error",r.MUTE_AUDIO="mute_audio",r.MUTE_VIDEO="mute_video",r.UNMUTE_AUDIO="unmute_audio",r.UNMUTE_VIDEO="unmute_video",r.ON_P2P_OK="on_p2p_ok",r.RECEIVE_METADATA="receive_metadata",r.ON_DATA_STREAM="on_data_stream",r.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",r.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",r.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",r.ENABLE_LOCAL_VIDEO="enable_local_video",r.DISABLE_LOCAL_VIDEO="disable_local_video",r.ENABLE_LOCAL_AUDIO="enable_local_audio",r.DISABLE_LOCAL_AUDIO="disable_local_audio",r.ON_PUBLISHED_USER_LIST="on_published_user_list",r}({}),$i=function(r){return r.SEND_ONLY="SEND_ONLY",r.RECEIVE_ONLY="RECEIVE_ONLY",r}({}),lt=function(r){return r.CONNECTED="websocket:connected",r.RECONNECTING="websocket:reconnecting",r.WILL_RECONNECT="websocket:will_reconnect",r.CLOSED="websocket:closed",r.FAILED="websocket:failed",r.ON_MESSAGE="websocket:on_message",r.REQUEST_NEW_URLS="websocket:request_new_urls",r.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",r.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire",r}({});function iT(r){if(typeof r!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(r))throw L.error("Invalid Channel Name ".concat(r)),new pe(Y.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function oT(r){if(o=r,!(typeof o=="number"&&Math.floor(o)===o&&0<=o&&o<=4294967295||y8(r,1,255)))throw new pe(Y.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var o;typeof r=="string"&&L.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}let zl=function(r){return r.TRANSCODE="mix_streaming",r.RAW="raw_streaming",r}({});const axe={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},tD={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function nD(r,o){Hr(r.url,"".concat(o,".url"),1,1e3,!1),Pn(r.x)||Qt(r.x,"".concat(o,".x"),0,1e4),Pn(r.y)||Qt(r.y,"".concat(o,".y"),0,1e4),Pn(r.width)||Qt(r.width,"".concat(o,".width"),0,1e4),Pn(r.height)||Qt(r.height,"".concat(o,".height"),0,1e4),Pn(r.zOrder)||Qt(r.zOrder,"".concat(o,".zOrder"),0,255),Pn(r.alpha)||Qt(r.alpha,"".concat(o,".alpha"),0,1,!1)}const cxe={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""};let fd=function(r){return r.WARNING="@live_uap-warning",r.ERROR="@line_uap-error",r.PUBLISH_STREAM_STATUS="@live_uap-publish-status",r.WORKER_STATUS="@live_uap-worker-status",r.REQUEST_NEW_ADDRESS="@live_uap-request-address",r}({}),rD=function(r){return r.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",r}({}),ur=function(r){return r[r.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",r[r.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",r[r.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",r[r.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",r[r.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",r[r.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",r[r.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",r[r.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",r[r.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",r[r.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",r[r.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",r[r.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",r[r.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",r[r.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",r[r.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",r[r.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",r[r.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",r[r.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",r[r.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",r[r.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",r[r.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN",r}({});function pz(r){if(!r.channelName)throw new pe(Y.INVALID_PARAMS,"invalid channelName in info");if(typeof r.uid!="number")throw new pe(Y.INVALID_PARAMS,"invalid uid in info, uid must be a number");return r.token&&Hr(r.token,"info.token",1,2047),oT(r.uid),iT(r.channelName),!0}let Wi=function(r){return r[r.SetSdkProfile=0]="SetSdkProfile",r[r.SetSourceChannel=1]="SetSourceChannel",r[r.SetSourceUserId=2]="SetSourceUserId",r[r.SetDestChannel=3]="SetDestChannel",r[r.StartPacketTransfer=4]="StartPacketTransfer",r[r.StopPacketTransfer=5]="StopPacketTransfer",r[r.UpdateDestChannel=6]="UpdateDestChannel",r[r.Reconnect=7]="Reconnect",r[r.SetVideoProfile=8]="SetVideoProfile",r}({}),Yl=function(r){return r.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",r.NETWORK_CONNECTED="NETWORK_CONNECTED",r.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",r.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",r.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",r.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",r.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",r.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",r.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",r.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",r}({}),fo=function(r){return r.RELAY_STATE_IDLE="RELAY_STATE_IDLE",r.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",r.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",r.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE",r}({}),km=function(r){return r.RELAY_OK="RELAY_OK",r.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",r.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",r.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED",r}({}),Ht=function(r){return r.High="high",r.Low="low",r.Audio="audio",r.Screen="screen",r.ScreenLow="screen_low",r}({}),jr=function(r){return r.DISCONNECT="disconnect",r.CONNECTION_STATE_CHANGE="connection-state-change",r.NETWORK_QUALITY="network-quality",r.STREAM_TYPE_CHANGE="stream-type-change",r.IS_P2P_DISCONNECTED="is-p2p-dis",r.DISCONNECT_P2P="dis-p2p",r.REQUEST_NEW_GATEWAY_LIST="req-gate-url",r.NEED_RENEW_SESSION="need-sid",r.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",r.JOIN_RESPONSE="join-response",r.RESET_CONNECTION_EVENTS="reset-connection-events",r.PRE_CONNECT_PC="pre-connect_pc",r.UPDATE_GATEWAY_CONFIG="update-gateway-config",r}({}),sT=function(r){return r.P2P_DISCONNECTED="P2P_DISCONNECTED",r.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",r.TIMEOUT="TIMEOUT",r.UNKNOWN_REASON="UNKNOWN_REASON",r}({}),Or=function(r){return r[r.Nothing=0]="Nothing",r[r.Audio=1]="Audio",r[r.LwoVideo=2]="LwoVideo",r[r.Video=4]="Video",r[r.Data=8]="Data",r[r.DataStream0=256]="DataStream0",r[r.DataStream1=512]="DataStream1",r[r.DataStream2=1024]="DataStream2",r[r.DataStream3=2048]="DataStream3",r[r.DataStream4=4096]="DataStream4",r[r.DataStream5=8192]="DataStream5",r[r.DataStream6=16384]="DataStream6",r[r.DataStream7=32768]="DataStream7",r}({}),jt=function(r){return r.CHINA="CHINA",r.ASIA="ASIA",r.NORTH_AMERICA="NORTH_AMERICA",r.EUROPE="EUROPE",r.JAPAN="JAPAN",r.INDIA="INDIA",r.KOREA="KOREA",r.HKMC="HKMC",r.US="US",r.OCEANIA="OCEANIA",r.SOUTH_AMERICA="SOUTH_AMERICA",r.AFRICA="AFRICA",r.OVERSEA="OVERSEA",r.GLOBAL="GLOBAL",r.EXTENSIONS="EXTENSIONS",r}({});const mz=[jt.AFRICA,jt.ASIA,jt.CHINA,jt.EUROPE,jt.GLOBAL,jt.INDIA,jt.JAPAN,jt.NORTH_AMERICA,jt.OCEANIA,jt.OVERSEA,jt.SOUTH_AMERICA];let pi=function(r){return r.CHINA="CN",r.ASIA="AS",r.NORTH_AMERICA="NA",r.EUROPE="EU",r.JAPAN="JP",r.INDIA="IN",r.KOREA="KR",r.HKMC="HK",r.US="US",r.OCEANIA="OC",r.SOUTH_AMERICA="SA",r.AFRICA="AF",r.OVERSEA="OVERSEA",r.GLOBAL="GLOBAL",r.EXTENSIONS="GLOBAL",r}({});const aT={CHINA:{},ASIA:{CODE:pi.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:pi.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:pi.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:pi.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:pi.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:pi.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:pi.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:pi.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:pi.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:pi.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:pi.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:pi.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:pi.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};T1&&(aT.CHINA={CODE:pi.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]});let v_=function(r){return r.UPDATE_BITRATE_LIMIT="update_bitrate_limit",r.UPDATE_CLIENT_ROLE_OPTIONS="update_client_role_options",r}({});function gz(r){return!!r&&!(!r.uplink||!r.id)&&r.uplink.max_bitrate!==void 0&&r.uplink.min_bitrate!==void 0}class vz extends An{constructor(o,s){super(),G(this,"onICEConnectionStateChange",void 0),G(this,"onConnectionStateChange",void 0),G(this,"onDTLSTransportStateChange",void 0),G(this,"onDTLSTransportError",void 0),G(this,"onICETransportStateChange",void 0),G(this,"onFirstAudioReceived",void 0),G(this,"onFirstVideoReceived",void 0),G(this,"onFirstAudioDecoded",void 0),G(this,"onFirstVideoDecoded",void 0),G(this,"onFirstVideoDecodedTimeout",void 0),G(this,"onSelectedLocalCandidateChanged",void 0),G(this,"onSelectedRemoteCandidateChanged",void 0),G(this,"onICECandidateError",void 0),G(this,"getLocalVideoStats",void 0)}}class yz extends vz{constructor(o,s){super(o,s),G(this,"establishPromise",void 0)}}let je=function(r){return r.VIDEO="video",r.AUDIO="audio",r}({}),mi=function(r){return r.UDP_RELAY="udp_relay",r.UDP_TCP_RELAY="udp_tcp_relay",r.TCP_RELAY="tcp_relay",r.RELAY="relay",r}({}),ql=function(r){return r[r.FIRST_CONNECTION=0]="FIRST_CONNECTION",r[r.UDP_TCP_RESTART=1]="UDP_TCP_RESTART",r[r.RELAY_RESTART=2]="RELAY_RESTART",r[r.TCP_RESTART=3]="TCP_RESTART",r[r.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",r[r.OLD_RESTART=11]="OLD_RESTART",r[r.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED",r}({});const _z=["disconnected","failed"];let Te=function(r){return r.LocalVideoTrack="videoTrack",r.LocalAudioTrack="audioTrack",r.LocalVideoLowTrack="videoLowTrack",r}({}),$t=function(r){return r.New="new",r.Connected="connected",r.Reconnecting="reconnecting",r.Disconnected="disconnected",r}({}),Ye=function(r){return r.AudioMetadata="audioMetadata",r.StateChange="stateChange",r.IceConnectionStateChange="iceConnectionStateChange",r.RequestMuteLocal="requestMuteLocal",r.RequestUnmuteLocal="requestUnmuteLocal",r.RequestRePublish="requestRePublish",r.RequestRePublishDataChannel="requestRePublishDataChannel",r.RequestReSubscribe="requestReSubscribe",r.RequestUploadStats="requestUploadStats",r.RequestUpload="requestUpload",r.MediaReconnectStart="MediaReconnectStart",r.MediaReconnectEnd="MediaReconnectEnd",r.NeedSignalRTT="NeedSignalRTT",r.RequestRestartICE="RequestRestartIce",r.PeerConnectionStateChange="PeerConnectionStateChange",r.RequestReconnect="RequestReconnect",r.RequestReconnectPC="RequestReconnectPC",r.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",r.P2PLost="P2PLost",r.UpdateVideoEncoder="UpdateVideoEncoder",r.ConnectionTypeChange="ConnectionTypeChange",r.RequestLowStreamParameter="RequestLowStreamParameter",r.QueryClientConnectionState="QueryClientConnectionState",r.LocalCandidate="LocalCandidate",r.RequestP2PMuteLocal="requestP2PMuteLocal",r.RequestP2PUnPublish="RequestP2PUnPublish",r.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",r.RequestP2PMuteRemote="RequestP2PMuteRemote",r.RequestP2PRestartICE="RequestP2PRestartICE",r}({}),va=function(r){return r.CONNECTING="CONNECTING",r.RECONNECTING="RECONNECTING",r.CONNECTED="CONNECTED",r.CLOSED="CLOSED",r}({}),ya=function(r){return r[r.CONNECT_AP=0]="CONNECT_AP",r[r.AP_CONNECTED=1]="AP_CONNECTED",r[r.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",r[r.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",r[r.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",r[r.CONNECT_WORKER=5]="CONNECT_WORKER",r[r.WORKER_CONNECTED=6]="WORKER_CONNECTED",r[r.CLOSED=7]="CLOSED",r}({}),Ur=function(r){return r.CONNECTION_STATE_CHANGE="connection-state-change",r.STATE_CHANGE="state-change",r.INSPECT_RESULT="inspect-result",r.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",r.REQUEST_NEW_WORKER_URL="request-new-worker-url",r}({}),Ez=function(r){return r.CONNECTED="transmitter:connected",r.RECONNECTING="transmitter:reconnecting",r.WILL_RECONNECT="transmitter:will_reconnect",r.CLOSED="transmitter:closed",r.FAILED="transmitter:failed",r.ON_MESSAGE="transmitter:on_message",r.REQUEST_NEW_URLS="transmitter:request_new_urls",r.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",r.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",r.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",r.FAILBACK="transmitter:failback",r.PRE_CONNECT_PC="transmitter:pre_connect_pc",r}({}),Qc=function(r){return r.CAMERA_CHANGED="camera-changed",r.MICROPHONE_CHANGED="microphone-changed",r.PLAYBACK_DEVICE_CHANGED="playback-device-changed",r.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",r.AUTOPLAY_FAILED="autoplay-failed",r.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",r.SECURITY_POLICY_VIOLATION="security-policy-violation",r}({}),Ds=function(r){return r.CONNECTING="CONNECTING",r.RECONNECTING="RECONNECTING",r.CONNECTED="CONNECTED",r.CLOSED="CLOSED",r}({}),sc=function(r){return r.CONNECTION_STATE_CHANGE="connection-state-change",r.STATE_CHANGE="state-change",r.INSPECT_RESULT="inspect-result",r.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",r.REQUEST_NEW_WORKER_URL="request-new-worker-url",r}({}),Lm=function(r){return r[r.CONNECT_AP=0]="CONNECT_AP",r[r.AP_CONNECTED=1]="AP_CONNECTED",r[r.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",r[r.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",r[r.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",r[r.CONNECT_WORKER=5]="CONNECT_WORKER",r[r.WORKER_CONNECTED=6]="WORKER_CONNECTED",r[r.CLOSED=7]="CLOSED",r}({}),Wn=function(r){return r.CALL="call",r.CANDIDATE="candidate",r.PUBLISH="publish",r.UNPUBLISH="unpublish",r.CONTROL="control",r.RESTART_ICE="restart_ice",r.ACK="ack",r.RESPONSE="response",r.JOIN="join",r.CHECK="check",r}({}),Mm=function(r){return r.ABORT="abort",r}({}),pd=function(r){return r.MUTE_LOCAL_AUDIO="mute_local_audio",r.MUTE_LOCAL_VIDEO="mute_local_video",r.UNMUTE_LOCAL_AUDIO="unmute_local_audio",r.UNMUTE_LOCAL_VIDEO="unmute_local_video",r}({}),lxe=function(r){return r.P2P_TOKEN_TIMEOUT="p2p_token_timeout",r.P2P_TOKEN_CHANGED="p2p_token_changed",r}({});const uxe={[rT.ACCESS_POINT]:{[Bi.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[Bi.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[Bi.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[Bi.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[Bi.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[Bi.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[Bi.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[Bi.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[Bi.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[Bi.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[Bi.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[Bi.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[Bi.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[Bi.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[Bi.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[Bi.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[Bi.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[Bi.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[rT.UNILBS]:{[ga.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[ga.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[ga.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[ga.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[ga.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[ga.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[ga.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[ga.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[ga.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[ga.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[ga.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[ga.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[rT.STRING_UID_ALLOCATOR]:{[eD.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[eD.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[eD.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function jm(r){const o=uxe[Math.floor(r/1e4)];if(!o)return{desc:"unknown error",retry:!1};const s=o[r%1e4];if(!s){if(Math.floor(r/1e4)===rT.ACCESS_POINT){const c=r%1e4;if(c.toString()[0]==="1")return{desc:r.toString(),retry:!1};if(c.toString()[0]==="2")return{desc:r.toString(),retry:!0}}return{desc:"unknown error",retry:!1}}return s}const dxe={[Xe.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[Xe.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[Xe.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[Xe.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[Xe.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[Xe.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[Xe.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[Xe.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[Xe.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[Xe.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[Xe.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[Xe.DATASTREAM2_NOT_AVAILABLE]:{desc:"DATASTREAM2_NOT_AVAILABLE",action:"quit"},[Xe.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[Xe.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[Xe.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[Xe.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[Xe.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[Xe.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[Xe.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[Xe.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[Xe.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[Xe.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[Xe.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[Xe.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[Xe.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[Xe.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[Xe.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[Xe.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[Xe.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[Xe.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[Xe.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[Xe.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[Xe.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[Xe.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[Xe.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[Xe.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[Xe.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[Xe.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[Xe.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[Xe.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[Xe.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[Xe.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Xe.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[Xe.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[Xe.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[Xe.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[Xe.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[Xe.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[Xe.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[Xe.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[Xe.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[Xe.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[Xe.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[Xe.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[Xe.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[Xe.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[Xe.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[Xe.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[Xe.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[Xe.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[Xe.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[Xe.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[Xe.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[Xe.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function y_(r){return dxe[r]||{desc:"UNKNOWN_ERROR_".concat(r),action:"failed"}}function bz(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function iD(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?bz(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):bz(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}function oD(r,o){if(typeof r=="string")return r;const{proxy:s,host:c,port:u}=r;if(o){const h=q("JOIN_GATEWAY_FALLBACK_PORT")||443;return h===443?"wss://".concat(c,"/ws/?p=").concat(Number(u)+150):"wss://".concat(c,":").concat(h,"/ws/?p=").concat(Number(u)+150)}return s?"wss://".concat(s,"/ws/?h=").concat(c,"&p=").concat(u):"wss://".concat(c,":").concat(u)}const hxe=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,fxe=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,pxe=/wss:\/\/(.+):([0-9]+)\/?/,mxe=/wss:\/\/(.[^\/]+)\/?/;let gxe=0;class vxe{constructor(o,s){G(this,"id",0),G(this,"store",void 0),G(this,"recordIndex",void 0),G(this,"websockets",[]),G(this,"try443PortDuration",2e3),G(this,"forceCloseWSDuration",5e3),G(this,"try443PortTimeout",null),G(this,"forceCloseTimeout",null),G(this,"isTry443PortFailed",!1),G(this,"isNormalPortFailed",!1),G(this,"useDoubleDomain",!1),G(this,"useProxy",!1),G(this,"startTime",Date.now()),this.id=++gxe,this.try443PortDuration=q("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=o||5e3,this.store=s}closeAllWebsockets(){this.websockets.forEach(o=>{o.onopen=null,o.onclose=null,o.onmessage=null,o.close()}),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout),this.forceCloseTimeout=null,this.try443PortTimeout=null}logger(){var o;const s=Date.now()-this.startTime;for(var c=arguments.length,u=new Array(c),h=0;h<c;h++)u[h]=arguments[h];L.debug("[choose-best-ws ".concat((o=this.store)===null||o===void 0?void 0:o.clientId," ").concat(this.id,"] ").concat(s,"ms:"),...u)}createWebSocket(o,s,c){this.logger("createWebSocket:",o,{isTry443Port:s,hasTimeoutDetection:c});const u=q("GATEWAY_DOMAINS"),h=Date.now(),p=[],g=u.find(A=>{var x;return Pe(x=o.host).call(x,A)});g||(this.useDoubleDomain=!1);const y=[];if(this.useDoubleDomain)u.forEach(A=>{y.push(oD(iD(iD({},o),{},{host:o.host.replace(g,A)}),s))});else{const A=iD({},o);if(s&&g){const x=u.find(B=>B!==g);x&&(A.host=A.host.replace(g,x))}y.push(oD(A,s))}try{y.forEach(A=>{const x=new WebSocket(A);x.binaryType="arraybuffer",p.push(x),this.logger("ws is connecting:",x.url)})}catch(A){if(this.logger("ws create failed"),p.forEach(x=>x.close()),p.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(o,s,c);if(!s&&Number(o.port)!==443)return this.createWebSocket(o,!0,c);throw new pe(Y.WS_ERR,"init websocket failed! Error: ".concat(A.toString()))}const b=n_();this.store&&this.store.recordJoinChannelService({urls:p.map(A=>A.url),service:"gateway"},this.recordIndex),p.forEach(A=>{A.onopen=()=>{this.logger("onopen: ws ".concat(A.url," open cost ").concat(Date.now()-h,"ms")),this.websockets.forEach(x=>{x!==A&&(x.onopen=null,x.onclose=null,x.onmessage=null,x.close(),this.logger("close backup websocket: ".concat(x.url)))}),this.websockets.length=0,b.resolve(A)},A.onclose=x=>{this.logger("onclose: ws ".concat(A.url," closed cost ").concat(Date.now()-h,"ms state: ").concat(A.readyState));const B=p.every(U=>U.readyState===WebSocket.CLOSED||U.readyState===WebSocket.CLOSING);this.logger("".concat(s?"443":"47xx"," websocket closed, all failed: ").concat(B)),B&&(s||this.isTry443PortFailed||this.useProxy)?(this.logger("onclose: all websocket is closed, ".concat(x.reason)),b.reject({code:x.code,reason:sT.A_ROUND_WS_FAILED})):!s&&B&&!this.isNormalPortFailed&&this.try443PortTimeout&&(this.logger("all 47xx websocket is closed, try 443 port"),this.clearTimeout(),C()),s?this.isTry443PortFailed=B:this.isNormalPortFailed=B},A.onmessage=x=>this.logger("".concat(A.url," onmessage: ").concat(x.data))}),this.websockets.push(...p);const w=()=>{this.websockets.forEach(A=>A.readyState!==WebSocket.OPEN&&A.close())},C=()=>{if(b.isResolved)return w();It().os===Rr.MAC_OS&&xn()&&w(),this.createWebSocket(o,!0,!0).then(A=>{b.resolve(A)}).catch(A=>{this.isNormalPortFailed&&b.reject(A),this.logger("try 443 port to create ws failed")}),this.forceCloseTimeout=window.setTimeout(()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",b.isResolved),this.forceCloseTimeout=null,w()},this.forceCloseWSDuration)};return c||(()=>{if(s||this.useProxy)return this.logger("add 5s timeout at ".concat(s?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(()=>{this.forceCloseTimeout=null,w()},this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout(()=>{this.logger("2s timeout, isWebsocket created: ",b.isResolved),this.try443PortTimeout=null,C()},this.try443PortDuration)})(),b.promise}chooseBestWebsocket(o,s,c,u){return this.useDoubleDomain=!!s,typeof o=="string"&&(o=function(h){let p,g,y;return[,p,g,y]=h.match(hxe)||[],p||([,g,y]=h.match(fxe)||[]),g&&y||([,g,y]=h.match(pxe)||[]),g&&y||([,g]=h.match(mxe)||[]),g||L.warning("un-destructible url: ",h),{proxy:p,host:g,port:y||"443"}}(o)),this.recordIndex=u,this.useProxy=!!o.proxy,c&&this.useProxy&&(L.warn("cannot use 443 only when use proxy"),c=!1),this.createWebSocket(o,!!c,!1).finally(()=>this.clearTimeout())}}function Sz(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}class wz extends An{get url(){return this.websocket&&this.websocket.url||this._websocketUrl}get reconnectMode(){return this._reconnectMode}set reconnectMode(o){var s;Pe(s=["tryNext","recover"]).call(s,o)&&this.resetReconnectCount(o),this._reconnectMode=o}get state(){return this._state}set state(o){o!==this._state&&(this._state=o,this._state==="reconnecting"?this.emit(lt.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(lt.CONNECTED):this._state==="closed"?this.emit(lt.CLOSED):this._state==="failed"&&this.emit(lt.FAILED))}resetReconnectCount(o){L.debug("websocket reset reconnect count, reason: "+o),this.reconnectCount=0}constructor(o,s){let c=arguments.length>2&&arguments[2]!==void 0&&arguments[2],u=arguments.length>3&&arguments[3]!==void 0&&arguments[3],h=arguments.length>4&&arguments[4]!==void 0&&arguments[4],p=arguments.length>5?arguments[5]:void 0;super(),G(this,"_websocketUrl",null),G(this,"connectionID",0),G(this,"currentURLIndex",0),G(this,"urls",[]),G(this,"_reconnectMode","tryNext"),G(this,"reconnectReason",void 0),G(this,"_initMutex",void 0),G(this,"name",void 0),G(this,"_state","closed"),G(this,"reconnectInterrupter",void 0),G(this,"websocket",void 0),G(this,"retryConfig",void 0),G(this,"reconnectCount",0),G(this,"forceCloseTimeout",5e3),G(this,"onlineReconnectListener",void 0),G(this,"useCompress",void 0),G(this,"tryDoubleDomain",!1),G(this,"use443PortOnly",!1),G(this,"wsInflateLength",0),G(this,"wsDeflateLength",0),G(this,"closeEstablishingWs",()=>{}),G(this,"store",void 0),G(this,"joinGatewayRecordIndex",void 0),this.store=p,this.name=o,this.retryConfig=function(C){for(var A=1;A<arguments.length;A++){var x=arguments[A]!=null?arguments[A]:{};A%2?Sz(Object(x),!0).forEach(function(B){G(C,B,x[B])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(x)):Sz(Object(x)).forEach(function(B){Object.defineProperty(C,B,Object.getOwnPropertyDescriptor(x,B))})}return C}({},s),this.useCompress=c,this.tryDoubleDomain=u,this.use443PortOnly=h,this._initMutex=new fi("websocket",p?p.clientId:void 0);const{timeout:g,timeoutFactor:y}=s,b=Math.max(300,Math.floor(3*g/5)),w=Math.max(1.2,Math.floor(8*y)/10);Do.ONLINE&&(this.retryConfig.timeout=b,this.retryConfig.timeoutFactor=w),qn.on(gm.NETWORK_STATE_CHANGE,(C,A)=>{C!==A&&(this.resetReconnectCount("network state change: ".concat(A," -> ").concat(C)),C===Do.ONLINE?(this.retryConfig.timeout=b,this.retryConfig.timeoutFactor=w):(this.retryConfig.timeout=g,this.retryConfig.timeoutFactor=y))})}getConnection(){return this.websocket||void 0}async init(o){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const c=await this._initMutex.lock();this._reconnectMode="tryNext",this.forceCloseTimeout=s,this.urls=o,this.state="connecting";try{const u=n_(),h=this.urls[this.currentURLIndex];q("ENABLE_PREALLOC_PC")&&this.emit(Ez.PRE_CONNECT_PC),this.createWebSocketConnection(h).then(u.resolve).catch(u.reject),this.once(lt.CLOSED,()=>{u.reject(new ve(Y.WS_DISCONNECT))}),this.once(lt.CONNECTED,u.resolve),await u.promise}catch{}finally{c()}}close(o,s){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const c=this.websocket;s?setTimeout(()=>c.close(),500):c.close(),this.websocket=void 0,this._websocketUrl=null}this.state=o?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(o,s){if(!this.websocket)return void L.warning("[".concat(this.name,"] can not reconnect, no websocket"));o!==void 0&&(this.reconnectMode=o),L.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinGatewayRecordIndex=="number"&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(s)]},this.joinGatewayRecordIndex);const c=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),c&&c.bind(this.websocket)({code:9999,reason:s})}sendMessage(o){let s=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new ve(Y.WS_ABORT,"websocket is not ready");try{s||(o=JSON.stringify(o)),this.websocket.send(o)}catch(c){throw new ve(Y.WS_ERR,"send websocket message error"+c.toString())}}setWsInflateData(o){this.wsDeflateLength=this.wsDeflateLength+o.originLength,this.wsInflateLength=this.wsInflateLength+o.compressedLength}getWsInflateData(){const o=this.wsInflateLength,s=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:o,wsDeflateLength:s}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(o){var s;const c=n_();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const u=w=>{var C;(C=this.store)===null||C===void 0||C.signalChannelOpen(),L.debug("[".concat(this.name,"] websocket opened:"),w),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),c.resolve()},h=async w=>{var C;if(L.debug("[".concat(this.name,"] websocket close ").concat((C=this.websocket)===null||C===void 0?void 0:C.url,", code: ").concat(w.code,", reason: ").concat(w.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)c.reject(new ve(Y.WS_DISCONNECT,"websocket close: ".concat(w.code))),this.close();else{this.state==="connected"&&(this.reconnectReason=w.reason,this.state="reconnecting");const A=Zo(this,lt.WILL_RECONNECT,this.reconnectMode,w.reason)||this.reconnectMode,x=await this.reconnectWithAction(A);if(this.state==="closed")return void L.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!x)return c.reject(new ve(Y.WS_DISCONNECT,"websocket reconnect failed: ".concat(w.code))),this.close(!0);c.resolve()}},p=w=>{this.emit(lt.ON_MESSAGE,w)},g=w=>{L.warn("[".concat(this.connectionID,"] ws open error ").concat(w))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),q("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(o=q("GATEWAY_WSS_ADDRESS")),L.debug("[".concat(this.name,"] start connect, url:"),o);const y=(s=this.store)===null||s===void 0?void 0:s.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var b;this._websocketUrl=oD(o);const w=await this.chooseBestWebsocketConnection(o);this.websocket=w,u&&u(this.websocket.url),this.websocket.onclose=h,this.websocket.onmessage=p,this.websocket.onerror=g,(b=this.store)===null||b===void 0||b.recordJoinChannelService({endTs:Date.now(),status:"success"},y),this.joinGatewayRecordIndex=y}catch(w){const C=this.state==="closed",A=w instanceof ve,x=A&&w.code===Y.WS_ABORT,B=A&&w.code===Y.WS_ERR,U=A?w.message:w&&(w.reason||w.toString());L.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(U)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:x?"aborted":"error",errors:[w]},y),C||B?(c.reject(C?new ve(Y.WS_DISCONNECT,"websocket is closed: ".concat(U)):new ve(Y.WS_ERR,"init websocket failed: ".concat(U))),B&&L.error("[".concat(this.name,"] init websocket failed: ").concat(U))):h&&h(w)}return c.promise}async reconnectWithAction(o){let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||this.urls.length===0||this.state==="closed")return!1;L.warning("[choose-best-ws] action: =>",o),this.onlineReconnectListener||qn.isOnline||!qn.onlineWaiter||(this.onlineReconnectListener=qn.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let c=!0;if(this.reconnectInterrupter=()=>c=!1,s){const p=g1(this.reconnectCount,this.retryConfig);L.debug("[".concat(this.name,"] wait ").concat(p,"ms to reconnect websocket, mode: ").concat(o)),await De.race([Kr(p),this.onlineReconnectListener||new De(()=>{})])}if(this._state==="closed"||!c)return!1;this.reconnectCount+=1;const u=async(p,g)=>{this.emit(lt.RECONNECT_CREATE_CONNECTION,g),await this.createWebSocketConnection(p)};try{if(o==="retry")await u(this.urls[this.currentURLIndex],o);else if(o==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);L.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),await u(this.urls[this.currentURLIndex],o)}else o==="recover"&&(L.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.urls=await oi(this,lt.REQUEST_NEW_URLS),this.currentURLIndex=0,await u(this.urls[this.currentURLIndex],o))}catch(p){var h;L.error("[".concat(this.name,"] reconnect failed ").concat(p&&p.toString()));const g=p==null||(h=p.data)===null||h===void 0?void 0:h.desc;return Array.isArray(g)&&Pe(g).call(g,"dynamic key expired")?(this.emit(lt.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(o,s)}return!0}}class sD extends wz{constructor(o,s){super(o,s,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(o,s){const c=n_(),u=function(p,g){return new vxe(p,g)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{L.debug("[choose-best-ws] close establishing websockets"),u.closeAllWebsockets(),c.reject(new ve(Y.WS_ABORT,"choose best websocket aborted"))};const h=q("GATEWAY_DOMAINS");return L.debug("[choose-best-ws] currentDomain: ",o,", domains: ",h,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),u.chooseBestWebsocket(o,this.tryDoubleDomain,this.use443PortOnly,s).then(c.resolve).catch(c.reject),c.promise.finally(()=>{this.closeEstablishingWs=void 0})}}class __ extends wz{constructor(o,s){super(o,s,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments.length>4&&arguments[4]!==void 0&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(o,s){return new De((c,u)=>{let h=!1;const p=[];this.closeEstablishingWs=()=>{L.debug("[choose-best-ws] close establishing websockets"),p.forEach(B=>{B.onclose=null,B.onopen=null,B.onmessage=null,B.close()}),u(new ve(Y.WS_ABORT,"choose best websocket aborted"))};const g=q("GATEWAY_DOMAINS");let y;const b=o.indexOf("?h="),w=g.find(B=>b!==-1?Pe(o).call(o,B,b):Pe(o).call(o,B));L.debug("[choose-best-ws] currentDomain: ",w,", domains: ",g);let C=!this.tryDoubleDomain||!w;if(!C&&w){var A;const B=Date.now();try{g.forEach(U=>{const F=b===-1?o.replace(w,U):o.substr(0,b)+o.substr(b).replace(w,U),K=new WebSocket(F);K.binaryType="arraybuffer",p.push(K),L.debug("[choose-best-ws] ws is connecting:",K.url)})}catch{for(L.debug("[choose-best-ws] ws create failed, fallback to single url"),p.forEach(F=>F.close());p.length;)p.pop();C=!0}(A=this.store)===null||A===void 0||A.recordJoinChannelService({urls:p.map(U=>U.url),service:"gateway"},s),p.forEach(U=>{U.onopen=()=>{if(h)return;const F=Date.now()-B;L.debug("[choose-best-ws] ws open cost ".concat(F,"ms")),p.filter(K=>K!==U).forEach(K=>{L.debug("[choose-best-ws]close backup websocket: ".concat(K.url)),K.close()}),h=!0,c(U)},U.onclose=F=>{y=F,!h&&(p.find(K=>!(K.readyState===WebSocket.CLOSED||K.readyState===WebSocket.CLOSING))||(L.debug("[choose-best-ws] all websocket is closed"),h=!0,u(y)))},U.onmessage=F=>{L.debug("[choose-best-ws]".concat(U.url," onmessage: ").concat(F.data))}}),Kr(this.forceCloseTimeout).then(()=>{p.forEach(U=>{U.readyState!==WebSocket.OPEN&&U.close()})})}if(C){var x;let B;L.debug("[choose-best-ws] use single url: ",o),(x=this.store)===null||x===void 0||x.recordJoinChannelService({urls:[o],service:"gateway"},s);try{B=new WebSocket(o),p.push(B),B.binaryType="arraybuffer"}catch(U){const F=new ve(Y.WS_ERR,"init websocket failed! Error: ".concat(U.toString()));return L.error("[".concat(this.name,"]").concat(F)),void u(F)}B.onopen=()=>{c(B)},B.onclose=U=>{u(U)},B.onmessage=U=>{L.debug("[choose-best-ws]".concat(B.url," onmessage: ").concat(U.data))},Kr(this.forceCloseTimeout).then(()=>{B&&B.readyState!==WebSocket.OPEN&&B.close()})}}).then(c=>(this.closeEstablishingWs=void 0,c)).catch(c=>{throw this.closeEstablishingWs=void 0,c})}}class yxe extends An{get connectionState(){return this._connectionState}set connectionState(o){o!==this._connectionState&&(this._connectionState=o,o===dn.CONNECTED?this.emit(it.WS_CONNECTED):o===dn.RECONNECTING?this.emit(it.WS_RECONNECTING,this._websocketReconnectReason):o===dn.CLOSED&&this.emit(it.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(o,s){super(),G(this,"_disconnectedReason",void 0),G(this,"_websocketReconnectReason",void 0),G(this,"_connectionState",dn.CLOSED),G(this,"reconnectToken",void 0),G(this,"websocket",void 0),G(this,"openConnectionTime",void 0),G(this,"clientId",void 0),G(this,"lastMsgTime",Date.now()),G(this,"uploadCache",[]),G(this,"uploadCacheInterval",void 0),G(this,"rttRolling",new k8(5)),G(this,"pingpongTimer",void 0),G(this,"wsInflateDataTimer",void 0),G(this,"pingpongTimeoutCount",0),G(this,"joinResponse",void 0),G(this,"multiIpOption",void 0),G(this,"initError",void 0),G(this,"spec",void 0),G(this,"store",void 0),G(this,"onWebsocketMessage",c=>{if(c.data instanceof ArrayBuffer)return void this.emit(it.ON_BINARY_DATA,c.data);const u=JSON.parse(c.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(u,"_id")){const h="res-@".concat(u._id);this.emit(h,u._result,u._message)}else if(Object.prototype.hasOwnProperty.call(u,"_type")){if(this.emit(u._type,u._message),u._type===bt.ON_NOTIFICATION&&this.handleNotification(u._message),u._type===bt.ON_USER_BANNED)switch(u._message.error_code){case 14:this.close(Bt.UID_BANNED);break;case 15:this.close(Bt.IP_BANNED);break;case 16:this.close(Bt.CHANNEL_BANNED)}if(u._type===bt.ON_USER_LICENSE_BANNED)switch(u._message.error_code){case Xe.ERR_LICENSE_MISSING:this.close(Bt.LICENSE_MISSING);break;case Xe.ERR_LICENSE_EXPIRED:this.close(Bt.LICENSE_EXPIRED);break;case Xe.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Bt.LICENSE_MINUTES_EXCEEDED);break;case Xe.ERR_LICENSE_PERIOD_INVALID:this.close(Bt.LICENSE_PERIOD_INVALID);break;case Xe.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Bt.LICENSE_MULTIPLE_SDK_SERVICE);break;case Xe.ERR_LICENSE_ILLEGAL:this.close(Bt.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=o.clientId,this.spec=o,this.store=s,this.websocket=new sD("gateway-".concat(this.clientId),this.spec.retryConfig,!0,q("JOIN_GATEWAY_USE_DUAL_DOMAIN"),q("JOIN_GATEWAY_USE_443PORT_ONLY"),s),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===dn.CONNECTED&&this.reconnect("retry",ii.OFFLINE)})}async request(o,s,c,u){const h=cn(6,""),p={_id:h,_type:o,_message:s},g=this.websocket.connectionID,y=()=>new De((B,U)=>{if(this.connectionState===dn.CONNECTED)return B();const F=()=>{this.off(it.WS_CLOSED,K),B()},K=()=>{this.off(it.WS_CONNECTED,F),U(new pe(Y.WS_ABORT))};this.once(it.WS_CONNECTED,F),this.once(it.WS_CLOSED,K),o!==tt.PUBLISH&&o!==tt.PUBLISH_DATASTREAM&&o!==tt.SUBSCRIBE&&o!==tt.SUBSCRIBE_DATASTREAM&&o!==tt.UNSUBSCRIBE&&o!==tt.UNSUBSCRIBE_DATASTREAM&&o!==tt.UNPUBLISH&&o!==tt.UNPUBLISH_DATASTREAM&&o!==tt.CONTROL&&o!==tt.RESTART_ICE||this.once(it.DISCONNECT_P2P,()=>{U(new pe(Y.DISCONNECT_P2P))}),o!==tt.PUBLISH&&o!==tt.RESTART_ICE||this.once(it.ABORT_P2P_EXECUTION,()=>{U(new pe(Y.DISCONNECT_P2P))})});if(this.connectionState!==dn.CONNECTING&&this.connectionState!==dn.RECONNECTING||o===tt.JOIN||o===tt.REJOIN||await y(),this.websocket.sendMessage(p,!0),u)return;const b=new De((B,U)=>{let F=!1;const K=(Q,ie)=>{F=!0,B({isSuccess:Q==="success",message:ie||{}}),this.off(it.WS_CLOSED,z),this.off(it.WS_RECONNECTING,z),this.emit(it.REQUEST_SUCCESS,o,s)};this.once("res-@".concat(h),K);const z=()=>{U(new pe(Y.WS_ABORT,"type: ".concat(o))),this.off(it.WS_CLOSED,z),this.off(it.WS_RECONNECTING,z),this.off("res-@".concat(h),K)};this.once(it.WS_CLOSED,z),this.once(it.WS_RECONNECTING,z),Kr(q("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==g||F||(L.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(o)),this.emit(it.REQUEST_TIMEOUT,o,s))})});let w=null;try{w=await b}catch(B){if(this.connectionState===dn.CLOSED||o===tt.LEAVE)throw new pe(Y.WS_ABORT);return!this.spec.forceWaitGatewayResponse||c?B.throw():o===tt.JOIN||o===tt.REJOIN?null:(await y(),await this.request(o,s))}if(w.isSuccess)return w.message;const C=Number(w.message.error_code||w.message.code),A=y_(C),x=new pe(Y.UNEXPECTED_RESPONSE,"".concat(A.desc,": ").concat(w.message.error_str),{code:C,data:w.message,desc:A.desc});return A.action==="success"?w.message:(L.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(o,", error_code: ").concat(C,", message: ").concat(A.desc,", action: ").concat(A.action)),C===Xe.ERR_TOO_MANY_BROADCASTERS?((o===tt.JOIN||o===tt.REJOIN)&&(this.initError=x,this.close()),x.throw()):A.action==="failed"?x.throw():A.action==="quit"?(this.initError=x,this.close(),x.throw()):(C===Xe.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=w.message.option,L.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",ii.MULTI_IP)):this.reconnect(A.action,ii.SERVER_ERROR),o===tt.JOIN||o===tt.REJOIN?null:await this.request(o,s)))}waitMessage(o,s){return new De(c=>{const u=h=>{(!s||s(h))&&(this.off(o,u),c(h))};this.on(o,u)})}uploadWRTCStats(o){if(!this.store.sessionId)return void L.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const s={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:o};this.upload(g_.WRTC_STATS,s)}upload(o,s){const c={_type:o,_message:s};try{this.websocket.sendMessage(c)}catch{const h=q("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(c),this.uploadCache.length>h&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==dn.CONNECTED)return;const p=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(p._type,p._message)},q("UPLOAD_CACHE_INTERVAL")||2e3))}}send(o,s){const c={_type:o,_message:s};this.websocket.sendMessage(c)}init(o){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new De((s,c)=>{this.once(it.WS_CONNECTED,()=>s(this.joinResponse)),this.once(it.WS_CLOSED,u=>c(this.initError||new pe(Y.WS_ABORT,u))),this.connectionState=dn.CONNECTING,this.websocket.init(o).catch(c),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4)})}close(o){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=o||Bt.LEAVE,this.connectionState=dn.CLOSED,L.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close()}async join(){if(!this.joinResponse){this.emit(it.ABORT_P2P_EXECUTION);const o=await oi(this,it.REQUEST_JOIN_INFO),s=await this.request(tt.JOIN,o);if(!s)return this.emit(it.REPORT_JOIN_GATEWAY,sT.TIMEOUT,this.url||""),!1;this.joinResponse=s,this.emit(it.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=dn.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new pe(Y.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const o=c_(this,it.REQUEST_REJOIN_INFO);o.token=this.reconnectToken;const s=await this.request(tt.REJOIN,o);return!!s&&(this.connectionState=dn.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),s.peers&&s.peers.forEach(c=>{this.emit(bt.ON_USER_ONLINE,{uid:c.uid}),c.audio&&this.emit(bt.ON_ADD_AUDIO_STREAM,{uid:c.uid,uint_id:c.uint_id,audio:!0,ssrcId:c.audio_ssrc}),c.video&&this.emit(bt.ON_ADD_VIDEO_STREAM,{uid:c.uid,uint_id:c.uint_id,video:!0,ssrcId:c.video_ssrc}),c.audio_mute?this.emit(bt.MUTE_AUDIO,{uid:c.uid}):this.emit(bt.UNMUTE_AUDIO,{uid:c.uid}),c.video_mute?this.emit(bt.MUTE_VIDEO,{uid:c.uid}):this.emit(bt.UNMUTE_VIDEO,{uid:c.uid}),c.audio_enable_local?this.emit(bt.ENABLE_LOCAL_AUDIO,{uid:c.uid}):this.emit(bt.DISABLE_LOCAL_AUDIO,{uid:c.uid}),c.video_enable_local?this.emit(bt.ENABLE_LOCAL_VIDEO,{uid:c.uid}):this.emit(bt.DISABLE_LOCAL_VIDEO,{uid:c.uid}),c.audio||c.video||this.emit(bt.ON_REMOVE_STREAM,{uid:c.uid,uint_id:c.uint_id})}),!0)}reconnect(o,s){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(o,s)}handleNotification(o){L.debug("[".concat(this.clientId,"] receive notification: "),o);const s=y_(o.code);if(o.code===28&&"detail"in o&&(L.info("[".concat(this.clientId,"] receive recover notification: "),o.detail),this.emit(it.RECOVER_NOTIFICATION,o.detail)),s.action!=="success"){if(s.action!=="failed")return s.action==="quit"?(s.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Bt.UID_BANNED),void this.close()):void this.reconnect(s.action,ii.SERVER_ERROR);L.error("[".concat(this.clientId,"] ignore error: "),s.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const o=q("PING_PONG_TIME_OUT"),s=Date.now();this.pingpongTimeoutCount>=o&&(L.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(s-this.lastMsgTime,"ms")),s-this.lastMsgTime>q("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",ii.TIMEOUT):this.request(tt.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const c=Date.now()-s;this.rttRolling.add(c),q("REPORT_STATS")&&this.send(tt.PING_BACK,{pingpongElapse:c})}).catch(c=>{})}handleWsInflateData(){const{wsInflateLength:o,wsDeflateLength:s}=this.websocket.getWsInflateData();o!==0&&s!==0&&this.upload(g_.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:s,ws_inflate_length:o})}handleWebsocketEvents(){this.websocket.on(lt.RECONNECT_CREATE_CONNECTION,o=>{this.emit(it.WS_RECONNECT_CREATE_CONNECTION,o)}),this.websocket.on(lt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(lt.CLOSED,()=>{this.connectionState=dn.CLOSED}),this.websocket.on(lt.FAILED,()=>{this._disconnectedReason=Bt.NETWORK_ERROR,this.connectionState=dn.CLOSED}),this.websocket.on(lt.RECONNECTING,o=>{this._websocketReconnectReason=o,this.joinResponse=void 0,this.connectionState===dn.CONNECTED?this.connectionState=dn.RECONNECTING:this.connectionState=dn.CONNECTING}),this.websocket.on(lt.WILL_RECONNECT,(o,s,c)=>{const u=c_(this,it.IS_P2P_DISCONNECTED),h=u||o!=="retry";u&&o==="retry"&&(L.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),o="tryNext",s=sT.P2P_DISCONNECTED),h&&(L.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(o)),this.emit(it.REPORT_JOIN_GATEWAY,s||sT.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(it.DISCONNECT_P2P)),c(o)}),this.websocket.on(lt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(o=>{L.warning("[".concat(this.clientId,"] rejoin failed ").concat(o)),this.reconnect("tryNext",ii.SERVER_ERROR)}):this.join().catch(o=>{if(this.emit(it.REPORT_JOIN_GATEWAY,o,this.url||""),o instanceof pe){if(o.code===Y.UNEXPECTED_RESPONSE&&o.data.code===Xe.ERR_NO_AUTHORIZED)return this.initError=new pe(Y.TOKEN_EXPIRE,"dynamic key expired"),void this.close(Bt.TOKEN_EXPIRE);L.error("[".concat(this.clientId,"] join gateway request failed"),o.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",ii.SERVER_ERROR):(this.initError=o,this.close())}})}),this.websocket.on(lt.REQUEST_NEW_URLS,(o,s)=>{oi(this,it.REQUEST_RECOVER,this.multiIpOption).then(o).catch(s)}),this.websocket.on(lt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(bt.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on(Ez.PRE_CONNECT_PC,()=>{this.emit(it.PRE_CONNECT_PC)})}}let _xe=function(r){return r.NATIVE_RTC="native_rtc",r.NATIVE_RTM="native_rtm",r.WEB_RTC="web_rtc",r.WEB_RTM="web_rtm",r}({}),Xn=function(r){return r[r.CHOOSE_SERVER=11]="CHOOSE_SERVER",r[r.CLOUD_PROXY=18]="CLOUD_PROXY",r[r.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",r[r.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK",r}({});function Tz(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function cT(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?Tz(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):Tz(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}function md(r){return r.match(/^[\.\:\d]+$/)?"".concat(r.replace(/[^\d]/g,"-"),".").concat(q("TURN_DOMAIN")):(L.debug("Cannot recognized as ip address: ".concat(r,", use as host")),r)}function aD(r,o){r.addresses||(r.addresses=[]);const s=function(g,y){if(q("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return g.map(C=>{let{ip:A,port:x}=C;return{address:"".concat(A,":").concat(x)}});const b=q("GATEWAY_DOMAINS");let w=b[1]&&Pe(y).call(y,b[1])?1:0;return g.map(C=>{let{domain_prefix:A,port:x,ip:B}=C;if(A)return{address:"".concat(A,".").concat(b[w++%b.length],":").concat(x)};const U=/^[\.\:\d]+$/.test(B),F=U?"".concat(B.replace(/[^\d]/g,"-"),".").concat(b[w++%b.length],":").concat(x):"".concat(B,":").concat(x);return U||L.debug("Cannot recognized as ip address: ".concat(B,", use as host")),{ip:B,port:x,address:F}})}(r.addresses,o),c=Array.isArray(r.detail)&&r.detail[18];if(c&&typeof c=="string"){const g=c.split(";");for(let y=0;y<g.length;y++){var u;const b=Oi(u=g[y]).call(u);s[y]&&b&&(s[y].ip6=b)}}const h=r.detail&&r.detail.candidate;let p;if(h){const[g,y]=h.split(":");g&&y&&(p={port:Number(y),ip:g,address:"".concat(g,":").concat(y)})}return{gatewayAddrs:s,apGatewayAddress:p,uid:r.uid,cid:r.cid,cert:r.cert,vid:r.detail&&r.detail[8],uni_lbs_ip:r.detail&&r.detail[1],res:r,csIp:r.detail&&r.detail[502]}}function ko(r){return typeof r=="number"?r:r.exact||r.ideal||r.max||r.min||0}function Cz(r){const o=r._encoderConfig;if(!o)return{};const s={resolution:o.width&&o.height?"".concat(ko(o.width),"x").concat(ko(o.height)):void 0,maxVideoBW:o.bitrateMax,minVideoBW:o.bitrateMin};return typeof o.frameRate=="number"?(s.maxFrameRate=o.frameRate,s.minFrameRate=o.frameRate):o.frameRate&&(s.maxFrameRate=o.frameRate.max||o.frameRate.ideal||o.frameRate.exact||o.frameRate.min,s.minFrameRate=o.frameRate.min||o.frameRate.ideal||o.frameRate.exact||o.frameRate.max),s}function Rz(r){return r>=0&&r<.17?1:r>=.17&&r<.36?2:r>=.36&&r<.59?3:r>=.59&&r<=1?4:r>1?5:0}function E_(r,o){let s,c,u;switch(o){case Xn.CHOOSE_SERVER:c=4096,u="choose server";break;case Xn.CLOUD_PROXY:c=1048576,u="proxy";break;case Xn.CLOUD_PROXY_5:c=4194304,u="proxy5";break;case Xn.CLOUD_PROXY_FALLBACK:c=4194310,u="proxy fallback";break;default:throw new pe(Y.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:r.detail&&r.detail[502],retry:!1})}if(r.response_body.forEach(h=>{h.buffer&&h.buffer.flag===c&&(s={code:h.buffer.code,addresses:(h.buffer.edges_services||[]).map(p=>cT(cT({},p),{},{ticket:h.buffer.cert})),server_ts:r.enter_ts,uid:h.buffer.uid,cid:h.buffer.cid,cname:h.buffer.cname,detail:cT(cT({},h.buffer.detail),r.detail),flag:h.buffer.flag,opid:r.opid,cert:h.buffer.cert})}),!s)throw new pe(Y.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(u," from multi unilbs response"),{csIp:r.detail&&r.detail[502]});return s}async function Az(r,o){return await De.all(r.addresses.map(async s=>({address:q("USE_TURN_IP")?s.ip:md(s.ip),tcpport:s.port,udpport:s.port,username:o&&q("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?o.toString():si.username,password:o&&q("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await d1(o.toString()):si.password})))}function cD(r,o){const s=o.getMediaStreamTrack(!0).getSettings(),c=o.videoHeight||s.height,u=o.videoWidth||s.width;return c&&u?Math.max(Math.min(c,u)/Math.min(ko(r.height),ko(r.width)),1):(L.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function gd(r){let{candidateType:o,relayProtocol:s,type:c,address:u,port:h,protocol:p}=r;const g={candidateType:o,relayProtocol:s,protocol:p};if(c!=="local-candidate"){const y=u.split(".");y.length>=4&&(y[1]="*",y[2]="*"),g.address=y.join("."),g.port=h}return g}function lT(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:q("SVC_MODE");if(q("ENABLE_SVC"))return function(o){return o in Vw}(r)?r:Vw.L1T3}const Oz={[je.VIDEO]:[{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"},{key:"video-orientation",extensionName:"urn:3gpp:video-orientation"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"playout-delay",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay"},{key:"video-content-type",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type"},{key:"color-space",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/color-space"},{key:"video-timing",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/video-timing"}],[je.AUDIO]:[{key:"ssrc-audio-level",extensionName:"urn:ietf:params:rtp-hdrext:ssrc-audio-level"},{key:"draft-holmer-rmcat-transport-wide-cc-extensions-01",extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"},{key:"abs-send-time",extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}]};function uT(r,o,s){o.forEach(c=>{var u;const h=Oz[r].find(g=>{var y;let{key:b}=g;return Pe(y=c.extensionName).call(y,b)});if(!h)return;const p=s.find(g=>{let{extensionName:y}=g;return Pe(y).call(y,h.key)});p&&Pe(u=p.extensionName).call(u,"gdpr_forbidden")&&(c.extensionName=p.extensionName)})}function Um(r,o){o.forEach(s=>{var c;const u=Oz[r].find(h=>{var p;let{key:g}=h;return Pe(p=s.extensionName).call(p,g)});Pe(c=s.extensionName).call(c,"gdpr_forbidden")&&u&&(s.extensionName=u.extensionName)})}function Iz(r){return r==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"||Pe(r).call(r,"abs-send-time")}function dT(r){return r==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"||Pe(r).call(r,"draft-holmer-rmcat-transport-wide-cc-extensions-01")}function xz(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function Pz(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?xz(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):xz(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}function b_(r){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},c=arguments.length>3?arguments[3]:void 0;const{filterRTX:u,filterVideoFec:h,filterAudioFec:p,filterAudioCodec:g,filterVideoCodec:y}=o,{useXR:b}=s;let w=[],C=[],A=[],x=[],B=!1,U=!1;if(ho(r).mediaDescriptions.forEach(K=>{c&&c!==K.attributes.direction||(K.media.mediaType!=="video"||B||(C=K.attributes.payloads,x=K.attributes.extmaps,B=!0),K.media.mediaType!=="audio"||U||(w=K.attributes.payloads,A=K.attributes.extmaps,U=!0))}),!x||C.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!A||w.length===0)throw new Error("Cannot get audio capabilities from SDP.");if(C.forEach(K=>{var z;(z=K.rtpMap)!==null&&z!==void 0&&z.clockRate&&(K.rtpMap.clockRate=parseInt(K.rtpMap.clockRate)),b&&K.rtcpFeedbacks.push({type:"rrtr"})}),w.forEach(K=>{var z;(z=K.rtpMap)!==null&&z!==void 0&&z.clockRate&&(K.rtpMap.clockRate=parseInt(K.rtpMap.clockRate)),b&&K.rtcpFeedbacks.push({type:"rrtr"})}),u&&(w=w.filter(K=>{var z;return((z=K.rtpMap)===null||z===void 0?void 0:z.encodingName.toLowerCase())!=="rtx"}),C=C.filter(K=>{var z;return((z=K.rtpMap)===null||z===void 0?void 0:z.encodingName.toLowerCase())!=="rtx"})),h&&(C=C.filter(K=>{var z;return!/(red)|(ulpfec)|(flexfec)/i.test(((z=K.rtpMap)===null||z===void 0?void 0:z.encodingName)||"")})),p&&(w=w.filter(K=>{var z;return!/(red)|(ulpfec)|(flexfec)/i.test(((z=K.rtpMap)===null||z===void 0?void 0:z.encodingName)||"")})),g&&(g==null?void 0:g.length)>0&&(w=w.filter(K=>{var z;return Pe(g).call(g,((z=K.rtpMap)===null||z===void 0?void 0:z.encodingName.toLowerCase())||"")})),y&&(y==null?void 0:y.length)>0){const K=C.filter(z=>{var Q;return Pe(y).call(y,((Q=z.rtpMap)===null||Q===void 0?void 0:Q.encodingName.toLowerCase())||"")});C=K.concat(u?[]:dD(K,C))}const F=q("UNSUPPORTED_VIDEO_CODEC");return F&&F.length>0&&(C=C.filter(K=>!(K.rtpMap&&Pe(F).call(F,K.rtpMap.encodingName.toLowerCase())))),{audioCodecs:w,videoCodecs:C,audioExtensions:A,videoExtensions:x}}function vd(r){const o=ho(r);let s,c;for(const u of o.mediaDescriptions){if(!s){const h=u.attributes.iceUfrag,p=u.attributes.icePwd;if(!h||!p)throw new Error("Cannot get iceUfrag or icePwd from SDP.");s={iceUfrag:h,icePwd:p}}if(!c){const h=u.attributes.fingerprints;h.length>0&&(c={fingerprints:h})}}if(!c&&o.attributes.fingerprints.length>0&&(c={fingerprints:o.attributes.fingerprints}),!c||!s)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:s,dtlsParameters:c}}function Nz(r,o){const s=[],c=r.attributes.ssrcGroups.filter(p=>p.semantic==="FID"),u=r.attributes.ssrcGroups.find(p=>p.semantic==="SIM"),h=r.attributes.ssrcs;if(u)u.ssrcIds.forEach(p=>{var g;const y=(g=c.find(b=>b.ssrcIds[0]===p))===null||g===void 0?void 0:g.ssrcIds[1];s.push({ssrcId:p,rtx:o?y:void 0})});else if(c.length>0){const p=c[0].ssrcIds[0],g=c[0].ssrcIds[1];s.push({ssrcId:p,rtx:o?g:void 0})}else{if(h.length===0)throw new Error("No ssrcs found on local media description.");s.push({ssrcId:h[0].ssrcId})}return s}function Dz(r,o,s){const{cname:c}=r;let u=[];o&&(u=kz(o)),u.length===0&&(u=r.iceParameters.candidates.map(w=>({foundation:w.foundation,componentId:"1",transport:w.protocol,priority:w.priority.toString(),connectionAddress:w.ip,port:w.port.toString(),type:w.type,extension:{}})),L.debug("Using candidates from gateway."));const h={fingerprints:r.dtlsParameters.fingerprints.map(w=>({hashFunction:w.algorithm,fingerprint:w.fingerprint}))},p={iceUfrag:r.iceParameters.iceUfrag,icePwd:r.iceParameters.icePwd};let g;switch(r.dtlsParameters.role){case"server":g="passive";break;case"client":g="active";break;case"auto":g="actpass"}const y=fT(r.rtpCapabilities),b=[];return Array.isArray(s)&&s.length>0&&s.forEach(w=>{b.push({kind:je.VIDEO,ssrcId:w.v,rtx:w.v_rtx,mslabel:"".concat(w.v,"_").concat(w.a)},{kind:je.AUDIO,ssrcId:w.a,mslabel:"".concat(w.v,"_").concat(w.a)})}),{dtlsParameters:h,iceParameters:p,candidates:u,rtpCapabilities:y,setup:g,cname:c,preSSRCs:b}}function kz(r){let o=[];return r.ip&&typeof r.port=="number"&&(o=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:r.ip,port:r.port.toString(),type:"host",extension:{}}],L.debug("Using remote candidate from AP ".concat(r.ip,":").concat(r.port)),r.ip6&&(o.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:r.ip6,port:r.port.toString(),type:"host",extension:{}}),L.debug("Using IPV6 remote candidate from AP ".concat(r.ip6,":").concat(r.port)))),o}function mf(r,o,s){const c=[],u=[];return r.forEach(h=>{let{ssrcId:p,rtx:g}=h;const y=cn(8,"track-"),b={ssrcId:p,attributes:Pz({label:y,mslabel:s=s||cn(10,""),msid:"".concat(s," ").concat(y)},o&&{cname:o})};if(c.push(b),g!==void 0){const w={ssrcId:g,attributes:Pz({label:y,mslabel:s,msid:"".concat(s," ").concat(y)},o&&{cname:o})};c.push(w),u.push({semantic:"FID",ssrcIds:[p,g]})}}),r.length>1&&u.push({semantic:"SIM",ssrcIds:r.map(h=>{let{ssrcId:p}=h;return p})}),{ssrcs:c,ssrcGroups:u}}function Vm(r,o){o instanceof jn&&r.attributes.payloads.forEach(s=>{var c;const u=(c=s.rtpMap)===null||c===void 0?void 0:c.encodingName.toLowerCase();if(!u||["opus","pcmu","pcma","g722"].indexOf(u)===-1)return;s.fmtp||(s.fmtp={parameters:{}}),u==="opus"&&typeof q("OPUS_PTIME")=="number"?s.fmtp.parameters.ptime=q("OPUS_PTIME"):s.fmtp.parameters.minptime="10",s.fmtp.parameters.useinbandfec="1";const h=o._encoderConfig;h&&(u!=="pcmu"&&u!=="pcma"&&u!=="g722"&&(h.bitrate&&!xn()&&(s.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*h.bitrate))),h.sampleRate&&(s.fmtp.parameters.maxplaybackrate="".concat(h.sampleRate),s.fmtp.parameters["sprop-maxcapturerate"]="".concat(h.sampleRate)),h.stereo&&(s.fmtp.parameters.stereo="1",s.fmtp.parameters["sprop-stereo"]="1")),o instanceof p_&&u==="opus"&&o._config.DTX&&(s.fmtp.parameters.usedtx="1"))})}function lD(r){const o=r.attributes.unrecognized.findIndex(s=>s.attField==="x-google-flag"&&s.attValue==="conference");o!==-1&&r.attributes.unrecognized.splice(o,1)}function uD(r,o){var s;if(!(o instanceof pn&&o._encoderConfig&&o._hints.indexOf(Zt.SCREEN_TRACK)===-1))return;const c=o._encoderConfig;xt().supportMinBitrate&&c.bitrateMin&&r.attributes.payloads.forEach(u=>{var h,p;Pe(h=["h264","h265","vp8","vp9","av1"]).call(h,((p=u.rtpMap)===null||p===void 0?void 0:p.encodingName.toLowerCase())||"")&&(u.fmtp||(u.fmtp={parameters:{}}),u.fmtp.parameters["x-google-min-bitrate"]="".concat(c.bitrateMin))}),xt().supportMinBitrate&&!Pe(s=o._hints).call(s,Zt.LOW_STREAM)&&c.bitrateMax&&r.attributes.payloads.forEach(u=>{var h,p;Pe(h=["h264","h265","vp8","vp9","av1"]).call(h,((p=u.rtpMap)===null||p===void 0?void 0:p.encodingName.toLowerCase())||"")&&(u.fmtp||(u.fmtp={parameters:{}}),u.fmtp.parameters["x-google-start-bitrate"]="".concat(q("X_GOOGLE_START_BITRATE")||Math.floor(c.bitrateMax)))})}function Lz(r){if(r.media.mediaType!=="video")return;const o=It();if(o.name!==Mt.SAFARI&&o.os!==Rr.IOS)return;const s=r.attributes.extmaps.findIndex(c=>/video-orientation/g.test(c.extensionName));s!==-1&&r.attributes.extmaps.splice(s,1)}function hT(r,o,s){if(!o)return;let c,u;if(r.media.mediaType==="video"?(c=s.videoExtensions,u=s.videoCodecs):(c=s.audioExtensions,u=s.audioCodecs),o.twcc===!0){const h=c.find(p=>dT(p.extensionName));if(h){const p=h.extensionName;r.attributes.extmaps.find(y=>dT(y.extensionName))||r.attributes.extmaps.push({entry:h.entry,extensionName:p}),function(y,b){return b.filter(w=>!!y.find(C=>C.payloadType===w.payloadType&&!!C.rtcpFeedbacks.find(A=>A.type==="transport-cc")))}(u,r.attributes.payloads).forEach(y=>{y.rtcpFeedbacks.find(b=>b.type==="transport-cc")||y.rtcpFeedbacks.push({type:"transport-cc"})})}}else if(o.twcc===!1){const h=r.attributes.extmaps.findIndex(p=>dT(p.extensionName));h!==-1&&r.attributes.extmaps.splice(h,1),r.attributes.payloads.forEach(p=>{const g=p.rtcpFeedbacks.findIndex(y=>y.type==="transport-cc");g!==-1&&p.rtcpFeedbacks.splice(g,1)})}if(o.remb===!0){const h=c.find(p=>Iz(p.extensionName));if(h){const p=h.extensionName;r.attributes.extmaps.find(y=>y.extensionName===p)||r.attributes.extmaps.push({entry:h.entry,extensionName:p}),function(y,b){return b.filter(w=>!!y.find(C=>C.payloadType===w.payloadType&&!!C.rtcpFeedbacks.find(A=>A.type==="goog-remb")))}(u,r.attributes.payloads).forEach(y=>{y.rtcpFeedbacks.find(b=>b.type==="goog-remb")||y.rtcpFeedbacks.push({type:"goog-remb"})})}}else if(o.remb===!1){const h=r.attributes.extmaps.findIndex(p=>Iz(p.extensionName));h!==-1&&r.attributes.extmaps.splice(h,1),r.attributes.payloads.forEach(p=>{const g=p.rtcpFeedbacks.findIndex(y=>y.type==="goog-remb");g!==-1&&p.rtcpFeedbacks.splice(g,1)})}}function Mz(r,o,s){if(xn()||r.media.mediaType!=="video"||!(o instanceof pn)||s!=="vp9"&&s!=="vp8"||s==="vp8"&&!q("SIMULCAST")||s==="vp9"&&q("ENABLE_SVC")||o._scalabilityMode===void 0||o._scalabilityMode.numSpatialLayers<=1)return;const c=s==="vp8"?2:o._scalabilityMode.numSpatialLayers,u=r.attributes.ssrcs[0],h=r.attributes.ssrcGroups.find(g=>g.semantic==="FID"&&g.ssrcIds[0]===u.ssrcId),p={semantic:"SIM",ssrcIds:[u.ssrcId]};for(let g=1;g<c;g++)r.attributes.ssrcs.push({ssrcId:u.ssrcId+g,attributes:On(u.attributes)}),p.ssrcIds.push(u.ssrcId+g),h&&(r.attributes.ssrcs.push({ssrcId:h.ssrcIds[1]+g,attributes:On(u.attributes)}),r.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[u.ssrcId+g,h.ssrcIds[1]+g]}));r.attributes.ssrcGroups.unshift(p)}async function jz(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=new RTCPeerConnection;s.addTransceiver("video",{direction:"sendonly"}),s.addTransceiver("audio",{direction:"sendonly"}),s.addTransceiver("video",{direction:"recvonly"}),s.addTransceiver("audio",{direction:"recvonly"});const c=(await s.createOffer()).sdp,{send:u,recv:h,sendrecv:p}=function(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},b=arguments.length>2?arguments[2]:void 0;const w=b_(b,g,y,"sendonly"),C=b_(b,g,y,"recvonly"),A={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},x={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},B={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(_a(w,C,"videoExtensions",A,x,B),_a(w,C,"videoCodecs",A,x,B),_a(w,C,"audioExtensions",A,x,B),_a(w,C,"audioCodecs",A,x,B),q("RAISE_H264_BASELINE_PRIORITY")){const U=[],F=[];B.videoCodecs.forEach((K,z)=>{var Q;if(((Q=K.rtpMap)===null||Q===void 0?void 0:Q.encodingName.toLocaleLowerCase())==="h264"){var ie,oe;const re=B.videoCodecs[z+1],me=re&&$z(K,re),Ee=(ie=K.fmtp)===null||ie===void 0?void 0:ie.parameters["profile-level-id"],xe=(oe=K.fmtp)===null||oe===void 0?void 0:oe.parameters["packetization-mode"];!Ee||Ee!==q("FIRST_H264_PROFILE_LEVEL_ID")||q("FIRST_PACKETIZATION_MODE")&&xe!==q("FIRST_PACKETIZATION_MODE")?me?F.push([K,re]):F.push([K]):me?U.push([K,re]):U.push([K])}}),U.length>0&&F.length>0&&(L.debug("raising H264 baseline profile priority"),B.videoCodecs.forEach((K,z)=>{var Q;if(((Q=K.rtpMap)===null||Q===void 0?void 0:Q.encodingName.toLocaleLowerCase())==="h264"){const ie=$z(K,B.videoCodecs[z+1]),oe=U.shift()||F.shift()||[];oe.length>0&&(ie?B.videoCodecs.splice(z,2,...oe):B.videoCodecs.splice(z,1,...oe))}}),x.videoCodecs=x.videoCodecs.filter(K=>{var z,Q;return!(((z=K.rtpMap)===null||z===void 0?void 0:z.encodingName.toLocaleLowerCase())==="h264"&&((Q=K.fmtp)===null||Q===void 0?void 0:Q.parameters["profile-level-id"])!==q("FIRST_H264_PROFILE_LEVEL_ID"))}),q("FILTER_SEND_H264_BASELINE")&&(A.videoCodecs=A.videoCodecs.filter(K=>{var z,Q;return!(((z=K.rtpMap)===null||z===void 0?void 0:z.encodingName.toLocaleLowerCase())==="h264"&&((Q=K.fmtp)===null||Q===void 0?void 0:Q.parameters["profile-level-id"])!==q("FIRST_H264_PROFILE_LEVEL_ID"))})))}return{send:A,recv:x,sendrecv:B}}(r,o,c);try{s.close()}catch{}return{send:u,recv:h,sendrecv:p}}function Uz(){const r={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},o=b_(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"recvonly"),s={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},c={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},u={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(_a(r,o,"videoExtensions",s,c,u),_a(r,o,"videoCodecs",s,c,u),_a(r,o,"audioExtensions",s,c,u),_a(r,o,"audioCodecs",s,c,u),q("RAISE_H264_BASELINE_PRIORITY")){const h=u.videoCodecs.findIndex(p=>p.rtpMap&&p.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&p.fmtp&&p.fmtp.parameters["profile-level-id"]==="42001f");if(h!==-1){const p=u.videoCodecs.findIndex(g=>g.rtpMap&&g.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(p<h){L.debug("raising H264 baseline profile priority");const g=u.videoCodecs[h];u.videoCodecs.splice(h,1),u.videoCodecs.splice(p,0,g)}p!==-1&&(c.videoCodecs=c.videoCodecs.filter(g=>!(g.rtpMap&&g.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&g.fmtp&&g.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:s,recv:c,sendrecv:u}}function _a(r,o,s,c,u,h){if(s==="videoExtensions"||s==="audioExtensions"){const p=[];return r[s].forEach(g=>{o[s].some((y,b)=>{if(g.entry===y.entry&&g.extensionName===y.extensionName)return p.push(b),!0})?h[s].push(g):c[s].push(g)}),void o[s].forEach((g,y)=>{p.indexOf(y)===-1&&u[s].push(g)})}if(s==="videoCodecs"||s==="audioCodecs"){const p=[];return r[s].forEach(g=>{o[s].some((y,b)=>{if(g.payloadType===y.payloadType&&JSON.stringify(g)===JSON.stringify(y))return p.push(b),!0})?h[s].push(g):c[s].push(g)}),void o[s].forEach((g,y)=>{p.indexOf(y)===-1&&u[s].push(g)})}}function fT(r){const{send:o,recv:s,sendrecv:c}=r;if(!c){if(!o||!s)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:o,recv:s}}let u,h;return o?(u={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},u.audioCodecs=[...o.audioCodecs,...c.audioCodecs],u.videoCodecs=[...o.videoCodecs,...c.videoCodecs],u.audioExtensions=[...o.audioExtensions,...c.audioExtensions],u.videoExtensions=[...o.videoExtensions,...c.videoExtensions]):u=c,s?(h={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},h.audioCodecs=[...s.audioCodecs,...c.audioCodecs],h.videoCodecs=[...s.videoCodecs,...c.videoCodecs],h.audioExtensions=[...s.audioExtensions,...c.audioExtensions],h.videoExtensions=[...s.videoExtensions,...c.videoExtensions]):h=c,{send:u,recv:h}}function Fm(r){r.media.mediaType==="audio"&&r.attributes.payloads.filter(o=>{var s;return((s=o.rtpMap)===null||s===void 0?void 0:s.encodingName.toLowerCase())==="opus"}).forEach(o=>{o.fmtp||(o.fmtp={parameters:{}}),o.fmtp.parameters.stereo="1",o.fmtp.parameters["sprop-stereo"]="1"})}function S_(r,o,s,c){let u=[];if(r===je.VIDEO){if(q("H264_PROFILE_LEVEL_ID")&&c==="h264"&&(u=o.videoCodecs.filter(h=>{var p;return Pe(p=h.rtpMap&&h.rtpMap.encodingName.toLowerCase()||"").call(p,c)&&h&&h.fmtp&&h.fmtp.parameters["profile-level-id"]===q("H264_PROFILE_LEVEL_ID")})),!Array.isArray(u)||u.length===0){let h=[];const p=[],g=[],y=[];if(s.videoCodecs.forEach(b=>{const w=b.rtpMap&&b.rtpMap.encodingName.toLowerCase()||"";Pe(w).call(w,c)?h.push(b):Pe(w).call(w,"vp9")?p.push(b):Pe(w).call(w,"vp8")?g.push(b):Pe(w).call(w,"h264")&&y.push(b)}),h.length===0){let b="";p.length!==0?(h=p,b="vp9"):g.length!==0?(h=g,b="vp8"):y.length!==0&&(h=y,b="h264"),L.warning("codec ".concat(c," not included in rtpCapabilities, fallback to default payloads: ").concat(b))}h.length!==0&&(u=o.videoCodecs.filter(b=>h.some(w=>w.payloadType===b.payloadType)))}if(u.length===0&&(L.warning("codec ".concat(c," not included in rtpCapabilities, fallback to default payloads: ").concat(o.videoCodecs[0].rtpMap&&o.videoCodecs[0].rtpMap.encodingName)),u=o.videoCodecs),q("USE_PUB_RTX")||q("USE_SUB_RTX")){const h=dD(u,o.videoCodecs);u=[...u,...h]}}else{u=o.audioCodecs.filter(p=>{var g;return Pe(g=p.rtpMap&&p.rtpMap.encodingName.toLowerCase()||"").call(g,c)});const h=o.audioCodecs.filter(p=>{var g;return Pe(g=p.rtpMap&&p.rtpMap.encodingName.toLowerCase()||"").call(g,"red")});u.length===0&&(L.warning("codec ".concat(c," not included in rtpCapabilities, fallback to opus")),u=o.audioCodecs.filter(p=>{var g;return Pe(g=p.rtpMap&&p.rtpMap.encodingName.toLowerCase()||"").call(g,"opus")})),q("ENABLE_AUDIO_RED")&&h.length!==0&&(u=[...h,...u])}return u}function dD(r,o){const s=r.map(c=>c.payloadType.toString());return o.filter(c=>c.rtpMap&&c.rtpMap.encodingName==="rtx"&&c.fmtp&&c.fmtp.parameters.apt&&Pe(s).call(s,c.fmtp&&c.fmtp.parameters.apt))}async function w_(r,o,s){const c=o.toString(),u=Fz(c,"offer","remote","exchangeSDP");await r.setRemoteDescription({type:"offer",sdp:c});const h=await r.createAnswer();if(!h.sdp)throw new Error("cannot get answer sdp");let p=h.sdp;p=Vz(p,s||{}),u==null||u(p||""),await r.setLocalDescription({type:"answer",sdp:p})}function Vz(r,o,s){const c=ho(r),{useXR:u}=o;return c.mediaDescriptions.forEach(h=>{var p;h.attributes.mid&&(Array.isArray(s)&&!Pe(s).call(s,h.attributes.mid)||(h.media.mediaType==="audio"&&Fm(h),u&&Pe(p=["audio","video"]).call(p,h.media.mediaType)&&h.attributes.payloads.forEach(g=>{g.rtcpFeedbacks.findIndex(y=>y.type==="rrtr")===-1&&g.rtcpFeedbacks.push({type:"rrtr"})})))}),hd(c)}function Fz(r,o,s,c){if(q("SDP_LOGGING"))return L.upload("exchanging ".concat(s," ").concat(o," SDP during P2PConnection.").concat(c,`
`),r),o==="offer"?u=>{Fz(u,"answer",s==="local"?"remote":"local",c)}:void 0}function Bz(r){const o=q("COMPATIBLE_SDP_EXTENSION");return!!(Array.isArray(o)&&o.length>0)&&o.some(s=>Pe(r).call(r,s))}function $z(r,o){try{var s;return((s=r.fmtp)===null||s===void 0?void 0:s.parameters.apt)===o.payloadType.toString()}catch{return!1}}function Wz(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function Lo(r,o){return typeof q(r)===o?q(r):void 0}function Exe(){try{const r=q("EXPERIMENTS")||{};return typeof r=="string"||Array.isArray(r)?{}:function(o){for(var s=1;s<arguments.length;s++){var c=arguments[s]!=null?arguments[s]:{};s%2?Wz(Object(c),!0).forEach(function(u){G(o,u,c[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(c)):Wz(Object(c)).forEach(function(u){Object.defineProperty(o,u,Object.getOwnPropertyDescriptor(c,u))})}return o}({},r)}catch(r){return L.debug("handle gateway attributes failed: ",r),{}}}const Gz={};function yd(r){(!(arguments.length>1&&arguments[1]!==void 0)||arguments[1])&&L.debug("install service ".concat(r.name)),Gz[r.name]=r}function Xl(r){const o=Gz[r];if(!o)throw new ve(Y.INVALID_OPERATION,"".concat(r," not found, please use AgoraRTC.use(").concat(r,"Service) to load it first"));return o}function Hz(r,o){return Xl("DataStream").create(r,o)}function pT(){return Xl("InterceptFrame").create()}function Kz(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function Zc(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?Kz(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):Kz(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}const hD=new Map;class bxe extends An{get state(){return this._state}set state(o){if(o===this._state)return;const s=this._state;this._state=o,o==="DISCONNECTED"&&this._disconnectedReason?this.emit(jr.CONNECTION_STATE_CHANGE,o,s,this._disconnectedReason):this.emit(jr.CONNECTION_STATE_CHANGE,o,s)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(o){L.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(o)),this._joinGatewayStartTime=o}constructor(o,s){var c,u,h;super(),G(this,"store",void 0),G(this,"joinInfo",void 0),G(this,"key",void 0),G(this,"ntpOffset",0),G(this,"signal",void 0),G(this,"role",void 0),G(this,"inChannelInfo",{joinAt:null,duration:0}),G(this,"spec",void 0),G(this,"_state","DISCONNECTED"),G(this,"_statsCollector",void 0),G(this,"_disconnectedReason",void 0),G(this,"isSignalRecover",!1),G(this,"hasChangeBGPAddress",!1),G(this,"trafficStatsInterval",void 0),G(this,"networkQualityInterval",void 0),G(this,"_joinGatewayStartTime",0),G(this,"_signalTimeout",!1),G(this,"_clientRoleOptions",void 0),G(this,"_isProactiveJoin",!1),this.store=o,this.spec=s,this.signal=this.store.useP2P?(c={spec:Zc(Zc({},s),{},{retryConfig:s.websocketRetryConfig}),store:o},(u=(h=Xl("P2PChannel")).createSubmodule)===null||u===void 0?void 0:u.call(h,c)):new yxe(Zc(Zc({},s),{},{retryConfig:s.websocketRetryConfig}),o),this._statsCollector=s.statsCollector,this.role=s.role||"audience",this._clientRoleOptions=s.clientRoleOptions,this.handleSignalEvents()}async join(o,s,c){this.store.joinGatewayStart(),o.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const u=Date.now();let h=hD.get(o.cname);if(h||(h=new Map,hD.set(o.cname,h)),this._isProactiveJoin=!0,h.has(o.uid)){const b=new pe(Y.UID_CONFLICT);throw We.joinGateway(o.sid,{lts:u,succ:!1,ec:b.code,addr:null,uid:o.uid,cid:o.cid,firstSuccess:this._isProactiveJoin,isProxy:!!o.proxyServer,signalChannel:"0",preload:o.preload}),b}h.set(o.uid,!0),this.joinInfo=o,this.key=s;let p=0;this.joinGatewayStartTime=u;const g=o.proxyServer;try{L.debug("[".concat(this.store.clientId,"] use websocket join uid ").concat(p));const b=o.gatewayAddrs.map(w=>{let{address:C}=w;const[A,x]=C.split(":"),B={host:A,port:x};return o.proxyServer&&(B.proxy=o.proxyServer),B});p=(await this.signal.init(b)).uid,L.debug("[".concat(this.store.clientId,"] websocket join uid ").concat(p," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(b){var y;throw L.error("[".concat(this.store.clientId,"] User join failed"),b.toString()),We.joinGateway(o.sid,{lts:u,succ:!1,ec:((y=b.data)===null||y===void 0?void 0:y.desc)||b.code,errorMsg:b.message,addr:this.signal.url,uid:o.uid,cid:o.cid,firstSuccess:this._isProactiveJoin,isProxy:!!g,signalChannel:"0",preload:o.preload}),h.delete(o.uid),this.signal.close(),b}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),L.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(b=>{L.warning("[".concat(this.store.clientId,"] get traffic stats error"),b.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(jr.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(jr.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(jr.NETWORK_QUALITY,{uplinkNetworkQuality:Rz(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:Rz(this._statsCollector.trafficStats.B_dnq)}):this.emit(jr.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),p}async leave(){let o=arguments.length>0&&arguments[0]!==void 0&&arguments[0],s=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){s!==Bt.FALLBACK&&(this.state="DISCONNECTING");try{o||this.signal.connectionState!==dn.CONNECTED||await function(c,u){return u===1/0?c:De.race([c,HOe(u)])}(this.signal.request(tt.LEAVE,void 0,!0),3e3)}catch(c){L.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),c)}this.signal.close(s),s!==Bt.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(o,s,c){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const u={state:"offer",p2p_id:this.store.p2pId,ortc:s,mode:this.spec.mode,extend:q("PUB_EXTEND"),twcc:!!q("PUBLISH_TWCC"),rtx:!!q("USE_PUB_RTX")};try{return(await this.signal.request(tt.PUBLISH,u,!0))._message}catch(h){if(c&&h.data&&h.data.code===Xe.ERR_PUBLISH_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),h.toString()),await this.tryUnpubBeforeRepub(o,s),this.publish(o,s,!1);throw h}}async publishDataChannel(o,s,c){var u;if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const h={stream_id:s.streamId,ordered:s.ordered?1:0,max_retrans_times:(u=s.maxRetransmits)!==null&&u!==void 0?u:10,channel_id:s.channelId,metadata:s.metadata};try{await this.signal.request(tt.PUBLISH_DATASTREAM,h,!0)}catch(p){if(c&&p.data&&p.data.code===Xe.ERR_PUBLISH_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),p.toString()),await this.tryUnpubDataChannelBeforeRepub(o,s),this.publishDataChannel(o,s,!1);throw p}}async unpublish(o,s){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(tt.UNPUBLISH,{stream_id:s,ortc:o},!0)}catch(c){L.warning("[".concat(this.store.clientId,"] unpublish warning: "),c)}}async unpublishDataChannel(o){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await De.all(o.map(s=>this.signal.request(tt.UNPUBLISH_DATASTREAM,{channel_id:s},!0)))}catch(s){L.warning("unpublish datachannels warning: ",s)}}async presubscribe(o,s,c){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const u={stream_id:o,stream_type:s,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!q("SUBSCRIBE_TWCC"),rtx:!!q("USE_SUB_RTX")||void 0,extend:q("SUB_EXTEND"),svc:Array.isArray(q("SVC"))&&q("SVC").length!==0?q("SVC"):void 0};try{return await this.signal.request(tt.PRE_SUBSCRIBE,u,!0)}catch(h){if(c&&h.data&&h.data.code===Xe.ERR_SUBSCRIBE_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),h.toString()),this.presubscribe(o,s,!1);throw h}}async subscribe(o,s,c){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const u={stream_id:o,stream_type:s.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!q("SUBSCRIBE_TWCC"),rtx:!!q("USE_SUB_RTX"),extend:q("SUB_EXTEND"),ssrcId:s.ssrcId,svc:Array.isArray(q("SVC"))&&q("SVC").length!==0?q("SVC"):void 0};try{return(await this.signal.request(tt.SUBSCRIBE,u,!0))._message}catch(h){if(c&&h.data&&h.data.code===Xe.ERR_SUBSCRIBE_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),h.toString()),await this.tryUnsubBeforeResub(o,s),await this.subscribe(o,s,!1);throw h}}async subscribeDataChannel(o,s,c){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const u={uid:o,stream_id:s.id,channel_id:s.datachannelId};try{return void await this.signal.request(tt.SUBSCRIBE_DATASTREAM,u,!0)}catch(h){if(c&&h.data&&h.data.code===Xe.ERR_SUBSCRIBE_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),h.toString()),await this.tryUnsubDataChannelBeforeResub(o,s),await this.subscribeDataChannel(o,s,!1);throw h}}async subscribeAll(o,s){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const c={p2p_id:this.store.p2pId,users:o,dtx:!1,rtx:!!q("USE_SUB_RTX"),twcc:!!q("SUBSCRIBE_TWCC"),svc:Array.isArray(q("SVC"))&&q("SVC").length!==0?q("SVC"):void 0};try{return await this.signal.request(tt.SUBSCRIBE_STREAMS,c,!0)}catch(u){if(s&&u.data&&u.data.code===Xe.ERR_SUBSCRIBE_REQUEST_INVALID)return L.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),u.toString()),await this.tryMassUnsubBeforeResub(o),await this.subscribeAll(o,!1);throw u}}async setVideoProfile(o){const s=function(c){if(!(c.bitrateMax&&c.bitrateMin&&c.frameRate&&c.height&&c.width))return;let u=c.frameRate,h=c.width,p=c.height,g=!0;return typeof u!="number"&&(u=u.exact||u.ideal||u.max||u.min||0,u||(g=!1)),typeof h!="number"&&(h=h.exact||h.ideal||h.max||h.min||0,h||(g=!1)),typeof p!="number"&&(p=p.exact||p.ideal||p.max||p.min||0,u||(g=!1)),g?{stream_type:0,width:h,height:p,fps:u,start_bps:1e3*c.bitrateMax,min_bps:1e3*c.bitrateMin,target_bps:1e3*c.bitrateMax}:void 0}(o);if(s)return this.signal.request(tt.SET_VIDEO_PROFILE,s);L.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(o,s){try{await this.signal.request(tt.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:o,stream_id:s},!0)}catch(c){L.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),c)}}async unsubscribeDataChannel(o,s){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await De.all(o.map(c=>this.signal.request(tt.UNSUBSCRIBE_DATASTREAM,{stream_id:c,uid:s},!0)))}catch(c){L.warning("unsubscribeDataChannel warning: ",c)}}async massUnsubscribe(o){try{await this.signal.request(tt.UNSUBSCRIBE_STREAMS,o,!0)}catch(s){L.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),s)}}async reconnectPC(o){const{iceParameters:s,dtlsParameters:c,rtpCapabilities:u}=o;return{gatewayEstablishParams:await this.signal.request(tt.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:s,dtlsParameters:c,rtpCapabilities:u}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(tt.GATEWAY_INFO)}async renewToken(o){await this.signal.request(tt.RENEW_TOKEN,o),this.key=o.token}updateClientRole(o,s){s&&(this._clientRoleOptions=Object.assign({},s)),q("CLIENT_ROLE_OPTIONS")&&(L.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(q("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," ")),this._clientRoleOptions=Object.assign({},q("CLIENT_ROLE_OPTIONS"))),this.role=o}async setClientRole(o,s){if(s&&(this._clientRoleOptions=Object.assign({},s)),q("CLIENT_ROLE_OPTIONS")&&(this._clientRoleOptions=Object.assign({},q("CLIENT_ROLE_OPTIONS")),L.debug("[".concat(this.store.clientId,"] Set roleOptions for ").concat(JSON.stringify(q("CLIENT_ROLE_OPTIONS"))," instead of ").concat(JSON.stringify(this._clientRoleOptions)," "))),this.state!=="CONNECTED")return void(this.role=o);let c,u=0;o==="audience"?this._clientRoleOptions&&this._clientRoleOptions.delay?(c=this._clientRoleOptions.delay,u=1):u=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:u=0,await this.signal.request(tt.SET_CLIENT_ROLE,{role:o,level:u,delay:c,client_ts:Date.now()}),this.role=o}async setRemoteVideoStreamType(o,s){await this.signal.request(tt.SWITCH_VIDEO_STREAM,{stream_id:o,stream_type:s})}async setDefaultRemoteVideoStreamType(o){await this.signal.request(tt.DEFAULT_VIDEO_STREAM,{stream_type:o})}async setStreamFallbackOption(o,s){await this.signal.request(tt.SET_FALLBACK_OPTION,{stream_id:o,fallback_type:s})}async pickSVCLayer(o,s){await this.signal.request(tt.PICK_SVC_LAYER,{stream_id:o,spatial_layer:s.spatialLayer,temporal_layer:s.temporalLayer})}async setRTM2Flag(o){await this.signal.request(tt.SET_RTM2_FLAG,{rtm2_flag:o})}async sendExtensionMessage(o,s,c){if(this.store.useP2P)return this.signal.sendExtensionMessage(o,s,c)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),Zc({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(tt.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const o=hD.get(this.joinInfo.cname);o&&o.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const o=function(s){let c;return c=s.startsWith("dc")?s.match(/(dc\:\/\/)?([^:]+):(\d+)/):s.match(/(wss\:\/\/)?([^:]+):(\d+)/),c?{username:si.username,password:si.password,turnServerURL:c[2],tcpport:parseInt(c[3])+30,udpport:parseInt(c[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],o&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(Zc(Zc({},si),{},{turnServerURL:o.turnServerURL,tcpport:o.tcpport,udpport:o.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const o=await this.signal.request(tt.TRAFFIC_STATS,void 0,!0);o.timestamp=Date.now(),o.ntp_offset!=null&&(this.ntpOffset=o.ntp_offset),o.peer_delay.forEach(s=>{const c=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(u=>u.peer_uid===s.peer_uid);c&&c.B_st!==s.B_st&&Lw(()=>{this.emit(jr.STREAM_TYPE_CHANGE,s.peer_uid,s.B_st)})}),this._statsCollector.updateTrafficStats(o)}getJoinMessage(o){var s;if(!this.joinInfo||!this.key)throw new pe(Y.UNEXPECTED_ERROR,"can not generate join message, no join info");const c=Object.assign({},this.joinInfo.apResponse);let u=q("REPORT_APP_SCENARIO");if(typeof u!="string")try{u=JSON.stringify(u)}catch{u=void 0}var h;u&&u.length>128&&(u=void 0),this.store.hasStartJoinChannel=!0,this.store.isABTestSuccess||this.emit(jr.UPDATE_GATEWAY_CONFIG),h=this.store.clientId,Pe(Dm).call(Dm,h)||Dm.push(h);const p=!(xn()||l8(87)||Q8())&&typeof q("ENABLE_PRE_SUB")=="boolean"&&q("ENABLE_PRE_SUB"),g=!Q8()&&Lo("ENABLE_PREALLOC_PC","boolean"),y=Exe(),b=r_(87)||function(){const C=It();if(C.name!==Mt.SAFARI||!C.browserVersion)return!1;const A=C.browserVersion.split(".");return Number(A[0])>15||Number(A[0])===15&&Number(A[1])>=4}(),w=Zc({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:xs,browser:navigator.userAgent,process_id:q("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:c,extend:q("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:u,attributes:{userAttributes:Zc(Zc({enableEncodedTransform:!!q("ENABLE_AUDIO_METADATA")&&b||!!q("ENABLE_AUDIO_TOPN")&&r1(Mt.CHROME,87,116)||void 0,enableAudioMetadata:!!q("ENABLE_AUDIO_METADATA")&&b,enableAudioPts:!!q("ENABLE_AUDIO_PTS_METADATA")&&b,topnSmoothLevel:q("TOPN_SMOOTH_LEVEL"),topnNewSpeakerDelay:q("TOPN_NEW_SPEAKER_DELAY"),topnSwitchHoldMs:q("TOPN_SWITCH_HOLD_MS"),topnAudioGain:q("TOPN_AUDIO_GAIN"),enablePublishedUserList:q("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:q("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:Lo("SUBSCRIBE_AUDIO_FILTER_TOPN","number"),enablePublishAudioFilter:Lo("ENABLE_PUBLISH_AUDIO_FILTER","boolean"),enableUserLicenseCheck:Lo("ENABLE_USER_LICENSE_CHECK","boolean"),enableRTX:q("USE_PUB_RTX")===!0||q("USE_SUB_RTX")===!0||void 0,disableFEC:q("DISABLE_FEC"),enableNTPReport:!!q("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!q("ENABLE_INSTANT_VIDEO")||void 0,enableFulllinkAvSync:!!q("ENABLE_FULL_LINK_AV_SYNC")||void 0,enableDataStream2:Lo("ENABLE_DATASTREAM_2","boolean"),enableAutFeedback:!!q("ENABLE_AUT_FEEDBACK")||void 0,rtm2Flag:typeof this.joinInfo.rtmFlag=="number"?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!q("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:Lo("USE_XR","boolean"),enableLossbasedBwe:Lo("ENABLE_LOSSBASED_BWE","boolean"),enableAutCC:!!q("ENABLE_AUT_CC")||void 0,enableCCFallback:Lo("ENABLE_CC_FALLBACK","boolean"),enablePreallocPC:g,preSubNum:p?Lo("PRE_SUB_NUM","number"):void 0,enablePubTWCC:Lo("PUBLISH_TWCC","boolean"),enableSubTWCC:Lo("SUBSCRIBE_TWCC","boolean"),enablePubRTX:Lo("USE_PUB_RTX","boolean"),enableSubRTX:Lo("USE_SUB_RTX","boolean"),enableSubSVC:q("ENABLE_SVC")?q("ENABLE_SVC_DEFAULT_CODECS"):Array.isArray(q("SVC"))&&q("SVC").length!==0?q("SVC"):void 0,enableSvcExtended:q("ENABLE_SVC")&&Array.isArray(q("SVC_EXTENDED"))&&q("SVC_EXTENDED").length!==0?q("SVC_EXTENDED"):void 0},y),{},{audioDuplicate:Lo("ENABLE_AUDIO_RED","boolean")?(s=Lo("AUDIO_DUPLICATE_NUM","number"))!==null&&s!==void 0?s:2:void 0})},join_ts:this.joinGatewayStartTime},o);return this.joinInfo.stringUid&&(w.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(w.aes_mode=this.joinInfo.aesmode,q("ENCRYPT_AES")?(w.aes_secret=this.joinInfo.aespassword,w.aes_encrypt=!0):w.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(w.aes_salt=this.joinInfo.aessalt)),c.addresses[this.signal.websocket.currentURLIndex]&&(w.ap_response.ticket=c.addresses[this.signal.websocket.currentURLIndex].ticket,delete c.addresses),this.joinInfo.defaultVideoStream!==void 0&&(w.default_video_stream=this.joinInfo.defaultVideoStream),w}getRejoinMessage(){if(!this.joinInfo)throw new pe(Y.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(it.WS_RECONNECT_CREATE_CONNECTION,o=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(it.WS_RECONNECTING,o=>{this.joinInfo&&We.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:o||ii.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",We.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:this.spec.mode==="live"?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:this.role==="audience"?2:1,buildFormat:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(it.WS_CLOSED,o=>{let s;switch(o){case Bt.LEAVE:s=ii.LEAVE;break;case Bt.UID_BANNED:case Bt.IP_BANNED:case Bt.CHANNEL_BANNED:case Bt.SERVER_ERROR:s=ii.SERVER_ERROR;break;case Bt.FALLBACK:s=ii.FALLBACK;break;case Bt.LICENSE_MISSING:case Bt.LICENSE_EXPIRED:case Bt.LICENSE_MINUTES_EXCEEDED:case Bt.LICENSE_PERIOD_INVALID:case Bt.LICENSE_MULTIPLE_SDK_SERVICE:case Bt.LICENSE_ILLEGAL:case Bt.TOKEN_EXPIRE:s=o;break;default:s=ii.NETWORK_ERROR}L.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(s||"undefined -> "+ii.NETWORK_ERROR)),this.joinInfo&&We.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:o===Bt.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:s}),this._disconnectedReason=o,o!==Bt.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(it.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo){if(this.role==="audience"){const o=q("CLIENT_ROLE_OPTIONS")||this._clientRoleOptions;o&&(o.level||o.delay)&&(L.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(o.level,", delay: ").concat(o.delay)),this.setClientRole(this.role,o))}if(We.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload,isABTestSuccess:this.store.isABTestSuccess}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1){const o=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!o)return void L.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(o));Yt("EVENT_REPORT_DOMAIN",o[1]),Yt("EVENT_REPORT_BACKUP_DOMAIN",o[1]),Yt("LOG_UPLOAD_SERVER","".concat(o[1],":6444"))}}}),this.signal.on(bt.ON_UPLINK_STATS,o=>{this._statsCollector.updateUplinkStats(o)}),this.signal.on(it.REQUEST_RECOVER,(o,s,c)=>{if(!this.joinInfo)return c(new pe(Y.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));o&&(this.joinInfo.multiIP=o,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,oi(this,jr.REQUEST_NEW_GATEWAY_LIST).then(s).catch(c)}),this.signal.on(it.REQUEST_JOIN_INFO,async(o,s,c)=>{var u;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void o(this.getJoinMessage({ortc:{}}));const h=On((u=this.joinInfo)===null||u===void 0?void 0:u.turnServer);if(q("NEW_TURN_MODE")&&h){let b=h.servers,w=h.serversFromGateway;const C=this.signal.currentURLIndex;b.length>0&&(b=[b[C%b.length]],h.servers=b),Array.isArray(w)&&w.length>0&&(w=[w[0]],h.serversFromGateway=w),L.debug("[".concat(this.store.clientId,"] use single turn, use turn server index: ").concat(C))}const{iceParameters:p,dtlsParameters:g,rtpCapabilities:y}=await oi(this,jr.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:h});try{o(this.getJoinMessage({ortc:{iceParameters:p,dtlsParameters:g,rtpCapabilities:y,version:"2"}}))}catch(b){s(b)}}),this.signal.on(it.REQUEST_REJOIN_INFO,o=>{o(this.getRejoinMessage())}),this.signal.on(it.REPORT_JOIN_GATEWAY,(o,s)=>{if(!this.joinInfo)return;let c,u="";var h;o instanceof pe?(c=((h=o.data)===null||h===void 0?void 0:h.desc)||o.code,u=o.message):c=o,We.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:c,errorMsg:u,addr:s,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,isProxy:!!this.joinInfo.proxyServer,signalChannel:"0",preload:this.joinInfo.preload})}),this.signal.on(it.IS_P2P_DISCONNECTED,o=>{o(c_(this,jr.IS_P2P_DISCONNECTED))}),this.signal.on(it.DISCONNECT_P2P,()=>{this.emit(jr.DISCONNECT_P2P)}),this.signal.on(it.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(it.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(it.JOIN_RESPONSE,o=>{const s=this.getCurrentGatewayAddress();this.emit(jr.JOIN_RESPONSE,o,s)}),this.signal.on(it.PRE_CONNECT_PC,async()=>{if(this.joinInfo){this.updateTurnConfigFromSignal();const o=this.getCurrentGatewayAddress(),s=q("FINGERPRINT")||this.joinInfo.apResponse.addresses[this.signal.currentURLIndex].fingerprint;if(o&&s){const c=kz(o);this.emit(jr.PRE_CONNECT_PC,{candidates:c,fingerprint:s})}}}),this.signal.on(it.RECOVER_NOTIFICATION,o=>{this.joinInfo&&typeof q("AP_REQUEST_DETAIL")=="string"&&(this.joinInfo.apRequestDetail="".concat(q("AP_REQUEST_DETAIL"),";").concat(o))})}async tryUnsubBeforeResub(o,s){try{await this.signal.request(tt.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:o,ortc:[s]},!0)}catch(c){throw L.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),c),c}}async tryUnsubDataChannelBeforeResub(o,s){try{await this.signal.request(tt.UNSUBSCRIBE,{stream_id:s.id},!0)}catch(c){throw L.warning("unsubscribe datachannel warning",c),c}}async tryUnpubBeforeRepub(o,s){try{await this.signal.request(tt.UNPUBLISH,{stream_id:o,ortc:s},!0)}catch(c){throw L.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),c),c}}async tryUnpubDataChannelBeforeRepub(o,s){try{await this.signal.request(tt.UNPUBLISH_DATASTREAM,{channnel_id:s.channelId},!0)}catch(c){throw L.warning("unpublish datastream warning: ",c),c}}async tryMassUnsubBeforeResub(o){const s={users:o.map(c=>({stream_id:c.stream_id,stream_type:c.stream_type}))};try{await this.signal.request(tt.UNSUBSCRIBE_STREAMS,s,!0)}catch(c){throw L.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),c),c}}async muteLocal(o,s){const c={action:o.find(u=>u.stream_type===Ht.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:o,stream_id:s};try{await this.signal.request(tt.CONTROL,c,!0,!0)}catch(u){throw L.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),u),u}}async unmuteLocal(o,s){const c={action:o.find(u=>u.stream_type===Ht.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:o,stream_id:s};try{await this.signal.request(tt.CONTROL,c,!0,!0)}catch(u){throw L.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),u),u}}async muteRemote(o,s){const c={action:o===je.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:s};try{await this.signal.request(tt.CONTROL,c,!0,!0)}catch(u){throw L.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),u),u}}async unmuteRemote(o,s){const c={action:o===je.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:s};try{await this.signal.request(tt.CONTROL,c,!0,!0)}catch(u){throw L.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),u),u}}uploadWRTCStats(o){this.signal.uploadWRTCStats(o)}upload(o,s){this.signal.upload(o,s)}getSignalRTT(){return this.signal.rtt}async restartICE(o){const s={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:o};try{return await this.signal.request(tt.RESTART_ICE,s,!0)}catch(c){throw L.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),c),c}}reconnect(o,s){this.state==="CONNECTED"&&this.signal.reconnect(o||void 0,s||ii.P2P_FAILED)}getCurrentGatewayAddress(){var o,s;if(!q("GATEWAY_WSS_ADDRESS"))return q("USE_CANDIDATE_FROM_AP_DETAIL")&&(o=this.joinInfo)!==null&&o!==void 0&&o.apGatewayAddress?(L.debug("[".concat(this.store.clientId,"] use candidate from ap detail, ").concat(JSON.stringify(this.joinInfo.apGatewayAddress))),this.joinInfo.apGatewayAddress):(s=this.joinInfo)!==null&&s!==void 0&&s.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(o){await this.signal.request(tt.SET_PARAMETER,{enablePublishAudioFilter:o})}}let mT=0,fD=0;function ac(r,o,s,c){return new De((u,h)=>{o.timeout=o.timeout||q("HTTP_CONNECT_TIMEOUT"),o.responseType=o.responseType||"json",o.data&&!s?(o.data=JSON.stringify(o.data),mT+=zc(o.data)):s&&(o.data.size?mT+=o.data.size:o.data instanceof FormData?mT+=A8(o.data):mT+=zc(JSON.stringify(o.data))),o.headers=o.headers||{},o.headers["Content-Type"]=o.headers["Content-Type"]||"application/json",o.method="POST",o.url=r,Qi.request(o).then(p=>{typeof p.data=="string"?fD+=zc(p.data):p.data instanceof ArrayBuffer||p.data instanceof Uint8Array?fD+=p.data.byteLength:fD+=zc(JSON.stringify(p.data)),c&&u({data:p.data,headers:p.headers}),u(p.data)}).catch(p=>{Qi.isCancel(p)?h(new pe(Y.OPERATION_ABORTED,"cancel token canceled")):p.code==="ECONNABORTED"?h(new pe(Y.NETWORK_TIMEOUT,p.message)):p.response?h(new pe(Y.NETWORK_RESPONSE_ERROR,p.response.status)):h(new pe(Y.NETWORK_ERROR,p.message))})})}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */(function(){var r;function o(be){var Oe=0;return function(){return Oe<be.length?{done:!1,value:be[Oe++]}:{done:!0}}}var s=typeof Object.defineProperties=="function"?Object.defineProperty:function(be,Oe,Ve){return be==Array.prototype||be==Object.prototype||(be[Oe]=Ve.value),be},c,u=function(be){be=[typeof globalThis=="object"&&globalThis,be,typeof window=="object"&&window,typeof self=="object"&&self,typeof i=="object"&&i];for(var Oe=0;Oe<be.length;++Oe){var Ve=be[Oe];if(Ve&&Ve.Math==Math)return Ve}throw Error("Cannot find global object")}(this);function h(be,Oe){if(Oe)e:{var Ve=u;be=be.split(".");for(var Se=0;Se<be.length-1;Se++){var j=be[Se];if(!(j in Ve))break e;Ve=Ve[j]}(Oe=Oe(Se=Ve[be=be[be.length-1]]))!=Se&&Oe!=null&&s(Ve,be,{configurable:!0,writable:!0,value:Oe})}}function p(be){return(be={next:be})[Symbol.iterator]=function(){return this},be}function g(be){var Oe=typeof Symbol<"u"&&Symbol.iterator&&be[Symbol.iterator];return Oe?Oe.call(be):{next:o(be)}}if(h("Symbol",function(be){function Oe(j,X){this.A=j,s(this,"description",{configurable:!0,writable:!0,value:X})}if(be)return be;Oe.prototype.toString=function(){return this.A};var Ve="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",Se=0;return function j(X){if(this instanceof j)throw new TypeError("Symbol is not a constructor");return new Oe(Ve+(X||"")+"_"+Se++,X)}}),h("Symbol.iterator",function(be){if(be)return be;be=Symbol("Symbol.iterator");for(var Oe="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Ve=0;Ve<Oe.length;Ve++){var Se=u[Oe[Ve]];typeof Se=="function"&&typeof Se.prototype[be]!="function"&&s(Se.prototype,be,{configurable:!0,writable:!0,value:function(){return p(o(this))}})}return be}),typeof Object.setPrototypeOf=="function")c=Object.setPrototypeOf;else{var y;e:{var b={};try{b.__proto__={a:!0},y=b.a;break e}catch{}y=!1}c=y?function(be,Oe){if(be.__proto__=Oe,be.__proto__!==Oe)throw new TypeError(be+" is not extensible");return be}:null}var w=c;function C(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function A(be){if(be.m)throw new TypeError("Generator is already running");be.m=!0}function x(be,Oe){return be.h=3,{value:Oe}}function B(be){this.g=new C,this.G=be}function U(be,Oe,Ve,Se){try{var j=Oe.call(be.g.j,Ve);if(!(j instanceof Object))throw new TypeError("Iterator result "+j+" is not an object");if(!j.done)return be.g.m=!1,j;var X=j.value}catch(Z){return be.g.j=null,be.g.s(Z),F(be)}return be.g.j=null,Se.call(be.g,X),F(be)}function F(be){for(;be.g.h;)try{var Oe=be.G(be.g);if(Oe)return be.g.m=!1,{value:Oe.value,done:!1}}catch(Ve){be.g.v=void 0,be.g.s(Ve)}if(be.g.m=!1,be.g.l){if(Oe=be.g.l,be.g.l=null,Oe.F)throw Oe.D;return{value:Oe.return,done:!0}}return{value:void 0,done:!0}}function K(be){this.next=function(Oe){return be.o(Oe)},this.throw=function(Oe){return be.s(Oe)},this.return=function(Oe){return function(Ve,Se){A(Ve.g);var j=Ve.g.j;return j?U(Ve,"return"in j?j.return:function(X){return{value:X,done:!0}},Se,Ve.g.return):(Ve.g.return(Se),F(Ve))}(be,Oe)},this[Symbol.iterator]=function(){return this}}function z(be,Oe){return Oe=new K(new B(Oe)),w&&be.prototype&&w(Oe,be.prototype),Oe}if(C.prototype.o=function(be){this.v=be},C.prototype.s=function(be){this.l={D:be,F:!0},this.h=this.C||this.u},C.prototype.return=function(be){this.l={return:be},this.h=this.u},B.prototype.o=function(be){return A(this.g),this.g.j?U(this,this.g.j.next,be,this.g.o):(this.g.o(be),F(this))},B.prototype.s=function(be){return A(this.g),this.g.j?U(this,this.g.j.throw,be,this.g.o):(this.g.s(be),F(this))},h("Array.prototype.entries",function(be){return be||function(){return function(Oe,Ve){Oe instanceof String&&(Oe+="");var Se=0,j=!1,X={next:function(){if(!j&&Se<Oe.length){var Z=Se++;return{value:Ve(Z,Oe[Z]),done:!1}}return j=!0,{done:!0,value:void 0}}};return X[Symbol.iterator]=function(){return X},X}(this,function(Oe,Ve){return[Oe,Ve]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var Q=function(be,Oe){for(var Ve=0;Ve<be.length;Ve++)Oe(be[Ve])},ie=function(be){return be.replace(/\r?\n|\r/g,`\r
`)},oe=function(be,Oe,Ve){return Oe instanceof Blob?(Ve=Ve!==void 0?Ve+"":typeof Oe.name=="string"?Oe.name:"blob",Oe.name===Ve&&Object.prototype.toString.call(Oe)!=="[object Blob]"||(Oe=new File([Oe],Ve)),[String(be),Oe]):[String(be),String(Oe)]},re=function(be,Oe){if(be.length<Oe)throw new TypeError(Oe+" argument required, but only "+be.length+" present.")},me=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,Ee=me.FormData,xe=me.XMLHttpRequest&&me.XMLHttpRequest.prototype.send,Me=me.Request&&me.fetch,pt=me.navigator&&me.navigator.sendBeacon,ut=me.Element&&me.Element.prototype,nt=me.Symbol&&Symbol.toStringTag;nt&&(Blob.prototype[nt]||(Blob.prototype[nt]="Blob"),"File"in me&&!File.prototype[nt]&&(File.prototype[nt]="File"));try{new File([],"")}catch{me.File=function(Oe,Ve,Se){return Oe=new Blob(Oe,Se||{}),Object.defineProperties(Oe,{name:{value:Ve},lastModified:{value:+(Se&&Se.lastModified!==void 0?new Date(Se.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),nt&&Object.defineProperty(Oe,nt,{value:"File"}),Oe}}var hn=function(be){return be.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},en=function(be){this.i=[];var Oe=this;be&&Q(be.elements,function(Ve){if(Ve.name&&!Ve.disabled&&Ve.type!=="submit"&&Ve.type!=="button"&&!Ve.matches("form fieldset[disabled] *"))if(Ve.type==="file"){var Se=Ve.files&&Ve.files.length?Ve.files:[new File([],"",{type:"application/octet-stream"})];Q(Se,function(j){Oe.append(Ve.name,j)})}else Ve.type==="select-multiple"||Ve.type==="select-one"?Q(Ve.options,function(j){!j.disabled&&j.selected&&Oe.append(Ve.name,j.value)}):Ve.type==="checkbox"||Ve.type==="radio"?Ve.checked&&Oe.append(Ve.name,Ve.value):(Se=Ve.type==="textarea"?ie(Ve.value):Ve.value,Oe.append(Ve.name,Se))})};if((r=en.prototype).append=function(be,Oe,Ve){re(arguments,2),this.i.push(oe(be,Oe,Ve))},r.delete=function(be){re(arguments,1);var Oe=[];be=String(be),Q(this.i,function(Ve){Ve[0]!==be&&Oe.push(Ve)}),this.i=Oe},r.entries=function be(){var Oe,Ve=this;return z(be,function(Se){if(Se.h==1&&(Oe=0),Se.h!=3)return Oe<Ve.i.length?Se=x(Se,Ve.i[Oe]):(Se.h=0,Se=void 0),Se;Oe++,Se.h=2})},r.forEach=function(be,Oe){re(arguments,1);for(var Ve=g(this),Se=Ve.next();!Se.done;Se=Ve.next()){var j=g(Se.value);Se=j.next().value,j=j.next().value,be.call(Oe,j,Se,this)}},r.get=function(be){re(arguments,1);var Oe=this.i;be=String(be);for(var Ve=0;Ve<Oe.length;Ve++)if(Oe[Ve][0]===be)return Oe[Ve][1];return null},r.getAll=function(be){re(arguments,1);var Oe=[];return be=String(be),Q(this.i,function(Ve){Ve[0]===be&&Oe.push(Ve[1])}),Oe},r.has=function(be){re(arguments,1),be=String(be);for(var Oe=0;Oe<this.i.length;Oe++)if(this.i[Oe][0]===be)return!0;return!1},r.keys=function be(){var Oe,Ve,Se,j,X=this;return z(be,function(Z){if(Z.h==1&&(Oe=g(X),Ve=Oe.next()),Z.h!=3)return Ve.done?void(Z.h=0):(Se=Ve.value,j=g(Se),x(Z,j.next().value));Ve=Oe.next(),Z.h=2})},r.set=function(be,Oe,Ve){re(arguments,2),be=String(be);var Se=[],j=oe(be,Oe,Ve),X=!0;Q(this.i,function(Z){Z[0]===be?X&&(X=!Se.push(j)):Se.push(Z)}),X&&Se.push(j),this.i=Se},r.values=function be(){var Oe,Ve,Se,j,X=this;return z(be,function(Z){if(Z.h==1&&(Oe=g(X),Ve=Oe.next()),Z.h!=3)return Ve.done?void(Z.h=0):(Se=Ve.value,(j=g(Se)).next(),x(Z,j.next().value));Ve=Oe.next(),Z.h=2})},en.prototype._asNative=function(){for(var be=new Ee,Oe=g(this),Ve=Oe.next();!Ve.done;Ve=Oe.next()){var Se=g(Ve.value);Ve=Se.next().value,Se=Se.next().value,be.append(Ve,Se)}return be},en.prototype._blob=function(){var be="----formdata-polyfill-"+Math.random(),Oe=[],Ve="--"+be+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(Se,j){return typeof Se=="string"?Oe.push(Ve+hn(ie(j))+`"\r
\r
`+ie(Se)+`\r
`):Oe.push(Ve+hn(ie(j))+'"; filename="'+hn(Se.name)+`"\r
Content-Type: `+(Se.type||"application/octet-stream")+`\r
\r
`,Se,`\r
`)}),Oe.push("--"+be+"--"),new Blob(Oe,{type:"multipart/form-data; boundary="+be})},en.prototype[Symbol.iterator]=function(){return this.entries()},en.prototype.toString=function(){return"[object FormData]"},ut&&!ut.matches&&(ut.matches=ut.matchesSelector||ut.mozMatchesSelector||ut.msMatchesSelector||ut.oMatchesSelector||ut.webkitMatchesSelector||function(be){for(var Oe=(be=(this.document||this.ownerDocument).querySelectorAll(be)).length;0<=--Oe&&be.item(Oe)!==this;);return-1<Oe}),nt&&(en.prototype[nt]="FormData"),xe){var ro=me.XMLHttpRequest.prototype.setRequestHeader;me.XMLHttpRequest.prototype.setRequestHeader=function(be,Oe){ro.call(this,be,Oe),be.toLowerCase()==="content-type"&&(this.B=!0)},me.XMLHttpRequest.prototype.send=function(be){be instanceof en?(be=be._blob(),this.B||this.setRequestHeader("Content-Type",be.type),xe.call(this,be)):xe.call(this,be)}}Me&&(me.fetch=function(be,Oe){return Oe&&Oe.body&&Oe.body instanceof en&&(Oe.body=Oe.body._blob()),Me.call(this,be,Oe)}),pt&&(me.navigator.sendBeacon=function(be,Oe){return Oe instanceof en&&(Oe=Oe._asNative()),pt.call(this,be,Oe)}),me.FormData=en}})();const T_=()=>{const r=q("AREAS");return r.length===0&&r.push(jt.GLOBAL),oa(r).call(r,(o,s,c)=>{const u=zz(s);return u?c===0?u:"".concat(o,",").concat(u):o},"")},zz=r=>r===jt.OVERSEA?"".concat(pi.ASIA,",").concat(pi.EUROPE,",").concat(pi.AFRICA,",").concat(pi.NORTH_AMERICA,",").concat(pi.SOUTH_AMERICA,",").concat(pi.OCEANIA):pi[r],Sxe=r=>{const o={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return r.map(s=>{const c=aT[s],u=Object.keys(c);u&&u.map(h=>{h!=="CODE"&&(o[h]=o[h].concat(c[h]))})}),o},gT={GLOBAL:{ASIA:[jt.CHINA,jt.JAPAN,jt.INDIA,jt.KOREA,jt.HKMC],EUROPE:[],NORTH_AMERICA:[jt.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},vT=Object.keys(gT[jt.GLOBAL]),pD=[jt.CHINA,jt.NORTH_AMERICA,jt.EUROPE,jt.ASIA,jt.JAPAN,jt.INDIA,jt.OCEANIA,jt.SOUTH_AMERICA,jt.AFRICA,jt.KOREA,jt.HKMC,jt.US],wxe=function(r,o){let s=[];if(Pe(r).call(r,jt.GLOBAL)){const h=[jt.GLOBAL,jt.OVERSEA],p=Object.keys(aT);if(o===jt.GLOBAL)throw new pe(Y.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(o===jt.CHINA)s=[jt.OVERSEA];else if(u=o,Pe(vT).call(vT,u)){const g=(c=o,gT[jt.GLOBAL][c]||[]),y=[...h,o,...g];s=p.filter(b=>!Pe(y).call(y,b))}else if(function(g){let y=!1;return vT.forEach(b=>{var w;Pe(w=gT[jt.GLOBAL][b]).call(w,g)&&(y=!0)}),y}(o)){const g=function(b){let w;return vT.forEach(C=>{var A;Pe(A=gT[jt.GLOBAL][C]).call(A,b)&&(w=C)}),w}(o),y=[...h,g,o];s=p.filter(b=>!Pe(y).call(y,b))}else s=r;s=function(g){const y=[];return pD.forEach(b=>{Pe(g).call(g,b)&&y.push(b)}),y.concat(g.filter(b=>!Pe(pD).call(pD,b)))}(s)}else s=r;var c,u;return s};function Yz(r){var o,s;if(!r&&Pe(o=q("AREAS")).call(o,jt.EXTENSIONS))return L.debug("update area from ap : reset"),void mD(PIe,!0);if(!Pe(s=q("AREAS")).call(s,jt.GLOBAL)||!r)return;let c=aT.EXTENSIONS;c&&(c={CODE:zz(jt.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(r,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(r,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(r,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(r,".agora.io"),"cds-ap-web-2-".concat(r,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(r,".agora.io"),"sua-ap-web-2-".concat(r,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(r,".agora.io"),"uap-ap-web-2-".concat(r,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(r,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(r,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(r,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(r,".agora.io")]},L.debug("update area from ap success: ".concat(r,",config is "),c),Yt("AREAS",[jt.EXTENSIONS],!0),Object.keys(c).map(u=>{u==="LOG_UPLOAD_SERVER"||u==="EVENT_REPORT_DOMAIN"||u==="EVENT_REPORT_BACKUP_DOMAIN"||u==="PROXY_SERVER_TYPE3"?Yt(u,c[u][0]):Yt(u,c[u])}))}function mD(r){let o=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=We.reportApiInvoke(null,{name:Yn.SET_AREA,options:r,tag:Nn.TRACER});try{let c=[];if(typeof r=="string"&&(c=[r]),Array.isArray(r)&&(r.forEach(h=>{if(!Pe(mz).call(mz,h))throw new pe(Y.INVALID_PARAMS,"invalid area code")}),c=r),Object.prototype.toString.call(r)==="[object Object]"){const{areaCode:h,excludedArea:p}=r;if(!h)throw new pe(Y.INVALID_PARAMS,"area code is needed");let g=h;typeof h=="string"&&(g=[h]),c=p?wxe(g,p):g}if(!o){if(rc.AREAS){const h=new pe(Y.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return s.onError(h),void L.warning("setArea is prohibited because of config-distribute")}if(Pe(c).call(c,jt.GLOBAL)&&q("AREAS")===jt.EXTENSIONS){const h=new pe(Y.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return s.onError(h),void L.warning("setArea is prohibited because of ap extensions")}}Yt("AREAS",c,o);const u=Sxe(c);Object.keys(u).map(h=>{h==="LOG_UPLOAD_SERVER"||h==="EVENT_REPORT_DOMAIN"||h==="EVENT_REPORT_BACKUP_DOMAIN"||h==="PROXY_SERVER_TYPE3"?Yt(h,u[h][0]):Yt(h,u[h])}),L.debug("set area success:",c.join(","))}catch(c){throw s.onError(c),c}s.onSuccess()}function qz(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function el(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?qz(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):qz(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}let gD=1;function Txe(r,o,s,c,u){gD+=1;const h={sid:s.sid,command:"convergeAllocateEdge",uid:"666",appId:s.appId,ts:Math.floor(Date.now()/1e3),seq:gD,requestId:gD,version:xs,cname:s.cname},p={service_name:o,json_body:JSON.stringify(h)};let g,y,b=r[0];return nc(async()=>{g=Date.now();const w=await ac(b,{data:p,cancelToken:c,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(y=Date.now()-g,w.code!==0){const x=new pe(Y.UNEXPECTED_RESPONSE,"live streaming ap error, code"+w.code,{retry:!0,responseTime:y});throw L.error(x.toString()),x}const C=JSON.parse(w.json_body);if(C.code!==200){const x=new pe(Y.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(C.code,", reason: ").concat(C.reason),{code:C.code,responseTime:y});throw L.error(x.toString()),x}if(!C.servers||C.servers.length===0){const x=new pe(Y.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:C.code,responseTime:y});throw L.error(x.toString()),x}const A=function(x,B){return{addressList:x.servers.map(U=>"wss://".concat(U.address.replace(/\./g,"-"),".").concat(q("WORKER_DOMAIN"),":").concat(U.wss,"?serviceName=").concat(encodeURIComponent(B))),workerToken:x.workerToken,vid:x.vid}}(C,o);return q("LIVE_STREAMING_ADDRESS")&&(A.addressList=q("LIVE_STREAMING_ADDRESS")instanceof Array?q("LIVE_STREAMING_ADDRESS"):[q("LIVE_STREAMING_ADDRESS")]),el(el({},A),{},{responseTime:y})},(w,C)=>(We.apworkerEvent(s.sid,{success:!0,sc:200,serviceName:o,responseDetail:JSON.stringify(w.addressList),firstSuccess:C===0,responseTime:y,serverIp:r[C%r.length]}),!1),(w,C)=>(We.apworkerEvent(s.sid,{success:!1,sc:w.data&&w.data.code||200,serviceName:o,responseTime:y,serverIp:r[C%r.length]}),!!(w.code!==Y.OPERATION_ABORTED&&w.code!==Y.UNEXPECTED_RESPONSE||w.data&&w.data.retry)&&(b=r[(C+1)%r.length],!0)),u)}let vD=1;function Xz(r,o,s,c){let{url:u,areaCode:h}=r;const{clientId:p,sid:g}=o,y=Date.now();let b;const w=o.role,[C,A]=_D(o,h,[Xn.CHOOSE_SERVER]);let x=qn.networkState;return nc(async()=>{x&&qn.networkState===Do.OFFLINE&&qn.onlineWaiter&&await De.race([qn.onlineWaiter,Kr(c&&c.maxRetryTimeout||rr.maxRetryTimeout)]),x=qn.networkState;const{data:B,headers:U}=await ac(u,{data:C,cancelToken:s,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);b=U.http3==="1"?1:-1,We.reportResourceTiming(u,g),Qz(B,u,o,y,[Xn.CHOOSE_SERVER],b);const F=E_(B,Xn.CHOOSE_SERVER);return yD(F),aD(F,u)},B=>(B&&We.joinChooseServer(g,{role:w,lts:y,succ:!0,csAddr:u,opid:A,serverList:B.gatewayAddrs.map(U=>U.address),ec:null,cid:B.cid.toString(),uid:B.uid.toString(),csIp:B.csIp,unilbsServerIds:[Xn.CHOOSE_SERVER].toString(),isHttp3:b,corssRegionTagReq:o.apRequestDetail,corssRegionTagRes:B.res.detail&&B.res.detail[38]}),!1),B=>B.code!==Y.OPERATION_ABORTED&&(B.code===Y.CAN_NOT_GET_GATEWAY_SERVER?B.data.retry:(We.joinChooseServer(g,{role:w,lts:y,succ:!1,csAddr:u,serverList:null,opid:A,ec:B.code,csIp:B.data&&B.data.csIp,unilbsServerIds:[Xn.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:x}),isHttp3:b,corssRegionTagReq:o.apRequestDetail}),L.warning("[".concat(p||"sid-".concat(g.slice(0,6)),"] Choose server network error, retry"),B),!0)),c)}function Jz(r,o,s,c){let u,{url:h,areaCode:p,serviceIds:g}=r;const y=Date.now(),b=o.role,[w,C]=_D(o,p,g);let A;return nc(async()=>{A&&qn.networkState===Do.OFFLINE&&qn.onlineWaiter&&await De.race([qn.onlineWaiter,Kr(c&&c.maxRetryTimeout||rr.maxRetryTimeout)]),A=qn.networkState;const{data:x,headers:B}=await ac(h,{data:w,cancelToken:s,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);u=B.http3==="1"?1:-1,We.reportResourceTiming(h,o.sid),Qz(x,h,o,y,g,u);const U=E_(x,Xn.CHOOSE_SERVER),F=E_(x,o.cloudProxyServer==="proxy5"?Xn.CLOUD_PROXY_5:o.cloudProxyServer==="proxy3"||o.cloudProxyServer==="proxy4"?Xn.CLOUD_PROXY:Xn.CLOUD_PROXY_FALLBACK);return yD(U),{gatewayInfo:aD(U,h),proxyInfo:F,url:h}},x=>(x.gatewayInfo&&We.joinChooseServer(o.sid,{role:b,lts:y,succ:!0,csAddr:h,serverList:x.gatewayInfo.gatewayAddrs.map(B=>B.address),ec:null,opid:C,cid:x.gatewayInfo.cid.toString(),uid:x.gatewayInfo.uid.toString(),csIp:x.gatewayInfo.csIp,unilbsServerIds:g.toString(),isHttp3:u,corssRegionTagReq:o.apRequestDetail,corssRegionTagRes:x.gatewayInfo.res.detail&&x.gatewayInfo.res.detail[38]}),x.proxyInfo&&We.joinWebProxyAP(o.sid,{lts:y,sucess:1,apServerAddr:h,turnServerAddrList:x.proxyInfo.addresses.map(B=>B.ip).join(","),errorCode:null,eventType:o.cloudProxyServer,unilbsServerIds:g.toString()}),!1),x=>x.code!==Y.OPERATION_ABORTED&&(x.code===Y.CAN_NOT_GET_GATEWAY_SERVER?x.data.retry:(We.joinWebProxyAP(o.sid,{lts:y,sucess:0,apServerAddr:h,turnServerAddrList:null,errorCode:x.code,eventType:o.cloudProxyServer,unilbsServerIds:g.toString(),extend:JSON.stringify({networkState:A})}),L.warning("[".concat(o.clientId,"] multi unilbs network error, retry"),x),!0)),c)}const Qz=(r,o,s,c,u,h)=>{const{sid:p,clientId:g,cloudProxyServer:y}=s,b=[],w=C=>{C.flag===4096?We.joinChooseServer(p,{role:s.role,lts:c,succ:!1,csAddr:o,opid:r.opid,serverList:null,ec:C.error.message,csIp:C.error.data&&C.error.data.csIp,unilbsServerIds:u.toString(),isHttp3:h,corssRegionTagReq:s.apRequestDetail}):C.flag!==1048576&&C.flag!==4194304&&C.flag!==4194310||We.joinWebProxyAP(p,{lts:c,sucess:0,apServerAddr:o,turnServerAddrList:null,errorCode:C.error.code,eventType:y,unilbsServerIds:u.toString()})};if(r.response_body.forEach(C=>{const A=C.buffer.code;if(C.uri===23&&A===0&&!C.buffer.edges_services)if(C.buffer.flag===4194310)L.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),C.buffer.edges_services=[];else{const x={error:new pe(Y.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:r.detail[502]}),flag:C.buffer.flag};b.push(x),w(x)}if(A!==0){const x=jm(A),B={error:new pe(Y.CAN_NOT_GET_GATEWAY_SERVER,x.desc,{desc:x.desc,retry:x.retry,csIp:r.detail[502]}),flag:C.buffer.flag};C.buffer.flag===4194310?L.warning(B.error.toString()):b.push(B),w(B)}}),b.length)throw L.warning("[".concat(g||"sid-".concat(p.slice(0,6)),"] multi unilbs ").concat(o," failed, ").concat(b.map(C=>"flag: ".concat(C.flag,", message: ").concat(C.error.message,", retry: ").concat(C.error.data.retry)).join(" | "))),new pe(Y.CAN_NOT_GET_GATEWAY_SERVER,b.map(C=>"flag: ".concat(C.flag,", message: ").concat(C.error.message)).join(" | "),{retry:!!b.find(C=>C.error.data.retry),csIp:r.detail[502],desc:[...new Set(b.map(C=>{var A;return C==null||(A=C.error)===null||A===void 0||(A=A.data)===null||A===void 0?void 0:A.desc}).filter(C=>!!C))]})},yD=r=>{var o,s,c,u;if(r.addresses&&r.addresses.length===0&&r.code===0)throw new pe(Y.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:r.detail&&r.detail[502]});if(q("AP_AREA")&&((c=r.detail)!==null&&c!==void 0&&c[23]&&typeof((u=r.detail)===null||u===void 0?void 0:u[23])=="string"?Yz(r.detail[23].toLowerCase()):Yz()),(o=r.detail)!==null&&o!==void 0&&o[19]&&typeof((s=r.detail)===null||s===void 0?void 0:s[19])=="string"){const p=r.detail[19],g=p==null?void 0:p.split(";");for(let y=0;y<g.length;y++){var h;const b=Oi(h=g[y]).call(h);r.addresses[y]&&g&&(r.addresses[y].fingerprint=b)}}if(q("GATEWAY_ADDRESS")&&q("GATEWAY_ADDRESS").length>0){L.debug("assign gateway address to",q("GATEWAY_ADDRESS"));const p=q("GATEWAY_ADDRESS").map(g=>{var y,b;const w=(y=(b=r.addresses.find(C=>C.ip===g.ip&&C.port===g.port))===null||b===void 0?void 0:b.fingerprint)!==null&&y!==void 0?y:"";return{ip:g.ip,port:g.port,ticket:r.addresses[0]&&r.addresses[0].ticket,fingerprint:w}});r.addresses=p}},Cxe=(r,o)=>{if(r.response_body&&r.response_body.length){const s=r.response_body[0];if(s.buffer.code!==0){const c=jm(s.buffer.code);throw new pe(Y.UPDATE_TICKET_FAILED,"[".concat(s.buffer.code,"]: ").concat(c.desc),{retry:c.retry})}return s.buffer.ticket}throw L.debug("update ticket request received ap response without response body:",o),new pe(Y.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},_D=(r,o,s)=>{const c=Math.floor(Math.random()*1e12),u=r.role==="host"?"1":r.role==="audience"?"2":void 0,h={appid:r.appId,client_ts:Date.now(),opid:c,sid:r.sid,request_bodies:[{uri:22,buffer:{cname:r.cname,detail:el(el(el({6:r.stringUid,11:o,12:q("USE_NEW_TOKEN")?"1":void 0},u?{17:u}:{}),{},{22:o},r.apRequestDetail?{33:r.apRequestDetail}:{}),r.apRTM?{26:"RTM2"}:{}),key:r.token,service_ids:s,uid:r.uid||0}}]};h.request_bodies.forEach(g=>{r.multiIP&&r.multiIP.gateway_ip&&(g.buffer.detail[5]=JSON.stringify({vocs_ip:[r.multiIP.uni_lbs_ip],vos_ip:[r.multiIP.gateway_ip]}))});const p=new FormData;return p.append("request",JSON.stringify(h)),[p,c]},Rxe=(r,o)=>{const s=Math.floor(Math.random()*1e12),c={appid:r.appId,client_ts:Date.now(),opid:s,sid:r.sid,request_bodies:[{uri:28,buffer:{cname:r.cname,detail:{1:"",6:r.stringUid,12:"1"},token:r.token,service_ids:o,uid:r.uid||0,edges_services:r.apResponse.addresses.map(h=>({ip:h.ip,port:h.port}))}}]},u=new FormData;return u.append("request",JSON.stringify(c)),[u,s]};let Bm=0;function $m(r){return De.all(r.map(o=>o.then(s=>{throw s},s=>s))).then(o=>{throw o},o=>o)}const C_=async r=>{let{fragementLength:o,referenceList:s,asyncMapHandler:c,allFailedhandler:u,promisesCollector:h}=r,p=0;const g=o;let y,b=0;const w=async()=>{const C=(()=>{const A=p*g,x=A+g;return s.slice(A,x).map(c)})();h&&h.push(...C);try{y=await $m(C)}catch(A){if(b+=g,p++,!(b>=s.length))return void await w();u(A)}C.forEach(A=>A.cancel())};return await w(),y},Zz=async r=>{let{referenceList:o,asyncMapHandler:s,closeFn:c}=r;const u=o.length;let h=0;const p=async()=>{const g=s(o.shift());try{return await g}catch(y){if(h++,h>=u||c!=null&&c(y))throw y;return p()}};return p()};async function ED(r,o,s,c){return{gatewayInfo:await async function(h,p,g,y){let b=null;const w=[],C=async()=>{const x=q("WEBCS_DOMAIN").slice(0,q("AJAX_REQUEST_CONCURRENT")).map(F=>({url:h.proxyServer?"https://".concat(h.proxyServer,"/ap/?url=").concat(F+"/api/v2/transpond/webrtc?v=2"):"https://".concat(F,"/api/v2/transpond/webrtc?v=2"),areaCode:T_()})),B=y.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:x.map(F=>F.url)}),U=await C_({fragementLength:q("FRAGEMENT_LENGTH"),referenceList:x,asyncMapHandler:F=>(L.debug("[".concat(h.clientId,"] Connect to choose_server:"),F.url),Xz(F,h,p,g)),allFailedhandler:F=>{throw y.recordJoinChannelService({endTs:Date.now(),status:"error",errors:F},B),F[0]},promisesCollector:w});return y.recordJoinChannelService({endTs:Date.now(),status:"success"},B),U},A=async()=>{if(await Kr(1e3),b!==null)return b;const x=q("WEBCS_DOMAIN_BACKUP_LIST").map(F=>({url:h.proxyServer?"https://".concat(h.proxyServer,"/ap/?url=").concat(F+"/api/v2/transpond/webrtc?v=2"):"https://".concat(F,"/api/v2/transpond/webrtc?v=2"),areaCode:T_()})),B=y.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:x.map(F=>F.url)}),U=await C_({fragementLength:q("FRAGEMENT_LENGTH"),referenceList:x,asyncMapHandler:F=>(L.debug("[".concat(h.clientId,"] Connect to backup choose_server:"),F.url),Xz(F,h,p,g)),allFailedhandler:F=>{throw y.recordJoinChannelService({endTs:Date.now(),status:"error",errors:F},B),F[0]},promisesCollector:w});return y.recordJoinChannelService({endTs:Date.now(),status:"success"},B),U};try{return b=await $m([C(),A()]),w.length&&w.forEach(x=>x.cancel&&typeof x.cancel=="function"&&x.cancel()),b}catch(x){throw x[0]}}(r,o,s,c)}}async function eY(r,o,s,c,u){const h=r.cloudProxyServer;if(h==="disabled"){if(r.useLocalAccessPoint)return await ED(r,o,s,u);if(q("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:A,proxyInfo:x}=await rY(r,o,s,u);if(r.turnServer&&r.turnServer.mode!=="auto")return{gatewayInfo:A};const B=x.map(U=>({turnServerURL:U.address,tcpport:U.tcpport||si.tcpport,udpport:U.udpport||si.udpport,username:U.username||si.username,password:U.password||si.password,forceturn:!1,security:!0}));if(u.useP2P){var p;const U=(p=r.uid)!==null&&p!==void 0?p:A.uid,F="glb:".concat(U.toString()),K=await d1(F),z=x.map(Q=>({turnServerURL:Q.address,tcpport:Q.tcpport||si.tcpport,udpport:Q.udpport||si.udpport,username:F,password:K,forceturn:!1,security:!0}));B.push(...z)}return r.turnServer={mode:"manual",servers:B},{gatewayInfo:A}}return await ED(r,o,s,u)}const{proxyInfo:g,gatewayInfo:y}=await rY(r,o,s,u),b={gatewayInfo:y},w=g.map(A=>({turnServerURL:A.address,tcpport:h==="proxy3"?void 0:A.tcpport?A.tcpport:si.tcpport,udpport:h==="proxy4"?void 0:A.udpport?A.udpport:si.udpport,username:A.username||si.username,password:A.password||si.password,forceturn:h!=="proxy4",security:h==="proxy5"}));if(u.useP2P){var C;const A=(C=r.uid)!==null&&C!==void 0?C:y.uid,x="glb:".concat(A.toString()),B=await d1(x),U=g.map(F=>({turnServerURL:F.address,tcpport:h==="proxy3"?void 0:F.tcpport||si.tcpport,udpport:h==="proxy4"?void 0:F.udpport||si.udpport,username:x,password:B,forceturn:h!=="proxy4",security:h==="proxy5"}));w.push(...U)}return r.turnServer={mode:"manual",servers:w},L.debug("[".concat(r.clientId,"] set proxy server: ").concat(r.proxyServer,", mode: ").concat(h)),b}async function tY(r,o,s,c,u){const h=q("ACCOUNT_REGISTER").slice(0,q("AJAX_REQUEST_CONCURRENT"));let p=[];p=o.proxyServer?h.map(y=>"https://".concat(o.proxyServer,"/ap/?url=").concat(y+"/api/v1")):h.map(y=>"https://".concat(y,"/api/v1"));const g=u==null?void 0:u.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:p});try{const y=await async function(b,w,C,A,x){const B=Date.now(),U={sid:C.sid,opid:10,appid:C.appId,string_uid:w};let F=b[0];const K=await nc(()=>ac(F+"".concat(F.indexOf("?")===-1?"?":"&","action=stringuid"),{data:U,cancelToken:A,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(z,Q)=>{if(z.code===0){if(z.uid<=0||z.uid>=Math.pow(2,32))throw L.error("Invalid Uint Uid ".concat(w," => ").concat(z.uid),z),We.reqUserAccount(U.sid,{lts:B,success:!1,serverAddr:F,stringUid:U.string_uid,uid:z.uid,errorCode:Y.INVALID_UINT_UID_FROM_STRING_UID,extend:U}),new pe(Y.INVALID_UINT_UID_FROM_STRING_UID);return We.reqUserAccount(U.sid,{lts:B,success:!0,serverAddr:F,stringUid:U.string_uid,uid:z.uid,errorCode:null,extend:U}),!1}const ie=jm(z.code);return ie.retry&&(F=b[(Q+1)%b.length]),We.reqUserAccount(U.sid,{lts:B,success:!1,serverAddr:F,stringUid:U.string_uid,uid:z.uid,errorCode:ie.desc,extend:U}),ie.retry},(z,Q)=>z.code!==Y.OPERATION_ABORTED&&(We.reqUserAccount(U.sid,{lts:B,success:!1,serverAddr:F,stringUid:U.string_uid,uid:null,errorCode:z.code,extend:U}),F=b[(Q+1)%b.length],!0),x);if(K.code!==0){const z=jm(K.code);throw new pe(Y.UNEXPECTED_RESPONSE,z.desc)}return K}(p,r,o,s,c);return u==null||u.recordJoinChannelService({status:"success",endTs:Date.now()},g),y.uid}catch(y){throw u==null||u.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[y]},g),y}}async function Axe(r,o,s){const c=q("ACCOUNT_REGISTER");let u=[];u=o.proxyServer?c.map(h=>"https://".concat(o.proxyServer,"/ap/?url=").concat(h+"/api/v1")):c.map(h=>"https://".concat(h,"/api/v1"));try{return await Zz({referenceList:u,asyncMapHandler:p=>async function(g,y,b,w){const C=Date.now(),A={sid:b.sid,opid:10,appid:b.appId,string_uid:y};try{const x=await ac(g+"".concat(g.indexOf("?")===-1?"?":"&","action=stringuid"),{data:A,cancelToken:w,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}});if(x.code!==0){const B=jm(x.code);throw new pe(Y.UNEXPECTED_RESPONSE,"preload sua error:".concat(B.desc),B)}if(x.uid<=0||x.uid>=Math.pow(2,32))throw new pe(Y.INVALID_UINT_UID_FROM_STRING_UID);return{requestTime:C,url:g,req:A,uid:x.uid,elapse:Date.now()-C}}catch(x){throw x}}(p,r,o,s),closeFn:p=>p.code===Y.OPERATION_ABORTED||p.code===Y.UNEXPECTED_RESPONSE&&!p.data.retry})}catch(h){throw h}}async function Oxe(r,o,s){const c=q("CDS_AP").slice(0,q("AJAX_REQUEST_CONCURRENT")).map(y=>r.proxyServer?"https://".concat(r.proxyServer,"/ap/?url=").concat(y+"/api/v1"):"https://".concat(y,"/api/v1?action=config")),u=c.map(y=>function(b,w,C,A){const x=It(),B={flag:64,cipher_method:0,features:el(el(el(el(el({install_id:w1(),device:x.name,system:x.os,system_general:navigator.userAgent,vendor:w.appId,version:xs,cname:w.cname,session_id:w.sid,proxyServer:w.proxyServer,sdk_type:_xe.WEB_RTC,browser_name:x.name,browser_version:x.version,user_agent:navigator.userAgent,channel_name:w.cname},w.stringUid&&{string_uid:w.stringUid}),w.uid&&{uid:w.uid+""}),x.os&&{os_name:x.os}),x.osVersion&&{os_version:x.osVersion}),{},{detail:""})};return nc(()=>ac(b,{data:B,timeout:1e3,cancelToken:C,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,U=>U.code!==Y.OPERATION_ABORTED,A)}(y,r,o,s));let h=null,p=null,g={};try{h=await $m(u)}catch(y){if(y.code===Y.OPERATION_ABORTED)throw y;p=y}if(u.forEach(y=>y.cancel()),We.reportApiInvoke(r.sid,{name:Yn.REQUEST_CONFIG_DISTRIBUTE,options:{error:p,res:h}}).onSuccess(),h&&h.test_tags)try{g=function(y){if(!y.test_tags)return{};const b=y.test_tags,w=Object.keys(b),C={};return w.forEach(A=>{var x;const B=Oi(x=A.slice(4)).call(x),U=JSON.parse(b[A]),F=U[1];C[B]={tag:U[0]||"",value:F}}),C}(h)}catch{}return g}async function nY(r,o){const s=q("WEBCS_DOMAIN").concat(q("WEBCS_DOMAIN_BACKUP_LIST")).map(c=>({url:"https://".concat(c,"/api/v2/transpond/webrtc?v=2"),areaCode:T_(),serviceIds:[Xn.CHOOSE_SERVER,Xn.CLOUD_PROXY_FALLBACK]}));try{return await Zz({referenceList:s,asyncMapHandler:u=>async function(h,p,g){let y,{url:b,areaCode:w,serviceIds:C}=h;const A=Date.now(),[x,B]=_D(p,w,C);let U=qn.networkState;try{U&&qn.networkState===Do.OFFLINE&&qn.onlineWaiter&&await De.race([qn.onlineWaiter,Kr(rr.maxRetryTimeout)]),U=qn.networkState;const{data:F,headers:K}=await ac(b,{data:x,cancelToken:g,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);y=K.http3==="1"?1:-1,(oe=>{const re=[];if(oe.response_body.forEach(me=>{const Ee=me.buffer.code;if(me.uri===23&&Ee===0&&!me.buffer.edges_services)if(me.buffer.flag===4194310)me.buffer.edges_services=[];else{const xe={error:new pe(Y.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:oe.detail[502]}),flag:me.buffer.flag};re.push(xe)}if(Ee!==0){const xe=jm(Ee),Me={error:new pe(Y.CAN_NOT_GET_GATEWAY_SERVER,xe.desc,{desc:xe.desc,retry:xe.retry,csIp:oe.detail[502]}),flag:me.buffer.flag};me.buffer.flag===4194310?L.warning(Me.error.toString()):re.push(Me)}}),re.length)throw new pe(Y.CAN_NOT_GET_GATEWAY_SERVER,re.map(me=>"flag: ".concat(me.flag,", message: ").concat(me.error.message)).join(" | "),{retry:!!re.find(me=>me.error.data.retry),csIp:oe.detail[502],desc:[...new Set(re.map(me=>{var Ee;return me==null||(Ee=me.error)===null||Ee===void 0||(Ee=Ee.data)===null||Ee===void 0?void 0:Ee.desc}).filter(me=>!!me))]})})(F);const Q=E_(F,Xn.CHOOSE_SERVER),ie=E_(F,Xn.CLOUD_PROXY_FALLBACK);return yD(Q),{gatewayInfo:aD(Q,b),proxyInfo:ie,opid:B,requestTime:A,url:b,isHttp3:y,elapse:Date.now()-A}}catch(F){throw F}}(u,r,o),closeFn:u=>u.code===Y.OPERATION_ABORTED||u.code===Y.CAN_NOT_GET_GATEWAY_SERVER&&!u.data.retry})}catch(c){throw c}}async function rY(r,o,s,c){const u=q("PROXY_SERVER_TYPE3"),h=(x,B,U)=>{let F=U||u;return Array.isArray(F)&&(F=B%2==0?u[1]:u[0]),"https://".concat(F,"/ap/?url=").concat(x)};let p=null;const g=[],y=async()=>{const x=q("WEBCS_DOMAIN").slice(0,q("AJAX_REQUEST_CONCURRENT")).map((F,K)=>{let z;return z=r.cloudProxyServer==="disabled"&&r.proxyServer?h("".concat(F,"/api/v2/transpond/webrtc?v=2"),K,r.proxyServer):r.cloudProxyServer==="disabled"||r.cloudProxyServer==="fallback"?"https://".concat(F,"/api/v2/transpond/webrtc?v=2"):h("".concat(F,"/api/v2/transpond/webrtc?v=2"),K),{url:z,areaCode:T_(),serviceIds:[Xn.CHOOSE_SERVER,r.cloudProxyServer==="proxy5"?Xn.CLOUD_PROXY_5:r.cloudProxyServer==="proxy3"||r.cloudProxyServer==="proxy4"?Xn.CLOUD_PROXY:Xn.CLOUD_PROXY_FALLBACK]}}),B=c.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:x.map(F=>F.url)}),U=await C_({fragementLength:q("FRAGEMENT_LENGTH"),referenceList:x,asyncMapHandler:F=>(L.debug("[".concat(r.clientId,"] Connect to choose_server:"),F.url),Jz(F,r,o,s)),allFailedhandler:F=>{throw c.recordJoinChannelService({endTs:Date.now(),status:"error",errors:F},B),F[0]},promisesCollector:g});return c.recordJoinChannelService({endTs:Date.now(),status:"success"},B),U},b=async()=>{if(await Kr(1e3),p!==null)return p;const x=q("WEBCS_DOMAIN_BACKUP_LIST").map((F,K)=>{let z;return z=r.cloudProxyServer==="disabled"&&r.proxyServer?h("".concat(F,"/api/v2/transpond/webrtc?v=2"),K,r.proxyServer):r.cloudProxyServer==="disabled"||r.cloudProxyServer==="fallback"?"https://".concat(F,"/api/v2/transpond/webrtc?v=2"):h("".concat(F,"/api/v2/transpond/webrtc?v=2"),K),{url:z,areaCode:T_(),serviceIds:[Xn.CHOOSE_SERVER,r.cloudProxyServer==="proxy5"?Xn.CLOUD_PROXY_5:r.cloudProxyServer==="proxy3"||r.cloudProxyServer==="proxy4"?Xn.CLOUD_PROXY:Xn.CLOUD_PROXY_FALLBACK]}}),B=c.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:x.map(F=>F.url)}),U=await C_({fragementLength:q("FRAGEMENT_LENGTH"),referenceList:x,asyncMapHandler:F=>(L.debug("[".concat(r.clientId,"] Connect to backup choose_server:"),F.url),Jz(F,r,o,s)),allFailedhandler:F=>{throw c.recordJoinChannelService({endTs:Date.now(),status:"error",errors:F},B),F[0]},promisesCollector:g});return c.recordJoinChannelService({endTs:Date.now(),status:"success"},B),U};let w,C,A;try{({gatewayInfo:w,proxyInfo:C,url:A}=await $m([y(),b()]))}catch(x){throw x[0]}if(g.length&&g.forEach(x=>x.cancel&&typeof x.cancel=="function"&&x.cancel()),!w||!C)throw new pe(Y.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(r.apUrl=A,r.cloudProxyServer!=="disabled"&&Array.isArray(u)&&A){const x=/^https?:\/\/(.+?)(\/.*)?$/.exec(A)[1];Pe(u).call(u,x)&&(r.proxyServer=x,L.setProxyServer(x),We.setProxyServer(x))}return p={gatewayInfo:w,proxyInfo:await Az(C,w.uid)},p}async function Ixe(r,o,s){const c=q("UAP_AP").slice(0,q("AJAX_REQUEST_CONCURRENT")).map(h=>r.proxyServer?"https://".concat(r.proxyServer,"/ap/?url=").concat(h+"/api/v1?action=uap"):"https://".concat(h,"/api/v1?action=uap")),u=c.map(h=>function(p,g,y,b){const w={command:"convergeAllocateEdge",sid:g.sid,appId:g.appId,token:g.token,ts:Date.now(),version:xs,cname:g.cname,uid:g.uid.toString(),requestId:vD,seq:vD};vD+=1;const C={service_name:"tele_channel",json_body:JSON.stringify(w)};return nc(async()=>{const A=await ac(p,{data:C,cancelToken:y,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(A.code!==0){const B=new pe(Y.UNEXPECTED_RESPONSE,"cross channel ap error, code"+A.code,{retry:!0});throw L.error(B.toString()),B}const x=JSON.parse(A.json_body);if(x.code!==200){const B=new pe(Y.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(x.code,", reason: ").concat(x.reason));throw L.error(B.toString()),B}if(!x.servers||x.servers.length===0){const B=new pe(Y.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw L.error(B.toString()),B}return{vid:x.vid,workerToken:x.workerToken,addressList:(q("CHANNEL_MEDIA_RELAY_SERVERS")||x.servers).map(B=>"wss://".concat(B.address.replace(/\./g,"-"),".").concat(q("WORKER_DOMAIN"),":").concat(B.wss))}},void 0,A=>!!(A.code!==Y.OPERATION_ABORTED&&A.code!==Y.UNEXPECTED_RESPONSE||A.data&&A.data.retry),b)}(h,r,o,s));try{const h=await $m(u);return u.forEach(p=>p.cancel()),h}catch(h){throw h[0]}}async function xxe(r,o,s){let c=null;const u=[],h=async p=>{const g=q(p?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(y=>r.proxyServer?"https://".concat(r.proxyServer,"/ap/?url=").concat(y+"/api/v2/transpond/webrtc?v=2"):"https://".concat(y,"/api/v2/transpond/webrtc?v=2"));return p&&(await Kr(1e3),c!==null)?c:await C_({fragementLength:q("FRAGEMENT_LENGTH"),referenceList:g,asyncMapHandler:y=>(L.debug("[".concat(r.clientId,"] update ticket, Connect to ").concat(p?"backup":""," choose_server:"),y),function(b,w,C,A){const[x]=Rxe(w,[Xn.CHOOSE_SERVER]);let B=qn.networkState;return nc(async()=>{B&&qn.networkState===Do.OFFLINE&&qn.onlineWaiter&&await De.race([qn.onlineWaiter,Kr(A&&A.maxRetryTimeout||rr.maxRetryTimeout)]),B=qn.networkState;const U=await ac(b,{data:x,cancelToken:C,headers:{"Content-Type":"multipart/form-data;"}},!0);return Cxe(U,b)},()=>!1,U=>U.code!==Y.OPERATION_ABORTED&&(U.code===Y.UPDATE_TICKET_FAILED?U.data.retry:(L.warning("[".concat(w.clientId,"] update ticket network error, retry"),U),!0)),A)}(y,r,o,s)),allFailedhandler:y=>{throw y[0]},promisesCollector:u})};try{return c=await $m([h(!1),h(!0)]),u.length&&u.forEach(p=>p.cancel&&typeof p.cancel=="function"&&p.cancel()),c}catch(p){throw p[0]}}function iY(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function bD(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?iY(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):iY(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}class Pxe extends An{get isSuccess(){return!!this.configs}constructor(o,s){super(),G(this,"configs",void 0),G(this,"store",void 0),G(this,"joinInfo",void 0),G(this,"cancelToken",void 0),G(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),G(this,"interval",void 0),G(this,"mutex",void 0),G(this,"mutableParamsRead",!1),G(this,"configCache",{}),G(this,"limit_bitrate",void 0),this.mutex=new fi("config-distribute",o),this.store=s}startGetConfigDistribute(o,s){this.joinInfo=o,this.cancelToken=s,this.interval&&this.stopGetConfigDistribute(),q("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},q("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0,this.configs=void 0,this.limit_bitrate=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,We.reportApiInvoke(null,{options:void 0,name:Yn.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:Nn.TRACER}).onSuccess(JSON.stringify(rc))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void L.debug("[config-distribute] get config distribute interrupted have no joininfo");let o;const s=await this.mutex.lock();try{o=await Oxe(this.joinInfo,this.cancelToken,this.retryConfig),L.debug("[config-distribute] get config distribute",JSON.stringify(o));const c=function(u){var h;const p=Yh(h=Object.keys(u).filter(b=>/^webrtc_ng_global_parameter/.test(b))).call(h);for(let b=0;b<p.length;b++)for(let w=p.length-1;w>b;w--){const C=p[w],A=u[C].value;if(typeof A.__priority=="number"){const x=A.__priority,B=p[w-1],U=u[B].value;if(typeof U.__priority=="number"){if(!(x>U.__priority))continue;{const F=C;p[w]=p[w-1],p[w-1]=F}}else{const F=C;p[w]=p[w-1],p[w-1]=F}}}const g=Date.now();let y={};return p.forEach(b=>{const w=u[b].value.__expires;w&&w<=g||(y[b]=u[b])}),y}(o);this.cacheGlobalParameterConfig(c),this.store.hasStartJoinChannel||(this.store.isABTestSuccess=!0),this.configs=c}catch(c){const u=new pe(Y.NETWORK_RESPONSE_ERROR,c);L.warning("[config-distribute] ".concat(u.toString()))}finally{s()}}getBitrateLimit(){return this.limit_bitrate||void 0}handleBitrateLimit(o){gz(o)&&(this.limit_bitrate?this.limit_bitrate&&this.limit_bitrate.id!==o.id&&this.emit(v_.UPDATE_BITRATE_LIMIT,o):this.emit(v_.UPDATE_BITRATE_LIMIT,o))}getLowStreamConfigDistribute(){return this.limit_bitrate&&bD({},this.limit_bitrate.low_stream_uplink)}handleABTestConfigDistribute(o){try{const s={},c=Object.keys(o),u=[];c.forEach(h=>{const p=o[h].value;s[h]=p;const g=p.__id;if(g&&this.configCache[h]&&this.configCache[h].__id===g)return;const y=p.__type,b=o[h].value,w=o[h].tag;let C=0;y?y===W8.REALTIME&&(C=1):Object.keys(b).some(A=>Object.prototype.hasOwnProperty.call(A1,A)||!X1()&&Object.prototype.hasOwnProperty.call(Fw,A)?(C=1,!0):void 0),u.push({tag:w,isApplied:C,feature:h,params:JSON.stringify(p)})}),u.forEach(h=>{let{tag:p,feature:g,params:y,isApplied:b}=h;this.store.sessionId&&We.abTest(this.store.sessionId,{intSucc:1,isApplied:b,tag:p,feature:g,params:y,cid:this.store.cid,uid:this.store.intUid})}),this.configCache=s}catch(s){L.debug("handleABTestConfigDistribute error",s)}}cacheGlobalParameterConfig(o){const s=function(u){const h={};return Object.keys(u).forEach(p=>{const g=u[p].value,y=g.__expires,b=g.__type;Object.keys(g).forEach(w=>{w==="__id"||w==="__type"||w==="__priority"||w==="__expires"||Object.prototype.hasOwnProperty.call(h,w)||(h[w]=bD(bD({value:g[w]},y&&{expires:y}),b&&{type:b}))})}),h}(o);try{var c;const u=(c=s.LIMIT_BITRATE)===null||c===void 0?void 0:c.value;delete s.LIMIT_BITRATE,u&&gz(u)&&this.handleBitrateLimit(u),this.limit_bitrate=u,this.handleGlobalParameterConfig(s),this.handleABTestConfigDistribute(o),function(g){try{const y=Date.now();Object.keys(g).forEach(b=>{const{value:w,type:C,expires:A}=g[b];A&&A<=y||((C===W8.REALTIME||Object.prototype.hasOwnProperty.call(A1,b))&&(rc[b]=w,yn[b]=w,L.debug("Update realtime parameters from config distribute",b,w)),C||X1()||!Object.prototype.hasOwnProperty.call(Fw,b)||(rc[b]=w,yn[b]=w,L.debug("Update gateway parameters from config distribute",b,w)))})}catch(y){L.error("Error update config immediately: ".concat(g),y.message)}}(s);const h=JSON.stringify(s),p=window.btoa(h);window.localStorage.setItem("websdk_ng_global_parameter",p),L.debug("Caching global parameters ".concat(h))}catch(u){L.error("Error caching global parameters:",u.message)}}handleGlobalParameterConfig(o){try{const s=Date.now();Object.keys(o).forEach(c=>{if(c==="CLIENT_ROLE_OPTIONS"&&Object.prototype.hasOwnProperty.call(yn,c)){const{value:u,expires:h}=o[c];if(h&&h<=s)return;(function(p,g){try{return typeof p=="object"&&typeof g=="object"&&JSON.stringify(p)===JSON.stringify(g)}catch{return!1}})(yn[c],u)||(rc[c]=u,yn[c]=u,this.emit(v_.UPDATE_CLIENT_ROLE_OPTIONS,u),L.debug("Updating client role options: ".concat(JSON.stringify(u))))}})}catch(s){L.error("Error handling global parameter config:",s.message)}}}class Nxe extends An{constructor(){super(...arguments),G(this,"resultStorage",new Map)}setLocalAudioStats(o,s,c){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",o,this.checkAudioInputLevel(c,s)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",o,this.checkSendAudioBitrate(c,s))}setLocalVideoStats(o,s,c){this.record("SEND_VIDEO_BITRATE_TOO_LOW",o,this.checkSendVideoBitrate(c,s)),this.record("FRAMERATE_INPUT_TOO_LOW",o,this.checkFramerateInput(c,s)),this.record("FRAMERATE_SENT_TOO_LOW",o,this.checkFramerateSent(c))}setRemoteAudioStats(o,s){const c=o.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",c,this.checkAudioOutputLevel(s))}setRemoteVideoStats(o,s){const c=o.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",c,this.checkVideoDecode(s))}record(o,s,c){if(q("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(o)||this.resultStorage.set(o,{result:[],isPrevNormal:!0});const u=this.resultStorage.get(o);if(u&&(u.result.push(c),u.result.length>=5)){var h;const p=Pe(h=u.result).call(h,!0);u.isPrevNormal&&!p&&this.emit("exception",oY[o],o,s),!u.isPrevNormal&&p&&this.emit("exception",oY[o]+2e3,o+"_RECOVER",s),u.isPrevNormal=p,u.result=[]}}checkAudioOutputLevel(o){return!(o.receiveBitrate>0&&o.receiveLevel===0)}checkAudioInputLevel(o,s){return s instanceof lr&&!s.isActive||!!s.muted||o.sendVolumeLevel!==0}checkFramerateInput(o,s){let c=null;s._encoderConfig&&s._encoderConfig.frameRate&&(c=ko(s._encoderConfig.frameRate));const u=o.captureFrameRate;return!c||!u||!(c>10&&u<5||c<10&&c>=5&&u<=1)}checkFramerateSent(o){return!(o.captureFrameRate&&o.sendFrameRate&&o.captureFrameRate>5&&o.sendFrameRate<=1)}checkSendVideoBitrate(o,s){return!!s.muted||o.sendBitrate!==0}checkSendAudioBitrate(o,s){return s instanceof lr&&!s.isActive||!!s.muted||o.sendBitrate!==0}checkVideoDecode(o){return o.receiveBitrate===0||o.decodeFrameRate!==0}}const oY={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},gi=new class{markSubscribeStart(r,o){performance.mark("agora-web-sdk/".concat(r,"/subscribe-").concat(o))}markPublishStart(r,o){performance.mark("agora-web-sdk/".concat(r,"/publish-").concat(o))}measureFromSubscribeStart(r,o){const s=performance.getEntriesByName("agora-web-sdk/".concat(r,"/subscribe-").concat(o));if(s.length>0){const c=s[s.length-1];return Math.round(performance.now()-c.startTime)}return 0}measureFromPublishStart(r,o){const s=performance.getEntriesByName("agora-web-sdk/".concat(r,"/publish-").concat(o));if(s.length>0){const c=s[s.length-1];return Math.round(performance.now()-c.startTime)}return 0}};function sY(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function gf(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?sY(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):sY(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}class R_{constructor(o){G(this,"store",void 0),G(this,"onStatsException",void 0),G(this,"onUploadPublishDuration",void 0),G(this,"onStatsChanged",void 0),G(this,"onVideoCodecChanged",void 0),G(this,"localStats",new Map),G(this,"remoteStats",new Map),G(this,"updateStatsInterval",void 0),G(this,"trafficStats",void 0),G(this,"trafficStatsPeerList",[]),G(this,"uplinkStats",void 0),G(this,"exceptionMonitor",void 0),G(this,"p2pChannel",void 0),G(this,"scalabilityMode",Vw.L1T1),G(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=o,this.exceptionMonitor=new Nxe,this.exceptionMonitor.on("exception",(s,c,u)=>{this.onStatsException&&this.onStatsException(s,c,u)})}startUpdateStats(){this.updateStatsInterval||(this.updateStatsInterval=window.setInterval(this.updateStats,1e3))}stopUpdateStats(){this.updateStatsInterval&&(window.clearInterval(this.updateStatsInterval),this.updateStatsInterval=void 0)}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(Te.LocalAudioTrack)||gf({},N1)}getLocalVideoTrackStats(){return this.localStats.get(Te.LocalVideoTrack)||gf({},D1)}getRemoteAudioTrackStats(o){const s=(h,p)=>{if(!this.trafficStats)return p;const g=this.trafficStats.peer_delay.find(y=>y.peer_uid===h);return g&&(p.publishDuration=g.B_ppad+(Date.now()-this.trafficStats.timestamp)),p},c={};if(o){var u;const h=(u=this.remoteStats.get(o))===null||u===void 0?void 0:u.audioStats;h&&(c[o]=s(o,h))}else Array.from(this.remoteStats.entries()).forEach(h=>{let[p,{audioStats:g}]=h;g&&(c[p]=s(p,g))});return c}getRemoteNetworkQualityStats(o){const s={};if(o){var c;const u=(c=this.remoteStats.get(o))===null||c===void 0?void 0:c.networkStats;u&&(s[o]=u)}else Array.from(this.remoteStats.entries()).forEach(u=>{let[h,{networkStats:p}]=u;p&&(s[h]=p)});return s}getRemoteVideoTrackStats(o){const s=(h,p)=>{if(!this.trafficStats)return p;const g=this.trafficStats.peer_delay.find(y=>y.peer_uid===h);return g&&(p.publishDuration=g.B_ppvd+(Date.now()-this.trafficStats.timestamp)),p},c={};if(o){var u;const h=(u=this.remoteStats.get(o))===null||u===void 0?void 0:u.videoStats;h&&(c[o]=s(o,h))}else Array.from(this.remoteStats.entries()).forEach(h=>{let[p,{videoStats:g}]=h;g&&(c[p]=s(p,g))});return c}getRTCStats(){let o=0,s=0,c=0,u=0;const h=this.localStats.get(Te.LocalAudioTrack);h&&(o+=h.sendBytes,s+=h.sendBitrate);const p=this.localStats.get(Te.LocalVideoTrack);p&&(o+=p.sendBytes,s+=p.sendBitrate);const g=this.localStats.get(Te.LocalVideoLowTrack);g&&(o+=g.sendBytes,s+=g.sendBitrate),this.remoteStats.forEach(b=>{let{audioStats:w,videoStats:C}=b;w&&(c+=w.receiveBytes,u+=w.receiveBitrate),C&&(c+=C.receiveBytes,u+=C.receiveBitrate)});let y=1;return this.trafficStats&&(y+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:y,SendBitrate:s,SendBytes:o,RecvBytes:c,RecvBitrate:u,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(o){this.localStats.set(o,void 0)}removeLocalStats(o){o?this.localStats.delete(o):this.localStats.clear()}addRemoteStats(o){this.remoteStats.set(o,{})}removeRemoteStats(o){o?this.remoteStats.delete(o):this.remoteStats.clear()}addP2PChannel(o){this.p2pChannel=o}updateTrafficStats(o){o.peer_delay=o.peer_delay.filter(s=>s.B_ppad!==void 0||s.B_ppvd!==void 0),o.peer_delay.filter(s=>this.trafficStatsPeerList.indexOf(s.peer_uid)===-1).forEach(s=>{var c;const u=(c=this.p2pChannel)===null||c===void 0?void 0:c.getRemoteMedia(s.peer_uid),h=u!=null&&u.videoSSRC?gi.measureFromSubscribeStart(this.store.clientId,u.videoSSRC):0,p=u!=null&&u.audioSSRC?gi.measureFromSubscribeStart(this.store.clientId,u.audioSSRC):0;s.B_ppad!==void 0&&s.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(s.peer_uid,s.B_ppad,s.B_ppvd,h>p?h:p),this.trafficStatsPeerList.push(s.peer_uid))}),this.trafficStats=o}updateUplinkStats(o){this.uplinkStats&&this.uplinkStats.B_fir!==o.B_fir&&L.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(o.B_fir)),this.uplinkStats=o}static isRemoteVideoFreeze(o,s,c){if(!o)return!1;const u=!!c&&s.framesDecodeFreezeTime>c.framesDecodeFreezeTime,h=!c||s.framesDecodeCount>c.framesDecodeCount;return u||!h}static isRemoteAudioFreeze(o){return!!o&&o._isFreeze()}isLocalVideoFreeze(o){return!(!o.inputFrame||!o.sentFrame)&&o.inputFrame.frameRate>5&&o.sentFrame.frameRate<3}updateLocalStats(o){Array.from(this.localStats.entries()).forEach(s=>{let[c,u]=s;switch(c){case Te.LocalVideoTrack:case Te.LocalVideoLowTrack:{const g=u,y=gf({},D1),b=o.getStats(),w=o.getLocalMedia(c);if(b){const C=b.videoSend.find(A=>A.ssrc===(w==null?void 0:w.ssrcs[0].ssrcId));if(C){const A=o.getLocalVideoSize(),x=o.getEncoderConfig(Te.LocalVideoTrack);var h;(C.codec==="H264"||C.codec==="H265"||C.codec==="VP8"||C.codec==="VP9"||C.codec==="AV1X"||C.codec==="AV1")&&(y.codecType=C.codec,(g==null?void 0:g.codecType)!==C.codec&&((h=this.onVideoCodecChanged)===null||h===void 0||h.call(this,C.codec.toLocaleLowerCase()))),y.sendBytes=C.bytes,y.sendBitrate=g?8*Math.max(0,y.sendBytes-g.sendBytes):0,C.inputFrame?(y.captureFrameRate=C.inputFrame.frameRate,y.captureResolutionHeight=C.inputFrame.height,y.captureResolutionWidth=C.inputFrame.width):A&&(y.captureResolutionWidth=A.width,y.captureResolutionHeight=A.height),C.sentFrame?(y.sendFrameRate=C.sentFrame.frameRate,y.sendResolutionHeight=C.sentFrame.height,y.sendResolutionWidth=C.sentFrame.width):A&&(y.sendResolutionWidth=A.width,y.sendResolutionHeight=A.height),C.avgEncodeMs&&(y.encodeDelay=C.avgEncodeMs),x&&x.bitrateMax?y.targetSendBitrate=1e3*x.bitrateMax:C.targetBitrate&&(y.targetSendBitrate=C.targetBitrate),y.sendPackets=C.packets,y.sendPacketsLost=C.packetsLost,y.sendJitterMs=C.jitterMs,y.sendRttMs=C.rttMs,y.totalDuration=g?g.totalDuration+1:1,y.totalFreezeTime=g?g.totalFreezeTime:0,this.isLocalVideoFreeze(C)&&(y.totalFreezeTime+=1),C.scalabilityMode&&this.scalabilityMode!==C.scalabilityMode&&(L.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(C.scalabilityMode)),this.scalabilityMode=C.scalabilityMode)}this.trafficStats&&(y.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var p;this.localStats.set(c,y),((g==null?void 0:g.sendResolutionWidth)!==y.sendResolutionWidth||(g==null?void 0:g.sendResolutionHeight)!==y.sendResolutionHeight)&&((p=this.onStatsChanged)===null||p===void 0||p.call(this,"resolution",{width:y.sendResolutionWidth,height:y.sendResolutionHeight})),y&&w&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,w.track,y);break}case Te.LocalAudioTrack:{const g=u,y=gf({},N1),b=o.getStats(),w=o.getLocalMedia(c);if(b){const C=b.audioSend.find(A=>A.ssrc===(w==null?void 0:w.ssrcs[0].ssrcId));if(C){if(C.codec!=="opus"&&C.codec!=="aac"&&C.codec!=="PCMU"&&C.codec!=="PCMA"&&C.codec!=="G722"||(y.codecType=C.codec),C.inputLevel)y.sendVolumeLevel=Math.round(32767*C.inputLevel);else{const A=o.getLocalAudioVolume();A&&(y.sendVolumeLevel=Math.round(32767*A))}y.sendBytes=C.bytes,y.sendPackets=C.packets,y.sendPacketsLost=C.packetsLost,y.sendJitterMs=C.jitterMs,y.sendRttMs=C.rttMs,y.sendBitrate=g?8*Math.max(0,y.sendBytes-g.sendBytes):0}}this.trafficStats&&(y.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(Te.LocalAudioTrack,y),y&&w&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,w.track,y);break}}})}updateRemoteStats(o){Array.from(this.remoteStats.entries()).forEach(s=>{var c,u;let[h,{videoStats:p,audioStats:g,videoPcStats:y}]=s;const b=g,w=p,C=y,A=gf({},eH),x=gf({},tH),B=gf({},mIe),{audioTrack:U,videoTrack:F,audioSSRC:K,videoSSRC:z}=o.getRemoteMedia(h);let Q;Q=this.store.useP2P?o.getStats(!0):o.getStats();const ie=(c=Q)===null||c===void 0?void 0:c.audioRecv.find(Ee=>Ee.ssrc===K),oe=(u=Q)===null||u===void 0?void 0:u.videoRecv.find(Ee=>Ee.ssrc===z),re=this.trafficStats&&this.trafficStats.peer_delay.find(Ee=>Ee.peer_uid===h);if(ie&&(ie.codec!=="opus"&&ie.codec!=="aac"&&ie.codec!=="PCMU"&&ie.codec!=="PCMA"&&ie.codec!=="G722"||(A.codecType=ie.codec),ie.outputLevel?A.receiveLevel=Math.round(32767*ie.outputLevel):U&&(A.receiveLevel=Math.round(32767*U.getVolumeLevel())),A.receiveBytes=ie.bytes,A.receivePackets=ie.packets,A.receivePacketsLost=ie.packetsLost,A.receivePacketsDiscarded=ie.packetsDiscarded,A.packetLossRate=A.receivePacketsLost/(A.receivePackets+A.receivePacketsLost),A.receiveBitrate=b?8*Math.max(0,A.receiveBytes-b.receiveBytes):0,A.totalDuration=b?b.totalDuration+1:1,A.totalFreezeTime=b?b.totalFreezeTime:0,A.freezeRate=A.totalFreezeTime/A.totalDuration,A.receiveDelay=ie.jitterBufferMs,A.totalDuration>10&&R_.isRemoteAudioFreeze(U)&&(A.totalFreezeTime+=1)),oe){var me;oe.codec!=="H264"&&oe.codec!=="H265"&&oe.codec!=="VP8"&&oe.codec!=="VP9"&&oe.codec!=="AV1X"&&oe.codec!=="AV1"||(x.codecType=oe.codec),x.receiveBytes=oe.bytes,x.receiveBitrate=w?8*Math.max(0,x.receiveBytes-w.receiveBytes):0,x.decodeFrameRate=oe.decodeFrameRate<0?0:oe.decodeFrameRate,x.renderFrameRate=oe.decodeFrameRate<0?0:oe.decodeFrameRate,oe.outputFrame&&(x.renderFrameRate=oe.outputFrame.frameRate),oe.receivedFrame?(x.receiveFrameRate=oe.receivedFrame.frameRate,x.receiveResolutionHeight=oe.receivedFrame.height,x.receiveResolutionWidth=oe.receivedFrame.width):F&&(x.receiveResolutionHeight=F._videoHeight||0,x.receiveResolutionWidth=F._videoWidth||0),oe.framesRateFirefox!==void 0&&(x.receiveFrameRate=Math.round(oe.framesRateFirefox)),x.receivePackets=oe.packets,x.receivePacketsLost=oe.packetsLost,x.packetLossRate=x.receivePacketsLost/(x.receivePackets+x.receivePacketsLost);const Ee=w?w.totalFreezeTime:0,xe=w?w.totalDuration:0;x.totalDuration=w?w.totalDuration+1:1,x.totalFreezeTime=(me=oe.totalFreezesDuration)!==null&&me!==void 0?me:Ee||0,x.receiveDelay=oe.jitterBufferMs||0;const Me=!!z&&o.getRemoteVideoIsReady(z);oe.totalFreezesDuration===void 0&&F&&Me&&R_.isRemoteVideoFreeze(F,oe,C)&&(x.totalFreezeTime+=1),x.freezeRate=Math.max(0,Math.min((x.totalFreezeTime-Ee)/(x.totalDuration-xe),1))}re&&(A.end2EndDelay=re.B_ad,x.end2EndDelay=re.B_vd,A.transportDelay=re.B_ed,x.transportDelay=re.B_ed,A.currentPacketLossRate=re.B_ealr4/100,x.currentPacketLossRate=re.B_evlr4/100,B.uplinkNetworkQuality=re.B_punq?re.B_punq:0,B.downlinkNetworkQuality=re.B_pdnq?re.B_pdnq:0),this.remoteStats.set(h,{audioStats:A,videoStats:x,videoPcStats:oe,networkStats:B}),U&&this.exceptionMonitor.setRemoteAudioStats(U,A),F&&this.exceptionMonitor.setRemoteVideoStats(F,x)})}}class aY{constructor(){G(this,"destChannelMediaInfos",new Map),G(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(o){pz(o),this.srcChannelMediaInfo=o}addDestChannelInfo(o){pz(o),this.destChannelMediaInfos.set(o.channelName,o)}removeDestChannelInfo(o){iT(o),this.destChannelMediaInfos.delete(o)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function cY(r){if(!(r instanceof aY))return new pe(Y.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const o=r.getSrcChannelMediaInfo(),s=r.getDestChannelMediaInfo();if(!o)return new pe(Y.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(s.size===0)return new pe(Y.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class _d{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(o,s){G(this,"uid",void 0),G(this,"_uintid",void 0),G(this,"_trust_in_room_",!0),G(this,"_trust_audio_enabled_state_",!0),G(this,"_trust_video_enabled_state_",!0),G(this,"_trust_audio_mute_state_",!0),G(this,"_trust_video_mute_state_",!0),G(this,"_audio_muted_",!1),G(this,"_video_muted_",!1),G(this,"_audio_enabled_",!0),G(this,"_video_enabled_",!0),G(this,"_audio_added_",!1),G(this,"_video_added_",!1),G(this,"_is_pre_created",!1),G(this,"_video_pre_subscribed",!1),G(this,"_audio_pre_subscribed",!1),G(this,"_trust_video_stream_added_state_",!0),G(this,"_trust_audio_stream_added_state_",!0),G(this,"_audioTrack",void 0),G(this,"_videoTrack",void 0),G(this,"_dataChannels",[]),G(this,"_audioSSRC",void 0),G(this,"_videoSSRC",void 0),G(this,"_audioOrtc",void 0),G(this,"_videoOrtc",void 0),G(this,"_cname",void 0),G(this,"_rtxSsrcId",void 0),G(this,"_videoMid",void 0),G(this,"_audioMid",void 0),this.uid=o,this._uintid=s}}function lY(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function uY(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?lY(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):lY(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}const A_="9",dY=4e4;function hY(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function Jl(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?hY(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):hY(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}var Wm=function(r){return r[r.DOWN=0]="DOWN",r[r.UP=1]="UP",r}(Wm||{});const yT=new Map;function fY(r,o,s,c){let{scale:u}=r;if(u===0&&c===Wm.UP||u>=o.length-1&&c===Wm.DOWN)return r;let h=Jl(Jl({},r),{},{scale:c===Wm.DOWN?++u:--u});switch(s){case"maintain-framerate":h=Jl(Jl({},h),o[u].motion);break;case"maintain-resolution":h=Jl(Jl({},h),o[u].detail);break;case"balanced":h=Jl(Jl({},h),o[u].balanced)}return h}function pY(r,o){if(o){const s={overUse:0,underUse:0,adaptationList:mY(o)};yT.set(r,s)}else yT.delete(r)}function mY(r){const o=Jl({},r),{bitrateMax:s,frameRate:c,scaleResolutionDownBy:u,bitrateMin:h}=o,{MIN_FRAME_RATE:p,MAX_THRESHOLD_FRAMERATE:g,MAX_SCALE:y,BITRATE_MIN_THRESHOLD:b,BITRATE_MAX_THRESHOLD:w,BWE_SCALE_UP_THRESHOLD:C,BWE_SCALE_DOWN_THRESHOLD:A,PERF_SCALE_DOWN_THRESHOLD:x,PERF_SCALE_UP_THRESHOLD:B,BALANCE_BITRATE_FACTOR:U,BALANCE_FRAMERATE_FACTOR:F,BALANCE_RESOLUTION_FACTOR:K,MOTION_RESOLUTION_FACTOR:z,MOTION_BITRATE_FACTOR:Q,DETAIL_FRAMERATE_FACTOR:ie,DETAIL_BITRATE_FACTOR:oe}=C1,re=Math.min(o.frameRate,g),me=[{scale:0,threshold:{bwe_down:Math.round(Math.pow(A,1)*s),bwe_up:s,fps_down:Math.round(Math.pow(x,1)*re),fps_up:c},balanced:{scaleResolutionDownBy:1,frameRate:c,bitrateMax:s,bitrateMin:h},motion:{scaleResolutionDownBy:1,frameRate:c,bitrateMax:s,bitrateMin:h},detail:{scaleResolutionDownBy:1,frameRate:c,bitrateMax:s,bitrateMin:h}}];for(let Ee=1;Ee<=y;Ee++){const xe={bwe_up:Math.round(Math.pow(C,Ee)*s),bwe_down:Math.round(Math.pow(A,Ee+1)*s),fps_up:Math.round(Math.pow(B,Ee)*re),fps_down:Math.round(Math.pow(x,Ee+1)*re)},Me={scaleResolutionDownBy:u/Math.pow(K,Ee),frameRate:Math.max(Math.round(Math.pow(F,Ee)*c),p),bitrateMax:Math.max(Math.round(Math.pow(U,Ee)*s),w),bitrateMin:Math.max(Math.round(Math.pow(U,Ee)*h),b)},pt={scaleResolutionDownBy:u/Math.pow(z,Ee),frameRate:c,bitrateMax:Math.max(Math.round(Math.pow(Q,Ee)*s),w),bitrateMin:Math.max(Math.round(Math.pow(Q,Ee)*h),b)},ut={scaleResolutionDownBy:1,frameRate:Math.max(Math.round(Math.pow(ie,Ee)*c),p),bitrateMax:Math.max(Math.round(Math.pow(oe,Ee)*s),w),bitrateMin:Math.max(Math.round(Math.pow(oe,Ee)*h),b)};me.push({scale:Ee,threshold:xe,balanced:Me,motion:pt,detail:ut})}return me}function Dxe(r,o,s,c,u,h){const p=yT.get(r)||{overUse:0,underUse:0,adaptationList:mY(u)},{adaptationList:g}=p;yT.set(r,p);const{OVERUSE_TIMES_THRESHOLD:y,UNDERUSE_TIMES_THRESHOLD:b}=C1,{scale:w}=c;let C,A;return typeof o=="number"&&o>0&&function(x,B,U,F){if(B>=U.length)return!1;let{threshold:{fps_down:K}}=U[B];return q("FORCE_AG_HIGH_FRAMERATE")&&F==="maintain-framerate"&&(K=U[0].threshold.fps_down),x<K}(o,w,g,h)&&(p.overUse++,A=u_.CPU,p.overUse>y)||typeof s=="number"&&s>0&&function(x,B,U){if(B>=U.length)return!1;const{threshold:{bwe_down:F}}=U[B];return x<F}(s,w,g)&&(p.overUse++,A=u_.BANDWIDTH,p.overUse>y)?(p.overUse=0,p.underUse=0,C=fY(c,g,h,Wm.DOWN),[C,A]):(typeof o=="number"&&o>0&&typeof s=="number"&&s>0&&function(x,B,U,F){if(B===0)return;let{threshold:{fps_up:K}}=U[B];return q("FORCE_AG_HIGH_FRAMERATE")&&F==="maintain-framerate"&&(K=U[1].threshold.fps_up),x>K}(o,w,g,h)&&function(x,B,U){if(B===0)return;const{threshold:{bwe_up:F}}=U[B];return x>F}(s,w,g)&&(p.underUse++,p.underUse>b&&(p.overUse=0,p.underUse=0,C=fY(c,g,h,Wm.UP),C.scale===0&&(A=u_.NONE))),[C,A])}function gY(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function SD(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?gY(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):gY(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}function kxe(r){var o;return!!q("ENABLE_AG_ADAPTATION")&&!!(r instanceof $1||Pe(o=r._hints).call(o,Zt.CUSTOM_TRACK))&&(!!q("FORCE_SUPPORT_AG_ADAPTATION")||!!(function(s){const c=It();if(c.os!==Rr.IOS||!c.osVersion)return!1;const u=c.osVersion.split(".");return Number(u[0])>=s}(14)&&d8(17,4)||u8(14)&&h8(17,4,!0)))}const _T=new Map;function ET(r,o){const s=_T.get(r);if(s){const{timer:c}=s;window.clearTimeout(c),_T.delete(r)}o.qualityLimitationReason=u_.NONE,pY(r)}function Lxe(r,o){var s;let c;switch(o){case Te.LocalAudioTrack:c=Ht.Audio;break;case Te.LocalVideoTrack:c=Pe(s=r._hints).call(s,Zt.SCREEN_TRACK)?Ht.Screen:Ht.High;break;case Te.LocalVideoLowTrack:c=Ht.Low}return c}function wD(r){const o=xt();if(r.some(s=>s._bypassWebAudio))throw new ve(Y.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");if(!o.webAudioMediaStreamDest)throw new ve(Y.NOT_SUPPORTED,"cannot publish multiple tracks because your browser does not support audio mixing")}function TD(r,o){wD(r);const s=new lr;return r.forEach(c=>s.addAudioTrack(c)),s}const Mxe=!xt().supportUnifiedPlan||q("CHROME_FORCE_PLAN_B")&&Wl();function bT(r){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var s;return Mxe?(s={spec:o,store:r},Xl("PlanBConnection").create(s)):new tl(o,r)}function CD(r){return r&&(r.iceConnectionState==="disconnected"||r.iceConnectionState==="checking"||r.iceConnectionState==="failed")}function vY(r){try{if(r.iceServers)return!1;if(r.turnServer&&r.turnServer.mode!=="off"){if(a_(r.turnServer.servers))return!1;if(q("FORCE_TURN_TCP")||r.turnServer.servers.concat(r.turnServer.serversFromGateway||[]).some(o=>o.forceturn))return!0}return!1}catch{return!1}}var Ct;function yY(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function cc(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?yY(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):yY(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}let tl=(Ct=class Wf extends yz{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var o,s;return(o=(s=this.peerConnection.getReceivers()[0])===null||s===void 0||(s=s.transport)===null||s===void 0?void 0:s.state)!==null&&o!==void 0?o:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map(o=>o.rtpMap&&o.rtpMap.encodingName.toLowerCase()||"").filter(o=>{var s;return Pe(s=Object.keys(Bw)).call(s,o)}))]}constructor(o,s){super(o,s),G(this,"id",cn(5,"connection-")),G(this,"store",void 0),G(this,"peerConnection",void 0),G(this,"forceTurn",!1),G(this,"remoteSDP",void 0),G(this,"initialOffer",void 0),G(this,"transportEventReceiver",void 0),G(this,"statsFilter",void 0),G(this,"extension",{useXR:q("USE_XR")}),G(this,"localCapabilities",void 0),G(this,"remoteCodecs",void 0),G(this,"localCandidateCount",0),G(this,"allCandidatesReceived",!1),G(this,"isPreallocation",!1),G(this,"preSSRCMap",new Map),G(this,"dataStreamChannelMap",new Map),G(this,"establishPromise",void 0),G(this,"recoveredDataChannelIds",[]),G(this,"currentDataChannelId",1),G(this,"supportAV1RtpSpec",!1),G(this,"mutex",void 0),G(this,"qualityLimitationReason",u_.NONE),G(this,"isFirstConnected",!1),this.store=s,this.forceTurn=vY(o),this.mutex=new fi("P2PConnection-mutex",s.clientId),this.peerConnection=new RTCPeerConnection(Wf.resolvePCConfiguration(o),{optional:[{googDscp:!0}]}),this.isFirstConnected=!1,this.statsFilter=S1(this.peerConnection,q("STATS_UPDATE_INTERVAL"),void 0,xn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}getPreMedia(o){const s=this.preSSRCMap.get(o);if(s!==void 0){const c=this.peerConnection.getTransceivers().find(u=>u.mid===s);if(c)return{transceiver:c,track:c.receiver.track,id:s}}}async updateRemoteRTPCapabilities(o,s){if(this.remoteCodecs=s,!this.remoteSDP)return void L.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(s));if(this.remoteSDP.updateRemoteCodec(o,s,this.store.codec)){const c=await this.peerConnection.createOffer(),u=this.logSDPExchange(c.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(c);const h=this.remoteSDP.toString();u==null||u(h),await this.peerConnection.setRemoteDescription({type:"answer",sdp:h})}else L.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.")}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const c=await this.peerConnection.createOffer();if(!c.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const u=vd(c.sdp),h=await jz({filterRTX:!q("USE_PUB_RTX")&&!q("USE_SUB_RTX"),filterVideoFec:q("FILTER_VIDEO_FEC"),filterAudioFec:q("FILTER_AUDIO_FEC"),filterVideoCodec:q("FILTER_VIDEO_CODEC")},this.extension);if(this.localCapabilities=fT(h),this.initialOffer=c,q("ENABLE_SVC")&&this.store.codec=="av1"){const g=await async function(){try{const y=new RTCPeerConnection;y.addTransceiver("video",{direction:"sendonly",sendEncodings:[{scalabilityMode:Vw.L1T3}]});const b=await y.createOffer();if(!b.sdp)return void y.close();const w=ho(b.sdp).mediaDescriptions[0];if(!w)return;const C=w.attributes.extmaps.find(A=>A.extensionName==="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension");return y.close(),C}catch{return}}();var o;g&&(this.supportAV1RtpSpec=!0,(o=h.send)===null||o===void 0||o.videoExtensions.push(g))}let p;return c.sdp&&Bz(c.sdp)&&(p=On(h),(s=p).send&&(Um(je.VIDEO,s.send.videoExtensions),Um(je.AUDIO,s.send.audioExtensions)),s.recv&&(Um(je.VIDEO,s.recv.videoExtensions),Um(je.AUDIO,s.recv.audioExtensions)),s.sendrecv&&(Um(je.VIDEO,s.sendrecv.videoExtensions),Um(je.AUDIO,s.sendrecv.audioExtensions))),cc(cc({},u),{},{rtpCapabilities:p||h,offerSDP:c.sdp})}catch(c){throw new ve(Y.GET_LOCAL_CONNECTION_PARAMS_FAILED,c.toString())}var s}async connect(o){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.initialOffer.sdp&&Bz(this.initialOffer.sdp)&&(s=o.rtpCapabilities,c=this.localCapabilities,s.send&&(uT(je.VIDEO,s.send.videoExtensions,c.send.videoExtensions),uT(je.AUDIO,s.send.audioExtensions,c.send.audioExtensions)),s.recv&&(uT(je.VIDEO,s.recv.videoExtensions,c.recv.videoExtensions),uT(je.AUDIO,s.recv.audioExtensions,c.recv.audioExtensions))),this.remoteSDP=new class{get localCapabilities(){return On(this._localCapabilities)}get rtpCapabilities(){return On(this._rtpCapabilities)}get candidates(){return On(this._candidates)}get iceParameters(){return On(this._iceParameters)}get dtlsParameters(){return On(this._dtlsParameters)}constructor(b){let w=arguments.length>1&&arguments[1]!==void 0&&arguments[1];G(this,"sessionDesc",void 0),G(this,"_localCapabilities",void 0),G(this,"_rtpCapabilities",void 0),G(this,"_candidates",void 0),G(this,"_originCandidates",void 0),G(this,"_iceParameters",void 0),G(this,"_isUseExtmapAllowMixed",void 0),G(this,"_dtlsParameters",void 0),G(this,"setup",void 0),G(this,"currentMidIndex",void 0),G(this,"cname",void 0),G(this,"firefoxSsrcMidMap",new Map),this._isUseExtmapAllowMixed=w,b=On(b);const{iceParameters:C,dtlsParameters:A,candidates:x,rtpCapabilities:B,setup:U,localCapabilities:F,cname:K}=b;this._rtpCapabilities=B,this._candidates=x,this._originCandidates=On(x),this._iceParameters=C,this._dtlsParameters=A,this._localCapabilities=F,this.setup=U,this.cname=K,this.sessionDesc=this.updateRemoteRTPCapabilities(B),this.currentMidIndex=this.sessionDesc.mediaDescriptions.length-1}preloadRemoteMedia(b){const w=this.candidates,C=this.dtlsParameters,A=this.iceParameters,x=this.rtpCapabilities.send;let B=this.sessionDesc.mediaDescriptions.length-1;for(let U=1;U<b;U++){const F=2*U+2e4,K=2*U+dY,{ssrcs:z,ssrcGroups:Q}=mf([{ssrcId:F}],this.cname),{ssrcs:ie,ssrcGroups:oe}=mf([{ssrcId:K,rtx:q("USE_SUB_RTX")?K+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:A_,protos:["UDP","TLS","RTP","SAVPF"],fmts:x.videoCodecs.map(re=>re.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:A.iceUfrag,icePwd:A.icePwd,unrecognized:[],candidates:w,extmaps:x.videoExtensions,fingerprints:C.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:ie,ssrcGroups:oe,rtcpFeedbackWildcards:[],payloads:x.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++B)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:A_,protos:["UDP","TLS","RTP","SAVPF"],fmts:x.audioCodecs.map(re=>re.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:A.iceUfrag,icePwd:A.icePwd,unrecognized:[],candidates:w,extmaps:x.audioExtensions,fingerprints:C.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:z,ssrcGroups:Q,rtcpFeedbackWildcards:[],payloads:x.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(++B)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return hd(this.sessionDesc)}send(b,w,C,A){const{ssrcs:x,ssrcGroups:B}=mf(w,this.cname,q("SYNC_GROUP")?C:void 0),U=this.findPreloadMediaDesc(x);if(U){if(xn()&&this.firefoxSsrcMidMap.set(x[0].ssrcId,U.attributes.mid),A&&(A.twcc||A.remb)){const F=this.sessionDesc.mediaDescriptions.indexOf(U);return this.sessionDesc.mediaDescriptions[F]=this.mungSendMediaDesc(U,A),{mid:U.attributes.mid,needExchangeSDP:!0}}return{mid:U.attributes.mid,needExchangeSDP:!1}}{const F=this.findAvailableMediaIndex(b,x);let K;return F===-1||F===1&&(ri()||function(){const z=It();return!(z.name!==Mt.CHROME||!z.osVersion)&&Number(z.version)<=90}()||q("ENABLE_ENCODED_TRANSFORM")&&$l())||F===0&&q("USE_SUB_RTX")||f8()?(K=this.createOrRecycleSendMedia(b,x,B,"sendonly",A),this.updateBundleMids()):(K=On(this.sessionDesc.mediaDescriptions[F]),K.attributes.direction="sendonly",K.attributes.ssrcs=x,K.attributes.ssrcGroups=B,this.sessionDesc.mediaDescriptions[F]=this.mungSendMediaDesc(K,A)),xn()&&this.firefoxSsrcMidMap.set(x[0].ssrcId,K.attributes.mid),{mid:K.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:b,needExchangeSDP:w}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:b.attributes.mid,needExchangeSDP:w}}batchSend(b){const w=b.map(x=>{let{kind:B,ssrcMsg:U,mslabel:F}=x;return this.send(B,U,F)}),C=[];let A=!1;return w.forEach(x=>{let{mid:B,needExchangeSDP:U}=x;U&&(A=!0),C.push(B)}),{mids:C,needExchangeSDP:A}}stopSending(b){const w=this.sessionDesc.mediaDescriptions.filter(C=>C.attributes.mid&&b.indexOf(C.attributes.mid)!==-1);if(w.length!==b.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");w.forEach(C=>{C.attributes.mid==="0"||xn()||f8()?C.attributes.ssrcs=[]:(C.attributes.ssrcs=[],C.attributes.direction="inactive",C.media.port="0")}),this.updateBundleMids()}mute(b){const w=this.sessionDesc.mediaDescriptions.find(C=>C.attributes.mid===b);if(!w)throw new Error("mediaDescription not found with ".concat(b," in remote SDP when calling RemoteSDP.mute."));w.attributes.direction="inactive"}unmute(b){const w=this.sessionDesc.mediaDescriptions.find(C=>C.attributes.mid===b);if(!w)throw new Error("mediaDescription not found with ".concat(b," in remote SDP when calling RemoteSDP.unmute."));w.attributes.direction="sendonly"}muteRemote(b){const w=this.sessionDesc.mediaDescriptions.filter(C=>Pe(b).call(b,C.attributes.mid||""));if(w.length!==b.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");w.forEach(C=>{C.attributes.direction="inactive"})}unmuteRemote(b){const w=this.sessionDesc.mediaDescriptions.filter(C=>Pe(b).call(b,C.attributes.mid||""));if(w.length!==b.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");w.forEach(C=>{C.attributes.direction="recvonly"})}receive(b,w,C,A){b.forEach((x,B)=>{this.createOrRecycleRecvMedia(x,[],"recvonly",w,C,A[B])}),this.updateBundleMids()}stopReceiving(b){const w=this.sessionDesc.mediaDescriptions.filter(C=>b.indexOf(C.attributes.mid)!==-1);if(w.length!==b.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");w.forEach(C=>{C.media.port="0",C.attributes.direction="inactive"}),this.updateBundleMids()}updateRemoteRTPCapabilities(b){const w=this.sessionDesc||ho((C=this._isUseExtmapAllowMixed,`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite`.concat(C?`
a=extmap-allow-mixed`:"",`
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`)));var C;this._rtpCapabilities=b;const A=this.rtpCapabilities.send,x=this.localCapabilities.send;for(const B of w.mediaDescriptions){if(B.attributes.iceUfrag=this._iceParameters.iceUfrag,B.attributes.icePwd=this._iceParameters.icePwd,B.attributes.fingerprints=this._dtlsParameters.fingerprints,B.attributes.candidates=this._candidates,B.attributes.setup=this.setup,B.media.mediaType==="application"&&(B.attributes.sctpPort="5000"),B.media.mediaType==="video"){if(A.videoCodecs.length===0){const U=x.videoCodecs.filter(F=>{var K,z;return(K=F.rtpMap)===null||K===void 0?void 0:Pe(z=K.encodingName.toLowerCase()).call(z,"vp8")})||[x.videoCodecs[0]];B.media.fmts=U.map(F=>F.payloadType.toString(10)),B.attributes.payloads=U,B.attributes.extmaps=[]}else if(B.media.fmts=A.videoCodecs.map(U=>U.payloadType.toString(10)),B.attributes.payloads=A.videoCodecs,B.attributes.extmaps=A.videoExtensions,q("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:U,ssrcGroups:F}=mf([{ssrcId:dY,rtx:q("USE_SUB_RTX")?40001:void 0}],this.cname);B.attributes.ssrcs=U,B.attributes.ssrcGroups=F}}if(B.media.mediaType==="audio"){if(A.audioCodecs.length===0){const U=x.audioCodecs.filter(F=>{var K,z;return(K=F.rtpMap)===null||K===void 0?void 0:Pe(z=K.encodingName.toLowerCase()).call(z,"opus")})||[x.audioCodecs[0]];B.media.fmts=U.map(F=>F.payloadType.toString(10)),B.attributes.payloads=U,B.attributes.extmaps=[]}else if(B.media.fmts=A.audioCodecs.map(U=>U.payloadType.toString(10)),B.attributes.payloads=A.audioCodecs,B.attributes.extmaps=A.audioExtensions,Fm(B),q("PRELOAD_MEDIA_COUNT")>0){const{ssrcs:U,ssrcGroups:F}=mf([{ssrcId:2e4}],this.cname);B.attributes.ssrcs=U,B.attributes.ssrcGroups=F}}}return this.sessionDesc=w,this.currentMidIndex=w.mediaDescriptions.length-1,this.sessionDesc}updateCandidates(b){const w=this._originCandidates.filter(A=>A.transport==="udp"),C=[];if(w.forEach(A=>{C.push(uY(uY({},A),{},{foundation:"tcpcandidate",priority:Number(A.priority)-1+"",transport:"tcp",port:Number(A.port)+90+""}))}),w.length!==0){switch(b){case mi.TCP_RELAY:this._candidates=C;break;case mi.UDP_TCP_RELAY:case mi.RELAY:this._candidates=[...w,...C];break;default:this._candidates=w}for(const A of this.sessionDesc.mediaDescriptions)A.attributes.candidates=this.candidates}}restartICE(b){b=On(b),this._iceParameters=b,this.sessionDesc.mediaDescriptions.forEach(w=>{w.attributes.iceUfrag=b.iceUfrag,w.attributes.icePwd=b.icePwd})}predictReceivingMids(b){const w=[];for(let C=0;C<b;C++)w.push((this.currentMidIndex+C+1).toString(10));return w}findAvailableMediaIndex(b,w){return this.sessionDesc.mediaDescriptions.findIndex(C=>{const A=C.media.mediaType===b&&C.media.port!=="0"&&(C.attributes.direction==="sendonly"||C.attributes.direction==="sendrecv")&&C.attributes.ssrcs.length===0;if(xn()){if(A){const x=this.firefoxSsrcMidMap.get(w[0].ssrcId);return!(x||C.attributes.mid!=="0"&&C.attributes.mid!=="1")||!(!x||x!==C.attributes.mid)}return!1}return A})}createOrRecycleDataChannel(){for(const C of this.sessionDesc.mediaDescriptions)if(C.media.mediaType==="application")return{mediaDesc:C,needExchangeSDP:!1};this.currentMidIndex+=1;const b="".concat(this.currentMidIndex),w={media:{mediaType:"application",port:A_,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(b),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(w),{mediaDesc:w,needExchangeSDP:!0}}createOrRecycleRecvMedia(b,w,C,A,x,B){const U=b._mediaStreamTrack.kind,F=this.rtpCapabilities.recv,K=S_(U,F,this.localCapabilities.send,U===je.VIDEO?A:x),z=U===je.VIDEO?F.videoExtensions:F.audioExtensions;this.currentMidIndex+=1;const Q="".concat(this.currentMidIndex);let ie={media:{mediaType:U,port:A_,protos:["UDP","TLS","RTP","SAVPF"],fmts:K.map(re=>re.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:z,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:w,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:K,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:C,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(Q)}};ie=this.mungRecvMediaDsec(ie,b,B);const oe=this.findFirstClosedMedia(U);if(oe){const re=this.sessionDesc.mediaDescriptions.indexOf(oe);this.sessionDesc.mediaDescriptions[re]=ie}else this.sessionDesc.mediaDescriptions.push(ie);return ie}updateRemoteCodec(b,w,C){const A=[...new Set(this._rtpCapabilities.recv.videoCodecs.map(ie=>ie.rtpMap&&ie.rtpMap.encodingName.toLowerCase()||"").filter(ie=>{var oe;return Pe(oe=Object.keys(Bw)).call(oe,ie)}))],x=new Set(w);if(A.every(ie=>x.has(ie)))return L.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(w)),!1;const B=this._rtpCapabilities.recv.videoCodecs.filter(ie=>w.some(oe=>{var re;return Pe(re=ie.rtpMap&&ie.rtpMap.encodingName.toLowerCase()||"").call(re,oe)}));if(B.length===0)return L.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(A," codecs: ").concat(w)),!1;const U=[...new Set(B.map(ie=>ie.rtpMap&&ie.rtpMap.encodingName.toLowerCase()||""))];let F;if(L.debug("updateRemoteCodec, from ".concat(A," to ").concat(U)),b.length===0)F=this.sessionDesc.mediaDescriptions.filter(ie=>ie.media.mediaType==="video"&&ie.attributes.direction==="recvonly");else if(F=this.sessionDesc.mediaDescriptions.filter(ie=>ie.attributes.mid&&ie.media.mediaType==="video"&&Pe(b).call(b,ie.attributes.mid)&&ie.attributes.direction==="recvonly"),F.length!==b.length)return L.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(b,", codecs: ").concat(w)),!1;if(q("USE_PUB_RTX")||q("USE_SUB_RTX")){const ie=dD(B,this.rtpCapabilities.recv.videoCodecs);B.push(...ie)}this._rtpCapabilities.recv.videoCodecs=B;const K=this.localCapabilities.send,z=this.rtpCapabilities.recv,Q=S_(je.VIDEO,z,K,C);return F.forEach(ie=>{const oe=Q.map(re=>re.payloadType.toString(10));L.debug("updateRemoteCodec mid: ".concat(ie.attributes.mid,", from"),ie.attributes.payloads,"to",Q),ie.attributes.payloads=Q,ie.media.fmts=oe}),!0}createOrRecycleSendMedia(b,w,C,A,x){const B=this.rtpCapabilities.send,U=b===je.VIDEO?B.videoCodecs:B.audioCodecs,F=b===je.VIDEO?B.videoExtensions:B.audioExtensions;this.currentMidIndex+=1;const K="".concat(this.currentMidIndex);let z={media:{mediaType:b,port:A_,protos:["UDP","TLS","RTP","SAVPF"],fmts:U.map(ie=>ie.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:F,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:w,ssrcGroups:C,rtcpFeedbackWildcards:[],payloads:U,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:A,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(K)}};z=this.mungSendMediaDesc(z,x);const Q=this.findFirstClosedMedia(b);if(Q){const ie=this.sessionDesc.mediaDescriptions.indexOf(Q);this.sessionDesc.mediaDescriptions[ie]=z}else this.sessionDesc.mediaDescriptions.push(z);return z}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(b=>b.media.port!=="0").map(b=>b.attributes.mid)}mungRecvMediaDsec(b,w,C){const A=On(b);return lD(A),Vm(A,w),uD(A,w),Lz(A),hT(A,C,this.localCapabilities.send),A}mungSendMediaDesc(b,w){const C=On(b);return hT(C,w,this.localCapabilities.recv),Fm(C),C}updateRecvMedia(b,w){const C=this.sessionDesc.mediaDescriptions.findIndex(A=>A.attributes.mid===b);if(C!==-1){const A=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[C],w);this.sessionDesc.mediaDescriptions[C]=A}}bumpMid(b){this.currentMidIndex+=b}findFirstClosedMedia(b){return this.sessionDesc.mediaDescriptions.find(w=>xn()?w.media.port==="0"&&w.media.mediaType===b:w.media.port==="0")}findPreloadMediaDesc(b){return this.sessionDesc.mediaDescriptions.find(w=>{var C;return((C=w.attributes)===null||C===void 0||(C=C.ssrcs[0])===null||C===void 0?void 0:C.ssrcId)===b[0].ssrcId})}getSSRC(b){var w;return(w=this.sessionDesc.mediaDescriptions.find(C=>C.attributes.mid===b))===null||w===void 0?void 0:w.attributes.ssrcs}}(cc(cc({},o),{},{localCapabilities:this.localCapabilities}),this.supportAV1RtpSpec),o.preallocation&&(this.isPreallocation=!0),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const u=this.remoteSDP.toString(),h=Vz(this.initialOffer.sdp,this.extension),p=this.logSDPExchange(h||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:h}),p==null||p(u),await this.peerConnection.setRemoteDescription({type:"answer",sdp:u});const g=this.peerConnection.getTransceivers()[0];if(g!=null&&g.receiver&&this.tryBindTransportEvents(g.receiver),q("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia(q("PRELOAD_MEDIA_COUNT"));const b=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:b});const w=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(w)}const{preSSRCs:y}=o;if(Array.isArray(y)&&y.length>0){const{mids:b}=this.remoteSDP.batchSend(y.map(w=>({kind:w.kind,ssrcMsg:[{ssrcId:w.ssrcId,rtx:w.rtx}],mslabel:w.mslabel})));b.forEach((w,C)=>{this.preSSRCMap.set(y[C].ssrcId,w)}),await w_(this.peerConnection,this.remoteSDP,this.extension),L.debug("[".concat(this.store.clientId,"] [P2PConnection] pre-batchReceive exchange SDP."))}}catch(u){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(u.toString()))}var s,c}async updateRemoteConnect(o){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateRemoteConnect before remote SDP created");const{rtpCapabilities:s}=o;this.remoteSDP.updateRemoteRTPCapabilities(s),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const{preSSRCs:c}=o;if(Array.isArray(c)&&c.length>0){const{mids:u}=this.remoteSDP.batchSend(c.map(h=>Object.assign({},{kind:h.kind,ssrcMsg:[{ssrcId:h.ssrcId,rtx:h.rtx}],mslabel:h.mslabel})));u.forEach((h,p)=>{this.preSSRCMap.set(c[p].ssrcId,h)})}await w_(this.peerConnection,this.remoteSDP,this.extension),L.debug("[P2PConnection] updateRemoteRTPCapabilities by exchanging SDP.")}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.updateRemoteConnect failed; ".concat(s.toString()))}}send(o,s,c){var u=this;return Is(function*(){const h=yield Ot(u.mutex.lock("From P2PConnection.send"));try{if(!u.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const p=[],g=lT();o.forEach(F=>{const K=u.peerConnection.addTransceiver(F._mediaStreamTrack,cc({direction:"sendonly"},F.trackMediaType==="video"&&u.supportAV1RtpSpec&&g?{sendEncodings:[{scalabilityMode:g}]}:{}));p.push(K),F._updateRtpTransceiver(K)}),xn()&&q("SIMULCAST")===!0&&(yield Ot(u.applySimulcastForFirefox(p,o)));const y=yield Ot(u.peerConnection.createOffer()),b=u.remoteSDP.predictReceivingMids(o.length),w=u.mungSendOfferSDP(y.sdp,o,b),C=ho(w),A=b.map(F=>{const K=C.mediaDescriptions.find(z=>z.attributes.mid===F);if(!K)throw new Error("Cannot extract ssrc from mediaDescription.");return Nz(K,q("USE_PUB_RTX"))});let x;try{x=yield A}catch(F){x=[],u.remoteSDP.receive(o,s,c,x);const K=u.remoteSDP.toString();throw yield Ot(u.peerConnection.setLocalDescription({type:"offer",sdp:w})),yield Ot(u.peerConnection.setRemoteDescription({type:"answer",sdp:K})),yield Ot(u.stopSending(b,!0)),F}u.remoteSDP.receive(o,s,c,x);const B=u.remoteSDP.toString(),U=u.logSDPExchange(w,"offer","local","send");return yield Ot(u.peerConnection.setLocalDescription({type:"offer",sdp:w})),yield Ot(u.applySimulcastEncodings(p,o)),yield Ot(u.applySendEncodings(p,o)),U==null||U(B),yield Ot(u.peerConnection.setRemoteDescription({type:"answer",sdp:B})),p.map((F,K)=>{const z=b[K];return{localSSRC:A[K],id:z,transceiver:F}})}catch(p){throw p instanceof ve?p:new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(p.toString()))}finally{h()}})()}async createDataChannels(o,s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let c=this.dataStreamChannelMap.get(o);if(c&&c.readyState==="open")L.debug("[P2PConnection] Channels are already available and can be reused directly.");else{const h=this.currentDataChannelId<1023?this.currentDataChannelId++:this.recoveredDataChannelIds.shift();if(typeof h!="number")throw new Error("create DataChannel error, because cannot get dc id");c=this.peerConnection.createDataChannel("datastream-channel",{id:h,negotiated:!0,ordered:!1,maxRetransmits:q("DATASTREAM_MAX_RETRANSMITS")}),c.binaryType="arraybuffer",this.dataStreamChannelMap.set(o,c)}s.forEach(h=>{h._updateOriginDataChannel(c)});const{needExchangeSDP:u}=this.remoteSDP.sendDataChannel();if(u){const h=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:h});const p=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(p),L.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else L.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(c){throw c instanceof ve?c:new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(c.toString()))}}async stopDataChannels(o){try{const s=this.dataStreamChannelMap.get(o);return s&&(s.id&&this.recoveredDataChannelIds.push(s.id),s.close()),void this.dataStreamChannelMap.delete(o)}catch(s){throw s instanceof ve?s:new ve(Y.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(s.toString()))}}async stopSending(o,s){const c=s?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const u=this.peerConnection.getTransceivers().filter(y=>o.indexOf(y.mid)!==-1);if(u.length!==o.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");u.map(y=>{var b;ET(this.id+y.mid,this),y.direction="inactive",(b=y.stop)===null||b===void 0||b.call(y)});const h=await this.peerConnection.createOffer(),p=this.logSDPExchange(h.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(h),this.remoteSDP.stopReceiving(o);const g=this.remoteSDP.toString();p==null||p(g),await this.peerConnection.setRemoteDescription({type:"answer",sdp:g})}catch(u){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(u.toString()))}finally{c&&c()}}async receive(o,s,c,u){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(o," before remoteSDP created."));const{mid:h,needExchangeSDP:p}=this.remoteSDP.send(o,s,c,u);p&&(await w_(this.peerConnection,this.remoteSDP,this.extension),L.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(o," by exchanging SDP.")));const g=this.peerConnection.getTransceivers().find(y=>y.mid===h);if(!g)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:g.receiver.track,id:h,transceiver:g}}catch(h){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(h.toString()))}}async batchReceive(o){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:s,needExchangeSDP:c}=this.remoteSDP.batchSend(o);return c&&(await w_(this.peerConnection,this.remoteSDP,this.extension),L.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))),s.map(u=>{const h=this.peerConnection.getTransceivers().find(p=>p.mid===u);if(!h)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:h.receiver.track,id:u,transceiver:h}})}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(s.toString()))}}async stopReceiving(o){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");o.forEach(h=>{Array.from(this.preSSRCMap.entries()).some(p=>{let[g,y]=p;if(y===h)return this.preSSRCMap.delete(g),!0})}),this.remoteSDP.stopSending(o);const s=this.remoteSDP.toString(),c=this.logSDPExchange(s,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const u=await this.peerConnection.createAnswer();c==null||c(u.sdp||""),await this.peerConnection.setLocalDescription(u)}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}}async muteRemote(o){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(o," before remote SDP created."));this.remoteSDP.mute(o);const s=this.remoteSDP.toString(),c=this.logSDPExchange(s,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const u=await this.peerConnection.createAnswer();c==null||c(u.sdp||""),await this.peerConnection.setLocalDescription(u)}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(s.toString()))}}async unmuteRemote(o){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(o," before remote SDP created."));this.remoteSDP.unmute(o);const s=this.remoteSDP.toString(),c=this.logSDPExchange(s,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const u=await this.peerConnection.createAnswer();c==null||c(u.sdp||""),await this.peerConnection.setLocalDescription(u)}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(s.toString()))}}async muteLocal(o){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(p=>p.mid&&o.indexOf(p.mid)!==-1);if(s.length!==o.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(p=>{p.direction="inactive"});const c=await this.peerConnection.createOffer(),u=this.logSDPExchange(c.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(c),this.remoteSDP.muteRemote(o);const h=this.remoteSDP.toString();u==null||u(h),await this.peerConnection.setRemoteDescription({type:"answer",sdp:h})}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(s.toString()))}}async unmuteLocal(o){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(p=>p.mid&&o.indexOf(p.mid)!==-1);if(s.length!==o.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(async(p,g)=>{p.direction="sendonly"});const c=await this.peerConnection.createOffer(),u=this.logSDPExchange(c.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(c),this.remoteSDP.unmuteRemote(o),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec(o,this.remoteCodecs,this.store.codec);const h=this.remoteSDP.toString();u==null||u(h),await this.peerConnection.setRemoteDescription({type:"answer",sdp:h})}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(s.toString()))}}restartICE(o){var s=this;return Is(function*(){const c=yield Ot(s.mutex.lock("From P2PConnection.restartICE"));try{if(!s.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const u=xt().supportPCSetConfiguration,h=q("FORCE_TURN_TCP")||s.forceTurn;if(o===mi.RELAY&&!u)return;if(u&&!h){const C=o===mi.RELAY?"relay":"all",A=s.peerConnection.getConfiguration();A.iceTransportPolicy!==C&&(L.debug("[".concat(s.store.clientId,"] restartICE change iceTransportPolicy from [").concat(A.iceTransportPolicy,"] to [").concat(C,"]")),A.iceTransportPolicy=C,s.peerConnection.setConfiguration(A))}s.remoteSDP.updateCandidates(o);const p=yield Ot(s.peerConnection.createOffer({iceRestart:!0}));if(!p.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const g=vd(p.sdp),{remoteIceParameters:y}=yield g.iceParameters;s.remoteSDP.restartICE(y);const b=s.remoteSDP.toString(),w=s.logSDPExchange(p.sdp||"","offer","local","restartICE");s.store.descriptionStart(),yield Ot(s.peerConnection.setLocalDescription(p)),w==null||w(b),yield Ot(s.peerConnection.setRemoteDescription({type:"answer",sdp:b}))}catch(u){L.warning("[".concat(s.store.clientId,"] restart ICE failed, abort operation"),u)}finally{c()}})()}async extendCandidate(){if(!this.remoteSDP||this.isFirstConnected)return;const o=await this.mutex.lock("From P2PConnection.extendCandidate");try{this.remoteSDP.updateCandidates(mi.TCP_RELAY),await w_(this.peerConnection,this.remoteSDP,this.extension)}catch(s){L.warning("[".concat(this.store.clientId,"] extend candidate failed, abort operation"),s)}finally{o()}}close(){var o;this.peerConnection.getTransceivers().forEach(s=>{ET(this.id+s.mid,this)}),this.preSSRCMap.clear(),this.peerConnection.close(),(o=this.onConnectionStateChange)===null||o===void 0||o.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear(),this.recoveredDataChannelIds=[],this.currentDataChannelId=1}getStats(){return cc(cc({},this.statsFilter.getStats()),{},{qualityLimitationReason:this.qualityLimitationReason})}getRemoteVideoIsReady(o){return this.statsFilter.getVideoIsReady(o)}async updateEncoderConfig(o,s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const c=await this.peerConnection.createOffer(),u=this.mungSendOfferSDP(c.sdp,[s],[o]);this.remoteSDP.updateRecvMedia(o,s);const h=this.remoteSDP.toString(),p=this.logSDPExchange(u,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:u}),p==null||p(h),await this.peerConnection.setRemoteDescription({type:"answer",sdp:h})}catch(c){throw new ve(Y.EXCHANGE_SDP_FAILED,c.toString())}}async updateSendParameters(o,s){const c=this.peerConnection.getTransceivers().filter(u=>u.mid===o);c.length===1&&(this.isVP8Simulcast(s)?xn()||await this.applySimulcastEncodings(c,[s]):await this.applySendEncodings(c,[s]))}setStatsRemoteVideoIsReady(o,s){this.statsFilter.setVideoIsReady2(o,s)}async replaceTrack(o,s){const c=this.peerConnection.getTransceivers().find(u=>u.mid===s);c&&await c.sender.replaceTrack(o._mediaStreamTrack)}async getSelectedCandidatePair(){const o=this.peerConnection.getReceivers();if(o.length>0&&o[0].transport&&o[0].transport.iceTransport&&o[0].transport.iceTransport.getSelectedCandidatePair&&o[0].transport.iceTransport.getSelectedCandidatePair()){const s=o[0].transport.iceTransport,{local:c,remote:u}=s.getSelectedCandidatePair();return{local:cc(cc({},Yc),{},{candidateType:c.type,protocol:c.protocol,address:c.address,port:c.port}),remote:cc(cc({},Yc),{},{candidateType:u.type,protocol:u.protocol,address:u.address,port:u.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var o;(o=this.onICEConnectionStateChange)===null||o===void 0||o.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var o;this.peerConnection.connectionState==="connected"&&(this.isFirstConnected=!0),(o=this.onConnectionStateChange)===null||o===void 0||o.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidateerror=o=>{if(o&&(o.errorCode||o.errorText)){var s;const c="code: ".concat(o.errorCode,", message: ").concat(o.errorText),u=o.port?"local: ".concat(o.port):"";L.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICECandidateError(").concat(c,"), url: ").concat(o.url||"",", host_candidate:").concat(u)),(s=this.onICECandidateError)===null||s===void 0||s.call(this,c)}},this.peerConnection.onicegatheringstatechange=o=>{o&&o.target&&"iceGatheringState"in o.target&&L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] RTCPeerConnection.onicegatheringstatechange(").concat(o.target.iceGatheringState,")"))},this.peerConnection.onicecandidate=o=>{o.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},q("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(o){const s={iceServers:[]};return o.iceServers?s.iceServers=o.iceServers:o.turnServer&&(a_(o.turnServer.servers)?s.iceServers=o.turnServer.servers:q("NEW_TURN_MODE")&&s.iceServers?(q("USE_TURN_SERVER_OF_GATEWAY")?o.turnServer.serversFromGateway&&s.iceServers.push(...Wf.newTurnServerConfigToIceServers(o.turnServer.serversFromGateway)):s.iceServers.push(...Wf.newTurnServerConfigToIceServers(o.turnServer.servers)),q("NEW_FORCE_TURN")&&(s.iceTransportPolicy="relay")):o.turnServer.mode!=="off"&&(s.iceServers&&s.iceServers.push(...Wf.turnServerConfigToIceServers(o.turnServer.servers)),q("USE_TURN_SERVER_OF_GATEWAY")&&s.iceServers&&o.turnServer.serversFromGateway&&s.iceServers.push(...Wf.turnServerConfigToIceServers(o.turnServer.serversFromGateway)),q("FORCE_TURN_TCP")?s.iceTransportPolicy="relay":o.turnServer.servers.concat(o.turnServer.serversFromGateway||[]).forEach(c=>{c.forceturn&&(s.iceTransportPolicy="relay")}))),q("ENABLE_ENCODED_TRANSFORM")&&xt().supportWebRTCEncodedTransform&&(s.encodedInsertableStreams=!0),s}static turnServerConfigToIceServers(o){const s=[];return o.forEach(c=>{c.security?c.tcpport&&s.push({username:c.username,credential:c.password,credentialType:"password",urls:"turns:".concat(md(c.turnServerURL),":").concat(c.tcpport,"?transport=tcp")}):(c.udpport&&!q("FORCE_TURN_TCP")&&s.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":").concat(c.udpport,"?transport=udp")}),c.tcpport&&s.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":").concat(c.tcpport,"?transport=tcp")}))}),s}static newTurnServerConfigToIceServers(o){const s=[];return o.forEach(c=>{const u=q("NEW_TURN_MODE");u===1?s.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":3478?transport=udp")}):u===2?s.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":3478?transport=tcp")}):u===3?s.push({username:c.username,credential:c.password,credentialType:"password",urls:"turns:".concat(md(c.turnServerURL),":443?transport=tcp")}):u===4&&(s.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":3478?transport=udp")}),s.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":3478?transport=tcp")}),s.push({username:c.username,credential:c.password,credentialType:"password",urls:"turns:".concat(md(c.turnServerURL),":443?transport=tcp")}))}),s}tryBindTransportEvents(o){const s=o.transport;if(s){this.transportEventReceiver=o,s.onstatechange=()=>{var u;s!=null&&s.state&&((u=this.onDTLSTransportStateChange)===null||u===void 0||u.call(this,s.state))},s.onerror=u=>{var h;(h=this.onDTLSTransportError)===null||h===void 0||h.call(this,"error"in u?u.error:u)};const c=s.iceTransport;c&&(c.onstatechange=()=>{const u=s==null?void 0:s.iceTransport.state;var h;u&&((h=this.onICETransportStateChange)===null||h===void 0||h.call(this,u))},c.getSelectedCandidatePair&&(c.onselectedcandidatepairchange=()=>{if(c.getSelectedCandidatePair()){const{local:u,remote:h}=c.getSelectedCandidatePair();L.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:u.type,protocol:u.protocol}),", remote ").concat(JSON.stringify({candidateType:h.type,protocol:h.protocol,address:h.address,port:h.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(o,s){var c,u;if(s||(s=this.peerConnection.getSenders().find(F=>F.track===o._mediaStreamTrack)),!s)return L.warn("[".concat(o.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(o))return L.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!xt().supportSetRtpSenderParameters)return L.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const h={},p={};switch(o._optimizationMode){case"motion":h.degradationPreference="maintain-framerate";break;case"detail":h.degradationPreference="maintain-resolution";break;case"balanced":h.degradationPreference="balanced"}const g=function(U,F){return U.getTransceivers().find(K=>K.sender.track===F||K.receiver.track===F)}(this.peerConnection,o._mediaStreamTrack),y=EIe(o);if(kxe(o)&&g&&s&&y&&this.getLocalVideoStats&&Pe(c=["vp8","vp9"]).call(c,this.store.codec)){var b;const U=h.degradationPreference||(Pe(b=o._hints).call(b,Zt.CUSTOM_TRACK)?q("CUSTOM_ADAPTATION_DEFAULT_MODE"):"maintain-framerate");(function(F,K,z,Q,ie,oe){if(ET(F,z),ie(K),Q!=="balanced"&&Q!=="maintain-framerate"&&Q!=="maintain-resolution")return;let re=-1;pY(F,K);const me=window.setInterval(()=>{const xe=_T.get(F);if(!q("ENABLE_AG_ADAPTATION")||!xe)return ET(F,z),void ie(K);const Me=oe();if(Me.sendPackets>0&&Me.OutgoingAvailableBandwidth>0){if(re===-1)return void(re=Date.now());if(Date.now()-re<1e3)return;const pt=Me.sendFrameRate,ut=Me.OutgoingAvailableBandwidth,[nt,hn]=Dxe(F,pt,ut,xe.adaptationConfig,K,Q);hn&&(z.qualityLimitationReason=hn),nt&&xe.adaptationConfig.scale!==nt.scale&&(L.debug("[".concat(F,"] applyAdaptation: ").concat(z.qualityLimitationReason,`
           sendFps `).concat(pt,", bwe ").concat(ut,", switch from ").concat(xe.adaptationConfig.scale," to ").concat(nt.scale," ")),xe.adaptationConfig=SD(SD({},xe.adaptationConfig),nt),ie(nt))}},q("CHECK_LOCAL_STATS_INTERVAL")),Ee=SD({},K);_T.set(F,{timer:me,adaptationConfig:Ee,originConfig:K,adaptationFunc:ie}),L.debug("[".concat(F,"] start adaptation, originConfig: ").concat(JSON.stringify(K),", degradationPreference: ").concat(Q))})(this.id+g.mid,y,this,U,F=>{s&&this.updateAdaptation(s,F)},this.getLocalVideoStats.bind(this))}if(o._encoderConfig){var w;const{bitrateMax:U,frameRate:F,scaleResolutionDownBy:K}=o._encoderConfig;U&&(p.maxBitrate=1e3*U),(Pe(w=o._hints).call(w,Zt.LOW_STREAM)||o.isUseScaleResolutionDownBy)&&(F&&(p.maxFramerate=ko(F)),K&&K>=1&&(p.scaleResolutionDownBy=K))}const{maxFramerate:C}=q("ENCODER_CONFIG_LIMIT");if(C&&typeof C=="number"&&(p.maxFramerate=p.maxFramerate?Math.min(p.maxFramerate,C):C),q("DSCP_TYPE")&&Wl()){var A;const U=q("DSCP_TYPE");Pe(A=["very-low","low","medium","high"]).call(A,U)&&(p.networkPriority=U)}const x=s.getParameters(),B=(u=x.encodings)===null||u===void 0?void 0:u[0];xn()&&!B&&(h.encodings=[p]),B&&Object.assign(B,p),Object.assign(x,h),L.debug("[".concat(o.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(x.encodings))),await s.setParameters(x),await async function(U,F,K){try{var z;if(!xt().supportSetRtpSenderParameters||!function(me){return me==="vp9"||me==="av1"}(U)||!q("ENABLE_SVC"))return;const Q={},ie={},oe=F.getParameters(),re=(z=oe.encodings)===null||z===void 0?void 0:z[0];ie.scalabilityMode=lT(K),re&&Object.assign(re,ie),Object.assign(oe,Q),await F.setParameters(oe),L.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode success: ".concat(JSON.stringify(oe.encodings)))}catch(Q){L.debug("[updateAdaptation] updateRtpSenderEncodings scalabilityMode failed",Q)}}(this.store.codec,s,q("SVC_MODE"))}async updateAdaptation(o,s){var c,u;if(!o)return L.debug("[updateAdaptation] no rtpSender found");if(!xt().supportSetRtpSenderParameters)return L.debug("[updateAdaptation] Browser not support set rtp-sender parameters");const h={},{bitrateMax:p,frameRate:g,scaleResolutionDownBy:y}=s;p&&(h.maxBitrate=1e3*p),g&&(h.maxFramerate=ko(g)),y&&y>=1&&Pe(c=["vp8","vp9"]).call(c,this.store.codec)&&(h.scaleResolutionDownBy=y);const b=o.getParameters(),w=(u=b.encodings)===null||u===void 0?void 0:u[0];w&&Object.assign(w,h),Object.assign(b,{});try{await o.setParameters(b),L.debug("[updateAdaptation] updateRtpSenderEncodings: ".concat(JSON.stringify(b.encodings)))}catch(C){!("transport"in o)||o.transport&&o.transport.state==="connected"?this.peerConnectionState!=="connected"?L.debug("[updateAdaptation] peerConnection not connected}"):L.debug("[updateAdaptation] updateRtpSenderEncodings failed",C):L.debug("[updateAdaptation] rtpSender transport not connected}")}}async applySendEncodings(o,s){try{if(!xt().supportSetRtpSenderParameters||o.length!==s.length)return;for(let c=0;c<o.length;c++){const u=o[c],h=s[c];h instanceof pn&&!this.isVP8Simulcast(h)&&await this.updateRtpSenderEncodings(h,u.sender)}}catch{L.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(o,s,c){const u=ho(o);return s.forEach((h,p)=>{const g=c[p],y=u.mediaDescriptions.find(b=>b.attributes.mid===g);y&&(Vm(y,h),Mz(y,h,this.store.codec))}),hd(u)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=o=>{var s;(s=this.onFirstAudioReceived)===null||s===void 0||s.call(this,o)},this.statsFilter.onFirstVideoReceived=o=>{var s;(s=this.onFirstVideoReceived)===null||s===void 0||s.call(this,o)},this.statsFilter.onFirstAudioDecoded=o=>{var s;(s=this.onFirstAudioDecoded)===null||s===void 0||s.call(this,o)},this.statsFilter.onFirstVideoDecoded=(o,s,c)=>{var u;(u=this.onFirstVideoDecoded)===null||u===void 0||u.call(this,o,s,c)},this.statsFilter.onSelectedLocalCandidateChanged=(o,s)=>{var c;(c=this.onSelectedLocalCandidateChanged)===null||c===void 0||c.call(this,o,s)},this.statsFilter.onSelectedRemoteCandidateChanged=(o,s)=>{var c;(c=this.onSelectedRemoteCandidateChanged)===null||c===void 0||c.call(this,o,s)},this.statsFilter.onFirstVideoDecodedTimeout=o=>{var s;(s=this.onFirstVideoDecodedTimeout)===null||s===void 0||s.call(this,o)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(o,s){if(o.length===s.length)for(let y=0;y<o.length;y++){var c,u,h,p,g;const b=o[y],w=s[y];if(w instanceof pn&&!Pe(c=w._hints).call(c,Zt.LOW_STREAM)&&(u=w._encoderConfig)!==null&&u!==void 0&&u.bitrateMax&&((h=w._encoderConfig)===null||h===void 0?void 0:h.bitrateMax)>200&&(p=w._scalabilityMode)!==null&&p!==void 0&&p.numSpatialLayers&&((g=w._scalabilityMode)===null||g===void 0?void 0:g.numSpatialLayers)>1&&this.store.codec==="vp8"){const C={},A={high:1e3*(w._encoderConfig.bitrateMax-50),medium:5e4};C.encodings=[{rid:"m",active:!0,maxBitrate:A.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:A.high}];const x=b.sender.getParameters();await b.sender.setParameters(Object.assign(x,C))}}}async applySimulcastEncodings(o,s){if(!xn()&&o.length===s.length)for(let c=0;c<o.length;c++){const u=s[c];if(u instanceof pn&&this.isVP8Simulcast(u)){const h=o[c],p={},g={high:1e3*(u._encoderConfig.bitrateMax-50),medium:5e4};p.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:g.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:g.medium,scaleResolutionDownBy:4}];const y=h.sender.getParameters();await h.sender.setParameters(Object.assign(y,p))}}}isVP8Simulcast(o){var s,c,u,h,p;return!!(o instanceof pn&&q("SIMULCAST")&&this.store.codec==="vp8"&&!Pe(s=o._hints).call(s,Zt.LOW_STREAM)&&(c=o._encoderConfig)!==null&&c!==void 0&&c.bitrateMax&&((u=o._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(h=o._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((p=o._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1)}logSDPExchange(o,s,c,u){if(q("SDP_LOGGING"))return L.upload("[".concat(this.store.clientId,"] exchanging ").concat(c," ").concat(s," SDP during P2PConnection.").concat(u,`
`),o),s==="offer"?h=>{this.logSDPExchange(h,"answer",c==="local"?"remote":"local",u)}:void 0}async getRemoteSSRC(o){if(!this.remoteSDP)return;const s=this.remoteSDP.getSSRC(o);return s&&s.length!==0?s[0].ssrcId:void 0}setConfiguration(o){if(xt().supportPCSetConfiguration){const s=Wf.resolvePCConfiguration(o);this.peerConnection.setConfiguration(s)}}},$e(Ct.prototype,"updateRemoteRTPCapabilities",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"updateRemoteRTPCapabilities"),Ct.prototype),$e(Ct.prototype,"connect",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"connect"),Ct.prototype),$e(Ct.prototype,"updateRemoteConnect",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"updateRemoteConnect"),Ct.prototype),$e(Ct.prototype,"createDataChannels",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"createDataChannels"),Ct.prototype),$e(Ct.prototype,"receive",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"receive"),Ct.prototype),$e(Ct.prototype,"batchReceive",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"batchReceive"),Ct.prototype),$e(Ct.prototype,"stopReceiving",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"stopReceiving"),Ct.prototype),$e(Ct.prototype,"muteRemote",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"muteRemote"),Ct.prototype),$e(Ct.prototype,"unmuteRemote",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"unmuteRemote"),Ct.prototype),$e(Ct.prototype,"muteLocal",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"muteLocal"),Ct.prototype),$e(Ct.prototype,"unmuteLocal",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"unmuteLocal"),Ct.prototype),$e(Ct.prototype,"close",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"close"),Ct.prototype),$e(Ct.prototype,"updateEncoderConfig",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"updateEncoderConfig"),Ct.prototype),$e(Ct.prototype,"updateSendParameters",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"updateSendParameters"),Ct.prototype),$e(Ct.prototype,"replaceTrack",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"replaceTrack"),Ct.prototype),$e(Ct.prototype,"updateAdaptation",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"updateAdaptation"),Ct.prototype),$e(Ct.prototype,"getRemoteSSRC",[eo],Object.getOwnPropertyDescriptor(Ct.prototype,"getRemoteSSRC"),Ct.prototype),Ct);function eo(r,o,s){const c=r[o];if(typeof c!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const u=this.mutex,h=await u.lock("From P2PConnection.".concat(o));try{for(var p=arguments.length,g=new Array(p),y=0;y<p;y++)g[y]=arguments[y];return await c.apply(this,g)}finally{h()}},s}function RD(r,o){let s=document.createElement("video"),c=document.createElement("canvas");s.setAttribute("style","display:none"),c.setAttribute("style","display:none"),s.setAttribute("muted",""),s.muted=!0,s.setAttribute("autoplay",""),s.autoplay=!0,s.setAttribute("playsinline",""),c.width=ko(o.width),c.height=ko(o.height);const u=ko(o.framerate||15);document.body.append(s),document.body.append(c);let h=r._mediaStreamTrack;s.srcObject=new MediaStream([h]),s.play();const p=c.getContext("2d");if(!p)throw new pe(Y.UNEXPECTED_ERROR,"can not get canvas context");const g=xt(),y=c.captureStream(g.supportRequestFrame?0:u).getVideoTracks()[0];y.canvas||(y.canvas=c),c.startCapture=()=>{if(!s)return c.stopCapture&&c.stopCapture();if(s.paused&&s.play(),s.videoHeight>2&&s.videoWidth>2){const w=s.videoWidth,C=s.videoHeight/w,A=c.width*C;Math.abs(A-c.height)>=2&&(L.debug("adjust low stream resolution","".concat(c.width,"x").concat(c.height," -> ").concat(c.width,"x").concat(A)),c.height=A)}p.drawImage(s,0,0,c.width,c.height),y.requestFrame&&y.requestFrame(),h!==r._mediaStreamTrack&&(h=r._mediaStreamTrack,s.srcObject=new MediaStream([h]))},c.stopCapture=M1(()=>c.startCapture&&c.startCapture(),u);const b=y.stop;return y.stop=()=>{b.call(y),s&&(s.remove(),s.srcObject=null,s=null),c&&(c.width=0,c.remove(),c.stopCapture&&c.stopCapture(),c.startCapture=void 0,c.stopCapture=void 0,c=null),L.debug("clean low stream renderer")},y}var Ea=function(r){return r[r.Video_Send_Qp_Sum=2143]="Video_Send_Qp_Sum",r[r.Video_Send_Freeze=2082]="Video_Send_Freeze",r[r.Video_Recv_Qp_Sum=2144]="Video_Recv_Qp_Sum",r[r.Video_Recv_Freeze=2084]="Video_Recv_Freeze",r[r.Video_Render_Freeze_Time=2109]="Video_Render_Freeze_Time",r[r.Video_Render_Freeze_Time_Render=2147]="Video_Render_Freeze_Time_Render",r[r.Video_Render_Freeze_Time_Render2=2223]="Video_Render_Freeze_Time_Render2",r[r.Audio_Recv_Freeze=2083]="Audio_Recv_Freeze",r[r.Video_Send_Type=2225]="Video_Send_Type",r}(Ea||{}),st=function(r){return r[r.Video_Send_Retransmit=2062]="Video_Send_Retransmit",r[r.Video_Send_Target_Encoded=2064]="Video_Send_Target_Encoded",r[r.Video_Send_Actual_Encoded=2060]="Video_Send_Actual_Encoded",r[r.Video_Send_Transmit=2066]="Video_Send_Transmit",r[r.Video_Send_Bandwidth=2061]="Video_Send_Bandwidth",r[r.Video_Capture_Height=2033]="Video_Capture_Height",r[r.Video_Capture_Width=2035]="Video_Capture_Width",r[r.Video_Capture_Frame_Rate=2034]="Video_Capture_Frame_Rate",r[r.Video_Send_Low_Height=2073]="Video_Send_Low_Height",r[r.Video_Send_Low_Frame_Rate=2075]="Video_Send_Low_Frame_Rate",r[r.Video_Send_Low_Width=2077]="Video_Send_Low_Width",r[r.Video_Send_Low_Bitrate=2069]="Video_Send_Low_Bitrate",r[r.Video_Send_Low_Package_Lost=2070]="Video_Send_Low_Package_Lost",r[r.Video_Send_Low_Package_Rate=2071]="Video_Send_Low_Package_Rate",r[r.Video_Send_Frame_Rate=2002]="Video_Send_Frame_Rate",r[r.Video_Send_Width=2003]="Video_Send_Width",r[r.Video_Send_Height=2004]="Video_Send_Height",r[r.Video_Send_Disabled=2095]="Video_Send_Disabled",r[r.Video_Send_Adaptation=2032]="Video_Send_Adaptation",r[r.Video_Send_Player_Status=2128]="Video_Send_Player_Status",r[r.Video_Send_Nacks=2009]="Video_Send_Nacks",r[r.Video_Send_Plis=2010]="Video_Send_Plis",r[r.Video_Send_Firs=2011]="Video_Send_Firs",r[r.Video_Send_Avg_Encode=2007]="Video_Send_Avg_Encode",r[r.Video_Send_Huge_Frame_Sent=2174]="Video_Send_Huge_Frame_Sent",r[r.Video_Send_Bytes_Retransmit=2173]="Video_Send_Bytes_Retransmit",r[r.Video_Send_Packages_Retransmit=2172]="Video_Send_Packages_Retransmit",r[r.Video_Send_Key_Frames_Encoded=2207]="Video_Send_Key_Frames_Encoded",r[r.Video_Send_Bitrate=2012]="Video_Send_Bitrate",r[r.Video_Send_Package_Rate=2031]="Video_Send_Package_Rate",r[r.Video_Send_Package_Lost=2005]="Video_Send_Package_Lost",r[r.Audio_Capture_PCM_Level=2104]="Audio_Capture_PCM_Level",r[r.Audio_Send_Level=2038]="Audio_Send_Level",r[r.Audio_Send_Bitrate=2039]="Audio_Send_Bitrate",r[r.Audio_Send_Package_Rate=2040]="Audio_Send_Package_Rate",r[r.Audio_Send_AEC_Return_Loss=2041]="Audio_Send_AEC_Return_Loss",r[r.Audio_Send_AEC_Return_Loss_Enhancement=2042]="Audio_Send_AEC_Return_Loss_Enhancement",r[r.Audio_Send_Freeze=2081]="Audio_Send_Freeze",r[r.Audio_Send_Disabled=2096]="Audio_Send_Disabled",r[r.Audio_Send_Bytes_Retransmit=2179]="Audio_Send_Bytes_Retransmit",r[r.Audio_Send_Packages_Retransmit=2180]="Audio_Send_Packages_Retransmit",r[r.Video_Recv_Height=2019]="Video_Recv_Height",r[r.Video_Recv_Width=2018]="Video_Recv_Width",r[r.Video_Recv_Frame_Rate_Output=2155]="Video_Recv_Frame_Rate_Output",r[r.Video_Recv_Jitter_Buffer=2023]="Video_Recv_Jitter_Buffer",r[r.Video_Recv_Current_Delay=2024]="Video_Recv_Current_Delay",r[r.Video_Recv_Nacks=2026]="Video_Recv_Nacks",r[r.Video_Recv_Plis=2027]="Video_Recv_Plis",r[r.Video_Recv_Firs=2028]="Video_Recv_Firs",r[r.Video_Recv_Disabled=2101]="Video_Recv_Disabled",r[r.Video_Recv_Player_Status=2129]="Video_Recv_Player_Status",r[r.Video_Recv_I_Frame_Delay=2149]="Video_Recv_I_Frame_Delay",r[r.Video_Render_Frame_Rate_Render=2022]="Video_Render_Frame_Rate_Render",r[r.Video_Render_Freeze_Duration=2156]="Video_Render_Freeze_Duration",r[r.Audio_Render_Level=2043]="Audio_Render_Level",r[r.Audio_Render_Freeze_Time_80ms=2226]="Audio_Render_Freeze_Time_80ms",r[r.Audio_Render_Freeze_Time_200ms=2227]="Audio_Render_Freeze_Time_200ms",r[r.Audio_Render_Freeze_Samples_80ms=2228]="Audio_Render_Freeze_Samples_80ms",r[r.Audio_Render_Freeze_Samples_200ms=2229]="Audio_Render_Freeze_Samples_200ms",r[r.Audio_Recv_PCM_Level=2105]="Audio_Recv_PCM_Level",r[r.Audio_Recv_Disabled=2102]="Audio_Recv_Disabled",r[r.Audio_Recv_Jitter_Buffer=2054]="Audio_Recv_Jitter_Buffer",r[r.Audio_Recv_Current_Delay=2047]="Audio_Recv_Current_Delay",r[r.Audio_Recv_Player_Status=2130]="Audio_Recv_Player_Status",r[r.Audio_Recv_Bitrate=2044]="Audio_Recv_Bitrate",r[r.Audio_Recv_Concealed_Samples=2148]="Audio_Recv_Concealed_Samples",r[r.Audio_Recv_Total_Samples_Received=2224]="Audio_Recv_Total_Samples_Received",r}(st||{}),qr=function(r){return r[r.Video_Render_Frame_Rate_Decode=2021]="Video_Render_Frame_Rate_Decode",r[r.Video_Recv_Frame_Rate=2020]="Video_Recv_Frame_Rate",r[r.Video_Recv_Frame_Dropped=2181]="Video_Recv_Frame_Dropped",r[r.Video_Recv_Bytes_Retransmit=2175]="Video_Recv_Bytes_Retransmit",r[r.Video_Recv_Packages_Retransmit=2176]="Video_Recv_Packages_Retransmit",r[r.Video_Recv_Packages_Discarded=2198]="Video_Recv_Packages_Discarded",r[r.Video_Recv_Avg_Decode=2200]="Video_Recv_Avg_Decode",r[r.Video_Recv_Avg_Processing_Delay=2202]="Video_Recv_Avg_Processing_Delay",r[r.Video_Recv_Avg_Assembly_Time=2203]="Video_Recv_Avg_Assembly_Time",r[r.Video_Recv_Avg_Inter_Frame_Delay=2204]="Video_Recv_Avg_Inter_Frame_Delay",r[r.Video_Recv_Key_Frames_Decoded=2206]="Video_Recv_Key_Frames_Decoded",r[r.Video_Recv_Package_Lost=2014]="Video_Recv_Package_Lost",r[r.Video_Recv_Bitrate=2029]="Video_Recv_Bitrate",r[r.Video_Recv_Package_Rate=2078]="Video_Recv_Package_Rate",r[r.Audio_Recv_Jitter=2055]="Audio_Recv_Jitter",r[r.Audio_Recv_Bytes_Retransmit=2178]="Audio_Recv_Bytes_Retransmit",r[r.Audio_Recv_Packages_Retransmit=2177]="Audio_Recv_Packages_Retransmit",r[r.Audio_Recv_Packages_Discarded=2199]="Audio_Recv_Packages_Discarded",r[r.Audio_Recv_Avg_Processing_Delay=2201]="Audio_Recv_Avg_Processing_Delay",r[r.Audio_Recv_Package_Rate=2046]="Audio_Recv_Package_Rate",r[r.Audio_Recv_Package_Lost=2045]="Audio_Recv_Package_Lost",r}(qr||{}),to=function(r){return r[r.RTT=2006]="RTT",r[r.CONN_TYPE=801]="CONN_TYPE",r[r.STATS_UPDATE_INTERVAL=2205]="STATS_UPDATE_INTERVAL",r}(to||{}),ST=function(r){return r[r.RTC_PEER_CONNECTION_STATE=2219]="RTC_PEER_CONNECTION_STATE",r}(ST||{});const vf=1e3,wT=6,O_=3,jxe=Math.max(wT,O_);function Je(r,o,s){s!=null&&Number.isFinite(s)&&(r[o]=Math.round(Math.max(0,s)))}function _Y(r){const o={[to.CONN_TYPE]:0,[to.RTT]:r.rtt,[to.STATS_UPDATE_INTERVAL]:r.updateInterval?Math.round(Math.max(0,r.updateInterval)):void 0};switch(r.selectedCandidatePair.localCandidate.candidateType){case"relay":{const s=r.selectedCandidatePair.localCandidate.relayProtocol;s==="udp"&&(o[to.CONN_TYPE]=1),s==="tcp"&&(o[to.CONN_TYPE]=3),s==="tls"&&(o[to.CONN_TYPE]=4);break}case"srflx":o[to.CONN_TYPE]=2;break;case"unknown":o[to.CONN_TYPE]=5;break;default:o[to.CONN_TYPE]=0}return o}function EY(r){let o=0;switch(r){case"none":o=0;break;case"cpu":o=1;break;case"bandwidth":o=2;break;case"other":o=3}return o}class bY extends An{constructor(o){super(),G(this,"store",void 0),G(this,"uploadWRTCStatsTimer",void 0),G(this,"uploadOutboundDenoiserStatsTimer",void 0),G(this,"uploadExtStatsTimer",void 0),G(this,"uploadExtUsageStatsTimer",void 0),G(this,"uploadInboundExtStatsTimer",void 0),G(this,"requestStats",void 0),G(this,"requestTransportStats",void 0),G(this,"requestLocalMedia",void 0),G(this,"requestRemoteMedia",void 0),G(this,"requestAllTracks",void 0),G(this,"requestVideoIsReady",void 0),G(this,"requestUploadStats",void 0),G(this,"requestUpload",void 0),G(this,"uploadOutboundStarted",!1),G(this,"uploadInboundStarted",!1),G(this,"uploadTransportStarted",!1),G(this,"uploadBaseStatsStarted",!1),G(this,"uploadExtensionUsageStarted",!1),G(this,"lastRecvStats",void 0),G(this,"lastSendStats",void 0),G(this,"lastRefRecvStats",void 0),G(this,"lastRefSendStats",void 0),G(this,"lastNormalRecvStats",void 0),G(this,"lastNormalSendStats",void 0),G(this,"needUploadRenderFreezeTime",!0),G(this,"lastUploadCompensateTime",-1),G(this,"uploadCompensateDeltaTime",0),this.store=o}uploadWRTCStats(o){if(!this.requestStats||!this.requestUploadStats)return;const s=o%O_==0,c=o%wT==0;let u,h;if(this.uploadTransportStarted&&(u=this.requestStats(),this.store.useP2P&&(h=this.requestStats(!0))),!u&&this.uploadOutboundStarted&&(u=this.requestStats()),!h&&this.uploadInboundStarted&&(h=this.requestStats(!0)),u||h){var p;const g={};if(this.uploadTransportStarted&&u){const b=this.getTransportStats(u,h,s);b&&(g.misc=[b])}if(this.uploadOutboundStarted&&u){const b=this.getOutboundStats(u,c?this.lastNormalSendStats:void 0,s?this.lastRefSendStats:void 0,this.lastSendStats);b&&(g.outbound=[b])}if(this.uploadInboundStarted&&h){this.uploadCompensateStats(o);const b=this.getInboundStats(h,c?this.lastNormalRecvStats:void 0,s?this.lastRefRecvStats:void 0,this.lastRecvStats);b&&(g.inbound=b)}const y=(p=this.requestTransportStats)===null||p===void 0?void 0:p.call(this).connectState;y&&(Array.isArray(g.misc)?g.misc[0]&&g.misc[0].addition&&(g.misc[0].addition[ST.RTC_PEER_CONNECTION_STATE]=b1[y]):g.misc=[{addition:{[ST.RTC_PEER_CONNECTION_STATE]:b1[y]}}]),this.requestUploadStats(g)}this.lastRecvStats=h,this.lastSendStats=u,c&&(this.lastNormalRecvStats=h,this.lastNormalSendStats=u),s&&(this.lastRefRecvStats=h,this.lastRefSendStats=u)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;this.uploadBaseStatsStarted=!0;let o=1;this.uploadWRTCStatsTimer=window.setInterval(()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted){if(this.uploadBaseStatsStarted){var s,c;const u=(s=this.requestTransportStats)===null||s===void 0?void 0:s.call(this);return void(u&&((c=this.requestUploadStats)===null||c===void 0||c.call(this,{misc:[{addition:{[ST.RTC_PEER_CONNECTION_STATE]:b1[u.connectState]}}]})))}return this.stopUploadWRTCStats()}this.uploadWRTCStats(o),++o===jxe+1&&(o=1)},vf)}uploadCompensateStats(o){if(!this.requestStats||!this.requestUploadStats||!this.requestRemoteMedia)return;const s=o%O_==0&&this.needUploadRenderFreezeTime;if(!this.uploadInboundStarted||!s)return;if(this.lastUploadCompensateTime===-1)return void(this.lastUploadCompensateTime=Date.now());const c=Math.max(-6e3,Date.now()-this.lastUploadCompensateTime-6e3);if(this.uploadCompensateDeltaTime+=c,this.lastUploadCompensateTime=Date.now(),this.uploadCompensateDeltaTime<6e3)return;const u=Math.min(Math.floor(this.uploadCompensateDeltaTime/6e3),10);this.uploadCompensateDeltaTime-=6e3*u;const h=this.requestStats(!0);new Array(u).fill(0).forEach(()=>{if(!this.requestStats||!this.requestUploadStats||!this.requestRemoteMedia)return;const p={};if(this.uploadInboundStarted&&h){const g=this.requestRemoteMedia()||[],y=[];g.forEach(b=>{let[w,C]=b;const A={peer:w.uid};if(w._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(w._videoSSRC)&&C.has(je.VIDEO)&&w.videoTrack){const x=function(B,U,F){if(!U.videoRecv.find(z=>z.ssrc===B))return;const K={};if(F&&F._player){const z=F._player,{renderFreezeAccTime2:Q,videoElementStatus:ie}=z;if(Jc.visibility==="visible"&&ie===wi.PLAYING&&xt().supportRequestVideoFrameCallback){const oe=Math.min(6e3,Q);z.renderFreezeAccTime2=Math.max(0,Q-oe),Je(K,Ea.Video_Render_Freeze_Time_Render2,oe),q("USE_NEW_RENDER_FREEZE_TIME")&&Je(K,Ea.Video_Render_Freeze_Time_Render,oe)}}return K}(w._videoSSRC,h,w.videoTrack);x&&(A.video=x)}A.video&&y.push(A)}),y.length>0&&(p.inbound=y,this.requestUploadStats(p))}})}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0),this.lastRefSendStats&&(this.lastRefSendStats.videoSend=[],this.lastRefSendStats.audioSend=[],this.lastRefSendStats=void 0),this.lastRefRecvStats&&(this.lastRefRecvStats.videoRecv=[],this.lastRefRecvStats.audioRecv=[],this.lastRefRecvStats=void 0),this.lastNormalSendStats&&(this.lastNormalSendStats.videoSend=[],this.lastNormalSendStats.audioSend=[],this.lastNormalSendStats=void 0),this.lastNormalRecvStats&&(this.lastNormalRecvStats.videoRecv=[],this.lastNormalRecvStats.audioRecv=[],this.lastNormalRecvStats=void 0),this.lastUploadCompensateTime=-1,this.uploadCompensateDeltaTime=0,this.needUploadRenderFreezeTime=!0}getTransportStats(o,s,c){if(!this.requestStats)return;if(!c)return o.rtt==null?void 0:{addition:{[to.RTT]:o.rtt,[to.CONN_TYPE]:void 0,[to.STATS_UPDATE_INTERVAL]:o.updateInterval||void 0}};const u=_Y(o);if(this.store.useP2P){if(s){const h=_Y(s);u[to.CONN_TYPE]+=h[to.CONN_TYPE]<<3}u[to.CONN_TYPE]+=110}else u[to.CONN_TYPE]+=100;return{addition:u}}getOutboundStats(o,s,c,u){if(!this.requestUploadStats||!this.requestLocalMedia)return;const h=this.requestLocalMedia();if(!h||h.length===0)return;let p,g,y;return h.forEach(b=>{let[w,{track:C,ssrcs:A}]=b;switch(w){case Te.LocalVideoLowTrack:case Te.LocalVideoTrack:if(w===Te.LocalVideoTrack){const x=function(F,K,z,Q,ie,oe){const re=K.videoSend.find(pt=>pt.ssrc===F);if(!re)return;const me={},{sentFrame:Ee,inputFrame:xe}=re;if(Q&&(Je(me,Ea.Video_Send_Qp_Sum,re.qpSumPerFrame),xe&&Ee)){var Me;const pt=xe.frameRate,ut=Ee.frameRate;me[Ea.Video_Send_Freeze]=function(nt,hn){let en=!0;return en=!(nt<=5)&&(nt<=10?hn<3:nt<=20?hn<4:hn<5),en}(pt,ut)?1:0,me[Ea.Video_Send_Type]=z.__className__==="CameraVideoTrack"?0:Pe(Me=z._hints).call(Me,Zt.SCREEN_TRACK)?1:2}if(ie){switch(Ee&&(Je(me,st.Video_Send_Height,Ee.height),Je(me,st.Video_Send_Width,Ee.width),Je(me,st.Video_Send_Frame_Rate,Ee.frameRate)),me[st.Video_Send_Disabled]=z._originMediaStreamTrack&&!z._originMediaStreamTrack.enabled||z._mediaStreamTrack&&!z._mediaStreamTrack.enabled?1:0,re.adaptionChangeReason){case"none":me[st.Video_Send_Adaptation]=0;break;case"cpu":me[st.Video_Send_Adaptation]=1;break;case"bandwidth":me[st.Video_Send_Adaptation]=2;break;case"other":me[st.Video_Send_Adaptation]=3}let pt=0;re.adaptionChangeReason&&(pt+=EY(re.adaptionChangeReason)),K.qualityLimitationReason&&(pt+=EY(K.qualityLimitationReason)<<3),me[st.Video_Send_Adaptation]=pt,me[st.Video_Send_Player_Status]=k1[z._player?z._player.videoElementStatus:"uninit"],Je(me,st.Video_Send_Nacks,re.nacksCount),Je(me,st.Video_Send_Plis,re.plisCount),Je(me,st.Video_Send_Firs,re.firsCount),Je(me,st.Video_Send_Avg_Encode,re.avgEncodeMs),Je(me,st.Video_Send_Huge_Frame_Sent,re.hugeFramesSent),Je(me,st.Video_Send_Bytes_Retransmit,re.retransmittedBytesSent),Je(me,st.Video_Send_Packages_Retransmit,re.retransmittedPacketsSent),Je(me,st.Video_Send_Key_Frames_Encoded,re.keyFramesEncoded);const ut=ie.videoSend.find(nt=>nt.ssrc===F);if(ut){let nt=vf*O_;ut.timestamp&&re.timestamp&&(nt=re.timestamp-ut.timestamp),ut.packets!=null&&re.packets!=null&&Je(me,st.Video_Send_Package_Rate,1e3*(re.packets-ut.packets)/nt),re.packetsLost!=null&&ut.packetsLost!=null&&Je(me,st.Video_Send_Package_Lost,re.packetsLost-ut.packetsLost),ut.bytes!=null&&re.bytes!=null&&Je(me,st.Video_Send_Bitrate,8*(re.bytes-ut.bytes)/nt)}}return me}(A[0].ssrcId,o,C,s,c),B=C&&function(F,K,z,Q){const ie=K.videoSend.find(re=>re.ssrc===F);if(!ie)return null;const oe={};if(Q){const re=ie.inputFrame,me=re&&re.height||z.videoHeight||0,Ee=re&&re.width||z.videoWidth||0,xe=re&&re.frameRate||0;Je(oe,st.Video_Capture_Height,me),Je(oe,st.Video_Capture_Width,Ee),Je(oe,st.Video_Capture_Frame_Rate,xe)}return oe}(A[0].ssrcId,o,C,!!c),U=function(F,K){const z={};return K&&(Je(z,st.Video_Send_Retransmit,F.bitrate.retransmit),Je(z,st.Video_Send_Target_Encoded,F.bitrate.targetEncoded),Je(z,st.Video_Send_Actual_Encoded,F.bitrate.actualEncoded),Je(z,st.Video_Send_Transmit,F.bitrate.transmit),Je(z,st.Video_Send_Bandwidth,F.sendBandwidth)),z}(o,!!c);g=Object.assign({},x,B,U)}else y=function(x,B,U,F,K){const z=B.videoSend.find(ie=>ie.ssrc===x);if(!z)return;const Q={};if(F){const ie=z.sentFrame;ie&&(Je(Q,st.Video_Send_Low_Height,ie.height),Je(Q,st.Video_Send_Low_Width,ie.width),Je(Q,st.Video_Send_Low_Frame_Rate,ie.frameRate));const oe=F.videoSend.find(re=>re.ssrc===x);if(oe){let re=vf*wT;oe.timestamp&&z.timestamp&&(re=z.timestamp-oe.timestamp),oe.packets!=null&&z.packets!=null&&Je(Q,st.Video_Send_Low_Package_Rate,1e3*(z.packets-oe.packets)/re),z.packetsLost!=null&&oe.packetsLost!=null&&Je(Q,st.Video_Send_Low_Package_Lost,z.packetsLost-oe.packetsLost),oe.bytes!=null&&z.bytes!=null&&Je(Q,st.Video_Send_Low_Bitrate,8*(z.bytes-oe.bytes)/re)}}return Q}(A[0].ssrcId,o,0,c);break;case Te.LocalAudioTrack:p=C&&function(x,B,U,F,K,z){const Q=B.audioSend.find(oe=>oe.ssrc===x);if(!Q)return;const ie={};if(K){ie[st.Audio_Send_Disabled]=U._originMediaStreamTrack&&!U._originMediaStreamTrack.enabled||U._mediaStreamTrack&&!U._mediaStreamTrack.enabled?1:0;const oe=100*U._source.getAccurateVolumeLevel(),re=Q.inputLevel;if(re!=null){const Ee=Math.ceil(50*Math.log10(100*re+1));Je(ie,st.Audio_Send_Level,Ee)}Je(ie,st.Audio_Capture_PCM_Level,oe),Je(ie,st.Audio_Send_AEC_Return_Loss,Q.aecReturnLoss),Je(ie,st.Audio_Send_AEC_Return_Loss_Enhancement,Q.aecReturnLossEnhancement),Je(ie,st.Audio_Send_Bytes_Retransmit,Q.retransmittedBytesSent),Je(ie,st.Audio_Send_Packages_Retransmit,Q.retransmittedPacketsSent),ie[st.Audio_Send_Freeze]=0;const me=K.audioSend.find(Ee=>Ee.ssrc===x);if(me){let Ee=vf*wT;me.timestamp&&Q.timestamp&&(Ee=Q.timestamp-me.timestamp),me.bytes!=null&&Q.bytes!=null&&Je(ie,st.Audio_Send_Bitrate,8*(Q.bytes-me.bytes)/Ee),me.packets!=null&&Q.packets!=null&&Je(ie,st.Audio_Send_Package_Rate,1e3*(Q.packets-me.packets)/Ee)}}return ie}(A[0].ssrcId,o,C,0,c)}}),{high:g,low:y,audio:p}}getInboundStats(o,s,c,u){if(!this.requestRemoteMedia)return;const h=this.requestRemoteMedia()||[],p=[];return h.forEach(g=>{let[y,b]=g;const w={peer:y.uid};if(b.has(je.VIDEO)&&y.videoTrack){const C=y._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(y._videoSSRC)||!1,A=y.videoTrack?function(x,B,U,F,K,z,Q,ie){const oe=B.videoRecv.find(nt=>nt.ssrc===x);if(!oe)return;const re={},{receivedFrame:me,outputFrame:Ee,decodeFrameRate:xe}=oe;Je(re,qr.Video_Render_Frame_Rate_Decode,xe),oe.framesRateFirefox&&Je(re,qr.Video_Recv_Frame_Rate,oe.framesRateFirefox),me&&Je(re,qr.Video_Recv_Frame_Rate,me.frameRate),Je(re,qr.Video_Recv_Frame_Dropped,oe.framesDroppedCount),Je(re,qr.Video_Recv_Bytes_Retransmit,oe.retransmittedBytesReceived),Je(re,qr.Video_Recv_Packages_Retransmit,oe.retransmittedPacketsReceived),Je(re,qr.Video_Recv_Packages_Discarded,oe.packetsDiscarded),Je(re,qr.Video_Recv_Avg_Decode,oe.avgDecodeMs),Je(re,qr.Video_Recv_Avg_Processing_Delay,oe.avgProcessingDelayMs),Je(re,qr.Video_Recv_Avg_Assembly_Time,oe.avgFramesAssembledFromMultiplePacketsMs),Je(re,qr.Video_Recv_Avg_Inter_Frame_Delay,oe.avgInterFrameDelayMs),Je(re,qr.Video_Recv_Key_Frames_Decoded,oe.keyFramesDecoded);const Me=ie&&ie.videoRecv.find(nt=>nt.ssrc===x);if(Me){const nt=B.timestamp-ie.timestamp||vf;oe.packetsLost!=null&&Me.packetsLost!=null&&Je(re,qr.Video_Recv_Package_Lost,oe.packetsLost-Me.packetsLost),Me.bytes!=null&&oe.bytes!=null&&Je(re,qr.Video_Recv_Bitrate,8*(oe.bytes-Me.bytes)/nt),Me.packets!=null&&oe.packets!=null&&Je(re,qr.Video_Recv_Package_Rate,1e3*(oe.packets-Me.packets)/nt)}const pt=z&&z.videoRecv.find(nt=>nt.ssrc===x);if(pt&&(Je(re,Ea.Video_Recv_Qp_Sum,oe.qpSumPerFrame),re[Ea.Video_Recv_Freeze]=F&&R_.isRemoteVideoFreeze(U,oe,pt)?1:0),Q){var ut;const nt=Q.videoRecv.find(en=>en.ssrc===x);me?(Je(re,st.Video_Recv_Height,me.height),Je(re,st.Video_Recv_Width,me.width)):U&&(Je(re,st.Video_Recv_Height,U._videoHeight||0),Je(re,st.Video_Recv_Width,U._videoWidth||0)),Ee&&Je(re,st.Video_Recv_Frame_Rate_Output,Ee.frameRate);const hn=(ut=U._player)===null||ut===void 0?void 0:ut.rendFrameRate.toFixed(0);if(hn&&Je(re,st.Video_Render_Frame_Rate_Render,+hn),Je(re,st.Video_Recv_Jitter_Buffer,oe.jitterBufferMs),Je(re,st.Video_Recv_Current_Delay,oe.currentDelayMs),Je(re,st.Video_Recv_Firs,oe.firsCount),Je(re,st.Video_Recv_Nacks,oe.nacksCount),Je(re,st.Video_Recv_Plis,oe.plisCount),U){re[st.Video_Recv_Disabled]=U._originMediaStreamTrack.enabled&&U._mediaStreamTrack.enabled?0:1;const en=U._player;if(en){const{freezeTimeCounterList:ro,renderFreezeAccTime:be,renderFreezeAccTime2:Oe,videoElementStatus:Ve}=en;if(ro&&ro.length>0&&Je(re,Ea.Video_Render_Freeze_Time,ro.splice(0,1)[0]),K&&Jc.visibility==="visible"&&Ve===wi.PLAYING&&xt().supportRequestVideoFrameCallback){const Se=Math.min(6e3,Oe);en.renderFreezeAccTime2=Math.max(0,Oe-Se),Je(re,Ea.Video_Render_Freeze_Time_Render2,Se);const j=Math.min(6e3,be);en.renderFreezeAccTime=Math.max(0,be-j),Je(re,Ea.Video_Render_Freeze_Time_Render,q("USE_NEW_RENDER_FREEZE_TIME")?Se:j)}if(typeof oe.totalFreezesDuration=="number"){const Se=nt&&nt.totalFreezesDuration?oe.totalFreezesDuration-nt.totalFreezesDuration:oe.totalFreezesDuration;Je(re,st.Video_Render_Freeze_Duration,1e3*Se)}}}if(re[st.Video_Recv_Player_Status]=k1[U._player?U._player.videoElementStatus:"uninit"],nt&&oe.totalInterFrameDelay!==void 0&&oe.totalSquaredInterFrameDelay!==void 0&&nt.totalInterFrameDelay!==void 0&&nt.totalSquaredInterFrameDelay!==void 0){const en=oe.totalInterFrameDelay-nt.totalInterFrameDelay,ro=oe.totalSquaredInterFrameDelay-nt.totalSquaredInterFrameDelay,be=oe.framesDecodeCount-nt.framesDecodeCount,Oe=en/be*1e3,Ve=Math.round(1e3*Math.sqrt((ro-Math.pow(en,2)/be)/be));!isNaN(Ve)&&Oe+Ve>Math.max(3*Oe,Oe+150)&&(re[st.Video_Recv_I_Frame_Delay]=Ve)}}return re}(y._videoSSRC,o,y.videoTrack,C===!0,this.needUploadRenderFreezeTime,s,c,u):void 0;A&&(w.video=A)}if(b.has(je.AUDIO)&&y.audioTrack){const C=y.audioTrack?function(A,x,B,U,F,K){const z=x.audioRecv.find(re=>re.ssrc===A);if(!z)return;const Q={};Je(Q,qr.Audio_Recv_Jitter,z.jitterMs),Je(Q,qr.Audio_Recv_Bytes_Retransmit,z.retransmittedBytesReceived),Je(Q,qr.Audio_Recv_Packages_Retransmit,z.retransmittedPacketsReceived),Je(Q,qr.Audio_Recv_Packages_Discarded,z.packetsDiscarded),Je(Q,qr.Audio_Recv_Avg_Processing_Delay,z.avgProcessingDelayMs);const ie=K&&K.audioRecv.find(re=>re.ssrc===A);if(ie){const re=vf;z.packets!=null&&ie.packets!=null&&Je(Q,qr.Audio_Recv_Package_Rate,1e3*(z.packets-ie.packets)/re),z.packetsLost!=null&&ie.packetsLost!=null&&Je(Q,qr.Audio_Recv_Package_Lost,z.packetsLost-ie.packetsLost)}if(U){const{receivedFrames:re,droppedFrames:me}=z;re!=null&&me!=null&&(Q[Ea.Audio_Recv_Freeze]=(oe=re)===0||100*me/oe>20?1:0)}var oe;if(F){const re=100*B._source.getAccurateVolumeLevel(),me=z.outputLevel;if(me!=null){const xe=Math.ceil(50*Math.log10(100*me+1));Je(Q,st.Audio_Render_Level,xe)}Je(Q,st.Audio_Recv_PCM_Level,re),B&&(Q[st.Audio_Recv_Disabled]=B._originMediaStreamTrack.enabled&&B._mediaStreamTrack.enabled?0:1),Je(Q,st.Audio_Recv_Jitter_Buffer,z.jitterBufferMs),Je(Q,st.Audio_Recv_Current_Delay,z.jitterBufferMs),Q[st.Audio_Recv_Player_Status]=k1[Zi.getPlayerState(B.getTrackId())];const Ee=F.audioRecv.find(xe=>xe.ssrc===A);if(Ee){Ee.bytes!=null&&z.bytes!=null&&Je(Q,st.Audio_Recv_Bitrate,8*(z.bytes-Ee.bytes)/(vf*O_));const xe=z.concealedSamples-Ee.concealedSamples;xe>0&&Je(Q,st.Audio_Recv_Concealed_Samples,xe);const Me=z.totalSamplesReceived-Ee.totalSamplesReceived;Me>0&&Je(Q,st.Audio_Recv_Total_Samples_Received,Me);const pt=z.freezeSamples80-Ee.freezeSamples80;pt>0&&Je(Q,st.Audio_Render_Freeze_Samples_80ms,pt);const ut=z.freezeSamples200-Ee.freezeSamples200;ut>0&&Je(Q,st.Audio_Render_Freeze_Samples_200ms,ut);const nt=z.freezeMs80-Ee.freezeMs80;Je(Q,st.Audio_Render_Freeze_Time_80ms,nt<0?0:nt);const hn=z.freezeMs200-Ee.freezeMs200;Je(Q,st.Audio_Render_Freeze_Time_200ms,hn<0?0:hn)}}return Q}(y._audioSSRC,o,y.audioTrack,s,c,u):void 0;C&&(w.audio=C)}(w.video||w.audio)&&p.push(w)}),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,p}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval(()=>{if(!this.requestAllTracks||!this.requestUpload)return;const o=(this.requestAllTracks()||[]).find(s=>s instanceof p_);if(o&&o._external.getDenoiserStats){const s=o._external.getDenoiserStats();s&&this.requestUpload(g_.DENOISER_STATS,s)}},2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval(()=>{!this.requestAllTracks||!this.requestUpload||this.requestAllTracks().forEach(o=>{o.getProcessorStats().forEach(s=>{this.requestUpload&&this.requestUpload(s.type,s.stats)})})},2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRefSendStats&&(this.lastRefSendStats.videoSend=[],this.lastRefSendStats.audioSend=[],this.lastRefSendStats=void 0),this.lastNormalSendStats&&(this.lastNormalSendStats.videoSend=[],this.lastNormalSendStats.audioSend=[],this.lastNormalSendStats=void 0),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0,this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval(()=>{!this.requestUpload||!this.requestRemoteMedia||(this.requestRemoteMedia()||[]).forEach(o=>{let[s,c]=o;c.has(je.VIDEO)&&s.videoTrack&&s.videoTrack.getProcessorStats().forEach(u=>{this.requestUpload&&this.requestUpload(u.type,u.stats)}),c.has(je.AUDIO)&&s.audioTrack&&s.audioTrack.getProcessorStats().forEach(u=>{this.requestUpload&&this.requestUpload(u.type,u.stats)})})},2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0),this.lastRefRecvStats&&(this.lastRefRecvStats.videoRecv=[],this.lastRefRecvStats.audioRecv=[],this.lastRefRecvStats=void 0),this.lastNormalRecvStats&&(this.lastNormalRecvStats.videoRecv=[],this.lastNormalRecvStats.audioRecv=[],this.lastNormalRecvStats=void 0),this.lastUploadCompensateTime=-1,this.uploadCompensateDeltaTime=0,this.needUploadRenderFreezeTime=!0,this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=void 0)}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const o=new Map;this.uploadExtUsageStatsTimer=window.setInterval(async()=>{const s=Date.now(),c={connectionInterval:q("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:s};let u=[];const h=this.requestAllTracks&&this.requestAllTracks()||[];for(const b of h)!b.muted&&b.enabled&&(u=u.concat(await b.getProcessorUsage()));const p=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[b,w]of p)w.has(je.VIDEO)&&b.videoTrack&&(u=u.concat(await b.videoTrack.getProcessorUsage())),w.has(je.AUDIO)&&b.audioTrack&&(u=u.concat(await b.audioTrack.getProcessorUsage()));if(u.length===0)return;c.details=function(b,w){const C={};for(const{id:U,value:F,level:K,direction:z}of b){var A;const Q=(A=w.get(U))!==null&&A!==void 0?A:0,ie=F===2?Q+q("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:Q;var x,B;w.set(U,ie),C[U]?(F===2&&(C[U].value=F),K>C[U].level&&(C[U].level=K),z==="remote"&&(C[U].remoteUidCount+=1),C[U].totalTs=(x=w.get(U))!==null&&x!==void 0?x:0):C[U]={value:F,level:K,remoteUidCount:z==="local"?0:1,totalTs:(B=w.get(U))!==null&&B!==void 0?B:0}}return Object.keys(C).map(U=>{const{level:F,value:K,totalTs:z}=C[U];return{id:U,level:F,value:K,totalTs:z}})}(u,o);const g=Date.now(),y=g>s?g:s+1;this.requestUpload&&this.requestUpload(g_.EXTENSION_USAGE_STATS,{usageStats:c,sendTs:y})},q("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}stopUploadBaseStats(){this.uploadBaseStatsStarted=!1}}const Uxe=q("ICE_RESTART_INTERVAL");let TT=new Map,Gm=new Map,Ed=[mi.UDP_TCP_RELAY,mi.TCP_RELAY,mi.RELAY],AD=q("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&xt().supportPCSetConfiguration;function SY(r){let o=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const s=TT.get(r.id);s&&(window.clearTimeout(s),TT.delete(r.id));const c=Gm.get(r.id);o&&c&&c.index===Ed.length-1&&(L.debug("[".concat(r.id,"] reset ICE restart policy")),Gm.delete(r.id))}function wY(r,o,s){if(TT.size===0&&Gm.size===0&&(Array.isArray(q("RESTART_SEQUENCE"))&&q("RESTART_SEQUENCE").length>0&&!function(g,y){if(g.length!==y.length)return!1;for(let b=0;b<g.length;b+=1){const w=g[b];if(g.filter(C=>C===w).length!==y.filter(C=>C===w).length)return!1}return!0}(Ed,q("RESTART_SEQUENCE"))&&(Ed=q("RESTART_SEQUENCE").filter(g=>{var y;if(Pe(y=Object.values(mi)).call(y,g))return!0}),L.debug("use reconnection policy from config distribution, queues: ".concat(Ed.join(" => ")))),AD=q("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&xt().supportPCSetConfiguration),Ed.length===0)return void s();let c,{index:u=0,type:h}=Gm.get(r.id)||{};if(AD&&h===mi.RELAY)return void s();let p=h&&u>=Ed.length-1;if(AD)h=mi.RELAY;else{if(p)return void s();h?(u++,h=Ed[u]):(h=Ed[0],u=0)}L.debug("[".concat(r.id,"] choose ICE restart policy: ").concat(h,", index: ").concat(u)),o(h),Gm.set(r.id,{index:u,type:h}),c=window.setTimeout(()=>wY(r,o,s),Uxe),TT.set(r.id,c)}var vt;function TY(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function nl(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?TY(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):TY(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}function CY(r){var o,s,c,u=2;for(typeof Symbol<"u"&&(s=qN,c=Symbol.iterator);u--;){if(s&&(o=r[s])!=null)return o.call(r);if(c&&(o=r[c])!=null)return new CT(o.call(r));s="@@asyncIterator",c="@@iterator"}throw new TypeError("Object is not async iterable")}function CT(r){function o(s){if(Object(s)!==s)return De.reject(new TypeError(s+" is not an object."));var c=s.done;return De.resolve(s.value).then(function(u){return{value:u,done:c}})}return CT=function(s){this.s=s,this.n=s.next},CT.prototype={s:null,n:null,next:function(){return o(this.n.apply(this.s,arguments))},return:function(s){var c=this.s.return;return c===void 0?De.resolve({value:s,done:!0}):o(c.apply(this.s,arguments))},throw:function(s){var c=this.s.return;return c===void 0?De.reject(s):o(c.apply(this.s,arguments))}},new CT(r)}let I_=(vt=class extends An{get state(){return this._state}set state(r){const o=this._state;this._state=r,this.emit(Ye.StateChange,o,this._state)}constructor(r,o){super(),G(this,"isPlanB",void 0),G(this,"store",void 0),G(this,"statsUploader",void 0),G(this,"connection",void 0),G(this,"localTrackMap",new Map),G(this,"remoteUserMap",new Map),G(this,"localDataChannels",[]),G(this,"remoteDataChannelMap",new Map),G(this,"pendingLocalTracks",[]),G(this,"pendingRemoteTracks",[]),G(this,"pendingLocalDataChannels",[]),G(this,"pendingRemoteDataChannels",[]),G(this,"statsCollector",void 0),G(this,"shouldForwardP2PCreation",void 0),G(this,"iceFailedCount",0),G(this,"dtlsFailedCount",0),G(this,"mutex",void 0),G(this,"_state",$t.Disconnected),G(this,"_pcStatsUploadType",q("NEW_ICE_RESTART")?ql.FIRST_CONNECTION:ql.OLD_FIRST_CONNECTION),G(this,"_isStartRestartIce",!1),G(this,"_restartTimer",void 0),G(this,"_isTryConnecting",!1),G(this,"_iceError",null),G(this,"_forceTurn",!1),G(this,"_isWaitPcToRePub",!1),G(this,"handleMuteLocalTrack",async(s,c,u)=>{const h=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==$t.Connected)return void u(new ve(Y.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const p=this.filterTobeMutedTracks(s);if(p.length===0)return void c();const g=p.find(b=>b[0]==="videoLowTrack");g&&g[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(p.map(b=>{let[,{id:w}]=b;return w}));const y=this.createMuteMessage(p);await rn(this,Ye.RequestMuteLocal,y),c()}catch(p){u(p)}finally{h()}}),G(this,"handleUnmuteLocalTrack",async(s,c,u)=>{const h=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==$t.Connected)return void u(new ve(Y.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const p=this.filterTobeUnmutedTracks(s);if(p.length===0)return void c();const g=p.find(b=>b[0]==="videoLowTrack");if(g){const b=g[1];if(b.track._originMediaStreamTrack.stop(),!q("DISABLE_DUAL_STREAM_USE_ENCODING")&&xt().supportDualStreamEncoding){const w=s._mediaStreamTrack.clone();b.track._mediaStreamTrack=w,b.track._originMediaStreamTrack=w}else{const w=RD(s,c_(this,Ye.RequestLowStreamParameter));b.track._mediaStreamTrack=w,b.track._originMediaStreamTrack=w}await new De((w,C)=>{this.handleReplaceTrack(b.track,w,C,!0)})}await this.connection.unmuteLocal(p.map(b=>{let[,{id:w}]=b;return w}));const y=this.createUnmuteMessage(p);await rn(this,Ye.RequestUnmuteLocal,y),c()}catch(p){u(p)}finally{h()}}),G(this,"handleUpdateVideoEncoder",async(s,c,u,h)=>{let p;h||(p=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoEncoder"));try{const y=this.localTrackMap.get(Te.LocalVideoTrack);if(!this.connection||!y||y.track!==s||this.state!==$t.Connected)return void c();const{id:b,track:w}=y;await this.connection.updateSendParameters(b,w),await this.connection.updateEncoderConfig(b,w),this.emit(Ye.UpdateVideoEncoder,w),c()}catch(y){u(y)}finally{var g;(g=p)===null||g===void 0||g()}}),G(this,"handleUpdateVideoSendParameters",async(s,c,u)=>{const h=await this.mutex.lock("Locking from P2PChannel.handleUpdateVideoSendParameters");try{const p=this.localTrackMap.get(Te.LocalVideoTrack);if(!this.connection||!p||p.track!==s||this.state!==$t.Connected)return void c();const{id:g,track:y}=p;await this.connection.updateSendParameters(g,y),c()}catch(p){u(p)}finally{h()}}),G(this,"handleReplaceMixingTrack",async(s,c,u,h)=>{if(!this.connection||this.state!==$t.Connected)return void c();const p=TD([s]);let g;L.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(p.getTrackId(),"]")),typeof h=="boolean"&&h||(g=await this.mutex.lock("From P2PChannel.handleReplaceMixingTrack"));try{await this.replaceTrack(s,p),c()}catch(b){u(b)}finally{var y;(y=g)===null||y===void 0||y()}}),G(this,"handleReplaceTrack",async(s,c,u,h)=>{let p;L.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(s.getTrackId(),"]")),typeof h=="boolean"&&h||(p=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var g;const b=Array.from(this.localTrackMap.entries()).find(w=>{let[,{track:C}]=w;return s===C});if(!this.connection||!b||this.state!==$t.Connected)return void c();if(await((g=this.connection)===null||g===void 0?void 0:g.replaceTrack(s,b[1].id)),this.isPlanB){const w=b[1];w.id=s._mediaStreamTrack.id,this.localTrackMap.set(b[0],w)}if(b[0]===Te.LocalVideoTrack&&!q("DISABLE_DUAL_STREAM_USE_ENCODING")&&xt().supportDualStreamEncoding){const w=this.localTrackMap.get(Te.LocalVideoLowTrack);if(w){const C=s._mediaStreamTrack.clone();w.track._originMediaStreamTrack.stop(),w.track._mediaStreamTrack=C,w.track._originMediaStreamTrack=C,await new De((A,x)=>{this.handleReplaceTrack(w.track,A,x,!0)})}}c()}catch(b){u(b)}finally{var y;(y=p)===null||y===void 0||y()}}),G(this,"handleGetRTCStats",s=>{s(this.statsCollector.getRTCStats())}),G(this,"handleGetLocalVideoStats",s=>{s(this.statsCollector.getLocalVideoTrackStats())}),G(this,"handleGetLocalAudioStats",s=>{s(this.statsCollector.getLocalAudioTrackStats())}),G(this,"handleGetRemoteVideoStats",s=>this.statsCollector.getRemoteVideoTrackStats(s.uid)[s.uid]),G(this,"handleGetRemoteAudioStats",s=>this.statsCollector.getRemoteAudioTrackStats(s.uid)[s.uid]),this.store=r,this.statsCollector=o,this.statsCollector.addP2PChannel(this),this.statsUploader=new bY(this.store),this.bindStatsUploaderEvents(),this.mutex=new fi("P2PChannel-mutex",this.store.clientId),this.isPlanB=!xt().supportUnifiedPlan||q("CHROME_FORCE_PLAN_B")&&Wl(),this.shouldForwardP2PCreation=q("FORWARD_P2P_CREATION")&&xt().supportPCSetConfiguration&&a1(),this.shouldForwardP2PCreation&&(this.connection=bT(this.store),this.emit(Ye.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection))}async startP2PConnection(r){var o;this.state=$t.New,this._forceTurn=vY(r),L.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] forceTurn: ").concat(this._forceTurn));const s=this.shouldForwardP2PCreation&&((o=this.connection)===null||o===void 0?void 0:o.peerConnectionState)==="closed";if(this.shouldForwardP2PCreation&&!s||(s&&this.connection&&(L.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.resetConnection(this.connection)),this.connection=bT(this.store,r),this.emit(Ye.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),!this.connection)throw new ve(Y.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=q("NEW_ICE_RESTART")?ql.FIRST_CONNECTION:ql.OLD_FIRST_CONNECTION,this._isTryConnecting=!0,this._isStartRestartIce=!1,this._iceError=null,this.connection.setConfiguration(r),this.connection.establishPromise}async connect(r){if(!this.connection)throw new ve(Y.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");q("ENABLE_PREALLOC_PC")&&this.state===$t.Connected?await this.connection.updateRemoteConnect(r):(this.store.peerConnectionStart(),await this.connection.connect(r),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=$t.Connected)}updateRemoteRTPCapabilities(r){const o=Array.from(this.localTrackMap.entries()).filter(u=>{var h;let[p]=u;return Pe(h=[Te.LocalVideoLowTrack,Te.LocalVideoTrack]).call(h,p)}),s=o.map(u=>{let[,{id:h}]=u;return h}),c=o.map(u=>{let[h]=u;return h});if(this.connection instanceof tl){if(We.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(c),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(r)}),!Pe(r).call(r,this.store.codec)){const u=["vp9","vp8","h264"].find(h=>Pe(r).call(r,h));u&&(this.store.codec=u,L.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(u,".")))}this.connection.updateRemoteRTPCapabilities(s,r)}}async getEstablishParams(){var r;if(this.connection instanceof tl&&this.connection.peerConnectionState!=="closed"&&Pe(r=[$t.New,$t.Connected]).call(r,this.state))return this.connection.establishPromise}async publishDataChannel(r){if(!this.connection||this.state!==$t.Connected){if(this.state===$t.Disconnected)throw new ve(Y.UNEXPECTED_ERROR,"PeerConnection already disconnected.");return r.forEach(s=>{var c;Pe(c=this.pendingLocalDataChannels).call(c,s)||this.pendingLocalDataChannels.push(s)}),[]}const o=this.filterTobePublishedDataChannels(r);return o.length===0?[]:(o.forEach(s=>{const c=Date.now();this.store.publish(s.id.toString(),"datachannel",c)}),await this.connection.createDataChannels(this.store.uid,o),o.forEach(s=>{this.localDataChannels.push(s);const c=Date.now();this.store.publish(s.id+"","datachannel",void 0,c)}),r.map(s=>({streamId:s.id,ordered:s.ordered,maxRetransmits:s.maxRetransmits,metadata:s.metadata,channelId:s._originDataChannelId})))}publish(r,o,s){var c=this;return Is(function*(){const u=yield Ot(c.mutex.lock("From P2PChannel.publish"));try{var h;const p=c.connection&&Pe(h=["disconnected","failed"]).call(h,c.connection.peerConnectionState);if(!c.connection||c.state!==$t.Connected||p){if(c.state===$t.Disconnected)throw new ve(Y.UNEXPECTED_ERROR,"PeerConnection already disconnected.");c.throwIfTrackTypeNotMatch(r);const y=r.filter(b=>c.pendingLocalTracks.indexOf(b)===-1);return c.pendingLocalTracks=c.pendingLocalTracks.concat(y),void(p&&(c._isWaitPcToRePub=!0))}c.store.pubId=c.store.pubId+1,gi.markPublishStart(c.store.clientId,c.store.pubId);const g=c.filterTobePublishedTracks(r,o,s);if(g.length===0)return void(yield Ot(c.tryToUnmuteAudio(r)));yield*bw(CY(c.doPublish(c.connection,g)))}finally{u()}})()}doPublish(r,o){var s=this;return Is(function*(){o.forEach(A=>{let{track:x,type:B}=A;const U=Date.now();s.store.publish(x.getTrackId(),B===Te.LocalAudioTrack?"audio":"video",U)}),s.bindLocalTrackEvents(o);const c=o.map(A=>{let{track:x}=A;return x}),u=yield Ot(r.send(c,s.store.codec,s.store.audioCodec)),h=(yield Ot(u.next())).value,p=s.createGatewayPublishMessage(o,h);let g;try{g=yield p}catch(A){throw u.throw(A),(A==null?void 0:A.code)===Y.WS_ABORT&&o.forEach(x=>{let{track:B}=x;s.pendingLocalTracks.indexOf(B)===-1&&s.pendingLocalTracks.push(B)}),s.unbindLocalTrackEvents(o),A}const y=s.mapPubResToRemoteConfig(p,g,c),b=(yield Ot(u.next(y))).value;if(s.state===$t.Disconnected)throw new ve(Y.UNEXPECTED_ERROR,"PeerConnection already disconnected.");q("ENABLE_VIDEO_SEI");const w=q("ENABLE_ENCODED_TRANSFORM"),C=q("ENABLE_AUDIO_METADATA");c.forEach(async A=>{const x=A.getRTCRtpTransceiver();if(!x||!w)return;const{interceptLocalVideoFrame:B,interceptLocalAudioFrame:U}=pT();A.trackMediaType===je.VIDEO?await B(x.sender,A):A.trackMediaType===je.AUDIO&&await U(x.sender,{metadata:C?()=>{const F=A.metadata.shift();return F&&F.value}:void 0})}),o.forEach(A=>{let{type:x}=A;s.statsCollector.addLocalStats(x)}),s.assignLocalTracks(o,b),s.statsUploader.startUploadOutboundStats(),o.forEach(A=>{let{track:x,type:B}=A;const U=Date.now();s.store.publish(x.getTrackId(),B===Te.LocalAudioTrack?"audio":"video",void 0,U)})})()}async updateVideoStreamParameter(r,o){const s=this.localTrackMap.get(o);if(!s||!this.connection)return;if(!(s.track instanceof pn))return L.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");const{track:c}=s,u=function(h,p){const g={};return h.height&&h.width&&(g.scaleResolutionDownBy=cD(h,p)),g.maxFramerate=h.framerate?ko(h.framerate):void 0,g.maxBitrate=h.bitrate?1e3*h.bitrate:void 0,g}(r,c);if(c._encoderConfig||(c._encoderConfig={}),o!==Te.LocalVideoLowTrack||!q("DISABLE_DUAL_STREAM_USE_ENCODING")&&xt().supportDualStreamEncoding)u.scaleResolutionDownBy!=null&&(c._encoderConfig.scaleResolutionDownBy=u.scaleResolutionDownBy);else{const h=c._originMediaStreamTrack;if(!h.canvas)return L.warn("[".concat(c.getTrackId(),"] no canvas on track"));(function(p,g){const y=p.canvas;g.width&&(y.width=ko(g.width)),g.height&&(y.height=ko(g.height)),g.framerate&&(y.stopCapture&&y.stopCapture(),y.stopCapture=M1(()=>{!y.startCapture&&y.stopCapture&&y.stopCapture(),y.startCapture&&y.startCapture()},ko(g.framerate)))})(h,r)}u.maxBitrate!=null&&(c._encoderConfig.bitrateMax=u.maxBitrate/1e3),u.maxFramerate!=null&&(c._encoderConfig.frameRate&&typeof c._encoderConfig.frameRate=="object"?c._encoderConfig.frameRate.max=u.maxFramerate:c._encoderConfig.frameRate={max:u.maxFramerate}),L.debug("[".concat(c.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(c._encoderConfig))),await this.connection.updateRtpSenderEncodings(c)}publishLowStream(r){var o=this;return Is(function*(){if(!o.connection||o.state!==$t.Connected)return;const s=yield Ot(o.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const u=o.localTrackMap.get(Te.LocalVideoTrack);if(!u)throw new ve(Y.UNEXPECTED_ERROR,"Could not find high stream");if(o.localTrackMap.has(Te.LocalVideoLowTrack))throw new ve(Y.UNEXPECTED_ERROR,"[".concat(o.store.clientId,"] Can't publish low stream when stream already publish"));const h=[{track:o.getLowVideoTrack(u.track,r),type:Te.LocalVideoLowTrack}];if(yield*bw(CY(o.doPublish(o.connection,h))),u.track.muted||!u.track.enabled){var c;const p=(c=o.localTrackMap.get(Te.LocalVideoLowTrack))===null||c===void 0?void 0:c.id;p!==void 0&&(yield Ot(o.connection.muteLocal([p])))}}finally{s()}})()}async republish(){this.pendingLocalTracks.length>0&&(L.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await oi(this,Ye.RequestRePublish,this.pendingLocalTracks),this.emit(Ye.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(L.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await oi(this,Ye.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[]),this._isWaitPcToRePub=!1}async reSubscribe(r){for(let o=this.pendingRemoteTracks.length-1;o>=0;o--){const{user:s,kind:c}=this.pendingRemoteTracks[o];(c!==je.AUDIO||s._audio_added_&&s._audioSSRC)&&(c!==je.VIDEO||s._video_added_&&s._videoSSRC)||this.pendingRemoteTracks.splice(o,1)}if(r)await oi(this,Ye.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:o,kind:s}of this.pendingRemoteTracks)await this.subscribe(o,s,s===je.VIDEO?o._videoSSRC:o._audioSSRC);this.pendingRemoteTracks.forEach(o=>{let{user:s}=o;this.emit(Ye.MediaReconnectEnd,s.uid)}),this.pendingRemoteTracks=[]}async unpublish(r){if(!this.connection||this.state!==$t.Connected)return void r.forEach(c=>{const u=this.pendingLocalTracks.indexOf(c);u!==-1&&this.pendingLocalTracks.splice(u,1)});const o=this.filterTobeUnpublishedTracks(r);if(o.length===0)return;const s=o.find(c=>c[0]==="videoLowTrack");return s&&s[1].track.close(),this.doUnpublish(this.connection,o)}async unpublishDataChannel(r){if(!this.connection||this.state!==$t.Connected)return void r.forEach(s=>{const c=this.pendingLocalDataChannels.indexOf(s);c!==-1&&this.pendingLocalDataChannels.splice(c,1)});const o=this.filterTobeUnpublishedDataChannels(r);return o.length!==0?(o.forEach(s=>{const c=this.localDataChannels.indexOf(s);c!==-1&&this.localDataChannels.splice(c,1)}),this.localDataChannels.length===0&&await this.connection.stopDataChannels(this.store.uid),o.map(s=>s.id)):void 0}async unpublishLowStream(){if(!this.connection||this.state!==$t.Connected)return;const r=this.localTrackMap.get(Te.LocalVideoLowTrack);if(!r)return;r.track.close();const o=[[Te.LocalVideoLowTrack,r]];return this.doUnpublish(this.connection,o)}async doUnpublish(r,o){const s=this.createGatewayUnpublishMessage(o);return await r.stopSending(o.map(c=>{let[,{id:u}]=c;return u})),this.withdrawLocalTracks(o),this.unbindLocalTrackEvents(o.map(c=>{let[u,{track:h}]=c;return{type:u,track:h}})),o.forEach(c=>{let[u]=c;this.statsCollector.removeLocalStats(u)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadOutboundStats(),s}async subscribeDataChannel(r,o){if(!this.connection||this.state!==$t.Connected)throw new ve(Y.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const s=o.filter(c=>{var u;return!((u=this.remoteDataChannelMap.get(r))!==null&&u!==void 0&&u.get(c.id))});if(s.length!==0)return await this.connection.createDataChannels(r.uid,s),s.forEach(c=>{var u;this.remoteDataChannelMap.has(r)?(u=this.remoteDataChannelMap.get(r))===null||u===void 0||u.set(c.id,c):this.remoteDataChannelMap.set(r,new Map([[c.id,c]]));const h=this.pendingRemoteDataChannels.findIndex(p=>{let{user:g,id:y}=p;return g.uid===r.uid&&y===c.id});h!==-1&&this.pendingRemoteDataChannels.splice(h,1)}),s.map(c=>c.id)}async subscribe(r,o,s,c,u){var h;if(!this.connection||this.state!==$t.Connected)throw new ve(Y.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((h=this.remoteUserMap.get(r))!==null&&h!==void 0&&h.has(o))return;let p,g,y;const b=this.connection.getPreMedia(s);if(b)L.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] preSSRCMap has ssrcId: ").concat(s,", no need to send sub to gateway.")),y=b.transceiver,p=b.track,g=b.id;else if(u){const A=u.find(B=>{let{stream_type:U}=B;return U===o});if(!A)throw new ve(Y.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(o," for user: ").concat(r.uid," because subscribe answer from gateway does not contain stream_type: ").concat(o,"."));const x=await this.connection.receive(o,A.ssrcs,String(r._uintid),A.attributes);this.connection instanceof tl&&(y=x.transceiver),p=x.track,g=x.id}else{const A=await this.connection.receive(o,[{ssrcId:s,rtx:c}],String(r._uintid),void 0);this.connection instanceof tl&&(y=A.transceiver),p=A.track,g=A.id}if(o===je.AUDIO?(r._audioTrack?r._audioTrack._updateOriginMediaStreamTrack(p):(r._audioTrack=new Pm(p,r.uid,r._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(r._audioTrack.getTrackId()))),y&&r._audioTrack._updateRtpTransceiver(y),this.bindRemoteTrackEvents(r,r._audioTrack)):(r._videoTrack?r._videoTrack._updateOriginMediaStreamTrack(p):(r._videoTrack=new xm(p,r.uid,r._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(r._videoTrack.getTrackId()))),y&&r._videoTrack._updateRtpTransceiver(y),this.bindRemoteTrackEvents(r,r._videoTrack)),y&&q("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:A,interceptRemoteAudioFrame:x}=pT();o==je.VIDEO?await A(y.receiver,{onSei:q("ENABLE_VIDEO_SEI")&&(B=>{var U;return(U=r._videoTrack)===null||U===void 0?void 0:U._onSei(B)})}):o==je.AUDIO&&await x(y.receiver,{enableTopn:!!q("ENABLE_AUDIO_TOPN"),enableMetadata:!!q("ENABLE_AUDIO_METADATA"),onMetadata:B=>{this.safeEmit(Ye.AudioMetadata,B)}})}const w=this.remoteUserMap.get(r);w?w.set(o,g):this.remoteUserMap.set(r,new Map([[o,g]])),this.statsCollector.addRemoteStats(r.uid),this.statsUploader.startUploadInboundStats();const C=this.pendingRemoteTracks.findIndex(A=>{let{user:x,kind:B}=A;return x.uid===r.uid&&o===B});C!==-1&&(this.pendingRemoteTracks.splice(C,1),this.emit(Ye.MediaReconnectEnd,r.uid))}async massSubscribe(r){return this.massSubscribeNoLock(r)}async massSubscribeNoLock(r){if(!this.connection||this.state!==$t.Connected)throw new ve(Y.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");r=r.filter(u=>{var h;let{user:p,mediaType:g}=u;return!((h=this.remoteUserMap.get(p))!==null&&h!==void 0&&h.has(g))});const o=[],s=new Map;r.forEach(u=>{if(!this.connection)return;const h=this.connection.getPreMedia(u.ssrcId);h?s.set(u.ssrcId,h):o.push(u)});const c=await this.connection.batchReceive(o.map(u=>{let{user:h,mediaType:p,ssrcId:g,rtxSsrcId:y}=u;return{kind:p,ssrcMsg:[{ssrcId:g,rtx:y}],mslabel:String(h._uintid)}}));o.forEach((u,h)=>{s.set(u.ssrcId,c[h])});for(const{user:u,mediaType:h,ssrcId:p}of r){const g=s.get(p);if(!g)return void L.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] cannot find ").concat(u.uid," subscribe data,").concat(h,", ").concat(p));const{track:y,id:b,transceiver:w}=g;if(w&&q("ENABLE_ENCODED_TRANSFORM")){const{interceptRemoteVideoFrame:x,interceptRemoteAudioFrame:B}=pT();h==je.VIDEO?await x(w.receiver,{onSei:q("ENABLE_VIDEO_SEI")&&(U=>{var F;return(F=u._videoTrack)===null||F===void 0?void 0:F._onSei(U)})}):h==je.AUDIO&&await B(w.receiver,{enableTopn:!!q("ENABLE_AUDIO_TOPN"),enableMetadata:!!q("ENABLE_AUDIO_METADATA"),onMetadata:U=>{this.safeEmit(Ye.AudioMetadata,U)}})}if(h===je.AUDIO?(u._audioTrack?u._audioTrack._updateOriginMediaStreamTrack(y):(u._audioTrack=new Pm(y,u.uid,u._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(u._audioTrack.getTrackId()))),w&&u._audioTrack._updateRtpTransceiver(w),this.bindRemoteTrackEvents(u,u._audioTrack)):(u._videoTrack?u._videoTrack._updateOriginMediaStreamTrack(y):(u._videoTrack=new xm(y,u.uid,u._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(u._videoTrack.getTrackId()))),w&&u._videoTrack._updateRtpTransceiver(w),this.bindRemoteTrackEvents(u,u._videoTrack)),q("ENABLE_VIDEO_SEI")&&w){const{interceptRemoteVideoFrame:x,interceptRemoteAudioFrame:B}=pT();h==je.VIDEO?await x(w.receiver,{onSei:U=>{var F;(F=u._videoTrack)===null||F===void 0||F._onSei(U)}}):h==je.AUDIO&&await B(w.receiver)}const C=this.remoteUserMap.get(u);C?C.set(h,b):this.remoteUserMap.set(u,new Map([[h,b]])),this.statsCollector.addRemoteStats(u.uid),this.statsUploader.startUploadInboundStats();const A=this.pendingRemoteTracks.findIndex(x=>{let{user:B,kind:U}=x;return B.uid===u.uid&&h===U});A!==-1&&(this.pendingRemoteTracks.splice(A,1),this.emit(Ye.MediaReconnectEnd,u.uid))}}async unsubscribe(r,o,s){const c=this.pendingRemoteTracks.filter(p=>{let{user:g,kind:y}=p;return o!==void 0?g.uid===r.uid&&o===y:g.uid===r.uid});if(c.forEach(p=>{const g=this.pendingRemoteTracks.indexOf(p);this.pendingRemoteTracks.splice(g,1)}),this.connection&&this.state===$t.Connected||s||c.forEach(p=>{let{kind:g}=p;var y;if(g===je.AUDIO)(y=r._audioTrack)===null||y===void 0||y._destroy(),r._audioTrack=void 0;else if(g===je.VIDEO){var b;(b=r._videoTrack)===null||b===void 0||b._destroy(),r._videoTrack=void 0}}),!this.connection||this.state!==$t.Connected)return;const u=this.filterTobeUnSubscribedTracks(r,o);if(u.length===0)return;await this.connection.stopReceiving(u.map(p=>{let[,{id:g}]=p;return g}));const h=this.createUnsubscribeMessage(u);return this.withdrawRemoteTracks(u),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),u.forEach(p=>{let[g,{kind:y}]=p;var b,w;if(y===je.VIDEO&&g._videoSSRC&&((b=this.connection)===null||b===void 0||b.setStatsRemoteVideoIsReady(g._videoSSRC,!1)),y===je.VIDEO)this.unbindRemoteTrackEvents(g._videoTrack),s||((w=g._videoTrack)===null||w===void 0||w._destroy(),g._videoTrack=void 0);else if(y===je.AUDIO){var C;this.unbindRemoteTrackEvents(g._audioTrack),!s&&((C=g._audioTrack)===null||C===void 0||C._destroy(),g._audioTrack=void 0)}}),h}async unsubscribeDataChannel(r,o){if(o.forEach(u=>{const h=this.pendingRemoteDataChannels.findIndex(p=>p.id===u.id);h!==-1&&this.pendingRemoteDataChannels.splice(h,1)}),!this.connection)return;const s=this.filterTobeUnSubscribedDataChannels(r,o);if(s.length===0)return;o.forEach(u=>{u._close()});const c=this.remoteDataChannelMap.get(r);return s.forEach(u=>{c&&c.delete(u.id)}),c&&c.size===0&&(this.remoteDataChannelMap.delete(r),await this.connection.stopDataChannels(r.uid)),s.map(u=>u.id)}async massUnsubscribe(r){return this.massUnsubscribeNoLock(r)}async massUnsubscribeNoLock(r){let o=[];for(const{user:u,mediaType:h}of r){const p=this.pendingRemoteTracks.filter(g=>{let{user:y,kind:b}=g;return h!==void 0?y.uid===u.uid&&h===b:y.uid===u.uid});p.forEach(g=>{const y=this.pendingRemoteTracks.indexOf(g);this.pendingRemoteTracks.splice(y,1)}),o=o.concat(p)}if(!this.connection||this.state!==$t.Connected)return void o.forEach(u=>{let{user:h,kind:p}=u;var g;if(p===je.AUDIO)(g=h._audioTrack)===null||g===void 0||g._destroy(),h._audioTrack=void 0;else if(p===je.VIDEO){var y;(y=h._videoTrack)===null||y===void 0||y._destroy(),h._videoTrack=void 0}});const s=oa(r).call(r,(u,h)=>{let{user:p,mediaType:g}=h;const y=this.filterTobeUnSubscribedTracks(p,g);return u.concat(y)},[]);if(s.length===0)return;await this.connection.stopReceiving(s.map(u=>{let[,{id:h}]=u;return h}));const c=this.createUnsubscribeAllMessage(s);return this.withdrawRemoteTracks(s),this.remoteUserMap.size===0&&this.statsUploader.stopUploadInboundStats(),s.forEach(u=>{let[h,{kind:p}]=u;var g,y;if(p===je.VIDEO&&h._videoSSRC&&((g=this.connection)===null||g===void 0||g.setStatsRemoteVideoIsReady(h._videoSSRC,!1)),p===je.VIDEO)this.unbindRemoteTrackEvents(h._videoTrack),(y=h._videoTrack)===null||y===void 0||y._destroy(),h._videoTrack=void 0;else if(p===je.AUDIO){var b;this.unbindRemoteTrackEvents(h._audioTrack),(b=h._audioTrack)===null||b===void 0||b._destroy(),h._audioTrack=void 0}}),c}isPreSubScribe(r){return!this.connection||this.state!==$t.Connected?!1:!!this.connection.getPreMedia(r)}async muteRemote(r,o){if(!this.connection)return;const s=this.remoteUserMap.get(r);if(!s)return void L.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(r.uid,"."));if(!s.get(o))return void L.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(r.uid," media type ").concat(o,"."));const c=o===je.VIDEO?r._videoSSRC:r._audioSSRC;c!==void 0&&this.connection.setStatsRemoteVideoIsReady(c,!1)}async unmuteRemote(r,o){return this.unmuteRemoteNoLock(r,o)}async unmuteRemoteNoLock(r,o){if(!this.connection)return;const s=this.remoteUserMap.get(r);if(!s)return void L.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(r.uid,"."));s.get(o)||L.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(r.uid," media type ").concat(o,"."))}addAudioMetadata(r){const o=this.localTrackMap.get(Te.LocalAudioTrack),s=o&&o.track;s&&s.metadata.push(r)}getAllTracks(r){const o=this.localTrackMap.get(Te.LocalAudioTrack);if((o==null?void 0:o.track)instanceof lr){const s=o.track;return Array.from(this.localTrackMap.entries()).filter(c=>{let[u]=c;return u!==Te.LocalAudioTrack}).filter(c=>{let[u]=c;return!(r&&u===Te.LocalVideoLowTrack)}).map(c=>{let[,{track:u}]=c;return u}).concat(s.trackList)}return Array.from(this.localTrackMap.entries()).filter(s=>{let[c]=s;return!(r&&c===Te.LocalVideoLowTrack)}).map(s=>{let[,{track:c}]=s;return c})}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(r,o,s,c,u){if(r){const p=this.localTrackMap.get(Te.LocalAudioTrack),g=c?this.localTrackMap.get(Te.LocalVideoLowTrack):this.localTrackMap.get(Te.LocalVideoTrack);We.publish(this.store.sessionId,{eventElapse:gi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:r,ec:o,audioName:p==null?void 0:p.track.getTrackLabel(),videoName:g==null?void 0:g.track.getTrackLabel(),screenshare:(g==null?void 0:g.track._hints.indexOf(Zt.SCREEN_TRACK))!==-1,audio:!!p,video:!!g,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}else{var h;s||(s=[]);const p=s.find(y=>y instanceof jn),g=c?(h=this.localTrackMap.get(Te.LocalVideoTrack))===null||h===void 0?void 0:h.track:s.find(y=>y instanceof pn);We.publish(this.store.sessionId,{eventElapse:gi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:r,ec:o,audioName:p==null?void 0:p.getTrackLabel(),videoName:g==null?void 0:g.getTrackLabel(),screenshare:(g==null?void 0:g._hints.indexOf(Zt.SCREEN_TRACK))!==-1,audio:!!p,video:!!g,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}}reportSubscribeEvent(r,o,s,c){const u=c===je.VIDEO?s._videoSSRC:s._audioSSRC;u&&We.subscribe(this.store.sessionId,{succ:r,ec:o,video:c===je.VIDEO,audio:c===je.AUDIO,peerid:s.uid,subscribeRequestid:u,p2pid:this.store.p2pId,eventElapse:gi.measureFromSubscribeStart(this.store.clientId,u),preSsrc:this.isPreSubScribe(u)})}reset(){L.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new fi("P2PChannel-mutex",this.store.clientId),this.connection&&(this.resetConnection(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=bT(this.store),this.emit(Ye.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.statsUploader.stopUploadBaseStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const r=this.localTrackMap.get(Te.LocalAudioTrack);if((r==null?void 0:r.track)instanceof lr){if(r.track.trackList.length>0){const o=r.track;r.track.trackList.forEach(s=>{o.removeAudioTrack(s)})}r.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=$t.Disconnected}getStats(){var r;return(r=this.connection)===null||r===void 0?void 0:r.getStats()}getRemoteVideoIsReady(r){var o;return((o=this.connection)===null||o===void 0?void 0:o.getRemoteVideoIsReady(r))||!1}getLocalAudioVolume(){const r=this.localTrackMap.get(Te.LocalAudioTrack);if(r)return r.track.getVolumeLevel()}getLocalVideoSize(){const r=this.localTrackMap.get(Te.LocalVideoTrack);if(r)return{width:r.track.videoWidth||0,height:r.track.videoHeight||0}}getEncoderConfig(r){const o=this.localTrackMap.get(r);return o&&o.track instanceof pn||o&&o.track instanceof jn?o.track._encoderConfig:void 0}getLocalMedia(r){return this.localTrackMap.get(r)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(r,o){if(!r)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(r);return!!s&&(!o||s.has(o))}async hasRemoteMediaWithLock(r,o){if(!r)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(r);return!!s&&(!o||s.has(o))}getRemoteMedia(r){var o;const s=Array.from(ts(o=this.remoteUserMap).call(o)).find(c=>c.uid===r);return s?{audioTrack:s.audioTrack,audioSSRC:s._audioSSRC,videoTrack:s.videoTrack,videoSSRC:s._videoSSRC}:{}}getAudioLevels(){let r=Array.from(this.remoteUserMap.entries()).map(s=>{let[c]=s;return{uid:c.uid,level:c.audioTrack?100*c.audioTrack._source.getAccurateVolumeLevel():0}});const o=this.localTrackMap.get(Te.LocalAudioTrack);return o&&r.push({level:100*o.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),r=Yh(r).call(r,(s,c)=>s.level-c.level),r}async disconnectForReconnect(){this.connection&&(L.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=$t.Reconnecting,q("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(r=>{let[o]=r;var s;o._videoTrack&&o._videoTrack._player&&((s=o._videoTrack._player.getVideoElement())===null||s===void 0||s.pause(),o._videoTrack._player.isKeepLastFrame=!0,o._videoTrack._originMediaStreamTrack.stop())}),this.resetConnection(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=bT(this.store),this.emit(Ye.PeerConnectionStateChange,this.connection.peerConnectionState),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(r=>{var o;let[s,{track:c}]=r;switch(s){case Te.LocalVideoTrack:Pe(o=c._hints).call(o,Zt.LOW_STREAM)?c.close():this.pendingLocalTracks.push(c);break;case Te.LocalAudioTrack:c instanceof lr?this.pendingLocalTracks=this.pendingLocalTracks.concat(c.trackList):this.pendingLocalTracks.push(c);case Te.LocalVideoLowTrack:}}),this.emit(Ye.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(r=>{let[o,s]=r;Array.from(ts(s).call(s)).forEach(c=>{this.setPendingRemoteMedia(o,c)}),this.emit(Ye.MediaReconnectStart,o.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.localDataChannels.length!==0&&(this.localDataChannels.forEach(r=>{this.pendingLocalDataChannels.push(r)}),this.localDataChannels.length=0),this.remoteDataChannelMap.size!==0&&(Array.from(this.remoteDataChannelMap.entries()).forEach(r=>{let[o,s]=r;Array.from(ts(s).call(s)).forEach(c=>{this.setPendingRemoteDataChannel(o,c)})}),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),L.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(r,o){for(const s of this.pendingRemoteDataChannels){const{user:c,id:u}=s;if((r instanceof _d?r.uid:r)===c.uid&&u===o)return!0}return!1}setPendingRemoteDataChannel(r,o){this.hasPendingRemoteDataChannel(r,o)||this.pendingRemoteDataChannels.push({user:r,id:o})}hasPendingRemoteMedia(r,o){for(const s of this.pendingRemoteTracks){const{user:c,kind:u}=s;if((r instanceof _d?r.uid:r)===c.uid&&o===u)return!0}return!1}setPendingRemoteMedia(r,o){this.hasPendingRemoteMedia(r,o)||this.pendingRemoteTracks.push({user:r,kind:o})}restartICE(r){var o=this;return Is(function*(){if(!o.connection||o.state!==$t.Connected)return;const s=yield Ot(o.mutex.lock("From P2PChannel.restartICE"));let c;try{c=yield Ot(o.connection.restartICE(r));const h=yield Ot(c.next());if(h.done)return;const p=h.value,g=yield p;switch(CD(o.connection)&&o.reportPCStats(Date.now(),!1,o._pcStatsUploadType),r){case mi.UDP_TCP_RELAY:o._pcStatsUploadType=ql.UDP_TCP_RESTART;break;case mi.TCP_RELAY:o._pcStatsUploadType=ql.TCP_RESTART;break;case mi.RELAY:o._pcStatsUploadType=ql.RELAY_RESTART;break;default:o._pcStatsUploadType=ql.OLD_RESTART}o._isTryConnecting=!0,c.next(g)}catch(h){var u;(u=c)===null||u===void 0||u.throw(h)}finally{s()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const r=this.connection.getStats(),o=this.localTrackMap.get(Te.LocalVideoTrack),s=this.localTrackMap.get(Te.LocalAudioTrack),c=r.videoSend.find(x=>x.ssrc===(o==null?void 0:o.ssrcs[0].ssrcId)),u=r.audioSend.find(x=>x.ssrc===(s==null?void 0:s.ssrcs[0].ssrcId));if(!c||!u)return 1;const h=Zo(this,Ye.NeedSignalRTT),p=c?c.rttMs:void 0,g=u?u.rttMs:void 0,y=p&&g?(p+g)/2:p||g,b=(y&&h?(y+h)/2:y||h)||0,w=100*r.sendPacketLossRate*.7/50+.3*b/1500,C=w<.17?1:w<.36?2:w<.59?3:w<.1?4:5,A=o==null?void 0:o.track;if(A&&A._encoderConfig&&A._hints.indexOf(Zt.SCREEN_TRACK)===-1){const x=A._encoderConfig.bitrateMax,B=r.bitrate.actualEncoded;if(x&&B){const U=(1e3*x-B)/(1e3*x);return lz[U<.15?0:U<.3?1:U<.45?2:U<.6?3:4][C]}}return C}getDownlinkNetworkQuality(){if(!this.connection)return 0;const r=this.connection.getStats();let o=0;return Array.from(this.remoteUserMap.entries()).forEach(s=>{let[c]=s;const u=c._audioSSRC,h=c._videoSSRC,p=r.audioRecv.find(B=>B.ssrc===u),g=r.videoRecv.find(B=>B.ssrc===h);if(!p&&!g)return void(o+=1);const y=Zo(this,Ye.NeedSignalRTT),b=r.rtt,w=(b&&y?(b+y)/2:b||y)||0,C=p?p.jitterMs:void 0,A=r.recvPacketLossRate;let x=.7*A*100/50+.3*w/1500;C&&(x=.6*A*100/50+.2*w/1500+.2*C/400),o+=x<.1?1:x<.17?2:x<.36?3:x<.59?4:5}),this.remoteUserMap.size>0?Math.round(o/this.remoteUserMap.size):o}async muteLocalTrack(r){return new De((o,s)=>{this.handleMuteLocalTrack(r,o,s)})}async replaceTrack(r,o){var s;if(L.debug("[".concat(this.store.clientId,"] P2PChannel replaceTrack from [").concat(r.getTrackId(),"] to [").concat(o.getTrackId(),"]")),!this.connection||this.state!==$t.Connected)return;const c=Array.from(this.localTrackMap.entries()).find(h=>{let[,{track:p}]=h;return r===p});if(!c)return;const u=c[0];if(r!==o&&(this.unbindLocalTrackEvents([{track:r,type:u}]),this.bindLocalTrackEvents([{track:o,type:u}]),c[1].track=o),await((s=this.connection)===null||s===void 0?void 0:s.replaceTrack(o,c[1].id)),this.isPlanB){const h=c[1];h.id=o._mediaStreamTrack.id,this.localTrackMap.set(u,h)}if(u===Te.LocalVideoTrack&&!q("DISABLE_DUAL_STREAM_USE_ENCODING")&&xt().supportDualStreamEncoding){const h=this.localTrackMap.get(Te.LocalVideoLowTrack);if(h){const p=r._mediaStreamTrack.clone();h.track._originMediaStreamTrack.stop(),h.track._mediaStreamTrack=p,h.track._originMediaStreamTrack=p,await new De((g,y)=>{this.handleReplaceTrack(h.track,g,y,!0)})}}}filterTobePublishedTracks(r,o,s){const c=[],u=this.getAllTracks();r=vm(r=r.filter(y=>u.indexOf(y)===-1));let h,p=!1;const g=this.localTrackMap.get(Te.LocalAudioTrack);for(const y of r){if(y instanceof pn&&(this.localTrackMap.has(Te.LocalVideoTrack)||p?new ve(Y.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(c.push({track:y,type:Te.LocalVideoTrack}),p=!0),o)){const b=this.getLowVideoTrack(y,s);c.push({track:b,type:Te.LocalVideoLowTrack})}if(y instanceof jn)if(g){const b=g.track;if(b instanceof lr)wD([y]),b.addAudioTrack(y),this.bindLocalAudioTrackEvents(y,!0);else{const w=TD([b,y]);L.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will replace audioTrack [").concat(w.getTrackId(),"]")),this.replaceTrack(b,w)}}else h instanceof lr?(wD([y]),h.addAudioTrack(y)):h||!y._useAudioElement&&xt().webAudioMediaStreamDest&&!y._bypassWebAudio?h=TD(h?[y,h]:[y]):h=y}return h&&(L.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection will send audioTrack [").concat(h.getTrackId(),"]")),c.push({track:h,type:Te.LocalAudioTrack})),c}filterTobeUnpublishedTracks(r){const o=[],s=this.getAllTracks();r=vm(r=r.filter(c=>s.indexOf(c)!==-1));for(const c of r){if(c instanceof jn){const u=this.localTrackMap.get(Te.LocalAudioTrack);if(!u)continue;u.track instanceof lr?(u.track.removeAudioTrack(c),this.unbindLocalAudioTrackEvents(c),u.track.trackList.length===0&&(o.push([Te.LocalAudioTrack,u]),u.track.close())):o.push([Te.LocalAudioTrack,u])}if(c instanceof pn){const u=this.localTrackMap.get(Te.LocalVideoTrack);if(!u)continue;o.push([Te.LocalVideoTrack,u]);const h=this.localTrackMap.get(Te.LocalVideoLowTrack);h&&o.push([Te.LocalVideoLowTrack,h])}}return o}filterTobePublishedDataChannels(r){return r=(r=vm(r)).filter(o=>this.localDataChannels.findIndex(s=>s.id===o.id)===-1)}filterTobeUnpublishedDataChannels(r){return r=(r=(r=vm(r)).filter(o=>this.localDataChannels.indexOf(o)!==-1)).filter(o=>o._originDataChannel)}bindLocalTrackEvents(r){r.forEach(o=>{let{track:s,type:c}=o;switch(c){case Te.LocalVideoTrack:s.addListener(Fe.GET_STATS,this.handleGetLocalVideoStats),s.addListener(Fe.GET_RTC_STATS,this.handleGetRTCStats),s.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(Fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.addListener(Fe.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),s.addListener(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Te.LocalAudioTrack:this.bindLocalAudioTrackEvents(s);case Te.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(r,o){r instanceof lr?r.trackList.forEach(s=>{s.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(Fe.GET_STATS,this.handleGetLocalAudioStats),s.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(r.addListener(Fe.GET_STATS,this.handleGetLocalAudioStats),r.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),o||(r.addListener(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.addListener(Fe.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack)))}unbindLocalTrackEvents(r){r||(r=Array.from(this.localTrackMap.entries()).map(o=>{let[s,{track:c}]=o;return{track:c,type:s}})),r.forEach(o=>{let{track:s,type:c}=o;switch(c){case Te.LocalVideoTrack:s.off(Fe.GET_STATS,this.handleGetLocalVideoStats),s.off(Fe.GET_RTC_STATS,this.handleGetRTCStats),s.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.off(Fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.off(Fe.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),s.off(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Te.LocalAudioTrack:this.unbindLocalAudioTrackEvents(s);case Te.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(r){r instanceof lr?r.trackList.forEach(o=>{o.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),o.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),o.off(Fe.GET_STATS,this.handleGetLocalAudioStats),o.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),o.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(r.off(Fe.GET_STATS,this.handleGetLocalAudioStats),r.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.off(Fe.NEED_REPLACE_MIXING_TRACK,this.handleReplaceMixingTrack),r.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(r,o){o instanceof xm&&o.addListener(Fe.GET_STATS,s=>{s(this.handleGetRemoteVideoStats(r))}),o instanceof Pm&&o.addListener(Fe.GET_STATS,s=>{s(this.handleGetRemoteAudioStats(r))})}unbindRemoteTrackEvents(r){r&&r.removeAllListeners(Fe.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(r=>{let[o,s]=r;s.has(je.AUDIO)&&this.unbindRemoteTrackEvents(o._audioTrack),s.has(je.VIDEO)&&this.unbindRemoteTrackEvents(o._videoTrack)})}createGatewayPublishMessage(r,o){return r.map((s,c)=>{var u;let h,p,{track:g,type:y}=s;switch(y){case Te.LocalAudioTrack:h=Ht.Audio,p={dtx:g instanceof p_&&g._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case Te.LocalVideoTrack:h=Pe(u=g._hints).call(u,Zt.SCREEN_TRACK)?Ht.Screen:Ht.High,p=nl(nl({},Cz(g)),{},{codec:this.store.codec,svc_mode:lT()});break;case Te.LocalVideoLowTrack:h=Ht.Low,p=nl(nl({},Cz(g)),{},{codec:this.store.codec,svc_mode:lT()})}return{stream_type:h,attributes:p,ssrcs:o[c]}})}createGatewayUnpublishMessage(r){return r.map(o=>{var s;let c,[u,{track:h,ssrcs:p,id:g}]=o;switch(u){case Te.LocalVideoTrack:c=Pe(s=h._hints).call(s,Zt.SCREEN_TRACK)?Ht.Screen:Ht.High;break;case Te.LocalAudioTrack:c=Ht.Audio;break;case Te.LocalVideoLowTrack:c=Ht.Low}return{stream_type:c,ssrcs:p,mid:g}})}assignLocalTracks(r,o){r.forEach((s,c)=>{let{track:u,type:h}=s;this.localTrackMap.set(h,{track:u,id:o[c].id,ssrcs:o[c].localSSRC})})}withdrawLocalTracks(r){r.forEach(o=>{let[s]=o;this.localTrackMap.delete(s)})}bindConnectionEvents(r){r.onConnectionStateChange=async o=>{if(L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(o,")")),this.emit(Ye.PeerConnectionStateChange,o),o==="connecting"&&r instanceof tl&&!xn()&&q("FIRST_TCP_CANDIDATE")&&window.setTimeout(()=>{o==="connecting"&&r.extendCandidate()},q("FIRST_TCP_CANDIDATE_INTERVAL")),o!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),o==="connected"&&(this._restartTimer&&(window.clearTimeout(this._restartTimer),this._restartTimer=void 0),r instanceof tl&&SY(r,!0),this._isTryConnecting&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isTryConnecting=!1,this._isStartRestartIce=!1,this._pcStatsUploadType=ql.DISCONNECTED_OR_FAILED,Zo(this,Ye.QueryClientConnectionState)==="CONNECTED"&&this._isWaitPcToRePub)){const s=this.pendingLocalTracks.map(u=>u.getTrackId()),c=this.pendingLocalDataChannels.map(u=>"dc_".concat(u.id));We.reportApiInvoke(this.store.sessionId,{name:Yn.REPUB_AFTER_PC_CONNECTED,options:s.concat(c),tag:Nn.TRACER}).onSuccess(),this.republish()}if(q("NEW_ICE_RESTART")&&r instanceof tl&&!xn()&&!this._forceTurn){if(Pe(_z).call(_z,o)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const s=u=>{CD(r)&&(L.debug("[".concat(this.store.clientId,"] [P2PChannel] try to restartICE, type is ").concat(u)),Zo(this,Ye.QueryClientConnectionState)==="CONNECTED"&&this.emit(Ye.RequestRestartICE,u))},c=()=>{CD(r)&&(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),L.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(Ye.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())};return void(this._restartTimer=window.setTimeout(()=>{wY(r,s,c)},800))}}else{if(o==="disconnected"&&r.iceConnectionState==="disconnected")return setTimeout(()=>{r.iceConnectionState==="disconnected"&&q("ICE_RESTART")&&Zo(this,Ye.QueryClientConnectionState)==="CONNECTED"&&this.emit(Ye.RequestRestartICE)},800),void setTimeout(()=>{r.peerConnectionState==="disconnected"&&(L.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isTryConnecting=!1,setTimeout(()=>this.emit(Ye.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);o==="failed"&&(L.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),setTimeout(()=>this.emit(Ye.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},r.onICEConnectionStateChange=o=>{o!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(o,")")),We.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:o,tag:Nn.TRACER}).onSuccess(),this.emit(Ye.IceConnectionStateChange,o)},r.onICETransportStateChange=o=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(o,")"))},r.onDTLSTransportStateChange=o=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(o,")"))},r.onDTLSTransportError=o=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(o,")"))},r.onFirstAudioDecoded=o=>{var s;const c=Array.from(ts(s=this.remoteUserMap).call(s)).find(h=>h._audioSSRC===o);var u;c&&(this.store.subscribe(c.uid,"audio",void 0,void 0,void 0,Date.now()),(u=c.audioTrack)===null||u===void 0||u.emit(Cm.FIRST_FRAME_DECODED),We.firstRemoteFrame(this.store.sessionId,Ar.FIRST_AUDIO_DECODE,Tn.FIRST_AUDIO_DECODE,{peer:c._uintid,subscribeElapse:gi.measureFromSubscribeStart(this.store.clientId,o),subscribeRequestid:o,p2pid:this.store.p2pId}))},r.onFirstAudioReceived=o=>{var s;const c=Array.from(ts(s=this.remoteUserMap).call(s)).find(u=>u._audioSSRC===o);c&&We.firstRemoteFrame(this.store.sessionId,Ar.FIRST_AUDIO_RECEIVED,Tn.FIRST_AUDIO_RECEIVED,{peer:c._uintid,subscribeElapse:gi.measureFromSubscribeStart(this.store.clientId,o),subscribeRequestid:o,p2pid:this.store.p2pId})},r.onFirstVideoDecoded=(o,s,c)=>{this.reportVideoFirstFrameDecoded(o,s,c)},r.onFirstVideoReceived=o=>{var s;const c=Array.from(ts(s=this.remoteUserMap).call(s)).find(u=>u._videoSSRC===o);c&&We.firstRemoteFrame(this.store.sessionId,Ar.FIRST_VIDEO_RECEIVED,Tn.FIRST_VIDEO_RECEIVED,{peer:c._uintid,subscribeElapse:gi.measureFromSubscribeStart(this.store.clientId,o),subscribeRequestid:o,p2pid:this.store.p2pId})},r.onSelectedLocalCandidateChanged=(o,s)=>{const c=o.candidateType==="relay",u=s.candidateType==="relay";s.candidateType!=="unknown"&&c===u||this.emit(Ye.ConnectionTypeChange,c),L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(gd(s))," -> ").concat(JSON.stringify(gd(o)),")"))},r.onSelectedRemoteCandidateChanged=(o,s)=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(gd(s))," -> ").concat(JSON.stringify(gd(o)),")"))},r.onFirstVideoDecodedTimeout=o=>{this.reportVideoFirstFrameDecoded(o,void 0,void 0,!0)},r.getLocalVideoStats=()=>{const o=this.statsCollector.getLocalVideoTrackStats(),s=this.statsCollector.getRTCStats();return nl(nl({},o),s)},r.onICECandidateError=o=>{this._iceError=o}}resetConnection(r){r instanceof tl&&function(o){Gm.delete(o.id),SY(o)}(r),r.close(),this.emit(Ye.PeerConnectionStateChange,"closed"),function(o){o.onConnectionStateChange=void 0,o.onICEConnectionStateChange=void 0,o.onICETransportStateChange=void 0,o.onDTLSTransportStateChange=void 0,o.onDTLSTransportError=void 0,o.onFirstAudioDecoded=void 0,o.onFirstAudioReceived=void 0,o.onFirstVideoDecoded=void 0,o.onFirstVideoReceived=void 0,o.onSelectedLocalCandidateChanged=void 0,o.onSelectedRemoteCandidateChanged=void 0,o.onFirstVideoDecodedTimeout=void 0,o.getLocalVideoStats=void 0}(r),this._isWaitPcToRePub=!1}filterTobeMutedTracks(r){const o=[];if(this.getAllTracks().indexOf(r)===-1)return o;const s=this.localTrackMap.get(Te.LocalAudioTrack);if(r instanceof jn&&(s==null?void 0:s.track)instanceof lr)return s.track.isActive||o.push([Te.LocalAudioTrack,s]),o;const c=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:h}]=u;return r===h});if(c&&(o.push(c),c[0]===Te.LocalVideoTrack)){const u=this.localTrackMap.get(Te.LocalVideoLowTrack);u&&o.push([Te.LocalVideoLowTrack,u])}return o}filterTobeUnmutedTracks(r){const o=[],s=this.localTrackMap.get(Te.LocalAudioTrack);if(r instanceof jn&&(s==null?void 0:s.track)instanceof lr)return s.track.isActive&&o.push([Te.LocalAudioTrack,s]),o;const c=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:h}]=u;return r===h});if(c)if(c[0]===Te.LocalVideoTrack){o.push(c);const u=this.localTrackMap.get(Te.LocalVideoLowTrack);u&&o.push([Te.LocalVideoLowTrack,u])}else o.push(c);return o}createMuteMessage(r){return r.map(o=>{var s;let c,[u,{track:h,ssrcs:p,id:g}]=o;switch(u){case Te.LocalAudioTrack:c=Ht.Audio;break;case Te.LocalVideoTrack:c=Pe(s=h._hints).call(s,Zt.SCREEN_TRACK)?Ht.Screen:Ht.High;break;case Te.LocalVideoLowTrack:c=Ht.Low}return{stream_type:c,ssrcs:p,mid:g}})}createUnmuteMessage(r){return r.map(o=>{var s;let c,[u,{track:h,ssrcs:p,id:g}]=o;switch(u){case Te.LocalAudioTrack:c=Ht.Audio;break;case Te.LocalVideoTrack:c=Pe(s=h._hints).call(s,Zt.SCREEN_TRACK)?Ht.Screen:Ht.High;break;case Te.LocalVideoLowTrack:c=Ht.Low}return{stream_type:c,ssrcs:p,mid:g}})}filterTobeUnSubscribedTracks(r,o){const s=[],c=this.remoteUserMap.get(r);if(!c)return s;if(o){const u=c.get(o);if(!u)return s;s.push([r,{kind:o,id:u}])}else Array.from(c.entries()).forEach(u=>{let[h,p]=u;s.push([r,{kind:h,id:p}])});return s}filterTobeUnSubscribedDataChannels(r,o){const s=[];return o.forEach(c=>{var u;(u=this.remoteDataChannelMap.get(r))!==null&&u!==void 0&&u.has(c.id)&&s.push(c)}),s}createUnsubscribeMessage(r){const o=[];return r.forEach(s=>{let[c,{kind:u,id:h}]=s;switch(u){case je.VIDEO:return void(c._videoSSRC&&o.push({stream_type:je.VIDEO,ssrcId:c._videoSSRC}));case je.AUDIO:return void(c._audioSSRC&&o.push({stream_type:je.AUDIO,ssrcId:c._audioSSRC}))}}),o}createUnsubscribeAllMessage(r){const o=new Map;return r.forEach(s=>{let[c,{kind:u}]=s;if(o.has(c)){let h=o.get(c);u===je.VIDEO?h|=Or.Video:h|=Or.Audio,o.set(c,h)}else u===je.VIDEO?o.set(c,Or.Video):o.set(c,Or.Audio)}),{users:Array.from(o.entries()).map(s=>{let[c,u]=s;return{stream_id:c.uid,stream_type:u}})}}withdrawRemoteTracks(r){r.forEach(o=>{let[s,{kind:c}]=o;const u=this.remoteUserMap.get(s);u&&(u.delete(c),Array.from(u.entries()).length===0&&this.remoteUserMap.delete(s))})}async updateBitrateLimit(r){const o=this.localTrackMap.get(Te.LocalVideoTrack),s=this.localTrackMap.get(Te.LocalVideoLowTrack);o&&(await o.track.setBitrateLimit(r.uplink),await new De((c,u)=>{this.handleUpdateVideoEncoder(o.track,c,u,!0)})),s&&r.low_stream_uplink&&(await s.track.setBitrateLimit({max_bitrate:r.low_stream_uplink.bitrate,min_bitrate:r.low_stream_uplink.bitrate||0}),await new De((c,u)=>{this.handleUpdateVideoEncoder(s.track,c,u,!0)}))}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(r,o,s){return r.map((c,u)=>{var h;let{stream_type:p}=c;const g=(h=o.find(y=>{let{stream_type:b}=y;return p===b}))===null||h===void 0?void 0:h.attributes;if(g&&q("DISABLE_SCREEN_SHARE_REMB")){const y=s[u]._hints;(Pe(y).call(y,Zt.SCREEN_TRACK)||Pe(y).call(y,Zt.SCREEN_LOW_TRACK))&&(g.remb=!1,L.debug("disable remb for screen share, hints:",y))}return g})}async tryToUnmuteAudio(r){for(let s=0;s<r.length;s++)if(r[s]instanceof jn){var o;const c=this.filterTobeUnmutedTracks(r[s]);if(c.length===0)continue;await((o=this.connection)===null||o===void 0?void 0:o.unmuteLocal(c.map(h=>{let[,{id:p}]=h;return p})));const u=this.createUnmuteMessage(c);return void await rn(this,Ye.RequestUnmuteLocal,u)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=r=>{var o;return!((o=this.connection)===null||o===void 0||!o.getRemoteVideoIsReady(r))},this.statsUploader.requestUpload=(r,o)=>this.emit(Ye.RequestUpload,r,o),this.statsUploader.requestUploadStats=r=>this.emit(Ye.RequestUploadStats,r),this.statsUploader.requestAllTracks=()=>this.getAllTracks(),this.statsUploader.requestTransportStats=()=>{var r;return{connectState:((r=this.connection)===null||r===void 0?void 0:r.peerConnectionState)||"closed"}}}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Kr(g1(this.dtlsFailedCount,rr)),this.emit(Ye.RequestReconnect)}async reconnectP2P(){const r=Array.from(this.localTrackMap.entries()),o=this.createGatewayUnpublishMessage(r);Array.from(this.remoteUserMap.entries()),o.length>0&&await oi(this,Ye.RequestUnpublishForReconnectPC,o),this.disconnectForReconnect(),this.emit(Ye.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(Te.LocalVideoTrack)||this.pendingLocalTracks.some(r=>r instanceof pn)}throwIfTrackTypeNotMatch(r){if(r.filter(o=>o instanceof pn).length>1)throw new ve(Y.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(r.filter(o=>o instanceof jn).length>1&&(r.some(o=>o instanceof jn&&o._bypassWebAudio)||!xt().webAudioMediaStreamDest))throw new ve(Y.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const o of r){if(o instanceof pn&&this.pendingLocalTracks.some(s=>s instanceof pn))throw new ve(Y.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(o instanceof jn&&this.pendingLocalTracks.some(s=>s instanceof jn)&&(!xt().webAudioMediaStreamDest||o._bypassWebAudio||this.pendingLocalTracks.some(s=>s instanceof jn&&s._bypassWebAudio)))throw new ve(Y.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(r,o){var s;const c=!q("DISABLE_DUAL_STREAM_USE_ENCODING")&&xt().supportDualStreamEncoding,u=nl(nl({},{width:160,height:120,framerate:15,bitrate:50}),o);let h;h=c?r._mediaStreamTrack.clone():RD(r,u);const p=cn(8,"track-low-"),g=new pn(h,nl(nl({},c&&{scaleResolutionDownBy:cD(u,r)}),{},{frameRate:u.framerate,bitrateMax:u.bitrate,bitrateMin:u.bitrate}),void 0,void 0,p);return g.on(cf.TRANSCEIVER_UPDATED,y=>{r._updateRtpTransceiver(y,wm.LOW_STREAM)}),g._hints.push(Zt.LOW_STREAM),Pe(s=r._hints).call(s,Zt.SCREEN_TRACK)&&g._hints.push(Zt.SCREEN_LOW_TRACK),r.on("sei-to-send",y=>{g.emit("sei-to-send",y)}),r.addListener(Fe.NEED_CLOSE,()=>{g.close()}),g}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(r,o,s){let c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof tl){var u,h,p,g;const y=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:b,dtlsTransportState:w,peerConnectionState:C}=this.connection,{local:A,remote:x}=await this.connection.getSelectedCandidatePair();We.pcStats(this.store.sessionId,{startTime:y,eventElapse:r-y||0,iceconnectionsate:b,dtlsstate:w,connectionstate:C,intSucc:o?1:2,error:this._iceError||c||"",selectedLocalCandidateProtocol:(u=A==null?void 0:A.protocol)!==null&&u!==void 0?u:"",selectedLocalCandidateType:(h=A.candidateType)!==null&&h!==void 0?h:"",selectedLocalCandidateAddress:"".concat(A.address,":").concat(A.port),selectedRemoteCandidateProtocol:(p=x.protocol)!==null&&p!==void 0?p:"",selectedRemoteCandidateType:(g=x.candidateType)!==null&&g!==void 0?g:"",selectedRemoteCandidateAddress:"".concat(x.address,":").concat(x.port),restartCnt:s,preallocation:this.connection.isPreallocation}),this._iceError=null}}reportVideoFirstFrameDecoded(r,o,s,c){var u;const h=Array.from(ts(u=this.remoteUserMap).call(u)).find(p=>p._videoSSRC===r);if(h){c||this.store.subscribe(h.uid,"video",void 0,void 0,void 0,void 0,Date.now());const p=this.store.keyMetrics,g=p.subscribe.find(y=>y.userId===h.uid&&y.type==="video");We.firstRemoteVideoDecode(this.store.sessionId,Ar.FIRST_VIDEO_DECODE,Tn.FIRST_VIDEO_DECODE,{peer:h._uintid,videowidth:o,videoheight:s,subscribeElapse:gi.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId,apEnd:p.requestAPEnd||0,apStart:p.requestAPStart||0,joinGwEnd:p.joinGatewayEnd||0,joinGwStart:p.joinGatewayStart||0,pcEnd:p.peerConnectionEnd||0,pcStart:p.peerConnectionStart||0,subscriberEnd:(g==null?void 0:g.subscribeEnd)||0,subscriberStart:(g==null?void 0:g.subscribeStart)||0,videoAddNotify:(g==null?void 0:g.streamAdded)||0,state:c?1:0,firstFrame:(g==null?void 0:g.firstFrame)||0})}}async remoteMediaSsrcChanged(r,o,s){if(!this.connection)return!1;const c=this.remoteUserMap.get(r);if(!c)return!1;const u=c.get(o);if(!u)return!1;const h=await this.connection.getRemoteSSRC(u);return h!==void 0&&h!==s}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(r=>{let[o,{track:s}]=r;o===Te.LocalVideoLowTrack?s._updateRtpTransceiver(void 0,wm.LOW_STREAM):s._updateRtpTransceiver(void 0)})}},$e(vt.prototype,"startP2PConnection",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"startP2PConnection"),vt.prototype),$e(vt.prototype,"connect",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"connect"),vt.prototype),$e(vt.prototype,"updateRemoteRTPCapabilities",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"updateRemoteRTPCapabilities"),vt.prototype),$e(vt.prototype,"publishDataChannel",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"publishDataChannel"),vt.prototype),$e(vt.prototype,"unpublish",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"unpublish"),vt.prototype),$e(vt.prototype,"unpublishDataChannel",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"unpublishDataChannel"),vt.prototype),$e(vt.prototype,"unpublishLowStream",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"unpublishLowStream"),vt.prototype),$e(vt.prototype,"subscribeDataChannel",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"subscribeDataChannel"),vt.prototype),$e(vt.prototype,"subscribe",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"subscribe"),vt.prototype),$e(vt.prototype,"massSubscribe",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"massSubscribe"),vt.prototype),$e(vt.prototype,"unsubscribe",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"unsubscribe"),vt.prototype),$e(vt.prototype,"unsubscribeDataChannel",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"unsubscribeDataChannel"),vt.prototype),$e(vt.prototype,"massUnsubscribe",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"massUnsubscribe"),vt.prototype),$e(vt.prototype,"muteRemote",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"muteRemote"),vt.prototype),$e(vt.prototype,"unmuteRemote",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"unmuteRemote"),vt.prototype),$e(vt.prototype,"hasRemoteMediaWithLock",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"hasRemoteMediaWithLock"),vt.prototype),$e(vt.prototype,"disconnectForReconnect",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"disconnectForReconnect"),vt.prototype),$e(vt.prototype,"updateBitrateLimit",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"updateBitrateLimit"),vt.prototype),$e(vt.prototype,"remoteMediaSsrcChanged",[xi],Object.getOwnPropertyDescriptor(vt.prototype,"remoteMediaSsrcChanged"),vt.prototype),vt);function xi(r,o,s){const c=r[o];if(typeof c!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const u=this.mutex,h=await u.lock("From P2PChannel.".concat(o));try{for(var p=arguments.length,g=new Array(p),y=0;y<p;y++)g[y]=arguments[y];return await c.apply(this,g)}finally{h()}},s}function RY(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function AY(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?RY(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):RY(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}const Vxe=Date.now(),Fxe=20,OD=new Map,RT=new Map;async function OY(r){const o=OD.get(r),s=Array.isArray(o)&&o[o.length-1],c=RT.get(r);if(!s)return void(c.isSyncing=!1);const u={uid:s.uid,payload:s.payload};c.firstRecvTs===0&&(c.firstRecvTs=s.recvTs,c.firstSendTs=s.sendTs);const h=s.sendTs-c.firstSendTs,p=h-(Date.now()-c.firstRecvTs);p>0&&(c.firstRecvTs=Date.now()-h);let g=s.mediaDelay+p;g<=0?(o.pop(),IY(s.context,u),g=0):g=Math.min(g,Fxe),setTimeout(()=>o.length&&OY(r),g)}function IY(r,o){r.safeEmit(_t.STREAM_MESSAGE,o.uid,o.payload),r.onStreamMessage&&r.onStreamMessage(o)}function Bxe(r){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2?arguments[2]:void 0;if(!r.syncWithAudio)return IY(s,{uid:r.uid,payload:r.payload});const c="".concat(s.id,"-").concat(r.uid),u=OD.get(c)||[],h=u.findIndex(b=>r.sendTs>=b.sendTs),p=AY(AY({},r),{},{context:s,mediaDelay:o,recvTs:Date.now()});h===-1?u.push(p):u.splice(h,0,p),OD.set(c,u);let g=!1;var y;RT.has(c)?g=!((y=RT.get(c))===null||y===void 0||!y.isSyncing):RT.set(c,{isSyncing:g,firstRecvTs:0,firstSendTs:0}),g||OY(c)}const $xe=It().name;function xY(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function PY(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?xY(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):xY(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}const Hm="websdk_ng_cache_parameter",Wxe=q("MAX_PRELOAD_ASYNC_LENGTH"),Gxe=1e4,yf=new Map,_f=[];let ID=null,xD=0,PD=0;const AT=new Map,Hxe=function(r,o){const s=[];let c=0;const u=async()=>{const h=s.shift();h&&await h(),s.length>0&&c<o?u():c--};return async function(){for(var h=arguments.length,p=new Array(h),g=0;g<h;g++)p[g]=arguments[g];return new De(async(y,b)=>{s.push(async()=>{try{const w=await r(...p);y(w)}catch(w){b(w)}}),c<o&&(c++,u())})}}(NY,Wxe),ND=Qi.CancelToken.source();async function NY(r,o,s,c,u,h){try{if(!q("ENABLE_PRELOAD"))return;if(!xt().supportWebCrypto)return void ud(()=>{L.warn("Your browser does not support preloading, this feature  be run in a secure environment")},"preload_webcrypto_not_supported");if(!s&&s!==null)throw new ve(Y.INVALID_PARAMS,"Invalid token: ".concat(s,". If you don not use token, set it to null"));s&&Hr(s,"token",1,2047),Hr(r,"appid",1,2047),iT(o),c&&oT(c);const p=sf();L.debug("preload channel ".concat(o,", uid is ").concat(c));const g={appId:r,cname:o,token:s||r,uid:typeof c!="string"?c:null,sid:p,proxyServer:u};let y,b;typeof c=="string"?(g.stringUid=c,[b,y]=await De.all([Axe(c,{sid:p,appId:r},ND.token),nY(PY(PY({},g),{},{token:s||r,uid:0}),ND.token)]),g.uid=b.uid,y.gatewayInfo.uid=g.uid,y.gatewayInfo.res.uid=g.uid):(h&&(g.stringUid=h),y=await nY(g,ND.token));const w={sid:p,appId:r,cname:o,token:s||r,uid:g.stringUid||c,intUid:g.uid||y.gatewayInfo.uid,stringUid:g.stringUid,ts:Date.now(),sua:b,ap:y};await async function(C){let A;try{C.uid&&kY({appId:C.appId,cname:C.cname,token:C.token,uid:C.uid,stringUid:C.stringUid});const x=UY(C),B=await async function(F,K){try{const z=await window.crypto.subtle.importKey("raw",C8(K),"AES-GCM",!1,["encrypt"]),Q=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:new Uint8Array(1)},z,of(window.btoa(JSON.stringify(F))));return dd(new Uint8Array(Q))}catch{return}}(C,C.token||C.appId);if(!B)return;A=jY(Hm);const U=A?JSON.parse(A):[];U.push({[x]:B}),U.length>q("AP_CACHE_NUM")&&U.shift(),OT(Hm,JSON.stringify(U))}catch(x){L.warn("Error caching server parameters:",x.message),OT(Hm,"")}}(w),xD++}catch(p){throw PD++,function(g){ID||(ID=window.setTimeout(()=>{let b="";AT.forEach((w,C)=>{b+="".concat(C,": ").concat(w," ;")}),We.reportApiInvoke(null,{name:Yn.PRELOAD,options:{success:xD,failed:PD,err:b}}).onError(g),xD=0,PD=0,AT.clear(),ID=null},Gxe));const y=AT.get(g.code)||0;AT.set(g.code,y+1)}(p),p}}async function DY(r){try{if(q("AP_REQUEST_DETAIL")||q("ENABLE_ROLE_SELECT_EDGE"))return;const o=kY(r);if(!o||r.cloudProxyServer!=="disabled")return;const s=await async function(c,u){try{const h=await window.crypto.subtle.importKey("raw",C8(u),"AES-GCM",!1,["decrypt"]),p=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(1)},h,of(c));return JSON.parse(window.atob(dd(new Uint8Array(p))))}catch{return}}(o,r.token||r.appId);if(!s||!function(c,u){return c.cname===u.cname&&c.appId===u.appId&&c.token===u.token?u.stringUid?c.stringUid===u.stringUid:typeof u.uid=="number"?c.uid===u.uid:c.uid==u.uid:!1}(s,r))return;if(s&&Date.now()-s.ts<q("AP_CACHE_LIFETIME"))return s}catch(o){L.warn("Error get preloadInfo",o.message)}}function kY(r){let o;try{if(o=jY(Hm),!o)return;const s=JSON.parse(o),c=UY(r),u=function(p,g){for(let y=p.length-1;y>=0;y--)if(g(p[y]))return y;return-1}(s,p=>c in p);if(u===-1)return;const h=s.splice(u,1)[0];return OT(Hm,JSON.stringify(s)),h[c]}catch(s){L.warn("Error delete preload info: ".concat(o),s.message),OT(Hm,"")}}function DD(r){if(r){let o=yf.get(r);o&&(window.clearTimeout(o),o=null,yf.delete(r)),Pe(_f).call(_f,r)||r.cloudProxyServer!=="disabled"||_f.push(r)}if(yf.size<q("AP_CACHE_NUM")&&_f.length>0){const o=_f.shift();yf.set(o,window.setTimeout(async()=>{const{appId:s,cname:c,token:u,stringUid:h,uid:p,proxyServer:g}=o;try{await Hxe(s,c,u,p,g,h),yf.has(o)&&DD(o)}catch(y){L.warn("update preload failed",y.message),LY(o)}},q("AP_UPDATE_INTERVAL")))}}function LY(r){const o=_f.indexOf(r);o!==-1&&_f.splice(o,1);let s=yf.get(r);s&&(window.clearTimeout(s),s=null,yf.delete(r),DD())}function MY(r,o){const s=r.sua,c=r.ap;o&&s&&We.reqUserAccount(r.sid,{lts:s.requestTime,elapse:s.elapse,success:!0,serverAddr:s.url,stringUid:o,uid:r.intUid,errorCode:null,extend:s.req}),We.reportResourceTiming(r.ap.url,r.sid),We.joinWebProxyAP(r.sid,{lts:c.requestTime,elapse:c.elapse,sucess:1,apServerAddr:c.url,turnServerAddrList:c.proxyInfo.addresses.map(u=>u.ip).join(","),eventType:"disabled",unilbsServerIds:[Xn.CHOOSE_SERVER,Xn.CLOUD_PROXY_FALLBACK].toString()}),We.joinChooseServer(r.sid,{lts:c.requestTime,elapse:c.elapse,succ:!0,csAddr:c.url,opid:c.opid,serverList:c.gatewayInfo.gatewayAddrs.map(u=>u.address),ec:null,cid:c.gatewayInfo.cid.toString(),uid:c.gatewayInfo.uid.toString(),csIp:c.gatewayInfo.csIp,unilbsServerIds:[Xn.CHOOSE_SERVER].toString(),isHttp3:c.isHttp3})}function jY(r){return window.atob(window.localStorage.getItem(r)||"")}function OT(r,o){window.localStorage.setItem(r,window.btoa(o))}function UY(r){let o="".concat(r.appId,"_").concat(r.cname);return typeof r.uid=="string"&&(o+="_s_".concat(r.uid)),typeof r.uid=="number"&&(o+="_".concat(r.uid)),r.token&&(o+="_".concat(r.token)),N8(o)}function Kxe(r){let o=function(){const s=qxe.pop();return s?(s.offset=s.limit=0,s):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(s,c){let u=s.appId;u!==void 0&&(Jn(c,10),bd(c,u));let h=s.cid;h!==void 0&&(Jn(c,16),Jn(c,h));let p=s.cname;p!==void 0&&(Jn(c,26),bd(c,p));let g=s.deviceId;g!==void 0&&(Jn(c,34),bd(c,g));let y=s.elapse;y!==void 0&&(Jn(c,40),Sd(c,y));let b=s.fileSize;b!==void 0&&(Jn(c,48),Sd(c,Km(b)));let w=s.height;w!==void 0&&(Jn(c,56),Sd(c,Km(w)));let C=s.jpg;C!==void 0&&(Jn(c,66),Jn(c,C.length),FY(c,C));let A=s.networkType;A!==void 0&&(Jn(c,72),Sd(c,Km(A)));let x=s.osType;x!==void 0&&(Jn(c,80),Sd(c,Km(x)));let B=s.requestId;B!==void 0&&(Jn(c,90),bd(c,B));let U=s.sdkVersion;U!==void 0&&(Jn(c,98),bd(c,U));let F=s.sequence;F!==void 0&&(Jn(c,104),Sd(c,Km(F)));let K=s.sid;K!==void 0&&(Jn(c,114),bd(c,K));let z=s.timestamp;z!==void 0&&(Jn(c,120),Sd(c,z));let Q=s.uid;Q!==void 0&&(Jn(c,128),Jn(c,Q));let ie=s.vid;ie!==void 0&&(Jn(c,136),Jn(c,ie));let oe=s.width;oe!==void 0&&(Jn(c,144),Sd(c,Km(oe)));let re=s.service;re!==void 0&&(Jn(c,152),Jn(c,re));let me=s.callbackData;me!==void 0&&(Jn(c,162),Jn(c,me.length),FY(c,me));let Ee=s.ticket;Ee!==void 0&&(Jn(c,170),bd(c,Ee));let xe=s.vendorConfigs;xe!==void 0&&(Jn(c,178),bd(c,xe))}(r,o),function(s){let c=s.bytes,u=s.limit;return c.length===u?c:c.subarray(0,u)}(o)}function zxe(r){return function(s){let c={};e:for(;!Xxe(s);){let u=x_(s);switch(u>>>3){case 0:break e;case 1:c.code=x_(s);break;case 2:c.msg=BY(s,x_(s));break;case 3:c.requestId=BY(s,x_(s));break;case 4:c.timestamp=Jxe(s,!1);break;default:Yxe(s,7&u)}}return c}({bytes:o=r,offset:0,limit:o.length});var o}function Yxe(r,o){switch(o){case 0:for(;128&ba(r););break;case 2:kD(r,x_(r));break;case 5:kD(r,4);break;case 1:kD(r,8);break;default:throw new Error("Unimplemented type: "+o)}}function Km(r){return{low:r|=0,high:r>>31,unsigned:r>=0}}let qxe=[];function kD(r,o){if(r.offset+o>r.limit)throw new Error("Skip past limit");r.offset+=o}function Xxe(r){return r.offset>=r.limit}function IT(r,o){let s=r.bytes,c=r.offset,u=r.limit,h=c+o;if(h>s.length){let p=new Uint8Array(2*h);p.set(s),r.bytes=p}return r.offset=h,h>u&&(r.limit=h),c}function VY(r,o){let s=r.offset;if(s+o>r.limit)throw new Error("Read past limit");return r.offset+=o,s}function FY(r,o){let s=IT(r,o.length);r.bytes.set(o,s)}function BY(r,o){let s=VY(r,o),c=String.fromCharCode,u=r.bytes,h="�",p="";for(let g=0;g<o;g++){let y,b,w,C,A=u[g+s];128&A?(224&A)==192?g+1>=o?p+=h:(y=u[g+s+1],(192&y)!=128?p+=h:(C=(31&A)<<6|63&y,C<128?p+=h:(p+=c(C),g++))):(240&A)==224?g+2>=o?p+=h:(y=u[g+s+1],b=u[g+s+2],(49344&(y|b<<8))!=32896?p+=h:(C=(15&A)<<12|(63&y)<<6|63&b,C<2048||C>=55296&&C<=57343?p+=h:(p+=c(C),g+=2))):(248&A)==240?g+3>=o?p+=h:(y=u[g+s+1],b=u[g+s+2],w=u[g+s+3],(12632256&(y|b<<8|w<<16))!=8421504?p+=h:(C=(7&A)<<18|(63&y)<<12|(63&b)<<6|63&w,C<65536||C>1114111?p+=h:(C-=65536,p+=c(55296+(C>>10),56320+(1023&C)),g+=3))):p+=h:p+=c(A)}return p}function bd(r,o){let s=o.length,c=0;for(let p=0;p<s;p++){let g=o.charCodeAt(p);g>=55296&&g<=56319&&p+1<s&&(g=(g<<10)+o.charCodeAt(++p)-56613888),c+=g<128?1:g<2048?2:g<65536?3:4}Jn(r,c);let u=IT(r,c),h=r.bytes;for(let p=0;p<s;p++){let g=o.charCodeAt(p);g>=55296&&g<=56319&&p+1<s&&(g=(g<<10)+o.charCodeAt(++p)-56613888),g<128?h[u++]=g:(g<2048?h[u++]=g>>6&31|192:(g<65536?h[u++]=g>>12&15|224:(h[u++]=g>>18&7|240,h[u++]=g>>12&63|128),h[u++]=g>>6&63|128),h[u++]=63&g|128)}}function ba(r){return r.bytes[VY(r,1)]}function $Y(r,o){let s=IT(r,1);r.bytes[s]=o}function x_(r){let o,s=0,c=0;do o=ba(r),s<32&&(c|=(127&o)<<s),s+=7;while(128&o);return c}function Jn(r,o){for(o>>>=0;o>=128;)$Y(r,127&o|128),o>>>=7;$Y(r,o)}function Jxe(r,o){let s,c=0,u=0,h=0;return s=ba(r),c=127&s,128&s&&(s=ba(r),c|=(127&s)<<7,128&s&&(s=ba(r),c|=(127&s)<<14,128&s&&(s=ba(r),c|=(127&s)<<21,128&s&&(s=ba(r),u=127&s,128&s&&(s=ba(r),u|=(127&s)<<7,128&s&&(s=ba(r),u|=(127&s)<<14,128&s&&(s=ba(r),u|=(127&s)<<21,128&s&&(s=ba(r),h=127&s,128&s&&(s=ba(r),h|=(127&s)<<7))))))))),{low:c|u<<28,high:u>>>4|h<<24,unsigned:o}}function Sd(r,o){let s=o.low>>>0,c=(o.low>>>28|o.high<<4)>>>0,u=o.high>>>24,h=u===0?c===0?s<16384?s<128?1:2:s<1<<21?3:4:c<16384?c<128?5:6:c<1<<21?7:8:u<128?9:10,p=IT(r,h),g=r.bytes;switch(h){case 10:g[p+9]=u>>>7&1;case 9:g[p+8]=h!==9?128|u:127&u;case 8:g[p+7]=h!==8?c>>>21|128:c>>>21&127;case 7:g[p+6]=h!==7?c>>>14|128:c>>>14&127;case 6:g[p+5]=h!==6?c>>>7|128:c>>>7&127;case 5:g[p+4]=h!==5?128|c:127&c;case 4:g[p+3]=h!==4?s>>>21|128:s>>>21&127;case 3:g[p+2]=h!==3?s>>>14|128:s>>>14&127;case 2:g[p+1]=h!==2?s>>>7|128:s>>>7&127;case 1:g[p]=h!==1?128|s:127&s}}const WY={},GY={},xT=4294967296,Qxe=xT*xT,Zxe=Qxe/2;KY(0,!0);const HY=KY(0),ePe=P_(0,-2147483648,!1),tPe=P_(-1,2147483647,!1);function KY(r,o){let s,c,u;return o?(u=0<=(r>>>=0)&&r<256)&&(c=GY[r],c)?c:(s=P_(r,0,!0),u&&(GY[r]=s),s):(u=-128<=(r|=0)&&r<128)&&(c=WY[r],c)?c:(s=P_(r,r<0?-1:0,!1),u&&(WY[r]=s),s)}function P_(r,o,s){return{low:0|r,high:0|o,unsigned:!!s}}function zY(r,o){if(isNaN(r))return HY;{if(r<=-9223372036854776e3)return ePe;if(r+1>=Zxe)return tPe}return r<0?HY:P_(r%xT|0,r/xT|0,o)}function YY(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}class LD extends An{get connectionState(){return this._connectionState}set connectionState(o){if(this._connectionState===o)return;const s=this._connectionState;this._connectionState=o,this.emit(sc.CONNECTION_STATE_CHANGE,o,s)}get quality(){return this._quality}set quality(o){this._quality=o>1?1:o<.1?.1:o,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(o){var s;super(),G(this,"name","AgoraRTCImageModeration"),G(this,"_connectionState",Ds.CONNECTING),G(this,"_sequence",0),G(this,"_moderationStartTime",void 0),G(this,"_workerConnection",void 0),G(this,"_workerMessageLengthLimit",void 0),G(this,"_qualityRatio",void 0),G(this,"_connectInfo",void 0),G(this,"_cancelTokenSource",Qi.CancelToken.source()),G(this,"_retryConfig",void 0),G(this,"_moderationInterval",void 0),G(this,"_moderationTimer",null),G(this,"_moderationMode",1),G(this,"_quality",1),G(this,"_qualityTimer",null),G(this,"_ticket",void 0),G(this,"_moderationIntervalMinimum",void 0),G(this,"_uploadFailedNum",0),G(this,"_uploadNum",0),G(this,"_uploadTimer",null),G(this,"_extraInfo",void 0),G(this,"_vendor",""),G(this,"_encoder",new TextEncoder),G(this,"_moderationId",void 0),G(this,"inspectImage",()=>{if(this.connectionState!==Ds.CONNECTED)throw new pe(Y.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===Ds.CONNECTED?this.requestToInspectImage():L.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=cn(5,"image-moderation-"),this._workerMessageLengthLimit=q("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=q("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(s=o.interval)!==null&&s!==void 0?s:1e3,o.extraInfo&&(this._extraInfo=this._encoder.encode(o.extraInfo)),o.vendor&&(this._vendor=o.vendor),this._qualityRatio=q("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new __("worker-"+this._moderationId,rr),this.on(sc.STATE_CHANGE,(c,u)=>{L.debug("[".concat(this._moderationId,"] Moderation operation :").concat(Lm[c]," ").concat(u||""))}),this.handleWorkerEvents()}async init(o,s){this.emit(sc.STATE_CHANGE,Lm.CONNECT_AP),this._connectInfo=o;const c=this._cancelTokenSource.token;return this._retryConfig=s,new De((u,h)=>{this.on(sc.CONNECTION_STATE_CHANGE,(p,g)=>{p===Ds.CONNECTED&&u()}),this.requestAP(o,c,s).then(p=>{this.connectWorker(p)}).catch(p=>{h(p)})})}updateConfig(o){var s;this._moderationInterval=(s=o.interval)!==null&&s!==void 0?s:1e3,o.extraInfo&&(this._extraInfo=this._encoder.encode(o.extraInfo)),o.vendor&&(this._vendor=o.vendor),L.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(o))),this.connectionState===Ds.CONNECTED&&this.inspectImage()}async requestAP(o,s,c){const u=q("WEBCS_DOMAIN").map(y=>"https://".concat(y,"/api/v1")),h=await function(y,b,w,C){let{appId:A,areaCode:x,cname:B,sid:U,token:F,uid:K}=b;Bm++;const z="moderation_plugin",Q={service_name:z,json_body:JSON.stringify({appId:A,areaCode:x,cname:B,command:"allocateEdge",requestId:Bm,seq:Bm,sid:U,appToken:F,ts:Date.now(),uid:K+""})};let ie,oe,re=y[0];return nc(async()=>{ie=Date.now();const me=await ac(re,{data:Q,cancelToken:w,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(oe=Date.now()-ie,me.code!==0){const Me=new pe(Y.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+me.code,{retry:!0,responseTime:oe});throw L.error(Me.toString()),Me}const Ee=JSON.parse(me.json_body);if(Ee.code!==200){const Me=new pe(Y.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(Ee.code,", reason: ").concat(Ee.reason),{code:Ee.code,responseTime:oe});throw L.error(Me.toString()),Me}if(!Ee.servers||!Array.isArray(Ee.servers)||Ee.servers.length===0){const Me=new pe(Y.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:Ee.code,responseTime:oe});throw L.error(Me.toString()),Me}if(!Ee.servers.some(Me=>!!Me.wss)){const Me=new pe(Y.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:Ee.code,responseTime:oe});throw L.error(Me.toString()),Me}const xe=q("IMAGE_MODERATION_WORKER_HOST");return{addressList:Ee.servers.map(Me=>{let{address:pt,wss:ut}=Me;if(pt&&ut)return"wss://".concat(pt.replace(/\./g,"-"),".").concat(xe,":").concat(ut,"/moderation")}).filter(Me=>!!Me),workerToken:Ee.workerToken,vid:Ee.vid,ticket:Ee.appTicket,responseTime:oe}},(me,Ee)=>(We.apworkerEvent(U,{success:!0,sc:200,serviceName:z,responseDetail:JSON.stringify(me.addressList),firstSuccess:Ee===0,responseTime:oe,serverIp:y[Ee%y.length]}),!1),(me,Ee)=>(We.apworkerEvent(U,{success:!1,sc:me.data&&me.data.code||200,serviceName:z,responseTime:oe,serverIp:y[Ee%y.length]}),!!(me.code!==Y.OPERATION_ABORTED&&me.code!==Y.UNEXPECTED_RESPONSE||me.data&&me.data.retry)&&(re=y[(Ee+1)%y.length],!0)),C)}(u,o,s,c);this.emit(sc.STATE_CHANGE,Lm.AP_CONNECTED);const{addressList:p,ticket:g}=h;return this._ticket=g,p}async connectWorker(o){this.emit(sc.STATE_CHANGE,Lm.CONNECT_WORKER),await this._workerConnection.init(o,1e4)}handleWorkerEvents(){this._workerConnection.on(lt.CONNECTED,async()=>{this.emit(sc.STATE_CHANGE,Lm.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=Ds.CONNECTED}),this._workerConnection.on(lt.CLOSED,()=>{this.connectionState=Ds.CLOSED}),this._workerConnection.on(lt.FAILED,()=>{this.connectionState=Ds.CLOSED}),this._workerConnection.on(lt.RECONNECTING,()=>{this.connectionState=this.connectionState===Ds.CONNECTED?Ds.RECONNECTING:Ds.CONNECTING}),this._workerConnection.on(lt.ON_MESSAGE,async o=>{if(o.data instanceof ArrayBuffer){const s=zxe(new Uint8Array(o.data));q("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&L.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(s)),this._uploadNum++,s.code===void 0||s.code===0||(this._uploadFailedNum++,L.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(s.code,", msg is ").concat(s.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{We.reportApiInvoke(this._connectInfo.sid||null,{name:Yn.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,s.code],tag:Nn.TRACER}).onError(new pe(Y.IMAGE_MODERATION_UPLOAD_FAILED,s.msg)),this._uploadTimer=null},q("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else L.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(lt.WILL_RECONNECT,(o,s,c)=>{o==="recover"&&c(o),c("tryNext")}),this._workerConnection.on(lt.REQUEST_NEW_URLS,(o,s)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(o).catch(s)})}static intToLong(o){return{low:o|=0,high:o>>31,unsigned:o>=0}}async requestToInspectImage(){const o=Zo(this,sc.CLIENT_LOCAL_VIDEO_TRACK),s={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(o){if(!o.isPlaying)return void(q("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&L.debug("Only the track being played can be inspected"));this._sequence++;const c=await this.generateRequestData(o,s);this._workerConnection.sendMessage(c,!0,!0)}else q("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&L.debug("Only the track being published can be inspected")}async generateRequestData(o,s){let{appId:c,cname:u,cid:h,vid:p,sid:g,uid:y}=s;const b=Date.now(),w=await o.getCurrentFrameImage("image/jpeg",this.quality),C=await bH(w,c,u),A=this._sequence+"-"+h+"-"+y+"-"+b+"-"+cn(12,""),x={appId:c,cid:h,cname:u,deviceId:"",elapse:LD.intToLong(Number(b-this._moderationStartTime)),fileSize:w.buffer.byteLength,height:w.height,width:w.width,jpg:C,networkType:6,osType:7,requestId:A,sdkVersion:"4.23.4",sequence:this._sequence,sid:g,timestamp:zY(b),uid:y,vid:p,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};this._extraInfo===void 0&&delete x.callbackData;const B=Kxe(x);if(B.byteLength<this._workerMessageLengthLimit){if(q("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const U=function(F){for(var K=1;K<arguments.length;K++){var z=arguments[K]!=null?arguments[K]:{};K%2?YY(Object(z),!0).forEach(function(Q){G(F,Q,z[Q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(F,Object.getOwnPropertyDescriptors(z)):YY(Object(z)).forEach(function(Q){Object.defineProperty(F,Q,Object.getOwnPropertyDescriptor(z,Q))})}return F}({},x);delete U.jpg,L.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(U))}return B}{const U=this.quality*this._qualityRatio;return this.quality=U,await this.generateRequestData(o,{appId:c,cname:u,cid:h,vid:p,sid:g,uid:y})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Qi.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=Ds.CLOSED,this.emit(sc.STATE_CHANGE,Lm.CLOSED)}}function qY(r){if(Qt(r.interval,"interval",1e3,1/0),r&&r.extraInfo&&r.extraInfo.length>1024)throw new pe(Y.INVALID_PARAMS,"config.extraInfo length cannot exceed 1024 bytes");if(r&&r.vendor&&r.vendor.length>1024)throw new pe(Y.INVALID_PARAMS,"config.vendor length cannot exceed 1024 bytes")}const nPe={name:"ImageModeration",create:function(r){let{config:o}=r;return qY(o),new LD(o)}};var XY,JY,QY,ZY,eq,tq,nq,rq,iq,oq,sq,aq,cq,lq,uq,dq,hq,fq,pq,mq,gq,vq,yq,_q,Eq,bq,Sq,wq,Tq,Cq,Rq,Aq,Oq,Iq,xq,Pq,Nq,Dq,kq,Lq,Mq,ke;function jq(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function Sa(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?jq(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):jq(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}fi.setLogger(L);let rPe=(XY=Qe(),JY=Qe({argsMap:(r,o)=>{if(!Array.isArray(o)){if(!(o instanceof Am))return[o];o=[o]}return o.map(s=>s?Object(s).toString():"null")}}),QY=Qe({argsMap:(r,o)=>(o||(o=[]),Array.isArray(o)||o.trackMediaType!==Rm.DATA?(Array.isArray(o)||(o=[o]),o.map(s=>s.getTrackId())):[o.getChannelId()])}),ZY=Qe({argsMap:(r,o,s,c)=>[typeof o=="object"?o.uid:o,s,c]}),eq=Qe({argsMap:(r,o,s)=>[o,s]}),tq=Qe({argsMap:(r,o)=>o.map(s=>{let{user:c,mediaType:u}=s;return[c==null?void 0:c.uid,u]})}),nq=Qe({argsMap:(r,o,s,c)=>[typeof o=="object"?o.uid:o,s,c]}),rq=Qe({argsMap:(r,o)=>o.map(s=>{let{user:c,mediaType:u}=s;return{uid:c==null?void 0:c.uid,mediaType:u}})}),iq=Qe(),oq=Qe(),sq=Qe(),aq=Qe(),cq=Qe(),lq=Qe(),uq=Qe(),dq=Qe(),hq=Qe(),fq=Qe(),pq=Qe(),mq=Qe(),gq=Qe(),vq=Qe(),yq=Qe(),_q=Qe({argsMap:(r,o)=>[o]}),Eq=Qe(),bq=Qe(),Sq=Qe(),wq=Qe(),Tq=Qe(),Cq=Qe(),Rq=Qe(),Aq=Qe(),Oq=Qe({argsMap:(r,o)=>(Array.isArray(o)||(o=[o]),[JSON.stringify(o)])}),Iq=Qe(),xq=Qe(),Pq=Qe(),Nq=Qe(),Dq=Qe(),kq=Qe(),Lq=Qe({reportResult:!0}),Mq=Qe(),ke=class extends An{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var r;return((r=this._config)===null||r===void 0?void 0:r.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(r,o){let s;if(super(),G(this,"store",void 0),G(this,"_uid",void 0),G(this,"_channelName",void 0),G(this,"_uintUid",void 0),G(this,"_users",[]),G(this,"_config",void 0),G(this,"_clientId",void 0),G(this,"_appId",void 0),G(this,"_sessionId",null),G(this,"_key",void 0),G(this,"_rtmConfig",{}),G(this,"_joinInfo",void 0),G(this,"_gateway",void 0),G(this,"_statsCollector",void 0),G(this,"_configDistribute",void 0),G(this,"_leaveMutex",void 0),G(this,"_publishMutex",void 0),G(this,"_renewTokenMutex",void 0),G(this,"_subscribeMutex",void 0),G(this,"_encryptionMode","none"),G(this,"_encryptionSecret",null),G(this,"_encryptionSalt",null),G(this,"_encryptDataStream",!1),G(this,"_encryptDataStreamKey",null),G(this,"_encryptDataStreamIv",null),G(this,"_proxyServer",void 0),G(this,"_turnServer",{servers:[],mode:"auto"}),G(this,"_cloudProxyServerMode","disabled"),G(this,"_isDualStreamEnabled",!1),G(this,"_defaultStreamFallbackType",void 0),G(this,"_lowStreamParameter",void 0),G(this,"_streamFallbackTypeCacheMap",new Map),G(this,"_remoteStreamTypeCacheMap",new Map),G(this,"_axiosCancelSource",Qi.CancelToken.source()),G(this,"_audioVolumeIndicationInterval",void 0),G(this,"_networkQualityInterval",void 0),G(this,"_userOfflineTimeout",void 0),G(this,"_streamRemovedTimeout",void 0),G(this,"_liveTranscodeStreamingClient",void 0),G(this,"_liveRawStreamingClient",void 0),G(this,"_channelMediaRelayClient",void 0),G(this,"_networkQualitySensitivity","normal"),G(this,"_p2pChannel",void 0),G(this,"_useLocalAccessPoint",!1),G(this,"_setLocalAPVersion",void 0),G(this,"_joinAndNotLeaveYet",!1),G(this,"_numberOfJoinCount",0),G(this,"_remoteDefaultVideoStreamType",void 0),G(this,"_inspect",void 0),G(this,"_moderation",void 0),G(this,"_license",void 0),G(this,"_pendingPublishedUsers",[]),G(this,"ntpAlignErrorCount",0),G(this,"remoteInboundOffset",0),G(this,"_peerConnectionState",void 0),G(this,"_handleLocalTrackEnable",(u,h,p)=>{this.publish(u,!1).then(h).catch(p)}),G(this,"_handleLocalTrackDisable",(u,h,p)=>{this.unpublish(u).then(h).catch(p)}),G(this,"_handleUserOnline",u=>{if(q("BLOCK_LOCAL_CLIENT")&&pf(u.uid,this.channelName))return void L.debug("[".concat(u.uid,"] will be ignored in local"));this.isStringUID&&typeof u.uid!="string"&&L.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const h=this._users.find(p=>p.uid===u.uid);if(h)h._trust_in_room_=!0,h._is_pre_created&&(h._is_pre_created=!1,this.safeEmit(_t.USER_JOINED,h));else{const p=new _d(u.uid,u.uint_id||u.uid);this._users.push(p),L.debug("[".concat(this._clientId,"] user online"),u.uid),this.safeEmit(_t.USER_JOINED,p)}}),G(this,"_handleUserOffline",u=>{if(q("BLOCK_LOCAL_CLIENT")&&pf(u.uid,this.channelName))return;const h=this._users.find(p=>p.uid===u.uid);h&&(this._handleRemoveStream(u),this._handleRemoveDataChannels(u),h._audio_pre_subscribed||h._video_pre_subscribed?h._is_pre_created=!0:kw(this._users,h),this._remoteStreamTypeCacheMap.delete(h.uid),this._streamFallbackTypeCacheMap.delete(h.uid),L.debug("[".concat(this._clientId,"] user offline"),u.uid,"reason:",u.reason),this.safeEmit(_t.USER_LEAVED,h,u.reason))}),G(this,"_handleAddAudioOrVideoStream",(u,h,p,g,y,b,w)=>{if(q("BLOCK_LOCAL_CLIENT")&&pf(h,this.channelName))return;const C=this._users.find(x=>x.uid===h);if(!C)return void L.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));L.debug("[".concat(this._clientId,"] stream added with uid ").concat(h,", type ").concat(u)),this.store.subscribe(C.uid,u,void 0,void 0,void 0,Date.now());const A=u==="audio"?C.hasAudio:C.hasVideo;C._uintid||(C._uintid=y||h),u==="audio"?C._trust_audio_stream_added_state_=!0:C._trust_video_stream_added_state_=!0,u==="audio"?(C._audio_added_=!0,p!==void 0&&(C._audioSSRC=p),g!==void 0&&(C._cname=g),b&&(C._audioOrtc=b)):(C._video_added_=!0,p!==void 0&&(C._videoSSRC=p),g!==void 0&&(C._cname=g),w!==void 0&&(C._rtxSsrcId=w),b&&(C._videoOrtc=b)),(u==="audio"?C.hasAudio:C.hasVideo)&&!A&&(L.info("[".concat(this._clientId,"] remote user ").concat(C.uid," published ").concat(u)),this.safeEmit(_t.USER_PUBLISHED,C,u)),u==="video"?We.onGatewayStream(this._sessionId,Ar.ON_ADD_VIDEO_STREAM,Tn.ON_ADD_VIDEO_STREAM,{peer:y||h,ssrc:C._videoSSRC}):We.onGatewayStream(this._sessionId,Ar.ON_ADD_AUDIO_STREAM,Tn.ON_ADD_AUDIO_STREAM,{peer:y||h,ssrc:C._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(C,u,p).then(x=>{if(x&&(L.debug("[".concat(this._clientId,"] resubscribe ").concat(u," for user ").concat(C.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof I_))return this._p2pChannel.unsubscribe(C,u,!0).then(()=>this._subscribe(C,u,!0).catch(B=>{L.error("[".concat(this._clientId,"] resubscribe error"),B.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(C,u)&&(L.debug("[".concat(this._clientId,"] resubscribe ").concat(u," for user ").concat(C.uid," after reconnect.")),this._subscribe(C,u,!0).catch(x=>{L.error("[".concat(this._clientId,"] resubscribe error"),x.toString())}))}),G(this,"_handleRemoveStream",u=>{if(q("BLOCK_LOCAL_CLIENT")&&pf(u.uid,this.channelName))return;const h=this._users.find(g=>g.uid===u.uid);if(!h)return void L.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));L.debug("[".concat(this._clientId,"] stream removed with uid ").concat(u.uid));let p=()=>{};h.hasAudio&&h.hasVideo?p=()=>{L.info("[".concat(this._clientId,"] remote user ").concat(h.uid," unpublished audio track")),this.safeEmit(_t.USER_UNPUBLISHED,h,"audio"),L.info("[".concat(this._clientId,"] remote user ").concat(h.uid," unpublished video track")),this.safeEmit(_t.USER_UNPUBLISHED,h,"video")}:h.hasVideo?p=()=>{L.info("[".concat(this._clientId,"] remote user ").concat(h.uid," unpublished video track")),this.safeEmit(_t.USER_UNPUBLISHED,h,"video")}:h.hasAudio&&(p=()=>{L.info("[".concat(this._clientId,"] remote user ").concat(h.uid," unpublished audio track")),this.safeEmit(_t.USER_UNPUBLISHED,h,"audio")}),h._video_pre_subscribed||h._audio_pre_subscribed||(h._trust_audio_stream_added_state_=!0,h._trust_video_stream_added_state_=!0,h._audio_added_=!1,h._video_added_=!1,this._p2pChannel instanceof I_&&this._p2pChannel.unsubscribe(h).then(g=>{if(g)return this._gateway.unsubscribe(g,h.uid)}),h._audioSSRC=void 0,h._videoSSRC=void 0,h._audioOrtc=void 0,h._videoOrtc=void 0,h._rtxSsrcId=void 0),We.onGatewayStream(this._sessionId,Ar.ON_REMOVE_STREAM,Tn.ON_REMOVE_STREAM,{peer:u.uint_id||u.uid}),p()}),G(this,"_handleSetStreamLocalEnable",(u,h,p)=>{if(q("BLOCK_LOCAL_CLIENT")&&pf(h,this.channelName))return;const g=this._users.find(w=>w.uid===h);if(!g)return void L.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));L.debug("[".concat(this._clientId,"] local ").concat(u," ").concat(p?"enabled":"disabled"," with uid ").concat(h));const y=u==="audio"?g.hasAudio:g.hasVideo;if(u==="audio"){g._trust_audio_enabled_state_=!0;const w=g._audio_enabled_;if(g._audio_enabled_=p,g._audio_enabled_===w)return;{const C=g._audio_enabled_?"enable-local-audio":"disable-local-audio";L.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(h,", msg: ").concat(C)),this.safeEmit(_t.USER_INFO_UPDATED,h,C)}}else{g._trust_video_enabled_state_=!0;const w=g._video_enabled_;if(g._video_enabled_=p,g._video_enabled_===w)return;{const C=g._video_enabled_?"enable-local-video":"disable-local-video";L.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(h,", msg: ").concat(C)),this.safeEmit(_t.USER_INFO_UPDATED,h,C)}}const b=u==="audio"?g.hasAudio:g.hasVideo;return y!==b?!y&&b?(L.info("[".concat(this._clientId,"] remote user ").concat(h," published ").concat(u)),void this.safeEmit(_t.USER_PUBLISHED,g,u)):(u==="video"&&g._videoTrack&&g._videoTrack._destroy(),u==="audio"&&g._audioTrack,this._p2pChannel.muteRemote(g,u),L.info("[".concat(this._clientId,"] remote user ").concat(h," unpublished ").concat(u)),void this.safeEmit(_t.USER_UNPUBLISHED,g,u)):void 0}),G(this,"_handleMuteStream",(u,h,p)=>{if(q("BLOCK_LOCAL_CLIENT")&&pf(u,this.channelName))return;L.debug("[".concat(this._clientId,"] receive mute message"),u,h,p);const g=this._users.find(w=>w.uid===u);if(!g)return void L.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(u));const y=h==="audio"?g.hasAudio:g.hasVideo;if(h==="audio"){g._trust_audio_mute_state_=!0;const w=g._audio_muted_;if(g._audio_muted_=p,g._audio_muted_===w)return;{const C=g._audio_muted_?"mute-audio":"unmute-audio";L.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(u,", msg: ").concat(C)),this.safeEmit(_t.USER_INFO_UPDATED,u,C)}}else{g._trust_video_mute_state_=!0;const w=g._video_muted_;if(g._video_muted_=p,g._video_muted_===w)return;{const C=g._video_muted_?"mute-video":"unmute-video";L.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(u,", msg: ").concat(C)),this.safeEmit(_t.USER_INFO_UPDATED,u,C)}}const b=h==="audio"?g.hasAudio:g.hasVideo;if(y!==b){if(!y&&b)return(h==="audio"?g._audioSSRC:g._videoSSRC)?(L.info("[".concat(this._clientId,"] remote user ").concat(u," published ").concat(h)),void this.safeEmit(_t.USER_PUBLISHED,g,h)):void L.warning("[".concat(this._clientId,"] remote user ").concat(u," receive ").concat(h," unmute message  before add stream message, ").concat(h," SSRC doesn't exist yet."));h==="video"&&g._videoTrack&&!g._video_pre_subscribed&&g._videoTrack._destroy(),h==="audio"&&g._audioTrack,this._p2pChannel.muteRemote(g,h),L.info("[".concat(this._clientId,"] remote user ").concat(u," unpublished ").concat(h)),this.safeEmit(_t.USER_UNPUBLISHED,g,h)}}),G(this,"_handleP2PLost",async u=>{L.debug("[".concat(this._clientId,"] receive p2p lost"),u),parseInt(u.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():L.warning("[".concat(this._clientId,"] P2PLost stream not found"),u)}),G(this,"_handleTokenWillExpire",()=>{L.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(_t.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),G(this,"_handleBeforeUnload",u=>{u.type==="beforeunload"&&u.returnValue!==void 0&&u.returnValue!==""||(this.leave(),L.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),G(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(_t.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const u={downlinkNetworkQuality:0,uplinkNetworkQuality:0};u.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),u.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(_t.NETWORK_QUALITY,u)}),G(this,"_handleP2PAddAudioOrVideoStream",(u,h,p,g)=>{const y=this._users.find(w=>w.uid===h);if(!y)return void L.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));L.debug("[".concat(this._clientId,"] stream added with uid ").concat(h,", type ").concat(u)),this.store.subscribe(y.uid,u,void 0,void 0,void 0,Date.now());const b=u==="audio"?y.hasAudio:y.hasVideo;u==="audio"?y._trust_audio_stream_added_state_=!0:y._trust_video_stream_added_state_=!0,u==="audio"?(y._audio_added_=!0,p!==void 0&&(y._audioSSRC=p),g!==void 0&&(y._audioMid=g)):(y._video_added_=!0,p!==void 0&&(y._videoSSRC=p),g!==void 0&&(y._videoMid=g)),(u==="audio"?y.hasAudio:y.hasVideo)&&!b&&(L.info("[".concat(this._clientId,"] remote user ").concat(y.uid," published ").concat(u)),this.safeEmit(_t.USER_PUBLISHED,y,u)),this._p2pChannel.hasPendingRemoteMedia(y,u)&&(L.debug("[".concat(this._clientId,"] resubscribe ").concat(u," for user ").concat(y.uid," after reconnect.")),this._subscribe(y,u,!0).catch(w=>{L.error("[".concat(this._clientId,"] resubscribe error"),w.toString())}))}),this._config=r,this._clientId=o||cn(5,"client-"),this.store=new class{constructor(u,h,p,g){ot(this,"state",void 0),this.state={codec:u,audioCodec:h,mode:p,clientId:g,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useP2P:!1,p2pTransport:af.Default,hasStartJoinChannel:!1,isABTestSuccess:!1}}dispatch(u){this.state=function(h,p){switch(p.type){case St.SET_SESSION_ID:return Ue(Ue({},h),{},{sessionId:p.sessionId});case St.SET_P2P_ID:return Ue(Ue({},h),{},{p2pId:p.p2pId});case St.SET_UID:return Ue(Ue({},h),{},{uid:p.uid});case St.SET_INT_UID:return Ue(Ue({},h),{},{intUid:p.intUid});case St.SET_PUB_ID:return Ue(Ue({},h),{},{pubId:p.pubId});case St.KEY_METRIC_CLIENT_CREATED:return Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{clientCreated:p.metric})});case St.KEY_METRIC_JOIN_START:return Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{joinStart:p.metric})});case St.KEY_METRIC_JOIN_END:return Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{joinEnd:p.metric})});case St.KEY_METRIC_REQUEST_AP_START:return Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{requestAPStart:p.metric})});case St.KEY_METRIC_REQUEST_AP_END:return Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{requestAPEnd:p.metric})});case St.KEY_METRIC_JOIN_GATEWAY_START:return Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{joinGatewayStart:p.metric})});case St.KEY_METRIC_JOIN_GATEWAY_END:return Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{joinGatewayEnd:p.metric})});case St.KEY_METRIC_PEER_CONNECTION_START:return Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{peerConnectionStart:p.metric})});case St.KEY_METRIC_PEER_CONNECTION_END:return Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{peerConnectionEnd:p.metric})});case St.KEY_METRIC_DESCRIPTION_START:return Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{descriptionStart:p.metric})});case St.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{signalChannelOpen:p.metric})});case St.KEY_METRIC_ICE_CONNECTION_END:return Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{iceConnectionEnd:p.metric})});case St.KEY_METRIC_PUBLISH:{const g=h.keyMetrics.publish,y=g.findIndex(b=>b.trackId===p.metric.trackId);return y!==-1?(g[y]=Ue(Ue({},g[y]),p.metric),Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{publish:[...g]})})):Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{publish:[...h.keyMetrics.publish,p.metric]})})}case St.KEY_METRIC_SUBSCRIBE:{const g=h.keyMetrics.subscribe,y=g.findIndex(b=>b.userId===p.metric.userId&&b.type===p.metric.type);return y!==-1?(g[y]=Ue(Ue({},g[y]),p.metric),Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{subscribe:[...g]})})):Ue(Ue({},h),{},{keyMetrics:Ue(Ue({},h.keyMetrics),{},{subscribe:[...h.keyMetrics.subscribe,p.metric]})})}case St.SET_CLOUD_PROXY_SERVER_MODE:return h.cloudProxyServerMode=p.mode,h;case St.RECORD_JOIN_CHANNEL_SERVICE:return typeof p.index!="number"?h.joinChannelServiceRecords=[...h.joinChannelServiceRecords,p.record]:(h.joinChannelServiceRecords[p.index]=Ue(Ue({},h.joinChannelServiceRecords[p.index]),p.record),h.joinChannelServiceRecords=[...h.joinChannelServiceRecords]),h;case St.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return h.joinChannelServiceRecords=[],h;case St.RESET_KEY_METRICS:return h.keyMetrics={publish:[],subscribe:[]},h;case St.SET_USE_P2P:return Ue(Ue({},h),{},{useP2P:p.val});case St.SET_TRANSPORT_TYPE:return Ue(Ue({},h),{},{p2pTransport:p.val});default:return h}}(this.state,u)}set sessionId(u){this.dispatch({type:St.SET_SESSION_ID,sessionId:u})}get sessionId(){return this.state.sessionId}set cid(u){this.state.cid=u}get cid(){return this.state.cid}set codec(u){this.state.codec=u}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(u){this.dispatch({type:St.SET_P2P_ID,p2pId:u})}get p2pId(){return this.state.p2pId}set dcId(u){this.dispatch({type:St.SET_DC_ID,dcId:u})}get dcId(){return this.state.dcId}set uid(u){this.dispatch({type:St.SET_UID,uid:u})}get uid(){return this.state.uid}set intUid(u){this.dispatch({type:St.SET_INT_UID,intUid:u})}get intUid(){return this.state.intUid}set pubId(u){this.dispatch({type:St.SET_PUB_ID,pubId:u})}get pubId(){return this.state.pubId}set cloudProxyServerMode(u){this.dispatch({type:St.SET_CLOUD_PROXY_SERVER_MODE,mode:u})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useP2P(u){this.dispatch({type:St.SET_USE_P2P,val:u})}get useP2P(){return this.state.useP2P}set p2pTransport(u){this.dispatch({type:St.SET_TRANSPORT_TYPE,val:u})}get p2pTransport(){return this.state.p2pTransport}set hasStartJoinChannel(u){this.state.hasStartJoinChannel=u}get hasStartJoinChannel(){return this.state.hasStartJoinChannel}set isABTestSuccess(u){this.state.isABTestSuccess=u}get isABTestSuccess(){return this.state.isABTestSuccess}clientCreated(){this.dispatch({type:St.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:St.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:St.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:St.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:St.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:St.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:St.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:St.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:St.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:St.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:St.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:St.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(u,h,p,g){this.dispatch({type:St.KEY_METRIC_PUBLISH,metric:Ue(Ue({trackId:u,type:h},p&&{publishStart:p}),g&&{publishEnd:g})})}subscribe(u,h,p,g,y,b,w){this.dispatch({type:St.KEY_METRIC_SUBSCRIBE,metric:Ue(Ue(Ue(Ue(Ue({userId:u,type:h},p&&{subscribeStart:p}),g&&{subscribeEnd:g}),y&&{firstFrame:y}),b&&{streamAdded:b}),w&&{firstDecoded:w})})}massSubscribe(u,h,p,g){u.forEach(y=>{this.dispatch({type:St.KEY_METRIC_SUBSCRIBE,metric:Ue(Ue(Ue({userId:y.userId,type:y.type},h&&{subscribeStart:h}),p&&{subscribeEnd:p}),g&&{firstFrame:g})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(u,h){u.service==="gateway"&&Array.isArray(u.urls)&&(u.urls=u.urls.map(p=>p.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof h!="number"?(this.dispatch({type:St.RECORD_JOIN_CHANNEL_SERVICE,record:Ue(Ue({},u),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(h<0||h>=this.state.joinChannelServiceRecords.length||this.dispatch({type:St.RECORD_JOIN_CHANNEL_SERVICE,record:u,index:h}),h)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:St.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:St.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}}(r.codec,r.audioCodec,r.mode,this._clientId),this._leaveMutex=new fi("client-leave",this._clientId),this._publishMutex=new fi("client-publish",this._clientId),this._renewTokenMutex=new fi("client-renewtoken",this._clientId),this._subscribeMutex=new fi("client-subscribe",this._clientId),this.store.clientCreated(),r.proxyServer&&this.setProxyServer(r.proxyServer,!0),r.turnServer&&this.setTurnServer(r.turnServer,!0),L.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(xs," build: ").concat(R1,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),r.clientRoleOptions)try{h1(r.clientRoleOptions),s=Object.assign({},r.clientRoleOptions)}catch(u){L.warning("[".concat(this._clientId,"] ").concat(u.toString()))}var c;this._statsCollector=new R_(this.store),this._statsCollector.onStatsException=(u,h,p)=>{L.warn("[".concat(this._clientId,"] receive exception msg, code: ").concat(u,", msg: ").concat(h,", uid: ").concat(p)),this.safeEmit(_t.EXCEPTION,{code:u,msg:h,uid:p})},this._statsCollector.onUploadPublishDuration=(u,h,p,g)=>{const y=this._users.find(b=>b.uid===u);y&&We.peerPublishStatus(this._sessionId,{subscribeElapse:g,audioPublishDuration:h,videoPublishDuration:p,peer:y._uintid})},this._statsCollector.onVideoCodecChanged=u=>{if(q("VIDEO_STANDARD_BITRATE_VERSION")&&(u==="av1"||u==="h265"||u==="h264")){const h=this.localTracks.find(p=>p instanceof pn);h&&h._saveEncodeBitrateRatio!==1&&h.setSaveEncodeBitrateRatio(u==="h264"?q("BASELINE_MORE_H264_BITRATE_RATIO"):void 0)}},this.store.useP2P=r.mode==="p2p",this._gateway=new bxe(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:r.websocketRetryConfig||rr,httpRetryConfig:r.httpRetryConfig||rr,forceWaitGatewayResponse:r.forceWaitGatewayResponse===void 0||r.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:r.role,clientRoleOptions:s}),this._configDistribute=new Pxe(this._clientId,this.store),this.store.useP2P?(this._p2pChannel=(c={store:this.store,statsCollector:this._statsCollector},Xl("P2PChannel").create(c)),this._handleP2PEvents()):this._p2pChannel=new I_(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(r,o,s,c,u){let h=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],p=arguments.length>6&&arguments[6]!==void 0&&arguments[6];Yt("JOIN_GATEWAY_USE_443PORT_ONLY",h),Yt("JOIN_GATEWAY_USE_DUAL_DOMAIN",p);const g=this._gateway.signal.websocket;return g instanceof sD&&(g.use443PortOnly=h,g.tryDoubleDomain=p),async function(y,b,w){Iw.get(y)||Iw.set(y,[]),xw.get(y)||xw.set(y,b),Kc.get(y)||Kc.set(y,0);const C=Iw.get(y),A=xw.get(y);if(!C||!A)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(Kc.get(y)===A){const K=n_();C.push(K),await K.promise}Kc.set(y,Kc.get(y)+1);for(var x=arguments.length,B=new Array(x>3?x-3:0),U=3;U<x;U++)B[U-3]=arguments[U];const F=await w(...B);return Kc.set(y,Kc.get(y)-1),Kc.get(y)===A-1&&C.length>0&&(C[0].resolve(),C.shift()),Kc.get(y)===0&&(Iw.set(y,[]),xw.set(y,0),Kc.set(y,0)),F}("client.join",q("JOIN_MAX_CONCURRENCY"),this.join.bind(this),r,o,s,c,u)}async join(r,o,s,c,u){const h=++this._numberOfJoinCount;this.store.joinStart(),c&&(this.store.uid=c);const p=(jw||jw||(jw=(window.location.protocol.split(":")[0]||"").toUpperCase(),jw))==="HTTPS",g=L8()?window.isSecureContext:"Browser Not Support";(!L8()&&!p||!window.isSecureContext)&&L.warning("The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser"),We.setAppId(r);try{if(!s&&s!==null)throw new pe(Y.INVALID_PARAMS,"Invalid token: ".concat(s,". If you don not use token, set it to null"));s&&Hr(s,"token",1,2047),Hr(r,"appid",1,2047),iT(o),c&&oT(c),u&&Hr(u,"optionalInfo",1,2047)}catch(U){throw We.reportApiInvoke(sf(),{name:Yn.JOIN,options:[r,o,s,c],states:{isHttps:p,isSecureContext:g},tag:Nn.TRACER}).onError(U),U}if(this._leaveMutex.isLocked&&(L.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),L.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const U=new pe(Y.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw We.reportApiInvoke(sf(),{name:Yn.JOIN,options:[r,o,s,c],states:{isHttps:p,isSecureContext:g},tag:Nn.TRACER}).onError(U),U}this._gateway.state="CONNECTING";const y=await DY({appId:r,cname:o,uid:c,stringUid:typeof c=="string"?c:void 0,token:s||r,cloudProxyServer:this._cloudProxyServerMode});if(!this._joinAndNotLeaveYet)throw new pe(Y.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));const b=(y==null?void 0:y.sid)||sf();L.info("[".concat(this._clientId,"] start join channel ").concat(o,", join number: ").concat(h)),this._sessionId||(this._sessionId=b,this.store.sessionId=this._sessionId);const w=We.reportApiInvoke(b,{id:this._clientId,name:Yn.JOIN,options:[r,o,s,c],states:{isHttps:p,isSecureContext:g},tag:Nn.TRACER}),C=Sa(Sa(Sa({},this._rtmConfig),{},{role:this.role,clientId:this._clientId,appId:r,sid:this._sessionId,cname:o,uid:typeof c!="string"?c:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:s||r,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:u,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint,preload:!!y},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType}),{},{apRequestDetail:q("AP_REQUEST_DETAIL")||void 0});if(this._useLocalAccessPoint&&(C.setLocalAPVersion=this._setLocalAPVersion),typeof c=="string"&&(C.stringUid=c,this._uintUid?(C.uid=this._uintUid,this._uintUid=void 0):C.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(C.aesmode=this._encryptionMode,C.aespassword=await(async U=>{const F=function(ie){const oe=window.atob(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),re=new Uint8Array(new ArrayBuffer(oe.length));for(let me=0;me<oe.length;me+=1)re[me]=oe.charCodeAt(me);return re}(),K=await window.crypto.subtle.importKey("spki",F,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),z=u1(U),Q=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},K,z);return function(ie){let oe="";for(let re=0;re<ie.length;re+=1)oe+=String.fromCharCode(ie[re]);return window.btoa(oe)}(new Uint8Array(Q))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new pe(Y.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(C.aessalt=this._encryptionSalt)}if(this._encryptDataStream&&(this._encryptionMode==="aes-128-gcm2"||this._encryptionMode==="aes-256-gcm2"))if(this._encryptionSalt&&this._encryptionSecret)if(window.crypto.subtle){const U=new TextEncoder,F=q("USE_PURE_ENCRYPTION_MASTER_KEY")?U.encode(C.appId+this._encryptionSecret+this._encryptionSecret):U.encode(C.appId+C.cname+this._encryptionSecret);this._encryptDataStreamIv=await async function(K,z,Q){const ie=await window.crypto.subtle.importKey("raw",z,"PBKDF2",!1,["deriveBits","deriveKey"]),oe=K==="aes-128-gcm2"?128:256,re=await window.crypto.subtle.deriveBits({name:"PBKDF2",iterations:H8,hash:"SHA-256",salt:Q},ie,oe+XOe);return new Uint8Array(re).subarray(oe/8)}(this._encryptionMode,F,of(this._encryptionSalt)),this._encryptDataStreamKey=await async function(K,z,Q){const ie=await window.crypto.subtle.importKey("raw",z,"PBKDF2",!1,["deriveBits","deriveKey"]),oe=K==="aes-128-gcm2"?128:256;return await window.crypto.subtle.deriveKey({name:"PBKDF2",iterations:H8,hash:"SHA-256",salt:Q},ie,{name:"AES-GCM",length:oe},!0,["encrypt","decrypt"])}(this._encryptionMode,F,of(this._encryptionSalt))}else g?L.warning("[".concat(this._clientId,"] encrypt datastream must be running in a secure context, fallback to plain data stream")):L.warning("[".concat(this._clientId,"] current browser do not support WebCrypto ,fallback to plain data stream")),this._encryptDataStream=!1;else this._encryptDataStream=!1,L.debug("[".concat(this._clientId,"] no salt / secret, cannot support encrypt data stream, fallback to plain data stream"));this._startSession(this._sessionId,{channel:o,appId:r,stringUid:C.stringUid});const A=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&A===this._sessionId&&We.joinChannelTimeout(this._sessionId,5)},5e3);try{var x;let U;const F=C.cloudProxyServer;if(Pe(x=["proxy3","proxy4","proxy5"]).call(x,F)){const oe=q("PROXY_SERVER_TYPE3");Array.isArray(oe)?C.proxyServer=oe[0]:C.proxyServer=oe}if(We.setProxyServer(C.proxyServer),L.setProxyServer(C.proxyServer),this.store.requestAPStart(),y){if(L.debug("[".concat(this._clientId,"] get serverInfo Success from Preload Cache ").concat(C.stringUid?", ".concat(C.stringUid," => ").concat(y.intUid):""," ")),C.stringUid&&!C.uid&&(C.uid=y.intUid),U={gatewayInfo:y.ap.gatewayInfo},q("JOIN_WITH_FALLBACK_MEDIA_PROXY")&&C.turnServer.mode==="auto")if(y.ap.proxyInfo.addresses.length===0)L.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers");else{const oe=(await Az(y.ap.proxyInfo,y.ap.gatewayInfo.uid)).map(re=>({turnServerURL:re.address,tcpport:re.tcpport||si.tcpport,udpport:re.udpport||si.udpport,username:re.username||si.username,password:re.password||si.password,forceturn:!1,security:!0}));C.turnServer={mode:"manual",servers:oe}}MY(y,C.stringUid)}else{if(C.stringUid&&!C.uid){let oe;[oe,U]=await De.all([tY(C.stringUid,C,this._axiosCancelSource.token,this._config.httpRetryConfig||rr,this.store),eY(C,this._axiosCancelSource.token,this._config.httpRetryConfig||rr,!0,this.store)]),L.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(C.stringUid," => ").concat(oe)),C.uid=oe,U.gatewayInfo.uid=oe,U.gatewayInfo.res.uid=oe}else U=await eY(C,this._axiosCancelSource.token,this._config.httpRetryConfig||rr,!0,this.store);if(!this._joinAndNotLeaveYet)throw new pe(Y.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"))}this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(C,this._axiosCancelSource.token),this._configDistribute.on(v_.UPDATE_BITRATE_LIMIT,oe=>{this._p2pChannel.updateBitrateLimit(oe)}),this._configDistribute.on(v_.UPDATE_CLIENT_ROLE_OPTIONS,oe=>{this._setClientRoleOptions(oe)})},0),this._key=s||r;const K=U.gatewayInfo,z=C.uid?C.uid:K.uid;this._joinInfo=Sa(Sa({},C),{},{cid:K.cid,uid:z,vid:K.vid,apResponse:K.res,apGatewayAddress:K.apGatewayAddress,uni_lbs_ip:K.uni_lbs_ip,gatewayAddrs:K.gatewayAddrs}),this.store.intUid=z,this.store.cid=K.cid;const Q=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new pe(Y.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));w.onSuccess(Q),this._appId=r,this._channelName=C.cname,this._uid=Q,this.store.uid=Q,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(ri()?"beforeunload":"pagehide",this._handleBeforeUnload),this._statsCollector.startUpdateStats()},0);const ie=C.stringUid?"string uid: ".concat(C.stringUid,",uid: ").concat(C.uid):"uid: ".concat(this._uid);return L.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(o,",").concat(ie)),setTimeout(()=>{L.startUpload()},5e3),this.store.joinEnd(),B=this,Pe(ff).call(ff,B)||ff.push(B),this._cloudProxyServerMode==="disabled"&&xt().supportWebCrypto&&q("ENABLE_PRELOAD")&&DD(this._joinInfo),Q}catch(U){const F=Array.isArray(U)?U[0]:U;throw F&&F.code===Y.OPERATION_ABORTED?L.warning("[".concat(this._clientId,"] join number: ").concat(h,", Joining channel failed, rollback"),F):L.error("[".concat(this._clientId,"] join number: ").concat(h,", Joining channel failed, rollback"),F),F.code!==Y.OPERATION_ABORTED&&this._numberOfJoinCount===h&&(this._gateway.state="DISCONNECTED",this._reset()),w.onError(F),F}var B}_joinGateway(){if(!this._joinInfo||!this._key)throw new pe(Y.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!q("JOIN_WITH_FALLBACK_SIGNAL_PROXY")))}async leave(){L.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(ri()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(o){const s=ff.indexOf(o);s!==-1&&ff.splice(s,1)}(this),this._statsCollector.stopUpdateStats();const r=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return L.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void r();await this._gateway.leave(this.connectionState!=="CONNECTED",Bt.LEAVE),L.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),r()}async publish(r){let o=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!Array.isArray(r)){if(!(r instanceof Am))return this._publishDataChannel(r);r=[r]}if(r.length===0)throw new pe(Y.INVALID_PARAMS,"param list is empty");const s=r;if(this._gateway.role==="audience")throw new pe(Y.INVALID_OPERATION,"audience can not publish stream");for(const u of s){if(!(u instanceof Am))throw new pe(Y.INVALID_PARAMS,"parameter is not local track");if(!u._enabled&&o)throw new pe(Y.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(u.getTrackId()))}L.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(s.map(u=>"".concat(u.getTrackId()," "))));const c=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),o&&s.forEach(u=>{const h=this._configDistribute.getBitrateLimit();u instanceof pn&&h&&u.setBitrateLimit(h.uplink)});try{await this._publishHighStream(s),L.info("[".concat(this._clientId,"] Publish success, id ").concat(s.map(u=>"".concat(u.getTrackId()," "))))}catch(u){throw L.error("[".concat(this._clientId,"] publish error"),u.toString()),u}finally{c()}}async _publishDataChannel(r){Qt(r.id,"id",0,65535,!0),Gl(r.ordered,"ordered"),Hr(r.metadata,"metadata",0,512),L.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(r.id));const o=await this._publishMutex.lock();try{if(this._p2pChannel.getAllDataChannels().findIndex(u=>u.id===r.id)!==-1)throw new pe(Y.INVALID_PARAMS,"Invalid id: ".concat(r.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||this._uid===void 0)throw new pe(Y.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&q("FORCE_TURN")&&!q("TURN_ENABLE_TCP")&&!q("TURN_ENABLE_UDP"))throw new pe(Y.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const s=function(u){return Hz(u,!1)}(r),c=await this._p2pChannel.publishDataChannel([s]);if(c.length>0){if(typeof s._originDataChannelId!="number")throw L.error("[".concat(this._clientId,"] can not publish with mediaType datachannel, cannot get RTCDatachannel id")),new pe(Y.CREATE_DATACHANNEL_ERROR);try{await De.all(c.map(u=>this._uid&&this._gateway.publishDataChannel(this._uid,u,!0))),await s._waitTillOpen()}catch(u){if(u.code!==Y.DISCONNECT_P2P)throw u}}return L.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(s.id)),s}catch(s){throw L.error("[".concat(this._clientId,"] publish datachannels error"),s.toString()),s}finally{o()}}async unpublish(r){if(!this._joinInfo||this._uid===void 0)throw new pe(Y.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let o=[];if(r)if(Array.isArray(r))o=r;else{if(!(r instanceof Am))return this._unpublishDataChannel([r]);o=[r]}else this.store.useP2P||await this._unpublishDataChannel(),o=this._p2pChannel.getAllTracks(!0);L.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(o.map(c=>"".concat(c.getTrackId()," "))," "));const s=await this._publishMutex.lock();try{if(this.store.useP2P){const c=await this._p2pChannel.unpublish(o);c&&await this._gateway.sendExtensionMessage(Wn.UNPUBLISH,{unpubMsg:c},!0)}else{const c=await this._p2pChannel.unpublish(o);c&&await this._gateway.unpublish(c,this._uid),L.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(o.map(u=>"".concat(u.getTrackId()))))}}catch(c){throw L.error("[".concat(this._clientId,"] unpublish error"),c.toString()),c}finally{s&&s()}}async _unpublishDataChannel(r){r!==void 0&&r.length!==0||(r=this._p2pChannel.getAllDataChannels()),L.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(r.map(s=>"".concat(s.id," "))," "));const o=await this._publishMutex.lock();try{const s=await this._p2pChannel.unpublishDataChannel(r);s&&await this._gateway.unpublishDataChannel(s),L.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(r.map(c=>"".concat(c.id))))}catch(s){throw L.error("[".concat(this._clientId,"] unpublish dataChannel error"),s.toString()),s}finally{o&&o()}}async subscribe(r,o,s){if(!(r instanceof _d)){const c=this.remoteUsers.find(u=>u.uid===r);if(!c)throw new pe(Y.INVALID_REMOTE_USER,"user is not in the channel");r=c}return o==="datachannel"?this._subscribeDataChannel(r,s):this._subscribe(r,o)}async presubscribe(r,o){if(yr(o,"mediaType",["audio","video"]),this.store.useP2P)throw new pe(Y.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new pe(Y.INVALID_OPERATION,"can't presub when not join");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const s=o===je.AUDIO,c=o===je.VIDEO,u=await this._subscribeMutex.lock();try{const{ssrcId:h,ortc:p,rtxSsrcId:g,cname:y,uint_id:b}=await this._gateway.presubscribe(r,o,!0);if(h==null)throw new pe(Y.UNEXPECTED_RESPONSE,"no ssrc id");let w=this._users.find(A=>A.uid===r);w||(w=new _d(r,b||r),w._is_pre_created=!0,this._users.push(w)),y&&(w._cname=y),w._uintid||(w._uintid=b||r),s&&(w._audioSSRC=h,w._audio_pre_subscribed=!0,p&&(w._audioOrtc=p)),c&&(w._videoSSRC=h,w._video_pre_subscribed=!0,p&&(w._videoOrtc=p),g!=null&&(w._rtxSsrcId=g)),L.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(h)),await this._p2pChannel.subscribe(w,o,h,g,p);const C=s?w._audioTrack:w._videoTrack;if(!C)throw new pe(Y.UNEXPECTED_ERROR,"can not find remote track in user");return s&&(w._trust_audio_stream_added_state_=!0,w._audio_added_=!0),c&&(w._trust_video_stream_added_state_=!0,w._video_added_=!0),C}catch(h){throw L.error("[".concat(this._clientId,"] presub user ").concat(r," error"),h),h}finally{u()}}async _subscribeDataChannel(r,o){var s;if(Qt(o,"channelId",0,65535,!0),!this._joinInfo)throw new pe(Y.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find(g=>g===r))throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", this user is not in the channel")),new pe(Y.INVALID_REMOTE_USER,"user is not in the channel");if(!r.hasAudio&&!r.hasVideo&&r._dataChannels.length===0)throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", user is not published")),new pe(Y.INVALID_REMOTE_USER,"user is not published");const u=(s=r._dataChannels)===null||s===void 0?void 0:s.find(g=>g.id===o);if(!u)throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid," with mediaType datachannel, remote datachannel is not published")),new pe(Y.REMOTE_USER_IS_NOT_PUBLISHED);const h=await this._subscribeMutex.lock();L.info("[".concat(this._clientId,"] subscribe user ").concat(r.uid,", mediaType: datachannel"));try{const g=await this._p2pChannel.subscribeDataChannel(r,[u]);if(g&&Pe(g).call(g,u.id))try{var p;if(typeof u._originDataChannelId!="number")throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid," with mediaType datachannel, cannot get RTCDatachannel")),new pe(Y.CREATE_DATACHANNEL_ERROR);const y={id:u.id,datachannelId:u._originDataChannelId,ordered:u.ordered,maxRetransmits:u.maxRetransmits,metadata:(p=u.metadata)!==null&&p!==void 0?p:""};await this._gateway.subscribeDataChannel(r.uid,y,!0),await u._waitTillOpen()}catch(y){if((y==null?void 0:y.code)!==Y.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(r,[u]),y;await this._p2pChannel.unsubscribeDataChannel(r,[u]),this._p2pChannel.setPendingRemoteDataChannel(r,u.id)}return L.info("[".concat(this._clientId,"] subscribe success user ").concat(r.uid,", mediaType: datachannel")),u}finally{h()}}async _p2pSubscribe(r,o,s){if(yr(o,"mediaType",["audio","video"]),!this._joinInfo)throw new pe(Y.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(h=>h===r)){const h=new pe(Y.INVALID_REMOTE_USER,"user is not in the channel");throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", this user is not in the channel")),h}if(!r.hasAudio&&!r.hasVideo){const h=new pe(Y.INVALID_REMOTE_USER,"user is not published");throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", user is not published")),h}if(!s&&(o==="audio"&&!r.hasAudio||o==="video"&&!r.hasVideo)){const h=new pe(Y.REMOTE_USER_IS_NOT_PUBLISHED);throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid," with mediaType ").concat(o,", remote track is not published")),h}const u=await this._subscribeMutex.lock();L.info("[".concat(this._clientId,"] subscribe user ").concat(r.uid,", mediaType: ").concat(o));try{if(await this._p2pChannel.hasRemoteMediaWithLock(r,o))await this._p2pChannel.unmuteRemote(r,o);else try{const p=o==="audio"?r._audioSSRC:r._videoSSRC,g=o==="audio"?r._audioMid:r._videoMid;this.store.subscribe(r.uid,o,Date.now()),this.store.useP2P&&await this._p2pChannel.subscribe(r,o,p,g)}catch(p){throw p}L.info("[".concat(this._clientId,"] subscribe success user ").concat(r.uid,", mediaType: ").concat(o)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(r.uid,this._defaultStreamFallbackType).catch(p=>{L.warning("[".concat(this._clientId,"] auto set fallback failed"),p)});const h=o==="audio"?r._audioTrack:r._videoTrack;if(!h)throw new pe(Y.UNEXPECTED_ERROR,"can not find remote track in user object");return h}catch(h){throw L.error("[".concat(this._clientId,"] subscribe user ").concat(r.uid," error"),h),h}finally{u()}}async _subscribe(r,o,s){if(this.store.useP2P)return this._p2pSubscribe(r,o);if(yr(o,"mediaType",["audio","video"]),!this._joinInfo)throw new pe(Y.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(b=>b===r)){const b=new pe(Y.INVALID_REMOTE_USER,"user is not in the channel");throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", this user is not in the channel")),b}if(!r.hasAudio&&!r.hasVideo){const b=new pe(Y.INVALID_REMOTE_USER,"user is not published");throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid,", user is not published")),b}if(!(s||(o!=="audio"||r.hasAudio&&r._audioSSRC!==void 0)&&(o!=="video"||r.hasVideo&&r._videoSSRC!==void 0))){const b=new pe(Y.REMOTE_USER_IS_NOT_PUBLISHED);throw L.error("[".concat(this._clientId,"] can not subscribe ").concat(r.uid," with mediaType ").concat(o,", remote track is not published")),b}let u=o==="audio"?r._audioSSRC:r._videoSSRC,h=o==="audio"?r._audioOrtc:r._videoOrtc,p=o==="video"?r._rtxSsrcId:void 0,g={stream_type:o==="audio"?je.AUDIO:je.VIDEO,ssrcId:u};const y=await this._subscribeMutex.lock();L.info("[".concat(this._clientId,"] subscribe user ").concat(r.uid,", mediaType: ").concat(o));try{if(await this._p2pChannel.hasRemoteMediaWithLock(r,o))await this._p2pChannel.unmuteRemote(r,o);else try{const w=o==="audio"?r._audioSSRC:r._videoSSRC;w!==void 0&&w!==u&&(u=w,h=o==="audio"?r._audioOrtc:r._videoOrtc,p=o==="video"?r._rtxSsrcId:void 0,g={stream_type:o==="audio"?je.AUDIO:je.VIDEO,ssrcId:u}),gi.markSubscribeStart(this.store.clientId,u),this.store.subscribe(r.uid,o,Date.now()),await this._p2pChannel.subscribe(r,o,u,p,h);try{this._p2pChannel.isPreSubScribe(u)||await this._gateway.subscribe(r.uid,g,!0)}catch(C){if((C==null?void 0:C.code)!==Y.WS_ABORT)throw await this._p2pChannel.unsubscribe(r,o),C;await this._p2pChannel.unsubscribe(r,o,!0),this._p2pChannel.setPendingRemoteMedia(r,o)}this.store.subscribe(r.uid,o,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,r,o)}catch(w){throw this._p2pChannel.reportSubscribeEvent(!1,w==null?void 0:w.code,r,o),w}L.info("[".concat(this._clientId,"] subscribe success user ").concat(r.uid,", mediaType: ").concat(o)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(r.uid,this._defaultStreamFallbackType).catch(w=>{L.warning("[".concat(this._clientId,"] auto set fallback failed"),w)});const b=o==="audio"?r._audioTrack:r._videoTrack;if(!b)throw new pe(Y.UNEXPECTED_ERROR,"can not find remote track in user object");return b}catch(b){throw L.error("[".concat(this._clientId,"] subscribe user ").concat(r.uid," error"),b),b}finally{y()}}async massSubscribe(r){if(Hl(r,"subscribeList"),!this._joinInfo)throw new pe(Y.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const o=Date.now(),s=new Map,c=await this._subscribeMutex.lock();L.info("[".concat(this._clientId,"]start massSubscribe user ").concat(r.map(g=>{let{user:y,mediaType:b}=g;return"user: ".concat(y==null?void 0:y.uid,", mediaType: ").concat(b)}).join("; ")));const u=(r=[...r]).map(g=>{let{user:y,mediaType:b}=g;return{user:y,mediaType:b}}),h=await this._p2pChannel.globalLock();try{var p;for(let y=r.length-1;y>=0;y--){const b=r[y],{user:w,mediaType:C}=b;if(yr(C,"mediaType",["audio","video"]),!w){const U=new pe(Y.INVALID_PARAMS,"user property does not exist in subscribeList item");throw L.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),U}if(!this._users.find(U=>U===w)){const U=new pe(Y.INVALID_REMOTE_USER,"user is not in the channel");L.error("[".concat(this._clientId,"] can not massSubscribe ").concat(w.uid,", this user is not in the channel")),u[y].error=U,r.splice(y,1);continue}if(C==="audio"&&(!w.hasAudio||w._audioSSRC===void 0)||C==="video"&&(!w.hasVideo||w._videoSSRC===void 0)){const U=new pe(Y.REMOTE_USER_IS_NOT_PUBLISHED);L.error("[".concat(this._clientId,"] can not subscribe ").concat(w.uid," with mediaType ").concat(C,", remote user is not published")),u[y].error=U,r.splice(y,1);continue}const x=Or.Video|Or.LwoVideo,B=s.get(w);if(B){if(C==="video"?B&x:B&Or.Audio){r.splice(y,1),L.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(w.uid,", mediaType:").concat(C," twice"));continue}s.set(w,B|(C==="video"?x:Or.Audio))}else s.set(w,C==="video"?x:Or.Audio)}for(let y=r.length-1;y>=0;y--){const b=r[y],{user:w,mediaType:C}=b,A=Or.Video|Or.LwoVideo;if(this._p2pChannel.hasRemoteMedia(w,C)){await this._p2pChannel.unmuteRemoteNoLock(w,C);const x=s.get(w);s.set(w,C==="video"?x^A:x^Or.Audio),r.splice(y,1)}}this.store.massSubscribe(r.map(y=>({userId:y.user.uid,type:y.mediaType})),o);let g=oa(p=Array.from(s.entries())).call(p,(y,b)=>{let[w,C]=b;if(C===0)return y;const A={stream_id:w.uid,stream_type:C};return C&Or.Audio&&(A.audio_ssrc=w._audioSSRC),C&Or.Video&&(A.video_ssrc=w._videoSSRC),y.push(A),y},[]);try{r.length>0&&await this._p2pChannel.massSubscribeNoLock(r.map(b=>{let{user:w,mediaType:C}=b;return{user:w,mediaType:C,ssrcId:C===je.VIDEO?w._videoSSRC:w._audioSSRC,rtxSsrcId:C===je.VIDEO?w._rtxSsrcId:void 0}}));const y=new Map;if(g=g.filter(b=>b.video_ssrc&&!this._p2pChannel.isPreSubScribe(b.video_ssrc)||b.audio_ssrc&&!this._p2pChannel.isPreSubScribe(b.audio_ssrc)||!b.video_ssrc&&!b.audio_ssrc),g.length>0){const b=await this._gateway.subscribeAll(g,!0);((b==null?void 0:b.users)||[]).forEach(w=>{let{stream_id:C,video_error_code:A,audio_error_code:x,error_code:B}=w;(A||x||B)&&y.set(C,{video_error_code:A,audio_error_code:x,error_code:B})})}if(Array.from(y.entries()).length>0){const b=[];Array.from(y.entries()).forEach(w=>{let[C,A]=w;const x=this.remoteUsers.find(B=>B.uid===C);if(x){let B;A.error_code||A.video_error_code&&A.audio_error_code?B=void 0:A.video_error_code?B=je.VIDEO:A.audio_error_code&&(B=je.AUDIO),b.push({user:x,mediaType:B})}}),b.length>0&&await this._p2pChannel.massUnsubscribeNoLock(b)}for(const b of u){const w=y.get(b.user.uid);if(w){const C=w.error_code||b.mediaType==="audio"&&w.audio_error_code||b.mediaType==="video"&&w.video_error_code;if(C){const A=y_(C);L.error("user:".concat(b.user.uid," mediaType:").concat(b.mediaType," has massSubscribe error ").concat(A.desc)),b.error=new pe(Y.SUBSCRIBE_FAILED,"code ".concat(C,": ").concat(A.desc))}}b.error||(b.mediaType==="video"?b.track=b.user.videoTrack:b.track=b.user.audioTrack)}return this.store.massSubscribe(u.filter(b=>!b.error).map(b=>({userId:b.user.uid,type:b.mediaType})),void 0,Date.now()),u.forEach(b=>{var w;We.subscribe(this.store.sessionId,{succ:!!b.error,ec:((w=b.error)===null||w===void 0?void 0:w.code)||null,video:b.mediaType===je.VIDEO,audio:b.mediaType===je.AUDIO,peerid:b.user.uid,subscribeRequestid:b.mediaType===je.VIDEO?b.user._videoSSRC:b.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-o),preSsrc:this._p2pChannel.isPreSubScribe(b.user._videoSSRC)},!0)}),L.info("[".concat(this._clientId,"] massSubscribe success ").concat(r.map(b=>{let{user:w,mediaType:C}=b;return"user: ".concat(w==null?void 0:w.uid,", mediaType: ").concat(C)}).join("; "))),u}catch(y){throw await this._p2pChannel.massUnsubscribeNoLock(r),y}}finally{h(),c()}}async unsubscribe(r,o,s){if(!(r instanceof _d)){const h=this.remoteUsers.find(p=>p.uid===r);if(!h)throw new pe(Y.INVALID_REMOTE_USER,"user is not in the channel");r=h}if(o||this.store.useP2P){if(o==="datachannel")return this._unsubscribeDataChannel(r,s)}else await this._unsubscribeDataChannel(r,s);if(o&&yr(o,"mediaType",["audio","video"]),!this._joinInfo)throw new pe(Y.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(h=>h===r)){const h=new pe(Y.INVALID_REMOTE_USER,"user is not in the channel");throw L.error("[".concat(this._clientId,"] can not unsubscribe ").concat(r.uid,", user is not in the channel")),h}L.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(r.uid,", mediaType: ").concat(o));const u=await this._subscribeMutex.lock();try{if(this.store.useP2P)await this._p2pChannel.unsubscribe(r,o);else{const h=await this._p2pChannel.unsubscribe(r,o);h&&await this._gateway.unsubscribe(h,r.uid),o&&o!=="audio"||(r._audio_pre_subscribed=!1),o&&o!=="video"||(r._video_pre_subscribed=!1),r._is_pre_created&&kw(this._users,r),L.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(r.uid,", mediaType: ").concat(o))}}catch(h){if(h.code===Y.DISCONNECT_P2P)return void L.warning("disconnecting p2p, abort unsubscribe request.");throw L.error("[".concat(this._clientId,"] unsubscribe user ").concat(r.uid," error"),h.toString()),h}finally{u()}}async _unsubscribeDataChannel(r,o){if(o&&Qt(o,"id",0,65535,!0),!this._joinInfo)throw new pe(Y.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find(u=>u===r)){const u=new pe(Y.INVALID_REMOTE_USER,"user is not in the channel");throw L.error("[".concat(this._clientId,"] can not unsubscribe ").concat(r.uid,", user is not in the channel")),u}let c;if(typeof o=="number"){const u=r._dataChannels.find(h=>h.id===o);u&&(c=[u])}else c=r._dataChannels;if(c===void 0){const u=new pe(Y.REMOTE_USER_IS_NOT_PUBLISHED);throw L.error("[".concat(this._clientId,"] can not unsubscribe ").concat(r.uid," with channelId ").concat(o,", remote datachannel is not published")),u}L.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(r.uid,", mediaType: datachannel, ids: ").concat(c.map(u=>u.id)));try{const u=await this._p2pChannel.unsubscribeDataChannel(r,c);u&&await this._gateway.unsubscribeDataChannel(u,r.uid),L.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(r.uid,", mediaType: datachannel, ids: ").concat(u))}catch(u){if(u.code===Y.DISCONNECT_P2P)return void L.warning("disconnecting p2p, abort unsubscribe request.");throw L.error("[".concat(this._clientId,"] unsubscribe user ").concat(r.uid," error"),u.toString()),u}}async massUnsubscribe(r){if(Hl(r,"unsubscribeList"),!this._joinInfo)throw new pe(Y.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");L.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(r.map(s=>{let{user:c,mediaType:u}=s;return"user: ".concat(c==null?void 0:c.uid,", mediaType: ").concat(u,";")}).join())),r=[...r];const o=new Map;for(let s=r.length-1;s>=0;s--){const{user:c,mediaType:u}=r[s];if(!c){const g=new pe(Y.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw L.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),g}if(yr(u,"mediaType",["video","audio",void 0]),!this._users.find(g=>g===c)){L.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(c.uid,", user is not in the channel")),r.splice(s,1);continue}const p=Or.Video|Or.LwoVideo;if(o.has(c)){const g=o.get(c);let y;switch(u){case"video":y=g&p;break;case"audio":y=g&Or.Audio;break;default:y=g&(Or.Audio|p)}if(y){L.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(c.uid,",mediaType:").concat(u," twice.")),r.splice(s,1);continue}u?u==="audio"?o.set(c,g|Or.Audio):u==="video"&&o.set(c,g|p):o.set(c,g|Or.Audio|p)}else u?u==="audio"?o.set(c,Or.Audio):u==="video"&&o.set(c,p):o.set(c,Or.Audio|p)}try{const s=await this._p2pChannel.massUnsubscribe(r);s&&await this._gateway.massUnsubscribe(s),L.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(r.map(c=>{let{user:u,mediaType:h}=c;return"user: ".concat(u==null?void 0:u.uid,", mediaType: ").concat(h,";")}).join()))}catch(s){if(s.code===Y.DISCONNECT_P2P)return void L.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw L.error("[".concat(this._clientId,"] massUnsubscribe error"),s.toString()),s}}async setLowStreamParameter(r){(function(s){if(!s)throw new ve(Y.INVALID_PARAMS);Pn(s.width)||c1(s.width,"streamParameter.width"),Pn(s.height)||c1(s.height,"streamParameter.height"),Pn(s.framerate)||c1(s.framerate,"streamParameter.framerate"),Pn(s.bitrate)||Qt(s.bitrate,"streamParameter.bitrate")})(r),(!r.width&&r.height||r.width&&!r.height)&&L.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),L.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(r));const o=this._configDistribute.getLowStreamConfigDistribute();if(o&&o.bitrate&&r.bitrate&&o.bitrate<r.bitrate&&(r.bitrate=o.bitrate),this._lowStreamParameter=r,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(r,Te.LocalVideoLowTrack)}async enableDualStream(){if(!xt().supportDualStream)throw We.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new pe(Y.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new pe(Y.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(r){throw We.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),r}this._isDualStreamEnabled=!0,We.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),L.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new pe(Y.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(Te.LocalVideoLowTrack))try{const r=await this._p2pChannel.unpublishLowStream();r&&await this._gateway.unpublish(r,this._joinInfo.stringUid||this._joinInfo.uid)}catch(r){throw We.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),r}this._isDualStreamEnabled=!1,We.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),L.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(r,o){if(function(c){yr(c,"role",["audience","host"])}(r),o&&h1(o),this.mode==="rtc"||this.mode==="p2p")throw L.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new pe(Y.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(o&&o.level&&r==="host")throw new pe(Y.INVALID_OPERATION,"host mode can not set audience latency level");if(r==="audience"&&this._p2pChannel.hasLocalMedia())throw new pe(Y.INVALID_OPERATION,"can not set client role to audience when publishing stream");const s=this._config.role;this._joinInfo&&(this._joinInfo.role=r),r!==s&&q("ENABLE_ROLE_SELECT_EDGE")?(this._gateway.updateClientRole(r,o),this._config.role=r,this._gateway.reconnect("recover",ii.REGIONAL_DISTRIBUTION)):(await this._gateway.setClientRole(r,o),this._config.role=r),L.info("[".concat(this._clientId,"] set client role to ").concat(r,", level: ").concat(o&&o.level))}async _setClientRoleOptions(r){if(this.mode==="rtc"||this.mode==="p2p"||this._config.role!=="audience"||this._p2pChannel.hasLocalMedia())return;let o=!1;try{r&&h1(r),await this._gateway.setClientRole(this._config.role,r),o=!0}catch{}finally{L.info("[".concat(this._clientId,"] set client role options ").concat(o?"succeed":"failed",", options is ").concat(r))}}getRemoteInboundOffset(){var r;const o=(r=this._p2pChannel.getStats())===null||r===void 0?void 0:r.audioSend[0];if(!o||!o.timestamp)return 0;const s=o.timestamp-Date.now();return Math.abs(s)>1e3+o.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?s:0}getNtpWallTimeInMs(){return document.visibilityState==="visible"&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(r,o){if(Hr(r,"proxyServer"),!o){if(this.connectionState!=="DISCONNECTED")throw new pe(Y.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new pe(Y.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=r,We.setProxyServer(this._proxyServer),L.setProxyServer(this._proxyServer),L.info("[".concat(this._clientId,"] Set proxy server ").concat(o?"by initialize call":""," success."))}setTurnServer(r,o){if(Array.isArray(r)||(r=[r]),!o){if(this.connectionState!=="DISCONNECTED")throw new pe(Y.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new pe(Y.INVALID_OPERATION,"You have already set the proxy")}if(a_(r))return this._turnServer={servers:r,mode:"original-manual"},void L.info("[".concat(this._clientId,"] Set original turnserver ").concat(o?"by initialize call":""," success: ").concat(r.map(s=>s.urls).join(","),"."));r.forEach(s=>w8(s)),this._turnServer={servers:r,mode:"manual"},L.info("[".concat(this._clientId,"] Set turnserver ").concat(o?"by initialize call":""," success."))}setLicense(r){if(this.connectionState!=="DISCONNECTED")throw new pe(Y.INVALID_OPERATION,"you should set license before join channel");if(Hr(r,"license",32,32),!/^[A-Za-z\d]+$/.test(r))throw new pe(Y.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=r,L.info("[".concat(this._clientId,"] set license success"),r)}startProxyServer(r){if(this.connectionState!=="DISCONNECTED")throw new pe(Y.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new pe(Y.INVALID_OPERATION,"You have already set the proxy");const o=[3,4,5];let s;switch(r===void 0&&(r=3),r){case 1:case 2:throw new pe(Y.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:s="proxy3";break;case 4:s="proxy4";break;case 5:s="proxy5";break;default:throw new pe(Y.INVALID_PARAMS,"proxy server mode must be ".concat(o.join("|")))}this._cloudProxyServerMode=s,this.store.cloudProxyServerMode=s,L.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new pe(Y.INVALID_OPERATION,"Stop proxy server after leave channel");We.setProxyServer(),L.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",L.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(r){if(!r.accessPoints)throw new pe(Y.INVALID_PARAMS,"accessPoints is required.");Hl(r.accessPoints.serverList,"accessPoints.serverList"),Hr(r.accessPoints.domain,"accessPoints.domain");const o=(A,x)=>{Qt(A,x,0,65535,!0)};let s=443;if(r.accessPoints.port&&(o(r.accessPoints.port,"accessPoints.port"),s=r.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new pe(Y.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");q("CLOSE_AFB_FOR_LOCAL_AP")&&(Yt("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),Yt("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const c=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,u=r.accessPoints.domain,h=r.accessPoints.serverList.map(A=>c.test(A)?"".concat(A.replace(/\./g,"-"),".").concat(u):A),p=h.map(A=>"".concat(A,":").concat(s));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,Yt("WEBCS_DOMAIN",p),Yt("WEBCS_DOMAIN_BACKUP_LIST",p),Yt("GATEWAY_DOMAINS",[u]),r.report&&r.report.hostname&&Array.isArray(r.report.hostname)&&r.report.hostname.length?(Hl(r.report.hostname,"report.hostname"),Yt("EVENT_REPORT_DOMAIN",r.report.hostname[0]),Yt("EVENT_REPORT_BACKUP_DOMAIN",r.report.hostname[1]||r.report.hostname[0])):(Yt("EVENT_REPORT_DOMAIN",h[0]),Yt("EVENT_REPORT_BACKUP_DOMAIN",h[1]||h[0]));let g=6443;r.report&&r.report.port&&(o(r.report.port,"report.port"),g=r.report.port),Yt("STATS_COLLECTOR_PORT",g),r.report?Yt("ENABLE_EVENT_REPORT",!0):Yt("ENABLE_EVENT_REPORT",!1);let y="";r.log&&r.log.hostname&&Array.isArray(r.log.hostname)&&r.log.hostname.length?(Hl(r.log.hostname,"log.hostname"),y=r.log.hostname[0]):y=h[0];let b=6444;r.log&&r.log.port&&(o(r.log.port,"log.port"),b=r.log.port),Yt("LOG_UPLOAD_SERVER","".concat(y,":").concat(b));let w=[];r.cds&&r.cds.hostname&&Array.isArray(r.cds.hostname)&&r.cds.hostname.length?(Hl(r.cds.hostname,"cds.hostname"),w=r.cds.hostname):w=h;let C=443;r.cds&&r.cds.port&&(o(r.cds.port,"cds.port"),C=r.cds.port),Yt("CDS_AP",w.map(A=>"".concat(A,":").concat(C))),r.cds?Yt("ENABLE_CONFIG_DISTRIBUTE",!0):Yt("ENABLE_CONFIG_DISTRIBUTE",!1),L.info("set local access point v2 success")}setLocalAccessPoints(r,o){if(Hl(r,"serverList"),Hr(o,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new pe(Y.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const s=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;r=r.map(c=>s.test(c)?"".concat(c.replace(/\./g,"-"),".").concat(o):c),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,Yt("WEBCS_DOMAIN",r),Yt("WEBCS_DOMAIN_BACKUP_LIST",r),Yt("GATEWAY_DOMAINS",[o]),Yt("EVENT_REPORT_DOMAIN",r[0]),Yt("EVENT_REPORT_BACKUP_DOMAIN",r[1]||r[0]),Yt("LOG_UPLOAD_SERVER","".concat(r[0],":6444")),L.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(r){if(yr(r,"streamType",[0,1,4,5,6,7,8,9]),this._remoteDefaultVideoStreamType=r,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(r),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(o){throw L.error("[".concat(this._clientId,"] set default remote video stream type error"),o.toString()),o}else L.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(r))}async setRemoteVideoStreamType(r,o){yr(o,"streamType",[0,1,4,5,6,7,8,9]);try{await this._gateway.setRemoteVideoStreamType(r,o),setTimeout(()=>{const s=this._users.find(c=>c.uid===r);s&&s.videoTrack&&s.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(s){throw L.error("[".concat(this._clientId,"] set remote video stream type error"),s.toString()),s}L.info("[".concat(this._clientId,"] set remote ").concat(r," video stream type to ").concat(o)),this._remoteStreamTypeCacheMap.set(r,o)}async setStreamFallbackOption(r,o){yr(o,"fallbackType",[0,1,2,3,4,5,6,7,8]);try{await this._gateway.setStreamFallbackOption(r,o)}catch(s){throw L.error("[".concat(this._clientId,"] set stream fallback option"),s.toString()),s}L.info("[".concat(this._clientId,"] set remote ").concat(r," stream fallback type to ").concat(o)),this._streamFallbackTypeCacheMap.set(r,o)}setEncryptionConfig(r,o,s,c){(function(h){yr(h,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])})(r),Hr(o,"secret");const u=["aes-128-gcm2","aes-256-gcm2"];if(Pe(u).call(u,r)){if(!s||!(s instanceof Uint8Array&&s.length===32))throw new pe(Y.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(s)throw new pe(Y.INVALID_PARAMS,"current encrypt mode does not need salt");if(c){if(Gl(c,"encryptDataStream"),!Pe(u).call(u,r))throw new pe(Y.INVALID_PARAMS,"current encrypt mode does not support data stream");this._encryptDataStream=!0}new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(o)||L.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=r,this._encryptionSecret=o,s&&(this._encryptionSalt=dd(s))}async renewToken(r){if(Hr(r,"token",1,2047),!this._key||!this._joinInfo)throw new pe(Y.INVALID_OPERATION,"renewToken should not be called before user join");const o=this._key;this._key=r,this._joinInfo&&(this._joinInfo.token=r);const s=await this._renewTokenMutex.lock();try{if(q("USE_NEW_TOKEN")){L.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const c=await xxe(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||rr);L.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:r,ticket:c})}else L.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:r});L.debug("[".concat(this._clientId,"] renewToken success"))}catch(c){throw this._key=o,this._joinInfo.token=o,L.error("[".concat(this._clientId,"] renewToken failed"),c.toString()),c}finally{s()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?L.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const r=this._p2pChannel.getAudioLevels();this.safeEmit(_t.VOLUME_INDICATOR,r)},q("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const r=this._statsCollector.getRTCStats(),o=this._gateway.getInChannelInfo();return r.Duration=Math.round(o.duration/1e3),r}async startLiveStreaming(r,o){if(!o){if(this.codec!=="h264")throw new pe(Y.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new pe(Y.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(r)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(r))throw new pe(Y.LIVE_STREAMING_TASK_CONFLICT);const s=o?zl.TRANSCODE:zl.RAW;return this._createLiveStreamingClient(s).startLiveStreamingTask(r,s)}setLiveTranscoding(r){return this._createLiveStreamingClient(zl.TRANSCODE).setTranscodingConfig(r)}async stopLiveStreaming(r){const o=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(s=>s&&s.hasUrl(r));if(!o.length)throw new pe(Y.INVALID_PARAMS,"can not find live streaming url to stop");await De.all(o.map(s=>s&&s.stopLiveStreamingTask(r)))}async startChannelMediaRelay(r){cY(r),await this._createChannelMediaRelayClient().startChannelMediaRelay(r)}async updateChannelMediaRelay(r){cY(r),await this._createChannelMediaRelayClient().updateChannelMediaRelay(r)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendAudioMetadata(r){this._p2pChannel instanceof I_&&this._p2pChannel.addAudioMetadata(r)}async sendStreamMessage(r){var o;let s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new pe(Y.INVALID_OPERATION,"can not send data stream, not joined");if((typeof r=="string"||r instanceof Uint8Array)&&(r={payload:r}),typeof r.payload=="string"){const u=new TextEncoder;r.payload=u.encode(r.payload)}let c=!1;if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Pe(o=["aes-128-gcm2","aes-256-gcm2"]).call(o,this._encryptionMode)&&(c=!0,r.payload=await async function(u,h,p){var g;const y=oa(g=Array.from(p)).call(g,(U,F)=>U+F,0),b={serverTs:0,seq:JOe++,length:p.length,checkSum:y},w=new Uint8Array(P8(y,2)),C=new ArrayBuffer(Em),A=new DataView(C);A.setUint32(0,b.serverTs),A.setUint16(4,b.seq),A.setUint16(6,b.length),A.setUint16(8,b.checkSum);const x=16-p.length%16;p=R8(p,new Uint8Array(x));const B=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:u,tagLength:G8,additionalData:w},h,p);return R8(new Uint8Array(C),new Uint8Array(B))}(this._encryptDataStreamIv,this._encryptDataStreamKey,r.payload)),new Blob([r.payload]).size>1024)throw new pe(Y.INVALID_PARAMS,c?"encrypted stream message out of range.":"stream message out of range.");return this._gateway.signal.request(tt.DATA_STREAM,{payload:dd(r.payload),syncWithAudio:r.syncWithAudio,sendTs:Date.now()-Vxe},!s)}sendMetadata(r){if(!this._joinInfo)throw new pe(Y.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([r]).size>1024)throw new pe(Y.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(tt.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:dd(r)})}async sendCustomReportMessage(r){if(Array.isArray(r)||(r=[r]),r.forEach(sIe),!this._joinInfo)throw new pe(Y.INVALID_OPERATION,"can not send custom report, not joined");await We.sendCustomReportMessage(this._joinInfo.sid,r)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(r,o){yr(o.spatialLayer,"spatialLayer",[0,1,2,3]),yr(o.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(r,o)}catch(s){throw L.error("[".concat(this._clientId,"] pick SVC layer failed"),s.toString()),s}}async setRTMConfig(r){const{apRTM:o=!1,rtmFlag:s}=r;if(Gl(o,"apRTM"),Qt(s,"rtmFlag",0),this._rtmConfig.apRTM=o,this._rtmConfig.rtmFlag=s,L.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(r)," in ").concat(this.connectionState," state")),(this.connectionState==="CONNECTED"||this.connectionState==="RECONNECTING")&&this._joinInfo)return this._joinInfo.apRTM=o,this._joinInfo.rtmFlag=s,this._gateway.setRTM2Flag(s)}_reset(){if(L.debug("[".concat(this._clientId,"] reset client")),function(r){const o=Dm.indexOf(r);o!==-1&&Dm.splice(o,1)}(this._clientId),this.store.hasStartJoinChannel=!1,this.store.isABTestSuccess=!1,this._axiosCancelSource.cancel(),this._axiosCancelSource=Qi.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo&&LY(this._joinInfo),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId&&We.removeSid(this._sessionId),this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._encryptDataStreamKey=null,this._encryptDataStreamIv=null,this._pendingPublishedUsers=[],this._users.forEach(r=>{r._audioTrack&&r._audioTrack._destroy(),r._videoTrack&&r._videoTrack._destroy(),r._dataChannels&&(r._dataChannels.forEach(o=>o._close()),r._dataChannels.length=0)}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new fi("client-publish",this._clientId),this._subscribeMutex=new fi("client-subscribe",this._clientId),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(r,o){var s;const c=r||sf();r?L.debug("[".concat(this._clientId,"] new Session ").concat(c)):L.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(c));const u=r?"":this._sessionId||"";this._sessionId=c,this.store.sessionId=c,We.addSid(c);const h={lts:new Date().getTime(),mode:this.mode,buildFormat:1,stringUid:(o==null?void 0:o.stringUid)||((s=this._joinInfo)===null||s===void 0?void 0:s.stringUid),channelProfile:this.mode==="live"?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:u,clientRole:this.role==="audience"?2:1};We.sessionInit(this._sessionId,Sa({cname:o.channel,appid:o.appId},h)),this._joinInfo&&(this._joinInfo.sid=c),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=c)}async _publishHighStream(r){if(!this._joinInfo||this._uid===void 0)throw new pe(Y.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&q("FORCE_TURN")&&!q("TURN_ENABLE_TCP")&&!q("TURN_ENABLE_UDP"))throw new pe(Y.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");L.debug("[".concat(this._clientId,"] publish high stream"));try{const s=await this._p2pChannel.publish(r,this._isDualStreamEnabled,this._lowStreamParameter);if(this.store.useP2P){const c=(await s.next()).value;if(c){try{await this._gateway.sendExtensionMessage(Wn.PUBLISH,c,!0)}catch(u){throw s.throw(u),u}await s.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const c=(await s.next()).value;if(c){var o;let u;try{u=await this._gateway.publish(this._uid,c,!0)}catch(h){if(h.code!==Y.DISCONNECT_P2P)throw s.throw(h),h}await s.next(((o=u)===null||o===void 0?void 0:o.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const u of r)u instanceof pn&&u._encoderConfig&&this._gateway.setVideoProfile(u._encoderConfig).catch(h=>{L.debug("[".concat(this._clientId,"] stop setVideoProfile, because websocket is closed"))}),!u.muted&&u.enabled||await this._p2pChannel.muteLocalTrack(u)}}catch(s){if(this._p2pChannel.reportPublishEvent(!1,s==null?void 0:s.code,r),(s==null?void 0:s.code)===Y.WS_ABORT)return;throw s}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new pe(Y.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new pe(Y.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));L.debug("[".concat(this._clientId,"] publish low stream"));const r=this._configDistribute.getLowStreamConfigDistribute();r&&r.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&r.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=r.bitrate));try{const s=await this._p2pChannel.publishLowStream(this._lowStreamParameter),c=(await s.next()).value;if(c){var o;let u;try{u=await this._gateway.publish(this._uid,c,!0)}catch(h){if(h.code!==Y.DISCONNECT_P2P)throw s.throw(h),h}s.next(((o=u)===null||o===void 0?void 0:o.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(s){if(this._p2pChannel.reportPublishEvent(!1,s==null?void 0:s.code,void 0,!0),(s==null?void 0:s.code)===Y.WS_ABORT)return;throw s}}_createLiveStreamingClient(r){const o=()=>{if(!this._joinInfo||!this._appId)return new pe(Y.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const s=(c={joinInfo:this._joinInfo,appId:this._appId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig},Xl("LiveStreaming").create(c));var c;return s.onLiveStreamError=(u,h)=>{We.reportApiInvoke(this._sessionId,{name:Yn.ON_LIVE_STREAM_ERROR,options:[u,h],tag:Nn.TRACER}).onSuccess(),this.safeEmit(_t.LIVE_STREAMING_ERROR,u,h)},s.onLiveStreamWarning=(u,h)=>{We.reportApiInvoke(this._sessionId,{name:Yn.ON_LIVE_STREAM_WARNING,options:[u,h],tag:Nn.TRACER}).onSuccess(),this.safeEmit(_t.LIVE_STREAMING_WARNING,u,h)},s.on(rD.REQUEST_WORKER_MANAGER_LIST,(u,h,p)=>{if(!this._joinInfo)return p(new pe(Y.INVALID_OPERATION,"can not find join info to get worker manager"));(async function(g,y,b,w){const C=q("UAP_AP").slice(0,q("AJAX_REQUEST_CONCURRENT")).map(A=>y.proxyServer?"https://".concat(y.proxyServer,"/ap/?url=").concat(A+"/api/v1?action=uap"):"https://".concat(A,"/api/v1?action=uap"));return await Txe(C,g,y,b,w)})(u,this._joinInfo,this._axiosCancelSource.token,rr).then(h).catch(p)}),s};return r===zl.RAW?(this._liveRawStreamingClient=this._liveRawStreamingClient||o(),this._liveRawStreamingClient):(this._liveTranscodeStreamingClient=this._liveTranscodeStreamingClient||o(),this._liveTranscodeStreamingClient)}_createChannelMediaRelayClient(){if(!this._joinInfo)return new pe(Y.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:o,sendResolutionHeight:s}=this.getLocalVideoStats(),c=(r={joinInfo:this._joinInfo,clientId:this._clientId,websocketRetryConfig:this._config.websocketRetryConfig,httpRetryConfig:this._config.httpRetryConfig,resolution:{width:o,height:s}},Xl("ChannelMediaRelay").create(r));c.on("state",u=>{u===fo.RELAY_STATE_FAILURE&&c&&c.dispose(),this.safeEmit(_t.CHANNEL_MEDIA_RELAY_STATE,u)}),c.on("event",u=>{this.safeEmit(_t.CHANNEL_MEDIA_RELAY_EVENT,u)}),this._channelMediaRelayClient=c,this._statsCollector.onStatsChanged=(u,h)=>{var p;u==="resolution"&&((p=this._channelMediaRelayClient)===null||p===void 0||p.setVideoProfile(h))}}var r;return this._channelMediaRelayClient}_handleUpdateDataChannel(r,o){const{added:s,deleted:c}=r,u=[];if(o){const h=[];this._users.forEach(p=>{p._dataChannels.forEach(g=>{s.every(y=>y.uid!==p._uintid||y.stream_id!==g.id)&&h.push({uid:p._uintid,stream_id:g.id,ordered:g.ordered,max_retrans_times:g.maxRetransmits,metadata:g.metadata})})}),h.length>0&&this._handleUpdateDataChannel({added:[],deleted:h})}Array.isArray(s)&&s.length>0&&s.forEach(h=>{const{uid:p,stream_id:g,ordered:y,max_retrans_times:b,metadata:w}=h,C=this._users.find(A=>A._uintid===p);if(!C)return void L.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"));if(L.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(p)),Pe(u).call(u,C)||u.push(C),C._uintid||(C._uintid=p),C._dataChannels.findIndex(A=>A.id===h.stream_id)===-1){const A={id:g,ordered:!!y,maxRetransmits:b,metadata:w},x=function(B){return Hz(B,!0)}(A);C._dataChannels.push(x),L.info("[".concat(this._clientId,"] remote user ").concat(C.uid," published datachannel")),o||this.safeEmit(_t.USER_PUBLISHED,C,"datachannel",A)}this._p2pChannel.hasPendingRemoteDataChannel(C,h.stream_id)&&(L.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(C.uid," after reconnect.")),this._subscribeDataChannel(C,h.stream_id).catch(A=>{L.error("[".concat(this._clientId,"] resubscribe datachannel error"),A.toString())}))}),o&&(this.safeEmit(_t.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(c)&&c.length>0&&c.forEach(h=>{const{uid:p,stream_id:g}=h,y=this._users.find(w=>w._uintid===p);if(!y)return void L.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const b=y._dataChannels.find(w=>w.id===h.stream_id);b&&(L.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(p)),this._p2pChannel.unsubscribeDataChannel(y,[b]).then(w=>{if(y._dataChannels=y._dataChannels.filter(C=>C!==b),w)return this._gateway.unsubscribeDataChannel(w,y.uid)}),L.info("[".concat(this._clientId,"] remote user ").concat(p," unpublished datachannel ,id:").concat(b.id)),this.safeEmit(_t.USER_UNPUBLISHED,y,"datachannel",b._config))})}_handleRemoveDataChannels(r){const o=this._users.find(s=>s.uid===r.uid);if(o){if(o._dataChannels!==void 0&&o._dataChannels.length>0){L.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(r.uid));const s=()=>{L.info("[".concat(this._clientId,"] remote user ").concat(o.uid," unpublished datachannel")),o._dataChannels.forEach(c=>{this.safeEmit(_t.USER_UNPUBLISHED,o,"datachannel",c._config)})};this._p2pChannel.unsubscribeDataChannel(o,o._dataChannels).then(c=>{if(c)return this._gateway.unsubscribeDataChannel(c,o.uid)}),s()}}else L.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(jr.UPDATE_GATEWAY_CONFIG,()=>{(function(){let r;try{r=window.localStorage.getItem("websdk_ng_global_parameter")}catch(o){return void L.error("Error loading sdk config",o.message)}if(r)try{const o=JSON.parse(window.atob(r)),s=Date.now();Object.keys(o).forEach(c=>{const{value:u,type:h,expires:p}=o[c];p&&p<=s||h||X1()||!Object.prototype.hasOwnProperty.call(Fw,c)||(rc[c]=u,yn[c]=u,L.debug("Update gateway parameters from config distribute",c,u))})}catch(o){L.error("Error update config from local cache",o.message)}})()}),this._gateway.on(jr.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(jr.CONNECTION_STATE_CHANGE,(r,o,s)=>{var c;if(s===Bt.FALLBACK)return;const u=()=>{this.safeEmit(_t.CONNECTION_STATE_CHANGE,r,o,s)};if(We.reportApiInvoke(this._sessionId||((c=this._gateway.joinInfo)===null||c===void 0?void 0:c.sid)||null,{name:Yn.CONNECTION_STATE_CHANGE,options:[r,o,s],tag:Nn.TRACER}).onSuccess(JSON.stringify({cur:r,prev:o,reason:s})),L.info("[".concat(this._clientId,"] signal connection state change: ").concat(o," -> ").concat(r)),r==="DISCONNECTED")return this._reset(),void u();if(r==="RECONNECTING")this._users.forEach(p=>{p._trust_in_room_=!1,p._trust_audio_enabled_state_=!1,p._trust_video_enabled_state_=!1,p._trust_audio_mute_state_=!1,p._trust_video_mute_state_=!1,p._trust_audio_stream_added_state_=!1,p._trust_video_stream_added_state_=!1,p._is_pre_created||(p._audio_pre_subscribed||(p._audioSSRC=void 0,p._audioOrtc=void 0),p._video_pre_subscribed||(p._videoSSRC=void 0,p._videoOrtc=void 0,p._rtxSsrcId=void 0),p._cname=void 0)}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(r==="CONNECTED"){var h;this._streamFallbackTypeCacheMap.forEach((p,g)=>{this._gateway.setStreamFallbackOption(g,p).catch(y=>{L.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),y)})}),this._remoteStreamTypeCacheMap.forEach((p,g)=>{this._gateway.setRemoteVideoStreamType(g,p).catch(y=>{L.warning("[".concat(this._clientId,"] auto set remote stream type failed"),y)})}),this._remoteDefaultVideoStreamType!==void 0&&((h=this._joinInfo)===null||h===void 0?void 0:h.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{L.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(p=>{L.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(p))}),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(p=>!p._trust_in_room_).forEach(p=>{L.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(p.uid)),this._handleUserOffline({uid:p.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(p=>{p._trust_audio_mute_state_||(L.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(p.uid)),this._handleMuteStream(p.uid,je.AUDIO,!1)),p._trust_video_mute_state_||(L.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(p.uid)),this._handleMuteStream(p.uid,je.VIDEO,!1)),p._trust_audio_enabled_state_||(L.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(p.uid)),this._handleSetStreamLocalEnable("audio",p.uid,!0)),p._trust_video_enabled_state_||(L.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(p.uid)),this._handleSetStreamLocalEnable("video",p.uid,!0)),p._trust_video_stream_added_state_||(L.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(p.uid)),this._handleResetAddStream(p,"video")),p._trust_audio_stream_added_state_||(L.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(p.uid)),this._handleResetAddStream(p,"audio")),p._video_added_||p._audio_added_||(L.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(p.uid)),this._handleRemoveStream({uid:p.uid,uint_id:p._uintid}))}))},1e3))}u()}),this._gateway.on(jr.REQUEST_NEW_GATEWAY_LIST,async(r,o)=>{if(!this._joinInfo)return o(new pe(Y.UNEXPECTED_ERROR,"can not recover, no join info"));try{let s;const c=await DY(Sa(Sa({},this._joinInfo),{},{uid:this._joinInfo.uid,stringUid:void 0}));c?(s=c.ap,MY(c),this._joinInfo.preload=!0):(s=await ED(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||rr,this.store),this._joinInfo.preload=!1),this._joinInfo&&(this._joinInfo.apResponse=s.gatewayInfo.res,this._joinInfo.gatewayAddrs=s.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=s.gatewayInfo.uni_lbs_ip);const u=[];s.gatewayInfo.gatewayAddrs.forEach(h=>{let{address:p}=h;const[g,y]=p.split(":");this._joinInfo&&this._joinInfo.proxyServer?u.push({proxy:this._joinInfo.proxyServer,host:g,port:y}):u.push({host:g,port:y})}),r(u)}catch(s){o(s)}}),this._gateway.on(jr.NETWORK_QUALITY,r=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(_t.NETWORK_QUALITY,r)}),this._gateway.on(jr.STREAM_TYPE_CHANGE,(r,o)=>{this.safeEmit(_t.STREAM_TYPE_CHANGED,r,o),We.reportApiInvoke(this._sessionId,{name:Yn.STREAM_TYPE_CHANGE,options:[r,o],tag:Nn.TRACER}).onSuccess(JSON.stringify({uid:r,streamType:o}))}),this._gateway.on(jr.IS_P2P_DISCONNECTED,r=>{this._p2pChannel.isP2PDisconnected()?r(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?r(!1):r(!0)}),this._gateway.on(jr.REQUEST_P2P_CONNECTION_PARAMS,async(r,o,s)=>{try{let c=await this._p2pChannel.getEstablishParams();q("ENABLE_PREALLOC_PC")&&c||(c=await this._p2pChannel.startP2PConnection(r)),o(c)}catch(c){s(c)}}),this._gateway.on(jr.JOIN_RESPONSE,(r,o)=>{if(this.store.useP2P)return;let s;r.attributes?s=r.attributes.userAttributes.preSubSsrcs:L.debug("no attributes in joinResponse");const c=Dz(r.ortc,o,s);this._p2pChannel.connect(c)}),this._gateway.on(jr.PRE_CONNECT_PC,async r=>{const{candidates:o,fingerprint:s}=r;if(this._joinInfo&&o.length>0&&!this._p2pChannel.isPlanB){var c;await this._p2pChannel.startP2PConnection({turnServer:this._joinInfo.turnServer});const{cert:u,cid:h}=this._joinInfo.apResponse;await this._p2pChannel.connect({iceParameters:{iceUfrag:"".concat(h,"_").concat(u),icePwd:"".concat(h,"_").concat(u)},dtlsParameters:{fingerprints:[{hashFunction:"sha-256",fingerprint:(c=q("FINGERPRINT"))!==null&&c!==void 0?c:s}]},candidates:o,rtpCapabilities:{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},setup:"active",cname:"o/i14u9pJrxRKAsu",preallocation:!0})}})}_handleGatewaySignalEvents(){this._gateway.signal.on(bt.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(bt.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(bt.ON_ADD_AUDIO_STREAM,r=>this._handleAddAudioOrVideoStream("audio",r.uid,r.ssrcId,r.cname,r.uint_id,r.ortc)),this._gateway.signal.on(bt.ON_ADD_VIDEO_STREAM,r=>this._handleAddAudioOrVideoStream("video",r.uid,r.ssrcId,r.cname,r.uint_id,r.ortc,r.rtxSsrcId)),this._gateway.signal.on(bt.ON_REMOTE_DATASTREAM_UPDATE,r=>{this._handleUpdateDataChannel(r)}),this._gateway.signal.on(bt.ON_REMOTE_FULL_DATASTREAM_INFO,r=>{this._handleUpdateDataChannel({added:r.datastreams||[],deleted:[]},!0)}),this._gateway.signal.on(bt.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(bt.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(bt.MUTE_AUDIO,r=>this._handleMuteStream(r.uid,je.AUDIO,!0)),this._gateway.signal.on(bt.UNMUTE_AUDIO,r=>this._handleMuteStream(r.uid,je.AUDIO,!1)),this._gateway.signal.on(bt.MUTE_VIDEO,r=>this._handleMuteStream(r.uid,je.VIDEO,!0)),this._gateway.signal.on(bt.UNMUTE_VIDEO,r=>this._handleMuteStream(r.uid,je.VIDEO,!1)),this._gateway.signal.on(bt.RECEIVE_METADATA,r=>{const o=of(r.metadata);this.safeEmit(_t.RECEIVE_METADATA,r.uid,o)}),this._gateway.signal.on(bt.ON_DATA_STREAM,async r=>{var o;if(!r)return;let s=of(r.payload);if(this._encryptDataStream&&this._encryptDataStreamIv&&this._encryptDataStreamKey&&window.crypto.subtle&&Pe(o=["aes-128-gcm2","aes-256-gcm2"]).call(o,this._encryptionMode)){if(r.payload.length<Em)throw new pe(Y.UNEXPECTED_RESPONSE,"payload length ".concat(r.payload.length," is less than header length ").concat(Em));s=await async function(h,p,g){const y=g.subarray(0,Em),b=y.slice(8,Em),w=(b[0]<<8)+b[1],C=(y[6]<<8)+y[7],A=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:h,tagLength:G8,additionalData:new Uint8Array(P8(w,2))},p,g.subarray(Em));return new Uint8Array(A).subarray(0,C)}(this._encryptDataStreamIv,this._encryptDataStreamKey,s)}let c=0;if(r.ordered||r.syncWithAudio){const u=this._p2pChannel.getStats(),h=this.remoteUsers.find(g=>g.uid===r.uid),p=u==null?void 0:u.audioRecv.find(g=>g.ssrc===(h==null?void 0:h._audioSSRC));c=p==null?void 0:p.jitterBufferMs}(c==null||Number.isNaN(c))&&(c=0),Bxe(Sa(Sa({},r),{},{payload:s}),c,{id:this._clientId,onStreamMessage:typeof this.onStreamMessage=="function"?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})}),this._gateway.signal.on(bt.ON_CRYPT_ERROR,()=>{ud(()=>{L.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(_t.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(bt.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(bt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{L.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,Bt.TOKEN_EXPIRE),this.safeEmit(_t.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(bt.ON_STREAM_FALLBACK_UPDATE,r=>{L.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(r.stream_id,", attr: ").concat(r.stream_type)),this.safeEmit(_t.STREAM_FALLBACK,r.stream_id,r.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(bt.ON_PUBLISH_STREAM,r=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:r.proxy})),L.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(r))))}),this._gateway.signal.on(bt.ENABLE_LOCAL_VIDEO,r=>{this._handleSetStreamLocalEnable("video",r.uid,!0)}),this._gateway.signal.on(bt.DISABLE_LOCAL_VIDEO,r=>{this._handleSetStreamLocalEnable("video",r.uid,!1)}),this._gateway.signal.on(it.REQUEST_TIMEOUT,(r,o)=>{if(this._joinInfo)switch(r){case tt.PUBLISH:{if(!o)return;const u=o.ortc;if(u){var s,c;const h=u.some(y=>{let{stream_type:b}=y;return b===Ht.Audio}),p=u.some(y=>{let{stream_type:b}=y;return b!==Ht.Audio}),g=u.some(y=>{let{stream_type:b}=y;return b===Ht.Screen||b===Ht.ScreenLow});o.state==="offer"&&We.publish(this._joinInfo.sid,{eventElapse:gi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:Y.TIMEOUT,audio:h,video:p,p2pid:o.p2p_id,publishRequestid:this.store.pubId,screenshare:g,audioName:h?(s=u.find(y=>{let{stream_type:b}=y;return b===Ht.Audio}))===null||s===void 0||(s=s.ssrcs[0])===null||s===void 0?void 0:s.ssrcId.toString():void 0,videoName:p?(c=u.find(y=>{let{stream_type:b}=y;return b!==Ht.Audio}))===null||c===void 0||(c=c.ssrcs[0])===null||c===void 0?void 0:c.ssrcId.toString():void 0})}break}case tt.SUBSCRIBE:o&&We.subscribe(this._joinInfo.sid,{succ:!1,ec:Y.TIMEOUT,audio:o.stream_type===je.AUDIO,video:o.stream_type===je.VIDEO,peerid:o.stream_id,subscribeRequestid:o.ssrcId,p2pid:this.store.p2pId,eventElapse:gi.measureFromSubscribeStart(this.store.clientId,o.ssrcId),preSsrc:this._p2pChannel.isPreSubScribe(o.ssrcId)})}}),this._gateway.signal.on(bt.ON_P2P_OK,r=>{this.uid,this._uid}),this._gateway.signal.on(bt.ON_PUBLISHED_USER_LIST,r=>{if(r==null||!r.users)return;q("BLOCK_LOCAL_CLIENT")&&(r.users=r.users.filter(c=>!pf(c.string_id||c.stream_id,this.channelName)));const o=[],s=[];for(const c of r.users){let u=this._users.find(w=>w._uintid===c.stream_id);u?u._trust_in_room_=!0:(u=new _d(c.string_id||c.stream_id,c.stream_id),this._users.push(u),this.getListeners(_t.PUBLISHED_USER_LIST).length===0&&(L.debug("[".concat(this._clientId,"] user online"),c.stream_id),this.safeEmit(_t.USER_JOINED,u)));const h=Or.Audio&c.stream_type,p=(Or.Video|Or.LwoVideo)&c.stream_type,g=(65280&c.stream_type)!=0,y=h&&u.hasAudio,b=p&&u.hasVideo;p&&(u._trust_video_stream_added_state_=!0,u._video_added_=!0,u._videoSSRC=c.video_ssrc,u._rtxSsrcId=c.video_rtx),h&&(u._trust_audio_stream_added_state_=!0,u._audio_added_=!0,u._audioSSRC=c.audio_ssrc),h&&!y&&this.getListeners(_t.PUBLISHED_USER_LIST).length===0&&(L.info("[".concat(this._clientId,"] remote user ").concat(u.uid," published audio")),this.safeEmit(_t.USER_PUBLISHED,u,"audio")),p&&!b&&this.getListeners(_t.PUBLISHED_USER_LIST).length===0&&(L.info("[".concat(this._clientId,"] remote user ").concat(u.uid," published video")),this.safeEmit(_t.USER_PUBLISHED,u,"video")),(h&&!y||p&&!b||g)&&o.push(u),p&&this._p2pChannel.hasPendingRemoteMedia(u,"video")&&s.push({user:u,mediaType:"video"}),h&&this._p2pChannel.hasPendingRemoteMedia(u,"audio")&&s.push({user:u,mediaType:"audio"})}s.length>0&&(L.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(s.map(c=>"user: ".concat(c.user.uid,", mediaType: ").concat(c.mediaType)).join("; ")," ")),this.massSubscribe(s).catch(c=>{L.error("[".concat(this._clientId,"] mass resubscribe error"),c.toString())})),this.getListeners(_t.PUBLISHED_USER_LIST).length>0?q("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=o:(L.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(o.map(c=>c.uid).join(", "))),this.safeEmit(_t.PUBLISHED_USER_LIST,o)):L.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(o.map(c=>c.uid).join(", ")))}),this._gateway.signal.on(bt.ON_RTP_CAPABILITY_CHANGE,r=>{const{video_codec:o}=r;this._p2pChannel instanceof I_&&this._p2pChannel.updateRemoteRTPCapabilities(o.map(s=>s.toLowerCase()).filter(s=>{var c;return Pe(c=Object.keys(Bw)).call(c,s)}))})}_handleP2PEvents(){this._gateway.signal.on(bt.ON_USER_OFFLINE,()=>{this._p2pChannel.disconnectForReconnect()}),this._gateway.signal.on(Wn.PUBLISH,(r,o,s)=>{const{uid:c}=r;r.forEach(u=>{const{kind:h,ssrcs:p,mid:g,isMuted:y}=u;this._handleP2PAddAudioOrVideoStream(h,c,p[0].ssrcId,g);const b=this._users.find(w=>w.uid===c);return b&&this.store.useP2P?this._p2pChannel.mockSubscribe(b,h,p[0].ssrcId,g).then(()=>{o()}).catch(s):o(),this._handleMuteStream(c,h,!!y)})}),this._gateway.signal.on(Wn.CALL,async(r,o,s)=>{if(this.store.useP2P)try{var c;o(await this._p2pChannel.startP2P({turnServer:(c=this._joinInfo)===null||c===void 0?void 0:c.turnServer},r))}catch(u){s(u)}}),this._gateway.signal.on(it.P2P_CONNECTION,async r=>{this.store.useP2P&&(await this._p2pChannel).p2pConnect(r)}),this._gateway.signal.on(Wn.UNPUBLISH,async(r,o,s)=>{if(this.store.useP2P){const{unpubMsg:c,uid:u}=r,h=this._users.find(p=>p.uid===u);if(!h)return L.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(u)),void o();try{c.forEach(async p=>{let{stream_type:g}=p;const y=g===Ht.Audio?je.AUDIO:je.VIDEO;await this._p2pChannel.unsubscribe(h,y),this._handleMuteStream(u,y,!0)}),o()}catch(p){s(p)}}}),this._gateway.signal.on(Wn.CONTROL,async(r,o)=>{const{action:s}=r;switch(s){case pd.MUTE_LOCAL_VIDEO:this._handleMuteStream(o,je.VIDEO,!0);break;case pd.MUTE_LOCAL_AUDIO:this._handleMuteStream(o,je.AUDIO,!0);break;case pd.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",o),this._handleMuteStream(o,je.VIDEO,!1);break;case pd.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",o),this._handleMuteStream(o,je.AUDIO,!1)}}),this._gateway.signal.on(Wn.RESTART_ICE,async(r,o,s)=>{if(this.store.useP2P)try{const{direction:c,iceParameter:u}=r;c!==$i.SEND_ONLY||u?o(await this._p2pChannel.restartICE(c,u)):(this._p2pChannel.handleDisconnect(c),o())}catch(c){s(c)}}),this._gateway.signal.on(Wn.CANDIDATE,r=>{if(this.store.useP2P){const{candidate:o,direction:s}=r;this._p2pChannel.addRemoteCandidate(o,s)}}),this._p2pChannel.on(Ye.RequestP2PRestartICE,async(r,o,s)=>{try{const{direction:c}=r;o(await this._gateway.sendExtensionMessage(Wn.RESTART_ICE,r,c===$i.SEND_ONLY))}catch(c){s(c)}}),this._p2pChannel.on(Ye.LocalCandidate,r=>{this._gateway.sendExtensionMessage(Wn.CANDIDATE,JSON.stringify(r),!0)}),this._p2pChannel.on(Ye.RequestP2PMuteLocal,async(r,o,s)=>{try{await this._gateway.sendExtensionMessage(Wn.CONTROL,r,!0),o()}catch(c){s(c)}}),this._p2pChannel.on(Ye.RequestP2PUnmuteRemote,async(r,o,s)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(r,this._joinInfo.stringUid||this._joinInfo.uid),o()}catch(c){c.code===Y.DISCONNECT_P2P?o():s(c)}else o()}),this._p2pChannel.on(Ye.RequestP2PMuteRemote,async(r,o,s)=>{if(this._joinInfo)try{await this._gateway.muteRemote(r,this._joinInfo.stringUid||this._joinInfo.uid),o()}catch(c){c.code===Y.DISCONNECT_P2P?o():s(c)}else o()}),this._p2pChannel.on(Ye.StateChange,(r,o)=>{o===$t.Connected&&this._p2pChannel.republish()})}_handleP2PChannelEvents(){this._p2pChannel.on(Ye.PeerConnectionStateChange,r=>{const o=this._peerConnectionState;r!==o&&(this.safeEmit(_t.PEERCONNECTION_STATE_CHANGE,r,o),this._peerConnectionState=r)}),this._p2pChannel.on(Ye.RequestMuteLocal,async(r,o,s)=>{if(this._joinInfo)try{await this._gateway.muteLocal(r,this._joinInfo.stringUid||this._joinInfo.uid),o()}catch(c){c.code===Y.DISCONNECT_P2P?o():s(c)}else o()}),this._p2pChannel.on(Ye.RequestUnmuteLocal,async(r,o,s)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(r,this._joinInfo.stringUid||this._joinInfo.uid),o()}catch(c){c.code===Y.DISCONNECT_P2P?o():s(c)}else o()}),this._p2pChannel.on(Ye.RequestRePublish,(r,o,s)=>{this.publish(r,!1).then(o).catch(s)}),this._p2pChannel.on(Ye.RequestRePublishDataChannel,(r,o,s)=>{De.all(r.map(async c=>{const u=await this._p2pChannel.publishDataChannel([c]);try{u.forEach(h=>{this._uid&&this._gateway.publishDataChannel(this._uid,h,!0)})}catch(h){if(h.code!==Y.DISCONNECT_P2P)throw h}})).then(o).catch(s)}),this._p2pChannel.on(Ye.RequestReSubscribe,async(r,o,s)=>{try{for(const{user:c,kind:u}of r)u===je.VIDEO?await this.subscribe(c,"video"):await this.subscribe(c,"audio");o()}catch(c){s(c)}}),this._p2pChannel.on(Ye.RequestUpload,(r,o)=>{this._gateway.upload(r,o)}),this._p2pChannel.on(Ye.RequestUploadStats,r=>{this._gateway.uploadWRTCStats(r)}),this._p2pChannel.on(Ye.MediaReconnectStart,r=>{this.safeEmit(_t.MEDIA_RECONNECT_START,r)}),this._p2pChannel.on(Ye.MediaReconnectEnd,r=>{this.safeEmit(_t.MEDIA_RECONNECT_END,r)}),this._p2pChannel.on(Ye.NeedSignalRTT,r=>{r(this._gateway.getSignalRTT())}),this._p2pChannel.on(Ye.RequestRestartICE,async r=>{if(this.store.useP2P)return;const o=await this._p2pChannel.restartICE(r),s=await o.next();if(s.done)return;const c=s.value;let u;try{u=await this._gateway.restartICE({iceParameters:c})}catch(p){return void o.throw(p)}const{iceParameters:h}=function(p){const g=p.iceParameters;return{iceParameters:{iceUfrag:g.iceUfrag,icePwd:g.icePwd}}}(u);await o.next({remoteIceParameters:h})}),this._p2pChannel.on(Ye.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(Ye.RequestReconnectPC,async()=>{var r;const{iceParameters:o,dtlsParameters:s,rtpCapabilities:c}=await this._p2pChannel.startP2PConnection({turnServer:(r=this._joinInfo)===null||r===void 0?void 0:r.turnServer}),{gatewayEstablishParams:u,gatewayAddress:h}=await this._gateway.reconnectPC({iceParameters:o,dtlsParameters:s,rtpCapabilities:c}),p=Dz(u,h);await this._p2pChannel.connect(p),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(Ye.RequestUnpublishForReconnectPC,async(r,o,s)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(r,this._uid),o()):s()}),this._p2pChannel.on(Ye.P2PLost,()=>{this.safeEmit(_t.P2P_LOST,this.store.uid)}),this._p2pChannel.on(Ye.UpdateVideoEncoder,r=>{r._encoderConfig&&this._gateway.setVideoProfile(r._encoderConfig)}),this._p2pChannel.on(Ye.ConnectionTypeChange,r=>{this.safeEmit(_t.IS_USING_CLOUD_PROXY,r)}),this._p2pChannel.on(Ye.RequestLowStreamParameter,r=>{r(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(Ye.QueryClientConnectionState,r=>{r(this.connectionState)}),this._p2pChannel.on(Ye.AudioMetadata,r=>{this.safeEmit(_t.AUDIO_METADATA,r)})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(r){if(!this._joinInfo||this.connectionState!=="CONNECTED")throw new pe(Y.INVALID_OPERATION,"[".concat(this._clientId,"] can not create content inspect, please join channel first"));if(this._inspect)throw new pe(Y.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));try{const s=(o={config:r},Xl("ContentInspect").create(o));this._inspect=s,this.handleVideoInspectEvents(s);const{appId:c,cname:u,sid:h,token:p,uid:g,cid:y,vid:b}=this._joinInfo;await s.init({appId:c,areaCode:"",cname:u,sid:h,token:p,uid:g,cid:y,vid:b?Number(b):0},rr)}catch(s){throw Array.isArray(s)?s[0]:s}var o}handleVideoInspectEvents(r){r.on(Ur.CONNECTION_STATE_CHANGE,(o,s)=>{if(this.safeEmit(_t.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,o,s),s===va.CONNECTED){if(this.connectionState!=="CONNECTED")return void this.safeEmit(_t.CONTENT_INSPECT_ERROR,new pe(Y.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));r.inspectImage()}}),r.on(Ur.INSPECT_RESULT,(o,s)=>{var c;if((s==null?void 0:s.code)===Y.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return L.debug("Stop inspect content because that has left channel"),this==null||(c=this._inspect)===null||c===void 0||c.close(),void(this._inspect=void 0);this.safeEmit(_t.CONTENT_INSPECT_RESULT,o,s)}),r.on(Ur.CLIENT_LOCAL_VIDEO_TRACK,o=>{o(this.localTracks.filter(s=>s.trackMediaType==="video")[0])})}async disableContentInspect(){if(!this._inspect)throw new pe(Y.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(r){throw Array.isArray(r)?r[0]:r}}async setImageModeration(r,o){if(Gl(r,"enabled"),r){if(!o)throw new pe(Y.INVALID_PARAMS,"config is required");if(qY(o),!this._joinInfo)throw new pe(Y.INVALID_OPERATION,"can not create image moderation, please join channel first");try{if(this._moderation)this._moderation.updateConfig(o);else{const c=(s={config:o},Xl("ImageModeration").create(s));this._moderation=c,this.handleImageModerationEvents(c);const{appId:u,cname:h,sid:p,token:g,uid:y,cid:b,vid:w}=this._joinInfo;await c.init({appId:u,areaCode:"",cname:h,sid:p,token:g,uid:y,cid:b,vid:w?Number(w):0},rr)}}catch(c){throw Array.isArray(c)?c[0]:c}}else{var s;if(!this._moderation)throw new pe(Y.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(c){throw Array.isArray(c)?c[0]:c}}}handleImageModerationEvents(r){r.on(sc.CONNECTION_STATE_CHANGE,(o,s)=>{if(this.safeEmit(_t.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,o,s),o===Ds.CONNECTED){if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new pe(Y.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");r.inspectImage()}}),r.on(sc.CLIENT_LOCAL_VIDEO_TRACK,o=>{o(this.localTracks.filter(s=>s.trackMediaType==="video")[0])})}setP2PTransport(r){if(function(o){yr(o,"transport",["default","auto","relay","sd-rtn"])}(r),this.mode!=="p2p")throw new pe(Y.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=r,L.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(r))}getJoinChannelServiceRecords(){return L.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(r){Gl(r,"enabled"),Yt("ENABLE_PUBLISH_AUDIO_FILTER",r),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(r)}_handleResetAddStream(r,o){switch(o){case"audio":r._audio_added_=!1,r._trust_audio_stream_added_state_=!0;break;case"video":r._video_added_=!1,r._trust_video_stream_added_state_=!0}}},$e(ke.prototype,"leave",[XY],Object.getOwnPropertyDescriptor(ke.prototype,"leave"),ke.prototype),$e(ke.prototype,"publish",[JY],Object.getOwnPropertyDescriptor(ke.prototype,"publish"),ke.prototype),$e(ke.prototype,"unpublish",[QY],Object.getOwnPropertyDescriptor(ke.prototype,"unpublish"),ke.prototype),$e(ke.prototype,"subscribe",[ZY],Object.getOwnPropertyDescriptor(ke.prototype,"subscribe"),ke.prototype),$e(ke.prototype,"presubscribe",[eq],Object.getOwnPropertyDescriptor(ke.prototype,"presubscribe"),ke.prototype),$e(ke.prototype,"massSubscribe",[tq],Object.getOwnPropertyDescriptor(ke.prototype,"massSubscribe"),ke.prototype),$e(ke.prototype,"unsubscribe",[nq],Object.getOwnPropertyDescriptor(ke.prototype,"unsubscribe"),ke.prototype),$e(ke.prototype,"massUnsubscribe",[rq],Object.getOwnPropertyDescriptor(ke.prototype,"massUnsubscribe"),ke.prototype),$e(ke.prototype,"setLowStreamParameter",[iq],Object.getOwnPropertyDescriptor(ke.prototype,"setLowStreamParameter"),ke.prototype),$e(ke.prototype,"enableDualStream",[oq],Object.getOwnPropertyDescriptor(ke.prototype,"enableDualStream"),ke.prototype),$e(ke.prototype,"disableDualStream",[sq],Object.getOwnPropertyDescriptor(ke.prototype,"disableDualStream"),ke.prototype),$e(ke.prototype,"setClientRole",[aq],Object.getOwnPropertyDescriptor(ke.prototype,"setClientRole"),ke.prototype),$e(ke.prototype,"_setClientRoleOptions",[cq],Object.getOwnPropertyDescriptor(ke.prototype,"_setClientRoleOptions"),ke.prototype),$e(ke.prototype,"setProxyServer",[lq],Object.getOwnPropertyDescriptor(ke.prototype,"setProxyServer"),ke.prototype),$e(ke.prototype,"setTurnServer",[uq],Object.getOwnPropertyDescriptor(ke.prototype,"setTurnServer"),ke.prototype),$e(ke.prototype,"setLicense",[dq],Object.getOwnPropertyDescriptor(ke.prototype,"setLicense"),ke.prototype),$e(ke.prototype,"startProxyServer",[hq],Object.getOwnPropertyDescriptor(ke.prototype,"startProxyServer"),ke.prototype),$e(ke.prototype,"stopProxyServer",[fq],Object.getOwnPropertyDescriptor(ke.prototype,"stopProxyServer"),ke.prototype),$e(ke.prototype,"setLocalAccessPointsV2",[pq],Object.getOwnPropertyDescriptor(ke.prototype,"setLocalAccessPointsV2"),ke.prototype),$e(ke.prototype,"setLocalAccessPoints",[mq],Object.getOwnPropertyDescriptor(ke.prototype,"setLocalAccessPoints"),ke.prototype),$e(ke.prototype,"setRemoteDefaultVideoStreamType",[gq],Object.getOwnPropertyDescriptor(ke.prototype,"setRemoteDefaultVideoStreamType"),ke.prototype),$e(ke.prototype,"setRemoteVideoStreamType",[vq],Object.getOwnPropertyDescriptor(ke.prototype,"setRemoteVideoStreamType"),ke.prototype),$e(ke.prototype,"setStreamFallbackOption",[yq],Object.getOwnPropertyDescriptor(ke.prototype,"setStreamFallbackOption"),ke.prototype),$e(ke.prototype,"setEncryptionConfig",[_q],Object.getOwnPropertyDescriptor(ke.prototype,"setEncryptionConfig"),ke.prototype),$e(ke.prototype,"renewToken",[Eq],Object.getOwnPropertyDescriptor(ke.prototype,"renewToken"),ke.prototype),$e(ke.prototype,"enableAudioVolumeIndicator",[bq],Object.getOwnPropertyDescriptor(ke.prototype,"enableAudioVolumeIndicator"),ke.prototype),$e(ke.prototype,"startLiveStreaming",[Sq],Object.getOwnPropertyDescriptor(ke.prototype,"startLiveStreaming"),ke.prototype),$e(ke.prototype,"setLiveTranscoding",[wq],Object.getOwnPropertyDescriptor(ke.prototype,"setLiveTranscoding"),ke.prototype),$e(ke.prototype,"stopLiveStreaming",[Tq],Object.getOwnPropertyDescriptor(ke.prototype,"stopLiveStreaming"),ke.prototype),$e(ke.prototype,"startChannelMediaRelay",[Cq],Object.getOwnPropertyDescriptor(ke.prototype,"startChannelMediaRelay"),ke.prototype),$e(ke.prototype,"updateChannelMediaRelay",[Rq],Object.getOwnPropertyDescriptor(ke.prototype,"updateChannelMediaRelay"),ke.prototype),$e(ke.prototype,"stopChannelMediaRelay",[Aq],Object.getOwnPropertyDescriptor(ke.prototype,"stopChannelMediaRelay"),ke.prototype),$e(ke.prototype,"sendCustomReportMessage",[Oq],Object.getOwnPropertyDescriptor(ke.prototype,"sendCustomReportMessage"),ke.prototype),$e(ke.prototype,"pickSVCLayer",[Iq],Object.getOwnPropertyDescriptor(ke.prototype,"pickSVCLayer"),ke.prototype),$e(ke.prototype,"setRTMConfig",[xq],Object.getOwnPropertyDescriptor(ke.prototype,"setRTMConfig"),ke.prototype),$e(ke.prototype,"enableContentInspect",[Pq],Object.getOwnPropertyDescriptor(ke.prototype,"enableContentInspect"),ke.prototype),$e(ke.prototype,"disableContentInspect",[Nq],Object.getOwnPropertyDescriptor(ke.prototype,"disableContentInspect"),ke.prototype),$e(ke.prototype,"setImageModeration",[Dq],Object.getOwnPropertyDescriptor(ke.prototype,"setImageModeration"),ke.prototype),$e(ke.prototype,"setP2PTransport",[kq],Object.getOwnPropertyDescriptor(ke.prototype,"setP2PTransport"),ke.prototype),$e(ke.prototype,"getJoinChannelServiceRecords",[Lq],Object.getOwnPropertyDescriptor(ke.prototype,"getJoinChannelServiceRecords"),ke.prototype),$e(ke.prototype,"setPublishAudioFilterEnabled",[Mq],Object.getOwnPropertyDescriptor(ke.prototype,"setPublishAudioFilterEnabled"),ke.prototype),ke);class N_{constructor(o,s){G(this,"id",0),G(this,"element",void 0),G(this,"peerPair",void 0),G(this,"context",void 0),G(this,"audioPlayerElement",void 0),G(this,"audioTrack",void 0),N_.count+=1,this.id=N_.count,this.element=o,this.context=s}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=o=>{const s=document.createElement("audio");s.srcObject=new MediaStream([o.track]),s.play(),this.audioPlayerElement=s}}async switchSdp(){if(!this.peerPair)return;const o=async(c,u)=>{const h=u==="offer"?await c.createOffer():await c.createAnswer();return await c.setLocalDescription(h),c.iceGatheringState==="complete"?c.localDescription:new De(p=>{c.onicegatheringstatechange=()=>{c.iceGatheringState==="complete"&&p(c.localDescription)}})},s=async(c,u)=>await c.setRemoteDescription(u);try{const c=await o(this.peerPair[0],"offer");await s(this.peerPair[1],c);const u=await o(this.peerPair[1],"answer");await s(this.peerPair[0],u)}catch(c){throw new pe(Y.LOCAL_AEC_ERROR,c.toString()).print()}}async getTracksFromMediaElement(o){if(this.audioTrack)return this.audioTrack;let s;try{o instanceof HTMLVideoElement&&(o.captureStream?o.captureStream():o.mozCaptureStream()),s=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(o).connect(s)}catch(u){throw new pe(Y.LOCAL_AEC_ERROR,u.toString()).print()}if(!s)throw new pe(Y.LOCAL_AEC_ERROR,"no dest node when local aec").print();const c=s.stream.getAudioTracks()[0];return this.audioTrack=c,c}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const o=this.element,s=await this.getTracksFromMediaElement(o);this.peerPair&&this.peerPair[0].addTrack(s),await this.switchSdp()}close(){L.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(o=>{o.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var Uq,PT;G(N_,"count",0);const iPe=window.AudioContext||window.webkitAudioContext,oPe=new(Uq=Qe({report:We}),$e((PT=class{constructor(){G(this,"units",[]),G(this,"context",void 0)}processExternalMediaAEC(r){if(!this._doesEnvironmentNeedAEC())return L.debug("the system does not need to process local aec"),-1;this.context||(this.context=new iPe);let o=this.units.find(s=>s&&s.getElement()===r);return o||(o=new N_(r,this.context),this.units.push(o)),o.startEchoCancellation(),L.debug("start processing local audio echo cancellation, id is",o.id),o.id}_doesEnvironmentNeedAEC(){return It().name!==Mt.SAFARI}}).prototype,"processExternalMediaAEC",[Uq],Object.getOwnPropertyDescriptor(PT.prototype,"processExternalMediaAEC"),PT.prototype),PT);function Vq(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function Fq(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?Vq(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):Vq(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}const MD=window||document;function Bq(r){let o=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!MD)return;const s=ir._cspEventHandlerPointer;if(s&&o)return void console.error(s,o);const c=u=>{if(!(u&&u.blockedURI&&(ir.onSecurityPolicyViolation||ir.getListeners(Qc.SECURITY_POLICY_VIOLATION).length>0)))return;const h=u.blockedURI;q("CSP_DETECTED_HOSTNAME_LIST").some(p=>Pe(h).call(h,p))&&(ir.onSecurityPolicyViolation&&typeof ir.onSecurityPolicyViolation=="function"&&ir.onSecurityPolicyViolation(u),ir.getListeners(Qc.SECURITY_POLICY_VIOLATION).length>0&&ir.safeEmit(Qc.SECURITY_POLICY_VIOLATION,u))};s&&MD.removeEventListener("securitypolicyviolation",s),(o||r&&typeof r=="function"||ir.getListeners(Qc.SECURITY_POLICY_VIOLATION).length>0)&&MD.addEventListener("securitypolicyviolation",c),ir._cspEventHandlerPointer=c}var sPe=T,aPe=CG,$q=RegExp.prototype,cPe=function(r){return r===$q||sPe($q,r)?aPe(r):r.flags},Pi=a(cPe);function zm(r){let o=r.length;for(;--o>=0;)r[o]=0}const jD=256,Wq=286,D_=30,k_=15,UD=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),NT=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),lPe=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Gq=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ql=new Array(576);zm(Ql);const L_=new Array(60);zm(L_);const M_=new Array(512);zm(M_);const j_=new Array(256);zm(j_);const VD=new Array(29);zm(VD);const DT=new Array(D_);function FD(r,o,s,c,u){this.static_tree=r,this.extra_bits=o,this.extra_base=s,this.elems=c,this.max_length=u,this.has_stree=r&&r.length}let Hq,Kq,zq;function BD(r,o){this.dyn_tree=r,this.max_code=0,this.stat_desc=o}zm(DT);const Yq=r=>r<256?M_[r]:M_[256+(r>>>7)],U_=(r,o)=>{r.pending_buf[r.pending++]=255&o,r.pending_buf[r.pending++]=o>>>8&255},ls=(r,o,s)=>{r.bi_valid>16-s?(r.bi_buf|=o<<r.bi_valid&65535,U_(r,r.bi_buf),r.bi_buf=o>>16-r.bi_valid,r.bi_valid+=s-16):(r.bi_buf|=o<<r.bi_valid&65535,r.bi_valid+=s)},rl=(r,o,s)=>{ls(r,s[2*o],s[2*o+1])},qq=(r,o)=>{let s=0;do s|=1&r,r>>>=1,s<<=1;while(--o>0);return s>>>1},Xq=(r,o,s)=>{const c=new Array(16);let u,h,p=0;for(u=1;u<=k_;u++)p=p+s[u-1]<<1,c[u]=p;for(h=0;h<=o;h++){let g=r[2*h+1];g!==0&&(r[2*h]=qq(c[g]++,g))}},Jq=r=>{let o;for(o=0;o<Wq;o++)r.dyn_ltree[2*o]=0;for(o=0;o<D_;o++)r.dyn_dtree[2*o]=0;for(o=0;o<19;o++)r.bl_tree[2*o]=0;r.dyn_ltree[512]=1,r.opt_len=r.static_len=0,r.sym_next=r.matches=0},Qq=r=>{r.bi_valid>8?U_(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0},Zq=(r,o,s,c)=>{const u=2*o,h=2*s;return r[u]<r[h]||r[u]===r[h]&&c[o]<=c[s]},$D=(r,o,s)=>{const c=r.heap[s];let u=s<<1;for(;u<=r.heap_len&&(u<r.heap_len&&Zq(o,r.heap[u+1],r.heap[u],r.depth)&&u++,!Zq(o,c,r.heap[u],r.depth));)r.heap[s]=r.heap[u],s=u,u<<=1;r.heap[s]=c},e9=(r,o,s)=>{let c,u,h,p,g=0;if(r.sym_next!==0)do c=255&r.pending_buf[r.sym_buf+g++],c+=(255&r.pending_buf[r.sym_buf+g++])<<8,u=r.pending_buf[r.sym_buf+g++],c===0?rl(r,u,o):(h=j_[u],rl(r,h+jD+1,o),p=UD[h],p!==0&&(u-=VD[h],ls(r,u,p)),c--,h=Yq(c),rl(r,h,s),p=NT[h],p!==0&&(c-=DT[h],ls(r,c,p)));while(g<r.sym_next);rl(r,256,o)},WD=(r,o)=>{const s=o.dyn_tree,c=o.stat_desc.static_tree,u=o.stat_desc.has_stree,h=o.stat_desc.elems;let p,g,y,b=-1;for(r.heap_len=0,r.heap_max=573,p=0;p<h;p++)s[2*p]!==0?(r.heap[++r.heap_len]=b=p,r.depth[p]=0):s[2*p+1]=0;for(;r.heap_len<2;)y=r.heap[++r.heap_len]=b<2?++b:0,s[2*y]=1,r.depth[y]=0,r.opt_len--,u&&(r.static_len-=c[2*y+1]);for(o.max_code=b,p=r.heap_len>>1;p>=1;p--)$D(r,s,p);y=h;do p=r.heap[1],r.heap[1]=r.heap[r.heap_len--],$D(r,s,1),g=r.heap[1],r.heap[--r.heap_max]=p,r.heap[--r.heap_max]=g,s[2*y]=s[2*p]+s[2*g],r.depth[y]=(r.depth[p]>=r.depth[g]?r.depth[p]:r.depth[g])+1,s[2*p+1]=s[2*g+1]=y,r.heap[1]=y++,$D(r,s,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],((w,C)=>{const A=C.dyn_tree,x=C.max_code,B=C.stat_desc.static_tree,U=C.stat_desc.has_stree,F=C.stat_desc.extra_bits,K=C.stat_desc.extra_base,z=C.stat_desc.max_length;let Q,ie,oe,re,me,Ee,xe=0;for(re=0;re<=k_;re++)w.bl_count[re]=0;for(A[2*w.heap[w.heap_max]+1]=0,Q=w.heap_max+1;Q<573;Q++)ie=w.heap[Q],re=A[2*A[2*ie+1]+1]+1,re>z&&(re=z,xe++),A[2*ie+1]=re,ie>x||(w.bl_count[re]++,me=0,ie>=K&&(me=F[ie-K]),Ee=A[2*ie],w.opt_len+=Ee*(re+me),U&&(w.static_len+=Ee*(B[2*ie+1]+me)));if(xe!==0){do{for(re=z-1;w.bl_count[re]===0;)re--;w.bl_count[re]--,w.bl_count[re+1]+=2,w.bl_count[z]--,xe-=2}while(xe>0);for(re=z;re!==0;re--)for(ie=w.bl_count[re];ie!==0;)oe=w.heap[--Q],oe>x||(A[2*oe+1]!==re&&(w.opt_len+=(re-A[2*oe+1])*A[2*oe],A[2*oe+1]=re),ie--)}})(r,o),Xq(s,b,r.bl_count)},t9=(r,o,s)=>{let c,u,h=-1,p=o[1],g=0,y=7,b=4;for(p===0&&(y=138,b=3),o[2*(s+1)+1]=65535,c=0;c<=s;c++)u=p,p=o[2*(c+1)+1],++g<y&&u===p||(g<b?r.bl_tree[2*u]+=g:u!==0?(u!==h&&r.bl_tree[2*u]++,r.bl_tree[32]++):g<=10?r.bl_tree[34]++:r.bl_tree[36]++,g=0,h=u,p===0?(y=138,b=3):u===p?(y=6,b=3):(y=7,b=4))},n9=(r,o,s)=>{let c,u,h=-1,p=o[1],g=0,y=7,b=4;for(p===0&&(y=138,b=3),c=0;c<=s;c++)if(u=p,p=o[2*(c+1)+1],!(++g<y&&u===p)){if(g<b)do rl(r,u,r.bl_tree);while(--g!=0);else u!==0?(u!==h&&(rl(r,u,r.bl_tree),g--),rl(r,16,r.bl_tree),ls(r,g-3,2)):g<=10?(rl(r,17,r.bl_tree),ls(r,g-3,3)):(rl(r,18,r.bl_tree),ls(r,g-11,7));g=0,h=u,p===0?(y=138,b=3):u===p?(y=6,b=3):(y=7,b=4)}};let r9=!1;const i9=(r,o,s,c)=>{ls(r,0+(c?1:0),3),Qq(r),U_(r,s),U_(r,~s),s&&r.pending_buf.set(r.window.subarray(o,o+s),r.pending),r.pending+=s};var uPe=r=>{r9||((()=>{let o,s,c,u,h;const p=new Array(16);for(c=0,u=0;u<28;u++)for(VD[u]=c,o=0;o<1<<UD[u];o++)j_[c++]=u;for(j_[c-1]=u,h=0,u=0;u<16;u++)for(DT[u]=h,o=0;o<1<<NT[u];o++)M_[h++]=u;for(h>>=7;u<D_;u++)for(DT[u]=h<<7,o=0;o<1<<NT[u]-7;o++)M_[256+h++]=u;for(s=0;s<=k_;s++)p[s]=0;for(o=0;o<=143;)Ql[2*o+1]=8,o++,p[8]++;for(;o<=255;)Ql[2*o+1]=9,o++,p[9]++;for(;o<=279;)Ql[2*o+1]=7,o++,p[7]++;for(;o<=287;)Ql[2*o+1]=8,o++,p[8]++;for(Xq(Ql,287,p),o=0;o<D_;o++)L_[2*o+1]=5,L_[2*o]=qq(o,5);Hq=new FD(Ql,UD,257,Wq,k_),Kq=new FD(L_,NT,0,D_,k_),zq=new FD(new Array(0),lPe,0,19,7)})(),r9=!0),r.l_desc=new BD(r.dyn_ltree,Hq),r.d_desc=new BD(r.dyn_dtree,Kq),r.bl_desc=new BD(r.bl_tree,zq),r.bi_buf=0,r.bi_valid=0,Jq(r)},dPe=(r,o,s,c)=>{let u,h,p=0;r.level>0?(r.strm.data_type===2&&(r.strm.data_type=(g=>{let y,b=4093624447;for(y=0;y<=31;y++,b>>>=1)if(1&b&&g.dyn_ltree[2*y]!==0)return 0;if(g.dyn_ltree[18]!==0||g.dyn_ltree[20]!==0||g.dyn_ltree[26]!==0)return 1;for(y=32;y<jD;y++)if(g.dyn_ltree[2*y]!==0)return 1;return 0})(r)),WD(r,r.l_desc),WD(r,r.d_desc),p=(g=>{let y;for(t9(g,g.dyn_ltree,g.l_desc.max_code),t9(g,g.dyn_dtree,g.d_desc.max_code),WD(g,g.bl_desc),y=18;y>=3&&g.bl_tree[2*Gq[y]+1]===0;y--);return g.opt_len+=3*(y+1)+5+5+4,y})(r),u=r.opt_len+3+7>>>3,h=r.static_len+3+7>>>3,h<=u&&(u=h)):u=h=s+5,s+4<=u&&o!==-1?i9(r,o,s,c):r.strategy===4||h===u?(ls(r,2+(c?1:0),3),e9(r,Ql,L_)):(ls(r,4+(c?1:0),3),((g,y,b,w)=>{let C;for(ls(g,y-257,5),ls(g,b-1,5),ls(g,w-4,4),C=0;C<w;C++)ls(g,g.bl_tree[2*Gq[C]+1],3);n9(g,g.dyn_ltree,y-1),n9(g,g.dyn_dtree,b-1)})(r,r.l_desc.max_code+1,r.d_desc.max_code+1,p+1),e9(r,r.dyn_ltree,r.dyn_dtree)),Jq(r),c&&Qq(r)},hPe=(r,o,s)=>(r.pending_buf[r.sym_buf+r.sym_next++]=o,r.pending_buf[r.sym_buf+r.sym_next++]=o>>8,r.pending_buf[r.sym_buf+r.sym_next++]=s,o===0?r.dyn_ltree[2*s]++:(r.matches++,o--,r.dyn_ltree[2*(j_[s]+jD+1)]++,r.dyn_dtree[2*Yq(o)]++),r.sym_next===r.sym_end),fPe=r=>{ls(r,2,3),rl(r,256,Ql),(o=>{o.bi_valid===16?(U_(o,o.bi_buf),o.bi_buf=0,o.bi_valid=0):o.bi_valid>=8&&(o.pending_buf[o.pending++]=255&o.bi_buf,o.bi_buf>>=8,o.bi_valid-=8)})(r)},pPe={_tr_init:uPe,_tr_stored_block:i9,_tr_flush_block:dPe,_tr_tally:hPe,_tr_align:fPe},V_=(r,o,s,c)=>{let u=65535&r|0,h=r>>>16&65535|0,p=0;for(;s!==0;){p=s>2e3?2e3:s,s-=p;do u=u+o[c++]|0,h=h+u|0;while(--p);u%=65521,h%=65521}return u|h<<16|0};const mPe=new Uint32Array((()=>{let r,o=[];for(var s=0;s<256;s++){r=s;for(var c=0;c<8;c++)r=1&r?3988292384^r>>>1:r>>>1;o[s]=r}return o})());var Gi=(r,o,s,c)=>{const u=mPe,h=c+s;r^=-1;for(let p=c;p<h;p++)r=r>>>8^u[255&(r^o[p])];return-1^r},Ef={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},kT={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:gPe,_tr_stored_block:GD,_tr_flush_block:vPe,_tr_tally:wd,_tr_align:yPe}=pPe,{Z_NO_FLUSH:Td,Z_PARTIAL_FLUSH:_Pe,Z_FULL_FLUSH:EPe,Z_FINISH:wa,Z_BLOCK:o9,Z_OK:no,Z_STREAM_END:s9,Z_STREAM_ERROR:il,Z_DATA_ERROR:bPe,Z_BUF_ERROR:HD,Z_DEFAULT_COMPRESSION:SPe,Z_FILTERED:wPe,Z_HUFFMAN_ONLY:LT,Z_RLE:TPe,Z_FIXED:CPe,Z_DEFAULT_STRATEGY:RPe,Z_UNKNOWN:APe,Z_DEFLATED:MT}=kT,KD=286,OPe=30,IPe=19,xPe=2*KD+1,PPe=15,bf=258,ol=262,Ym=42,Sf=113,F_=666,wf=(r,o)=>(r.msg=Ef[o],o),a9=r=>2*r-(r>4?9:0),Cd=r=>{let o=r.length;for(;--o>=0;)r[o]=0},NPe=r=>{let o,s,c,u=r.w_size;o=r.hash_size,c=o;do s=r.head[--c],r.head[c]=s>=u?s-u:0;while(--o);o=u,c=o;do s=r.prev[--c],r.prev[c]=s>=u?s-u:0;while(--o)};let Rd=(r,o,s)=>(o<<r.hash_shift^s)&r.hash_mask;const ks=r=>{const o=r.state;let s=o.pending;s>r.avail_out&&(s=r.avail_out),s!==0&&(r.output.set(o.pending_buf.subarray(o.pending_out,o.pending_out+s),r.next_out),r.next_out+=s,o.pending_out+=s,r.total_out+=s,r.avail_out-=s,o.pending-=s,o.pending===0&&(o.pending_out=0))},Ls=(r,o)=>{vPe(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,o),r.block_start=r.strstart,ks(r.strm)},$n=(r,o)=>{r.pending_buf[r.pending++]=o},B_=(r,o)=>{r.pending_buf[r.pending++]=o>>>8&255,r.pending_buf[r.pending++]=255&o},zD=(r,o,s,c)=>{let u=r.avail_in;return u>c&&(u=c),u===0?0:(r.avail_in-=u,o.set(r.input.subarray(r.next_in,r.next_in+u),s),r.state.wrap===1?r.adler=V_(r.adler,o,u,s):r.state.wrap===2&&(r.adler=Gi(r.adler,o,u,s)),r.next_in+=u,r.total_in+=u,u)},c9=(r,o)=>{let s,c,u=r.max_chain_length,h=r.strstart,p=r.prev_length,g=r.nice_match;const y=r.strstart>r.w_size-ol?r.strstart-(r.w_size-ol):0,b=r.window,w=r.w_mask,C=r.prev,A=r.strstart+bf;let x=b[h+p-1],B=b[h+p];r.prev_length>=r.good_match&&(u>>=2),g>r.lookahead&&(g=r.lookahead);do if(s=o,b[s+p]===B&&b[s+p-1]===x&&b[s]===b[h]&&b[++s]===b[h+1]){h+=2,s++;do;while(b[++h]===b[++s]&&b[++h]===b[++s]&&b[++h]===b[++s]&&b[++h]===b[++s]&&b[++h]===b[++s]&&b[++h]===b[++s]&&b[++h]===b[++s]&&b[++h]===b[++s]&&h<A);if(c=bf-(A-h),h=A-bf,c>p){if(r.match_start=o,p=c,c>=g)break;x=b[h+p-1],B=b[h+p]}}while((o=C[o&w])>y&&--u!=0);return p<=r.lookahead?p:r.lookahead},qm=r=>{const o=r.w_size;let s,c,u;do{if(c=r.window_size-r.lookahead-r.strstart,r.strstart>=o+(o-ol)&&(r.window.set(r.window.subarray(o,o+o-c),0),r.match_start-=o,r.strstart-=o,r.block_start-=o,r.insert>r.strstart&&(r.insert=r.strstart),NPe(r),c+=o),r.strm.avail_in===0)break;if(s=zD(r.strm,r.window,r.strstart+r.lookahead,c),r.lookahead+=s,r.lookahead+r.insert>=3)for(u=r.strstart-r.insert,r.ins_h=r.window[u],r.ins_h=Rd(r,r.ins_h,r.window[u+1]);r.insert&&(r.ins_h=Rd(r,r.ins_h,r.window[u+3-1]),r.prev[u&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=u,u++,r.insert--,!(r.lookahead+r.insert<3)););}while(r.lookahead<ol&&r.strm.avail_in!==0)},l9=(r,o)=>{let s,c,u,h=r.pending_buf_size-5>r.w_size?r.w_size:r.pending_buf_size-5,p=0,g=r.strm.avail_in;do{if(s=65535,u=r.bi_valid+42>>3,r.strm.avail_out<u||(u=r.strm.avail_out-u,c=r.strstart-r.block_start,s>c+r.strm.avail_in&&(s=c+r.strm.avail_in),s>u&&(s=u),s<h&&(s===0&&o!==wa||o===Td||s!==c+r.strm.avail_in)))break;p=o===wa&&s===c+r.strm.avail_in?1:0,GD(r,0,0,p),r.pending_buf[r.pending-4]=s,r.pending_buf[r.pending-3]=s>>8,r.pending_buf[r.pending-2]=~s,r.pending_buf[r.pending-1]=~s>>8,ks(r.strm),c&&(c>s&&(c=s),r.strm.output.set(r.window.subarray(r.block_start,r.block_start+c),r.strm.next_out),r.strm.next_out+=c,r.strm.avail_out-=c,r.strm.total_out+=c,r.block_start+=c,s-=c),s&&(zD(r.strm,r.strm.output,r.strm.next_out,s),r.strm.next_out+=s,r.strm.avail_out-=s,r.strm.total_out+=s)}while(p===0);return g-=r.strm.avail_in,g&&(g>=r.w_size?(r.matches=2,r.window.set(r.strm.input.subarray(r.strm.next_in-r.w_size,r.strm.next_in),0),r.strstart=r.w_size,r.insert=r.strstart):(r.window_size-r.strstart<=g&&(r.strstart-=r.w_size,r.window.set(r.window.subarray(r.w_size,r.w_size+r.strstart),0),r.matches<2&&r.matches++,r.insert>r.strstart&&(r.insert=r.strstart)),r.window.set(r.strm.input.subarray(r.strm.next_in-g,r.strm.next_in),r.strstart),r.strstart+=g,r.insert+=g>r.w_size-r.insert?r.w_size-r.insert:g),r.block_start=r.strstart),r.high_water<r.strstart&&(r.high_water=r.strstart),p?4:o!==Td&&o!==wa&&r.strm.avail_in===0&&r.strstart===r.block_start?2:(u=r.window_size-r.strstart,r.strm.avail_in>u&&r.block_start>=r.w_size&&(r.block_start-=r.w_size,r.strstart-=r.w_size,r.window.set(r.window.subarray(r.w_size,r.w_size+r.strstart),0),r.matches<2&&r.matches++,u+=r.w_size,r.insert>r.strstart&&(r.insert=r.strstart)),u>r.strm.avail_in&&(u=r.strm.avail_in),u&&(zD(r.strm,r.window,r.strstart,u),r.strstart+=u,r.insert+=u>r.w_size-r.insert?r.w_size-r.insert:u),r.high_water<r.strstart&&(r.high_water=r.strstart),u=r.bi_valid+42>>3,u=r.pending_buf_size-u>65535?65535:r.pending_buf_size-u,h=u>r.w_size?r.w_size:u,c=r.strstart-r.block_start,(c>=h||(c||o===wa)&&o!==Td&&r.strm.avail_in===0&&c<=u)&&(s=c>u?u:c,p=o===wa&&r.strm.avail_in===0&&s===c?1:0,GD(r,r.block_start,s,p),r.block_start+=s,ks(r.strm)),p?3:1)},YD=(r,o)=>{let s,c;for(;;){if(r.lookahead<ol){if(qm(r),r.lookahead<ol&&o===Td)return 1;if(r.lookahead===0)break}if(s=0,r.lookahead>=3&&(r.ins_h=Rd(r,r.ins_h,r.window[r.strstart+3-1]),s=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),s!==0&&r.strstart-s<=r.w_size-ol&&(r.match_length=c9(r,s)),r.match_length>=3)if(c=wd(r,r.strstart-r.match_start,r.match_length-3),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=3){r.match_length--;do r.strstart++,r.ins_h=Rd(r,r.ins_h,r.window[r.strstart+3-1]),s=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!=0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=Rd(r,r.ins_h,r.window[r.strstart+1]);else c=wd(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(c&&(Ls(r,!1),r.strm.avail_out===0))return 1}return r.insert=r.strstart<2?r.strstart:2,o===wa?(Ls(r,!0),r.strm.avail_out===0?3:4):r.sym_next&&(Ls(r,!1),r.strm.avail_out===0)?1:2},Xm=(r,o)=>{let s,c,u;for(;;){if(r.lookahead<ol){if(qm(r),r.lookahead<ol&&o===Td)return 1;if(r.lookahead===0)break}if(s=0,r.lookahead>=3&&(r.ins_h=Rd(r,r.ins_h,r.window[r.strstart+3-1]),s=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=2,s!==0&&r.prev_length<r.max_lazy_match&&r.strstart-s<=r.w_size-ol&&(r.match_length=c9(r,s),r.match_length<=5&&(r.strategy===wPe||r.match_length===3&&r.strstart-r.match_start>4096)&&(r.match_length=2)),r.prev_length>=3&&r.match_length<=r.prev_length){u=r.strstart+r.lookahead-3,c=wd(r,r.strstart-1-r.prev_match,r.prev_length-3),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=u&&(r.ins_h=Rd(r,r.ins_h,r.window[r.strstart+3-1]),s=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!=0);if(r.match_available=0,r.match_length=2,r.strstart++,c&&(Ls(r,!1),r.strm.avail_out===0))return 1}else if(r.match_available){if(c=wd(r,0,r.window[r.strstart-1]),c&&Ls(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return 1}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(c=wd(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<2?r.strstart:2,o===wa?(Ls(r,!0),r.strm.avail_out===0?3:4):r.sym_next&&(Ls(r,!1),r.strm.avail_out===0)?1:2};function sl(r,o,s,c,u){this.good_length=r,this.max_lazy=o,this.nice_length=s,this.max_chain=c,this.func=u}const $_=[new sl(0,0,0,0,l9),new sl(4,4,8,4,YD),new sl(4,5,16,8,YD),new sl(4,6,32,32,YD),new sl(4,4,16,16,Xm),new sl(8,16,32,32,Xm),new sl(8,16,128,128,Xm),new sl(8,32,128,256,Xm),new sl(32,128,258,1024,Xm),new sl(32,258,258,4096,Xm)];function DPe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=MT,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*xPe),this.dyn_dtree=new Uint16Array(2*(2*OPe+1)),this.bl_tree=new Uint16Array(2*(2*IPe+1)),Cd(this.dyn_ltree),Cd(this.dyn_dtree),Cd(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(PPe+1),this.heap=new Uint16Array(2*KD+1),Cd(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*KD+1),Cd(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const W_=r=>{if(!r)return 1;const o=r.state;return!o||o.strm!==r||o.status!==Ym&&o.status!==57&&o.status!==69&&o.status!==73&&o.status!==91&&o.status!==103&&o.status!==Sf&&o.status!==F_?1:0},u9=r=>{if(W_(r))return wf(r,il);r.total_in=r.total_out=0,r.data_type=APe;const o=r.state;return o.pending=0,o.pending_out=0,o.wrap<0&&(o.wrap=-o.wrap),o.status=o.wrap===2?57:o.wrap?Ym:Sf,r.adler=o.wrap===2?0:1,o.last_flush=-2,gPe(o),no},d9=r=>{const o=u9(r);return o===no&&(s=>{s.window_size=2*s.w_size,Cd(s.head),s.max_lazy_match=$_[s.level].max_lazy,s.good_match=$_[s.level].good_length,s.nice_match=$_[s.level].nice_length,s.max_chain_length=$_[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=2,s.match_available=0,s.ins_h=0})(r.state),o},h9=(r,o,s,c,u,h)=>{if(!r)return il;let p=1;if(o===SPe&&(o=6),c<0?(p=0,c=-c):c>15&&(p=2,c-=16),u<1||u>9||s!==MT||c<8||c>15||o<0||o>9||h<0||h>CPe||c===8&&p!==1)return wf(r,il);c===8&&(c=9);const g=new DPe;return r.state=g,g.strm=r,g.status=Ym,g.wrap=p,g.gzhead=null,g.w_bits=c,g.w_size=1<<g.w_bits,g.w_mask=g.w_size-1,g.hash_bits=u+7,g.hash_size=1<<g.hash_bits,g.hash_mask=g.hash_size-1,g.hash_shift=~~((g.hash_bits+3-1)/3),g.window=new Uint8Array(2*g.w_size),g.head=new Uint16Array(g.hash_size),g.prev=new Uint16Array(g.w_size),g.lit_bufsize=1<<u+6,g.pending_buf_size=4*g.lit_bufsize,g.pending_buf=new Uint8Array(g.pending_buf_size),g.sym_buf=g.lit_bufsize,g.sym_end=3*(g.lit_bufsize-1),g.level=o,g.strategy=h,g.method=s,d9(r)};var kPe=(r,o)=>{if(W_(r)||o>o9||o<0)return r?wf(r,il):il;const s=r.state;if(!r.output||r.avail_in!==0&&!r.input||s.status===F_&&o!==wa)return wf(r,r.avail_out===0?HD:il);const c=s.last_flush;if(s.last_flush=o,s.pending!==0){if(ks(r),r.avail_out===0)return s.last_flush=-1,no}else if(r.avail_in===0&&a9(o)<=a9(c)&&o!==wa)return wf(r,HD);if(s.status===F_&&r.avail_in!==0)return wf(r,HD);if(s.status===Ym&&s.wrap===0&&(s.status=Sf),s.status===Ym){let u=MT+(s.w_bits-8<<4)<<8,h=-1;if(h=s.strategy>=LT||s.level<2?0:s.level<6?1:s.level===6?2:3,u|=h<<6,s.strstart!==0&&(u|=32),u+=31-u%31,B_(s,u),s.strstart!==0&&(B_(s,r.adler>>>16),B_(s,65535&r.adler)),r.adler=1,s.status=Sf,ks(r),s.pending!==0)return s.last_flush=-1,no}if(s.status===57){if(r.adler=0,$n(s,31),$n(s,139),$n(s,8),s.gzhead)$n(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),$n(s,255&s.gzhead.time),$n(s,s.gzhead.time>>8&255),$n(s,s.gzhead.time>>16&255),$n(s,s.gzhead.time>>24&255),$n(s,s.level===9?2:s.strategy>=LT||s.level<2?4:0),$n(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&($n(s,255&s.gzhead.extra.length),$n(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(r.adler=Gi(r.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69;else if($n(s,0),$n(s,0),$n(s,0),$n(s,0),$n(s,0),$n(s,s.level===9?2:s.strategy>=LT||s.level<2?4:0),$n(s,3),s.status=Sf,ks(r),s.pending!==0)return s.last_flush=-1,no}if(s.status===69){if(s.gzhead.extra){let u=s.pending,h=(65535&s.gzhead.extra.length)-s.gzindex;for(;s.pending+h>s.pending_buf_size;){let g=s.pending_buf_size-s.pending;if(s.pending_buf.set(s.gzhead.extra.subarray(s.gzindex,s.gzindex+g),s.pending),s.pending=s.pending_buf_size,s.gzhead.hcrc&&s.pending>u&&(r.adler=Gi(r.adler,s.pending_buf,s.pending-u,u)),s.gzindex+=g,ks(r),s.pending!==0)return s.last_flush=-1,no;u=0,h-=g}let p=new Uint8Array(s.gzhead.extra);s.pending_buf.set(p.subarray(s.gzindex,s.gzindex+h),s.pending),s.pending+=h,s.gzhead.hcrc&&s.pending>u&&(r.adler=Gi(r.adler,s.pending_buf,s.pending-u,u)),s.gzindex=0}s.status=73}if(s.status===73){if(s.gzhead.name){let u,h=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>h&&(r.adler=Gi(r.adler,s.pending_buf,s.pending-h,h)),ks(r),s.pending!==0)return s.last_flush=-1,no;h=0}u=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,$n(s,u)}while(u!==0);s.gzhead.hcrc&&s.pending>h&&(r.adler=Gi(r.adler,s.pending_buf,s.pending-h,h)),s.gzindex=0}s.status=91}if(s.status===91){if(s.gzhead.comment){let u,h=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>h&&(r.adler=Gi(r.adler,s.pending_buf,s.pending-h,h)),ks(r),s.pending!==0)return s.last_flush=-1,no;h=0}u=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,$n(s,u)}while(u!==0);s.gzhead.hcrc&&s.pending>h&&(r.adler=Gi(r.adler,s.pending_buf,s.pending-h,h))}s.status=103}if(s.status===103){if(s.gzhead.hcrc){if(s.pending+2>s.pending_buf_size&&(ks(r),s.pending!==0))return s.last_flush=-1,no;$n(s,255&r.adler),$n(s,r.adler>>8&255),r.adler=0}if(s.status=Sf,ks(r),s.pending!==0)return s.last_flush=-1,no}if(r.avail_in!==0||s.lookahead!==0||o!==Td&&s.status!==F_){let u=s.level===0?l9(s,o):s.strategy===LT?((h,p)=>{let g;for(;;){if(h.lookahead===0&&(qm(h),h.lookahead===0)){if(p===Td)return 1;break}if(h.match_length=0,g=wd(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++,g&&(Ls(h,!1),h.strm.avail_out===0))return 1}return h.insert=0,p===wa?(Ls(h,!0),h.strm.avail_out===0?3:4):h.sym_next&&(Ls(h,!1),h.strm.avail_out===0)?1:2})(s,o):s.strategy===TPe?((h,p)=>{let g,y,b,w;const C=h.window;for(;;){if(h.lookahead<=bf){if(qm(h),h.lookahead<=bf&&p===Td)return 1;if(h.lookahead===0)break}if(h.match_length=0,h.lookahead>=3&&h.strstart>0&&(b=h.strstart-1,y=C[b],y===C[++b]&&y===C[++b]&&y===C[++b])){w=h.strstart+bf;do;while(y===C[++b]&&y===C[++b]&&y===C[++b]&&y===C[++b]&&y===C[++b]&&y===C[++b]&&y===C[++b]&&y===C[++b]&&b<w);h.match_length=bf-(w-b),h.match_length>h.lookahead&&(h.match_length=h.lookahead)}if(h.match_length>=3?(g=wd(h,1,h.match_length-3),h.lookahead-=h.match_length,h.strstart+=h.match_length,h.match_length=0):(g=wd(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++),g&&(Ls(h,!1),h.strm.avail_out===0))return 1}return h.insert=0,p===wa?(Ls(h,!0),h.strm.avail_out===0?3:4):h.sym_next&&(Ls(h,!1),h.strm.avail_out===0)?1:2})(s,o):$_[s.level].func(s,o);if(u!==3&&u!==4||(s.status=F_),u===1||u===3)return r.avail_out===0&&(s.last_flush=-1),no;if(u===2&&(o===_Pe?yPe(s):o!==o9&&(GD(s,0,0,!1),o===EPe&&(Cd(s.head),s.lookahead===0&&(s.strstart=0,s.block_start=0,s.insert=0))),ks(r),r.avail_out===0))return s.last_flush=-1,no}return o!==wa?no:s.wrap<=0?s9:(s.wrap===2?($n(s,255&r.adler),$n(s,r.adler>>8&255),$n(s,r.adler>>16&255),$n(s,r.adler>>24&255),$n(s,255&r.total_in),$n(s,r.total_in>>8&255),$n(s,r.total_in>>16&255),$n(s,r.total_in>>24&255)):(B_(s,r.adler>>>16),B_(s,65535&r.adler)),ks(r),s.wrap>0&&(s.wrap=-s.wrap),s.pending!==0?no:s9)},LPe=(r,o)=>{let s=o.length;if(W_(r))return il;const c=r.state,u=c.wrap;if(u===2||u===1&&c.status!==Ym||c.lookahead)return il;if(u===1&&(r.adler=V_(r.adler,o,s,0)),c.wrap=0,s>=c.w_size){u===0&&(Cd(c.head),c.strstart=0,c.block_start=0,c.insert=0);let y=new Uint8Array(c.w_size);y.set(o.subarray(s-c.w_size,s),0),o=y,s=c.w_size}const h=r.avail_in,p=r.next_in,g=r.input;for(r.avail_in=s,r.next_in=0,r.input=o,qm(c);c.lookahead>=3;){let y=c.strstart,b=c.lookahead-2;do c.ins_h=Rd(c,c.ins_h,c.window[y+3-1]),c.prev[y&c.w_mask]=c.head[c.ins_h],c.head[c.ins_h]=y,y++;while(--b);c.strstart=y,c.lookahead=2,qm(c)}return c.strstart+=c.lookahead,c.block_start=c.strstart,c.insert=c.lookahead,c.lookahead=0,c.match_length=c.prev_length=2,c.match_available=0,r.next_in=p,r.input=g,r.avail_in=h,c.wrap=u,no},G_={deflateInit:(r,o)=>h9(r,o,MT,15,8,RPe),deflateInit2:h9,deflateReset:d9,deflateResetKeep:u9,deflateSetHeader:(r,o)=>W_(r)||r.state.wrap!==2?il:(r.state.gzhead=o,no),deflate:kPe,deflateEnd:r=>{if(W_(r))return il;const o=r.state.status;return r.state=null,o===Sf?wf(r,bPe):no},deflateSetDictionary:LPe,deflateInfo:"pako deflate (from Nodeca project)"};const MPe=(r,o)=>Object.prototype.hasOwnProperty.call(r,o);var jT={assign:function(r){const o=Array.prototype.slice.call(arguments,1);for(;o.length;){const s=o.shift();if(s){if(typeof s!="object")throw new TypeError(s+"must be non-object");for(const c in s)MPe(s,c)&&(r[c]=s[c])}}return r},flattenChunks:r=>{let o=0;for(let c=0,u=r.length;c<u;c++)o+=r[c].length;const s=new Uint8Array(o);for(let c=0,u=0,h=r.length;c<h;c++){let p=r[c];s.set(p,u),u+=p.length}return s}};let f9=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{f9=!1}const H_=new Uint8Array(256);for(let r=0;r<256;r++)H_[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;H_[254]=H_[254]=1;var K_={string2buf:r=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(r);let o,s,c,u,h,p=r.length,g=0;for(u=0;u<p;u++)s=r.charCodeAt(u),(64512&s)==55296&&u+1<p&&(c=r.charCodeAt(u+1),(64512&c)==56320&&(s=65536+(s-55296<<10)+(c-56320),u++)),g+=s<128?1:s<2048?2:s<65536?3:4;for(o=new Uint8Array(g),h=0,u=0;h<g;u++)s=r.charCodeAt(u),(64512&s)==55296&&u+1<p&&(c=r.charCodeAt(u+1),(64512&c)==56320&&(s=65536+(s-55296<<10)+(c-56320),u++)),s<128?o[h++]=s:s<2048?(o[h++]=192|s>>>6,o[h++]=128|63&s):s<65536?(o[h++]=224|s>>>12,o[h++]=128|s>>>6&63,o[h++]=128|63&s):(o[h++]=240|s>>>18,o[h++]=128|s>>>12&63,o[h++]=128|s>>>6&63,o[h++]=128|63&s);return o},buf2string:(r,o)=>{const s=o||r.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(r.subarray(0,o));let c,u;const h=new Array(2*s);for(u=0,c=0;c<s;){let p=r[c++];if(p<128){h[u++]=p;continue}let g=H_[p];if(g>4)h[u++]=65533,c+=g-1;else{for(p&=g===2?31:g===3?15:7;g>1&&c<s;)p=p<<6|63&r[c++],g--;g>1?h[u++]=65533:p<65536?h[u++]=p:(p-=65536,h[u++]=55296|p>>10&1023,h[u++]=56320|1023&p)}}return((p,g)=>{if(g<65534&&p.subarray&&f9)return String.fromCharCode.apply(null,p.length===g?p:p.subarray(0,g));let y="";for(let b=0;b<g;b++)y+=String.fromCharCode(p[b]);return y})(h,u)},utf8border:(r,o)=>{(o=o||r.length)>r.length&&(o=r.length);let s=o-1;for(;s>=0&&(192&r[s])==128;)s--;return s<0||s===0?o:s+H_[r[s]]>o?s:o}},p9=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const m9=Object.prototype.toString,{Z_NO_FLUSH:jPe,Z_SYNC_FLUSH:UPe,Z_FULL_FLUSH:VPe,Z_FINISH:FPe,Z_OK:UT,Z_STREAM_END:BPe,Z_DEFAULT_COMPRESSION:$Pe,Z_DEFAULT_STRATEGY:WPe,Z_DEFLATED:GPe}=kT;function VT(r){this.options=jT.assign({level:$Pe,method:GPe,chunkSize:16384,windowBits:15,memLevel:8,strategy:WPe},r||{});let o=this.options;o.raw&&o.windowBits>0?o.windowBits=-o.windowBits:o.gzip&&o.windowBits>0&&o.windowBits<16&&(o.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p9,this.strm.avail_out=0;let s=G_.deflateInit2(this.strm,o.level,o.method,o.windowBits,o.memLevel,o.strategy);if(s!==UT)throw new Error(Ef[s]);if(o.header&&G_.deflateSetHeader(this.strm,o.header),o.dictionary){let c;if(c=typeof o.dictionary=="string"?K_.string2buf(o.dictionary):m9.call(o.dictionary)==="[object ArrayBuffer]"?new Uint8Array(o.dictionary):o.dictionary,s=G_.deflateSetDictionary(this.strm,c),s!==UT)throw new Error(Ef[s]);this._dict_set=!0}}function HPe(r,o){const s=new VT(o);if(s.push(r,!0),s.err)throw s.msg||Ef[s.err];return s.result}VT.prototype.push=function(r,o){const s=this.strm,c=this.options.chunkSize;let u,h;if(this.ended)return!1;for(h=o===~~o?o:o===!0?FPe:jPe,typeof r=="string"?s.input=K_.string2buf(r):m9.call(r)==="[object ArrayBuffer]"?s.input=new Uint8Array(r):s.input=r,s.next_in=0,s.avail_in=s.input.length;;)if(s.avail_out===0&&(s.output=new Uint8Array(c),s.next_out=0,s.avail_out=c),(h===UPe||h===VPe)&&s.avail_out<=6)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else{if(u=G_.deflate(s,h),u===BPe)return s.next_out>0&&this.onData(s.output.subarray(0,s.next_out)),u=G_.deflateEnd(this.strm),this.onEnd(u),this.ended=!0,u===UT;if(s.avail_out!==0){if(h>0&&s.next_out>0)this.onData(s.output.subarray(0,s.next_out)),s.avail_out=0;else if(s.avail_in===0)break}else this.onData(s.output)}return!0},VT.prototype.onData=function(r){this.chunks.push(r)},VT.prototype.onEnd=function(r){r===UT&&(this.result=jT.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};var KPe={deflate:HPe};const FT=16209;var zPe=function(r,o){let s,c,u,h,p,g,y,b,w,C,A,x,B,U,F,K,z,Q,ie,oe,re,me,Ee,xe;const Me=r.state;s=r.next_in,Ee=r.input,c=s+(r.avail_in-5),u=r.next_out,xe=r.output,h=u-(o-r.avail_out),p=u+(r.avail_out-257),g=Me.dmax,y=Me.wsize,b=Me.whave,w=Me.wnext,C=Me.window,A=Me.hold,x=Me.bits,B=Me.lencode,U=Me.distcode,F=(1<<Me.lenbits)-1,K=(1<<Me.distbits)-1;e:do{x<15&&(A+=Ee[s++]<<x,x+=8,A+=Ee[s++]<<x,x+=8),z=B[A&F];t:for(;;){if(Q=z>>>24,A>>>=Q,x-=Q,Q=z>>>16&255,Q===0)xe[u++]=65535&z;else{if(!(16&Q)){if(!(64&Q)){z=B[(65535&z)+(A&(1<<Q)-1)];continue t}if(32&Q){Me.mode=16191;break e}r.msg="invalid literal/length code",Me.mode=FT;break e}ie=65535&z,Q&=15,Q&&(x<Q&&(A+=Ee[s++]<<x,x+=8),ie+=A&(1<<Q)-1,A>>>=Q,x-=Q),x<15&&(A+=Ee[s++]<<x,x+=8,A+=Ee[s++]<<x,x+=8),z=U[A&K];n:for(;;){if(Q=z>>>24,A>>>=Q,x-=Q,Q=z>>>16&255,!(16&Q)){if(!(64&Q)){z=U[(65535&z)+(A&(1<<Q)-1)];continue n}r.msg="invalid distance code",Me.mode=FT;break e}if(oe=65535&z,Q&=15,x<Q&&(A+=Ee[s++]<<x,x+=8,x<Q&&(A+=Ee[s++]<<x,x+=8)),oe+=A&(1<<Q)-1,oe>g){r.msg="invalid distance too far back",Me.mode=FT;break e}if(A>>>=Q,x-=Q,Q=u-h,oe>Q){if(Q=oe-Q,Q>b&&Me.sane){r.msg="invalid distance too far back",Me.mode=FT;break e}if(re=0,me=C,w===0){if(re+=y-Q,Q<ie){ie-=Q;do xe[u++]=C[re++];while(--Q);re=u-oe,me=xe}}else if(w<Q){if(re+=y+w-Q,Q-=w,Q<ie){ie-=Q;do xe[u++]=C[re++];while(--Q);if(re=0,w<ie){Q=w,ie-=Q;do xe[u++]=C[re++];while(--Q);re=u-oe,me=xe}}}else if(re+=w-Q,Q<ie){ie-=Q;do xe[u++]=C[re++];while(--Q);re=u-oe,me=xe}for(;ie>2;)xe[u++]=me[re++],xe[u++]=me[re++],xe[u++]=me[re++],ie-=3;ie&&(xe[u++]=me[re++],ie>1&&(xe[u++]=me[re++]))}else{re=u-oe;do xe[u++]=xe[re++],xe[u++]=xe[re++],xe[u++]=xe[re++],ie-=3;while(ie>2);ie&&(xe[u++]=xe[re++],ie>1&&(xe[u++]=xe[re++]))}break}}break}}while(s<c&&u<p);ie=x>>3,s-=ie,x-=ie<<3,A&=(1<<x)-1,r.next_in=s,r.next_out=u,r.avail_in=s<c?c-s+5:5-(s-c),r.avail_out=u<p?p-u+257:257-(u-p),Me.hold=A,Me.bits=x};const BT=15,YPe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),qPe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),XPe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),JPe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var z_=(r,o,s,c,u,h,p,g)=>{const y=g.bits;let b,w,C,A,x,B,U=0,F=0,K=0,z=0,Q=0,ie=0,oe=0,re=0,me=0,Ee=0,xe=null;const Me=new Uint16Array(16),pt=new Uint16Array(16);let ut,nt,hn,en=null;for(U=0;U<=BT;U++)Me[U]=0;for(F=0;F<c;F++)Me[o[s+F]]++;for(Q=y,z=BT;z>=1&&Me[z]===0;z--);if(Q>z&&(Q=z),z===0)return u[h++]=20971520,u[h++]=20971520,g.bits=1,0;for(K=1;K<z&&Me[K]===0;K++);for(Q<K&&(Q=K),re=1,U=1;U<=BT;U++)if(re<<=1,re-=Me[U],re<0)return-1;if(re>0&&(r===0||z!==1))return-1;for(pt[1]=0,U=1;U<BT;U++)pt[U+1]=pt[U]+Me[U];for(F=0;F<c;F++)o[s+F]!==0&&(p[pt[o[s+F]]++]=F);if(r===0?(xe=en=p,B=20):r===1?(xe=YPe,en=qPe,B=257):(xe=XPe,en=JPe,B=0),Ee=0,F=0,U=K,x=h,ie=Q,oe=0,C=-1,me=1<<Q,A=me-1,r===1&&me>852||r===2&&me>592)return 1;for(;;){ut=U-oe,p[F]+1<B?(nt=0,hn=p[F]):p[F]>=B?(nt=en[p[F]-B],hn=xe[p[F]-B]):(nt=96,hn=0),b=1<<U-oe,w=1<<ie,K=w;do w-=b,u[x+(Ee>>oe)+w]=ut<<24|nt<<16|hn|0;while(w!==0);for(b=1<<U-1;Ee&b;)b>>=1;if(b!==0?(Ee&=b-1,Ee+=b):Ee=0,F++,--Me[U]==0){if(U===z)break;U=o[s+p[F]]}if(U>Q&&(Ee&A)!==C){for(oe===0&&(oe=Q),x+=K,ie=U-oe,re=1<<ie;ie+oe<z&&(re-=Me[ie+oe],!(re<=0));)ie++,re<<=1;if(me+=1<<ie,r===1&&me>852||r===2&&me>592)return 1;C=Ee&A,u[C]=Q<<24|ie<<16|x-h|0}}return Ee!==0&&(u[x+Ee]=U-oe<<24|64<<16|0),g.bits=Q,0};const{Z_FINISH:g9,Z_BLOCK:QPe,Z_TREES:$T,Z_OK:Tf,Z_STREAM_END:ZPe,Z_NEED_DICT:eNe,Z_STREAM_ERROR:Ta,Z_DATA_ERROR:v9,Z_MEM_ERROR:y9,Z_BUF_ERROR:tNe,Z_DEFLATED:_9}=kT,WT=16180,GT=16190,Zl=16191,qD=16192,XD=16194,HT=16199,KT=16200,JD=16206,Vr=16209,E9=r=>(r>>>24&255)+(r>>>8&65280)+((65280&r)<<8)+((255&r)<<24);function nNe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Cf=r=>{if(!r)return 1;const o=r.state;return!o||o.strm!==r||o.mode<WT||o.mode>16211?1:0},b9=r=>{if(Cf(r))return Ta;const o=r.state;return r.total_in=r.total_out=o.total=0,r.msg="",o.wrap&&(r.adler=1&o.wrap),o.mode=WT,o.last=0,o.havedict=0,o.flags=-1,o.dmax=32768,o.head=null,o.hold=0,o.bits=0,o.lencode=o.lendyn=new Int32Array(852),o.distcode=o.distdyn=new Int32Array(592),o.sane=1,o.back=-1,Tf},S9=r=>{if(Cf(r))return Ta;const o=r.state;return o.wsize=0,o.whave=0,o.wnext=0,b9(r)},w9=(r,o)=>{let s;if(Cf(r))return Ta;const c=r.state;return o<0?(s=0,o=-o):(s=5+(o>>4),o<48&&(o&=15)),o&&(o<8||o>15)?Ta:(c.window!==null&&c.wbits!==o&&(c.window=null),c.wrap=s,c.wbits=o,S9(r))},T9=(r,o)=>{if(!r)return Ta;const s=new nNe;r.state=s,s.strm=r,s.window=null,s.mode=WT;const c=w9(r,o);return c!==Tf&&(r.state=null),c};let QD,ZD,C9=!0;const rNe=r=>{if(C9){QD=new Int32Array(512),ZD=new Int32Array(32);let o=0;for(;o<144;)r.lens[o++]=8;for(;o<256;)r.lens[o++]=9;for(;o<280;)r.lens[o++]=7;for(;o<288;)r.lens[o++]=8;for(z_(1,r.lens,0,288,QD,0,r.work,{bits:9}),o=0;o<32;)r.lens[o++]=5;z_(2,r.lens,0,32,ZD,0,r.work,{bits:5}),C9=!1}r.lencode=QD,r.lenbits=9,r.distcode=ZD,r.distbits=5},R9=(r,o,s,c)=>{let u;const h=r.state;return h.window===null&&(h.wsize=1<<h.wbits,h.wnext=0,h.whave=0,h.window=new Uint8Array(h.wsize)),c>=h.wsize?(h.window.set(o.subarray(s-h.wsize,s),0),h.wnext=0,h.whave=h.wsize):(u=h.wsize-h.wnext,u>c&&(u=c),h.window.set(o.subarray(s-c,s-c+u),h.wnext),(c-=u)?(h.window.set(o.subarray(s-c,s),0),h.wnext=c,h.whave=h.wsize):(h.wnext+=u,h.wnext===h.wsize&&(h.wnext=0),h.whave<h.wsize&&(h.whave+=u))),0};var iNe=(r,o)=>{let s,c,u,h,p,g,y,b,w,C,A,x,B,U,F,K,z,Q,ie,oe,re,me,Ee=0;const xe=new Uint8Array(4);let Me,pt;const ut=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Cf(r)||!r.output||!r.input&&r.avail_in!==0)return Ta;s=r.state,s.mode===Zl&&(s.mode=qD),p=r.next_out,u=r.output,y=r.avail_out,h=r.next_in,c=r.input,g=r.avail_in,b=s.hold,w=s.bits,C=g,A=y,me=Tf;e:for(;;)switch(s.mode){case WT:if(s.wrap===0){s.mode=qD;break}for(;w<16;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}if(2&s.wrap&&b===35615){s.wbits===0&&(s.wbits=15),s.check=0,xe[0]=255&b,xe[1]=b>>>8&255,s.check=Gi(s.check,xe,2,0),b=0,w=0,s.mode=16181;break}if(s.head&&(s.head.done=!1),!(1&s.wrap)||(((255&b)<<8)+(b>>8))%31){r.msg="incorrect header check",s.mode=Vr;break}if((15&b)!==_9){r.msg="unknown compression method",s.mode=Vr;break}if(b>>>=4,w-=4,re=8+(15&b),s.wbits===0&&(s.wbits=re),re>15||re>s.wbits){r.msg="invalid window size",s.mode=Vr;break}s.dmax=1<<s.wbits,s.flags=0,r.adler=s.check=1,s.mode=512&b?16189:Zl,b=0,w=0;break;case 16181:for(;w<16;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}if(s.flags=b,(255&Pi(s))!==_9){r.msg="unknown compression method",s.mode=Vr;break}if(57344&Pi(s)){r.msg="unknown header flags set",s.mode=Vr;break}s.head&&(s.head.text=b>>8&1),512&Pi(s)&&4&s.wrap&&(xe[0]=255&b,xe[1]=b>>>8&255,s.check=Gi(s.check,xe,2,0)),b=0,w=0,s.mode=16182;case 16182:for(;w<32;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}s.head&&(s.head.time=b),512&Pi(s)&&4&s.wrap&&(xe[0]=255&b,xe[1]=b>>>8&255,xe[2]=b>>>16&255,xe[3]=b>>>24&255,s.check=Gi(s.check,xe,4,0)),b=0,w=0,s.mode=16183;case 16183:for(;w<16;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}s.head&&(s.head.xflags=255&b,s.head.os=b>>8),512&Pi(s)&&4&s.wrap&&(xe[0]=255&b,xe[1]=b>>>8&255,s.check=Gi(s.check,xe,2,0)),b=0,w=0,s.mode=16184;case 16184:if(1024&Pi(s)){for(;w<16;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}s.length=b,s.head&&(s.head.extra_len=b),512&Pi(s)&&4&s.wrap&&(xe[0]=255&b,xe[1]=b>>>8&255,s.check=Gi(s.check,xe,2,0)),b=0,w=0}else s.head&&(s.head.extra=null);s.mode=16185;case 16185:if(1024&Pi(s)&&(x=s.length,x>g&&(x=g),x&&(s.head&&(re=s.head.extra_len-s.length,s.head.extra||(s.head.extra=new Uint8Array(s.head.extra_len)),s.head.extra.set(c.subarray(h,h+x),re)),512&Pi(s)&&4&s.wrap&&(s.check=Gi(s.check,c,x,h)),g-=x,h+=x,s.length-=x),s.length))break e;s.length=0,s.mode=16186;case 16186:if(2048&Pi(s)){if(g===0)break e;x=0;do re=c[h+x++],s.head&&re&&s.length<65536&&(s.head.name+=String.fromCharCode(re));while(re&&x<g);if(512&Pi(s)&&4&s.wrap&&(s.check=Gi(s.check,c,x,h)),g-=x,h+=x,re)break e}else s.head&&(s.head.name=null);s.length=0,s.mode=16187;case 16187:if(4096&Pi(s)){if(g===0)break e;x=0;do re=c[h+x++],s.head&&re&&s.length<65536&&(s.head.comment+=String.fromCharCode(re));while(re&&x<g);if(512&Pi(s)&&4&s.wrap&&(s.check=Gi(s.check,c,x,h)),g-=x,h+=x,re)break e}else s.head&&(s.head.comment=null);s.mode=16188;case 16188:if(512&Pi(s)){for(;w<16;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}if(4&s.wrap&&b!==(65535&s.check)){r.msg="header crc mismatch",s.mode=Vr;break}b=0,w=0}s.head&&(s.head.hcrc=Pi(s)>>9&1,s.head.done=!0),r.adler=s.check=0,s.mode=Zl;break;case 16189:for(;w<32;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}r.adler=s.check=E9(b),b=0,w=0,s.mode=GT;case GT:if(s.havedict===0)return r.next_out=p,r.avail_out=y,r.next_in=h,r.avail_in=g,s.hold=b,s.bits=w,eNe;r.adler=s.check=1,s.mode=Zl;case Zl:if(o===QPe||o===$T)break e;case qD:if(s.last){b>>>=7&w,w-=7&w,s.mode=JD;break}for(;w<3;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}switch(s.last=1&b,b>>>=1,w-=1,3&b){case 0:s.mode=16193;break;case 1:if(rNe(s),s.mode=HT,o===$T){b>>>=2,w-=2;break e}break;case 2:s.mode=16196;break;case 3:r.msg="invalid block type",s.mode=Vr}b>>>=2,w-=2;break;case 16193:for(b>>>=7&w,w-=7&w;w<32;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}if((65535&b)!=(b>>>16^65535)){r.msg="invalid stored block lengths",s.mode=Vr;break}if(s.length=65535&b,b=0,w=0,s.mode=XD,o===$T)break e;case XD:s.mode=16195;case 16195:if(x=s.length,x){if(x>g&&(x=g),x>y&&(x=y),x===0)break e;u.set(c.subarray(h,h+x),p),g-=x,h+=x,y-=x,p+=x,s.length-=x;break}s.mode=Zl;break;case 16196:for(;w<14;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}if(s.nlen=257+(31&b),b>>>=5,w-=5,s.ndist=1+(31&b),b>>>=5,w-=5,s.ncode=4+(15&b),b>>>=4,w-=4,s.nlen>286||s.ndist>30){r.msg="too many length or distance symbols",s.mode=Vr;break}s.have=0,s.mode=16197;case 16197:for(;s.have<s.ncode;){for(;w<3;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}s.lens[ut[s.have++]]=7&b,b>>>=3,w-=3}for(;s.have<19;)s.lens[ut[s.have++]]=0;if(s.lencode=s.lendyn,s.lenbits=7,Me={bits:s.lenbits},me=z_(0,s.lens,0,19,s.lencode,0,s.work,Me),s.lenbits=Me.bits,me){r.msg="invalid code lengths set",s.mode=Vr;break}s.have=0,s.mode=16198;case 16198:for(;s.have<s.nlen+s.ndist;){for(;Ee=s.lencode[b&(1<<s.lenbits)-1],F=Ee>>>24,K=Ee>>>16&255,z=65535&Ee,!(F<=w);){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}if(z<16)b>>>=F,w-=F,s.lens[s.have++]=z;else{if(z===16){for(pt=F+2;w<pt;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}if(b>>>=F,w-=F,s.have===0){r.msg="invalid bit length repeat",s.mode=Vr;break}re=s.lens[s.have-1],x=3+(3&b),b>>>=2,w-=2}else if(z===17){for(pt=F+3;w<pt;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}b>>>=F,w-=F,re=0,x=3+(7&b),b>>>=3,w-=3}else{for(pt=F+7;w<pt;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}b>>>=F,w-=F,re=0,x=11+(127&b),b>>>=7,w-=7}if(s.have+x>s.nlen+s.ndist){r.msg="invalid bit length repeat",s.mode=Vr;break}for(;x--;)s.lens[s.have++]=re}}if(s.mode===Vr)break;if(s.lens[256]===0){r.msg="invalid code -- missing end-of-block",s.mode=Vr;break}if(s.lenbits=9,Me={bits:s.lenbits},me=z_(1,s.lens,0,s.nlen,s.lencode,0,s.work,Me),s.lenbits=Me.bits,me){r.msg="invalid literal/lengths set",s.mode=Vr;break}if(s.distbits=6,s.distcode=s.distdyn,Me={bits:s.distbits},me=z_(2,s.lens,s.nlen,s.ndist,s.distcode,0,s.work,Me),s.distbits=Me.bits,me){r.msg="invalid distances set",s.mode=Vr;break}if(s.mode=HT,o===$T)break e;case HT:s.mode=KT;case KT:if(g>=6&&y>=258){r.next_out=p,r.avail_out=y,r.next_in=h,r.avail_in=g,s.hold=b,s.bits=w,zPe(r,A),p=r.next_out,u=r.output,y=r.avail_out,h=r.next_in,c=r.input,g=r.avail_in,b=s.hold,w=s.bits,s.mode===Zl&&(s.back=-1);break}for(s.back=0;Ee=s.lencode[b&(1<<s.lenbits)-1],F=Ee>>>24,K=Ee>>>16&255,z=65535&Ee,!(F<=w);){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}if(K&&!(240&K)){for(Q=F,ie=K,oe=z;Ee=s.lencode[oe+((b&(1<<Q+ie)-1)>>Q)],F=Ee>>>24,K=Ee>>>16&255,z=65535&Ee,!(Q+F<=w);){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}b>>>=Q,w-=Q,s.back+=Q}if(b>>>=F,w-=F,s.back+=F,s.length=z,K===0){s.mode=16205;break}if(32&K){s.back=-1,s.mode=Zl;break}if(64&K){r.msg="invalid literal/length code",s.mode=Vr;break}s.extra=15&K,s.mode=16201;case 16201:if(s.extra){for(pt=s.extra;w<pt;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}s.length+=b&(1<<s.extra)-1,b>>>=s.extra,w-=s.extra,s.back+=s.extra}s.was=s.length,s.mode=16202;case 16202:for(;Ee=s.distcode[b&(1<<s.distbits)-1],F=Ee>>>24,K=Ee>>>16&255,z=65535&Ee,!(F<=w);){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}if(!(240&K)){for(Q=F,ie=K,oe=z;Ee=s.distcode[oe+((b&(1<<Q+ie)-1)>>Q)],F=Ee>>>24,K=Ee>>>16&255,z=65535&Ee,!(Q+F<=w);){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}b>>>=Q,w-=Q,s.back+=Q}if(b>>>=F,w-=F,s.back+=F,64&K){r.msg="invalid distance code",s.mode=Vr;break}s.offset=z,s.extra=15&K,s.mode=16203;case 16203:if(s.extra){for(pt=s.extra;w<pt;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}s.offset+=b&(1<<s.extra)-1,b>>>=s.extra,w-=s.extra,s.back+=s.extra}if(s.offset>s.dmax){r.msg="invalid distance too far back",s.mode=Vr;break}s.mode=16204;case 16204:if(y===0)break e;if(x=A-y,s.offset>x){if(x=s.offset-x,x>s.whave&&s.sane){r.msg="invalid distance too far back",s.mode=Vr;break}x>s.wnext?(x-=s.wnext,B=s.wsize-x):B=s.wnext-x,x>s.length&&(x=s.length),U=s.window}else U=u,B=p-s.offset,x=s.length;x>y&&(x=y),y-=x,s.length-=x;do u[p++]=U[B++];while(--x);s.length===0&&(s.mode=KT);break;case 16205:if(y===0)break e;u[p++]=s.length,y--,s.mode=KT;break;case JD:if(s.wrap){for(;w<32;){if(g===0)break e;g--,b|=c[h++]<<w,w+=8}if(A-=y,r.total_out+=A,s.total+=A,4&s.wrap&&A&&(r.adler=s.check=Pi(s)?Gi(s.check,u,A,p-A):V_(s.check,u,A,p-A)),A=y,4&s.wrap&&(Pi(s)?b:E9(b))!==s.check){r.msg="incorrect data check",s.mode=Vr;break}b=0,w=0}s.mode=16207;case 16207:if(s.wrap&&Pi(s)){for(;w<32;){if(g===0)break e;g--,b+=c[h++]<<w,w+=8}if(4&s.wrap&&b!==(4294967295&s.total)){r.msg="incorrect length check",s.mode=Vr;break}b=0,w=0}s.mode=16208;case 16208:me=ZPe;break e;case Vr:me=v9;break e;case 16210:return y9;default:return Ta}return r.next_out=p,r.avail_out=y,r.next_in=h,r.avail_in=g,s.hold=b,s.bits=w,(s.wsize||A!==r.avail_out&&s.mode<Vr&&(s.mode<JD||o!==g9))&&R9(r,r.output,r.next_out,A-r.avail_out),C-=r.avail_in,A-=r.avail_out,r.total_in+=C,r.total_out+=A,s.total+=A,4&s.wrap&&A&&(r.adler=s.check=Pi(s)?Gi(s.check,u,A,r.next_out-A):V_(s.check,u,A,r.next_out-A)),r.data_type=s.bits+(s.last?64:0)+(s.mode===Zl?128:0)+(s.mode===HT||s.mode===XD?256:0),(C===0&&A===0||o===g9)&&me===Tf&&(me=tNe),me},eu={inflateReset:S9,inflateReset2:w9,inflateResetKeep:b9,inflateInit:r=>T9(r,15),inflateInit2:T9,inflate:iNe,inflateEnd:r=>{if(Cf(r))return Ta;let o=r.state;return o.window&&(o.window=null),r.state=null,Tf},inflateGetHeader:(r,o)=>{if(Cf(r))return Ta;const s=r.state;return 2&s.wrap?(s.head=o,o.done=!1,Tf):Ta},inflateSetDictionary:(r,o)=>{const s=o.length;let c,u,h;return Cf(r)?Ta:(c=r.state,c.wrap!==0&&c.mode!==GT?Ta:c.mode===GT&&(u=1,u=V_(u,o,s,0),u!==c.check)?v9:(h=R9(r,o,s,s),h?(c.mode=16210,y9):(c.havedict=1,Tf)))},inflateInfo:"pako inflate (from Nodeca project)"},oNe=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const A9=Object.prototype.toString,{Z_NO_FLUSH:sNe,Z_FINISH:aNe,Z_OK:Y_,Z_STREAM_END:ek,Z_NEED_DICT:tk,Z_STREAM_ERROR:cNe,Z_DATA_ERROR:O9,Z_MEM_ERROR:lNe}=kT;function zT(r){this.options=jT.assign({chunkSize:65536,windowBits:15,to:""},r||{});const o=this.options;o.raw&&o.windowBits>=0&&o.windowBits<16&&(o.windowBits=-o.windowBits,o.windowBits===0&&(o.windowBits=-15)),!(o.windowBits>=0&&o.windowBits<16)||r&&r.windowBits||(o.windowBits+=32),o.windowBits>15&&o.windowBits<48&&!(15&o.windowBits)&&(o.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p9,this.strm.avail_out=0;let s=eu.inflateInit2(this.strm,o.windowBits);if(s!==Y_)throw new Error(Ef[s]);if(this.header=new oNe,eu.inflateGetHeader(this.strm,this.header),o.dictionary&&(typeof o.dictionary=="string"?o.dictionary=K_.string2buf(o.dictionary):A9.call(o.dictionary)==="[object ArrayBuffer]"&&(o.dictionary=new Uint8Array(o.dictionary)),o.raw&&(s=eu.inflateSetDictionary(this.strm,o.dictionary),s!==Y_)))throw new Error(Ef[s])}function uNe(r,o){const s=new zT(o);if(s.push(r),s.err)throw s.msg||Ef[s.err];return s.result}zT.prototype.push=function(r,o){const s=this.strm,c=this.options.chunkSize,u=this.options.dictionary;let h,p,g;if(this.ended)return!1;for(p=o===~~o?o:o===!0?aNe:sNe,A9.call(r)==="[object ArrayBuffer]"?s.input=new Uint8Array(r):s.input=r,s.next_in=0,s.avail_in=s.input.length;;){for(s.avail_out===0&&(s.output=new Uint8Array(c),s.next_out=0,s.avail_out=c),h=eu.inflate(s,p),h===tk&&u&&(h=eu.inflateSetDictionary(s,u),h===Y_?h=eu.inflate(s,p):h===O9&&(h=tk));s.avail_in>0&&h===ek&&s.state.wrap>0&&r[s.next_in]!==0;)eu.inflateReset(s),h=eu.inflate(s,p);switch(h){case cNe:case O9:case tk:case lNe:return this.onEnd(h),this.ended=!0,!1}if(g=s.avail_out,s.next_out&&(s.avail_out===0||h===ek))if(this.options.to==="string"){let y=K_.utf8border(s.output,s.next_out),b=s.next_out-y,w=K_.buf2string(s.output,y);s.next_out=b,s.avail_out=c-b,b&&s.output.set(s.output.subarray(y,y+b),0),this.onData(w)}else this.onData(s.output.length===s.next_out?s.output:s.output.subarray(0,s.next_out));if(h!==Y_||g!==0){if(h===ek)return h=eu.inflateEnd(this.strm),this.onEnd(h),this.ended=!0,!0;if(s.avail_in===0)break}}return!0},zT.prototype.onData=function(r){this.chunks.push(r)},zT.prototype.onEnd=function(r){r===Y_&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=jT.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};var dNe={inflate:uNe};const{deflate:hNe}=KPe,{inflate:fNe}=dNe;var pNe=hNe,mNe=fNe,I9=function(r){return r[r.ONE_BYTE=0]="ONE_BYTE",r[r.TWO_BYTE=1]="TWO_BYTE",r}(I9||{});class gNe{constructor(){G(this,"_sequence",0),G(this,"_startTime",Date.now()),G(this,"isUseOneByte",!0)}get startTime(){const o=Date.now()-this._startTime;return o<Math.pow(2,16)?o:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(o){const s={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:o};if(o.byteLength>128){const g=new Uint8Array(4);g.set([1,0,0,0]);const y={id:0,length:4,data:g.buffer},b={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[y]};s.commonPacketHeader.extension=1,s.extension=b,s.payload=this.compress(o),s.commonPacketHeader.length=8+(s.extension.length+2)+s.payload.byteLength}else s.commonPacketHeader.length=8+s.payload.byteLength;q("SHOW_DATASTREAM2_LOG")&&L.debug("send data header: ".concat(JSON.stringify(s.commonPacketHeader)));const c=new ArrayBuffer(s.commonPacketHeader.length),u=new Uint8Array(c),h=new DataView(c);let p=0;if(h.setUint16(p,s.commonPacketHeader.extension<<15|s.commonPacketHeader.reserved<<14|s.commonPacketHeader.length,!0),p+=2,h.setUint32(p,s.commonPacketHeader.sequence,!0),p+=4,h.setUint16(p,s.commonStreamHeader,!0),p+=2,s.extension){const g=this.serializeExtension(s.extension);u.set(new Uint8Array(g),p),p+=g.byteLength}if(u.set(new Uint8Array(s.payload),p),p+=s.payload.byteLength,p!==s.commonPacketHeader.length)throw Error("serialize error!");return c}deserialize(o){if(o.byteLength<4)return new ArrayBuffer(0);const s=new DataView(o);let c=0;const u=s.getUint16(c,!0);c+=2;const h={length:16383&u,reserved:(16384&u)>>14,extension:(32768&u)>>15,sequence:s.getUint16(c+2,!0)<<16|s.getUint16(c,!0)};let p,g;if(c+=4,q("SHOW_DATASTREAM2_LOG")&&L.debug("receive data header: ".concat(JSON.stringify(h))),s.getUint16(c,!0),c+=2,h.extension){g=this.deserializeExtension(o.slice(c)),c+=2+g.length,p=o.slice(c);let y=!1;if(g.datas.length>0){const b=g.datas.find(w=>w.id===0);b&&(y=(1&new DataView(b.data).getUint32(0,!0))==1)}p=y?this.decompress(p):p}else p=o.slice(8);return p}serializeExtension(o){const{profile:s,length:c,datas:u}=o,h=new ArrayBuffer(c+2),p=new Uint8Array(h),g=new DataView(h);let y=0;if(g.setUint8(y++,s),g.setUint8(y++,c),u.forEach(b=>{s?(g.setUint8(y++,b.id),g.setUint8(y++,b.length),p.set(new Uint8Array(b.data),y),y+=b.data.byteLength):(g.setUint8(y++,b.id|b.length<<4),p.set(new Uint8Array(b.data),y),y+=b.data.byteLength)}),y!==c+2)throw Error("serialize extension error, is ".concat(y,"!==").concat(c+2));return h}deserializeExtension(o){const s=new DataView(o);let c=0;const u=s.getUint8(c);c++;const h=s.getUint8(c);c++;const p=u===I9.TWO_BYTE,g=[],y=new DataView(o,2);let b=0;for(;b<h;){let w=0,C=0,A=new ArrayBuffer(0);p?(w=y.getUint8(b),b++,C=y.getUint8(b),b++):(w=15&y.getUint8(b),C=y.getUint8(b)>>4,b++),C>0&&(A=y.buffer.slice(b+2,b+2+C),b+=A.byteLength),g.push({id:w,length:C,data:A})}if(b!==h)throw Error("parse error");return{profile:u,length:h,datas:g}}decompress(o){return mNe(new Uint8Array(o))}compress(o){return pNe(new Uint8Array(o))}}const vNe={name:"DataStream",create:(r,o)=>{const s=o?new wIe(r):new TIe(r);return s.useDataStream(new gNe),s}};class yNe extends An{constructor(o,s,c){super(),G(this,"ws",void 0),G(this,"requestId",1),G(this,"heartBeatTimer",void 0),G(this,"joinInfo",void 0),G(this,"clientId",void 0),G(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),G(this,"onClose",u=>{this.emit("close"),this.dispose()}),G(this,"onMessage",u=>{const h=JSON.parse(u.data);if(!h||h.command!=="serverResponse"||!h.requestId)return h&&h.command==="serverStatus"&&h.serverStatus&&h.serverStatus.command?(this.emit("status",h.serverStatus),void this.emit(h.serverStatus.command,h.serverStatus)):void 0;this.emit("req_".concat(h.requestId),h)}),this.joinInfo=o,this.clientId=s,this.ws=new __("cross-channel-".concat(this.clientId),c),this.ws.on(lt.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(lt.CONNECTED,this.onOpen),this.ws.on(lt.ON_MESSAGE,this.onMessage),this.ws.on(lt.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(o){const s=this.requestId++;return o.requestId=s,o.seq=s,this.ws.sendMessage(o),s}waitStatus(o){return new De((s,c)=>{const u=window.setTimeout(()=>{c(new pe(Y.TIMEOUT,"wait status timeout, status: ".concat(o)))},5e3);this.once(o,h=>{window.clearTimeout(u),h.state&&h.state!==0?c(new pe(Y.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(o))):s(void 0)}),this.once("dispose",()=>{window.clearTimeout(u),c(new pe(Y.WS_ABORT))})})}async request(o){if(this.ws.state==="closed")throw new pe(Y.WS_DISCONNECT);const s=()=>new De((p,g)=>{this.ws.once(lt.CLOSED,()=>g(new pe(Y.WS_ABORT))),this.ws.once(lt.CONNECTED,p)});this.ws.state!=="connected"&&await s();const c=this.sendMessage(o),u=new De((p,g)=>{const y=()=>{g(new pe(Y.WS_ABORT))};this.ws.once(lt.RECONNECTING,y),this.ws.once(lt.CLOSED,y),this.once("req_".concat(c),p),Kr(3e3).then(()=>{this.removeAllListeners("req_".concat(c)),this.ws.off(lt.RECONNECTING,y),this.ws.off(lt.CLOSED,y),g(new pe(Y.TIMEOUT,"cross channel ws request timeout"))})}),h=await u;if(!h||h.code!==200)throw new pe(Y.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(h)));return h}async connect(o){this.ws.removeAllListeners(lt.REQUEST_NEW_URLS),this.ws.on(lt.REQUEST_NEW_URLS,s=>{s(o)}),await this.ws.init(o)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(o){const s=this.requestId++;return o.requestId=s,this.ws.sendMessage(o),s}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class _Ne extends An{set state(o){o!==this._state&&(o!==fo.RELAY_STATE_FAILURE&&(this.errorCode=km.RELAY_OK),this.emit("state",o,this.errorCode),this._state=o)}get state(){return this._state}constructor(o,s,c,u,h){super(),G(this,"joinInfo",void 0),G(this,"sid",void 0),G(this,"clientId",void 0),G(this,"cancelToken",Qi.CancelToken.source()),G(this,"workerToken",void 0),G(this,"requestId",0),G(this,"signal",void 0),G(this,"prevChannelMediaConfig",void 0),G(this,"httpRetryConfig",void 0),G(this,"_resolution",void 0),G(this,"_state",fo.RELAY_STATE_IDLE),G(this,"errorCode",km.RELAY_OK),G(this,"onStatus",p=>{L.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(p))),p&&p.command&&(p.command==="onAudioPacketReceived"&&this.emit("event",Yl.PACKET_RECEIVED_AUDIO_FROM_SRC),p.command==="onVideoPacketReceived"&&this.emit("event",Yl.PACKET_RECEIVED_VIDEO_FROM_SRC),p.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=km.SRC_TOKEN_EXPIRED,this.state=fo.RELAY_STATE_FAILURE),p.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=km.DEST_TOKEN_EXPIRED,this.state=fo.RELAY_STATE_FAILURE))}),G(this,"onReconnect",async()=>{L.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",Yl.NETWORK_DISCONNECTED),this.state=fo.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(p=>{this.state!==fo.RELAY_STATE_IDLE&&(L.error("auto restart channel media relay failed",p.toString()),this.errorCode=km.SERVER_CONNECTION_LOST,this.state=fo.RELAY_STATE_FAILURE)})}),this.joinInfo=o,this.clientId=s,this.sid=sf(),this.signal=new yNe(this.joinInfo,this.clientId,c),this.httpRetryConfig=u,this._resolution=h}async startChannelMediaRelay(o){if(this.state!==fo.RELAY_STATE_IDLE)throw new pe(Y.INVALID_OPERATION);this.state=fo.RELAY_STATE_CONNECTING,await this.connect(),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(o)}catch(s){throw s.data&&s.data.serverResponse&&s.data.serverResponse.command==="SetSourceChannel"?new pe(Y.CROSS_CHANNEL_FAILED_JOIN_SRC):s.data&&s.data.serverResponse&&s.serverResponse.command==="SetDestChannelStatus"?new pe(Y.CROSS_CHANNEL_FAILED_JOIN_DEST):s.data&&s.data.serverResponse&&s.serverResponse.command==="StartPacketTransfer"?new pe(Y.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):s}this.prevChannelMediaConfig=o}async updateChannelMediaRelay(o){if(this.state!==fo.RELAY_STATE_RUNNING)throw new pe(Y.INVALID_OPERATION);await this.sendUpdateMessage(o),this.prevChannelMediaConfig=o}async setVideoProfile(o){if(this._resolution=o,this.state!==fo.RELAY_STATE_RUNNING)throw new pe(Y.INVALID_OPERATION);const s=this.genMessage(Wi.SetVideoProfile);await this.signal.request(s),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),L.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=fo.RELAY_STATE_IDLE,this.dispose()}dispose(){L.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=Qi.CancelToken.source(),this.state=fo.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const o=await Ixe(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=o.workerToken,await this.signal.connect(o.addressList),this.emit("event",Yl.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(o){const s=this.genMessage(Wi.StopPacketTransfer);await this.signal.request(s),await this.signal.waitStatus("Normal Quit"),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const c=this.genMessage(Wi.SetSdkProfile,o);await this.signal.request(c),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const u=this.genMessage(Wi.SetSourceChannel,o);await this.signal.request(u),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",Yl.PACKET_JOINED_SRC_CHANNEL),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const h=this.genMessage(Wi.SetSourceUserId,o);await this.signal.request(h),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const p=this.genMessage(Wi.SetDestChannel,o);await this.signal.request(p),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",Yl.PACKET_JOINED_DEST_CHANNEL),L.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const g=this.genMessage(Wi.StartPacketTransfer,o);await this.signal.request(g),this.emit("event",Yl.PACKET_SENT_TO_DEST_CHANNEL),this.state=fo.RELAY_STATE_RUNNING,L.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(o){const s=this.genMessage(Wi.UpdateDestChannel,o);await this.signal.request(s),this.emit("event",Yl.PACKET_UPDATE_DEST_CHANNEL),L.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const o=this.genMessage(Wi.StopPacketTransfer);await this.signal.request(o),L.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(o,s){const c=[],u=[],h=[];this.requestId+=1;const p={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:xs,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};p.sdkVersion==="4.23.4"&&(p.sdkVersion="0.0.1");let g=null,y=null;switch(o){case Wi.SetSdkProfile:return p.clientRequest={command:"SetSdkProfile",type:"multi_channel"},p;case Wi.SetSourceChannel:if(y=s&&s.getSrcChannelMediaInfo(),!y)throw new pe(Y.UNEXPECTED_ERROR,"can not find source config");return p.clientRequest={command:"SetSourceChannel",uid:"0",channelName:y.channelName,token:y.token||this.joinInfo.appId},p;case Wi.SetSourceUserId:if(y=s&&s.getSrcChannelMediaInfo(),!y)throw new pe(Y.UNEXPECTED_ERROR,"can not find source config");return p.clientRequest={command:"SetSourceUserId",uid:y.uid+""},p;case Wi.SetDestChannel:if(g=s&&s.getDestChannelMediaInfo(),!g)throw new pe(Y.UNEXPECTED_ERROR,"can not find dest config");return g.forEach(b=>{c.push(b.channelName),u.push(b.uid+""),h.push(b.token||this.joinInfo.appId)}),p.clientRequest={command:"SetDestChannel",channelName:c,uid:u,token:h},p;case Wi.StartPacketTransfer:return p.clientRequest={command:"StartPacketTransfer"},p;case Wi.Reconnect:return p.clientRequest={command:"Reconnect"},p;case Wi.StopPacketTransfer:return p.clientRequest={command:"StopPacketTransfer"},p;case Wi.UpdateDestChannel:if(g=s&&s.getDestChannelMediaInfo(),!g)throw new pe(Y.UNEXPECTED_ERROR,"can not find dest config");return g.forEach(b=>{c.push(b.channelName),u.push(b.uid+""),h.push(b.token||this.joinInfo.appId)}),p.clientRequest={command:"UpdateDestChannel",channelName:c,uid:u,token:h},p;case Wi.SetVideoProfile:p.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return p}}const ENe={name:"ChannelMediaRelay",create:function(r){return new _Ne(r.joinInfo,r.clientId,r.websocketRetryConfig||rr,r.httpRetryConfig||rr,r.resolution)}};function x9(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function q_(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?x9(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):x9(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}class bNe extends An{constructor(o,s,c,u){super(),G(this,"spec",void 0),G(this,"token",void 0),G(this,"websocket",void 0),G(this,"pingpongTimer",void 0),G(this,"reconnectMode","retry"),G(this,"serviceMode",void 0),G(this,"reqId",0),G(this,"commandReqId",0),G(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),G(this,"handleWebSocketMessage",h=>{if(!h.data)return;const p=JSON.parse(h.data);p.requestId?this.emit("@".concat(p.requestId,"-").concat(p.sid),p):(We.workerEvent(this.spec.sid,{actionType:"status",serverCode:p.code,workerType:this.serviceMode===zl.TRANSCODE?1:2}),this.emit(fd.PUBLISH_STREAM_STATUS,p))}),this.spec=s,this.token=o,this.serviceMode=u,this.websocket=new __("live-streaming",c),this.websocket.on(lt.CONNECTED,this.handleWebSocketOpen),this.websocket.on(lt.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(lt.REQUEST_NEW_URLS,(h,p)=>{oi(this,fd.REQUEST_NEW_ADDRESS).then(h).catch(p)}),this.websocket.on(lt.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(o){return this.websocket.init(o)}async request(o,s,c,u){this.reqId+=1,o==="request"&&(this.commandReqId+=1);const h=this.commandReqId,p=this.reqId;if(!p||!this.websocket)throw new pe(Y.UNEXPECTED_ERROR);const g=q_({command:o,sdkVersion:xs==="4.23.4"?"0.0.1":xs,seq:p,requestId:p,allocate:c,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},s);if(this.websocket.state==="closed")throw new pe(Y.WS_DISCONNECT);const y=()=>new De((A,x)=>{this.websocket.once(lt.CLOSED,()=>x(new pe(Y.WS_ABORT))),this.websocket.once(lt.CONNECTED,A)});this.websocket.state!=="connected"&&await y(),g.clientRequest&&(g.clientRequest.workerToken=this.token);const b=new De((A,x)=>{const B=()=>{x(new pe(Y.WS_ABORT))};this.websocket.once(lt.RECONNECTING,B),this.websocket.once(lt.CLOSED,B),this.once("@".concat(p,"-").concat(this.spec.sid),U=>{A(U)})});u&&We.workerEvent(this.spec.sid,q_(q_({},u),{},{requestId:h,actionType:"request",payload:JSON.stringify(s.clientRequest),serverCode:0,code:0}));const w=Date.now();this.websocket.sendMessage(g);let C=null;try{C=await b}catch(A){if(this.websocket.state==="closed")throw A;return await y(),await this.request(o,s,c)}return u&&We.workerEvent(this.spec.sid,q_(q_({},u),{},{requestId:h,actionType:"response",payload:JSON.stringify(C.serverResponse),serverCode:C.code,success:C.code===200,responseTime:Date.now()-w})),C.code!==200&&this.handleResponseError(C),C}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const o=xs==="4.23.4"?"0.0.1":xs;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:o,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(o){switch(o.code){case ur.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void L.warning("live stream response already exists stream");case ur.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case ur.LIVE_STREAM_RESPONSE_BAD_STREAM:case ur.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new pe(Y.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:o.code}).throw();case ur.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(o.serverResponse.command==="UnpublishStream")return;throw new pe(Y.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case ur.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new pe(Y.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:o.code}).throw();case ur.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const s=new pe(Y.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(fd.WARNING,s,o.serverResponse.url)}case ur.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const s=new pe(Y.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(fd.WARNING,s,o.serverResponse.url)}case ur.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new pe(Y.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case ur.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new pe(Y.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:o.code}).throw();case ur.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const s=new pe(Y.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(fd.WARNING,s,o.serverResponse.url)}case ur.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new pe(Y.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:o.code}).throw();case ur.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new pe(Y.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case ur.LIVE_STREAM_RESPONSE_WORKER_LOST:case ur.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(o.serverResponse.command==="UnpublishStream")return;throw new pe(Y.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case ur.ERROR_FAIL_SEND_MESSAGE:if(o.serverResponse.command==="UnpublishStream")return;if(o.serverResponse.command==="UpdateTranscoding"||o.serverResponse.command==="ControlStream")return new pe(Y.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:o.code}).throw();throw new pe(Y.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case ur.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case ur.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case ur.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case ur.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new pe(Y.LIVE_STREAMING_CDN_ERROR,"",{code:o.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(Mw)},6e3)}}function P9(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function po(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?P9(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):P9(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}class SNe extends An{constructor(o){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rr,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:rr;super(),G(this,"onLiveStreamWarning",void 0),G(this,"onLiveStreamError",void 0),G(this,"spec",void 0),G(this,"retryTimeout",1e4),G(this,"connection",void 0),G(this,"httpRetryConfig",void 0),G(this,"wsRetryConfig",void 0),G(this,"streamingTasks",new Map),G(this,"isStartingStreamingTask",!1),G(this,"taskMutex",new fi("live-streaming")),G(this,"cancelToken",Qi.CancelToken.source()),G(this,"transcodingConfig",void 0),G(this,"uapResponse",void 0),G(this,"lastTaskId",1),G(this,"statusError",new Map),this.spec=o,this.httpRetryConfig=c,this.wsRetryConfig=s}async setTranscodingConfig(o){const s=po(po({},cxe),o);s.videoCodecProfile!==66&&s.videoCodecProfile!==77&&s.videoCodecProfile!==100&&(L.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(s.videoCodecProfile," -> 100")),s.videoCodecProfile=100),s.transcodingUsers||(s.transcodingUsers=s.userConfigs),s.transcodingUsers&&(s.transcodingUsers=s.transcodingUsers.map(p=>po(po(po({},axe),p),{},{zOrder:p.zOrder?p.zOrder+1:1}))),function(p){Pn(p.width)||Qt(p.width,"config.width",0,1e4),Pn(p.height)||Qt(p.height,"config.height",0,1e4),Pn(p.videoBitrate)||Qt(p.videoBitrate,"config.videoBitrate",1,1e6),Pn(p.videoFrameRate)||Qt(p.videoFrameRate,"config.videoFrameRate"),Pn(p.lowLatency)||Gl(p.lowLatency,"config.lowLatency"),Pn(p.audioSampleRate)||yr(p.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),Pn(p.audioBitrate)||Qt(p.audioBitrate,"config.audioBitrate",1,128),Pn(p.audioChannels)||yr(p.audioChannels,"config.audioChannels",[1,2,3,4,5]),Pn(p.videoGop)||Qt(p.videoGop,"config.videoGop"),Pn(p.videoCodecProfile)||yr(p.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),Pn(p.userCount)||Qt(p.userCount,"config.userCount",0,17),Pn(p.backgroundColor)||Qt(p.backgroundColor,"config.backgroundColor",0,16777215),Pn(p.userConfigExtraInfo)||Hr(p.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),p.transcodingUsers&&!Pn(p.transcodingUsers)&&(Hl(p.transcodingUsers,"config.transcodingUsers"),p.transcodingUsers.forEach((g,y)=>{oT(g.uid),Pn(g.x)||Qt(g.x,"transcodingUser[".concat(y,"].x"),0,1e4),Pn(g.y)||Qt(g.y,"transcodingUser[".concat(y,"].y"),0,1e4),Pn(g.width)||Qt(g.width,"transcodingUser[".concat(y,"].width"),0,1e4),Pn(g.height)||Qt(g.height,"transcodingUser[".concat(y,"].height"),0,1e4),Pn(g.zOrder)||Qt(g.zOrder-1,"transcodingUser[".concat(y,"].zOrder"),0,100),Pn(g.alpha)||Qt(g.alpha,"transcodingUser[".concat(y,"].alpha"),0,1,!1)})),Pn(p.watermark)||nD(p.watermark,"watermark"),Pn(p.backgroundImage)||nD(p.backgroundImage,"backgroundImage"),p.images&&!Pn(p.images)&&(Hl(p.images,"config.images"),p.images.forEach((g,y)=>{nD(g,"images[".concat(y,"]"))}))}(s);const c=[];s.images&&c.push(...s.images.map(p=>po(po(po({},tD),p),{},{zOrder:255}))),s.backgroundImage&&(c.push(po(po(po({},tD),s.backgroundImage),{},{zOrder:0})),delete s.backgroundImage),s.watermark&&(c.push(po(po(po({},tD),s.watermark),{},{zOrder:255})),delete s.watermark),s.images=c,s.transcodingUsers&&(s.userConfigs=s.transcodingUsers.map(p=>po({},p)),s.userCount=s.transcodingUsers.length,delete s.transcodingUsers);const u=(s.userConfigs||[]).map(p=>typeof p.uid=="number"?De.resolve(p.uid):tY(p.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await De.all(u)).forEach((p,g)=>{s.userConfigs&&s.userConfigs[g]&&(s.userConfigs[g].uid=p)}),this.transcodingConfig=s,this.connection)try{var h;const p=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(xo(h=this.streamingTasks).call(h)).map(g=>g.taskId).join("#")});L.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(p.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(p){if(!p.data||!p.data.retry)throw p;p.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(g=>{L.warning("[".concat(this.spec.clientId,"] live streaming receive error"),p.toString(),"try to republish",g.url),this.startLiveStreamingTask(g.url,g.mode,p).then(()=>{L.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(g.url," success"))}).catch(y=>{L.error("[".concat(this.spec.clientId,"] live streaming republish failed"),g.url,y.toString()),this.onLiveStreamError&&this.onLiveStreamError(g.url,y)})})}}async startLiveStreamingTask(o,s,c){if(!this.transcodingConfig&&s===zl.TRANSCODE)throw new pe(Y.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");const u={command:"PublishStream",ts:Date.now(),url:o,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};L.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(o,", mode: ").concat(s));const h=await this.taskMutex.lock();if(!this.connection&&c)return void h();if(this.streamingTasks.get(o)&&!c)return h(),new pe(Y.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(s))}catch(g){throw h(),g}switch(s){case zl.TRANSCODE:u.transcodingConfig=po({},this.transcodingConfig)}this.uapResponse&&this.uapResponse.vid&&(u.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const p=this.lastTaskId++;try{const g=new De((b,w)=>{Kr(this.retryTimeout).then(()=>{if(c)return w(c);const C=this.statusError.get(o);return C?(this.statusError.delete(o),w(C)):void 0})}),y=await De.race([this.connection.request("request",{clientRequest:u},!0,{url:o,command:"PublishStream",workerType:s===zl.TRANSCODE?1:2,requestByUser:!c,tid:p.toString()}),g]);this.isStartingStreamingTask=!1,L.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(y.code)),this.streamingTasks.set(o,{clientRequest:u,mode:s,url:o,taskId:p}),h()}catch(g){if(h(),this.isStartingStreamingTask=!1,!g.data||!g.data.retry||c)throw g;return g.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(o,s,g)):await this.startLiveStreamingTask(o,s,g)}}stopLiveStreamingTask(o){return new De((s,c)=>{const u=this.streamingTasks.get(o);if(!u||!this.connection)return new pe(Y.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const h=u.mode;u.abortTask=()=>{L.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(o),s()},this.connection.request("request",{clientRequest:{command:"UnpublishStream",url:u.url}},!1,{url:o,command:"UnPublishStream",workerType:h===zl.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(p=>{L.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(p.code)),this.streamingTasks.delete(o),this.streamingTasks.size===0&&(this.connection&&this.connection.close(),this.connection=void 0),s()}).catch(c)})}resetAllTask(){var o;const s=Array.from(xo(o=this.streamingTasks).call(o));this.terminate();for(const c of s)this.startLiveStreamingTask(c.url,c.mode).catch(u=>{this.onLiveStreamError&&this.onLiveStreamError(c.url,u)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=Qi.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(o){if(this.connection)throw new pe(Y.UNEXPECTED_ERROR,"live streaming connection has already connected");const s=await oi(this,rD.REQUEST_WORKER_MANAGER_LIST,o);return this.uapResponse=s,this.connection=new bNe(s.workerToken,this.spec,this.wsRetryConfig,o),this.connection.on(fd.WARNING,(c,u)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(u,c)),this.connection.on(fd.PUBLISH_STREAM_STATUS,c=>this.handlePublishStreamServer(c)),this.connection.on(fd.REQUEST_NEW_ADDRESS,(c,u)=>{if(!this.connection)return u(new pe(Y.UNEXPECTED_ERROR,"can not get new live streaming address list"));oi(this,rD.REQUEST_WORKER_MANAGER_LIST,o).then(h=>{this.uapResponse=h,c(h.addressList)}).catch(u)}),await this.connection.init(s.addressList),this.connection}handlePublishStreamServer(o){const s=o.serverStatus&&o.serverStatus.url||"empty_url",c=this.streamingTasks.get(s),u=o.reason;switch(o.code){case ur.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case ur.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case ur.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case ur.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const p=new pe(Y.LIVE_STREAMING_CDN_ERROR,"",{code:o.code});if(c)return L.error(p.toString()),this.onLiveStreamError&&this.onLiveStreamError(s,p);if(!this.isStartingStreamingTask)return;this.statusError.set(s,p)}case ur.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const p=new pe(Y.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,u);return this.onLiveStreamWarning&&this.onLiveStreamWarning(s,p)}case ur.LIVE_STREAM_RESPONSE_WORKER_LOST:case ur.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var h;if(!this.connection)return;this.connection.tryNextAddress();const p=Array.from(xo(h=this.streamingTasks).call(h));for(const g of p)g.abortTask?g.abortTask():(L.warning("[".concat(this.spec.clientId,"] publish stream status code"),o.code,"try to republish",g.url),this.startLiveStreamingTask(g.url,g.mode,new pe(Y.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:o.code})).then(()=>{L.debug("[".concat(this.spec.clientId,"] republish live stream success"),g.url)}).catch(y=>{L.error(y.toString()),this.onLiveStreamError&&this.onLiveStreamError(g.url,y)}));return}}}hasUrl(o){return this.streamingTasks.has(o)}}const wNe={name:"LiveStreaming",create:function(r){return new SNe(r.joinInfo,r.websocketRetryConfig||rr,r.httpRetryConfig||rr)}};function TNe(r){let o=k9();return function(s,c){let u=s.appId;u!==void 0&&(zt(c,10),al(c,u));let h=s.cid;h!==void 0&&(zt(c,16),zt(c,h));let p=s.cname;p!==void 0&&(zt(c,26),al(c,p));let g=s.deviceId;g!==void 0&&(zt(c,34),al(c,g));let y=s.elapse;y!==void 0&&(zt(c,40),Ad(c,y));let b=s.fileSize;b!==void 0&&(zt(c,48),Ad(c,Jm(b)));let w=s.height;w!==void 0&&(zt(c,56),Ad(c,Jm(w)));let C=s.jpg;C!==void 0&&(zt(c,66),zt(c,C.length),function(ro,be){let Oe=Qm(ro,be.length);ro.bytes.set(be,Oe)}(c,C));let A=s.networkType;A!==void 0&&(zt(c,72),Ad(c,Jm(A)));let x=s.osType;x!==void 0&&(zt(c,80),Ad(c,Jm(x)));let B=s.requestId;B!==void 0&&(zt(c,90),al(c,B));let U=s.sdkVersion;U!==void 0&&(zt(c,98),al(c,U));let F=s.sequence;F!==void 0&&(zt(c,104),Ad(c,Jm(F)));let K=s.sid;K!==void 0&&(zt(c,114),al(c,K));let z=s.timestamp;z!==void 0&&(zt(c,120),Ad(c,z));let Q=s.uid;Q!==void 0&&(zt(c,128),zt(c,Q));let ie=s.vid;ie!==void 0&&(zt(c,136),zt(c,ie));let oe=s.width;oe!==void 0&&(zt(c,144),Ad(c,Jm(oe)));let re=s.service;re!==void 0&&(zt(c,152),zt(c,re));let me=s.callbackData;me!==void 0&&(zt(c,162),al(c,me));let Ee=s.jpgEncryption;Ee!==void 0&&(zt(c,168),zt(c,Ee));let xe=s.requestType;xe!==void 0&&(zt(c,176),zt(c,xe));let Me=s.scorePorn;Me!==void 0&&(zt(c,185),sk(c,Me));let pt=s.scoreSexy;pt!==void 0&&(zt(c,193),sk(c,pt));let ut=s.scoreNeutral;ut!==void 0&&(zt(c,201),sk(c,ut));let nt=s.scene;nt!==void 0&&(zt(c,208),zt(c,nt));let hn=s.ossFilePrefix;hn!==void 0&&(zt(c,218),al(c,hn));let en=s.serviceVendor;if(en!==void 0)for(let ro of en){zt(c,226);let be=k9();ANe(ro,be),zt(c,be.limit),PNe(c,be),xNe(be)}}(r,o),function(s){let c=s.bytes,u=s.limit;return c.length===u?c:c.subarray(0,u)}(o)}function CNe(r){return function(s){let c={};e:for(;!L9(s);){let u=cl(s);switch(u>>>3){case 0:break e;case 1:c.code=cl(s);break;case 2:c.msg=M9(s,cl(s));break;case 3:{let h=ONe(s);c.data=RNe(s),s.limit=h;break}default:N9(s,7&u)}}return c}({bytes:o=r,offset:0,limit:o.length});var o}function RNe(r){let o={};e:for(;!L9(r);){let s=cl(r);switch(s>>>3){case 0:break e;case 1:o.requestId=M9(r,cl(r));break;case 2:o.requestType=cl(r)>>>0;break;case 3:o.scorePorn=ok(r);break;case 4:o.scoreSexy=ok(r);break;case 5:o.scoreNeutral=ok(r);break;case 6:o.requestScene=cl(r)>>>0;break;case 7:o.scene=cl(r)>>>0;break;default:N9(r,7&s)}}return o}function ANe(r,o){let s=r.service;s!==void 0&&(zt(o,8),zt(o,s));let c=r.vendor;c!==void 0&&(zt(o,16),zt(o,c));let u=r.token;u!==void 0&&(zt(o,26),al(o,u));let h=r.callbackUrl;h!==void 0&&(zt(o,34),al(o,h))}function ONe(r){let o=cl(r),s=r.limit;return r.limit=r.offset+o,s}function N9(r,o){switch(o){case 0:for(;128&j9(r););break;case 2:rk(r,cl(r));break;case 5:rk(r,4);break;case 1:rk(r,8);break;default:throw new Error("Unimplemented type: "+o)}}let INe=new Float32Array(1);new Uint8Array(INe.buffer);let nk=new Float64Array(1),mo=new Uint8Array(nk.buffer);function Jm(r){return{low:r|=0,high:r>>31,unsigned:r>=0}}let D9=[];function k9(){const r=D9.pop();return r?(r.offset=r.limit=0,r):{bytes:new Uint8Array(64),offset:0,limit:0}}function xNe(r){D9.push(r)}function rk(r,o){if(r.offset+o>r.limit)throw new Error("Skip past limit");r.offset+=o}function L9(r){return r.offset>=r.limit}function Qm(r,o){let s=r.bytes,c=r.offset,u=r.limit,h=c+o;if(h>s.length){let p=new Uint8Array(2*h);p.set(s),r.bytes=p}return r.offset=h,h>u&&(r.limit=h),c}function ik(r,o){let s=r.offset;if(s+o>r.limit)throw new Error("Read past limit");return r.offset+=o,s}function M9(r,o){let s=ik(r,o),c=String.fromCharCode,u=r.bytes,h="�",p="";for(let g=0;g<o;g++){let y,b,w,C,A=u[g+s];128&A?(224&A)==192?g+1>=o?p+=h:(y=u[g+s+1],(192&y)!=128?p+=h:(C=(31&A)<<6|63&y,C<128?p+=h:(p+=c(C),g++))):(240&A)==224?g+2>=o?p+=h:(y=u[g+s+1],b=u[g+s+2],(49344&(y|b<<8))!=32896?p+=h:(C=(15&A)<<12|(63&y)<<6|63&b,C<2048||C>=55296&&C<=57343?p+=h:(p+=c(C),g+=2))):(248&A)==240?g+3>=o?p+=h:(y=u[g+s+1],b=u[g+s+2],w=u[g+s+3],(12632256&(y|b<<8|w<<16))!=8421504?p+=h:(C=(7&A)<<18|(63&y)<<12|(63&b)<<6|63&w,C<65536||C>1114111?p+=h:(C-=65536,p+=c(55296+(C>>10),56320+(1023&C)),g+=3))):p+=h:p+=c(A)}return p}function al(r,o){let s=o.length,c=0;for(let p=0;p<s;p++){let g=o.charCodeAt(p);g>=55296&&g<=56319&&p+1<s&&(g=(g<<10)+o.charCodeAt(++p)-56613888),c+=g<128?1:g<2048?2:g<65536?3:4}zt(r,c);let u=Qm(r,c),h=r.bytes;for(let p=0;p<s;p++){let g=o.charCodeAt(p);g>=55296&&g<=56319&&p+1<s&&(g=(g<<10)+o.charCodeAt(++p)-56613888),g<128?h[u++]=g:(g<2048?h[u++]=g>>6&31|192:(g<65536?h[u++]=g>>12&15|224:(h[u++]=g>>18&7|240,h[u++]=g>>12&63|128),h[u++]=g>>6&63|128),h[u++]=63&g|128)}}function PNe(r,o){let s=Qm(r,o.limit),c=r.bytes,u=o.bytes;for(let h=0,p=o.limit;h<p;h++)c[h+s]=u[h]}function j9(r){return r.bytes[ik(r,1)]}function U9(r,o){let s=Qm(r,1);r.bytes[s]=o}function ok(r){let o=ik(r,8),s=r.bytes;return mo[0]=s[o++],mo[1]=s[o++],mo[2]=s[o++],mo[3]=s[o++],mo[4]=s[o++],mo[5]=s[o++],mo[6]=s[o++],mo[7]=s[o++],nk[0]}function sk(r,o){let s=Qm(r,8),c=r.bytes;nk[0]=o,c[s++]=mo[0],c[s++]=mo[1],c[s++]=mo[2],c[s++]=mo[3],c[s++]=mo[4],c[s++]=mo[5],c[s++]=mo[6],c[s++]=mo[7]}function cl(r){let o,s=0,c=0;do o=j9(r),s<32&&(c|=(127&o)<<s),s+=7;while(128&o);return c}function zt(r,o){for(o>>>=0;o>=128;)U9(r,127&o|128),o>>>=7;U9(r,o)}function Ad(r,o){let s=o.low>>>0,c=(o.low>>>28|o.high<<4)>>>0,u=o.high>>>24,h=u===0?c===0?s<16384?s<128?1:2:s<1<<21?3:4:c<16384?c<128?5:6:c<1<<21?7:8:u<128?9:10,p=Qm(r,h),g=r.bytes;switch(h){case 10:g[p+9]=u>>>7&1;case 9:g[p+8]=h!==9?128|u:127&u;case 8:g[p+7]=h!==8?c>>>21|128:c>>>21&127;case 7:g[p+6]=h!==7?c>>>14|128:c>>>14&127;case 6:g[p+5]=h!==6?c>>>7|128:c>>>7&127;case 5:g[p+4]=h!==5?128|c:127&c;case 4:g[p+3]=h!==4?s>>>21|128:s>>>21&127;case 3:g[p+2]=h!==3?s>>>14|128:s>>>14&127;case 2:g[p+1]=h!==2?s>>>7|128:s>>>7&127;case 1:g[p]=h!==1?128|s:127&s}}function V9(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}const NNe=new Map([["moderation",1],["supervise",2]]);class DNe extends An{get connectionState(){return this._connectionState}set connectionState(o){if(this._connectionState===o)return;const s=this._connectionState;this._connectionState=o,this.emit(Ur.CONNECTION_STATE_CHANGE,s,o)}get inspectType(){return this._inspectType}set inspectType(o){var s;this._inspectMode=oa(s=o.map(c=>NNe.get(c)||0)).call(s,(c,u)=>c+u),this._inspectType=o}get quality(){return this._quality}set quality(o){this._quality=o>1?1:o<.1?.1:o,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(o){super(),G(this,"name","AgoraRTCVideoContentInspect"),G(this,"_connectionState",va.CONNECTING),G(this,"_innerConnectionState",void 0),G(this,"sequence",0),G(this,"inspectStartTime",void 0),G(this,"workerManagerConnection",void 0),G(this,"workerConnection",void 0),G(this,"workerMessageLengthLimit",void 0),G(this,"inspectIntervalMinimum",void 0),G(this,"qualityRatio",void 0),G(this,"_connectInfo",void 0),G(this,"_cancelTokenSource",Qi.CancelToken.source()),G(this,"_retryConfig",void 0),G(this,"wmSequence",0),G(this,"inspectInterval",void 0),G(this,"inspectTimer",null),G(this,"ossFilePrefix",void 0),G(this,"extraInfo",void 0),G(this,"_inspectType",void 0),G(this,"_inspectMode",void 0),G(this,"_quality",1),G(this,"qualityTimer",null),G(this,"_inspectId",void 0),G(this,"_needWorkUrlOnly",!1),G(this,"inspectImage",()=>{if(this.connectionState!==va.CONNECTED)throw new pe(Y.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===va.CONNECTED?this.requestToInspectImage():L.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=cn(5,"inspect-"),this.workerMessageLengthLimit=q("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=q("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=q("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=o.interval,this.ossFilePrefix=o.ossFilePrefix,this.extraInfo=o.extraInfo,this.inspectType=o.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new __("worker-manager-"+this._inspectId,rr),this.on(Ur.STATE_CHANGE,(s,c)=>{this._innerConnectionState=s,L.debug("[".concat(this._inspectId,"] Inspect operation :").concat(ya[s]," ").concat(c||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new __("worker-"+this._inspectId,rr),this.handleWorkerEvents()}async init(o,s){this.emit(Ur.STATE_CHANGE,ya.CONNECT_AP),this._connectInfo=o;const c=this._cancelTokenSource.token;return this._retryConfig=s,new De((u,h)=>{this.on(Ur.CONNECTION_STATE_CHANGE,(p,g)=>{g===va.CONNECTED&&u()}),this.requestAP(o,c,s).then(p=>{this.connectWorkerManager(p)}).catch(p=>{h(p)})})}async requestAP(o,s,c){const u=q("WEBCS_DOMAIN").map(g=>"https://".concat(g,"/api/v1")),h=await function(g,y,b,w){let{appId:C,areaCode:A,cname:x,sid:B,token:U,uid:F}=y;Bm++;const K="image_moderation_api",z={service_name:K,json_body:JSON.stringify({appId:C,areaCode:A,cname:x,command:"allocateEdge",requestId:Bm,seq:Bm,sid:B,token:U,ts:Date.now(),uid:F+""})};let Q,ie,oe=g[0];return nc(async()=>{Q=Date.now();const re=await ac(oe,{data:z,cancelToken:b,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(ie=Date.now()-Q,re.code!==0){const Me=new pe(Y.UNEXPECTED_RESPONSE,"image inspect ap error, code"+re.code,{retry:!0,responseTime:ie});throw L.error(Me.toString()),Me}const me=JSON.parse(re.json_body);if(me.code!==200){const Me=new pe(Y.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(me.code,", reason: ").concat(me.reason),{code:me.code,responseTime:ie});throw L.error(Me.toString()),Me}if(!me.servers||!Array.isArray(me.servers)||me.servers.length===0){const Me=new pe(Y.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:me.code,responseTime:ie});throw L.error(Me.toString()),Me}const Ee=q("VIDEO_INSPECT_WORKER_MANAGER_HOST"),xe=q("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:me.servers.map(Me=>{let{address:pt,wss:ut}=Me;if(pt&&ut)return"wss://".concat(pt.replace(/\./g,"-"),".").concat(Ee,":").concat(xe||ut)}).filter(Me=>!!Me),workerToken:me.workerToken,vid:me.vid,responseTime:ie}},(re,me)=>(We.apworkerEvent(B,{success:!0,sc:200,serviceName:K,responseDetail:JSON.stringify(re.addressList),firstSuccess:me===0,responseTime:ie,serverIp:g[me%g.length]}),!1),(re,me)=>(We.apworkerEvent(B,{success:!1,sc:re.data&&re.data.code||200,serviceName:K,responseTime:ie,serverIp:g[me%g.length]}),!!(re.code!==Y.OPERATION_ABORTED&&re.code!==Y.UNEXPECTED_RESPONSE||re.data&&re.data.retry)&&(oe=g[(me+1)%g.length],!0)),w)}(u,o,s,c);this.emit(Ur.STATE_CHANGE,ya.AP_CONNECTED);const{addressList:p}=h;return this.wmSequence++,p}async connectWorkerManager(o){let s=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=s,this.emit(Ur.STATE_CHANGE,ya.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(o,1e4)}async connectWorker(o){await this.workerConnection.init([o])}handleWorkerManagerEvents(){this.workerManagerConnection.on(lt.CONNECTED,async()=>{this.emit(Ur.STATE_CHANGE,ya.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.23.4",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(lt.CLOSED,()=>{this._innerConnectionState<ya.GET_WORKER_MANAGER_RESPONSE&&L.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(lt.FAILED,()=>{this._innerConnectionState<ya.GET_WORKER_MANAGER_RESPONSE&&L.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(lt.RECONNECTING,()=>{this._innerConnectionState<ya.GET_WORKER_MANAGER_RESPONSE&&L.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(lt.ON_MESSAGE,async o=>{this.emit(Ur.STATE_CHANGE,ya.GET_WORKER_MANAGER_RESPONSE);const s=this.workerManagerConnection.url;this.workerManagerConnection.close();const c=JSON.parse(o.data);if(c.code!==200)throw L.error("[".concat(this._inspectId,"] Unexpected code ").concat(c.code," from worker manager")),new pe(Y.UNEXPECTED_RESPONSE,"response code of worker is unexpected",c);if(!(c.serverResponse&&c.serverResponse.portWss&&s))throw L.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(c))),new pe(Y.UNEXPECTED_RESPONSE,"response content of worker is unexpected",c);{const u=q("VIDEO_INSPECT_WORKER_PORT")||c.serverResponse.portWss,h=s.replace(/:\d+\/?$/,":".concat(u));this.emit(Ur.STATE_CHANGE,ya.CONNECT_WORKER,h),this._needWorkUrlOnly?this.emit(Ur.REQUEST_NEW_WORKER_URL,h):await this.connectWorker(h)}}),this.workerManagerConnection.on(lt.WILL_RECONNECT,(o,s,c)=>{c(o)}),this.workerManagerConnection.on(lt.REQUEST_NEW_URLS,(o,s)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(o).catch(s)})}handleWorkerEvents(){this.workerConnection.on(lt.CONNECTED,async()=>{this.emit(Ur.STATE_CHANGE,ya.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=va.CONNECTED}),this.workerConnection.on(lt.ON_MESSAGE,async o=>{if(o.data instanceof ArrayBuffer){const c=CNe(new Uint8Array(o.data));if(q("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&L.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(c)),c.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(Ur.INSPECT_RESULT,void 0,void 0);if(c.data&&c.data.scorePorn&&c.data.scoreSexy&&c.data.scoreNeutral){var s;const u={porn:c.data.scorePorn,sexy:c.data.scoreSexy,neutral:c.data.scoreNeutral},h=oa(s=Object.keys(u)).call(s,(g,y)=>u[g]>u[y]?g:y,"porn"),p=Object.keys(u).find(g=>g===h);this.emit(Ur.INSPECT_RESULT,p)}else this.emit(Ur.INSPECT_RESULT,void 0,new pe(Y.UNEXPECTED_RESPONSE,c.code+"","There is an unexpected data on message"))}else this.emit(Ur.INSPECT_RESULT,void 0,new pe(Y.UNEXPECTED_RESPONSE,c.code+"",c.msg))}else L.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(Ur.INSPECT_RESULT,void 0,new pe(Y.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(lt.CLOSED,()=>{this.connectionState=va.CLOSED}),this.workerConnection.on(lt.FAILED,()=>{this.connectionState=va.CLOSED}),this.workerConnection.on(lt.RECONNECTING,()=>{this.connectionState=this.connectionState===va.CONNECTED?va.RECONNECTING:va.CONNECTING}),this.workerConnection.on(lt.WILL_RECONNECT,(o,s,c)=>{o==="recover"&&c(o),c("tryNext")}),this.workerConnection.on(lt.REQUEST_NEW_URLS,(o,s)=>{this.workerManagerConnection.close(),this.once(Ur.REQUEST_NEW_WORKER_URL,c=>{o([c])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(c=>{this.connectWorkerManager(c,!0)}).catch(c=>{s(c)})})}async requestToInspectImage(){this.sequence++;const o=Zo(this,Ur.CLIENT_LOCAL_VIDEO_TRACK),s={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(o){if(!o.isPlaying)return void this.emit(Ur.INSPECT_RESULT,void 0,new pe(Y.INVALID_OPERATION,"Only the track being played can be inspected"));const c=await this.generateRequestData(o,s);this.workerConnection.sendMessage(c,!0,!0)}else this.emit(Ur.INSPECT_RESULT,void 0,new pe(Y.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(o,s){let{appId:c,cname:u,cid:h,vid:p,sid:g,uid:y}=s;const b=Date.now(),w=await o.getCurrentFrameImage("image/jpeg",this.quality),C=await bH(w,c,u),A=this.sequence+"-"+h+"-"+y+"-"+b+"-"+cn(12,""),x={appId:c,cid:h,cname:u,deviceId:"",elapse:(B=Number(b-this.inspectStartTime),{low:B|=0,high:B>>31,unsigned:B>=0}),fileSize:C.byteLength,jpgEncryption:2,height:w.height,width:w.width,jpg:C,networkType:6,osType:7,requestId:A,sdkVersion:"4.23.4",sequence:this.sequence,sid:g,timestamp:zY(b),uid:y,vid:p,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};var B;this.extraInfo===void 0&&delete x.callbackData,this.ossFilePrefix===void 0&&delete x.ossFilePrefix;const U=TNe(x);if(U.byteLength<this.workerMessageLengthLimit){if(q("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const F=function(K){for(var z=1;z<arguments.length;z++){var Q=arguments[z]!=null?arguments[z]:{};z%2?V9(Object(Q),!0).forEach(function(ie){G(K,ie,Q[ie])}):Object.getOwnPropertyDescriptors?Object.defineProperties(K,Object.getOwnPropertyDescriptors(Q)):V9(Object(Q)).forEach(function(ie){Object.defineProperty(K,ie,Object.getOwnPropertyDescriptor(Q,ie))})}return K}({},x);delete F.jpg,L.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(F))}return U}{const F=this.quality*this.qualityRatio;return this.quality=F,await this.generateRequestData(o,{appId:c,cname:u,cid:h,vid:p,sid:g,uid:y})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=Qi.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=va.CLOSED,this.emit(Ur.STATE_CHANGE,ya.CLOSED)}}const kNe={name:"ContentInspect",create:function(r){let{config:o}=r;return function(s){if(!s)throw new pe(Y.INVALID_PARAMS,"inspectConfig is necessary.");if(!s.inspectType||!Array.isArray(s.inspectType))throw new pe(Y.INVALID_PARAMS,"inspectConfig.inspectType is necessary and is an instance of Array.");{const c=[...new Set(s.inspectType)];c.forEach(u=>{var h;if(!Pe(h=["supervise","moderation"]).call(h,u))throw new pe(Y.INVALID_PARAMS,"".concat(u," is not a valid inspect type."))}),s.inspectType=c}if(s&&s.extraInfo&&s.extraInfo.length>1024)throw new pe(Y.INVALID_PARAMS,"inspectConfig.extraInfo length cannot exceed 1024 bytes")}(o),new DNe(o)}};var F9=a(ar.Object.getOwnPropertySymbols),LNe=Kt,MNe=wx.indexOf,jNe=s0,ak=le([].indexOf),B9=!!ak&&1/ak([1],1,-0)<0;LNe({target:"Array",proto:!0,forced:B9||!jNe("indexOf")},{indexOf:function(r){var o=arguments.length>1?arguments[1]:void 0;return B9?ak(this,r,o)||0:MNe(this,r,o)}});var UNe=ia("Array","indexOf"),VNe=T,FNe=UNe,ck=Array.prototype,BNe=function(r){var o=r.indexOf;return r===ck||VNe(ck,r)&&o===ck.indexOf?FNe:o},$9=a(BNe);function $Ne(r,o){if(r==null)return{};var s,c,u=function(p,g){if(p==null)return{};var y={};for(var b in p)if({}.hasOwnProperty.call(p,b)){if($9(g).call(g,b)!==-1)continue;y[b]=p[b]}return y}(r,o);if(F9){var h=F9(r);for(c=0;c<h.length;c++)s=h[c],$9(o).call(o,s)===-1&&{}.propertyIsEnumerable.call(r,s)&&(u[s]=r[s])}return u}let W9=class{get localCapabilities(){return On(this._localCapabilities)}get rtpCapabilities(){return On(this._rtpCapabilities)}get candidates(){return On(this._candidates)}get iceParameters(){return On(this._iceParameters)}get dtlsParameters(){return On(this._dtlsParameters)}constructor(r){G(this,"sessionDesc",void 0),G(this,"_localCapabilities",void 0),G(this,"_rtpCapabilities",void 0),G(this,"_candidates",void 0),G(this,"_iceParameters",void 0),G(this,"_dtlsParameters",void 0),G(this,"setup",void 0),G(this,"currentMidIndex",void 0),G(this,"cname","o/i14u9pJrxRKAsu"),G(this,"firefoxSsrcMidMap",new Map),r=On(r);const{remoteIceParameters:o,remoteDtlsParameters:s,candidates:c,remoteRTPCapabilities:u,localCapabilities:h,direction:p,setup:g,videoCodec:y,audioCodec:b}=r;let w;this.setup=g,w=p===$i.RECEIVE_ONLY?ho(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`):ho(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=extmap-allow-mixed
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=recvonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`),this._rtpCapabilities=u,this._candidates=c,this._iceParameters=o,this._dtlsParameters=s,this._localCapabilities=h;const C=p===$i.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,A=p===$i.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,x=p===$i.RECEIVE_ONLY?u.send.videoCodecs:S_(je.VIDEO,C,A,y),B=p===$i.RECEIVE_ONLY?u.send.audioCodecs:S_(je.AUDIO,C,A,b);for(const U of w.mediaDescriptions)U.attributes.iceUfrag=o.iceUfrag,U.attributes.icePwd=o.icePwd,U.attributes.fingerprints=s.fingerprints,U.attributes.candidates=c,U.attributes.setup=this.setup,U.media.mediaType==="application"&&(U.attributes.sctpPort="5000"),U.media.mediaType==="video"&&(U.media.fmts=x.map(F=>F.payloadType.toString(10)),U.attributes.payloads=x,U.attributes.extmaps=C.videoExtensions),U.media.mediaType==="audio"&&(U.media.fmts=B.map(F=>F.payloadType.toString(10)),U.attributes.payloads=B,U.attributes.extmaps=C.audioExtensions,Fm(U));this.sessionDesc=w,this.currentMidIndex=w.mediaDescriptions.length-1}toString(){return hd(this.sessionDesc)}hasMid(r){return Array.isArray(r)?r.every(o=>this.hasMid(o)):this.sessionDesc.mediaDescriptions.some(o=>o.attributes.mid===r)}send(r,o,s,c,u){s=s.replace(/ /g,"-");const{ssrcs:h,ssrcGroups:p}=mf(o,this.cname,q("SYNC_GROUP")?s:void 0),g=this.findPreloadMediaDesc(h);if(g){if(xn()&&this.firefoxSsrcMidMap.set(h[0].ssrcId,g.attributes.mid),u&&(u.twcc||u.remb)){const y=this.sessionDesc.mediaDescriptions.indexOf(g);return this.sessionDesc.mediaDescriptions[y]=this.mungSendMediaDesc(g,u),{mid:g.attributes.mid,needExchangeSDP:!0}}return{mid:g.attributes.mid,needExchangeSDP:!1}}{const y=this.findAvailableMediaIndex(r,h,c);let b;return y===-1?(b=this.createOrRecycleSendMedia(r,h,p,"sendonly",c,u),this.updateBundleMids()):(b=On(this.sessionDesc.mediaDescriptions[y]),b.attributes.direction="sendonly",b.attributes.ssrcs=h,b.attributes.ssrcGroups=p,this.sessionDesc.mediaDescriptions[y]=this.mungSendMediaDesc(b,u)),xn()&&this.firefoxSsrcMidMap.set(h[0].ssrcId,b.attributes.mid),{needExchangeSDP:!0,mid:b.attributes.mid}}}stopSending(r){const o=this.sessionDesc.mediaDescriptions.filter(s=>s.attributes.mid&&r.indexOf(s.attributes.mid)!==-1);if(o.length!==r.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");o.forEach(s=>{s.attributes.ssrcs=[]}),this.updateBundleMids()}receive(r,o,s){const c=[];return r.forEach(u=>{const h=u._mediaStreamTrack.kind,p=this.findAvailableRecvMediaIndex(h);let g,y=!1;p===-1?(y=!0,g=this.createOrRecycleRecvMedia(u,[],"recvonly",o,s),this.updateBundleMids()):(g=On(this.sessionDesc.mediaDescriptions[p]),g.attributes.direction="recvonly"),c.push({mid:g.attributes.mid,needCreateTransceiver:y})}),c}stopReceiving(r){const o=this.sessionDesc.mediaDescriptions.filter(s=>r.indexOf(s.attributes.mid)!==-1);if(o.length!==r.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");o.forEach(s=>{s.media.port="0",s.attributes.direction="inactive"}),this.updateBundleMids()}addRemoteCandidate(r){const{foundation:o,protocol:s,address:c,port:u,type:h,relatedAddress:p,relatedPort:g,priority:y}=new RTCIceCandidate(r),b={foundation:o??"",componentId:"1",transport:s??"",priority:y?y+"":"",connectionAddress:c??"",port:u?u+"":"",type:h?h+"":"",relAddr:p??"",relPort:g?g+"":"",extension:{}};this.candidates.some(w=>w.priority===b.priority&&w.connectionAddress===b.connectionAddress&&w.port===b.port)||(this._candidates.push(b),this.sessionDesc.mediaDescriptions.forEach(w=>{w.attributes.candidates=this.candidates}))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(r,o,s,c,u){const h=r._mediaStreamTrack.kind,p=this.rtpCapabilities.recv,g=S_(h,p,this.localCapabilities.send,h===je.AUDIO?u:c),y=h===je.VIDEO?p.videoExtensions:p.audioExtensions,b="".concat(++this.currentMidIndex);let w={media:{mediaType:h,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:g.map(A=>A.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:y,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:o,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:g,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:s,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(b)}};w=this.mungRecvMediaDsec(w,r);const C=this.findFirstClosedMedia(h);if(C){const A=this.sessionDesc.mediaDescriptions.indexOf(C);this.sessionDesc.mediaDescriptions[A]=w}else this.sessionDesc.mediaDescriptions.push(w);return w}muteRemote(r){const o=this.sessionDesc.mediaDescriptions.filter(s=>Pe(r).call(r,s.attributes.mid||""));if(o.length!==r.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");o.forEach(s=>{s.attributes.direction="inactive"})}unmuteRemote(r){const o=this.sessionDesc.mediaDescriptions.filter(s=>Pe(r).call(r,s.attributes.mid||""));if(o.length!==r.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");o.forEach(s=>{s.attributes.direction="recvonly"})}findAvailableMediaIndex(r,o,s){return this.sessionDesc.mediaDescriptions.findIndex(c=>{const u=c.media.mediaType===r&&c.media.port!=="0"&&(c.attributes.direction==="sendonly"||c.attributes.direction==="sendrecv")&&c.attributes.ssrcs.length===0;if(xn()){if(u){const h=this.firefoxSsrcMidMap.get(o[0].ssrcId);return!(h||c.attributes.mid!=="0"&&c.attributes.mid!=="1")||!(!h||h!==c.attributes.mid)}return!1}return u&&c.attributes.mid===s})}findAvailableRecvMediaIndex(r){return this.sessionDesc.mediaDescriptions.findIndex(o=>{const s=o.media.mediaType===r&&o.media.port!=="0"&&(o.attributes.direction==="recvonly"||o.attributes.direction==="sendrecv");return o.attributes.mid!=="0"&&o.attributes.mid!=="1"&&s})}predictReceivingMids(r){const o=[];for(let s=0;s<r;s++)o.push((this.currentMidIndex+s+1).toString(10));return o}restartICE(r){r=On(r),this._iceParameters=r,this.sessionDesc.mediaDescriptions.forEach(o=>{o.attributes.iceUfrag=r.iceUfrag,o.attributes.icePwd=r.icePwd})}createOrRecycleSendMedia(r,o,s,c,u,h){const p=this.rtpCapabilities.send,g=r===je.VIDEO?p.videoCodecs:p.audioCodecs,y=r===je.VIDEO?p.videoExtensions:p.audioExtensions;xn()&&(u="".concat(++this.currentMidIndex));let b={media:{mediaType:r,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:g.map(C=>C.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:y,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:o,ssrcGroups:s,rtcpFeedbackWildcards:[],payloads:g,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:c,rtcpMux:!0,rtcpRsize:!0,mid:u}};b=this.mungSendMediaDesc(b,h);const w=this.findFirstClosedMedia(r);if(w){const C=this.sessionDesc.mediaDescriptions.indexOf(w);this.sessionDesc.mediaDescriptions[C]=b}else this.sessionDesc.mediaDescriptions.push(b);return b}mungRecvMediaDsec(r,o,s){const c=On(r);return lD(c),Vm(c,o),uD(c,o),Lz(c),hT(c,s,this.localCapabilities.send),c}mungSendMediaDesc(r,o){const s=On(r);return hT(s,o,this.localCapabilities.recv),Fm(s),s}updateRecvMedia(r,o){const s=this.sessionDesc.mediaDescriptions.findIndex(c=>c.attributes.mid===r);if(s!==-1){const c=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[s],o);this.sessionDesc.mediaDescriptions[s]=c}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(r=>r.media.port!=="0").map(r=>r.attributes.mid)}findPreloadMediaDesc(r){return this.sessionDesc.mediaDescriptions.find(o=>{var s;return((s=o.attributes)===null||s===void 0||(s=s.ssrcs[0])===null||s===void 0?void 0:s.ssrcId)===r[0].ssrcId})}findFirstClosedMedia(r){return this.sessionDesc.mediaDescriptions.find(o=>xn()?o.media.port==="0"&&o.media.mediaType===r:o.media.port==="0")}};const WNe=["sdp"];var mn;function G9(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function Od(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?G9(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):G9(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}let H9=(mn=class pg extends vz{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var o,s;return(o=(s=this.peerConnection.getReceivers()[0])===null||s===void 0||(s=s.transport)===null||s===void 0?void 0:s.state)!==null&&o!==void 0?o:null}get localCodecs(){return[]}set isInRestartIce(o){this._isInRestartIce=o}get isInRestartIce(){return this._isInRestartIce}constructor(o,s,c){super(o,s),G(this,"direction",void 0),G(this,"name",void 0),G(this,"store",void 0),G(this,"spec",void 0),G(this,"peerConnection",void 0),G(this,"initialOffer",void 0),G(this,"transport",void 0),G(this,"statsFilter",void 0),G(this,"localCandidateCount",0),G(this,"_isInRestartIce",!1),G(this,"mutex",void 0),G(this,"onLocalCandidate",void 0),G(this,"remoteSDP",void 0),G(this,"pendingCandidates",[]),G(this,"localCapabilities",void 0),G(this,"isReady",!1),G(this,"restartCnt",0),G(this,"curTurnServerIndex",0),this.store=s,this.spec=o,this.mutex=new fi("P2PConnection-mutex",s.clientId),this.peerConnection=new RTCPeerConnection(pg.resolvePCConfiguration(o,s.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=c??$i.SEND_ONLY,this.name=this.direction===$i.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=S1(this.peerConnection,q("STATS_UPDATE_INTERVAL"),void 0,xn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(o){try{const s=await jz();if(this.localCapabilities=fT(s),o){const{sdp:c}=o,u=$Ne(o,WNe),h=function(){const w={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},C=b_(arguments.length>2?arguments[2]:void 0,arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},"sendonly"),A={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},x={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},B={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(_a(C,w,"videoExtensions",A,x,B),_a(C,w,"videoCodecs",A,x,B),_a(C,w,"audioExtensions",A,x,B),_a(C,w,"audioCodecs",A,x,B),q("RAISE_H264_BASELINE_PRIORITY")){const U=B.videoCodecs.findIndex(F=>F.rtpMap&&F.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&F.fmtp&&F.fmtp.parameters["profile-level-id"]==="42001f");if(U!==-1){const F=B.videoCodecs.findIndex(K=>K.rtpMap&&K.rtpMap.encodingName.toLocaleLowerCase()==="h264");if(F<U){L.debug("raising H264 baseline profile priority");const K=B.videoCodecs[U];B.videoCodecs.splice(U,1),B.videoCodecs.splice(F,0,K)}F!==-1&&q("FILTER_SEND_H264_BASELINE")&&(A.videoCodecs=A.videoCodecs.filter(K=>!(K.rtpMap&&K.rtpMap.encodingName.toLocaleLowerCase()==="h264"&&K.fmtp&&K.fmtp.parameters["profile-level-id"]!=="42001f")))}}return{send:A,recv:x,sendrecv:B}}({},{},c);this.remoteSDP=new W9({remoteIceParameters:u.iceParameters,remoteDtlsParameters:u.dtlsParameters,candidates:[],remoteRTPCapabilities:h,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const p=await this.peerConnection.createAnswer();if(!p.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const g=vd(p.sdp);await this.peerConnection.setLocalDescription(p);const y=await Uz({},{},p.sdp);this.localCapabilities=fT(y);const b=this.peerConnection.getTransceivers()[0];return b!=null&&b.receiver&&b.receiver.transport&&this.tryBindTransportEvents(b.receiver.transport),Od(Od({},g),{},{sdp:p.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const c=await this.peerConnection.createOffer();if(!c.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const u=vd(c.sdp);return this.initialOffer=c,Od(Od({},u),{},{sdp:c.sdp})}}catch(s){throw new ve(Y.GET_LOCAL_CONNECTION_PARAMS_FAILED,s.toString())}}async connect(o){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:s,iceParameters:c,dtlsParameters:u}=o,h=await Uz({},{},s);this.remoteSDP=new W9({remoteIceParameters:c,remoteDtlsParameters:u,candidates:[],remoteRTPCapabilities:h,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const p=this.peerConnection.getTransceivers()[0];p!=null&&p.sender&&p.sender.transport&&this.tryBindTransportEvents(p.sender.transport)}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(s.toString()))}}async addRemoteCandidate(o){try{o&&this.pendingCandidates.push(o),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach(s=>{this.peerConnection.addIceCandidate(s)}),this.pendingCandidates=[])}catch(s){throw new ve(Y.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(s.toString()))}}send(o,s,c){var u=this;return Is(function*(){const h=yield Ot(u.mutex.lock("From P2PConnection.send"));try{if(!u.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const p=[],g=u.remoteSDP.receive(o,s,c);o.forEach((F,K)=>{if(g[K].needCreateTransceiver){const z=u.peerConnection.addTransceiver(F._mediaStreamTrack,{direction:"sendonly"});p.push(z),F._updateRtpTransceiver(z)}else{const z=u.peerConnection.getTransceivers().find(Q=>Q.mid===g[K].mid);if(!z)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(g[K].mid));p.push(z),F._updateRtpTransceiver(z)}}),xn()&&q("SIMULCAST")===!0&&(yield Ot(u.applySimulcastForFirefox(p,o)));const y=g.map(F=>F.mid),b=yield Ot(u.peerConnection.createOffer()),w=u.mungSendOfferSDP(b.sdp,o,y),C=ho(w),A=y.map(F=>{const K=C.mediaDescriptions.find(z=>z.attributes.mid===F);if(!K)throw new Error("Cannot extract ssrc from mediaDescription.");return Nz(K,q("USE_PUB_RTX"))}),x=p.map((F,K)=>{const z=y[K];return{localSSRC:A[K],id:z}});yield Ot(u.peerConnection.setLocalDescription({type:"offer",sdp:w}));try{yield x}catch(F){const K=u.remoteSDP.toString();throw yield Ot(u.peerConnection.setLocalDescription({type:"offer",sdp:w})),yield Ot(u.peerConnection.setRemoteDescription({type:"answer",sdp:K})),yield Ot(u.stopSending(y,!0)),F}yield Ot(u.applySimulcastEncodings(p,o)),yield Ot(u.applySendEncodings(p,o));const B=u.remoteSDP.toString(),U=u.logSDPExchange(w,"offer","local","send");return U==null||U(B),yield Ot(u.setRemoteDescription({type:"answer",sdp:B})),p.map((F,K)=>{const z=y[K];return{localSSRC:A[K],id:z}})}catch(p){throw p instanceof ve?p:new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(p.toString()))}finally{h()}})()}async stopSending(o,s){const c=s?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const u=this.peerConnection.getTransceivers().filter(y=>o.indexOf(y.mid)!==-1);if(u.length!==o.length)throw new Error("Transceivers' length (".concat(u.length,") doesn't match mids' length (").concat(o.length,") when trying to call P2PConnection.stopSending."));u.map(y=>{var b;y.direction="inactive",(b=y.stop)===null||b===void 0||b.call(y)});const h=await this.peerConnection.createOffer(),p=this.logSDPExchange(h.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(h),this.remoteSDP.stopReceiving(o);const g=this.remoteSDP.toString();p==null||p(g),await this.setRemoteDescription({type:"answer",sdp:g})}catch(u){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(u.toString()))}finally{c&&c()}}async receive(o,s,c,u){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(o," before remoteSDP created."));const{mid:h,needExchangeSDP:p}=this.remoteSDP.send(o,s,c,u);if(p){const y=this.remoteSDP.toString(),b=this.logSDPExchange(y,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:y});const w=await this.peerConnection.createAnswer(),C=this.mungReceiveAnswerSDP(w.sdp,h,o);b==null||b(C||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:C}),L.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(o," by exchanging SDP."))}else L.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(o," no need to exchange SDP."));const g=this.peerConnection.getTransceivers().find(y=>y.mid===h);if(!g||g.mid===null)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:g.receiver.track,mid:g.mid,transceiver:g}}catch(h){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(h.toString()))}}async mockReceive(o,s,c,u){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(o," before remoteSDP created."));const{mid:h,needExchangeSDP:p}=this.remoteSDP.send(o,s,c,u);if(p){const g=this.remoteSDP.toString(),y=this.logSDPExchange(g,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:g});const b=await this.peerConnection.createAnswer(),w=this.mungReceiveAnswerSDP(b.sdp,h,o);y==null||y(w||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:w}),L.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(o," by exchanging SDP."))}else L.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(o," no need to exchange SDP."))}catch(h){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(h.toString()))}}async stopReceiving(o){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(o);const s=this.remoteSDP.toString(),c=this.logSDPExchange(s,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:s});const u=await this.peerConnection.createAnswer();c==null||c(u.sdp||""),await this.peerConnection.setLocalDescription(u)}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}}async restartICE(o){try{if(this.store.p2pTransport===af.Auto&&(this.store.p2pTransport=af.SdRtn,xt().supportPCSetConfiguration&&this.peerConnection.setConfiguration(pg.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,xt().supportPCSetConfiguration&&this.peerConnection.setConfiguration(pg.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!o){this.restartCnt++,this.isReady=!1;const s=await this.peerConnection.createOffer({iceRestart:!0});if(!s.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:c}=vd(s.sdp);return this.store.descriptionStart(),this.direction===$i.SEND_ONLY&&await this.peerConnection.setLocalDescription(s),c}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(o),this.store.descriptionStart(),this.direction===$i.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const s=await this.peerConnection.createAnswer();if(!s.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:c}=vd(s.sdp);return await this.peerConnection.setLocalDescription(s),c}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}}close(){var o;this.peerConnection.close(),this.peerConnection.onicecandidate=null,(o=this.onConnectionStateChange)===null||o===void 0||o.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(o){return this.statsFilter.getVideoIsReady(o)}async updateEncoderConfig(o,s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const c=await this.peerConnection.createOffer(),u=this.mungSendOfferSDP(c.sdp,[s],[o]);this.remoteSDP.updateRecvMedia(o,s);const h=this.remoteSDP.toString(),p=this.logSDPExchange(u,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:u}),p==null||p(h),await this.peerConnection.setRemoteDescription({type:"answer",sdp:h})}catch(c){throw new ve(Y.EXCHANGE_SDP_FAILED,c.toString())}}async updateSendParameters(o,s){const c=this.peerConnection.getTransceivers().filter(u=>u.mid===o);c.length===1&&(this.isVP8Simulcast(s)?xn()||await this.applySimulcastEncodings(c,[s]):await this.applySendEncodings(c,[s]))}setStatsRemoteVideoIsReady(o,s){this.statsFilter.setVideoIsReady2(o,s)}async replaceTrack(o,s){const c=this.peerConnection.getTransceivers().find(u=>u.mid===s);c&&await c.sender.replaceTrack(o._mediaStreamTrack)}async getSelectedCandidatePair(){const o=this.peerConnection.getReceivers();if(o.length>0&&o[0].transport&&o[0].transport.iceTransport&&o[0].transport.iceTransport.getSelectedCandidatePair&&o[0].transport.iceTransport.getSelectedCandidatePair()){const s=o[0].transport.iceTransport,{local:c,remote:u}=s.getSelectedCandidatePair();return{local:Od(Od({},Yc),{},{candidateType:c.type,protocol:c.protocol,address:c.address,port:c.port}),remote:Od(Od({},Yc),{},{candidateType:u.type,protocol:u.protocol,address:u.address,port:u.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var o,s;Pe(o=["connected","completed"]).call(o,this.peerConnection.iceConnectionState)&&(this.isReady=!1),(s=this.onICEConnectionStateChange)===null||s===void 0||s.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var o;this.peerConnection.connectionState==="connected"&&(this.restartCnt=0),(o=this.onConnectionStateChange)===null||o===void 0||o.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=o=>{if(o.candidate){var s;o.candidate.candidate&&((s=this.onLocalCandidate)===null||s===void 0||s.call(this,o.candidate.toJSON())),this.localCandidateCount+=1}else L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount)})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(o,s){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const u={iceServers:[]};var h;return o.iceServers?u.iceServers=o.iceServers:o.turnServer&&o.turnServer.mode!=="off"&&(a_(o.turnServer.servers)?u.iceServers=o.turnServer.servers:(u.iceServers&&u.iceServers.push(...pg.turnServerConfigToIceServers(o.turnServer.servers,s,c)),q("USE_TURN_SERVER_OF_GATEWAY")&&u.iceServers&&o.turnServer.serversFromGateway&&u.iceServers.push(...pg.turnServerConfigToIceServers(o.turnServer.serversFromGateway,s,c)),Pe(h=[af.Relay,af.SdRtn]).call(h,s)&&(u.iceTransportPolicy="relay"),q("FORCE_TURN_TCP")?u.iceTransportPolicy="relay":o.turnServer.servers.concat(o.turnServer.serversFromGateway||[]).forEach(p=>{p.forceturn&&(u.iceTransportPolicy="relay")}))),q("ENABLE_ENCODED_TRANSFORM")&&xt().supportWebRTCEncodedTransform&&(u.encodedInsertableStreams=!0),L.debug("P2PConnection p2pTransport is ".concat(s)),u}static turnServerConfigToIceServers(o,s){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const u=[],h=o.filter(g=>g.tcpport);L.debug("P2PConnection turnServers is ".concat(h,", current index is ").concat(c));const p=h.length>c?h[c]:h[0];switch(s){case af.SdRtn:const g=o.filter(b=>{var w;return Pe(w=b.username).call(w,"glb:")&&b.turnServerURL==b.turnServerURL}),y=g.length>c?g[c]:g[0];y&&(u.push({username:y.username,credential:y.password,credentialType:"password",urls:"turn:".concat(md(y.turnServerURL),":").concat(y.tcpport,"?transport=udp")}),u.push({username:y.username,credential:y.password,credentialType:"password",urls:"turns:".concat(md(y.turnServerURL),":").concat(y.tcpport,"?transport=tcp")}));break;case af.Relay:p&&(u.push({username:p.username,credential:p.password,credentialType:"password",urls:"turn:".concat(p.turnServerURL,":").concat(p.tcpport,"?transport=udp")}),u.push({username:p.username,credential:p.password,credentialType:"password",urls:"turns:".concat(md(p.turnServerURL),":").concat(p.tcpport,"?transport=tcp")}));break;default:p&&(u.push({username:p.username,credential:p.password,credentialType:"password",urls:"turn:".concat(p.turnServerURL,":").concat(p.tcpport,"?transport=udp")}),u.push({username:p.username,credential:p.password,credentialType:"password",urls:"turns:".concat(md(p.turnServerURL),":").concat(p.tcpport,"?transport=tcp")}),u.push({username:p.username,credential:p.password,credentialType:"password",urls:"stun:".concat(p.turnServerURL,":").concat(p.tcpport)}))}return u}tryBindTransportEvents(o){if(o){this.transport=o,o.onstatechange=()=>{var c;o!=null&&o.state&&((c=this.onDTLSTransportStateChange)===null||c===void 0||c.call(this,o.state))},o.onerror=c=>{var u;(u=this.onDTLSTransportError)===null||u===void 0||u.call(this,"error"in c?c.error:c)};const s=o.iceTransport;s&&(s.onstatechange=()=>{const c=o==null?void 0:o.iceTransport.state;var u;c&&((u=this.onICETransportStateChange)===null||u===void 0||u.call(this,c))},s.getSelectedCandidatePair&&(s.onselectedcandidatepairchange=()=>{if(s.getSelectedCandidatePair()){const{local:c,remote:u}=s.getSelectedCandidatePair();L.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:c.type,protocol:c.protocol}),", remote ").concat(JSON.stringify({candidateType:u.type,protocol:u.protocol,address:u.address,port:u.port})," )"))}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(o,s){var c;if(s||(s=this.peerConnection.getSenders().find(w=>w.track===o._mediaStreamTrack)),!s)return L.warn("[".concat(o.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(o))return L.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!xt().supportSetRtpSenderParameters)return L.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const u={},h={};switch(o._optimizationMode){case"motion":u.degradationPreference="maintain-framerate";break;case"detail":u.degradationPreference="maintain-resolution";break;default:u.degradationPreference="balanced"}if(o._encoderConfig){var p;const{bitrateMax:w,frameRate:C,scaleResolutionDownBy:A}=o._encoderConfig;w&&(h.maxBitrate=1e3*w),Pe(p=o._hints).call(p,Zt.LOW_STREAM)&&(C&&(h.maxFramerate=ko(C)),A&&A>=1&&(h.scaleResolutionDownBy=A))}if(q("DSCP_TYPE")&&Wl()){var g;const w=q("DSCP_TYPE");Pe(g=["very-low","low","medium","high"]).call(g,w)&&(h.networkPriority=w)}const y=s.getParameters(),b=(c=y.encodings)===null||c===void 0?void 0:c[0];xn()&&!b&&(u.encodings=[h]),b&&Object.assign(b,h),Object.assign(y,u),L.debug("[".concat(o.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(y.encodings))),await s.setParameters(y)}async applySendEncodings(o,s){try{if(!xt().supportSetRtpSenderParameters||o.length!==s.length)return;for(let c=0;c<o.length;c++){const u=o[c],h=s[c];h instanceof pn&&!this.isVP8Simulcast(h)&&await this.updateRtpSenderEncodings(h,u.sender)}}catch{L.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(o,s,c){const u=ho(o);return s.forEach((h,p)=>{const g=c[p],y=u.mediaDescriptions.find(b=>b.attributes.mid===g);y&&(Vm(y,h),Mz(y,h,this.store.codec))}),hd(u)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=o=>{var s;(s=this.onFirstAudioReceived)===null||s===void 0||s.call(this,o)},this.statsFilter.onFirstVideoReceived=o=>{var s;(s=this.onFirstVideoReceived)===null||s===void 0||s.call(this,o)},this.statsFilter.onFirstAudioDecoded=o=>{var s;(s=this.onFirstAudioDecoded)===null||s===void 0||s.call(this,o)},this.statsFilter.onFirstVideoDecoded=(o,s,c)=>{var u;(u=this.onFirstVideoDecoded)===null||u===void 0||u.call(this,o,s,c)},this.statsFilter.onSelectedLocalCandidateChanged=(o,s)=>{var c;(c=this.onSelectedLocalCandidateChanged)===null||c===void 0||c.call(this,o,s)},this.statsFilter.onSelectedRemoteCandidateChanged=(o,s)=>{var c;(c=this.onSelectedRemoteCandidateChanged)===null||c===void 0||c.call(this,o,s)},this.statsFilter.onFirstVideoDecodedTimeout=o=>{var s;(s=this.onFirstVideoDecodedTimeout)===null||s===void 0||s.call(this,o)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(o,s){if(o.length===s.length)for(let y=0;y<o.length;y++){var c,u,h,p,g;const b=o[y],w=s[y];if(w instanceof pn&&!Pe(c=w._hints).call(c,Zt.LOW_STREAM)&&(u=w._encoderConfig)!==null&&u!==void 0&&u.bitrateMax&&((h=w._encoderConfig)===null||h===void 0?void 0:h.bitrateMax)>200&&(p=w._scalabilityMode)!==null&&p!==void 0&&p.numSpatialLayers&&((g=w._scalabilityMode)===null||g===void 0?void 0:g.numSpatialLayers)>1&&this.store.codec==="vp8"){const C={},A={high:1e3*(w._encoderConfig.bitrateMax-50),medium:5e4};C.encodings=[{rid:"m",active:!0,maxBitrate:A.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:A.high}];const x=b.sender.getParameters();await b.sender.setParameters(Object.assign(x,C))}}}async applySimulcastEncodings(o,s){if(!xn()&&o.length===s.length)for(let c=0;c<o.length;c++){const u=s[c];if(u instanceof pn&&this.isVP8Simulcast(u)){const h=o[c],p={},g={high:1e3*(u._encoderConfig.bitrateMax-50),medium:5e4};p.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:g.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:g.medium,scaleResolutionDownBy:4}];const y=h.sender.getParameters();await h.sender.setParameters(Object.assign(y,p))}}}isVP8Simulcast(o){var s,c,u,h,p;return!!(o instanceof pn&&q("SIMULCAST")&&this.store.codec==="vp8"&&!Pe(s=o._hints).call(s,Zt.LOW_STREAM)&&(c=o._encoderConfig)!==null&&c!==void 0&&c.bitrateMax&&((u=o._encoderConfig)===null||u===void 0?void 0:u.bitrateMax)>200&&(h=o._scalabilityMode)!==null&&h!==void 0&&h.numSpatialLayers&&((p=o._scalabilityMode)===null||p===void 0?void 0:p.numSpatialLayers)>1)}logSDPExchange(o,s,c,u){if(q("SDP_LOGGING"))return L.upload("[".concat(this.store.clientId,"] exchanging ").concat(c," ").concat(s," SDP during P2PConnection.").concat(u,`
`),o),s==="offer"?h=>{this.logSDPExchange(h,"answer",c==="local"?"remote":"local",u)}:void 0}async muteLocal(o){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(p=>p.mid&&o.indexOf(p.mid)!==-1);if(s.length!==o.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(p=>{p.direction="inactive"});const c=await this.peerConnection.createOffer(),u=this.logSDPExchange(c.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(c),this.remoteSDP.muteRemote(o);const h=this.remoteSDP.toString();u==null||u(h),await this.setRemoteDescription({type:"answer",sdp:h})}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(s.toString()))}}async unmuteLocal(o){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const s=this.peerConnection.getTransceivers().filter(p=>p.mid&&o.indexOf(p.mid)!==-1);if(s.length!==o.length)throw new Error("Transceivers' length doesn't match mids' length.");s.map(async p=>{p.direction="sendonly"});const c=await this.peerConnection.createOffer(),u=this.logSDPExchange(c.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(c),this.remoteSDP.unmuteRemote(o);const h=this.remoteSDP.toString();u==null||u(h),await this.setRemoteDescription({type:"answer",sdp:h})}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(s.toString()))}}async getRemoteSSRC(o,s){var c;if(s=s??((c=this.currentRemoteDescription)===null||c===void 0?void 0:c.sdp)){var u;const h=(u=ho(s).mediaDescriptions.find(p=>p.attributes.mid===o))===null||u===void 0?void 0:u.attributes.ssrcs;return h==null?void 0:h[0].ssrcId}}async setRemoteDescription(o){var s;await this.peerConnection.setRemoteDescription(o),Pe(s=["connected","completed"]).call(s,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(o,s,c){const u=ho(o),h=u.mediaDescriptions.find(p=>p.attributes.mid===s);return h&&c===je.AUDIO&&h.media.mediaType==="audio"&&Fm(h),hd(u)}},$e(mn.prototype,"establish",[Ca],Object.getOwnPropertyDescriptor(mn.prototype,"establish"),mn.prototype),$e(mn.prototype,"connect",[Ca],Object.getOwnPropertyDescriptor(mn.prototype,"connect"),mn.prototype),$e(mn.prototype,"receive",[Ca],Object.getOwnPropertyDescriptor(mn.prototype,"receive"),mn.prototype),$e(mn.prototype,"mockReceive",[Ca],Object.getOwnPropertyDescriptor(mn.prototype,"mockReceive"),mn.prototype),$e(mn.prototype,"stopReceiving",[Ca],Object.getOwnPropertyDescriptor(mn.prototype,"stopReceiving"),mn.prototype),$e(mn.prototype,"restartICE",[Ca],Object.getOwnPropertyDescriptor(mn.prototype,"restartICE"),mn.prototype),$e(mn.prototype,"close",[Ca],Object.getOwnPropertyDescriptor(mn.prototype,"close"),mn.prototype),$e(mn.prototype,"updateEncoderConfig",[Ca],Object.getOwnPropertyDescriptor(mn.prototype,"updateEncoderConfig"),mn.prototype),$e(mn.prototype,"updateSendParameters",[Ca],Object.getOwnPropertyDescriptor(mn.prototype,"updateSendParameters"),mn.prototype),$e(mn.prototype,"replaceTrack",[Ca],Object.getOwnPropertyDescriptor(mn.prototype,"replaceTrack"),mn.prototype),$e(mn.prototype,"muteLocal",[Ca],Object.getOwnPropertyDescriptor(mn.prototype,"muteLocal"),mn.prototype),$e(mn.prototype,"unmuteLocal",[Ca],Object.getOwnPropertyDescriptor(mn.prototype,"unmuteLocal"),mn.prototype),mn);function Ca(r,o,s){const c=r[o];if(typeof c!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const u=this.mutex,h=await u.lock("From P2PConnection.".concat(o));try{for(var p=arguments.length,g=new Array(p),y=0;y<p;y++)g[y]=arguments[y];return await c.apply(this,g)}finally{h()}},s}let lc=function(r){return r.SEND_ONLY="SEND_ONLY",r.RECEIVE_ONLY="RECEIVE_ONLY",r}({});var K9,z9,Y9,q9,X9,J9,Q9,Z9,e7,t7,n7,Rn;function r7(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function YT(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?r7(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):r7(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}let GNe=(K9=uc(lc.SEND_ONLY),z9=uc(lc.SEND_ONLY),Y9=uc(),q9=uc(lc.RECEIVE_ONLY),X9=uc(lc.RECEIVE_ONLY),J9=uc(lc.RECEIVE_ONLY),Q9=uc(lc.RECEIVE_ONLY),Z9=uc(lc.RECEIVE_ONLY),e7=uc(lc.RECEIVE_ONLY),t7=uc(),n7=uc(lc.RECEIVE_ONLY),Rn=class extends An{get state(){return this._state}set state(r){const o=this._state;this._state=r,this.emit(Ye.StateChange,o,this._state)}constructor(r,o){super(),G(this,"isPlanB",!1),G(this,"store",void 0),G(this,"statsUploader",void 0),G(this,"sendConnection",void 0),G(this,"recvConnection",void 0),G(this,"localTrackMap",new Map),G(this,"remoteUserMap",new Map),G(this,"localDataChannels",[]),G(this,"pendingLocalTracks",[]),G(this,"pendingRemoteTracks",[]),G(this,"statsCollector",void 0),G(this,"dtlsFailedCount",0),G(this,"sendMutex",void 0),G(this,"recvMutex",void 0),G(this,"_state",$t.Disconnected),G(this,"_restartStates",["disconnected","failed"]),G(this,"reconnectInterval",void 0),G(this,"uploadUnplinkStarted",!1),G(this,"uploadDownlinkStarted",!1),G(this,"uplinkStateUploadInterval",void 0),G(this,"downlinkStatsUploadInterval",void 0),G(this,"handleMuteLocalTrack",async(s,c,u)=>{const h=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==$t.Connected)return void u(new ve(Y.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const y=this.filterTobeMutedTracks(s);if(y.length===0)return void c();const b=y.find(x=>x[0]==="videoLowTrack");b&&b[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(y.map(x=>{let[,{id:B}]=x;return B}));let w=!1;var p,g;s.trackMediaType==="video"?w=!((p=this.localTrackMap.get(Te.LocalAudioTrack))===null||p===void 0||!p.track._muted):w=((g=this.localTrackMap.get(Te.LocalVideoTrack))===null||g===void 0?void 0:g.id)===void 0;const C=this.createMuteMessage(y);await rn(this,Ye.RequestMuteLocal,C);const A=s.trackMediaType==="video"?pd.MUTE_LOCAL_VIDEO:pd.MUTE_LOCAL_AUDIO;await rn(this,Ye.RequestP2PMuteLocal,{action:A,message:C,isMuteAll:w}),c()}catch(y){u(y)}finally{h()}}),G(this,"handleUnmuteLocalTrack",async(s,c,u)=>{const h=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==$t.Connected)return void u(new ve(Y.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const p=this.filterTobeUnmutedTracks(s);if(p.length===0)return void c();await this.sendConnection.unmuteLocal(p.map(b=>{let[,{id:w}]=b;return w}));const g=this.createUnmuteMessage(p),y=s.trackMediaType==="video"?pd.UNMUTE_LOCAL_VIDEO:pd.UNMUTE_LOCAL_AUDIO;await rn(this,Ye.RequestP2PMuteLocal,{action:y,message:g}),c()}catch(p){u(p)}finally{h()}}),G(this,"handleUpdateVideoEncoder",async(s,c,u,h)=>{let p;typeof h=="boolean"&&h||(p=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoEncoder"));try{const y=this.localTrackMap.get(Te.LocalVideoTrack);if(!this.sendConnection||!y||y.track!==s||this.state!==$t.Connected)return void c();const{id:b,track:w}=y;b&&(await this.sendConnection.updateSendParameters(b,w),await this.sendConnection.updateEncoderConfig(b,w),this.emit(Ye.UpdateVideoEncoder,w)),c()}catch(y){u(y)}finally{var g;(g=p)===null||g===void 0||g()}}),G(this,"handleUpdateVideoSendParameters",async(s,c,u)=>{const h=await this.sendMutex.lock("Locking from P2PChannel2.handleUpdateVideoSendParameters");try{const p=this.localTrackMap.get(Te.LocalVideoTrack);if(!this.sendConnection||!p||p.track!==s||this.state!==$t.Connected)return void c();const{id:g,track:y}=p;g&&await this.sendConnection.updateSendParameters(g,y),c()}catch(p){u(p)}finally{h()}}),G(this,"handleReplaceTrack",async(s,c,u,h)=>{let p;L.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(s.getTrackId(),"]")),typeof h=="boolean"&&h||(p=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var g;const b=Array.from(this.localTrackMap.entries()).find(w=>{let[,{track:C}]=w;return s===C});if(!this.sendConnection||!b||b[1].id===void 0||this.state!==$t.Connected)return void c();if(await((g=this.sendConnection)===null||g===void 0?void 0:g.replaceTrack(s,b[1].id)),b[0]===Te.LocalVideoTrack&&xt().supportDualStreamEncoding){const w=this.localTrackMap.get(Te.LocalVideoLowTrack);if(w){const C=s._mediaStreamTrack.clone();w.track._originMediaStreamTrack.stop(),w.track._mediaStreamTrack=C,w.track._originMediaStreamTrack=C,await new De((A,x)=>{this.handleReplaceTrack(w.track,A,x,!0)})}}c()}catch(b){u(b)}finally{var y;(y=p)===null||y===void 0||y()}}),G(this,"handleGetLocalVideoStats",s=>{s(this.statsCollector.getLocalVideoTrackStats())}),G(this,"handleGetLocalAudioStats",s=>{s(this.statsCollector.getLocalAudioTrackStats())}),G(this,"handleGetRemoteVideoStats",s=>this.statsCollector.getRemoteVideoTrackStats(s.uid)[s.uid]),G(this,"handleGetRemoteAudioStats",s=>this.statsCollector.getRemoteAudioTrackStats(s.uid)[s.uid]),this.store=r,this.statsCollector=o,this.statsCollector.addP2PChannel(this),this.statsUploader=new bY(r),this.bindStatsUploaderEvents(),this.sendMutex=new fi("P2PChannel2-send-mutex",r.clientId),this.recvMutex=new fi("P2PChannel2-recv-mutex",r.clientId),this.reconnectInterval=window.setInterval(()=>{[this.sendConnection,this.recvConnection].forEach(s=>{s&&(s.iceConnectionState!=="disconnected"&&s.iceConnectionState!=="failed"||this.handleDisconnect(s.direction))})},q("ICE_RESTART_INTERVAL"))}async startP2PConnection(r,o){throw new ve(Y.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(r){throw new ve(Y.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(r,o){let s;try{if(o){this.recvConnection&&(L.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),s=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new H9(r,this.store,$i.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const c=await this.recvConnection.establish(o);return{iceParameters:c.iceParameters,dtlsParameters:c.dtlsParameters,sdp:c.sdp}}{this.state=$t.New,this.sendConnection&&(L.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),s=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new H9(r,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const c=await this.sendConnection.establish();return{iceParameters:c.iceParameters,dtlsParameters:c.dtlsParameters,sdp:c.sdp}}}finally{s&&s()}}async p2pConnect(r){if(!this.sendConnection)throw new ve(Y.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(r),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=$t.Connected}async addRemoteCandidate(r,o){if(o===$i.RECEIVE_ONLY){if(!this.sendConnection)throw new ve(Y.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(r)}else{if(!this.recvConnection)throw new ve(Y.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(r)}}publish(r,o,s){var c=this;return Is(function*(){const u=yield Ot(c.sendMutex.lock("From P2PChannel.publish"));try{if(!c.sendConnection||c.state!==$t.Connected){c.throwIfTrackTypeNotMatch(r);const b=r.filter(w=>c.pendingLocalTracks.indexOf(w)===-1);return void(c.pendingLocalTracks=c.pendingLocalTracks.concat(b))}c.store.pubId=c.store.pubId+1,gi.markPublishStart(c.store.clientId,c.store.pubId);const h=c.filterTobePublishedTracks(r,o,s);if(h.length===0)return void(yield Ot(c.tryToUnmuteAudio(r)));h.forEach(b=>{let{track:w,type:C}=b;const A=Date.now();c.store.publish(w.getTrackId(),C===Te.LocalAudioTrack?"audio":"video",A)}),c.bindLocalTrackEvents(h);const p=yield Ot(c.sendConnection.send(h.map(b=>{let{track:w}=b;return w}),c.store.codec,c.store.audioCodec)),g=(yield Ot(p.next())).value,y=c.createGatewayPublishMessage(h,g);try{yield y}catch(b){throw p.throw(b),(b==null?void 0:b.code)===Y.WS_ABORT&&h.forEach(w=>{let{track:C}=w;c.pendingLocalTracks.indexOf(C)===-1&&c.pendingLocalTracks.push(C)}),c.unbindLocalTrackEvents(h),b}yield Ot(p.next()),h.forEach(b=>{let{type:w}=b;c.statsCollector.addLocalStats(w)}),c.statsUploader.startUploadOutboundStats(),c.assignLocalTracks(h,g),h.forEach(b=>{let{track:w,type:C}=b;const A=Date.now();c.store.publish(w.getTrackId(),C===Te.LocalAudioTrack?"audio":"video",void 0,A)}),c.startUploadUplinkState()}finally{u()}})()}async unpublish(r){if(!this.sendConnection||this.state!==$t.Connected)return void(r.length===0?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter(u=>!Pe(r).call(r,u)));const o=this.filterTobeUnpublishedTracks(r);if(o.length===0)return;const s=o.find(u=>u[0]==="videoLowTrack");s&&s[1].track.close();const c=this.createGatewayUnpublishMessage(o);if(await this.sendConnection.stopSending(o.map(u=>{let[,{id:h}]=u;return h})),this.withdrawLocalTracks(o),this.unbindLocalTrackEvents(o.map(u=>{let[h,{track:p}]=u;return{type:h,track:p}})),o.forEach(u=>{let[h]=u;this.statsCollector.removeLocalStats(h)}),this.localTrackMap.size===0&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===$t.Connected)return s&&s[1].track.close(),c;r.forEach(u=>{const h=this.pendingLocalTracks.indexOf(u);h!==-1&&this.pendingLocalTracks.splice(h,1)})}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const r=()=>{const o=[],s=[];Array.from(this.localTrackMap.entries()).forEach(c=>{let[u,{track:h,ssrcs:p}]=c;const g={stream_type:Lxe(h,u),ssrcs:p};h._muted||!h._enabled?o.push(g):s.push(g)}),o.length>0&&o.forEach(c=>{rn(this,Ye.RequestMuteLocal,[c])}),s.length>0&&s.forEach(c=>{rn(this,Ye.RequestUnmuteLocal,[c])})};r(),this.uplinkStateUploadInterval=window.setInterval(()=>{r()},3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(r){return Is(function*(){throw new ve(Y.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")})()}async republish(){this.pendingLocalTracks.length>0&&(L.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await oi(this,Ye.RequestRePublish,this.pendingLocalTracks),this.emit(Ye.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new ve(Y.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(r,o,s,c){var u;if(!this.recvConnection)throw new ve(Y.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if((u=this.remoteUserMap.get(r))!==null&&u!==void 0&&u.has(o))return;const{track:h,mid:p,transceiver:g}=await this.recvConnection.receive(o,[{ssrcId:s}],String(r.uid),c);o===je.AUDIO?(r._audioTrack?r._audioTrack._updateOriginMediaStreamTrack(h):(r._audioTrack=new Pm(h,r.uid,r._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(r._audioTrack.getTrackId()))),g&&r._audioTrack._updateRtpTransceiver(g),this.bindRemoteTrackEvents(r,r._audioTrack)):(r._videoSSRC=s,r._videoTrack?r._videoTrack._updateOriginMediaStreamTrack(h):(r._videoTrack=new xm(h,r.uid,r._uintid,this.store),L.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(r._videoTrack.getTrackId()))),g&&r._videoTrack._updateRtpTransceiver(g),this.bindRemoteTrackEvents(r,r._videoTrack));const y=this.remoteUserMap.get(r);y?y.set(o,p):this.remoteUserMap.set(r,new Map([[o,p]])),this.statsCollector.addRemoteStats(r.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const b=this.pendingRemoteTracks.findIndex(w=>{let{user:C,kind:A}=w;return C.uid===r.uid&&o===A});b!==-1&&(this.pendingRemoteTracks.splice(b,1),this.emit(Ye.MediaReconnectEnd,r.uid))}async mockSubscribe(r,o,s,c){if(!this.recvConnection)throw new ve(Y.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(o,[{ssrcId:s}],String(r.uid),c)}async unsubscribe(r,o,s){const c=this.pendingRemoteTracks.filter(h=>{let{user:p,kind:g}=h;return o!==void 0?p.uid===r.uid&&o===g:p.uid===r.uid});if(c.forEach(h=>{const p=this.pendingRemoteTracks.indexOf(h);this.pendingRemoteTracks.splice(p,1)}),this.recvConnection||s||c.forEach(h=>{let{kind:p}=h;var g;if(p===je.AUDIO)(g=r._audioTrack)===null||g===void 0||g._destroy(),r._audioTrack=void 0;else if(p===je.VIDEO){var y;(y=r._videoTrack)===null||y===void 0||y._destroy(),r._videoTrack=void 0}}),!this.recvConnection)return;const u=this.filterTobeUnSubscribedTracks(r,o);u.length!==0&&(await this.recvConnection.stopReceiving(u.map(h=>{let[,{id:p}]=h;return p})),this.withdrawRemoteTracks(u),this.remoteUserMap.size===0&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),u.forEach(h=>{let[p,{kind:g}]=h;var y,b;if(g===je.VIDEO&&p._videoSSRC&&((y=this.recvConnection)===null||y===void 0||y.setStatsRemoteVideoIsReady(p._videoSSRC,!1)),g===je.VIDEO)this.unbindRemoteTrackEvents(p._videoTrack),s||((b=p._videoTrack)===null||b===void 0||b._destroy(),p._videoTrack=void 0);else if(g===je.AUDIO){var w;this.unbindRemoteTrackEvents(p._audioTrack),!s&&((w=p._audioTrack)===null||w===void 0||w._destroy(),p._audioTrack=void 0)}}),u.forEach(h=>{let[,{kind:p}]=h;rn(this,Ye.RequestP2PMuteRemote,p)}))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const r=()=>Array.from(this.remoteUserMap.entries()).forEach(o=>{let[,s]=o;[je.VIDEO,je.AUDIO].forEach(c=>{s.has(c)?rn(this,Ye.RequestP2PUnmuteRemote,c):rn(this,Ye.RequestP2PMuteRemote,c)})});r(),this.downlinkStatsUploadInterval=window.setInterval(()=>{r()},3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(r){throw new ve(Y.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(r){throw new ve(Y.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(r){throw new ve(Y.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(r){throw new ve(Y.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(r,o){if(!this.recvConnection)return;const s=this.remoteUserMap.get(r);if(!s)return void L.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(r.uid,"."));if(!s.get(o))return void L.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(r.uid," media type ").concat(o,"."));const c=o===je.VIDEO?r._videoSSRC:r._audioSSRC;c!==void 0&&this.recvConnection.setStatsRemoteVideoIsReady(c,!1)}async unmuteRemote(r,o){return this.unmuteRemoteNoLock(r,o)}async unmuteRemoteNoLock(r,o){if(!this.recvConnection)return;const s=this.remoteUserMap.get(r);if(!s)return void L.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(r.uid,"."));s.get(o)||L.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(r.uid," media type ").concat(o,"."))}getAllTracks(r){const o=this.localTrackMap.get(Te.LocalAudioTrack);if((o==null?void 0:o.track)instanceof lr){const s=o.track;return Array.from(this.localTrackMap.entries()).filter(c=>{let[u]=c;return u!==Te.LocalAudioTrack}).filter(c=>{let[u]=c;return!(r&&u===Te.LocalVideoLowTrack)}).map(c=>{let[,{track:u}]=c;return u}).concat(s.trackList)}return Array.from(this.localTrackMap.entries()).filter(s=>{let[c]=s;return!(r&&c===Te.LocalVideoLowTrack)}).map(s=>{let[,{track:c}]=s;return c})}reportPublishEvent(r,o,s,c,u){if(r){const p=this.localTrackMap.get(Te.LocalAudioTrack),g=c?this.localTrackMap.get(Te.LocalVideoLowTrack):this.localTrackMap.get(Te.LocalVideoTrack);We.publish(this.store.sessionId,{eventElapse:gi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:r,ec:o,audioName:p==null?void 0:p.track.getTrackLabel(),videoName:g==null?void 0:g.track.getTrackLabel(),screenshare:(g==null?void 0:g.track._hints.indexOf(Zt.SCREEN_TRACK))!==-1,audio:!!p,video:!!g,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}else{var h;s||(s=[]);const p=s.find(y=>y instanceof jn),g=c?(h=this.localTrackMap.get(Te.LocalVideoTrack))===null||h===void 0?void 0:h.track:s.find(y=>y instanceof pn);We.publish(this.store.sessionId,{eventElapse:gi.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:r,ec:o,audioName:p==null?void 0:p.getTrackLabel(),videoName:g==null?void 0:g.getTrackLabel(),screenshare:(g==null?void 0:g._hints.indexOf(Zt.SCREEN_TRACK))!==-1,audio:!!p,video:!!g,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:u})}}reportSubscribeEvent(r,o,s,c){const u=c===je.VIDEO?s._videoSSRC:s._audioSSRC;u&&We.subscribe(this.store.sessionId,{succ:r,ec:o,video:c===je.VIDEO,audio:c===je.AUDIO,peerid:s.uid,subscribeRequestid:c===je.VIDEO?s._videoSSRC:s._audioSSRC,p2pid:this.store.p2pId,eventElapse:gi.measureFromSubscribeStart(this.store.clientId,u)})}reset(){L.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new fi("P2PChannel2-send-mutex",this.store.clientId),this.sendMutex=new fi("P2PChannel2-recv-mutex",this.store.clientId),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const r=this.localTrackMap.get(Te.LocalAudioTrack);if((r==null?void 0:r.track)instanceof lr){if(r.track.trackList.length>0){const o=r.track;r.track.trackList.forEach(s=>{o.removeAudioTrack(s)})}r.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=$t.Disconnected}getStats(r){var o,s;return r?(s=this.recvConnection)===null||s===void 0?void 0:s.getStats():(o=this.sendConnection)===null||o===void 0?void 0:o.getStats()}getRemoteVideoIsReady(r){var o;return((o=this.recvConnection)===null||o===void 0?void 0:o.getRemoteVideoIsReady(r))||!1}getLocalAudioVolume(){const r=this.localTrackMap.get(Te.LocalAudioTrack);if(r)return r.track.getVolumeLevel()}getLocalVideoSize(){const r=this.localTrackMap.get(Te.LocalVideoTrack);if(r)return{width:r.track.videoWidth||0,height:r.track.videoHeight||0}}getEncoderConfig(r){const o=this.localTrackMap.get(r);return o&&o.track instanceof pn||o&&o.track instanceof jn?o.track._encoderConfig:void 0}getLocalMedia(r){return this.localTrackMap.get(r)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(r,o){if(!r)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(r);return!!s&&(!o||s.has(o))}async hasRemoteMediaWithLock(r,o){if(!r)return this.remoteUserMap.size>0;const s=this.remoteUserMap.get(r);return!!s&&(!o||s.has(o))}getRemoteMedia(r){var o;const s=Array.from(ts(o=this.remoteUserMap).call(o)).find(c=>c.uid===r);return s?{audioTrack:s.audioTrack,audioSSRC:s._audioSSRC,videoTrack:s.videoTrack,videoSSRC:s._videoSSRC}:{}}getAudioLevels(){let r=Array.from(this.remoteUserMap.entries()).map(s=>{let[c]=s;return{uid:c.uid,level:c.audioTrack?100*c.audioTrack._source.getAccurateVolumeLevel():0}});const o=this.localTrackMap.get(Te.LocalAudioTrack);return o&&r.push({level:100*o.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),r=Yh(r).call(r,(s,c)=>s.level-c.level),r}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(L.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=$t.Reconnecting,q("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(r=>{let[o]=r;var s;o._videoTrack&&o._videoTrack._player&&((s=o._videoTrack._player.getVideoElement())===null||s===void 0||s.pause(),o._videoTrack._player.isKeepLastFrame=!0,o._videoTrack._originMediaStreamTrack.stop())}),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(r=>{var o;let[s,{track:c}]=r;switch(s){case Te.LocalVideoTrack:Pe(o=c._hints).call(o,Zt.LOW_STREAM)?c.close():this.pendingLocalTracks.push(c);break;case Te.LocalAudioTrack:c instanceof lr?this.pendingLocalTracks=this.pendingLocalTracks.concat(c.trackList):this.pendingLocalTracks.push(c);case Te.LocalVideoLowTrack:}}),this.emit(Ye.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(r=>{let[o,s]=r;Array.from(ts(s).call(s)).forEach(c=>{this.setPendingRemoteMedia(o,c)}),this.emit(Ye.MediaReconnectStart,o.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),L.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(r,o){for(const s of this.pendingRemoteTracks){const{user:c,kind:u}=s;if((r instanceof _d?r.uid:r)===c.uid&&o===u)return!0}return!1}setPendingRemoteMedia(r,o){this.hasPendingRemoteMedia(r,o)||this.pendingRemoteTracks.push({user:r,kind:o})}async restartICE(r,o){let s,c;if(r===$i.SEND_ONLY){if(!this.sendConnection)throw new ve(Y.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");s=await this.sendMutex.lock("From P2PChannel.restartICE"),c=this.sendConnection}else{if(!this.recvConnection)throw new ve(Y.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");s=await this.recvMutex.lock("From P2PChannel.restartICE"),c=this.recvConnection}try{if(o){const u=await c.restartICE(o);return c.isInRestartIce=!1,u}{const u=await c.restartICE();if(u){const h=await oi(this,Ye.RequestP2PRestartICE,{direction:$i.RECEIVE_ONLY,iceParameter:u});await c.restartICE(h),c.isInRestartIce=!1}}}finally{s()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const r=this.sendConnection.getStats(),o=this.localTrackMap.get(Te.LocalVideoTrack),s=this.localTrackMap.get(Te.LocalAudioTrack),c=r.videoSend.find(x=>{var B;return x.ssrc===(o==null||(B=o.ssrcs)===null||B===void 0?void 0:B[0].ssrcId)}),u=r.audioSend.find(x=>{var B;return x.ssrc===(s==null||(B=s.ssrcs)===null||B===void 0?void 0:B[0].ssrcId)});if(!c||!u)return 1;const h=Zo(this,Ye.NeedSignalRTT),p=c?c.rttMs:void 0,g=u?u.rttMs:void 0,y=p&&g?(p+g)/2:p||g,b=(y&&h?(y+h)/2:y||h)||0,w=100*r.sendPacketLossRate*.7/50+.3*b/1500,C=w<.17?1:w<.36?2:w<.59?3:w<.1?4:5,A=o==null?void 0:o.track;if(A&&A._encoderConfig&&A._hints.indexOf(Zt.SCREEN_TRACK)===-1){const x=A._encoderConfig.bitrateMax,B=r.bitrate.actualEncoded;if(x&&B){const U=(1e3*x-B)/(1e3*x);return lz[U<.15?0:U<.3?1:U<.45?2:U<.6?3:4][C]}}return C}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const r=this.recvConnection.getStats();let o=0;return Array.from(this.remoteUserMap.entries()).forEach(s=>{let[c]=s;const u=c._audioSSRC,h=c._videoSSRC,p=r.audioRecv.find(B=>B.ssrc===u),g=r.videoRecv.find(B=>B.ssrc===h);if(!p&&!g)return void(o+=1);const y=Zo(this,Ye.NeedSignalRTT),b=r.rtt,w=(b&&y?(b+y)/2:b||y)||0,C=p?p.jitterMs:void 0,A=r.recvPacketLossRate;let x=.7*A*100/50+.3*w/1500;C&&(x=.6*A*100/50+.2*w/1500+.2*C/400),o+=x<.1?1:x<.17?2:x<.36?3:x<.59?4:5}),this.remoteUserMap.size>0?Math.round(o/this.remoteUserMap.size):o}async muteLocalTrack(r){return new De((o,s)=>{this.handleMuteLocalTrack(r,o,s)})}filterTobePublishedTracks(r,o,s){const c=[],u=xt(),h=this.getAllTracks();r=vm(r=r.filter(y=>h.indexOf(y)===-1));let p=!1,g=!1;for(const y of r){if(y instanceof pn&&(this.localTrackMap.has(Te.LocalVideoTrack)||p?new ve(Y.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(c.push({track:y,type:Te.LocalVideoTrack}),p=!0),o)){const b=this.getLowVideoTrack(y,s);c.push({track:b,type:Te.LocalVideoLowTrack})}if(y instanceof jn){const b=this.localTrackMap.get(Te.LocalAudioTrack);if(b){if(!(b.track instanceof lr))throw new ve(Y.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(y._bypassWebAudio)throw new ve(Y.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");b.track.addAudioTrack(y),this.bindLocalAudioTrackEvents(y,!0)}else if(g){const w=c.find(C=>{let{type:A}=C;return A===Te.LocalAudioTrack});if(!(w.track instanceof lr))throw new ve(Y.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(y._bypassWebAudio)throw new ve(Y.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");w.track.addAudioTrack(y)}else{if(!u.webAudioMediaStreamDest||y instanceof lr||y._bypassWebAudio)c.push({track:y,type:Te.LocalAudioTrack});else{const w=new lr;w.addAudioTrack(y),c.push({track:w,type:Te.LocalAudioTrack})}g=!0}}}return c}filterTobeUnpublishedTracks(r){const o=[],s=this.getAllTracks();r=vm(r=r.filter(c=>s.indexOf(c)!==-1));for(const c of r){if(c instanceof jn){const u=this.localTrackMap.get(Te.LocalAudioTrack);if(!u)continue;u.track instanceof lr?(u.track.removeAudioTrack(c),this.unbindLocalAudioTrackEvents(c),u.track.trackList.length===0&&(o.push([Te.LocalAudioTrack,u]),u.track.close())):o.push([Te.LocalAudioTrack,u])}if(c instanceof pn){const u=this.localTrackMap.get(Te.LocalVideoTrack);if(!u)continue;o.push([Te.LocalVideoTrack,u]);const h=this.localTrackMap.get(Te.LocalVideoLowTrack);h&&o.push([Te.LocalVideoLowTrack,h])}}return o}bindLocalTrackEvents(r){r.forEach(o=>{let{track:s,type:c}=o;switch(c){case Te.LocalVideoTrack:s.addListener(Fe.GET_STATS,this.handleGetLocalVideoStats),s.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(Fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.addListener(Fe.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),s.addListener(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Te.LocalAudioTrack:this.bindLocalAudioTrackEvents(s);case Te.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(r,o){r instanceof lr?r.trackList.forEach(s=>{s.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.addListener(Fe.GET_STATS,this.handleGetLocalAudioStats),s.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(r.addListener(Fe.GET_STATS,this.handleGetLocalAudioStats),r.addListener(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.addListener(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.addListener(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.addListener(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),o||r.addListener(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(r){r||(r=Array.from(this.localTrackMap.entries()).map(o=>{let[s,{track:c}]=o;return{track:c,type:s}})),r.forEach(o=>{let{track:s,type:c}=o;switch(c){case Te.LocalVideoTrack:s.off(Fe.GET_STATS,this.handleGetLocalVideoStats),s.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),s.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),s.off(Fe.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),s.off(Fe.NEED_UPDATE_VIDEO_SEND_PARAMETERS,this.handleUpdateVideoSendParameters),s.off(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),s.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),s.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case Te.LocalAudioTrack:this.unbindLocalAudioTrackEvents(s);case Te.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(r){r instanceof lr?r.trackList.forEach(o=>{o.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),o.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),o.off(Fe.GET_STATS,this.handleGetLocalAudioStats),o.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),o.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(r.off(Fe.GET_STATS,this.handleGetLocalAudioStats),r.off(Fe.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),r.off(Fe.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),r.off(Fe.NEED_REPLACE_TRACK,this.handleReplaceTrack),r.off(Fe.NEED_MUTE_TRACK,this.handleMuteLocalTrack),r.off(Fe.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(r,o){o instanceof xm&&o.addListener(Fe.GET_STATS,s=>{s(this.handleGetRemoteVideoStats(r))}),o instanceof Pm&&o.addListener(Fe.GET_STATS,s=>{s(this.handleGetRemoteAudioStats(r))})}unbindRemoteTrackEvents(r){r&&r.removeAllListeners(Fe.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(r=>{let[o,s]=r;s.has(je.AUDIO)&&this.unbindRemoteTrackEvents(o._audioTrack),s.has(je.VIDEO)&&this.unbindRemoteTrackEvents(o._videoTrack)})}createGatewayPublishMessage(r,o){return r.map((s,c)=>{var u;let h,{track:p,type:g}=s;switch(g){case Te.LocalAudioTrack:h=Ht.Audio;break;case Te.LocalVideoTrack:h=Pe(u=p._hints).call(u,Zt.SCREEN_TRACK)?Ht.Screen:Ht.High;break;case Te.LocalVideoLowTrack:h=Ht.Low}return{kind:g===Te.LocalAudioTrack?je.AUDIO:je.VIDEO,stream_type:h,mid:o[c].id,ssrcs:o[c].localSSRC,isMuted:p.muted||!p.enabled}})}createGatewayUnpublishMessage(r){return r.map(o=>{var s;let c,[u,{track:h,ssrcs:p,id:g}]=o;switch(u){case Te.LocalVideoTrack:c=Pe(s=h._hints).call(s,Zt.SCREEN_TRACK)?Ht.Screen:Ht.High;break;case Te.LocalAudioTrack:c=Ht.Audio;break;case Te.LocalVideoLowTrack:c=Ht.Low}return{stream_type:c,ssrcs:p,mid:g}})}assignLocalTracks(r,o){r.forEach((s,c)=>{let{track:u,type:h}=s;this.localTrackMap.set(h,{track:u,id:o[c].id,ssrcs:o[c].localSSRC})})}withdrawLocalTracks(r){r.forEach(o=>{let[s]=o;this.localTrackMap.delete(s)})}bindConnectionEvents(r){r.onConnectionStateChange=async o=>{var s;L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(r.name,".onConnectionStateChange(").concat(o,")")),this.emit(Ye.PeerConnectionStateChange,o),o!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),o==="connected"&&(r.isInRestartIce=!1),Pe(s=this._restartStates).call(s,o)&&!r.isInRestartIce&&(o==="disconnected"&&await Kr(800),r.iceConnectionState!=="disconnected"&&r.iceConnectionState!=="failed"||this.handleDisconnect(r.direction))},r.onICEConnectionStateChange=o=>{o!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(o,")")),We.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:o,tag:Nn.TRACER}).onSuccess(),this.emit(Ye.IceConnectionStateChange,o)},r.onICETransportStateChange=o=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(o,")"))},r.onDTLSTransportStateChange=o=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(o,")"))},r.onDTLSTransportError=o=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(o,")"))},r.onFirstAudioDecoded=o=>{var s;const c=Array.from(ts(s=this.remoteUserMap).call(s)).find(h=>h._audioSSRC===o);var u;c&&(this.store.subscribe(c.uid,"audio",void 0,void 0,void 0,Date.now()),(u=c.audioTrack)===null||u===void 0||u.emit(Cm.FIRST_FRAME_DECODED),We.firstRemoteFrame(this.store.sessionId,Ar.FIRST_AUDIO_DECODE,Tn.FIRST_AUDIO_DECODE,{peer:c._uintid,subscribeElapse:gi.measureFromSubscribeStart(this.store.clientId,o),subscribeRequestid:o,p2pid:this.store.p2pId}))},r.onFirstAudioReceived=o=>{var s;const c=Array.from(ts(s=this.remoteUserMap).call(s)).find(u=>u._audioSSRC===o);c&&We.firstRemoteFrame(this.store.sessionId,Ar.FIRST_AUDIO_RECEIVED,Tn.FIRST_AUDIO_RECEIVED,{peer:c._uintid,subscribeElapse:gi.measureFromSubscribeStart(this.store.clientId,o),subscribeRequestid:o,p2pid:this.store.p2pId})},r.onFirstVideoDecoded=(o,s,c)=>{this.reportVideoFirstFrameDecoded(o,s,c)},r.onFirstVideoReceived=o=>{var s;const c=Array.from(ts(s=this.remoteUserMap).call(s)).find(u=>u._videoSSRC===o);c&&We.firstRemoteFrame(this.store.sessionId,Ar.FIRST_VIDEO_RECEIVED,Tn.FIRST_VIDEO_RECEIVED,{peer:c._uintid,subscribeElapse:gi.measureFromSubscribeStart(this.store.clientId,o),subscribeRequestid:o,p2pid:this.store.p2pId})},r.onSelectedLocalCandidateChanged=(o,s)=>{const c=o.candidateType==="relay",u=s.candidateType==="relay";s.candidateType!=="unknown"&&c===u||this.emit(Ye.ConnectionTypeChange,c),L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(gd(s))," -> ").concat(JSON.stringify(gd(o)),")"))},r.onSelectedRemoteCandidateChanged=(o,s)=>{L.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(gd(s))," -> ").concat(JSON.stringify(gd(o)),")"))},r.onFirstVideoDecodedTimeout=o=>{this.reportVideoFirstFrameDecoded(o,void 0,void 0,!0)},r.onLocalCandidate=o=>{this.emit(Ye.LocalCandidate,{candidate:o,direction:r.direction})}}unbindConnectionEvents(r){r.onConnectionStateChange=void 0,r.onICEConnectionStateChange=void 0,r.onICETransportStateChange=void 0,r.onDTLSTransportStateChange=void 0,r.onDTLSTransportError=void 0,r.onFirstAudioDecoded=void 0,r.onFirstAudioReceived=void 0,r.onFirstVideoDecoded=void 0,r.onFirstVideoReceived=void 0,r.onSelectedLocalCandidateChanged=void 0,r.onSelectedRemoteCandidateChanged=void 0,r.onFirstVideoDecodedTimeout=void 0,r.onLocalCandidate=void 0}async handleDisconnect(r){const o=r===$i.SEND_ONLY?this.sendConnection:this.recvConnection;o&&!o.isInRestartIce&&(o.isInRestartIce=!0,L.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(o.name,"] start use restartICE")),r===$i.SEND_ONLY?this.restartICE(r):oi(this,Ye.RequestP2PRestartICE,{direction:$i.SEND_ONLY}))}filterTobeMutedTracks(r){const o=[];if(this.getAllTracks().indexOf(r)===-1)return o;const s=this.localTrackMap.get(Te.LocalAudioTrack);if(r instanceof jn&&(s==null?void 0:s.track)instanceof lr)return s.track.isActive||o.push([Te.LocalAudioTrack,s]),o;const c=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:h}]=u;return r===h});if(c&&(o.push(c),c[0]===Te.LocalVideoTrack)){const u=this.localTrackMap.get(Te.LocalVideoLowTrack);u&&o.push([Te.LocalVideoLowTrack,u])}return o}filterTobeUnmutedTracks(r){const o=[],s=this.localTrackMap.get(Te.LocalAudioTrack);if(r instanceof jn&&(s==null?void 0:s.track)instanceof lr)return s.track.isActive&&o.push([Te.LocalAudioTrack,s]),o;const c=Array.from(this.localTrackMap.entries()).find(u=>{let[,{track:h}]=u;return r===h});if(c)if(c[0]===Te.LocalVideoTrack){o.push(c);const u=this.localTrackMap.get(Te.LocalVideoLowTrack);u&&o.push([Te.LocalVideoLowTrack,u])}else o.push(c);return o}createMuteMessage(r){return r.map(o=>{var s;let c,[u,{track:h,ssrcs:p,id:g}]=o;switch(u){case Te.LocalAudioTrack:c=Ht.Audio;break;case Te.LocalVideoTrack:c=Pe(s=h._hints).call(s,Zt.SCREEN_TRACK)?Ht.Screen:Ht.High;break;case Te.LocalVideoLowTrack:c=Ht.Low}return{stream_type:c,ssrcs:p,mid:g}})}createUnmuteMessage(r){return r.map(o=>{var s;let c,[u,{track:h,ssrcs:p,id:g}]=o;switch(u){case Te.LocalAudioTrack:c=Ht.Audio;break;case Te.LocalVideoTrack:c=Pe(s=h._hints).call(s,Zt.SCREEN_TRACK)?Ht.Screen:Ht.High;break;case Te.LocalVideoLowTrack:c=Ht.Low}return{stream_type:c,ssrcs:p,mid:g}})}filterTobeUnSubscribedTracks(r,o){const s=[],c=this.remoteUserMap.get(r);if(!c)return s;if(o){const u=c.get(o);if(!u)return s;s.push([r,{kind:o,id:u}])}else Array.from(c.entries()).forEach(u=>{let[h,p]=u;s.push([r,{kind:h,id:p}])});return s}createUnsubscribeMessage(r){const o=[];return r.forEach(s=>{let[c,{kind:u,id:h}]=s;switch(u){case je.VIDEO:return void(c._videoSSRC&&o.push({stream_type:je.VIDEO,ssrcId:c._videoSSRC}));case je.AUDIO:return void(c._audioSSRC&&o.push({stream_type:je.AUDIO,ssrcId:c._audioSSRC}))}}),o}withdrawRemoteTracks(r){r.forEach(o=>{let[s,{kind:c}]=o;const u=this.remoteUserMap.get(s);u&&(u.delete(c),Array.from(u.entries()).length===0&&this.remoteUserMap.delete(s))})}async updateBitrateLimit(r){const o=this.localTrackMap.get(Te.LocalVideoTrack),s=this.localTrackMap.get(Te.LocalVideoLowTrack);o&&(await o.track.setBitrateLimit(r.uplink),await new De((c,u)=>{this.handleUpdateVideoEncoder(o.track,c,u,!0)})),s&&r.low_stream_uplink&&(await s.track.setBitrateLimit({max_bitrate:r.low_stream_uplink.bitrate,min_bitrate:r.low_stream_uplink.bitrate||0}),await new De((c,u)=>{this.handleUpdateVideoEncoder(s.track,c,u,!0)}))}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const r=this.sendConnection.peerConnectionState,o=this.recvConnection.peerConnectionState;return r!=="connected"&&o!=="connected"}return!0}async tryToUnmuteAudio(r){for(let o=0;o<r.length;o++)if(r[o]instanceof jn){const s=this.filterTobeUnmutedTracks(r[o]);if(s.length===0)continue;const c=this.createUnmuteMessage(s);return void await rn(this,Ye.RequestUnmuteLocal,c)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=r=>this.getStats(r),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter(r=>{let[,{ssrcs:o}]=r;return!!o}),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=r=>{var o;return!((o=this.recvConnection)===null||o===void 0||!o.getRemoteVideoIsReady(r))},this.statsUploader.requestUpload=(r,o)=>this.emit(Ye.RequestUpload,r,o),this.statsUploader.requestUploadStats=r=>this.emit(Ye.RequestUploadStats,r),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await Kr(g1(this.dtlsFailedCount,rr)),this.emit(Ye.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(Te.LocalVideoTrack)||this.pendingLocalTracks.some(r=>r instanceof pn)}throwIfTrackTypeNotMatch(r){if(r.filter(o=>o instanceof pn).length>1)throw new ve(Y.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(r.filter(o=>o instanceof jn).length>1&&(r.some(o=>o instanceof jn&&o._bypassWebAudio)||!xt().webAudioMediaStreamDest))throw new ve(Y.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const o of r){if(o instanceof pn&&this.pendingLocalTracks.some(s=>s instanceof pn))throw new ve(Y.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(o instanceof jn&&this.pendingLocalTracks.some(s=>s instanceof jn)&&(!xt().webAudioMediaStreamDest||o._bypassWebAudio||this.pendingLocalTracks.some(s=>s instanceof jn&&s._bypassWebAudio)))throw new ve(Y.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(r,o){const s=!q("DISABLE_DUAL_STREAM_USE_ENCODING")&&xt().supportDualStreamEncoding,c=YT(YT({},{width:160,height:120,framerate:15,bitrate:50}),o);let u;u=s?r._mediaStreamTrack.clone():RD(r,c);const h=cn(8,"track-low-"),p=new pn(u,YT(YT({},s&&{scaleResolutionDownBy:cD(c,r)}),{},{frameRate:c.framerate,bitrateMax:c.bitrate,bitrateMin:c.bitrate}),void 0,void 0,h);return p.on(cf.TRANSCEIVER_UPDATED,g=>{r._updateRtpTransceiver(g,wm.LOW_STREAM)}),p._hints.push(Zt.LOW_STREAM),r.addListener(Fe.NEED_CLOSE,()=>{p.close()}),p}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(r,o,s,c){var u;const h=Array.from(ts(u=this.remoteUserMap).call(u)).find(p=>p._videoSSRC===r);if(h){c||this.store.subscribe(h.uid,"video",void 0,void 0,void 0,void 0,Date.now());const p=this.store.keyMetrics,g=p.subscribe.find(y=>y.userId===h.uid&&y.type==="video");We.firstRemoteVideoDecode(this.store.sessionId,Ar.FIRST_VIDEO_DECODE,Tn.FIRST_VIDEO_DECODE,{peer:h._uintid,videowidth:o,videoheight:s,subscribeElapse:gi.measureFromSubscribeStart(this.store.clientId,r),subscribeRequestid:r,p2pid:this.store.p2pId,apEnd:p.requestAPEnd||0,apStart:p.requestAPStart||0,joinGwEnd:p.joinGatewayEnd||0,joinGwStart:p.joinGatewayStart||0,pcEnd:p.peerConnectionEnd||0,pcStart:p.peerConnectionStart||0,subscriberEnd:(g==null?void 0:g.subscribeEnd)||0,subscriberStart:(g==null?void 0:g.subscribeStart)||0,videoAddNotify:(g==null?void 0:g.streamAdded)||0,state:c?1:0})}}async remoteMediaSsrcChanged(r,o,s){if(!this.recvConnection)return!1;const c=this.remoteUserMap.get(r);if(!c)return!1;const u=c.get(o);if(!u)return!1;const h=await this.recvConnection.getRemoteSSRC(u);return h!==void 0&&h!==s}isPreSubScribe(r){return!1}async publishDataChannel(r){throw new ve(Y.NOT_SUPPORTED)}async unpublishDataChannel(r){throw new ve(Y.NOT_SUPPORTED)}async subscribeDataChannel(r,o){throw new ve(Y.NOT_SUPPORTED)}async unsubscribeDataChannel(r,o){throw new ve(Y.NOT_SUPPORTED)}hasPendingRemoteDataChannel(r,o){throw new ve(Y.NOT_SUPPORTED)}setPendingRemoteDataChannel(r,o){throw new ve(Y.NOT_SUPPORTED)}async preConnect(r){throw new ve(Y.NOT_SUPPORTED)}getEstablishParams(){throw new ve(Y.NOT_SUPPORTED)}async reSubscribe(r){throw new ve(Y.NOT_SUPPORTED)}async updateVideoStreamParameter(r,o){throw new ve(Y.NOT_SUPPORTED)}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(r=>{let[o,{track:s}]=r;o===Te.LocalVideoLowTrack?s._updateRtpTransceiver(void 0,wm.LOW_STREAM):s._updateRtpTransceiver(void 0)})}},$e(Rn.prototype,"p2pConnect",[K9],Object.getOwnPropertyDescriptor(Rn.prototype,"p2pConnect"),Rn.prototype),$e(Rn.prototype,"unpublish",[z9],Object.getOwnPropertyDescriptor(Rn.prototype,"unpublish"),Rn.prototype),$e(Rn.prototype,"unpublishLowStream",[Y9],Object.getOwnPropertyDescriptor(Rn.prototype,"unpublishLowStream"),Rn.prototype),$e(Rn.prototype,"subscribe",[q9],Object.getOwnPropertyDescriptor(Rn.prototype,"subscribe"),Rn.prototype),$e(Rn.prototype,"mockSubscribe",[X9],Object.getOwnPropertyDescriptor(Rn.prototype,"mockSubscribe"),Rn.prototype),$e(Rn.prototype,"unsubscribe",[J9],Object.getOwnPropertyDescriptor(Rn.prototype,"unsubscribe"),Rn.prototype),$e(Rn.prototype,"muteRemote",[Q9],Object.getOwnPropertyDescriptor(Rn.prototype,"muteRemote"),Rn.prototype),$e(Rn.prototype,"unmuteRemote",[Z9],Object.getOwnPropertyDescriptor(Rn.prototype,"unmuteRemote"),Rn.prototype),$e(Rn.prototype,"hasRemoteMediaWithLock",[e7],Object.getOwnPropertyDescriptor(Rn.prototype,"hasRemoteMediaWithLock"),Rn.prototype),$e(Rn.prototype,"disconnectForReconnect",[t7],Object.getOwnPropertyDescriptor(Rn.prototype,"disconnectForReconnect"),Rn.prototype),$e(Rn.prototype,"remoteMediaSsrcChanged",[n7],Object.getOwnPropertyDescriptor(Rn.prototype,"remoteMediaSsrcChanged"),Rn.prototype),Rn);function uc(r){return function(o,s,c){const u=o[s];if(typeof u!="function")throw new Error("Cannot use mutex on object property.");return c.value=async function(){for(var h=arguments.length,p=new Array(h),g=0;g<h;g++)p[g]=arguments[g];switch(r){case lc.SEND_ONLY:{const y=await this.sendMutex.lock("From P2PChannel2.".concat(s));try{return await u.apply(this,p)}finally{y()}}case lc.RECEIVE_ONLY:{const y=await this.recvMutex.lock("From P2PChannel2.".concat(s));try{return await u.apply(this,p)}finally{y()}}default:{const y=await this.sendMutex.lock("From P2PChannel2.".concat(s)),b=await this.recvMutex.lock("From P2PChannel2.".concat(s));try{return await u.apply(this,p)}finally{y(),b()}}}},c}}class Rf extends An{constructor(o,s){super(),G(this,"signal",void 0),G(this,"token",void 0),G(this,"tokenTimeout",void 0),G(this,"tokenInterval",void 0),G(this,"_sequence",0),G(this,"userMap",new Map),G(this,"encoder",new TextEncoder),this.signal=o,this.token=s;const c=()=>{this.signal.connectionState===dn.CONNECTED&&this.check(),this.userMap.size===0?this.tokenInterval=window.setTimeout(c,1e3):this.tokenInterval=window.setTimeout(c,3*q("P2P_TOKEN_INTERVAL"))};c()}async send(o,s,c,u,h){var p;if(this.userMap.size===0)return;const g=Array.from(xo(p=this.userMap).call(p))[0].token;typeof s!="string"&&(s=JSON.stringify(s)),u=u??cn(6,""),h=h??this._sequence++;const y={_id:u,_type:o,_seq:h,_message:s,token:"".concat(this.token,"_").concat(g)};q("SHOW_P2P_LOG")&&L.debug("send message",y,"noNeedResponse : ".concat(c)),this.splitMessage(JSON.stringify(y)).forEach(w=>{this.signal.request(tt.DATA_STREAM,{payload:dd(this.encoder.encode(w))})});const b=new De((w,C)=>{const A=window.setTimeout(()=>{this.off("res-@".concat(u,"_ack"),x),this.off("res-@".concat(u),U),this.off(Mm.ABORT,B),L.debug("[external-signal] request timeout, type: ".concat(o,", requestId: ").concat(u)),this.userMap.size===0?C(new ve(Y.INVALID_REMOTE_USER)):C(new ve(Y.TIMEOUT))},q("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),x=()=>{A&&window.clearTimeout(A),this.off(Mm.ABORT,B),c&&w()},B=()=>{A&&window.clearTimeout(A),this.off("res-@".concat(u,"_ack"),x),this.off("res-@".concat(u),U),C(new ve(Y.EXTERNAL_SIGNAL_ABORT,"type: ".concat(o,", requestId: ").concat(u)))};this.once(Mm.ABORT,B),this.once("res-@".concat(u,"_ack"),x);const U=(K,z)=>{F=!0,A&&window.clearTimeout(A),this.off("res-@".concat(u,"_ack"),x),this.off(Mm.ABORT,B),K==="success"?w(z):C(new ve(Y.P2P_MESSAGE_FAILED,"request ".concat(o," failed, requestId: ").concat(u)))};let F=!1;c||(this.once("res-@".concat(u),U),Kr(q("SIGNAL_REQUEST_TIMEOUT")).then(()=>{F||L.warning("external_signal request timeout, type: ".concat(o,", requestId: ").concat(u,", ").concat(y))}))});try{return await b}catch(w){if(w.code===Y.TIMEOUT)return await this.send(o,s,c,u,h);throw w}}onMessage(o){var s;const{_uid:c}=o;let u,h=this.userMap.get(c);if(h)u=h.splitMessageMap;else{if(this.userMap.size>0||!("_type"in o)||o._type!==Wn.CHECK)return;const{token:b}=o;u=new Map,h={uid:c,isStart:!0,token:b,splitMessageMap:u,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(c,h),this.signal.emit(bt.ON_USER_ONLINE,{uid:c}),this.handleUserOnline()}if("id"in o&&"total"in o){var p;const{id:b,total:w}=o,C=(p=u.get(b))!==null&&p!==void 0?p:[];if(C.push(o),u.has(b)||u.set(b,C),C.length!==w)return;{const A=Yh(C).call(C,(x,B)=>x.index-B.index).map(x=>x.payload).join("");u.delete(b),(o=JSON.parse(A))._uid=c}}const{_type:g,token:y}=o;if(Pe(s=[Wn.ACK,Wn.CHECK]).call(s,g))return g===Wn.CHECK&&this.handleCheckToken(h,y),void this.receiveMessage(o);y==="".concat(h.token,"_").concat(this.token)?this.handleReceivedMessage(o):L.debug('Receive unexpected message", '.concat(y,", cur_token: ").concat(h.token,"_").concat(this.token),o)}check(){const o={_id:cn(6,""),token:this.token,_type:Wn.CHECK};q("SHOW_P2P_LOG")&&L.debug("send message",o),this.signal.request(tt.DATA_STREAM,{payload:dd(this.encoder.encode(JSON.stringify(o)))})}ack(o){const s={_id:o,_type:Wn.ACK,token:this.token};q("SHOW_P2P_LOG")&&L.debug("send message",s),this.signal.request(tt.DATA_STREAM,{payload:dd(this.encoder.encode(JSON.stringify(s)))})}response(o,s,c){this.send(Wn.RESPONSE,JSON.stringify({success:!c,message:s}),!0,o)}handleReceivedMessage(o){const s=()=>{this.userMap.forEach(b=>{const{receivedMessagesMap:w,nextExpectedSequenceNumber:C}=b;for(;w.has(C);){const A=w.get(C);w.delete(C),this.receiveMessage(A),b.nextExpectedSequenceNumber++}})};if(!o)return void s();const{_uid:c,_seq:u}=o,h=this.userMap.get(c),{receivedMessagesMap:p,isStart:g,nextExpectedSequenceNumber:y}=h;if(u<y)return this.ack(o._id),void L.debug("[external-signal] receive old message, seq: ".concat(u,", ").concat(o._message));p.set(u,o),g&&u===y&&(this.receiveMessage(o),p.delete(y),h.nextExpectedSequenceNumber++,s())}receiveMessage(o){const{_id:s,_type:c,_message:u,_uid:h}=o;if(q("SHOW_P2P_LOG")&&L.debug("receive message",o),s){let p;switch(o._type!==Wn.ACK&&(u&&(p=JSON.parse(u)),this.ack(o._id)),o._type){case Wn.CANDIDATE:case Wn.CONTROL:this.signal.emit(c,p,h);break;case Wn.PUBLISH:case Wn.UNPUBLISH:case Wn.RESTART_ICE:case Wn.CALL:p.uid=h,oi(this.signal,c,p).then(g=>{this.response(o._id,g)}).catch(()=>{this.response(o._id,void 0,!0)});break;case Wn.ACK:this.getListeners("res-@".concat(s,"_ack")).length>0&&this.emit("res-@".concat(s,"_ack"));break;case Wn.RESPONSE:{const{success:g,message:y}=p;this.emit("res-@".concat(s),g?"success":"failed",y);break}}}}splitMessage(o){if(o.length<Rf.MAX_MESSAGE_SIZE)return[o];const s=[],{remoteToken:c}=JSON.parse(o),u=cn(6,"");let h=0,p=800;const g=Math.ceil(o.length/p);for(;o.length>0;){h++;const y={id:u,index:h,total:g,payload:o.slice(0,p),token:"".concat(this.token,"_").concat(c)};JSON.stringify(y).length>Rf.MAX_MESSAGE_SIZE?p-=50:(s.push(y),o=o.slice(p))}return s.map(y=>JSON.stringify(y))}handleCheckToken(o,s){return o.token!==s?(L.debug("token changed, from ".concat(o.token," to ").concat(s)),this.reset(o.uid,s),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout(()=>{L.debug("token timeout, ".concat(s)),this.reset(o.uid)},q("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const o=await oi(this.signal,Wn.CALL,void 0),s=await this.send(Wn.CALL,o);this.signal.emit(it.P2P_CONNECTION,s,!0)}async reset(o,s){const c=this.userMap.get(o);c&&(this.emit(Mm.ABORT),this.signal.emit(bt.ON_USER_OFFLINE,{uid:c.uid,reason:lxe.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),s||(L.debug("change local token from ".concat(s," to ").concat(s)),this.token=cn(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(Mm.ABORT)}}G(Rf,"MAX_SIZE",1),G(Rf,"MAX_MESSAGE_SIZE",1024);class HNe extends An{get connectionState(){return this._connectionState}set connectionState(o){o!==this._connectionState&&(this._connectionState=o,o===dn.CONNECTED?this.emit(it.WS_CONNECTED):o===dn.RECONNECTING?this.emit(it.WS_RECONNECTING,this._websocketReconnectReason):o===dn.CLOSED&&this.emit(it.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(o,s){super(),G(this,"_disconnectedReason",void 0),G(this,"_websocketReconnectReason",void 0),G(this,"_connectionState",dn.CLOSED),G(this,"reconnectToken",void 0),G(this,"p2pToken",void 0),G(this,"websocket",void 0),G(this,"openConnectionTime",void 0),G(this,"clientId",void 0),G(this,"lastMsgTime",Date.now()),G(this,"uploadCache",[]),G(this,"uploadCacheInterval",void 0),G(this,"rttRolling",new k8(5)),G(this,"pingpongTimer",void 0),G(this,"pingpongTimeoutCount",0),G(this,"joinResponse",void 0),G(this,"multiIpOption",void 0),G(this,"initError",void 0),G(this,"spec",void 0),G(this,"store",void 0),G(this,"_external_signal",void 0),G(this,"onWebsocketMessage",c=>{if(c.data instanceof ArrayBuffer)return void this.emit(it.ON_BINARY_DATA,c.data);const u=JSON.parse(c.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(u,"_id")){const h="res-@".concat(u._id);this.emit(h,u._result,u._message)}else if(Object.prototype.hasOwnProperty.call(u,"_type")){switch(u._type){case bt.ON_DATA_STREAM:return void this.handleDataStream(u._message);case bt.MUTE_AUDIO:case bt.MUTE_VIDEO:case bt.ON_P2P_LOST:case bt.ON_USER_ONLINE:return;case bt.ON_USER_OFFLINE:const{uid:h}=u._message;return L.debug("[".concat(this.clientId,"] user-offline uid: ").concat(h)),void this._external_signal.reset(h)}if(this.emit(u._type,u._message),u._type===bt.ON_NOTIFICATION&&this.handleNotification(u._message),u._type===bt.ON_USER_BANNED)switch(u._message.error_code){case 14:this.close(Bt.UID_BANNED);break;case 15:this.close(Bt.IP_BANNED);break;case 16:this.close(Bt.CHANNEL_BANNED)}if(u._type===bt.ON_USER_LICENSE_BANNED)switch(u._message.error_code){case Xe.ERR_LICENSE_MISSING:this.close(Bt.LICENSE_MISSING);break;case Xe.ERR_LICENSE_EXPIRED:this.close(Bt.LICENSE_EXPIRED);break;case Xe.ERR_LICENSE_MINUTES_EXCEEDED:this.close(Bt.LICENSE_MINUTES_EXCEEDED);break;case Xe.ERR_LICENSE_PERIOD_INVALID:this.close(Bt.LICENSE_PERIOD_INVALID);break;case Xe.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(Bt.LICENSE_MULTIPLE_SDK_SERVICE);break;case Xe.ERR_LICENSE_ILLEGAL:this.close(Bt.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=o.clientId,this.spec=o,this.store=s,this.websocket=new sD("gateway-".concat(this.clientId),this.spec.retryConfig,!0,q("JOIN_GATEWAY_USE_DUAL_DOMAIN"),q("JOIN_GATEWAY_USE_443PORT_ONLY"),s),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===dn.CONNECTED&&this.reconnect("retry",ii.OFFLINE)}),this.p2pToken=cn(6,""),this._external_signal=new Rf(this,this.p2pToken)}async request(o,s,c,u){const h=cn(6,""),p={_id:h,_type:o,_message:s},g=this.websocket.connectionID,y=()=>new De((B,U)=>{if(this.connectionState===dn.CONNECTED)return B();const F=()=>{this.off(it.WS_CLOSED,K),B()},K=()=>{this.off(it.WS_CONNECTED,F),U(new ve(Y.WS_ABORT))};this.once(it.WS_CONNECTED,F),this.once(it.WS_CLOSED,K)});if(this.connectionState!==dn.CONNECTING&&this.connectionState!==dn.RECONNECTING||o===tt.JOIN||o===tt.REJOIN||await y(),this.websocket.sendMessage(p,!0),u)return;const b=new De((B,U)=>{let F=!1;const K=(Q,ie)=>{F=!0,B({isSuccess:Q==="success",message:ie||{}}),this.off(it.WS_CLOSED,z),this.off(it.WS_RECONNECTING,z),this.emit(it.REQUEST_SUCCESS,o,s)};this.once("res-@".concat(h),K);const z=()=>{U(new ve(Y.WS_ABORT,"type: ".concat(o))),this.off(it.WS_CLOSED,z),this.off(it.WS_RECONNECTING,z),this.off("res-@".concat(h),K)};this.once(it.WS_CLOSED,z),this.once(it.WS_RECONNECTING,z),Kr(q("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==g||F||(L.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(o)),this.emit(it.REQUEST_TIMEOUT,o,s))})});let w=null;try{w=await b}catch(B){if(this.connectionState===dn.CLOSED||o===tt.LEAVE)throw new ve(Y.WS_ABORT);return!this.spec.forceWaitGatewayResponse||c?B.throw():o===tt.JOIN||o===tt.REJOIN?null:(await y(),await this.request(o,s))}if(w.isSuccess)return w.message;const C=Number(w.message.error_code||w.message.code),A=y_(C),x=new ve(Y.UNEXPECTED_RESPONSE,"".concat(A.desc,": ").concat(w.message.error_str),{code:C,data:w.message,desc:A.desc});return A.action==="success"?w.message:(L.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(o,", error_code: ").concat(C,", message: ").concat(A.desc,", action: ").concat(A.action)),C===Xe.ERR_TOO_MANY_BROADCASTERS?((o===tt.JOIN||o===tt.REJOIN)&&(this.initError=x,this.close()),x.throw()):A.action==="failed"?x.throw():A.action==="quit"?(this.initError=x,this.close(),x.throw()):(C===Xe.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=w.message.option,L.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",ii.MULTI_IP)):this.reconnect(A.action,ii.SERVER_ERROR),o===tt.JOIN||o===tt.REJOIN?null:await this.request(o,s)))}waitMessage(o,s){return new De(c=>{const u=h=>{(!s||s(h))&&(this.off(o,u),c(h))};this.on(o,u)})}uploadWRTCStats(o){if(!this.store.sessionId)return void L.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const s={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:o};this.upload(g_.WRTC_STATS,s)}upload(o,s){const c={_type:o,_message:s};try{this.websocket.sendMessage(c)}catch{const h=q("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(c),this.uploadCache.length>h&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==dn.CONNECTED)return;const p=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(p._type,p._message)},q("UPLOAD_CACHE_INTERVAL")||2e3))}}send(o,s){const c={_type:o,_message:s};this.websocket.sendMessage(c)}async sendExtensionMessage(o,s,c){return await this._external_signal.send(o,s,c)}init(o){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new De((s,c)=>{this.once(it.WS_CONNECTED,()=>s(this.joinResponse)),this.once(it.WS_CLOSED,()=>c(this.initError||new ve(Y.WS_ABORT))),this.connectionState=dn.CONNECTING,this.websocket.init(o).catch(c)})}close(o){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=o||Bt.LEAVE,this.connectionState=dn.CLOSED,L.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),this.p2pToken=cn(6,""),this._external_signal.clear(),this._external_signal=new Rf(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(it.ABORT_P2P_EXECUTION);const o=await oi(this,it.REQUEST_JOIN_INFO),s=await this.request(tt.JOIN,o);if(!s)return this.emit(it.REPORT_JOIN_GATEWAY,Y.TIMEOUT,this.url||""),!1;this.joinResponse=s,this.emit(it.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=dn.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(o,s){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(o,s)}handleDataStream(o){try{var s;const c=of(o.payload),u=new TextDecoder().decode(c),h=JSON.parse(u);"total"in h&&"id"in h||Pe(s=Object.values(Wn)).call(s,h._type)?(h._uid=o.uid,this._external_signal.onMessage(h)):this.emit(bt.ON_DATA_STREAM,o)}catch{this.emit(bt.ON_DATA_STREAM,o)}}handleNotification(o){L.debug("[".concat(this.clientId,"] receive notification: "),o);const s=y_(o.code);if(s.action!=="success"){if(s.action!=="failed")return s.action==="quit"?(s.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(Bt.UID_BANNED),void this.close()):void this.reconnect(s.action,ii.SERVER_ERROR);L.error("[".concat(this.clientId,"] ignore error: "),s.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const o=q("PING_PONG_TIME_OUT"),s=Date.now();this.pingpongTimeoutCount>=o&&(L.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(s-this.lastMsgTime,"ms")),s-this.lastMsgTime>q("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",ii.TIMEOUT):this.request(tt.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const c=Date.now()-s;this.rttRolling.add(c),q("REPORT_STATS")&&this.send(tt.PING_BACK,{pingpongElapse:c})}).catch(c=>{})}handleWebsocketEvents(){this.websocket.on(lt.RECONNECT_CREATE_CONNECTION,o=>{this.emit(it.WS_RECONNECT_CREATE_CONNECTION,o)}),this.websocket.on(lt.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(lt.CLOSED,()=>{this.connectionState=dn.CLOSED}),this.websocket.on(lt.FAILED,()=>{this._disconnectedReason=Bt.NETWORK_ERROR,this.connectionState=dn.CLOSED}),this.websocket.on(lt.RECONNECTING,o=>{this._websocketReconnectReason=o,this.joinResponse=void 0,this.connectionState===dn.CONNECTED?this.connectionState=dn.RECONNECTING:this.connectionState=dn.CONNECTING}),this.websocket.on(lt.WILL_RECONNECT,(o,s,c)=>{o!=="retry"?(L.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(o)),this.reconnectToken=void 0):L.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),c(o)}),this.websocket.on(lt.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.join().catch(o=>{if(this.emit(it.REPORT_JOIN_GATEWAY,o,this.url||""),o instanceof ve&&o.code===Y.UNEXPECTED_RESPONSE&&o.data.code===Xe.ERR_NO_AUTHORIZED)return L.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",ii.SERVER_ERROR);L.error("[".concat(this.clientId,"] join gateway request failed"),o.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",ii.SERVER_ERROR):(this.initError=o,this.close())})}),this.websocket.on(lt.REQUEST_NEW_URLS,(o,s)=>{oi(this,it.REQUEST_RECOVER,this.multiIpOption).then(o).catch(s)}),this.websocket.on(lt.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(bt.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}const KNe={name:"P2PChannel",create:function(r){let{store:o,statsCollector:s}=r;return new GNe(o,s)},createSubmodule:function(r){let{store:o,spec:s}=r;return new HNe(s,o)}};function i7(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function o7(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?i7(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):i7(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}class zNe{constructor(o){G(this,"sessionDesc",void 0),G(this,"localCapabilities",void 0),G(this,"rtpCapabilities",void 0),G(this,"candidates",void 0),G(this,"_originCandidates",void 0),G(this,"iceParameters",void 0),G(this,"dtlsParameters",void 0),G(this,"setup",void 0),G(this,"currentMidIndex",void 0),G(this,"cname",void 0),o=On(o);const{iceParameters:s,dtlsParameters:c,candidates:u,rtpCapabilities:h,setup:p,localCapabilities:g,sdkCodec:y,cname:b}=o,w=ho(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=h,this.candidates=u,this._originCandidates=On(u),this.iceParameters=s,this.dtlsParameters=c,this.setup=p,this.localCapabilities=g,this.cname=b;for(let C=0;C<w.mediaDescriptions.length;C++){const A=w.mediaDescriptions[C];if(A.attributes.iceUfrag=s.iceUfrag,A.attributes.icePwd=s.icePwd,A.attributes.fingerprints=c.fingerprints,A.attributes.candidates=u,A.attributes.setup=p,A.media.mediaType==="video"){A.media.fmts=h.videoCodecs.map(B=>B.payloadType.toString(10));let x=h.videoCodecs.filter(B=>{var U,F;return(U=B.rtpMap)===null||U===void 0?void 0:Pe(F=U.encodingName.toLowerCase()).call(F,y)});x.length===0&&(x=h.videoCodecs),A.attributes.payloads=x,A.attributes.extmaps=h.videoExtensions}A.media.mediaType==="audio"&&(A.media.fmts=h.audioCodecs.map(x=>x.payloadType.toString(10)),A.attributes.payloads=h.audioCodecs,A.attributes.extmaps=h.audioExtensions),w.mediaDescriptions[C]=this.mungMediaDesc(A)}this.sessionDesc=w,this.currentMidIndex=w.mediaDescriptions.length-1}toString(){return hd(this.sessionDesc)}send(o,s,c){const{ssrcs:u,ssrcGroups:h}=mf(s,this.cname),p=this.sessionDesc.mediaDescriptions.find(b=>o===je.VIDEO?b.media.mediaType==="video":b.media.mediaType==="audio"),g=u[0].attributes.label,y=u[0].attributes.mslabel;return p.attributes.ssrcs=p.attributes.ssrcs.concat(u),p.attributes.ssrcGroups=p.attributes.ssrcGroups.concat(h),{id:g,mslabel:y}}batchSend(o){return o.map(s=>{let{kind:c,ssrcMsg:u}=s;return this.send(c,u,void 0)})}stopSending(o){this.sessionDesc.mediaDescriptions.forEach(s=>{const c=[],u=[],h=[];s.attributes.ssrcs.forEach(p=>{Pe(o).call(o,p.attributes.label||"")?h.push(p):c.push(p)}),s.attributes.ssrcGroups.forEach(p=>{var g;Pe(g=h.map(y=>y.ssrcId)).call(g,p.ssrcIds[0])||u.push(p)}),s.attributes.ssrcs=c,s.attributes.ssrcGroups=u})}mute(o){const s=this.sessionDesc.mediaDescriptions.find(c=>c.attributes.mid===o);if(!s)throw new Error("mediaDescription not found with ".concat(o," in remote SDP when calling RemoteSDP.mute."));s.attributes.direction="inactive"}unmute(o){const s=this.sessionDesc.mediaDescriptions.find(c=>c.attributes.mid===o);if(!s)throw new Error("mediaDescription not found with ".concat(o," in remote SDP when calling RemoteSDP.unmute."));s.attributes.direction="sendonly"}receive(o,s,c){o.forEach((u,h)=>{const p=u._mediaStreamTrack,g=this.sessionDesc.mediaDescriptions.findIndex(b=>b.attributes.mid===p.kind),y=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[g],u);this.sessionDesc.mediaDescriptions[g]=y})}stopReceiving(o){}updateCandidates(o){const s=this._originCandidates.filter(u=>u.transport==="udp"),c=[];if(s.forEach(u=>{c.push(o7(o7({},u),{},{foundation:"tcpcandidate",priority:Number(u.priority)-1+"",transport:"tcp",port:Number(u.port)+90+""}))}),s.length!==0){switch(o){case mi.TCP_RELAY:this.candidates=c;break;case mi.UDP_TCP_RELAY:case mi.RELAY:this.candidates=[...s,...c];break;default:this.candidates=s}for(const u of this.sessionDesc.mediaDescriptions)u.attributes.candidates=this.candidates}}restartICE(o){o=On(o),this.iceParameters=o,this.sessionDesc.mediaDescriptions.forEach(s=>{s.attributes.iceUfrag=o.iceUfrag,s.attributes.icePwd=o.icePwd})}predictReceivingMids(o){const s=[];for(let c=0;c<o;c++)s.push((this.currentMidIndex+c+1).toString(10));return s}mungRecvMediaDsec(o,s){const c=On(o);return Vm(c,s),uD(c,s),c}updateRecvMedia(o,s){const c=this.sessionDesc.mediaDescriptions.findIndex(u=>u.attributes.mid===o);if(c!==-1){const u=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[c],s);this.sessionDesc.mediaDescriptions[c]=u}}bumpMid(o){this.currentMidIndex+=o}updateTrackLabel(o,s,c){const u=this.sessionDesc.mediaDescriptions.find(p=>o===je.VIDEO?p.attributes.mid==="video":p.attributes.mid==="audio");if(u){const p=u.attributes.ssrcs.find(g=>g.attributes.label===s);var h;p&&(p.attributes.label=c,(h=p.attributes.msid)===null||h===void 0||h.replace(s,c))}}mungMediaDesc(o){const s=On(o);return lD(s),function(c){const u=c.attributes.extmaps.find(h=>dT(h.extensionName));u&&c.attributes.extmaps.splice(c.attributes.extmaps.indexOf(u),1),c.attributes.payloads.forEach(h=>{const p=h.rtcpFeedbacks.findIndex(g=>g.type==="transport-cc");p!==-1&&h.rtcpFeedbacks.splice(p,1)})}(s),s}getSSRC(o){for(const s of this.sessionDesc.mediaDescriptions)for(const c of s.attributes.ssrcs)if(c.attributes.label===o)return[c]}}var on;function s7(r,o){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);o&&(c=c.filter(function(u){return Object.getOwnPropertyDescriptor(r,u).enumerable})),s.push.apply(s,c)}return s}function qT(r){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?s7(Object(s),!0).forEach(function(c){G(r,c,s[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):s7(Object(s)).forEach(function(c){Object.defineProperty(r,c,Object.getOwnPropertyDescriptor(s,c))})}return r}let YNe=(on=class NE extends yz{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map(o=>o.rtpMap&&o.rtpMap.encodingName.toLowerCase()||"").filter(o=>{var s;return Pe(s=Object.keys(Bw)).call(s,o)}))]}constructor(o,s){super(o,s),G(this,"store",void 0),G(this,"peerConnection",void 0),G(this,"remoteSDP",void 0),G(this,"initialOffer",void 0),G(this,"statsFilter",void 0),G(this,"useRTX",!1),G(this,"localCapabilities",void 0),G(this,"localCandidateCount",0),G(this,"allCandidatesReceived",!1),G(this,"establishPromise",void 0),G(this,"mutex",void 0),this.store=s,this.mutex=new fi("P2PConnection-mutex",s.clientId),this.peerConnection=new RTCPeerConnection(NE.resolvePCConfiguration(o),{optional:[{googDscp:!0}]}),this.statsFilter=S1(this.peerConnection,q("STATS_UPDATE_INTERVAL"),void 0,xn()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const o=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!o.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const s=vd(o.sdp),c=b_(o.sdp,{filterRTX:!this.useRTX,filterVideoFec:q("FILTER_VIDEO_FEC"),filterAudioFec:q("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=c,this.initialOffer=o,qT(qT({},s),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:c},offerSDP:o.sdp})}catch(o){throw new ve(Y.GET_LOCAL_CONNECTION_PARAMS_FAILED,o.toString())}}async updateRemoteConnect(){}async connect(o){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new zNe(qT(qT({},o),{},{rtpCapabilities:o.rtpCapabilities.send,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec}));const s=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:s})}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(s.toString()))}}async updateRemoteRTPCapabilities(o,s){throw new ve(Y.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}getPreMedia(o){}send(o,s){var c=this;return Is(function*(){const u=yield Ot(c.mutex.lock());try{if(!c.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const h=o.map(A=>c.peerConnection.addTrack(A._mediaStreamTrack)),p=yield Ot(c.peerConnection.createOffer()),g=ho(p.sdp),y=o.map(A=>{const x=A._mediaStreamTrack,B=g.mediaDescriptions.find(U=>U.attributes.mid===x.kind);if(!B)throw new Error("Cannot extract ssrc from mediaDescription.");return function(U,F,K){const z=U.attributes.ssrcs.filter(ie=>ie.attributes.label===F),Q=U.attributes.ssrcGroups;if(z.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(Q&&z.length>1){const ie=Q.find(oe=>oe.ssrcIds.indexOf(z[0].ssrcId)!==-1);return ie?[{ssrcId:ie.ssrcIds[0],rtx:K?ie.ssrcIds[1]:void 0}]:[{ssrcId:z[0].ssrcId}]}return[{ssrcId:z[0].ssrcId}]}(B,x.id,c.useRTX)});let b;try{b=yield y}catch(A){throw h.forEach(x=>{ri()&&x.replaceTrack(null),c.peerConnection.removeTrack(x)}),A}const w=c.mungSendOfferSDP(p.sdp,o);c.remoteSDP.receive(o,s,b);const C=c.remoteSDP.toString();return yield Ot(c.peerConnection.setLocalDescription({type:"offer",sdp:w})),yield Ot(c.applySendEncodings(h,o)),yield Ot(c.peerConnection.setRemoteDescription({type:"answer",sdp:C})),o.map((A,x)=>{const B=A._mediaStreamTrack.id;return{localSSRC:y[x],id:B}})}catch(h){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(h.toString()))}finally{u()}})()}async stopSending(o){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const s=this.peerConnection.getSenders().filter(h=>{var p;return o.indexOf(((p=h.track)===null||p===void 0?void 0:p.id)||"")!==-1});if(s.length!==o.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");s.map(h=>{ri()&&h.replaceTrack(null),this.peerConnection.removeTrack(h)});const c=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(c),this.remoteSDP.stopReceiving(o);const u=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(s.toString()))}}async receive(o,s,c,u){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(o," before remoteSDP created."));const{id:h,mslabel:p}=this.remoteSDP.send(o,s,u),g=new De((w,C)=>{const A=setTimeout(()=>{C(new Error("Cannot receive track, id: ".concat(h)))},1e4),x=B=>{const U=It();if((U.name==="Safari"&&Number(U.version)===11||Vi())&&B.track.id!==h&&B.streams[0].id===p){var F;const K=B.streams[0].getTracks()[0];return(F=this.remoteSDP)===null||F===void 0||F.updateTrackLabel(o,h,B.track.id),this.peerConnection.removeEventListener("track",x),clearTimeout(A),void w(K)}if(B.track.id===h)return this.peerConnection.removeEventListener("track",x),clearTimeout(A),void w(B.track)};this.peerConnection.addEventListener("track",x)}),y=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:y});const b=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(b),{track:await g,id:h}}catch(h){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(h.toString()))}}async stopReceiving(o){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(o);const s=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const c=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(c)}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(s.toString()))}}async muteRemote(o){}async unmuteRemote(o){}async muteLocal(o){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const s=this.peerConnection.getSenders().filter(c=>{var u;return o.indexOf(((u=c.track)===null||u===void 0?void 0:u.id)||"")!==-1});if(s.length!==o.length)throw new Error("sender' length doesn't match mids' length.");s.map(c=>{if(ri()&&c.track)c.track.enabled=!1;else{const u=c.getParameters();u.encodings.forEach(h=>h.active=!1),c.setParameters(u)}})}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(s.toString()))}}async unmuteLocal(o){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const s=this.peerConnection.getSenders().filter(h=>{var p;return o.indexOf(((p=h.track)===null||p===void 0?void 0:p.id)||"")!==-1});if(s.length!==o.length)throw new Error("Senders' length doesn't match mids' length.");s.map(async h=>{if(ri()&&h.track)h.track.enabled=!0;else{const p=h.getParameters();p.encodings.forEach(g=>g.active=!0),await h.setParameters(p)}});const c=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(c);const u=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:u})}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(s.toString()))}}restartICE(o){var s=this;return Is(function*(){const c=yield Ot(s.mutex.lock("From P2PConnection.restartICE"));try{if(!s.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");const u=xt().supportPCSetConfiguration;if(o===mi.RELAY&&!u)return;if(u){const b=s.peerConnection.getConfiguration(),w=o===mi.RELAY?"relay":"all";b.iceTransportPolicy!==w&&(L.debug("[".concat(s.store.clientId,"] restartICE change iceTransportPolicy from [").concat(b.iceTransportPolicy,"] to [").concat(w,"]")),b.iceTransportPolicy=w,s.peerConnection.setConfiguration(b))}o!==mi.RELAY&&s.remoteSDP.updateCandidates(o);const h=yield Ot(s.peerConnection.createOffer({iceRestart:!0}));if(!h.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const p=vd(h.sdp),{remoteIceParameters:g}=yield p.iceParameters;s.remoteSDP.restartICE(g);const y=s.remoteSDP.toString();yield Ot(s.peerConnection.setLocalDescription(h)),yield Ot(s.peerConnection.setRemoteDescription({type:"answer",sdp:y}))}catch(u){L.warning("[".concat(s.store.clientId,"] restart ICE failed, abort operation"),u)}finally{c()}})()}close(){var o;this.peerConnection.close(),(o=this.onConnectionStateChange)===null||o===void 0||o.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(o){return this.statsFilter.getVideoIsReady(o)}async updateEncoderConfig(o,s){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const c=await this.peerConnection.createOffer(),u=this.mungSendOfferSDP(c.sdp,[s]);this.remoteSDP.updateRecvMedia(s._mediaStreamTrack.kind,s);const h=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:u}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:h})}catch(c){throw new ve(Y.EXCHANGE_SDP_FAILED,c.toString())}}async updateSendParameters(o,s){const c=this.peerConnection.getSenders().filter(u=>{var h;return((h=u.track)===null||h===void 0?void 0:h.id)===o});c.length===1&&await this.applySendEncodings(c,[s])}setStatsRemoteVideoIsReady(o,s){this.statsFilter.setVideoIsReady2(o,s)}async replaceTrack(o,s){const c=this.peerConnection.getSenders().find(u=>{var h;return((h=u.track)===null||h===void 0?void 0:h.id)===s});c&&await c.replaceTrack(o._mediaStreamTrack)}createDataChannels(o,s){throw new ve(Y.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(o){throw new ve(Y.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var o;(o=this.onICEConnectionStateChange)===null||o===void 0||o.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var o;(o=this.onConnectionStateChange)===null||o===void 0||o.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=o=>{o.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,L.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},q("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(o){const s={iceServers:[],sdpSemantics:"plan-b"};return o.iceServers?s.iceServers=o.iceServers:o.turnServer&&o.turnServer.mode!=="off"&&(a_(o.turnServer.servers)?s.iceServers=o.turnServer.servers:(s.iceServers&&s.iceServers.push(...NE.turnServerConfigToIceServers(o.turnServer.servers)),q("USE_TURN_SERVER_OF_GATEWAY")&&s.iceServers&&o.turnServer.serversFromGateway&&s.iceServers.push(...NE.turnServerConfigToIceServers(o.turnServer.serversFromGateway)),o.turnServer.servers.concat(o.turnServer.serversFromGateway||[]).forEach(c=>{c.forceturn&&(s.iceTransportPolicy="relay")}))),s}static turnServerConfigToIceServers(o){const s=[];return o.forEach(c=>{c.security?c.tcpport&&s.push({username:c.username,credential:c.password,credentialType:"password",urls:"turns:".concat(c.turnServerURL,":").concat(c.tcpport,"?transport=tcp")}):(c.udpport&&s.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":").concat(c.udpport,"?transport=udp")}),c.tcpport&&s.push({username:c.username,credential:c.password,credentialType:"password",urls:"turn:".concat(c.turnServerURL,":").concat(c.tcpport,"?transport=tcp")}))}),s}async updateRtpSenderEncodings(o,s){var c;if(s||(s=this.peerConnection.getSenders().find(b=>{var w;return((w=b.track)===null||w===void 0?void 0:w.id)===o._mediaStreamTrack.id})),!s)return L.warn("[".concat(o.getTrackId(),"] no rtpSender found}"));if(!xt().supportSetRtpSenderParameters)return L.warn("Browser not support set rtp-sender parameters");const u={},h={};if(o instanceof pn)switch(o._optimizationMode){case"motion":u.degradationPreference="maintain-framerate";break;case"detail":u.degradationPreference="maintain-resolution";break;default:u.degradationPreference="balanced"}if(q("DSCP_TYPE")&&Wl()){var p;const b=q("DSCP_TYPE");Pe(p=["very-low","low","medium","high"]).call(p,b)&&(h.networkPriority=b)}const g=s.getParameters(),y=(c=g.encodings)===null||c===void 0?void 0:c[0];y&&Object.assign(y,h),Object.assign(g,u),L.debug("[".concat(o.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(g.encodings))),await s.setParameters(g)}async applySendEncodings(o,s){try{if(!xt().supportSetRtpSenderParameters||o.length!==s.length)return;for(let c=0;c<o.length;c++){const u=o[c],h=s[c];u&&h&&await this.updateRtpSenderEncodings(h,u)}}catch{L.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(o,s){const c=ho(o);return s.forEach((u,h)=>{const p=u._mediaStreamTrack,g=c.mediaDescriptions.find(y=>y.attributes.mid===p.kind);g&&Vm(g,u)}),hd(c)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=o=>{var s;(s=this.onFirstAudioReceived)===null||s===void 0||s.call(this,o)},this.statsFilter.onFirstVideoReceived=o=>{var s;(s=this.onFirstVideoReceived)===null||s===void 0||s.call(this,o)},this.statsFilter.onFirstAudioDecoded=o=>{var s;(s=this.onFirstAudioDecoded)===null||s===void 0||s.call(this,o)},this.statsFilter.onFirstVideoDecoded=(o,s,c)=>{var u;(u=this.onFirstVideoDecoded)===null||u===void 0||u.call(this,o,s,c)},this.statsFilter.onSelectedLocalCandidateChanged=(o,s)=>{var c;(c=this.onSelectedLocalCandidateChanged)===null||c===void 0||c.call(this,o,s)},this.statsFilter.onSelectedRemoteCandidateChanged=(o,s)=>{var c;(c=this.onSelectedRemoteCandidateChanged)===null||c===void 0||c.call(this,o,s)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(o){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const s=this.remoteSDP.batchSend(o).map((h,p)=>{let{id:g,mslabel:y}=h;const{kind:b}=o[p];return new De((w,C)=>{const A=setTimeout(()=>{C(new Error("Cannot receive track, id: ".concat(g)))},1e4),x=B=>{const U=It();if(U.name==="Safari"&&Number(U.version)===11&&B.track.id!==g&&B.streams[0].id===y){var F;const K=B.streams[0].getTracks()[0];return(F=this.remoteSDP)===null||F===void 0||F.updateTrackLabel(b,g,B.track.id),this.peerConnection.removeEventListener("track",x),clearTimeout(A),void w({track:K,id:g})}if(B.track.id===g)return this.peerConnection.removeEventListener("track",x),clearTimeout(A),void w({track:B.track,id:g})};this.peerConnection.addEventListener("track",x)})}),c=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:c});const u=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(u),await De.all(s)}catch(s){throw new ve(Y.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(s.toString()))}}async getRemoteSSRC(o){if(!this.remoteSDP)return;const s=this.remoteSDP.getSSRC(o);return s==null?void 0:s[0].ssrcId}setConfiguration(o){if(xt().supportPCSetConfiguration){const s=NE.resolvePCConfiguration(o);this.peerConnection.setConfiguration(s)}}},$e(on.prototype,"connect",[Ms],Object.getOwnPropertyDescriptor(on.prototype,"connect"),on.prototype),$e(on.prototype,"stopSending",[Ms],Object.getOwnPropertyDescriptor(on.prototype,"stopSending"),on.prototype),$e(on.prototype,"receive",[Ms],Object.getOwnPropertyDescriptor(on.prototype,"receive"),on.prototype),$e(on.prototype,"stopReceiving",[Ms],Object.getOwnPropertyDescriptor(on.prototype,"stopReceiving"),on.prototype),$e(on.prototype,"muteRemote",[Ms],Object.getOwnPropertyDescriptor(on.prototype,"muteRemote"),on.prototype),$e(on.prototype,"unmuteRemote",[Ms],Object.getOwnPropertyDescriptor(on.prototype,"unmuteRemote"),on.prototype),$e(on.prototype,"muteLocal",[Ms],Object.getOwnPropertyDescriptor(on.prototype,"muteLocal"),on.prototype),$e(on.prototype,"unmuteLocal",[Ms],Object.getOwnPropertyDescriptor(on.prototype,"unmuteLocal"),on.prototype),$e(on.prototype,"close",[Ms],Object.getOwnPropertyDescriptor(on.prototype,"close"),on.prototype),$e(on.prototype,"updateEncoderConfig",[Ms],Object.getOwnPropertyDescriptor(on.prototype,"updateEncoderConfig"),on.prototype),$e(on.prototype,"updateSendParameters",[Ms],Object.getOwnPropertyDescriptor(on.prototype,"updateSendParameters"),on.prototype),$e(on.prototype,"replaceTrack",[Ms],Object.getOwnPropertyDescriptor(on.prototype,"replaceTrack"),on.prototype),$e(on.prototype,"getRemoteSSRC",[Ms],Object.getOwnPropertyDescriptor(on.prototype,"getRemoteSSRC"),on.prototype),on);function Ms(r,o,s){const c=r[o];if(typeof c!="function")throw new Error("Cannot use mutex on object property.");return s.value=async function(){const u=this.mutex,h=await u.lock("Locking from P2PConnection.".concat(o));try{for(var p=arguments.length,g=new Array(p),y=0;y<p;y++)g[y]=arguments[y];return await c.apply(this,g)}finally{h()}},s}const qNe={name:"PlanBConnection",create:function(r){let{store:o,spec:s}=r;return new YNe(s,o)}},XNe={interceptLocalAudioFrame:async function(r){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!xt().supportWebRTCEncodedTransform)return void L.warning("browser not support audio encoded transform");if(qw.has(r)||!r.track)return;const s={track:r.track};if($l()){if(!r.createEncodedStreams)return void L.warning("browser not support createEncodedStreams() API");let u=null;try{u=r.createEncodedStreams()}catch(p){return void L.error("create audio-encoded-streams error",p&&p.message)}const h=new TransformStream({transform(p,g){s.controller||(s.controller=g),r.track&&r.track.id!==s.track.id&&(L.debug("audio track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",c),s.track=r.track,s.track.addEventListener("ended",c));const y=o.metadata&&o.metadata();y?function(b,w){const{chunk:C,controller:A}=w,x=q("ENABLE_AUDIO_PTS_METADATA")?Kl.AUDIO_64_BIT_PTS:Kl.METADATA;C.data=function(B,U,F){const K=F.byteLength,z=K+K1+rz,Q=G1+H1+z,ie=new ArrayBuffer(B.byteLength+Q),oe=new DataView(ie);oe.setUint8(0,nz),oe.setUint16(1,z),oe.setUint8(3,U),oe.setUint16(4,K);for(let me=0;me<K;me++)oe.setUint8(6+me,F[me]);const re=new Uint8Array(oe.buffer);return re.set(new Uint8Array(B),Q),re.buffer}(C.data,x,b),A.enqueue(C)}(y,{chunk:p,controller:g}):g.enqueue(p)}});u.readable.pipeThrough(h).pipeTo(u.writable)}else if(ri()){if(typeof RTCRtpScriptTransform>"u")return void L.warning("browser not support RTCRtpScriptTransform");const u=Yw(),h=new MessageChannel;await new De(g=>u.onmessage=y=>{y.data==="registered"&&g(void 0)});const p=new RTCRtpScriptTransform(u,{name:"audio-metadata-tx",port:h.port2},[h.port2]);r.transform=p,await new De(g=>u.onmessage=y=>{y.data==="started"&&g(void 0)}),h.port1.onmessage=g=>{var y;if(g.data.transformed&&r.track&&((y=r.track)===null||y===void 0?void 0:y.id)!==s.track.id)L.debug("audio track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",c),s.track=r.track,s.track.addEventListener("ended",c);else if(g.data.getMetadata){const b=o.metadata&&o.metadata();b&&h.port1.postMessage({metadata:b})}},s.worker=u}function c(){if(r.track){if(this.id!==r.track.id)return;r.track.removeEventListener("ended",c)}const u=qw.get(r);if(u){qw.delete(r);try{var h,p;(h=u.controller)===null||h===void 0||h.terminate(),(p=u.worker)===null||p===void 0||p.terminate()}catch(g){L.warning(g&&g.message)}}}qw.set(r,s),r.track.addEventListener("ended",c)},interceptRemoteAudioFrame:async function(r){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!xt().supportWebRTCEncodedTransform)return void L.warning("browser not support audio encoded transform");if(tT.has(r))return;const s={track:r.track,onMetadata:o.onMetadata};if($l()){if(!r.createEncodedStreams)return void L.warning("browser not support createEncodedStreams() API");r1(Mt.CHROME,87,116)||(o.enableTopn=!1);let u=null;try{u=r.createEncodedStreams()}catch(p){return void L.error("create audio-encoded-streams error",p&&p.message)}const h=new TransformStream({transform(p,g){s.controller||(s.controller=g),r.track&&r.track.id!==s.track.id&&(L.debug("audio track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",c),s.track=r.track,s.track.addEventListener("ended",c)),o.enableTopn?function(y,b,w){var C;const A=iz(new DataView(b.data));if(!A)return w.enqueue(b);const x=y.track.id;IIe.set(x,y.track);const B=(C=A.tlv.find(ie=>ie.tag===Kl.AUDIO_LEVEL))===null||C===void 0?void 0:C.value;let U=0;typeof B=="number"&&(U=127-B);const F=Math.round(Math.pow(10,U/60)-1),{selected:K,speaker:z}=function(ie,oe){let re=Nm.get(ie);if(re||(re=function(me){const Ee=new sz;return Nm.set(me,Ee),ic||(ic=new AIe(q("TOPN_SILENCE_THRESHOLD")||500),ic.on("ActiveSpeakerChanged",xe=>{xe!=null&&(Qw=xe)})),ic.addSpeakers([Ee]),Ee}(ie)),Nm.size<=az)return{selected:!0,speaker:re};if(!ic)throw new Error("no active speaker detector");return ic.levelChanged(re.id,oe),hf=ic.loudest.map(me=>me.id),Qw&&!Pe(hf).call(hf,Qw)&&hf.length>=az&&hf.pop(),{selected:Pe(hf).call(hf,re.id)||re.id===Qw,speaker:re}}(y,F),Q=function(ie,oe,re){const me=oc.get(ie)||new OIe(ie,oe);return me.score=re,oc.set(ie,me),function(Ee){if(Zw.set(Ee,!0),!eT)return void(eT=Date.now());const xe=Date.now();xe-eT>1e3&&(Zw.get(Ee)?Zw.set(Ee,!1):(cz(Ee),Zw.delete(Ee)),eT=xe)}(ie),me}(x,y.track,z.energyScore);Q.addSample(K),Q.active&&(b.data=A.frame.buffer,w.enqueue(b))}(r,p,g):o.enableMetadata?function(y,b,w){const C=iz(new DataView(y.data));if(!C)return b.enqueue(y);const A=C.tlv.find(x=>x.tag===Kl.METADATA||x.tag===Kl.AUDIO_64_BIT_PTS);A&&w&&A.value instanceof Uint8Array&&w(A.value),y.data=C.frame.buffer,b.enqueue(y)}(p,g,o.onMetadata):g.enqueue(p)}});u.readable.pipeThrough(h).pipeTo(u.writable)}else if(ri()){if(typeof RTCRtpScriptTransform>"u")return void L.warning("browser not support RTCRtpScriptTransform");const u=Yw(),h=new MessageChannel;await new De(g=>u.onmessage=y=>{y.data==="registered"&&g(void 0)});const p=new RTCRtpScriptTransform(u,{name:"audio-metadata-rx",port:h.port2},[h.port2]);r.transform=p,await new De(g=>u.onmessage=y=>{y.data==="started"&&g(void 0)}),h.port1.onmessage=g=>{var y;g.data.transformed&&r.track&&((y=r.track)===null||y===void 0?void 0:y.id)!==s.track.id?(L.debug("audio track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",c),s.track=r.track,s.track.addEventListener("ended",c)):g.data.metadata&&s.onMetadata&&s.onMetadata(g.data.metadata)},s.worker=u}function c(){r.track.removeEventListener("ended",c),function(u){const h=tT.get(u);if(h){(function(y){const b=Nm.get(y);b&&(Nm.delete(y),ic&&(ic.removeSpeakers([b]),Nm.size===0&&(ic.destroy(),ic=null)))})(u),cz(u.track.id),tT.delete(u);try{var p,g;(p=h.controller)===null||p===void 0||p.terminate(),(g=h.worker)===null||g===void 0||g.terminate()}catch(y){L.warning(y&&y.message)}}}(r)}tT.set(r,s),r.track.addEventListener("ended",c)},interceptLocalVideoFrame:async function(r,o){if(!xt().supportWebRTCEncodedTransform)return void L.warning("browser not support video encoded transform");if(nT.has(r)||!r.track)return;const s={track:r.track};if($l()){if(!r.createEncodedStreams)return void L.warning("browser not support createEncodedStreams() API");let u=null;try{u=r.createEncodedStreams()}catch(g){return void L.error("create video-encoded-streams error",g&&g.message)}const h=[];o.on("sei-to-send",g=>{h.push(g)});const p=new TransformStream({transform(g,y){s.controller||(s.controller=y),r.track&&r.track.id!==s.track.id&&(L.debug("video track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",c),s.track=r.track,s.track.addEventListener("ended",c));const b=h.shift();b&&(g.data=function(w,C){const A=function(z){const Q=z.length;let ie=[],oe=0;for(;oe<Q;)oe+2<Q&&z[oe]===0&&z[oe+1]===0&&(z[oe+2]===0||z[oe+2]===1||z[oe+2]===2||z[oe+2]===3)?(ie.push(z[oe],z[oe+1],3,z[oe+2]),oe+=3):(ie.push(z[oe]),oe++);return new Uint8Array(ie)}(C),x=A.length,B=Math.floor(x/255),U=x%255,F=new Uint8Array(6+B+1+x+w.byteLength);F[0]=0,F[1]=0,F[2]=0,F[3]=1,F[4]=6,F[5]=101;let K=0;for(;K<B;)F[6+K]=255,K++;return F[6+K]=U,K++,F.set(A,6+K),F.set(new Uint8Array(w),6+K+x),F.buffer}(g.data,b)),y.enqueue(g)}});u.readable.pipeThrough(p).pipeTo(u.writable)}else{if(!ri())return;{if(typeof RTCRtpScriptTransform>"u")return void L.warning("browser not support RTCRtpScriptTransform");const u=Yw(),h=new MessageChannel;await new De(g=>u.onmessage=y=>{y.data==="registered"&&g(void 0)});const p=new RTCRtpScriptTransform(u,{name:"sei-tx",port:h.port2},[h.port2]);r.transform=p,await new De(g=>u.onmessage=y=>{y.data==="started"&&g(void 0)}),o.on("sei-to-send",g=>{h.port1.postMessage({sei:g})}),h.port1.onmessage=g=>{var y;g.data.transformed&&r.track&&((y=r.track)===null||y===void 0?void 0:y.id)!==s.track.id&&(L.debug("video track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",c),s.track=r.track,s.track.addEventListener("ended",c))},s.worker=u}}function c(){if(r.track){if(this.id!==r.track.id)return;r.track.removeEventListener("ended",c)}const u=nT.get(r);if(u){nT.delete(r);try{var h,p;(h=u.controller)===null||h===void 0||h.terminate(),(p=u.worker)===null||p===void 0||p.terminate()}catch(g){L.warning(g&&g.message)}}}nT.set(r,s),r.track.addEventListener("ended",c)},interceptRemoteVideoFrame:async function(r){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!xt().supportWebRTCEncodedTransform)return void L.warning("browser not support video encoded transform");if(!r.track)return;if(m_.has(r)){const u=m_.get(r);return void(u&&(u.onSei=o.onSei))}const s={track:r.track,onSei:o.onSei};if($l()){if(!r.createEncodedStreams)return void L.warning("browser not support createEncodedStreams() API");let u=null;try{u=r.createEncodedStreams()}catch(p){return void L.error("create video-encoded-streams error",p&&p.message)}const h=new TransformStream({transform(p,g){s.controller||(s.controller=g),r.track&&r.track.id!==s.track.id&&(L.debug("video track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",c),s.track=r.track,s.track.addEventListener("ended",c));const y=function(b){const w=new DataView(b.data);let C=0;for(;C+4<b.data.byteLength;){if(w.getUint8(C+0)===0&&w.getUint8(C+1)===0&&w.getUint8(C+2)===0&&w.getUint8(C+3)===1&&w.getUint8(C+4)===6){let A=C+6,x=0,B=0;for(;(B=w.getUint8(A++))===255;)x+=255;x+=B;const U=xIe(b.data,A,x);return new Uint8Array(U)}C++}return null}(p);y&&s.onSei&&s.onSei(y),g.enqueue(p)}});u.readable.pipeThrough(h).pipeTo(u.writable)}else if(ri()){if(typeof RTCRtpScriptTransform>"u")return void L.warning("browser not support RTCRtpScriptTransform");const u=Yw(),h=new MessageChannel;await new De(g=>u.onmessage=y=>{y.data==="registered"&&g(void 0)});const p=new RTCRtpScriptTransform(u,{name:"sei-rx",port:h.port2},[h.port2]);r.transform=p,await new De(g=>u.onmessage=y=>{y.data==="started"&&g(void 0)}),h.port1.onmessage=g=>{var y;g.data.transformed&&r.track&&((y=r.track)===null||y===void 0?void 0:y.id)!==s.track.id?(L.debug("video track changed: ".concat(s.track.id," => ").concat(r.track.id)),s.track.removeEventListener("ended",c),s.track=r.track,s.track.addEventListener("ended",c)):g.data.sei&&s.onSei&&s.onSei(g.data.sei)},s.worker=u}function c(){if(r.track){if(this.id!==r.track.id)return;r.track.removeEventListener("ended",c)}(function(u){const h=m_.get(u);if(h){m_.delete(u);try{var p,g;(p=h.controller)===null||p===void 0||p.terminate(),(g=h.worker)===null||g===void 0||g.terminate()}catch(y){L.warning(y&&y.message)}}})(r)}m_.set(r,s),r.track.addEventListener("ended",c)}},JNe={name:"InterceptFrame",create:()=>XNe};w1(),Yt("PROCESS_ID","process-".concat(cn(8,""),"-").concat(cn(4,""),"-").concat(cn(4,""),"-").concat(cn(4,""),"-").concat(cn(12,""))),function(){let r;try{r=window.localStorage.getItem("websdk_ng_global_parameter")}catch(o){return void L.error("Error loading sdk config",o.message)}if(r)try{const o=JSON.parse(window.atob(r)),s=Date.now();L.debug("Loading global parameters from cache",o),Object.keys(o).forEach(c=>{if(Object.prototype.hasOwnProperty.call(yn,c)){const{value:u,expires:h}=o[c];if(h&&h<=s)return;rc[c]=u,yn[c]=u}})}catch(o){L.error("Error loading mutableParamsCache: ".concat(r),o.message)}}(),Array.isArray(rc.AREAS)&&rc.AREAS.length>0&&mD(rc.AREAS,!0);const a7=(r,o,s)=>{L.debug("setParameter key:".concat(r,", value:").concat(JSON.stringify(o))),Yt(r,o,s)};yd(ENe,!1),yd(wNe,!1),yd(nPe,!1),yd(kNe,!1),yd(vNe,!1),yd(KNe,!1),yd(qNe,!1),yd(JNe,!1);const ir=function(r){const o=new An,s=r,c={getListeners:o.getListeners.bind(o),on:(u,h)=>(function(p,g){p===Qc.SECURITY_POLICY_VIOLATION&&Bq(g,!0)}(u,h),o.on.bind(o)(u,h)),addListener:o.addListener.bind(o),once:o.once.bind(o),off:o.off.bind(o),removeAllListeners:o.removeAllListeners.bind(o),emit:o.emit.bind(o),safeEmit:o.safeEmit.bind(o)};return Fq(Fq({},s),c)}({__TRACK_LIST__:Sm,VERSION:xs,BUILD:R1,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:a7,getParameter:q,getSupportedCodec:async function(){let r={audio:[],video:[]};try{let o=new RTCPeerConnection;const s=await async function(c){let u;return xt().supportUnifiedPlan?(c.addTransceiver("video",{direction:"recvonly"}),c.addTransceiver("audio",{direction:"recvonly"}),u=(await c.createOffer()).sdp):u=(await c.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})).sdp,u}(o);if(!s)return r;o.close(),o=null,r=function(c){const u={video:[],audio:[]};return c.match(/ VP8/i)&&u.video.push("VP8"),c.match(/ VP9/i)&&u.video.push("VP9"),c.match(/ AV1/i)&&u.video.push("AV1"),c.match(/ H264/i)&&u.video.push("H264"),c.match(/ H265/i)&&u.video.push("H265"),c.match(/ opus/i)&&u.audio.push("OPUS"),c.match(/ PCMU/i)&&u.audio.push("PCMU"),c.match(/ PCMA/i)&&u.audio.push("PCMA"),c.match(/ G722/i)&&u.audio.push("G722"),u}(s)}catch(o){throw new pe(Y.CREATE_OFFER_FAILED,o.toString&&o.toString()).print()}return r},checkSystemRequirements:function(){const r=We.reportApiInvoke(null,{name:Yn.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:Nn.TRACER});let o=!1;try{const h=window.RTCPeerConnection,p=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,g=window.WebSocket;o=!!(h&&p&&g),o&&a1()&&l8(75)&&new h().close()}catch(h){return L.error("check system requirement failed: ",h),!1}let s=!1;const c=It();c.name===Mt.CHROME&&Number(c.version)>=58&&(tc.engine.name!=="WebKit"||function(){const h=It();if(Nw()){if(h.os===Rr.MAC_OS)return!0;if(h.os===Rr.IOS){const p=tc.os.version&&tc.os.version.split(".");if(p&&Number(p[0])===14&&p[1]&&Number(p[1])>=3||p&&Number(p[0])>14)return!0}}return!1}())&&(s=!0),(c.name===Mt.FIREFOX&&Number(c.version)>=56||c.name===Mt.OPERA&&Number(c.version)>=45||c.name===Mt.SAFARI&&Number(c.version)>=11||c.name==="WebKit"&&(Vi()||ha())&&c.osVersion&&Number(c.osVersion.split(".")[0])>=11||m8()||It().name===Mt.QQ)&&(s=!0),L.debug("checkSystemRequirements, api:",o,"browser",s);const u=o&&s;return r.onSuccess(u),u},getDevices:function(r){return ss.enumerateDevices(!0,!0,r)},getMicrophones:function(r){return ss.getRecordingDevices(r)},getCameras:function(r){return ss.getCamerasDevices(r)},getElectronScreenSources:lH,getPlaybackDevices:function(r){return ss.getSpeakers(r)},createClient:function(){var r;let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const s=cn(5,"client-"),c=We.reportApiInvoke(null,{id:s,name:Yn.CREATE_CLIENT,options:[o],tag:Nn.TRACER});try{(function(u){yr(u.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),yr(u.mode,"config.mode",["rtc","live","p2p"]),u.audioCodec!==void 0&&yr(u.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),u.proxyServer!==void 0&&Hr(u.proxyServer,"config.proxyServer",1,1e4),u.turnServer!==void 0&&w8(u.turnServer),u.httpRetryConfig!==void 0&&S8(u.httpRetryConfig),u.websocketRetryConfig!==void 0&&S8(u.websocketRetryConfig)})(o)}catch(u){throw c.onError(u),u}return(d8(16,0)||h8(16,0,!0))&&(o.codec==="vp9"&&(o.codec="vp8",L.debug("browser not support vp9, force use vp8")),Yt("UNSUPPORTED_VIDEO_CODEC",["vp9"])),o.audioCodec===void 0&&(o.audioCodec="opus"),c.onSuccess(),new rPe(Sa(Sa({forceWaitGatewayResponse:!0},o),{},{role:Pe(r=["rtc","p2p"]).call(r,o.mode)?"host":o.role||"audience"}),s)},createCameraVideoTrack:async function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const o=q("CAMERA_CAPTURE_CONFIG"),s=cn(8,"track-cam-"),c=We.reportApiInvoke(null,{id:s,tag:Nn.TRACER,name:Yn.CREATE_CAM_VIDEO_TRACK,options:[Cn({},r),o]});o&&(r.encoderConfig=o);const u=zw(r);let h=null;L.info("start create camera video track with config",JSON.stringify(r),"trackId",s);try{h=(await os({video:u},s)).getVideoTracks()[0]||null}catch(g){throw c.onError(g),g}if(!h){const g=new ve(Y.UNEXPECTED_ERROR,"can not find track in media stream");return c.onError(g),g.throw(L)}if(r.optimizationMode&&W1(s,h,r,ma(r.encoderConfig)),q("USE_STANDARD_BITRATE_DEFAULT")){const g=ma(r.encoderConfig);r.encoderConfig=g,delete g.bitrateMax,delete g.bitrateMin}const p=new $1(h,r,u,r.scalabiltyMode?Ww(r.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},r.optimizationMode,s);return c.onSuccess(p.getTrackId()),L.info("create camera video success, trackId:",s),p},createCustomVideoTrack:function(r){const o=cn(8,"track-cus-"),s=We.reportApiInvoke(null,{id:o,tag:Nn.TRACER,name:Yn.CREATE_CUSTOM_VIDEO_TRACK,options:[r]});q("USE_STANDARD_BITRATE_DEFAULT")&&(delete r.bitrateMax,delete r.bitrateMin);const c=new pn(r.mediaStreamTrack,{width:r.width,height:r.height,frameRate:r.frameRate,bitrateMax:r.bitrateMax,bitrateMin:r.bitrateMin},r.scalabiltyMode?Ww(r.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},r.optimizationMode,o,[Zt.CUSTOM_TRACK]);return s.onSuccess(c.getTrackId()),L.info("create custom video track success with config",r,"trackId",c.getTrackId()),c},createScreenVideoTrack:async function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const s=typeof o=="object"?function(A){return _H(A)}(o):void 0;s&&(o="auto");const c=cn(8,"track-scr-v-"),u=We.reportApiInvoke(null,{id:c,tag:Nn.TRACER,name:Yn.CREATE_SCREEN_VIDEO_TRACK,options:[Cn({},r),o]});r.encoderConfig?typeof r.encoderConfig=="string"||r.encoderConfig.width&&r.encoderConfig.height||(r.encoderConfig.width={max:1920},r.encoderConfig.height={max:1080}):r.encoderConfig="1080p_2";const h=function(A){const x={};A.screenSourceType&&(x.mediaSource=A.screenSourceType),A.extensionId&&$l()&&(x.extensionId=A.extensionId);const{displaySurface:B,selfBrowserSurface:U,surfaceSwitching:F,systemAudio:K,preferCurrentTab:z}=A;(r_(107)||i1(107)||o1(93))&&(B&&(yr(B,"displaySurface",["browser","window","monitor"]),x.displaySurface=B),U?(yr(U,"selfBrowserSurface",["exclude","include"]),x.selfBrowserSurface=U):x.selfBrowserSurface="include",F&&(yr(F,"surfaceSwitching",["exclude","include"]),x.surfaceSwitching=F)),(r_(105)||i1(105)||o1(91))&&K&&(yr(K,"systemAudio",["exclude","include"]),x.systemAudio=K),(r_(94)||i1(94)||o1(80))&&z&&(x.preferCurrentTab=!0),A.electronScreenSourceId&&(x.sourceId=A.electronScreenSourceId);const Q=A.encoderConfig?P1(A.encoderConfig):null;return x.mandatory={chromeMediaSource:"desktop",maxWidth:Q?Q.width:void 0,maxHeight:Q?Q.height:void 0},Q&&(Q.frameRate&&(typeof Q.frameRate=="number"?(x.mandatory.maxFrameRate=Q.frameRate,x.mandatory.minFrameRate=Q.frameRate):(x.mandatory.maxFrameRate=Q.frameRate.max||Q.frameRate.ideal||Q.frameRate.exact||void 0,x.mandatory.minFrameRate=Q.frameRate.min||Q.frameRate.ideal||Q.frameRate.exact||void 0),x.frameRate=Q.frameRate),Q.width&&(x.width=Q.width),Q.height&&(x.height=Q.height)),x}(r);let p=null,g=null;const y=xt();if(!y.supportShareAudio&&o==="enable"){const A=new ve(Y.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return u.onError(A),A.throw(L)}L.info("start create screen video track with config",r,"withAudio",o,"trackId",c);const b=y.supportShareAudio&&o!=="disable";try{const A=await os({screen:h,screenAudio:b?s||!0:void 0},c);p=A.getVideoTracks()[0]||null,g=A.getAudioTracks()[0]||null}catch(A){throw u.onError(A),A}if(!p){const A=new ve(Y.UNEXPECTED_ERROR,"can not find track in media stream");return u.onError(A),A.throw(L)}if(!g&&o==="enable"){p&&p.stop();const A=new ve(Y.SHARE_AUDIO_NOT_ALLOWED);return u.onError(A),A.throw(L)}r.optimizationMode||(r.optimizationMode="detail"),r.optimizationMode&&(W1(c,p,r,r.encoderConfig&&P1(r.encoderConfig)||void 0),r.encoderConfig&&typeof r.encoderConfig!="string"&&(r.encoderConfig.bitrateMin=r.encoderConfig.bitrateMax));const w=new pn(p,r.encoderConfig?P1(r.encoderConfig):{},r.scalabiltyMode?Ww(r.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},r.optimizationMode,c,[Zt.SCREEN_TRACK]);if(!g)return u.onSuccess(w.getTrackId()),L.info("create screen video track success","video:",w.getTrackId()),w;const C=new jn(g,void 0,cn(8,"track-scr-a-"),!1);return u.onSuccess([w.getTrackId(),C.getTrackId()]),L.info("create screen video track success","video:",w.getTrackId(),"audio:",C.getTrackId()),[w,C]},createMicrophoneAndCameraTracks:async function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=q("CAMERA_CAPTURE_CONFIG"),c=cn(8,"track-mic-"),u=cn(8,"track-cam-"),h=We.reportApiInvoke(null,{id:"".concat(c,"-").concat(u),tag:Nn.TRACER,name:Yn.CREATE_MIC_AND_CAM_TRACKS,options:[r,o,s]});s&&(o.encoderConfig=s);const p=zw(o),g=EH(r);let y=null,b=null;L.info("start create camera video track(".concat(u,") and microphone audio track(").concat(c,") with config, audio: ").concat(JSON.stringify(r),", video: ").concat(JSON.stringify(o)));try{const A=await os({audio:g,video:p},"".concat(c,"-").concat(u));y=A.getAudioTracks()[0],b=A.getVideoTracks()[0]}catch(A){throw h.onError(A),A}if(!y||!b){const A=new ve(Y.UNEXPECTED_ERROR,"can not find tracks in media stream");return h.onError(A),A.throw(L)}if(o.optimizationMode&&W1(u,b,o,ma(o.encoderConfig)),q("USE_STANDARD_BITRATE_DEFAULT")){const A=ma(o.encoderConfig);o.encoderConfig=A,delete A.bitrateMax,delete A.bitrateMin}const w=new p_(y,r,g,c),C=new $1(b,o,p,o.scalabiltyMode?Ww(o.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},o.optimizationMode,u);return h.onSuccess([w.getTrackId(),C.getTrackId()]),L.info("create camera video track(".concat(u,") and microphone audio track(").concat(c,") success")),[w,C]},createMicrophoneAudioTrack:async function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const o=cn(8,"track-mic-"),s=We.reportApiInvoke(null,{id:o,tag:Nn.TRACER,name:Yn.CREATE_MIC_AUDIO_TRACK,options:[r]}),c=EH(r);let u=null;L.info("start create microphone audio track with config",JSON.stringify(r),"trackId",o);try{u=(await os({audio:c},o)).getAudioTracks()[0]||null}catch(p){throw s.onError(p),p}if(!u){const p=new ve(Y.UNEXPECTED_ERROR,"can not find track in media stream");return s.onError(p),p.throw(L)}const h=new p_(u,r,c,o);return s.onSuccess(h.getTrackId()),L.info("create microphone audio track success, trackId:",o),h},createCustomAudioTrack:function(r){const o=cn(8,"track-cus-"),s=We.reportApiInvoke(null,{id:o,tag:Nn.TRACER,name:Yn.CREATE_CUSTOM_AUDIO_TRACK,options:[r]}),c=new jn(r.mediaStreamTrack,r.encoderConfig?Gw(r.encoderConfig):{},o,!1);return L.info("create custom audio track success with config",r,"trackId",c.getTrackId()),s.onSuccess(c.getTrackId()),c},createBufferSourceAudioTrack:async function(r){var o;const{cacheOnlineFile:s,encoderConfig:c}=r;let{source:u}=r;const h={source:u instanceof AudioBuffer?"AudioBuffer":u instanceof File?(o=File.name)!==null&&o!==void 0?o:"File":u,cacheOnlineFile:s,encoderConfig:c},p=cn(8,"track-buf-"),g=We.reportApiInvoke(null,{id:p,tag:Nn.TRACER,name:Yn.CREATE_BUFFER_AUDIO_TRACK,options:[h]});if(q("DISABLE_WEBAUDIO"))throw new ve(Y.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");L.info("start create buffer source audio track with config",JSON.stringify(h),"trackId",p);const y=u;if(!(u instanceof AudioBuffer))try{u=await async function(C,A){let x=null;if(typeof C=="string"){const U=sK.get(C);if(U)return L.debug("use cached audio resource: ",C),U;try{x=(await nc(()=>Qi.get(C,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(F){throw new ve(Y.FETCH_AUDIO_FILE_FAILED,F.toString())}}else x=await new De((F,K)=>{const z=new FileReader;z.onload=Q=>{Q.target?F(Q.target.result):K(new ve(Y.READ_LOCAL_AUDIO_FILE_ERROR))},z.onerror=()=>{K(new ve(Y.READ_LOCAL_AUDIO_FILE_ERROR))},z.readAsArrayBuffer(C)});const B=await function(U){const F=Om();return new De((K,z)=>{F.decodeAudioData(U,Q=>{K(Q)},Q=>{z(new ve(Y.DECODE_AUDIO_FILE_FAILED,Q.toString()))})})}(x);return typeof C=="string"&&A&&sK.set(C,B),B}(u,s)}catch(C){return g.onError(C),C.throw(L)}const b=new SIe(u),w=new bIe(y,b,c?Gw(c):{},p);return L.info("create buffer source audio track success, trackId:",p),g.onSuccess(w.getTrackId()),w},setAppType:function(r){if(L.debug("setAppType: ".concat(r)),!(Number.isInteger(r)&&r>=0))throw L.debug("Invalid appType"),new pe(Y.INVALID_PARAMS,"invalid app type",r);Yt("APP_TYPE",Math.floor(r))},setLogLevel:function(r){L.setLogLevel(r)},enableLogUpload:function(){q("USE_NEW_LOG")?Yt("UPLOAD_LOG",!0):L.enableLogUpload()},disableLogUpload:function(){q("USE_NEW_LOG")?Yt("UPLOAD_LOG",!1):L.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new aY},checkAudioTrackIsActive:async function(r){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const s=We.reportApiInvoke(null,{tag:Nn.TRACER,name:Yn.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[o]});if(!(r instanceof jn||r instanceof Pm)){const y=new pe(Y.INVALID_TRACK,"the parameter is not a audio track");return s.onError(y),y.throw()}o&&o<1e3&&(o=1e3);const c=r instanceof jn?r.getTrackLabel():"remote_track",u=r.getVolumeLevel();let h=u,p=u;const g=Date.now();return new De(y=>{const b=setInterval(()=>{const w=r.getVolumeLevel();h=w>h?w:h,p=w<p?w:p;const C=h-p>1e-4,A=Date.now()-g;if(C||A>o){clearInterval(b);const x=C,B={duration:A,deviceLabel:c,maxVolumeLevel:h,result:x};L.info("[track-".concat(r.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(B))),s.onSuccess(B),y(x)}},200)})},checkVideoTrackIsActive:async function(r){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const s=We.reportApiInvoke(null,{tag:Nn.TRACER,name:Yn.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[o]});if(!(r instanceof pn||r instanceof xm)){const C=new pe(Y.INVALID_TRACK,"the parameter is not a video track");return s.onError(C),C.throw()}o&&o<1e3&&(o=1e3);const c=r instanceof pn?r.getTrackLabel():"remote_track",u=r.getMediaStreamTrack(!0),h=document.createElement("video");h.style.width="1px",h.style.height="1px",h.setAttribute("muted",""),h.muted=!0,h.setAttribute("playsinline",""),h.controls=!1,(ri()||Nw())&&(h.style.opacity="0.01",h.style.position="fixed",h.style.left="0",h.style.top="0",document.body.appendChild(h)),h.srcObject=new MediaStream([u]),h.play();const p=document.createElement("canvas");p.width=160,p.height=120;let g=0,y=0;try{const C=Date.now();g=await function(A,x,B,U){let F,K=0,z=null;return new De((Q,ie)=>{function oe(){K>U&&F&&(F(),Q(K));const re=B.getContext("2d");if(!re){const xe=new pe(Y.UNEXPECTED_ERROR,"can not get canvas 2d context.");return L.error(xe.toString()),void ie(xe)}re.drawImage(A,0,0,160,120);const me=re.getImageData(0,0,B.width,B.height),Ee=Math.floor(me.data.length/3);if(z){for(let xe=0;xe<Ee;xe+=3)if(me.data[xe]!==z[xe])return K+=1,void(z=me.data);z=me.data}else z=me.data}setTimeout(()=>{F&&(F(),Q(K))},x),F=M1(()=>{oe()},30)})}(h,o,p,4),y=Date.now()-C}catch(C){throw s.onError(C),C}$xe===Mt.SAFARI&&(h.pause(),h.remove()),h.srcObject=null;const b=g>4,w={duration:y,changedPicNum:g,deviceLabel:c,result:b};return L.info("[track-".concat(r.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(w))),s.onSuccess(w),b},setArea:mD,audioElementPlayCenter:Zi,resumeAudioContext:function(){Zi.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(r){oPe.processExternalMediaAEC(r)},registerExtensions:function(r){const o=q("PLUGIN_INFO")||[];r.forEach(s=>{"name"in s&&!Pe(o).call(o,s.name)&&o.push(s.name);const c=s;c.__registered__=!0,c.logger.hookLog=L.extLog,c.reporter.hookApiInvoke=We.extApiInvoke,c.parameters&&Object.keys(c.parameters).forEach(u=>{c.parameters[u]=q(u)})}),a7("PLUGIN_INFO",o)},ChannelMediaRelayError:km,ChannelMediaRelayEvent:Yl,ChannelMediaRelayState:fo,RemoteStreamFallbackType:pIe,RemoteStreamType:fIe,ConnectionDisconnectedReason:Bt,AudienceLatencyLevelType:GOe,AREAS:jt,preload:async function(r,o,s,c){return NY(r,o,s,c)}});return Object.defineProperties(ir,{onAudioAutoplayFailed:{get:()=>as.onAudioAutoplayFailed,set:r=>{as.onAudioAutoplayFailed=r}},onAutoplayFailed:{get:()=>as.onAutoplayFailed,set:r=>{as.onAutoplayFailed=r}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>ir._onSecurityPolicyViolation,set(r){ir._onSecurityPolicyViolation=r,Bq(r)}},__CLIENT_LIST__:{get:()=>q("SHOW_GLOBAL_CLIENT_LIST")?ff:[]}}),ss.on(lf.CAMERA_DEVICE_CHANGED,r=>{L.info("camera device changed",JSON.stringify(r)),ir.onCameraChanged&&ir.onCameraChanged(r),ir.safeEmit(Qc.CAMERA_CHANGED,r)}),ss.on(lf.RECORDING_DEVICE_CHANGED,r=>{L.info("microphone device changed",JSON.stringify(r)),ir.onMicrophoneChanged&&ir.onMicrophoneChanged(r),ir.safeEmit(Qc.MICROPHONE_CHANGED,r)}),ss.on(lf.PLAYOUT_DEVICE_CHANGED,r=>{L.debug("playout device changed",JSON.stringify(r)),ir.onPlaybackDeviceChanged&&ir.onPlaybackDeviceChanged(r),ir.safeEmit(Qc.PLAYBACK_DEVICE_CHANGED,r)}),Zi.onAutoplayFailed=()=>{L.info("detect audio element autoplay failed"),as.onAudioAutoplayFailed&&as.onAudioAutoplayFailed()},qt.on("autoplay-failed",()=>{L.info("detect webaudio autoplay failed"),as.onAudioAutoplayFailed&&as.onAudioAutoplayFailed(),ir.safeEmit(Qc.AUTOPLAY_FAILED)}),qt.on(Yr.STATE_CHANGE,(r,o)=>{L.info("audio context state changed: ".concat(o," => ").concat(r)),ir.onAudioContextStateChanged&&ir.onAudioContextStateChanged(r,o),ir.safeEmit(Qc.AUDIO_CONTEXT_STATE_CHANGED,r,o)}),qn.on(gm.NETWORK_STATE_CHANGE,(r,o)=>{L.info("[network-indicator] network state changed, ".concat(o," => ").concat(r))}),window&&(window.__ARTC__=ir),ir})})(gge);var __t=gge.exports;const Xne=zn(__t),E_t=({appId:e,channel:t,token:n,isConnected:i})=>{const{toast:a}=Hu(),[l,d]=N.useState(!1),[f,m]=N.useState(1),[v,E]=N.useState(!1),[S,T]=N.useState(!1),[R,I]=N.useState(""),O=N.useRef(null),P=N.useRef(null);return N.useRef([]),N.useEffect(()=>{if(!i||!t){E(!1),I("");return}return(async()=>{var $,V,W;try{if(T(!0),E(!1),I(""),console.log("Initializing Agora with:",{appId:e,channel:t}),!e||e.length!==32)throw new Error("Invalid Agora App ID format");try{const ae=await fetch("https://api.agora.io/health",{method:"GET",mode:"no-cors",signal:AbortSignal.timeout(5e3)});console.log("Agora API health check completed")}catch(ae){console.warn("Network connectivity test failed:",ae)}const H=Xne.createClient({mode:"rtc",codec:"vp8",role:"host"});O.current=H,H.on("user-published",async(ae,ce)=>{try{console.log("User published:",ae.uid,ce),await H.subscribe(ae,ce),console.log("Subscribe success for user:",ae.uid),ce==="audio"&&ae.audioTrack&&ae.audioTrack.play(),m(ge=>ge+1)}catch(ge){console.error("Error subscribing to user:",ge)}}),H.on("user-unpublished",ae=>{console.log("User unpublished:",ae.uid),m(ce=>Math.max(1,ce-1))}),H.on("user-left",ae=>{console.log("User left:",ae.uid),m(ce=>Math.max(1,ce-1))}),H.on("connection-state-change",(ae,ce)=>{console.log("Connection state changed:",ae,"from:",ce),ae==="DISCONNECTED"||ae==="DISCONNECTING"?(E(!0),I("Connection lost to voice chat server")):ae==="CONNECTED"&&(E(!1),I(""))}),H.on("exception",ae=>{console.error("Agora exception:",ae),E(!0),I(`Voice chat error: ${ae.msg}`)});try{if((await navigator.permissions.query({name:"microphone"})).state==="denied")throw new Error("Microphone permission denied")}catch(ae){console.warn("Could not check microphone permission:",ae)}console.log("Joining channel:",t);let J=n;const ee=String(Math.floor(Math.random()*1e6));if(!J)try{if(J=(await(await fetch(`http://localhost:5000/rtc-token?channel=${encodeURIComponent(t)}&uid=${ee}`)).json()).token,!J)throw new Error("Failed to fetch Agora RTC token")}catch{throw new Error("Could not fetch Agora RTC token from server.")}const le=H.join(e,t,J,ee),he=new Promise((ae,ce)=>setTimeout(()=>ce(new Error("Connection timeout")),1e4));await Promise.race([le,he]),console.log("Joined Agora channel with UID:",ee),console.log("Creating audio track...");const de=await Xne.createMicrophoneAudioTrack({encoderConfig:"music_standard"});P.current=de,console.log("Publishing audio track..."),await H.publish([de]),console.log("Published audio track successfully"),T(!1),E(!1),I(""),a({title:"Voice Chat Connected",description:"Successfully joined the voice chat!"})}catch(H){console.error("Error initializing Agora:",H),E(!0),T(!1);let J="Failed to connect to voice chat.";H.code==="INVALID_PARAMS"?J="Invalid voice chat configuration.":H.code==="CAN_NOT_GET_GATEWAY_SERVER"?J="Cannot reach voice chat servers. Please check your internet connection.":H.code==="INVALID_VENDOR_KEY"?J="Invalid Agora App ID. Voice chat is not properly configured.":($=H.message)!=null&&$.includes("Permission")?J="Microphone permission denied. Please allow microphone access.":(V=H.message)!=null&&V.includes("timeout")?J="Connection timeout. Please check your internet connection.":(W=H.message)!=null&&W.includes("Invalid Agora App ID")?J="Voice chat is not properly configured. Please contact support.":H.code&&(J=`Voice chat error (${H.code}): ${H.message}`),I(J),a({title:"Voice Chat Error",description:J,variant:"destructive"})}})(),()=>{console.log("Cleaning up Agora connection..."),P.current&&(P.current.close(),P.current=null),O.current&&(O.current.leave().catch(console.error),O.current.removeAllListeners(),O.current=null),m(1),d(!1),E(!1),I("")}},[i,e,t,n,a]),{isMuted:l,participantCount:f,toggleMute:async()=>{if(P.current&&!v){const M=!l;console.log("Toggling microphone:",M?"muted":"unmuted");try{await P.current.setEnabled(!M),d(M)}catch($){console.error("Error toggling mute:",$),a({title:"Error",description:"Failed to toggle microphone",variant:"destructive"})}}},leaveCall:async()=>{console.log("Leaving voice chat");try{P.current&&(P.current.close(),P.current=null),O.current&&(await O.current.leave(),O.current=null),m(1),d(!1),E(!1),I("")}catch(M){console.error("Error leaving call:",M)}},hasError:v,isJoining:S,errorMessage:R}},b_t=()=>{const[e,t]=N.useState("unknown");return N.useEffect(()=>{(async()=>{try{if(navigator.permissions){const i=await navigator.permissions.query({name:"microphone"});t(i.state),console.log("Microphone permission:",i.state)}}catch(i){console.warn("Could not check microphone permission:",i),t("unknown")}})()},[]),e},S_t=({isMuted:e,onToggleMute:t,onLeaveCall:n,participantCount:i})=>_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[_.jsx(vn,{variant:e?"secondary":"default",size:"sm",onClick:t,className:"flex-1",children:e?_.jsxs(_.Fragment,{children:[_.jsx(PLe,{className:"h-4 w-4 mr-2"}),"Muted"]}):_.jsxs(_.Fragment,{children:[_.jsx(NLe,{className:"h-4 w-4 mr-2"}),"Unmuted"]})}),_.jsxs(vn,{variant:"destructive",size:"sm",onClick:n,className:"flex-1",children:[_.jsx(kLe,{className:"h-4 w-4 mr-2"}),"Leave"]})]}),_.jsx("div",{className:"text-xs text-muted-foreground text-center",children:_.jsxs("span",{className:"inline-flex items-center gap-1",children:[_.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),i," participant",i!==1?"s":""," in voice chat"]})})]}),w_t=({isJoining:e,microphonePermission:t,onJoinCall:n})=>_.jsxs("div",{className:"text-center",children:[_.jsx(tse,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),_.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Connect to voice chat to talk with other participants"}),t==="denied"&&_.jsxs("div",{className:"mb-3 p-2 bg-orange-50 border border-orange-200 rounded text-orange-800 text-xs",children:[_.jsx(yV,{className:"h-4 w-4 inline mr-1"}),"Microphone access required for voice chat"]}),_.jsx(vn,{onClick:n,disabled:e||t==="denied",className:"w-full",children:e?_.jsxs(_.Fragment,{children:[_.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Connecting..."]}):_.jsxs(_.Fragment,{children:[_.jsx(LLe,{className:"h-4 w-4 mr-2"}),"Join Voice Chat"]})})]}),T_t=({isAdmin:e,isValidUrl:t,onToggleVoice:n})=>t?_.jsxs("div",{className:"p-4 text-center text-muted-foreground border-t",children:[_.jsx(tse,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),_.jsx("p",{className:"mb-2",children:"Voice chat is disabled for this room."}),e&&_.jsx(vn,{variant:"outline",onClick:()=>n(!0),children:"Enable Voice Chat"})]}):_.jsxs("div",{className:"p-4 text-center text-muted-foreground border-t",children:[_.jsx(yV,{className:"h-8 w-8 mx-auto mb-2 text-orange-500"}),_.jsx("p",{className:"mb-2",children:"Voice chat is not configured."}),_.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Please add your Agora.io App ID to enable voice chat."}),_.jsxs("div",{className:"text-xs text-muted-foreground bg-gray-50 p-2 rounded border",children:[_.jsx("p",{children:"To configure voice chat:"}),_.jsx("p",{children:"1. Sign up at agora.io"}),_.jsx("p",{children:"2. Get your App ID from the console"}),_.jsx("p",{children:"3. Replace 'your_agora_app_id_here' in StudyRoomVoice.tsx"})]}),e&&_.jsx(vn,{variant:"outline",onClick:()=>n(!1),className:"mt-2",children:"Disable Voice Chat"})]}),Jne="d997a2560ca7443fa3d656cd679e9d5d",C_t=e=>{try{return new URL(e).pathname.split("/").pop()||"default-channel"}catch{return e.replace(/[^a-zA-Z0-9]/g,"")||"default-channel"}},R_t=({roomUrl:e,isVoiceEnabled:t,isAdmin:n,onToggleVoice:i,onSwitchToTextChat:a})=>{const{toast:l}=Hu(),[d,f]=N.useState(!1),[m,v]=N.useState(0),E=b_t(),S=C_t(e),{isMuted:T,participantCount:R,toggleMute:I,leaveCall:O,hasError:P,isJoining:D,errorMessage:k}=E_t({appId:Jne,channel:S,isConnected:d});console.log("StudyRoomVoice state:",{roomUrl:e,isVoiceEnabled:t,isAdmin:n,channel:S,isConnected:d,hasError:P,isJoining:D,retryCount:m,errorMessage:k});const M=Jne.length===32;if(!t||!M)return _.jsx(T_t,{isAdmin:n,isValidUrl:M,onToggleVoice:i});if(P&&d)return _.jsxs("div",{className:"p-4 border-t",children:[_.jsxs("div",{className:"flex items-center justify-between mb-3",children:[_.jsx("h3",{className:"font-medium",children:"Voice Chat"}),n&&_.jsx(vn,{variant:"outline",size:"sm",onClick:()=>i(!1),children:"Disable Voice"})]}),_.jsxs("div",{className:"mb-3 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[_.jsx("p",{className:"text-sm text-orange-800 text-center mb-2",children:"⚠️ Connection issue detected"}),_.jsx("p",{className:"text-xs text-orange-700 text-center mb-3",children:k||"There was a problem with the voice chat connection."}),_.jsxs("div",{className:"flex gap-2 justify-center",children:[_.jsx(vn,{variant:"outline",size:"sm",onClick:()=>{console.log("Retrying voice chat connection...",m+1),f(!1),v(W=>W+1),setTimeout(()=>f(!0),1e3)},children:"Retry Connection"}),a&&_.jsx(vn,{variant:"secondary",size:"sm",onClick:a,children:"Switch to Text Chat"})]})]})]});const $=async()=>{if(E==="denied"){l({title:"Microphone Permission Required",description:"Please enable microphone access in your browser settings to join voice chat.",variant:"destructive"});return}console.log("Attempting to join voice chat with channel:",S),f(!0)},V=async()=>{await O(),f(!1),v(0)};return d?_.jsxs("div",{className:"p-4 border-t",children:[_.jsxs("div",{className:"flex items-center justify-between mb-3",children:[_.jsx("h3",{className:"font-medium",children:"Voice Chat"}),n&&_.jsx(vn,{variant:"outline",size:"sm",onClick:()=>i(!1),children:"Disable Voice"})]}),_.jsx("div",{className:"mb-3 p-4 bg-green-50 border border-green-200 rounded-lg",children:_.jsx("p",{className:"text-sm text-green-800 text-center",children:"🎤 Connected to voice chat"})}),_.jsx(S_t,{isMuted:T,onToggleMute:I,onLeaveCall:V,participantCount:R})]}):_.jsxs("div",{className:"p-4 border-t",children:[_.jsxs("div",{className:"flex items-center justify-between mb-3",children:[_.jsx("h3",{className:"font-medium",children:"Voice Chat"}),n&&_.jsx(vn,{variant:"outline",size:"sm",onClick:()=>i(!1),children:"Disable Voice"})]}),_.jsx(w_t,{isJoining:D,microphonePermission:E,onJoinCall:$})]})};class A_t extends se.Component{constructor(n){super(n);l7(this,"handleRetry",()=>{this.setState({hasError:!1,error:void 0}),this.props.onRetry&&this.props.onRetry()});this.state={hasError:!1}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,i){console.error("Voice chat error caught by boundary:",n,i)}render(){var n;return this.state.hasError?_.jsxs("div",{className:"p-4 text-center text-muted-foreground border-t",children:[_.jsx(yV,{className:"h-8 w-8 mx-auto mb-2 text-red-500"}),_.jsx("p",{className:"mb-2",children:"Voice chat encountered an error"}),_.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:((n=this.state.error)==null?void 0:n.message)||"Something went wrong with the voice chat component"}),_.jsx(vn,{variant:"outline",onClick:this.handleRetry,children:"Try Again"})]}):this.props.children}}const O_t=[],I_t=()=>{const{toast:e}=Hu(),[t,n]=N.useState([]),[i,a]=N.useState(null),[l,d]=N.useState(!1),[f,m]=N.useState({name:"",description:"",ca_level:""}),[v,E]=N.useState(O_t),[S,T]=N.useState(""),[R,I]=N.useState(""),[O,P]=N.useState(!1),[D,k]=N.useState(null),[M,$]=N.useState(""),[V,W]=N.useState("All"),H=i?t.find(te=>te.id===i):null;N.useEffect(()=>{Wt.auth.getUser().then(({data:ne})=>k(ne.user));const{data:te}=Wt.auth.onAuthStateChange((ne,ue)=>{k((ue==null?void 0:ue.user)??null)});return()=>{te==null||te.subscription.unsubscribe()}},[]),N.useEffect(()=>{kd.getAll().then(n).catch(ne=>{e({title:"Error",description:ne.message,variant:"destructive"})});const te=Wt.channel("study_rooms_realtime").on("postgres_changes",{event:"*",schema:"public",table:"study_rooms"},ne=>{kd.getAll().then(n)}).subscribe();return()=>{Wt.removeChannel(te)}},[e]),N.useEffect(()=>{async function te(){if(H!=null&&H.created_by){const{data:ne,error:ue}=await Wt.from("profiles").select("full_name").eq("id",H.created_by).single();$((ne==null?void 0:ne.full_name)||H.created_by)}}te()},[H==null?void 0:H.created_by]);const J=async()=>{if(!D){e({title:"Error",description:"You must be logged in to create a room.",variant:"destructive"});return}if(!f.name||!f.ca_level){e({title:"Error",description:"Please provide a name and CA level for the room",variant:"destructive"});return}try{console.log("Creating room with voice chat...");const te=await kd.create({name:f.name,description:f.description,ca_level:f.ca_level,created_by:D.id,participants:[D.id]});console.log("Room created successfully:",te),n(ne=>[te,...ne]),d(!1),a(te.id),e({title:"Room Created",description:`Study room "${f.name}" has been created with voice chat enabled`}),m({name:"",description:"",ca_level:""})}catch(te){console.error("Error creating room:",te),e({title:"Error",description:te.message||"Failed to create room",variant:"destructive"})}},ee=async()=>{if(!D){e({title:"Error",description:"You must be logged in to join a room.",variant:"destructive"});return}try{const te=await kd.getRoomByCode(Number(R));if(!te){e({title:"Room Not Found",description:"Please enter a valid room code",variant:"destructive"});return}await kd.joinRoom(Number(R),D.id);const ne=await kd.getAll();n(ne),a(te.id),P(!1),I(""),e({title:"Joined Room",description:`You have joined "${te.name}"`})}catch(te){e({title:"Error",description:te.message,variant:"destructive"})}},le=te=>{if(te.preventDefault(),!S.trim())return;const ne={id:`msg-${Date.now()}`,sender:D==null?void 0:D.id,content:S,timestamp:new Date};E([...v,ne]),T("")},he=()=>{i&&(a(null),e({title:"Left Room",description:"You have left the study room"}))},de=async()=>{if(H&&window.confirm("Are you sure you want to delete this room? This action cannot be undone."))try{await kd.deleteRoom(H.id),a(null),n(te=>te.filter(ne=>ne.id!==H.id)),e({title:"Room Deleted",description:`Study room "${H.name}" has been deleted.`})}catch(te){e({title:"Error",description:te.message,variant:"destructive"})}},ae=async te=>{if(H!=null&&H.id)try{await kd.toggleVoiceChat(H.id,te),n(ne=>ne.map(ue=>ue.id===H.id?{...ue,voice_enabled:te}:ue)),e({title:te?"Voice Chat Enabled":"Voice Chat Disabled",description:te?"Participants can now join voice chat":"Voice chat has been disabled for this room"})}catch(ne){console.error("Error toggling voice chat:",ne),e({title:"Error",description:ne.message,variant:"destructive"})}},ce=()=>{const te=document.querySelector('[data-value="chat"]');te&&te.click()},ge=te=>te.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});console.log("activeRoomData:",H);const ye=t.filter(te=>V==="All"||te.ca_level===V);return _.jsxs("div",{className:"container py-8 md:py-12",children:[_.jsx(Nr,{children:_.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Study Rooms"})}),i?_.jsx("div",{className:"grid grid-cols-1 gap-6",children:H&&_.jsx(Nr,{delay:.1,children:_.jsx(Vn.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},children:_.jsxs(Zn,{className:"border-2 border-primary/20",children:[_.jsxs(Zr,{className:"flex flex-row items-center justify-between space-y-0",children:[_.jsxs("div",{children:[_.jsx(pr,{children:H.name}),_.jsx(ms,{children:H.ca_level})]}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx(vn,{variant:"outline",onClick:he,children:"Leave Room"}),(D==null?void 0:D.id)===H.created_by&&_.jsx(vn,{variant:"destructive",onClick:de,children:"Delete Room"})]})]}),_.jsxs(mr,{children:[_.jsxs("div",{className:"mb-4",children:[_.jsx("h3",{className:"font-medium mb-2",children:"Room Info"}),_.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(WE,{className:"h-4 w-4 text-muted-foreground"}),_.jsxs("span",{children:["Participants: ",H.participants.length]})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Sb,{className:"h-4 w-4 text-muted-foreground"}),_.jsxs("span",{children:["CA Level: ",H.ca_level]})]}),_.jsx("div",{className:"sm:col-span-2",children:_.jsxs("span",{className:"text-muted-foreground",children:["Room Code: ",H.room_code]})}),_.jsx("div",{className:"sm:col-span-2",children:_.jsxs("span",{className:"text-muted-foreground",children:["Created by: ",M]})}),H.description&&_.jsxs("div",{className:"sm:col-span-2 border-t pt-2 mt-1",children:[_.jsx("span",{className:"block text-muted-foreground",children:"Description:"}),_.jsx("span",{children:H.description})]})]})]}),_.jsxs(lI,{defaultValue:"chat",children:[_.jsxs(BS,{className:"mb-4",children:[_.jsxs(gs,{value:"chat","data-value":"chat",children:[_.jsx(Vk,{className:"h-4 w-4 mr-2"}),"Chat"]}),_.jsxs(gs,{value:"participants",children:[_.jsx(WE,{className:"h-4 w-4 mr-2"}),"Participants"]}),_.jsxs(gs,{value:"voice",children:[_.jsx("span",{role:"img","aria-label":"Voice Chat",className:"h-4 w-4 mr-2",children:"🔊"}),"Voice Chat"]})]}),_.jsx(Vn.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:_.jsx(ja,{value:"chat",className:"space-y-4",children:_.jsxs(Zn,{className:"border",children:[_.jsx(pge,{className:"h-[400px] p-4",children:v.length===0?_.jsx("div",{className:"flex items-center justify-center h-full text-center",children:_.jsxs("div",{children:[_.jsx(Vk,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),_.jsx("p",{className:"text-lg font-medium",children:"No messages yet"}),_.jsx("p",{className:"text-sm text-muted-foreground",children:"Be the first to send a message in this room!"})]})}):_.jsx("div",{className:"space-y-4",children:v.map((te,ne)=>_.jsxs(Vn.div,{className:"flex gap-3 items-end",children:[_.jsx(rb,{className:"h-8 w-8",children:_.jsx(ib,{children:typeof te.sender=="string"?te.sender.charAt(0):"?"})}),_.jsxs("div",{className:`rounded-lg p-3 max-w-[80%] ${te.sender===(D==null?void 0:D.id)?"bg-primary text-primary-foreground":"bg-muted"}`,children:[_.jsxs("div",{className:"flex justify-between gap-4 mb-1",children:[_.jsx("span",{className:"font-medium text-sm",children:te.sender===(D==null?void 0:D.id)?"You":te.sender}),_.jsx("span",{className:"text-xs opacity-70",children:ge(te.timestamp)})]}),_.jsx("p",{className:"text-sm",children:te.content})]})]},te.id||ne))})}),_.jsx("div",{className:"p-4 border-t",children:_.jsxs("form",{onSubmit:le,className:"flex gap-2",children:[_.jsx(_n,{value:S,onChange:te=>T(te.target.value),placeholder:"Type your message...",className:"flex-1"}),_.jsx(vn,{type:"submit",children:"Send"})]})})]})})}),_.jsx(Vn.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:_.jsx(ja,{value:"participants",children:_.jsxs(Zn,{className:"border",children:[_.jsxs(mr,{className:"py-4",children:[_.jsx("h3",{className:"font-medium mb-4",children:"Room Participants"}),_.jsx("div",{className:"space-y-2",children:H.participants.map((te,ne)=>_.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-md hover:bg-accent",children:[_.jsx(rb,{className:"h-8 w-8",children:_.jsx(ib,{children:te.charAt(0)})}),_.jsxs("div",{children:[_.jsx("p",{className:"font-medium",children:te===(D==null?void 0:D.id)?"You":te}),te===H.created_by&&_.jsx("p",{className:"text-xs text-muted-foreground",children:"Room Creator"})]})]},ne))})]}),_.jsx(Iu,{children:_.jsxs("p",{className:"text-sm text-muted-foreground",children:["Room Code: ",H.room_code," (Share this code to invite others)"]})})]})})}),_.jsx(Vn.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:_.jsx(ja,{value:"voice",children:_.jsx(A_t,{children:_.jsx(R_t,{roomUrl:H.daily_room_url||H.id,isVoiceEnabled:H.voice_enabled??!0,isAdmin:(D==null?void 0:D.id)===H.created_by,onToggleVoice:ae,onSwitchToTextChat:ce})})})})]})]})]})})})}):_.jsx(Nr,{delay:.1,children:_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[_.jsxs("div",{className:"md:col-span-2 space-y-6",children:[_.jsxs("div",{className:"flex gap-4",children:[_.jsxs(hh,{open:l,onOpenChange:d,children:[_.jsx(fh,{asChild:!0,children:_.jsx(vn,{children:"Create Room"})}),_.jsxs(Tu,{children:[_.jsxs(Cu,{children:[_.jsx(Au,{children:"Create Study Room"}),_.jsx(Ou,{children:"Create a new virtual study room to collaborate with others."})]}),_.jsxs("div",{className:"grid gap-4 py-4",children:[_.jsxs("div",{className:"grid gap-2",children:[_.jsx(fr,{htmlFor:"room-name",children:"Room Name"}),_.jsx(_n,{id:"room-name",value:f.name,onChange:te=>m({...f,name:te.target.value}),placeholder:"e.g., Taxation Study Group"})]}),_.jsxs("div",{className:"grid gap-2",children:[_.jsx(fr,{htmlFor:"room-ca-level",children:"CA Level"}),_.jsxs(yl,{value:f.ca_level,onValueChange:te=>m({...f,ca_level:te}),children:[_.jsx(Oc,{id:"room-ca-level",children:_.jsx(_l,{placeholder:"Select CA Level"})}),_.jsxs(Ic,{children:[_.jsx(Kn,{value:"Foundation",children:"Foundation"}),_.jsx(Kn,{value:"Inter",children:"Inter"}),_.jsx(Kn,{value:"Final",children:"Final"})]})]})]}),_.jsxs("div",{className:"grid gap-2",children:[_.jsx(fr,{htmlFor:"room-description",children:"Description (Optional)"}),_.jsx(_n,{id:"room-description",value:f.description,onChange:te=>m({...f,description:te.target.value}),placeholder:"Briefly describe the purpose of this room"})]})]}),_.jsx(Ru,{children:_.jsx(vn,{onClick:J,children:"Create Room"})})]})]}),_.jsxs(hh,{open:O,onOpenChange:P,children:[_.jsx(fh,{asChild:!0,children:_.jsx(vn,{variant:"outline",children:"Join Room"})}),_.jsxs(Tu,{children:[_.jsxs(Cu,{children:[_.jsx(Au,{children:"Join Study Room"}),_.jsx(Ou,{children:"Enter a room code to join an existing study room."})]}),_.jsx("div",{className:"grid gap-4 py-4",children:_.jsxs("div",{className:"grid gap-2",children:[_.jsx(fr,{htmlFor:"room-code",children:"Room Code"}),_.jsx(_n,{id:"room-code",value:R,onChange:te=>I(te.target.value.replace(/[^0-9]/g,"")),placeholder:"e.g., 123456",maxLength:6})]})}),_.jsx(Ru,{children:_.jsx(vn,{onClick:ee,children:"Join Room"})})]})]})]}),_.jsxs("div",{className:"mb-4 flex gap-4 items-center",children:[_.jsx("label",{className:"font-medium",children:"CA Level:"}),_.jsxs(yl,{value:V,onValueChange:W,children:[_.jsx(Oc,{className:"w-40",children:_.jsx(_l,{placeholder:"Select CA Level"})}),_.jsxs(Ic,{children:[_.jsx(Kn,{value:"All",children:"All"}),_.jsx(Kn,{value:"Foundation",children:"Foundation"}),_.jsx(Kn,{value:"Inter",children:"Inter"}),_.jsx(Kn,{value:"Final",children:"Final"})]})]})]}),_.jsxs(Zn,{children:[_.jsxs(Zr,{children:[_.jsx(pr,{children:"Active Study Rooms"}),_.jsx(ms,{children:"Join an existing study room to collaborate with other students"})]}),_.jsx(mr,{children:ye.length===0?_.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No active study rooms. Create one to get started!"}):_.jsx("div",{className:"space-y-4",children:ye.map((te,ne)=>_.jsx(Nr,{delay:.2+ne*.05,children:_.jsxs(Vn.div,{whileHover:{scale:1.02,boxShadow:"0 8px 24px rgba(0,0,0,0.08)"},transition:{type:"spring",stiffness:300},className:"border rounded-lg p-4 hover:border-primary transition-all duration-200 cursor-pointer",onClick:()=>a(te.id),children:[_.jsxs("div",{className:"flex justify-between items-start mb-2",children:[_.jsxs("div",{children:[_.jsx("h3",{className:"font-medium",children:te.name}),_.jsx("p",{className:"text-sm text-muted-foreground",children:te.ca_level})]}),_.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[_.jsx(WE,{className:"h-4 w-4"}),_.jsx("span",{children:te.participants.length})]})]}),te.description&&_.jsx("p",{className:"text-sm mb-3",children:te.description}),_.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[te.participants.slice(0,3).map((ue,_e)=>_.jsx(rb,{className:"h-6 w-6",children:_.jsx(ib,{className:"text-xs",children:ue.charAt(0)})},_e)),te.participants.length>3&&_.jsxs("div",{className:"h-6 w-6 rounded-full bg-secondary flex items-center justify-center text-xs",children:["+",te.participants.length-3]})]})]})},te.id))})})]})]}),_.jsx("div",{children:_.jsxs(Zn,{children:[_.jsx(Zr,{children:_.jsx(pr,{children:"Study Room Features"})}),_.jsxs(mr,{className:"space-y-4",children:[_.jsxs("div",{className:"flex items-start gap-3",children:[_.jsx("div",{className:"bg-primary/10 p-2 rounded-full",children:_.jsx(Vk,{className:"h-5 w-5 text-primary"})}),_.jsxs("div",{children:[_.jsx("h3",{className:"font-medium",children:"Text Chat"}),_.jsx("p",{className:"text-sm text-muted-foreground",children:"Exchange messages and share information with fellow students"})]})]}),_.jsxs("div",{className:"flex items-start gap-3",children:[_.jsx("div",{className:"bg-primary/10 p-2 rounded-full",children:_.jsx(Sb,{className:"h-5 w-5 text-primary"})}),_.jsxs("div",{children:[_.jsx("h3",{className:"font-medium",children:"Study Tracking"}),_.jsx("p",{className:"text-sm text-muted-foreground",children:"Track study sessions and collaborate on specific topics"})]})]})]}),_.jsx(Iu,{className:"flex-col gap-4",children:_.jsx(vn,{className:"w-full active:scale-95 transition-transform",onClick:()=>d(!0),children:"Create a New Room"})})]})})]})})]})},x_t=()=>{const t=kl().pathname==="/tools",[n,i]=N.useState("All"),l=[{title:"Study Timer",description:"Focus on your studies with our Pomodoro timer",icon:ese,path:"/tools/timer",color:"bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700",iconColor:"text-blue-500"},{title:"Study Planner",description:"Plan and organize your study schedule",icon:Joe,path:"/tools/planner",color:"bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700",iconColor:"text-green-500"},{title:"Study Rooms",description:"Join virtual study rooms with other students",icon:WE,path:"/tools/rooms",color:"bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700",iconColor:"text-purple-500"}];return t?_.jsx("div",{className:"container py-8 md:py-12",children:_.jsxs("div",{className:"max-w-4xl mx-auto",children:[_.jsx(Nr,{children:_.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Tools"})}),_.jsx("p",{className:"text-muted-foreground mb-8",children:"All the tools you need for effective CA exam preparation"}),_.jsxs("div",{className:"mb-4 flex gap-4 items-center",children:[_.jsx("label",{className:"font-medium",children:"CA Level:"}),_.jsxs(yl,{value:n,onValueChange:i,children:[_.jsx(Oc,{className:"w-40",children:_.jsx(_l,{placeholder:"Select CA Level"})}),_.jsxs(Ic,{children:[_.jsx(Kn,{value:"All",children:"All"}),_.jsx(Kn,{value:"Foundation",children:"Foundation"}),_.jsx(Kn,{value:"Inter",children:"Inter"}),_.jsx(Kn,{value:"Final",children:"Final"})]})]})]}),_.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:l.map((d,f)=>_.jsx(Nr,{delay:.1+f*.05,children:_.jsx(Dt,{to:d.path,className:"no-underline group",children:_.jsxs(Zn,{className:"h-full border border-border/40 transition-all duration-200 hover:border-border hover:shadow-md",children:[_.jsx(Zr,{className:"pb-2",children:_.jsxs("div",{className:"flex items-center gap-3",children:[d.icon?_.jsx("div",{className:"p-2 rounded-md bg-gray-100 dark:bg-gray-700",children:_.jsx(d.icon,{size:20,className:d.iconColor})}):null,_.jsx(pr,{className:"text-xl",children:d.title})]})}),_.jsx(mr,{children:_.jsx(ms,{className:"text-sm",children:d.description})})]})})},d.path))})]})}):_.jsxs(oae,{children:[_.jsx(Xr,{path:"/timer",element:_.jsx(u8e,{})}),_.jsx(Xr,{path:"/planner",element:_.jsx(Wyt,{})}),_.jsx(Xr,{path:"/rooms",element:_.jsx(I_t,{})})]})};function au(e,t){return Math.floor(Math.random()*(t-e+1))+e}const Qne=["gst","depreciation","percentage","profitLoss"];function eM(){const e=Qne[au(0,Qne.length-1)];switch(e){case"gst":{const t=au(100,1e4),n=[5,12,18,28][au(0,3)];return{q:`Calculate GST (${n}%) on ₹${t}`,answer:+(t*n/100).toFixed(2),type:e}}case"depreciation":{const t=au(1e3,5e4),n=[10,15,20][au(0,2)];return{q:`Depreciation at ${n}% on asset of ₹${t} (SLM, 1 year)`,answer:+(t*n/100).toFixed(2),type:e}}case"percentage":{const t=au(50,5e3),n=au(1,100);return{q:`What is ${n}% of ₹${t}?`,answer:+(t*n/100).toFixed(2),type:e}}case"profitLoss":{const t=au(100,5e3),n=au(5,30);return{q:`Selling Price if Cost Price is ₹${t} and Profit % is ${n}%?`,answer:+(t*(1+n/100)).toFixed(2),type:e}}default:return{q:"",answer:0,type:"gst"}}}function P_t(){const[e,t]=N.useState(()=>eM()),[n,i]=N.useState(""),[a,l]=N.useState(null),[d,f]=N.useState(0),[m,v]=N.useState(0);function E(S){S.preventDefault();const T=parseFloat(n);if(isNaN(T)){l("Please enter a valid number.");return}Math.abs(T-e.answer)<.01?(l("✅ Correct!"),f(R=>R+1),setTimeout(()=>{t(eM()),i(""),l(null)},1200)):(l(`❌ Incorrect. Correct answer: ₹${e.answer}`),v(R=>R+1),setTimeout(()=>{t(eM()),i(""),l(null)},2200))}return _.jsxs("div",{children:[_.jsx("div",{className:"mb-2 font-semibold",children:"CA Calculation Game"}),_.jsx("div",{className:"mb-4",children:e.q}),_.jsxs("form",{onSubmit:E,className:"flex flex-col items-center gap-2",children:[_.jsx("input",{type:"number",step:"0.01",value:n,onChange:S=>i(S.target.value),className:"border rounded px-3 py-1 w-40 text-center",placeholder:"Enter answer",required:!0}),_.jsx("button",{type:"submit",className:"bg-primary text-white px-4 py-1 rounded mt-1",children:"Check"})]}),a&&_.jsx("div",{className:"mt-3 font-medium",children:a}),_.jsxs("div",{className:"mt-4 text-xs text-muted-foreground",children:["Score: ",d," | Attempts: ",m]})]})}const N_t={documents:[],videos:[]},D_t=["All","Taxation","Financial Reporting","Audit","Cost Accounting","Corporate Law","Economics"];function dg(e){const t=/(?:youtube\.com\/(?:.*v=|(?:v|embed|shorts)\/)|youtu\.be\/)([\w-]{11})/,n=e.match(t);return n?n[1]:null}const k_t=()=>{const[e,t]=N.useState({}),[n,i]=N.useState(""),[a,l]=N.useState(""),[d,f]=N.useState(""),[m,v]=N.useState(!1),[E,S]=N.useState({}),[T,R]=N.useState(""),[I,O]=N.useState(""),[P,D]=N.useState(""),[k,M]=N.useState(null),[$,V]=N.useState(!1),{toast:W}=Hu(),[H,J]=N.useState(N_t),[ee,le]=N.useState("All"),[he,de]=N.useState(""),[ae,ce]=N.useState(!1),[ge,ye]=N.useState(!1),[te,ne]=N.useState(!1),[ue,_e]=N.useState({title:"",category:"",file:null}),[Ce,Ie]=N.useState({title:"",url:"",duration:"",ca_level:"",subject:""}),[Ge,Ze]=N.useState("All"),wt=async()=>{if(!n.trim()||!a.trim()||!d.trim())return;v(!0);const{data:we,error:He}=await Wt.from("resources_notes").insert([{title:n,teacher:d,url:a}]).select();if(v(!1),He){W({title:"Error",description:He.message,variant:"destructive"});return}we&&we.length>0&&t(Ke=>{const Re=Ke[n]?[...Ke[n]]:[],at=we[0];return at&&typeof at=="object"&&"id"in at&&Re.push({id:at.id,teacher:d,url:a}),{...Ke,[n]:Re}}),i(""),l(""),f(""),W({title:"Note Added",description:"Note added successfully!"})},Ft=async()=>{if(!T.trim()||!P.trim()||!I.trim()&&!k)return;V(!0);let we=I,He=!1;if(k){k.name.split(".").pop();const at=`${Date.now()}_${k.name}`,{data:mt,error:At}=await Wt.storage.from("ppt-pdfs").upload(at,k,{contentType:"application/pdf"});if(At){V(!1),W({title:"Upload Error",description:At.message,variant:"destructive"});return}const{data:nn}=Wt.storage.from("ppt-pdfs").getPublicUrl(at);we=(nn==null?void 0:nn.publicUrl)||"",He=!0}const{data:Ke,error:Re}=await Wt.from("resources_ppts").insert([{title:T,teacher:P,url:we,is_pdf:He}]).select();if(V(!1),Re){W({title:"Error",description:Re.message,variant:"destructive"});return}Ke&&Ke.length>0&&S(at=>{const mt=at[T]?[...at[T]]:[],At=Ke[0];return At&&typeof At=="object"&&"id"in At&&mt.push({id:At.id,teacher:P,url:we,is_pdf:He}),{...at,[T]:mt}}),R(""),O(""),D(""),M(null),W({title:"PPT Added",description:"PPT added successfully!"})};N.useEffect(()=>{const we=async()=>{const{data:{user:Re}}=await Wt.auth.getUser();if(Re){const{data:at,error:mt}=await Wt.from("profiles").select("is_admin").eq("id",Re.id).single();mt?ce(!1):at&&"is_admin"in at?ce(at.is_admin===!0):ce(!1)}},He=async()=>{v(!0);const{data:Re,error:at}=await Wt.from("resources_notes").select("*");if(v(!1),!at&&Re){const mt={};Re.forEach(At=>{mt[At.title]||(mt[At.title]=[]),mt[At.title].push({id:At.id,teacher:At.teacher,url:At.url})}),t(mt)}},Ke=async()=>{V(!0);const{data:Re,error:at}=await Wt.from("resources_ppts").select("*");if(V(!1),!at&&Re){const mt={};Re.forEach(At=>{mt[At.title]||(mt[At.title]=[]),mt[At.title].push({id:At.id,teacher:At.teacher,url:At.url,is_pdf:At.is_pdf})}),S(mt)}};we(),He(),Ke()},[]),N.useEffect(()=>{(async()=>{const{data:He,error:Ke}=await Wt.from("videos").select("*");!Ke&&He&&J(Re=>({...Re,videos:He}))})()},[]),H.documents.filter(we=>(Ge==="All"||we.ca_level===Ge)&&(ee==="All"||we.category===ee)&&we.title.toLowerCase().includes(he.toLowerCase()));const ze=H.videos.filter(we=>(Ge==="All"||we.ca_level===Ge)&&we.title.toLowerCase().includes(he.toLowerCase())),Nt=async()=>{if(!Ce.title||!dg(Ce.url)||!Ce.ca_level||Ce.ca_level==="Foundation"&&!Ce.subject){W({title:"Error",description:"Please fill in all required fields",variant:"destructive"});return}const we={title:Ce.title,url:Ce.url,duration:Ce.duration||"00:00",ca_level:Ce.ca_level,subject:Ce.ca_level==="Foundation"?Ce.subject:null,uploadDate:new Date().toISOString().split("T")[0],thumbnailUrl:"/placeholder.svg"},{data:He,error:Ke}=await Wt.from("videos").insert([we]).select();if(Ke){W({title:"Error",description:Ke.message,variant:"destructive"});return}J(Re=>({...Re,videos:[...Re.videos,...He||[]]})),ne(!1),W({title:"Video Added",description:`"${Ce.title}" has been added to resources`}),Ie({title:"",url:"",duration:"",ca_level:"",subject:""})};return _.jsxs("div",{className:"container py-8 md:py-12",children:[_.jsx(Nr,{children:_.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Study Resources"})}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[_.jsx("div",{className:"md:col-span-2",children:_.jsx(_n,{placeholder:"Search resources...",value:he,onChange:we=>de(we.target.value),className:"w-full"})}),_.jsx("div",{children:_.jsxs(yl,{value:ee,onValueChange:le,children:[_.jsx(Oc,{children:_.jsx(_l,{placeholder:"Filter by category"})}),_.jsx(Ic,{children:D_t.map(we=>_.jsx(Kn,{value:we,children:we},we))})]})})]}),_.jsxs("div",{className:"mb-4 flex gap-4 items-center",children:[_.jsx("label",{className:"font-medium",children:"CA Level:"}),_.jsxs(yl,{value:Ge,onValueChange:Ze,children:[_.jsx(Oc,{className:"w-40",children:_.jsx(_l,{placeholder:"Select CA Level"})}),_.jsxs(Ic,{children:[_.jsx(Kn,{value:"All",children:"All"}),_.jsx(Kn,{value:"Foundation",children:"Foundation"}),_.jsx(Kn,{value:"Inter",children:"Inter"}),_.jsx(Kn,{value:"Final",children:"Final"})]})]})]}),ae&&_.jsx("div",{className:"flex gap-4 mb-8",children:_.jsxs(hh,{open:te,onOpenChange:ne,children:[_.jsx(fh,{asChild:!0,children:_.jsx(vn,{variant:"outline",children:"Add YouTube Video"})}),_.jsxs(Tu,{children:[_.jsxs(Cu,{children:[_.jsx(Au,{children:"Add YouTube Video"}),_.jsx(Ou,{children:"Add a new YouTube video resource for students. Paste a valid YouTube link to see a preview."})]}),_.jsxs("div",{className:"grid gap-4 py-4",children:[_.jsxs("div",{className:"grid gap-2",children:[_.jsx(fr,{htmlFor:"video-title",children:"Title"}),_.jsx(_n,{id:"video-title",value:Ce.title,onChange:we=>Ie({...Ce,title:we.target.value}),placeholder:"e.g., GST Calculation Tutorial"})]}),_.jsxs("div",{className:"grid gap-2",children:[_.jsx(fr,{htmlFor:"video-ca-level",children:"CA Level"}),_.jsxs(yl,{value:Ce.ca_level,onValueChange:we=>Ie({...Ce,ca_level:we}),children:[_.jsx(Oc,{id:"video-ca-level",children:_.jsx(_l,{placeholder:"Select CA Level"})}),_.jsxs(Ic,{children:[_.jsx(Kn,{value:"Foundation",children:"Foundation"}),_.jsx(Kn,{value:"Inter",children:"Inter"}),_.jsx(Kn,{value:"Final",children:"Final"})]})]})]}),Ce.ca_level==="Foundation"&&_.jsxs("div",{className:"grid gap-2",children:[_.jsx(fr,{htmlFor:"video-subject",children:"Subject"}),_.jsxs(yl,{value:Ce.subject,onValueChange:we=>Ie({...Ce,subject:we}),children:[_.jsx(Oc,{id:"video-subject",children:_.jsx(_l,{placeholder:"Select Subject"})}),_.jsxs(Ic,{children:[_.jsx(Kn,{value:"Accounting",children:"Accounting"}),_.jsx(Kn,{value:"Business Laws",children:"Business Laws"}),_.jsx(Kn,{value:"Quantitative",children:"Quantitative"}),_.jsx(Kn,{value:"Business Economic",children:"Business Economic"})]})]})]}),_.jsxs("div",{className:"grid gap-2",children:[_.jsx(fr,{htmlFor:"video-url",children:"YouTube URL"}),_.jsx(_n,{id:"video-url",value:Ce.url,onChange:we=>Ie({...Ce,url:we.target.value}),placeholder:"e.g., https://youtube.com/watch?v=..."}),Ce.url&&!dg(Ce.url)&&_.jsx("span",{className:"text-red-500 text-xs",children:"Please enter a valid YouTube URL."}),dg(Ce.url)&&_.jsx("div",{className:"mt-2",children:_.jsx("iframe",{width:"100%",height:"220",src:`https://www.youtube.com/embed/${dg(Ce.url)}`,title:Ce.title||"YouTube Preview",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"w-full h-56 rounded"})})]}),_.jsxs("div",{className:"grid gap-2",children:[_.jsx(fr,{htmlFor:"video-duration",children:"Duration (Optional)"}),_.jsx(_n,{id:"video-duration",value:Ce.duration,onChange:we=>Ie({...Ce,duration:we.target.value}),placeholder:"e.g., 45:30"})]})]}),_.jsx(Ru,{children:_.jsx(vn,{onClick:Nt,disabled:!Ce.title||!dg(Ce.url)||!Ce.ca_level||Ce.ca_level==="Foundation"&&!Ce.subject,children:"Add YouTube Video"})})]})]})}),_.jsxs(lI,{defaultValue:"notes",className:"mt-8",children:[_.jsxs(BS,{className:"mb-6",children:[_.jsx(gs,{value:"notes",children:"Notes"}),_.jsx(gs,{value:"ppts",children:"PPTs"}),_.jsx(gs,{value:"youtube",children:"YouTube"}),_.jsx(gs,{value:"fun-games",children:"Fun Games"})]}),_.jsx(ja,{value:"notes",children:_.jsxs("div",{className:"text-center py-12",children:[_.jsx("h3",{className:"text-lg font-medium mb-4",children:"Notes"}),ae&&_.jsx("div",{className:"flex flex-col items-start w-full",children:_.jsxs(hh,{children:[_.jsx(fh,{asChild:!0,children:_.jsx(vn,{className:"mb-4",children:"Add Note Link"})}),_.jsxs(Tu,{children:[_.jsxs(Cu,{children:[_.jsx(Au,{children:"Add Note Link"}),_.jsx(Ou,{children:"Enter the title, teacher, and URL for the note."})]}),_.jsx(_n,{placeholder:"Title",value:n,onChange:we=>i(we.target.value),className:"mb-2"}),_.jsx(_n,{placeholder:"URL",value:a,onChange:we=>l(we.target.value),className:"mb-2"}),_.jsx(_n,{placeholder:"Teacher",value:d,onChange:we=>f(we.target.value),className:"mb-2"}),_.jsx(Ru,{children:_.jsx(vn,{onClick:wt,disabled:m,children:"Add"})})]})]})}),_.jsx("div",{className:"flex flex-col gap-6 w-full mt-4",children:Object.entries(e).map(([we,He],Ke)=>_.jsxs("div",{className:"rounded-lg border bg-card text-card-foreground shadow p-5 w-full",children:[_.jsxs("div",{className:"flex items-center mb-3",children:[_.jsxs("span",{className:"text-lg font-semibold text-primary mr-2",children:[Ke+1,"."]}),_.jsx("span",{className:"text-lg font-semibold text-primary",children:we})]}),_.jsx("ul",{className:"ml-6 space-y-2",children:He.map((Re,at)=>_.jsxs("li",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"rounded bg-muted px-2 py-0.5 text-xs text-muted-foreground font-semibold mr-2",children:String.fromCharCode(97+at)}),_.jsxs("span",{className:"flex items-center gap-1 text-sm",children:[_.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-700 font-medium",children:[_.jsxs("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"inline-block align-middle text-blue-500",viewBox:"0 0 24 24",children:[_.jsx("path",{d:"M12 20h9"}),_.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19.5 3 21l1.5-4L16.5 3.5Z"})]}),Re.teacher]}),_.jsx("span",{className:"text-gray-400 mx-1",children:"—"}),_.jsxs("a",{href:Re.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline break-all inline-flex items-center gap-1",children:[_.jsxs("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"inline-block align-middle text-blue-400",viewBox:"0 0 24 24",children:[_.jsx("path",{d:"M10 13a5 5 0 0 1 7 7l-1 1a5 5 0 0 1-7-7"}),_.jsx("path",{d:"M8 11a5 5 0 0 1 7-7l1 1a5 5 0 0 1-7 7"}),_.jsx("line",{x1:"8",x2:"16",y1:"8",y2:"16"})]}),Re.url]})]})]},at))})]},we))})]})}),_.jsx(ja,{value:"ppts",children:_.jsxs("div",{className:"text-center py-12",children:[_.jsx("h3",{className:"text-lg font-medium mb-4",children:"PPTs"}),ae&&_.jsx("div",{className:"flex flex-col items-start w-full",children:_.jsxs(hh,{children:[_.jsx(fh,{asChild:!0,children:_.jsx(vn,{className:"mb-4",children:"Add PPT Resource"})}),_.jsxs(Tu,{children:[_.jsxs(Cu,{children:[_.jsx(Au,{children:"Add PPT Resource"}),_.jsx(Ou,{children:"Enter the title, teacher, and URL or upload a PDF for the PPT."})]}),_.jsx(_n,{placeholder:"Title",value:T,onChange:we=>R(we.target.value),className:"mb-2"}),_.jsx(_n,{placeholder:"URL",value:I,onChange:we=>O(we.target.value),className:"mb-2"}),_.jsx(_n,{placeholder:"Teacher",value:P,onChange:we=>D(we.target.value),className:"mb-2"}),_.jsxs("div",{className:"mb-2 flex flex-col gap-2",children:[_.jsx("label",{className:"font-medium",children:"Or upload PDF"}),_.jsx("input",{type:"file",accept:"application/pdf",onChange:we=>{var He;return M(((He=we.target.files)==null?void 0:He[0])||null)}}),k&&_.jsxs("span",{className:"text-xs text-green-600",children:["Selected: ",k.name]})]}),_.jsx(Ru,{children:_.jsx(vn,{onClick:Ft,disabled:$||!I.trim()&&!k||!T.trim()||!P.trim(),children:"Add"})})]})]})}),_.jsx("div",{className:"flex flex-col gap-6 w-full mt-4",children:Object.entries(E).map(([we,He],Ke)=>_.jsxs("div",{className:"rounded-lg border bg-card text-card-foreground shadow p-5 w-full",children:[_.jsxs("div",{className:"flex items-center mb-3",children:[_.jsxs("span",{className:"text-lg font-semibold text-primary mr-2",children:[Ke+1,"."]}),_.jsx("span",{className:"text-lg font-semibold text-primary",children:we})]}),_.jsx("ul",{className:"ml-6 space-y-2",children:He.map((Re,at)=>_.jsxs("li",{className:"flex items-center gap-2",children:[_.jsx("span",{className:"rounded bg-muted px-2 py-0.5 text-xs text-muted-foreground font-semibold mr-2",children:String.fromCharCode(97+at)}),_.jsxs("span",{className:"flex items-center gap-1 text-sm",children:[_.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-700 font-medium",children:[_.jsxs("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"inline-block align-middle text-blue-500",viewBox:"0 0 24 24",children:[_.jsx("path",{d:"M12 20h9"}),_.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19.5 3 21l1.5-4L16.5 3.5Z"})]}),Re.teacher]}),_.jsx("span",{className:"text-gray-400 mx-1",children:"—"}),Re.is_pdf?_.jsxs("a",{href:Re.url,target:"_blank",rel:"noopener noreferrer",className:"text-green-700 underline break-all inline-flex items-center gap-1",children:[_.jsxs("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"inline-block align-middle text-green-600",viewBox:"0 0 24 24",children:[_.jsx("path",{d:"M12 20h9"}),_.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19.5 3 21l1.5-4L16.5 3.5Z"})]}),"PDF"]}):_.jsxs("a",{href:Re.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline break-all inline-flex items-center gap-1",children:[_.jsxs("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"inline-block align-middle text-blue-400",viewBox:"0 0 24 24",children:[_.jsx("path",{d:"M10 13a5 5 0 0 1 7 7l-1 1a5 5 0 0 1-7-7"}),_.jsx("path",{d:"M8 11a5 5 0 0 1 7-7l1 1a5 5 0 0 1-7 7"}),_.jsx("line",{x1:"8",x2:"16",y1:"8",y2:"16"})]}),Re.url]})]})]},at))})]},we))})]})}),_.jsx(ja,{value:"youtube",children:ze.length===0?_.jsxs("div",{className:"text-center py-12",children:[_.jsx(jLe,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),_.jsx("h3",{className:"text-lg font-medium",children:"No YouTube videos found"}),_.jsx("p",{className:"text-muted-foreground",children:he?`No results for "${he}"`:"No YouTube videos available. Add your first video!"})]}):_.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:ze.map((we,He)=>{const Ke=dg(we.url);return _.jsx(Nr,{delay:.1+He*.05,children:_.jsxs(Zn,{className:"overflow-hidden",children:[_.jsx("div",{className:"aspect-video relative bg-muted flex items-center justify-center",children:Ke?_.jsx("iframe",{width:"100%",height:"220",src:`https://www.youtube.com/embed/${Ke}`,title:we.title,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"w-full h-56"}):_.jsx("img",{src:we.thumbnailUrl,alt:we.title,className:"object-cover w-full",loading:"lazy",style:{maxHeight:220,width:"100%",objectFit:"cover"}})}),_.jsxs(Zr,{className:"py-4",children:[_.jsx(pr,{className:"text-lg",children:we.title}),_.jsx(ms,{children:we.category})]}),_.jsxs(Iu,{className:"flex justify-between py-3",children:[_.jsxs("span",{className:"text-sm text-muted-foreground",children:["Duration: ",we.duration]}),_.jsx("span",{className:"text-sm text-muted-foreground",children:we.uploadDate})]})]})},we.id)})})}),_.jsx(ja,{value:"fun-games",children:_.jsxs("div",{className:"text-center py-12",children:[_.jsx("h3",{className:"text-lg font-medium mb-4",children:"Fun Games"}),_.jsx("div",{className:"max-w-md mx-auto bg-card rounded shadow p-6",children:_.jsx(P_t,{})})]})})]})]})},L_t=()=>_.jsxs("div",{className:"container py-8 md:py-12",children:[_.jsx("h1",{className:"text-3xl font-bold mb-6",children:"MCQ Practice"}),_.jsx("p",{className:"mb-4 text-muted-foreground",children:"Practice Multiple Choice Questions for your CA preparation. (Content coming soon!)"})]}),M_t=()=>_.jsxs("div",{className:"relative container py-8 md:py-12 flex items-center justify-center min-h-[300px]",children:[_.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10 pointer-events-none",children:_.jsx("span",{className:"bg-yellow-400 text-yellow-900 text-lg font-bold px-8 py-4 rounded-xl shadow-lg opacity-90 border-2 border-yellow-600 animate-pulse",children:"🚧 Coming Soon 🚧"})}),_.jsxs("div",{className:"opacity-40 blur-sm select-none pointer-events-none",children:[_.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Test Yourself"}),_.jsx("p",{className:"mb-4 text-muted-foreground",children:"Take full-length or topic-wise tests to assess your CA exam readiness."})]})]}),j_t=()=>_.jsxs("div",{className:"container py-8 md:py-12",children:[_.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Preparation"}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[_.jsxs(Dt,{to:"/resources",className:"block p-6 border border-border/40 rounded-lg shadow hover:shadow-md hover:border-border transition-all",children:[_.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Resources"}),_.jsx("p",{className:"text-muted-foreground",children:"Access helpful resources for your CA preparation."})]}),_.jsxs(Dt,{to:"/mcq",className:"block p-6 border border-border/40 rounded-lg shadow hover:shadow-md hover:border-border transition-all",children:[_.jsx("h2",{className:"text-xl font-semibold mb-2",children:"MCQ"}),_.jsx("p",{className:"text-muted-foreground",children:"Practice Multiple Choice Questions for your CA exams."})]}),_.jsxs(Dt,{to:"/test",className:"block p-6 border border-border/40 rounded-lg shadow hover:shadow-md hover:border-border transition-all opacity-60 pointer-events-none select-none",children:[_.jsxs("h2",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:["Test",_.jsx("span",{className:"bg-yellow-200 text-yellow-800 text-xs font-bold px-2 py-0.5 rounded-full",children:"Coming Soon"})]}),_.jsx("p",{className:"text-muted-foreground",children:"Take full-length or topic-wise tests to assess your readiness."})]})]})]}),U_t=()=>{const{toast:e}=Hu(),{signIn:t}=jc(),n=xS(),[i,a]=N.useState(""),[l,d]=N.useState(""),[f,m]=N.useState(!1),v=async E=>{if(E.preventDefault(),!i||!l){e({title:"Error",description:"Please enter both email and password",variant:"destructive"});return}m(!0);try{const{error:S}=await t(i,l);S?e({title:"Login Failed",description:S.message,variant:"destructive"}):(e({title:"Success",description:"Successfully logged in!"}),n("/"))}catch(S){e({title:"Error",description:"An unexpected error occurred",variant:"destructive"}),console.error("Login error:",S)}finally{m(!1)}};return _.jsxs("div",{className:"relative",children:[_.jsxs("div",{className:"container max-w-md py-16 md:py-24",children:[_.jsx("div",{className:"mb-6 text-center",children:_.jsxs("div",{className:"inline-flex items-center mb-6",children:[_.jsx("div",{className:"w-10 h-10 rounded-lg bg-primary flex items-center justify-center",children:_.jsx("span",{className:"text-white text-lg font-bold",children:"CA"})}),_.jsx("h1",{className:"ml-2 text-3xl font-semibold",children:"Unfiltered CA"})]})}),_.jsxs(Zn,{className:"border border-border/40 shadow-sm",children:[_.jsxs(Zr,{className:"space-y-1",children:[_.jsx(pr,{className:"text-2xl",children:"Sign in"}),_.jsx(ms,{children:"Enter your email and password to access your account"})]}),_.jsxs("form",{onSubmit:v,children:[_.jsxs(mr,{className:"space-y-4",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsx(fr,{htmlFor:"email",children:"Email"}),_.jsx(_n,{id:"email",type:"email",placeholder:"your.email@example.com",value:i,onChange:E=>a(E.target.value),required:!0,className:"h-11"})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsx(fr,{htmlFor:"password",children:"Password"}),_.jsx(Dt,{to:"/forgot-password",className:"text-sm text-primary hover:underline",children:"Forgot password?"})]}),_.jsx(_n,{id:"password",type:"password",value:l,onChange:E=>d(E.target.value),required:!0,className:"h-11"})]})]}),_.jsxs(Iu,{className:"flex-col gap-4",children:[_.jsx(Fr,{type:"submit",className:"w-full h-11",disabled:f,hoverScale:1.02,children:f?"Signing in...":"Sign in"}),_.jsxs("div",{className:"text-center text-sm",children:["Don't have an account?"," ",_.jsx(Dt,{to:"/register",className:"text-primary hover:underline",children:"Sign up"})]})]})]})]})]}),_.jsx("div",{className:"fixed bottom-4 right-4 z-0 opacity-60 pointer-events-none select-none",children:_.jsx(cp,{name:"law",className:"w-40 h-40"})})]})};var cx="Checkbox",[V_t,LEt]=ta(cx),[F_t,l3]=V_t(cx);function B_t(e){const{__scopeCheckbox:t,checked:n,children:i,defaultChecked:a,disabled:l,form:d,name:f,onCheckedChange:m,required:v,value:E="on",internal_do_not_use_render:S}=e,[T,R]=Eh({prop:n,defaultProp:a??!1,onChange:m,caller:cx}),[I,O]=N.useState(null),[P,D]=N.useState(null),k=N.useRef(!1),M=I?!!d||!!I.closest("form"):!0,$={checked:T,disabled:l,setChecked:R,control:I,setControl:O,name:f,form:d,value:E,hasConsumerStoppedPropagationRef:k,required:v,defaultChecked:vh(a)?!1:a,isFormControl:M,bubbleInput:P,setBubbleInput:D};return _.jsx(F_t,{scope:t,...$,children:$_t(S)?S($):i})}var _ge="CheckboxTrigger",Ege=N.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:n,...i},a)=>{const{control:l,value:d,disabled:f,checked:m,required:v,setControl:E,setChecked:S,hasConsumerStoppedPropagationRef:T,isFormControl:R,bubbleInput:I}=l3(_ge,e),O=fn(a,E),P=N.useRef(m);return N.useEffect(()=>{const D=l==null?void 0:l.form;if(D){const k=()=>S(P.current);return D.addEventListener("reset",k),()=>D.removeEventListener("reset",k)}},[l,S]),_.jsx(yt.button,{type:"button",role:"checkbox","aria-checked":vh(m)?"mixed":m,"aria-required":v,"data-state":Cge(m),"data-disabled":f?"":void 0,disabled:f,value:d,...i,ref:O,onKeyDown:et(t,D=>{D.key==="Enter"&&D.preventDefault()}),onClick:et(n,D=>{S(k=>vh(k)?!0:!k),I&&R&&(T.current=D.isPropagationStopped(),T.current||D.stopPropagation())})})});Ege.displayName=_ge;var u3=N.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:i,checked:a,defaultChecked:l,required:d,disabled:f,value:m,onCheckedChange:v,form:E,...S}=e;return _.jsx(B_t,{__scopeCheckbox:n,checked:a,defaultChecked:l,disabled:f,required:d,onCheckedChange:v,name:i,form:E,value:m,internal_do_not_use_render:({isFormControl:T})=>_.jsxs(_.Fragment,{children:[_.jsx(Ege,{...S,ref:t,__scopeCheckbox:n}),T&&_.jsx(Tge,{__scopeCheckbox:n})]})})});u3.displayName=cx;var bge="CheckboxIndicator",Sge=N.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:i,...a}=e,l=l3(bge,n);return _.jsx(Ao,{present:i||vh(l.checked)||l.checked===!0,children:_.jsx(yt.span,{"data-state":Cge(l.checked),"data-disabled":l.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});Sge.displayName=bge;var wge="CheckboxBubbleInput",Tge=N.forwardRef(({__scopeCheckbox:e,...t},n)=>{const{control:i,hasConsumerStoppedPropagationRef:a,checked:l,defaultChecked:d,required:f,disabled:m,name:v,value:E,form:S,bubbleInput:T,setBubbleInput:R}=l3(wge,e),I=fn(n,R),O=Wue(l),P=wse(i);N.useEffect(()=>{const k=T;if(!k)return;const M=window.HTMLInputElement.prototype,V=Object.getOwnPropertyDescriptor(M,"checked").set,W=!a.current;if(O!==l&&V){const H=new Event("click",{bubbles:W});k.indeterminate=vh(l),V.call(k,vh(l)?!1:l),k.dispatchEvent(H)}},[T,O,l,a]);const D=N.useRef(vh(l)?!1:l);return _.jsx(yt.input,{type:"checkbox","aria-hidden":!0,defaultChecked:d??D.current,required:f,disabled:m,name:v,value:E,form:S,...t,tabIndex:-1,ref:I,style:{...t.style,...P,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Tge.displayName=wge;function $_t(e){return typeof e=="function"}function vh(e){return e==="indeterminate"}function Cge(e){return vh(e)?"indeterminate":e?"checked":"unchecked"}const Rge=N.forwardRef(({className:e,...t},n)=>_.jsx(u3,{ref:n,className:gt("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:_.jsx(Sge,{className:gt("flex items-center justify-center text-current"),children:_.jsx(RO,{className:"h-4 w-4"})})}));Rge.displayName=u3.displayName;const W_t=()=>{const{toast:e}=Hu(),{signUp:t}=jc(),[n,i]=N.useState(""),[a,l]=N.useState(""),[d,f]=N.useState(""),[m,v]=N.useState(!1),[E,S]=N.useState(!1),T=async R=>{if(R.preventDefault(),!n||!a||!d){e({title:"Error",description:"Please fill in all fields",variant:"destructive"});return}if(d.length<6){e({title:"Error",description:"Password must be at least 6 characters long",variant:"destructive"});return}if(!E){e({title:"Error",description:"Please accept the terms of service and privacy policy",variant:"destructive"});return}v(!0);try{const{error:I}=await t(a,d,n);e(I?{title:"Registration Failed",description:I.message,variant:"destructive"}:{title:"Success",description:"Account created successfully! Please check your email for verification."})}catch(I){e({title:"Error",description:"An unexpected error occurred",variant:"destructive"}),console.error("Registration error:",I)}finally{v(!1)}};return _.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"container max-w-md py-16 md:py-24",children:_.jsxs(Zn,{children:[_.jsxs(Zr,{className:"space-y-1",children:[_.jsx(pr,{className:"text-2xl font-bold",children:"Create an account"}),_.jsx(ms,{children:"Enter your information to create an account"})]}),_.jsxs("form",{onSubmit:T,children:[_.jsxs(mr,{className:"space-y-4",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsx(fr,{htmlFor:"name",children:"Full Name"}),_.jsx(_n,{id:"name",placeholder:"John Doe",value:n,onChange:R=>i(R.target.value),required:!0})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(fr,{htmlFor:"email",children:"Email"}),_.jsx(_n,{id:"email",type:"email",placeholder:"your.email@example.com",value:a,onChange:R=>l(R.target.value),required:!0})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(fr,{htmlFor:"password",children:"Password"}),_.jsx(_n,{id:"password",type:"password",value:d,onChange:R=>f(R.target.value),required:!0}),_.jsx("p",{className:"text-xs text-muted-foreground",children:"Must be at least 6 characters long"})]}),_.jsxs("div",{className:"flex items-center space-x-2",children:[_.jsx(Rge,{id:"terms",checked:E,onCheckedChange:R=>S(R===!0)}),_.jsxs("label",{htmlFor:"terms",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:["I agree to the"," ",_.jsx(Dt,{to:"/terms",className:"text-primary hover:underline",children:"terms of service"})," ","and"," ",_.jsx(Dt,{to:"/privacy",className:"text-primary hover:underline",children:"privacy policy"})]})]})]}),_.jsxs(Iu,{className:"flex-col gap-4",children:[_.jsx(Fr,{type:"submit",className:"w-full",disabled:m,hoverScale:1.02,children:m?"Creating account...":"Create account"}),_.jsxs("div",{className:"text-center text-sm",children:["Already have an account?"," ",_.jsx(Dt,{to:"/login",className:"text-primary hover:underline",children:"Sign in"})]})]})]})]})}),_.jsx("div",{className:"fixed bottom-4 right-4 z-0 opacity-60 pointer-events-none select-none",children:_.jsx(cp,{name:"law",className:"w-40 h-40"})})]})},G_t=()=>{const{toast:e}=Hu(),{user:t,signOut:n}=jc(),[i,a]=N.useState(!1),[l,d]=N.useState({name:"",email:"",bio:""});N.useEffect(()=>{(async()=>{var S;if(t)try{const{data:T,error:R}=await Wt.from("profiles").select("full_name").eq("id",t.id).single();if(R)throw R;d({name:(T==null?void 0:T.full_name)||((S=t.user_metadata)==null?void 0:S.full_name)||"",email:t.email||"",bio:"CA student preparing for finals"})}catch(T){console.error("Error fetching profile:",T)}})()},[t]);const f=async E=>{if(E.preventDefault(),!!t){a(!0);try{const{error:S}=await Wt.from("profiles").update({full_name:l.name}).eq("id",t.id);if(S)throw S;e({title:"Profile updated",description:"Your profile changes have been saved."})}catch(S){e({title:"Error",description:S.message||"Failed to update profile",variant:"destructive"}),console.error("Profile update error:",S)}finally{a(!1)}}},m=async E=>{E.preventDefault();const S=new FormData(E.target),T=S.get("current-password"),R=S.get("new-password"),I=S.get("confirm-password");if(!T||!R||!I){e({title:"Error",description:"Please fill in all password fields",variant:"destructive"});return}if(R!==I){e({title:"Error",description:"New passwords do not match",variant:"destructive"});return}a(!0);try{const{error:O}=await Wt.auth.signInWithPassword({email:(t==null?void 0:t.email)||"",password:T});if(O){e({title:"Error",description:"Current password is incorrect",variant:"destructive"}),a(!1);return}const{error:P}=await Wt.auth.updateUser({password:R});if(P)throw P;e({title:"Password updated",description:"Your password has been changed successfully."}),E.target.reset()}catch(O){e({title:"Error",description:O.message||"Failed to update password",variant:"destructive"}),console.error("Password change error:",O)}finally{a(!1)}},v=async()=>{try{await n(),e({title:"Signed out",description:"You have been signed out successfully."})}catch(E){console.error("Sign out error:",E)}};return _.jsx("div",{className:"container py-12 md:py-16",children:_.jsxs("div",{className:"space-y-10",children:[_.jsxs("div",{children:[_.jsx("h1",{className:"text-3xl font-bold",children:"Account Settings"}),_.jsx("p",{className:"text-muted-foreground",children:"Manage your account settings and profile information"})]}),_.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[_.jsx("aside",{className:"md:w-1/4",children:_.jsxs("div",{className:"space-y-4",children:[_.jsxs("div",{className:"flex flex-col items-center space-y-2 border rounded-lg p-6",children:[_.jsxs(rb,{className:"h-24 w-24",children:[_.jsx(ege,{src:"/placeholder.svg"}),_.jsx(ib,{children:l.name.charAt(0)})]}),_.jsxs("div",{className:"text-center",children:[_.jsx("h2",{className:"text-xl font-bold",children:l.name}),_.jsx("p",{className:"text-sm text-muted-foreground",children:l.email})]}),_.jsx(vn,{variant:"outline",className:"w-full",children:"Change Avatar"})]}),_.jsxs(Zn,{children:[_.jsx(Zr,{children:_.jsx(pr,{children:"Study Statistics"})}),_.jsxs(mr,{className:"space-y-2",children:[_.jsxs("div",{className:"flex justify-between",children:[_.jsx("span",{className:"text-muted-foreground",children:"Total Study Time"}),_.jsx("span",{children:"24h 30m"})]}),_.jsxs("div",{className:"flex justify-between",children:[_.jsx("span",{className:"text-muted-foreground",children:"Sessions Completed"}),_.jsx("span",{children:"42"})]}),_.jsxs("div",{className:"flex justify-between",children:[_.jsx("span",{className:"text-muted-foreground",children:"Average Session"}),_.jsx("span",{children:"35m"})]})]}),_.jsx(Iu,{children:_.jsx(vn,{variant:"outline",className:"w-full",onClick:v,children:"Sign Out"})})]})]})}),_.jsx("div",{className:"flex-1",children:_.jsxs(lI,{defaultValue:"profile",children:[_.jsxs(BS,{className:"mb-6",children:[_.jsx(gs,{value:"profile",children:"Profile"}),_.jsx(gs,{value:"password",children:"Password"}),_.jsx(gs,{value:"notifications",children:"Notifications"})]}),_.jsx(ja,{value:"profile",children:_.jsx(Zn,{children:_.jsxs("form",{onSubmit:f,children:[_.jsxs(Zr,{children:[_.jsx(pr,{children:"Profile Information"}),_.jsx(ms,{children:"Update your personal information."})]}),_.jsxs(mr,{className:"space-y-4",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsx(fr,{htmlFor:"name",children:"Full Name"}),_.jsx(_n,{id:"name",value:l.name,onChange:E=>d({...l,name:E.target.value})})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(fr,{htmlFor:"email",children:"Email"}),_.jsx(_n,{id:"email",type:"email",value:l.email,disabled:!0}),_.jsx("p",{className:"text-xs text-muted-foreground",children:"Email cannot be changed"})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(fr,{htmlFor:"bio",children:"Bio"}),_.jsx(_n,{id:"bio",value:l.bio,onChange:E=>d({...l,bio:E.target.value})})]})]}),_.jsx(Iu,{children:_.jsx(vn,{type:"submit",disabled:i,children:i?"Saving...":"Save changes"})})]})})}),_.jsx(ja,{value:"password",children:_.jsx(Zn,{children:_.jsxs("form",{onSubmit:m,children:[_.jsxs(Zr,{children:[_.jsx(pr,{children:"Change Password"}),_.jsx(ms,{children:"Update your password to enhance account security."})]}),_.jsxs(mr,{className:"space-y-4",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsx(fr,{htmlFor:"current-password",children:"Current Password"}),_.jsx(_n,{id:"current-password",name:"current-password",type:"password"})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(fr,{htmlFor:"new-password",children:"New Password"}),_.jsx(_n,{id:"new-password",name:"new-password",type:"password"})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(fr,{htmlFor:"confirm-password",children:"Confirm New Password"}),_.jsx(_n,{id:"confirm-password",name:"confirm-password",type:"password"})]})]}),_.jsx(Iu,{children:_.jsx(vn,{type:"submit",disabled:i,children:i?"Updating...":"Update Password"})})]})})}),_.jsx(ja,{value:"notifications",children:_.jsxs(Zn,{children:[_.jsxs(Zr,{children:[_.jsx(pr,{children:"Notifications"}),_.jsx(ms,{children:"Configure how you receive notifications."})]}),_.jsx(mr,{children:_.jsx("p",{className:"text-muted-foreground",children:"Notification settings will be implemented in a future update."})})]})})]})})]})]})})},H_t=()=>{const e=kl();return N.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),_.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:_.jsxs("div",{className:"text-center",children:[_.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),_.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),_.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})};function K_t(){const[e,t]=N.useState([]),[n,i]=N.useState(!0),[a,l]=N.useState(!1),[d,f]=N.useState(""),[m,v]=N.useState(""),[E,S]=N.useState(!1),[T,R]=N.useState(null);N.useEffect(()=>{I()},[]);async function I(){i(!0);const{data:P,error:D}=await Wt.from("forum_questions").select("id, title, description, created_at, updated_at");if(D){i(!1);return}const k=await Promise.all((P||[]).map(async M=>{const{count:$}=await Wt.from("forum_upvotes").select("*",{count:"exact",head:!0}).eq("question_id",M.id),{count:V}=await Wt.from("forum_answers").select("*",{count:"exact",head:!0}).eq("question_id",M.id);return{...M,upvotes:$||0,answers:V||0}}));t(k),i(!1)}async function O(P){if(P.preventDefault(),!d.trim()){R("Title is required.");return}S(!0),R(null);const{error:D}=await Wt.from("forum_questions").insert([{title:d,description:m}]);if(S(!1),D){R("Failed to post question.");return}f(""),v(""),l(!1),I()}return _.jsxs("div",{className:"container py-10",children:[_.jsxs("div",{className:"flex justify-between items-center mb-8",children:[_.jsx("h1",{className:"text-2xl font-bold",children:"Discussion Forum"}),_.jsxs(hh,{open:a,onOpenChange:l,children:[_.jsx(fh,{asChild:!0,children:_.jsx(vn,{children:"Ask a Question"})}),_.jsxs(Tu,{children:[_.jsxs(Cu,{children:[_.jsx(Au,{children:"Ask a Question"}),_.jsx(Ou,{children:"Share your question with the community."})]}),_.jsxs("form",{onSubmit:O,className:"space-y-4",children:[_.jsx(_n,{placeholder:"Question Title",value:d,onChange:P=>f(P.target.value),required:!0}),_.jsx(iI,{placeholder:"Describe your question (optional)",value:m,onChange:P=>v(P.target.value)}),T&&_.jsx("div",{className:"text-red-500 text-sm pb-2",children:T}),_.jsx(Ru,{children:_.jsx(vn,{type:"submit",disabled:E,children:E?"Posting...":"Post Question"})})]})]})]})]}),n?_.jsx("div",{children:"Loading questions..."}):e.length===0?_.jsx("div",{children:"No questions yet. Be the first to ask!"}):_.jsx("div",{className:"space-y-4",children:e.map(P=>_.jsxs("div",{className:"border rounded p-4 flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx(Dt,{to:`/forum/${P.id}`,className:"text-lg font-semibold hover:underline",children:P.title}),_.jsxs("div",{className:"text-muted-foreground text-xs mt-1",children:[P.answers," Answers • ",P.upvotes," Upvotes"]})]}),_.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(P.created_at).toLocaleString()})]},P.id))})]})}function z_t(){const{id:e}=SUe(),{user:t}=jc(),[n,i]=N.useState(null),[a,l]=N.useState([]),[d,f]=N.useState(!0),[m,v]=N.useState(""),[E,S]=N.useState(!1),[T,R]=N.useState(null),[I,O]=N.useState(!1),[P,D]=N.useState(null);N.useEffect(()=>{k()},[e]);async function k(){f(!0);const{data:V,error:W}=await Wt.from("forum_questions").select("*").eq("id",e).single();if(W){f(!1),i(null);return}i(V);const{data:H}=await Wt.from("forum_answers").select("*").eq("question_id",e).order("created_at",{ascending:!0});l(H||[]),f(!1)}async function M(V){if(V.preventDefault(),!m.trim()){R("Answer cannot be empty.");return}if(!t){R("You must be signed in to answer.");return}S(!0),R(null);const{error:W}=await Wt.from("forum_answers").insert([{question_id:e,answer:m,user_id:t.id}]);if(S(!1),W){R("Failed to post answer.");return}v(""),k()}async function $(){if(!t){D("You must be signed in to upvote.");return}O(!0);const V=t.id,{count:W,error:H}=await Wt.from("forum_upvotes").select("*",{count:"exact",head:!0}).eq("user_id",V).eq("question_id",e);!H&&W===0&&await Wt.from("forum_upvotes").insert([{user_id:V,question_id:e}]),k(),O(!1)}return _.jsx("div",{className:"container py-10 max-w-2xl mx-auto",children:d?_.jsx("div",{children:"Loading..."}):n?_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"mb-6",children:[_.jsx("h2",{className:"text-xl font-bold mb-2",children:n.title}),_.jsx("div",{className:"text-muted-foreground mb-2",children:n.description}),_.jsxs("div",{className:"flex gap-4 items-center mb-2",children:[_.jsx(vn,{onClick:$,disabled:I,variant:"outline",children:"Upvote"}),_.jsx("span",{className:"text-sm"}),P&&_.jsx("span",{className:"text-xs text-blue-600 ml-3",children:P})]}),_.jsxs("div",{className:"text-xs text-muted-foreground",children:["Asked on ",new Date(n.created_at).toLocaleString()]})]}),_.jsxs("div",{className:"mb-8",children:[_.jsx("h3",{className:"font-semibold mb-2",children:"Answers"}),a.length===0?_.jsx("div",{children:"No answers yet."}):_.jsx("div",{className:"space-y-4",children:a.map(V=>_.jsxs("div",{className:"border rounded p-3",children:[_.jsx("div",{children:V.answer}),_.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Answered on ",new Date(V.created_at).toLocaleString()]})]},V.id))})]}),_.jsxs("form",{onSubmit:M,className:"space-y-2",children:[_.jsx(iI,{placeholder:"Write your answer...",value:m,onChange:V=>v(V.target.value),required:!0}),T&&_.jsx("div",{className:"text-red-500 text-sm pb-2",children:T}),_.jsx(vn,{type:"submit",disabled:E,children:E?"Posting...":"Post Answer"})]})]}):_.jsx("div",{children:"Question not found."})})}const Y_t=()=>_.jsxs("div",{className:"container mx-auto py-10 max-w-3xl",children:[_.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Privacy Policy"}),_.jsx("p",{className:"mb-4",children:"Last updated: June 1, 2025"}),_.jsx("p",{className:"mb-4",children:'This Privacy Policy describes how Unfiltered CA ("we", "us", or "our") collects, uses, and protects your information when you use our website and services.'}),_.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2",children:"1. Information We Collect"}),_.jsxs("ul",{className:"list-disc list-inside mb-4",children:[_.jsxs("li",{children:[_.jsx("b",{children:"Personal Information:"})," When you register, contact us, or use certain features, we may collect your name, email address, and other details you provide."]}),_.jsxs("li",{children:[_.jsx("b",{children:"Usage Data:"})," We collect information about how you use the site, such as pages visited and interactions."]})]}),_.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2",children:"2. How We Use Your Information"}),_.jsxs("ul",{className:"list-disc list-inside mb-4",children:[_.jsx("li",{children:"To provide and maintain our services."}),_.jsxs("li",{children:["To communicate with you, including responding to inquiries at ",_.jsx("a",{href:"mailto:unfilteredca07@gmail.com",className:"underline",children:"unfilteredca07@gmail.com"}),"."]}),_.jsx("li",{children:"To improve our website and user experience."})]}),_.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2",children:"3. Sharing Your Information"}),_.jsx("p",{className:"mb-4",children:"We do not sell or rent your personal information. We may share information with service providers who help us operate the site, or if required by law."}),_.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2",children:"4. Security"}),_.jsx("p",{className:"mb-4",children:"We take reasonable measures to protect your data. However, no method of transmission over the internet is 100% secure."}),_.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2",children:"5. Your Choices"}),_.jsxs("p",{className:"mb-4",children:["You may contact us at ",_.jsx("a",{href:"mailto:unfilteredca07@gmail.com",className:"underline",children:"unfilteredca07@gmail.com"})," to update or delete your information."]}),_.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2",children:"6. Changes to This Policy"}),_.jsx("p",{className:"mb-4",children:"We may update this Privacy Policy from time to time. Changes will be posted on this page."}),_.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2",children:"7. Contact"}),_.jsxs("p",{children:["If you have any questions about this Privacy Policy, please contact us at ",_.jsx("a",{href:"mailto:unfilteredca07@gmail.com",className:"underline",children:"unfilteredca07@gmail.com"}),"."]})]}),q_t=()=>_.jsxs("div",{className:"container mx-auto py-10 max-w-3xl",children:[_.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Terms of Service"}),_.jsx("p",{className:"mb-4",children:"Last updated: June 1, 2025"}),_.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2",children:"1. Acceptance of Terms"}),_.jsx("p",{className:"mb-4",children:"By using Unfiltered CA, you agree to these Terms of Service. If you do not agree, please do not use our website."}),_.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2",children:"2. Use of the Service"}),_.jsx("p",{className:"mb-4",children:"You agree to use the site for lawful purposes only. You must not misuse or interfere with the site’s operation."}),_.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2",children:"3. User Accounts"}),_.jsx("p",{className:"mb-4",children:"You are responsible for maintaining the confidentiality of your account. Notify us immediately of any unauthorized use."}),_.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2",children:"4. Intellectual Property"}),_.jsx("p",{className:"mb-4",children:"All content on this site is owned by Unfiltered CA or its licensors. You may not copy or distribute content without permission."}),_.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2",children:"5. Limitation of Liability"}),_.jsx("p",{className:"mb-4",children:"We are not liable for any damages arising from your use of the site."}),_.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2",children:"6. Changes to Terms"}),_.jsx("p",{className:"mb-4",children:"We may update these terms at any time. Continued use of the site means you accept the new terms."}),_.jsx("h2",{className:"text-xl font-semibold mt-6 mb-2",children:"7. Contact"}),_.jsxs("p",{children:["If you have any questions about these Terms, please contact us at ",_.jsx("a",{href:"mailto:unfilteredca07@gmail.com",className:"underline",children:"unfilteredca07@gmail.com"}),"."]})]}),X_t=()=>_.jsxs("div",{className:"container mx-auto py-10 max-w-2xl",children:[_.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Help Center"}),_.jsx("p",{className:"mb-4",children:"For any assistance, please contact us at:"}),_.jsx("div",{className:"text-lg font-semibold text-primary",children:"unfilteredca07@gmail.com"})]}),J_t=()=>_.jsxs("div",{className:"container mx-auto py-10 max-w-2xl",children:[_.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Contact Us"}),_.jsx("p",{className:"mb-4",children:"You can reach us at:"}),_.jsx("div",{className:"text-lg font-semibold text-primary",children:"unfilteredca07@gmail.com"})]}),Q_t=({studySessions:e})=>{const t=se.useMemo(()=>{const n={};return e.forEach(i=>{const[a,l]=i.startTime.split(":").map(Number),[d,f]=i.endTime.split(":").map(Number),m=d+f/60-(a+l/60);n[i.subject]=(n[i.subject]||0)+(m>0?m:0)}),Object.entries(n).map(([i,a])=>({subject:i,value:a}))},[e]);return t.length===0?_.jsx("div",{className:"text-muted-foreground",children:"No data for bar chart"}):_.jsx(dB,{width:"100%",height:300,children:_.jsxs(Sme,{data:t,children:[_.jsx(qS,{dataKey:"subject"}),_.jsx(XS,{}),_.jsx(Na,{}),_.jsx(ph,{}),_.jsx(Uh,{dataKey:"value",fill:"#8884d8"})]})})},Zne=["#6366f1","#f59e42","#10b981","#ef4444","#a855f7","#fbbf24"],Z_t=({studySessions:e})=>{const t=se.useMemo(()=>{const n={};return e.forEach(i=>{const[a,l]=i.startTime.split(":").map(Number),[d,f]=i.endTime.split(":").map(Number),m=d+f/60-(a+l/60);n[i.subject]=(n[i.subject]||0)+(m>0?m:0)}),Object.entries(n).map(([i,a])=>({subject:i,value:a}))},[e]);return t.length===0?_.jsx("div",{className:"text-muted-foreground",children:"No data for pie chart"}):_.jsx(dB,{width:"100%",height:300,children:_.jsxs(egt,{children:[_.jsx(Xu,{data:t,dataKey:"value",nameKey:"subject",cx:"50%",cy:"50%",outerRadius:100,label:!0,children:t.map((n,i)=>_.jsx(NI,{fill:Zne[i%Zne.length]},`cell-${i}`))}),_.jsx(Na,{}),_.jsx(ph,{})]})})},eEt=({quizSessions:e})=>e.length?_.jsxs(t3,{children:[_.jsx(n3,{children:_.jsxs(_S,{children:[_.jsx(yu,{children:"Subject"}),_.jsx(yu,{children:"Score"}),_.jsx(yu,{children:"Time Taken (min)"}),_.jsx(yu,{children:"Date"})]})}),_.jsx(r3,{children:e.map(t=>_.jsxs(_S,{children:[_.jsx(_u,{children:t.subject}),_.jsx(_u,{children:t.score}),_.jsx(_u,{children:t.timeTaken}),_.jsx(_u,{children:t.date.toLocaleDateString()})]},t.id))})]}):_.jsx("div",{className:"text-muted-foreground",children:"No quiz data yet."}),tEt=({studySessions:e})=>{const t=se.useMemo(()=>{const n={};return e.forEach(i=>{const[a,l]=i.startTime.split(":").map(Number),[d,f]=i.endTime.split(":").map(Number),m=d+f/60-(a+l/60);n[i.subject]||(n[i.subject]={count:0,totalHours:0,totalDuration:0}),n[i.subject].count+=1,n[i.subject].totalHours+=m>0?m:0,n[i.subject].totalDuration+=m>0?m:0}),Object.entries(n).map(([i,{count:a,totalHours:l,totalDuration:d}])=>({subject:i,count:a,totalHours:l,avgDuration:a>0?d/a:0}))},[e]);return t.length===0?_.jsx("div",{className:"text-muted-foreground",children:"No study data yet."}):_.jsxs(t3,{children:[_.jsx(n3,{children:_.jsxs(_S,{children:[_.jsx(yu,{children:"Subject"}),_.jsx(yu,{children:"Sessions"}),_.jsx(yu,{children:"Total Hours"}),_.jsx(yu,{children:"Avg. Session Duration"})]})}),_.jsx(r3,{children:t.map(n=>_.jsxs(_S,{children:[_.jsx(_u,{children:n.subject}),_.jsx(_u,{children:n.count}),_.jsx(_u,{children:n.totalHours.toFixed(1)}),_.jsxs(_u,{children:[n.avgDuration.toFixed(2)," hrs"]})]},n.subject))})]})},nEt=()=>{const[e,t]=N.useState([]),[n,i]=N.useState([]),[a,l]=N.useState(!0),[d,f]=N.useState(null),{user:m}=jc();return N.useEffect(()=>{window.scrollTo(0,0)},[]),N.useEffect(()=>{(async()=>{if(!m){l(!1),f("Please log in to view study analysis.");return}l(!0);try{const{data:E,error:S}=await Wt.from("study_sessions").select("*").eq("user_id",m.id);if(console.log("Raw study_sessions data from Supabase:",E),console.error("Error fetching study_sessions (if any):",S),S){console.error("Definite error fetching study sessions:",S),f(S.message||"Failed to fetch study sessions."),t([]);return}t(E?E.map(I=>{const O=new Date(I.date),P=I.duration||0,D=new Date(O.getTime()+P*6e4);return{id:I.id,subject:I.subject,date:O,title:I.title,description:I.description,duration:P,startTime:O.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}),endTime:D.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1}),user_id:I.user_id,created_at:I.created_at}}):[]);const{data:T,error:R}=await Wt.from("quiz_sessions").select("id, subject, score, time_taken, completed_at, user_id, quiz_id").eq("user_id",m.id);console.log("Raw quiz_sessions data from Supabase:",T),console.error("Error fetching quiz_sessions (if any):",R),R?(console.error("Definite error fetching quiz results:",R),f(I=>I?`${I}
${R.message}`:R.message||"Failed to fetch quiz results.")):i(T?T.map(I=>({id:I.id,subject:I.subject,score:I.score,timeTaken:I.time_taken/60,date:new Date(I.completed_at),user_id:I.user_id,quiz_id:I.quiz_id})):[])}catch(E){f(E.message||"Failed to fetch data."),console.error("Error fetching analysis data:",E)}finally{l(!1)}})()},[m]),a?_.jsx("div",{className:"p-4",children:"Loading analysis..."}):d?_.jsxs("div",{className:"p-4 text-red-500",children:["Error: ",d]}):_.jsxs("div",{className:"container mx-auto p-4 md:p-8",children:[_.jsx("h1",{className:"text-3xl font-bold mb-8 text-center",children:"Study Analysis"}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[_.jsxs(Zn,{children:[_.jsx(Zr,{children:_.jsx(pr,{children:"Study Hours Distribution (Bar Chart)"})}),_.jsx(mr,{children:_.jsx(Q_t,{studySessions:e})})]}),_.jsxs(Zn,{children:[_.jsx(Zr,{children:_.jsx(pr,{children:"Study Hours Distribution (Pie Chart)"})}),_.jsx(mr,{children:_.jsx(Z_t,{studySessions:e})})]})]}),_.jsxs(Zn,{className:"mb-8",children:[_.jsx(Zr,{children:_.jsx(pr,{children:"Detailed Study Log"})}),_.jsx(mr,{children:_.jsx(tEt,{studySessions:e})})]}),_.jsxs(Zn,{children:[_.jsx(Zr,{children:_.jsx(pr,{children:"Quiz Performance"})}),_.jsx(mr,{children:_.jsx(eEt,{quizSessions:n})})]})]})},rEt=()=>{const e=[],t=new Date;for(let n=6;n>=0;n--){const i=new Date(t);i.setDate(t.getDate()-n);const a=i.toISOString().slice(0,10),l=Number(localStorage.getItem(`pomodoro_${a}`)||0);e.push({date:a.slice(5),count:l})}return e},iEt=()=>{N.useEffect(()=>{window.scrollTo(0,0)},[]);const e=rEt();return _.jsxs("div",{className:"container mx-auto p-4 md:p-8",children:[_.jsx("h1",{className:"text-3xl font-bold mb-8 text-center",children:"Pomodoro Hub"}),_.jsxs(Zn,{className:"mb-8",children:[_.jsx(Zr,{children:_.jsx(pr,{children:"Pomodoros Completed (Last 7 Days)"})}),_.jsx(mr,{children:e.length>0?_.jsx(dB,{width:"100%",height:300,children:_.jsxs(Sme,{data:e,margin:{top:8,right:24,left:8,bottom:24},children:[_.jsx(qS,{dataKey:"date"}),_.jsx(XS,{allowDecimals:!1}),_.jsx(Na,{}),_.jsx(Uh,{dataKey:"count",fill:"#6366f1",radius:[4,4,0,0]})]})}):_.jsx("p",{className:"text-muted-foreground",children:"No Pomodoro data recorded yet for the last 7 days."})})]})]})},ere=["Success is the sum of small efforts, repeated day in and day out.","Don't watch the clock; do what it does. Keep going.","Great things never come from comfort zones.","Discipline is the bridge between goals and accomplishment.","Push yourself, because no one else is going to do it for you.","The secret of getting ahead is getting started."];function tre(){return ere[Math.floor(Math.random()*ere.length)]}function nre(e){return`${e.toFixed(1)} hrs`}const oEt=()=>{const{user:e}=jc(),[t,n]=N.useState([]),[i,a]=N.useState(0),[l,d]=N.useState(0),[f,m]=N.useState(0),[v,E]=N.useState(tre()),[S,T]=N.useState([{username:"You",streak:0,avatar:"🧑"}]);return N.useEffect(()=>{E(tre())},[]),N.useEffect(()=>{e&&Wt.from("study_sessions").select("*").eq("user_id",e.id).then(({data:R})=>{R&&n(R.map(I=>({id:I.id,subject:I.subject,date:new Date(I.date),startTime:I.start_time||"09:00",endTime:I.end_time||"10:00",notes:I.description||""})))})},[e]),N.useEffect(()=>{const R=new Date,I=t.filter(W=>W.date instanceof Date?W.date.toDateString()===R.toDateString():new Date(W.date).toDateString()===R.toDateString());let O=0;I.forEach(W=>{const[H,J]=W.startTime.split(":").map(Number),[ee,le]=W.endTime.split(":").map(Number);O+=ee+le/60-(H+J/60)}),a(O);const P=new Date(R);P.setDate(R.getDate()-R.getDay());const D=new Date(P);D.setDate(P.getDate()+6);let k=0;t.forEach(W=>{const H=W.date instanceof Date?W.date:new Date(W.date);if(H>=P&&H<=D){const[J,ee]=W.startTime.split(":").map(Number),[le,he]=W.endTime.split(":").map(Number);k+=le+he/60-(J+ee/60)}}),d(k);const M=Array.from(new Set(t.map(W=>W.date instanceof Date?W.date.toDateString():new Date(W.date).toDateString()))).sort((W,H)=>new Date(H).getTime()-new Date(W).getTime());let $=0,V=new Date;for(let W=0;W<M.length&&new Date(M[W]).toDateString()===V.toDateString();W++)$++,V.setDate(V.getDate()-1);m($),T([{username:"You",streak:$,avatar:"🧑"}])},[t]),_.jsxs("div",{className:"container mx-auto py-8 md:py-12",children:[_.jsx("h1",{className:"text-3xl font-bold mb-8 text-center",children:"Achievements & Leaderboard"}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[_.jsx(Zn,{children:_.jsxs(mr,{className:"p-4 flex flex-col items-center",children:[_.jsx(pr,{className:"mb-2 text-center",children:"Today's Progress"}),_.jsx("span",{className:"text-2xl font-bold",children:nre(i)})]})}),_.jsx(Zn,{children:_.jsxs(mr,{className:"p-4 flex flex-col items-center",children:[_.jsx(pr,{className:"mb-2 text-center",children:"This Week"}),_.jsx("span",{className:"text-2xl font-bold",children:nre(l)})]})}),_.jsx(Zn,{children:_.jsxs(mr,{className:"p-4 flex flex-col items-center",children:[_.jsx(pr,{className:"mb-2 text-center",children:"Streak"}),_.jsxs("span",{className:"text-2xl font-bold text-green-600",children:["🔥 ",f," days"]})]})}),_.jsx(Zn,{children:_.jsxs(mr,{className:"p-4 flex flex-col items-center",children:[_.jsx(pr,{className:"mb-2 text-center",children:"Motivation"}),_.jsxs("span",{className:"italic text-muted-foreground text-center",children:["“",v,"”"]})]})})]}),_.jsxs("div",{className:"mb-8",children:[_.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Leaderboard"}),_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"min-w-full bg-white border border-border rounded-lg",children:[_.jsx("thead",{children:_.jsxs("tr",{children:[_.jsx("th",{className:"px-4 py-2 border-b",children:"Rank"}),_.jsx("th",{className:"px-4 py-2 border-b",children:"User"}),_.jsx("th",{className:"px-4 py-2 border-b",children:"Streak"})]})}),_.jsx("tbody",{children:S.map((R,I)=>_.jsxs("tr",{className:I===0?"bg-gray-100":"",children:[_.jsx("td",{className:"px-4 py-2 text-center",children:I+1}),_.jsxs("td",{className:"px-4 py-2 flex items-center gap-2 text-center justify-center",children:[R.avatar," ",R.username]}),_.jsxs("td",{className:"px-4 py-2 text-center",children:[R.streak," days"]})]},R.username))})]})})]})]})};class sEt extends se.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){}render(){var t;return this.state.hasError?_.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[200px] text-center p-8",children:[_.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-2",children:"Something went wrong"}),_.jsx("p",{className:"mb-2 text-muted-foreground",children:"An unexpected error occurred. Please try refreshing the page or contact support."}),_.jsx("details",{className:"text-xs text-muted-foreground whitespace-pre-wrap",style:{maxWidth:400},children:(t=this.state.error)==null?void 0:t.toString()})]}):this.props.children}}const aEt=()=>{const{pathname:e}=kl();return N.useEffect(()=>{window.scrollTo(0,0)},[e]),null},cEt=new Gje,lEt=()=>_.jsx(N.StrictMode,{children:_.jsx(sEt,{children:_.jsx(Kje,{client:cEt,children:_.jsxs(HUe,{children:[_.jsx(aEt,{}),_.jsxs(Eje,{children:[_.jsx(_Me,{}),_.jsx(qMe,{}),_.jsx(hBe,{children:_.jsxs(oae,{children:[_.jsx(Xr,{path:"/",element:_.jsx(Ni,{children:_.jsx(OGe,{})})}),_.jsx(Xr,{path:"/tools/*",element:_.jsx(Ni,{children:_.jsx(iu,{children:_.jsx(x_t,{})})})}),_.jsx(Xr,{path:"/preparation",element:_.jsx(Ni,{children:_.jsx(iu,{children:_.jsx(j_t,{})})})}),_.jsx(Xr,{path:"/resources",element:_.jsx(Ni,{children:_.jsx(iu,{children:_.jsx(k_t,{})})})}),_.jsx(Xr,{path:"/forum",element:_.jsx(Ni,{children:_.jsx(K_t,{})})}),_.jsx(Xr,{path:"/forum/:id",element:_.jsx(Ni,{children:_.jsx(z_t,{})})}),_.jsx(Xr,{path:"/mcq",element:_.jsx(Ni,{children:_.jsx(iu,{children:_.jsx(L_t,{})})})}),_.jsx(Xr,{path:"/test",element:_.jsx(Ni,{children:_.jsx(iu,{children:_.jsx(M_t,{})})})}),_.jsx(Xr,{path:"/login",element:_.jsx(Ni,{children:_.jsx(U_t,{})})}),_.jsx(Xr,{path:"/register",element:_.jsx(Ni,{children:_.jsx(W_t,{})})}),_.jsx(Xr,{path:"/profile",element:_.jsx(Ni,{children:_.jsx(iu,{children:_.jsx(G_t,{})})})}),_.jsx(Xr,{path:"/help-center",element:_.jsx(Ni,{children:_.jsx(X_t,{})})}),_.jsx(Xr,{path:"/contact-us",element:_.jsx(Ni,{children:_.jsx(J_t,{})})}),_.jsx(Xr,{path:"/privacy-policy",element:_.jsx(Ni,{children:_.jsx(Y_t,{})})}),_.jsx(Xr,{path:"/terms-of-service",element:_.jsx(Ni,{children:_.jsx(q_t,{})})}),_.jsx(Xr,{path:"/study-analysis",element:_.jsx(Ni,{children:_.jsx(iu,{children:_.jsx(nEt,{})})})})," ",_.jsx(Xr,{path:"/pomodoro",element:_.jsx(Ni,{children:_.jsx(iu,{children:_.jsx(iEt,{})})})})," ",_.jsx(Xr,{path:"/achievements",element:_.jsx(Ni,{children:_.jsx(iu,{children:_.jsx(oEt,{})})})})," ",_.jsx(Xr,{path:"*",element:_.jsx(Ni,{children:_.jsx(H_t,{})})})]})})]})]})})})});Toe(document.getElementById("root")).render(_.jsx(lEt,{}));export{zn as g};
